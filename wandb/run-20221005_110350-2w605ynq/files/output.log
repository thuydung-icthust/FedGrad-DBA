current path: saved_models/model_mnist_Oct.05_11.03.48
Loading data
build_classes_dict done
train loaders done
get poison test loader
Starting performing KrMLRFL...
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1097, Accuracy: 9646/10000 (96.4600%)
___Train Local_Simple,  epoch  11, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 719/731 (98.3584%)
___Train Local_Simple,  epoch  11, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2988, Accuracy: 8998/10000 (89.9800%)
poison local model 61 index 0
___PoisonTrain Local_Simple ,  epoch  11, local model 61, internal_epoch   1,  Average loss: 0.0211, Accuracy: 427/699 (61.0873%), train_poison_data_count: 220
___PoisonTrain Local_Simple ,  epoch  11, local model 61, internal_epoch   2,  Average loss: 0.0117, Accuracy: 456/699 (65.2361%), train_poison_data_count: 220
Global model norm: 16.539532092117113.
Norm before scaling: 16.71508246864471. Distance: 4.268345227466373
Total norm for 5 adversaries is: 16.71508246864471. distance: 4.268345227466373
class_loss: 3.5104146003723145, distance_loss: 0.0
class_loss: 1.8648605346679688, distance_loss: 0.3162311911582947
class_loss: 1.1312787532806396, distance_loss: 0.7744445204734802
class_loss: 1.1551026105880737, distance_loss: 1.1992974281311035
class_loss: 1.1223413944244385, distance_loss: 1.5319246053695679
class_loss: 1.1552973985671997, distance_loss: 1.8200098276138306
class_loss: 0.9727140665054321, distance_loss: 2.0811071395874023
class_loss: 0.9655166864395142, distance_loss: 2.3258538246154785
class_loss: 0.9581470489501953, distance_loss: 2.5514469146728516
class_loss: 0.8991203904151917, distance_loss: 2.761491060256958
class_loss: 0.9833215475082397, distance_loss: 2.9537038803100586
class_loss: 0.7647413611412048, distance_loss: 3.1338162422180176
class_loss: 0.822985827922821, distance_loss: 3.299034357070923
class_loss: 0.8584273457527161, distance_loss: 3.4473769664764404
class_loss: 0.6633390188217163, distance_loss: 3.5703072547912598
class_loss: 0.7161194086074829, distance_loss: 3.684647560119629
class_loss: 0.6452224850654602, distance_loss: 3.7905874252319336
class_loss: 0.810435950756073, distance_loss: 3.8859505653381348
class_loss: 0.8298177123069763, distance_loss: 3.972400665283203
class_loss: 0.6129506826400757, distance_loss: 4.05469274520874
class_loss: 0.7324016094207764, distance_loss: 4.131722450256348
class_loss: 0.6955277323722839, distance_loss: 4.20252799987793
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9907, Accuracy: 4928/8968 (54.9509%)
poison local model 11 index 1
___PoisonTrain Local_Simple ,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0322, Accuracy: 278/645 (43.1008%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  11, local model 11, internal_epoch   2,  Average loss: 0.0194, Accuracy: 327/645 (50.6977%), train_poison_data_count: 205
Global model norm: 16.539532092117113.
Norm before scaling: 16.817764082086036. Distance: 5.039996771735717
Total norm for 5 adversaries is: 16.817764082086036. distance: 5.039996771735717
class_loss: 4.539518356323242, distance_loss: 0.0
class_loss: 2.417982816696167, distance_loss: 0.3524917960166931
class_loss: 1.4732260704040527, distance_loss: 0.8848463892936707
class_loss: 1.7820674180984497, distance_loss: 1.4030033349990845
class_loss: 1.670753002166748, distance_loss: 1.8188773393630981
class_loss: 1.6887736320495605, distance_loss: 2.178250312805176
class_loss: 1.69856858253479, distance_loss: 2.496901273727417
class_loss: 1.6251591444015503, distance_loss: 2.78171706199646
class_loss: 1.5262686014175415, distance_loss: 3.03717303276062
class_loss: 1.4118624925613403, distance_loss: 3.267648220062256
class_loss: 0.958504855632782, distance_loss: 3.4760050773620605
class_loss: 1.4650713205337524, distance_loss: 3.691863536834717
class_loss: 1.410029411315918, distance_loss: 3.872204542160034
class_loss: 1.0932815074920654, distance_loss: 4.0163750648498535
class_loss: 0.9721928238868713, distance_loss: 4.147823810577393
class_loss: 1.0221666097640991, distance_loss: 4.27739143371582
class_loss: 1.0412580966949463, distance_loss: 4.401827812194824
class_loss: 1.0627564191818237, distance_loss: 4.519493103027344
class_loss: 1.1959556341171265, distance_loss: 4.631038665771484
class_loss: 1.100512146949768, distance_loss: 4.736700057983398
class_loss: 0.9711346626281738, distance_loss: 4.836575508117676
class_loss: 1.1528176069259644, distance_loss: 4.929904937744141
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5739, Accuracy: 6676/8968 (74.4425%)
poison local model 71 index 2
___PoisonTrain Local_Simple ,  epoch  11, local model 71, internal_epoch   1,  Average loss: 0.0197, Accuracy: 772/1384 (55.7803%), train_poison_data_count: 440
class_loss: 3.6337695121765137, distance_loss: 0.0
class_loss: 1.7928739786148071, distance_loss: 0.41091495752334595
class_loss: 1.7432215213775635, distance_loss: 0.9174676537513733
class_loss: 1.9602717161178589, distance_loss: 1.3058750629425049
class_loss: 1.6159952878952026, distance_loss: 1.6268266439437866
class_loss: 1.4152852296829224, distance_loss: 1.9485597610473633
class_loss: 1.252673864364624, distance_loss: 2.2607614994049072
class_loss: 1.1137242317199707, distance_loss: 2.5523931980133057
class_loss: 1.0592970848083496, distance_loss: 2.824854850769043
class_loss: 0.9669269323348999, distance_loss: 3.0798180103302
class_loss: 1.0418484210968018, distance_loss: 3.315126419067383
class_loss: 0.8774325251579285, distance_loss: 3.5317790508270264
class_loss: 0.9572365283966064, distance_loss: 3.7297279834747314
class_loss: 0.7480521202087402, distance_loss: 3.912001371383667
class_loss: 1.210070252418518, distance_loss: 4.08030366897583
class_loss: 0.8688188791275024, distance_loss: 4.226978778839111
class_loss: 0.8538861870765686, distance_loss: 4.355586051940918
class_loss: 0.7134546041488647, distance_loss: 4.472978591918945
class_loss: 0.7847453951835632, distance_loss: 4.581131458282471
class_loss: 0.9073824882507324, distance_loss: 4.6792426109313965
class_loss: 0.8393684029579163, distance_loss: 4.768661975860596
class_loss: 0.9180272817611694, distance_loss: 4.852058410644531
___PoisonTrain Local_Simple ,  epoch  11, local model 71, internal_epoch   2,  Average loss: 0.0103, Accuracy: 960/1384 (69.3642%), train_poison_data_count: 440
Global model norm: 16.539532092117113.
Norm before scaling: 17.15914742439237. Distance: 5.862683961499364
Total norm for 5 adversaries is: 17.15914742439237. distance: 5.862683961499364
class_loss: 0.7988827228546143, distance_loss: 4.930307865142822
class_loss: 0.8729782104492188, distance_loss: 5.001896858215332
class_loss: 0.7474061250686646, distance_loss: 5.067049503326416
class_loss: 0.8452227711677551, distance_loss: 5.126030445098877
class_loss: 0.882675290107727, distance_loss: 5.176769256591797
class_loss: 0.813332200050354, distance_loss: 5.22146463394165
class_loss: 0.5880067944526672, distance_loss: 5.261598587036133
class_loss: 0.6266626715660095, distance_loss: 5.301309108734131
class_loss: 0.623065710067749, distance_loss: 5.338122367858887
class_loss: 0.6974892020225525, distance_loss: 5.374566078186035
class_loss: 0.9617859125137329, distance_loss: 5.406965255737305
class_loss: 0.7907993197441101, distance_loss: 5.4374895095825195
class_loss: 0.7230826020240784, distance_loss: 5.467464447021484
class_loss: 0.6652708649635315, distance_loss: 5.499288082122803
class_loss: 0.5618345141410828, distance_loss: 5.5284318923950195
class_loss: 0.7040727138519287, distance_loss: 5.558917999267578
class_loss: 0.5065561532974243, distance_loss: 5.590811252593994
class_loss: 0.5689151287078857, distance_loss: 5.629356861114502
class_loss: 0.3366829454898834, distance_loss: 5.6718854904174805
class_loss: 0.39139991998672485, distance_loss: 5.716859340667725
class_loss: 0.3530721664428711, distance_loss: 5.763200759887695
class_loss: 0.17595578730106354, distance_loss: 5.810490131378174
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0653, Accuracy: 8773/8968 (97.8256%)
poison local model 42 index 3
___PoisonTrain Local_Simple ,  epoch  11, local model 42, internal_epoch   1,  Average loss: 0.0268, Accuracy: 170/236 (72.0339%), train_poison_data_count: 80
class_loss: 2.349877119064331, distance_loss: 0.0
class_loss: 1.8577362298965454, distance_loss: 0.207455113530159
class_loss: 1.2086020708084106, distance_loss: 0.5615610480308533
class_loss: 0.9028346538543701, distance_loss: 0.9584099054336548
___PoisonTrain Local_Simple ,  epoch  11, local model 42, internal_epoch   2,  Average loss: 0.0194, Accuracy: 137/236 (58.0508%), train_poison_data_count: 80
Global model norm: 16.539532092117113.
Norm before scaling: 16.36239395048951. Distance: 2.296692717708487
Total norm for 5 adversaries is: 16.36239395048951. distance: 2.296692717708487
class_loss: 1.4102065563201904, distance_loss: 1.3310359716415405
class_loss: 1.1734087467193604, distance_loss: 1.6091365814208984
class_loss: 1.0183321237564087, distance_loss: 1.8585213422775269
class_loss: 0.9719399809837341, distance_loss: 2.087225914001465
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.2262, Accuracy: 5729/8968 (63.8827%)
poison local model 45 index 0
class_loss: 3.578488826751709, distance_loss: 0.0
class_loss: 1.7760286331176758, distance_loss: 0.3494974374771118
class_loss: 1.6465920209884644, distance_loss: 0.8455685973167419
class_loss: 1.9029282331466675, distance_loss: 1.2382404804229736
class_loss: 1.557267665863037, distance_loss: 1.5457655191421509
class_loss: 1.4604356288909912, distance_loss: 1.8432897329330444
class_loss: 1.5495814085006714, distance_loss: 2.120497226715088
class_loss: 1.3632274866104126, distance_loss: 2.3677480220794678
class_loss: 1.2645349502563477, distance_loss: 2.5944325923919678
class_loss: 1.1343716382980347, distance_loss: 2.8076863288879395
___PoisonTrain Local_Simple ,  epoch  11, local model 45, internal_epoch   1,  Average loss: 0.0274, Accuracy: 339/628 (53.9809%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  11, local model 45, internal_epoch   2,  Average loss: 0.0151, Accuracy: 347/628 (55.2548%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.732984412052275. Distance: 4.3633704248944705
Total norm for 5 adversaries is: 16.732984412052275. distance: 4.3633704248944705
class_loss: 1.1030422449111938, distance_loss: 3.0158886909484863
class_loss: 0.9508678317070007, distance_loss: 3.212510347366333
class_loss: 0.9224562644958496, distance_loss: 3.397195816040039
class_loss: 1.1203281879425049, distance_loss: 3.567485809326172
class_loss: 0.8362345695495605, distance_loss: 3.720590829849243
class_loss: 1.0340301990509033, distance_loss: 3.855626344680786
class_loss: 0.9090415239334106, distance_loss: 3.9695332050323486
class_loss: 0.8226146101951599, distance_loss: 4.075804710388184
class_loss: 0.8261378407478333, distance_loss: 4.1764373779296875
class_loss: 0.9350681900978088, distance_loss: 4.271109104156494
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.3247, Accuracy: 2673/8968 (29.8060%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 842/860 (97.9070%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0005, Accuracy: 853/860 (99.1860%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2156, Accuracy: 9342/10000 (93.4200%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 304/312 (97.4359%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   2,  Average loss: 0.0007, Accuracy: 307/312 (98.3974%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2631, Accuracy: 9177/10000 (91.7700%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 492/499 (98.5972%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   2,  Average loss: 0.0003, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3008, Accuracy: 9117/10000 (91.1700%)
time spent on training: 74.4016363620758
Starting performing KrMLRFL...
Num data points: [293, 731, 699, 645, 1384, 236, 628, 860, 312, 499]
Num selected data points: [293 731 860 312 499]
The chosen ones are users: [0, 1, 7, 8, 9], which are global users: [23, 72, 37, 21, 35]
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1028, Accuracy: 9696/10000 (96.9600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 11, 71, 42, 45]
base_p: [-0.006717    0.00034668 -0.00212856 ... -0.0030188  -0.01063142
 -0.0004416 ]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 6]
layer1_inf_time: 4.296630859375
[PAIRWISE] pred_attackers_indx:  [2 3 4 5 6]
layer2_inf_t: 255.010498046875
assumed final_attacker_idxs:  [2 3 4 5 6]
final_attacker_idxs is: [2, 3, 4, 5, 6]
g_attacker_idxs: [61 11 71 42 45]
g_normal_idxs: [23 72 37 21 35]
filtered_attacker_idxs: [2, 3, 4, 5, 6]
final_attacker_idxs are: [2, 3, 4, 5, 6]
num_dps: [293, 731, 699, 645, 1384, 236, 628, 860, 312, 499]
epoch_acc: 96.96000000000001
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 11.2643, Accuracy: 83/8968 (0.9255%)
Done in 81.80906414985657 sec.
Server Epoch:12 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 0
___PoisonTrain Local_Simple ,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0286, Accuracy: 355/645 (55.0388%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  12, local model 11, internal_epoch   2,  Average loss: 0.0188, Accuracy: 332/645 (51.4729%), train_poison_data_count: 205
Global model norm: 16.483873289166027.
Norm before scaling: 16.72730505416219. Distance: 4.608281616877295
Total norm for 3 adversaries is: 16.72730505416219. distance: 4.608281616877295
class_loss: 3.0730044841766357, distance_loss: 0.0
class_loss: 2.7085022926330566, distance_loss: 0.2750197947025299
class_loss: 1.1914118528366089, distance_loss: 0.7549716234207153
class_loss: 2.3288958072662354, distance_loss: 1.2197378873825073
class_loss: 1.4065845012664795, distance_loss: 1.5253872871398926
class_loss: 1.1145530939102173, distance_loss: 1.832061767578125
class_loss: 1.2958879470825195, distance_loss: 2.121320962905884
class_loss: 1.4205005168914795, distance_loss: 2.3804140090942383
class_loss: 1.2448691129684448, distance_loss: 2.6142947673797607
class_loss: 1.1655898094177246, distance_loss: 2.8232624530792236
class_loss: 1.5148407220840454, distance_loss: 3.0144991874694824
class_loss: 1.0648995637893677, distance_loss: 3.229292392730713
class_loss: 1.0757421255111694, distance_loss: 3.4330151081085205
class_loss: 1.3385194540023804, distance_loss: 3.6051125526428223
class_loss: 1.2816805839538574, distance_loss: 3.7396769523620605
class_loss: 1.0404375791549683, distance_loss: 3.8545918464660645
class_loss: 0.9899511933326721, distance_loss: 3.9650392532348633
class_loss: 1.0454524755477905, distance_loss: 4.074501037597656
class_loss: 0.9286903738975525, distance_loss: 4.181994915008545
class_loss: 1.0530253648757935, distance_loss: 4.289936065673828
class_loss: 1.0352791547775269, distance_loss: 4.39180326461792
class_loss: 1.2899701595306396, distance_loss: 4.4904465675354
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.9252, Accuracy: 5251/8968 (58.5526%)
___Train Local_Simple,  epoch  12, local model 59, internal_epoch   1,  Average loss: 0.0017, Accuracy: 738/760 (97.1053%)
___Train Local_Simple,  epoch  12, local model 59, internal_epoch   2,  Average loss: 0.0011, Accuracy: 746/760 (98.1579%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2400, Accuracy: 9207/10000 (92.0700%)
___Train Local_Simple,  epoch  12, local model 62, internal_epoch   1,  Average loss: 0.0011, Accuracy: 413/423 (97.6359%)
___Train Local_Simple,  epoch  12, local model 62, internal_epoch   2,  Average loss: 0.0005, Accuracy: 419/423 (99.0544%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1334, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0014, Accuracy: 490/501 (97.8044%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   2,  Average loss: 0.0007, Accuracy: 495/501 (98.8024%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1174, Accuracy: 9639/10000 (96.3900%)
___Train Local_Simple,  epoch  12, local model 65, internal_epoch   1,  Average loss: 0.0013, Accuracy: 360/371 (97.0350%)
___Train Local_Simple,  epoch  12, local model 65, internal_epoch   2,  Average loss: 0.0007, Accuracy: 364/371 (98.1132%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2176, Accuracy: 9312/10000 (93.1200%)
poison local model 22 index 1
___PoisonTrain Local_Simple ,  epoch  12, local model 22, internal_epoch   1,  Average loss: 0.0249, Accuracy: 362/583 (62.0926%), train_poison_data_count: 187
___PoisonTrain Local_Simple ,  epoch  12, local model 22, internal_epoch   2,  Average loss: 0.0162, Accuracy: 328/583 (56.2607%), train_poison_data_count: 187
Global model norm: 16.483873289166027.
Norm before scaling: 16.550327189458372. Distance: 3.8547304445618416
Total norm for 3 adversaries is: 16.550327189458372. distance: 3.8547304445618416
class_loss: 3.1425321102142334, distance_loss: 0.0
class_loss: 1.7252360582351685, distance_loss: 0.3213081955909729
class_loss: 1.7747012376785278, distance_loss: 0.7915151119232178
class_loss: 1.166858196258545, distance_loss: 1.0236765146255493
class_loss: 0.8299140930175781, distance_loss: 1.2582563161849976
class_loss: 1.344002366065979, distance_loss: 1.5103133916854858
class_loss: 1.215061068534851, distance_loss: 1.763543963432312
class_loss: 1.153242826461792, distance_loss: 1.9939261674880981
class_loss: 0.9931389093399048, distance_loss: 2.21358585357666
class_loss: 1.1497665643692017, distance_loss: 2.413844347000122
class_loss: 0.9016309976577759, distance_loss: 2.6375832557678223
class_loss: 1.0453855991363525, distance_loss: 2.8349263668060303
class_loss: 0.9984275102615356, distance_loss: 2.9877777099609375
class_loss: 0.8716932535171509, distance_loss: 3.1129846572875977
class_loss: 0.9633521437644958, distance_loss: 3.2365782260894775
class_loss: 1.0068204402923584, distance_loss: 3.3559529781341553
class_loss: 0.9203329682350159, distance_loss: 3.4701664447784424
class_loss: 0.9225460886955261, distance_loss: 3.575035333633423
class_loss: 0.7770884037017822, distance_loss: 3.670579671859741
class_loss: 1.0349981784820557, distance_loss: 3.7584614753723145
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.9605, Accuracy: 5976/8968 (66.6369%)
___Train Local_Simple,  epoch  12, local model 78, internal_epoch   1,  Average loss: 0.0016, Accuracy: 292/303 (96.3696%)
___Train Local_Simple,  epoch  12, local model 78, internal_epoch   2,  Average loss: 0.0011, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2067, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch  12, local model 58, internal_epoch   1,  Average loss: 0.0027, Accuracy: 265/276 (96.0145%)
___Train Local_Simple,  epoch  12, local model 58, internal_epoch   2,  Average loss: 0.0016, Accuracy: 269/276 (97.4638%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2765, Accuracy: 9090/10000 (90.9000%)
___Train Local_Simple,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0012, Accuracy: 594/606 (98.0198%)
___Train Local_Simple,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 599/606 (98.8449%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9457, Accuracy: 8056/10000 (80.5600%)
poison local model 81 index 2
___PoisonTrain Local_Simple ,  epoch  12, local model 81, internal_epoch   1,  Average loss: 0.0224, Accuracy: 654/1227 (53.3007%), train_poison_data_count: 391
class_loss: 4.594991683959961, distance_loss: 0.0
class_loss: 2.2818796634674072, distance_loss: 0.4052301347255707
class_loss: 1.449784755706787, distance_loss: 0.926834762096405
class_loss: 1.7312382459640503, distance_loss: 1.37837815284729
class_loss: 1.449871301651001, distance_loss: 1.7481263875961304
class_loss: 1.2946308851242065, distance_loss: 2.08931303024292
class_loss: 1.1983059644699097, distance_loss: 2.399057626724243
class_loss: 1.0855178833007812, distance_loss: 2.6754281520843506
class_loss: 1.084122657775879, distance_loss: 2.9287726879119873
class_loss: 1.090754747390747, distance_loss: 3.1616299152374268
class_loss: 1.0375516414642334, distance_loss: 3.373523235321045
class_loss: 1.115839958190918, distance_loss: 3.564915418624878
class_loss: 0.8364440202713013, distance_loss: 3.7360594272613525
class_loss: 0.9813041090965271, distance_loss: 3.8898725509643555
class_loss: 1.0759488344192505, distance_loss: 4.027853012084961
class_loss: 0.926810085773468, distance_loss: 4.153162002563477
class_loss: 0.7782179713249207, distance_loss: 4.269824981689453
class_loss: 0.9162619709968567, distance_loss: 4.381965160369873
class_loss: 0.971093475818634, distance_loss: 4.485689640045166
class_loss: 1.5924166440963745, distance_loss: 4.57920503616333
___PoisonTrain Local_Simple ,  epoch  12, local model 81, internal_epoch   2,  Average loss: 0.0158, Accuracy: 649/1227 (52.8932%), train_poison_data_count: 391
Global model norm: 16.483873289166027.
Norm before scaling: 17.01355068709709. Distance: 5.583868921506697
Total norm for 3 adversaries is: 17.01355068709709. distance: 5.583868921506697
class_loss: 0.9230540990829468, distance_loss: 4.686529159545898
class_loss: 1.3181260824203491, distance_loss: 4.785254001617432
class_loss: 1.4139995574951172, distance_loss: 4.868310928344727
class_loss: 1.2021230459213257, distance_loss: 4.936739444732666
class_loss: 1.0448275804519653, distance_loss: 4.994649887084961
class_loss: 0.9816187024116516, distance_loss: 5.046609401702881
class_loss: 0.9559507369995117, distance_loss: 5.097416400909424
class_loss: 0.8031332492828369, distance_loss: 5.144768714904785
class_loss: 1.0076526403427124, distance_loss: 5.18937873840332
class_loss: 1.0433547496795654, distance_loss: 5.229327201843262
class_loss: 0.87279212474823, distance_loss: 5.267147064208984
class_loss: 0.8054729700088501, distance_loss: 5.304934024810791
class_loss: 0.7846611738204956, distance_loss: 5.341669082641602
class_loss: 0.8071756958961487, distance_loss: 5.378474235534668
class_loss: 0.9752253890037537, distance_loss: 5.412819862365723
class_loss: 0.9869114756584167, distance_loss: 5.445101737976074
class_loss: 0.8934903740882874, distance_loss: 5.474715232849121
class_loss: 0.748058557510376, distance_loss: 5.500668048858643
class_loss: 0.7302778363227844, distance_loss: 5.523664474487305
class_loss: 1.1068733930587769, distance_loss: 5.546072483062744
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.6427, Accuracy: 6262/8968 (69.8260%)
time spent on training: 55.97050929069519
Starting performing KrMLRFL...
Num data points: [645, 760, 423, 501, 371, 583, 303, 276, 606, 1227]
Num selected data points: [423 501 371 303 276]
The chosen ones are users: [2, 3, 4, 6, 7], which are global users: [62, 28, 65, 78, 58]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 22, 81]
base_p: [-0.00734444  0.00024479 -0.00055437 ... -0.0045618  -0.00109012
 -0.00302169]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 8, 9]
layer1_inf_time: 3.350830078125
[PAIRWISE] pred_attackers_indx:  [0 5 9]
layer2_inf_t: 144.38720703125
assumed final_attacker_idxs:  [0 1 5 8 9]
final_attacker_idxs is: [0, 1, 5, 8, 9]
g_attacker_idxs: [11 59 22 41 81]
g_normal_idxs: [62 28 65 78 58]
filtered_attacker_idxs: [0, 1, 5, 8, 9]
final_attacker_idxs are: [0, 1, 5, 8, 9]
num_dps: [645, 760, 423, 501, 371, 583, 303, 276, 606, 1227]
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.0845, Accuracy: 9730/10000 (97.3000%)
epoch_acc: 97.3
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 11.9123, Accuracy: 20/8968 (0.2230%)
Done in 63.24864149093628 sec.
Server Epoch:13 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch  13, local model 54, internal_epoch   1,  Average loss: 0.0017, Accuracy: 500/519 (96.3391%)
___Train Local_Simple,  epoch  13, local model 54, internal_epoch   2,  Average loss: 0.0010, Accuracy: 509/519 (98.0732%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3800, Accuracy: 8764/10000 (87.6400%)
___Train Local_Simple,  epoch  13, local model 55, internal_epoch   1,  Average loss: 0.0021, Accuracy: 343/354 (96.8927%)
___Train Local_Simple,  epoch  13, local model 55, internal_epoch   2,  Average loss: 0.0007, Accuracy: 351/354 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.7280, Accuracy: 7636/10000 (76.3600%)
poison local model 61 index 0
___PoisonTrain Local_Simple ,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0204, Accuracy: 434/699 (62.0887%), train_poison_data_count: 220
class_loss: 3.443540096282959, distance_loss: 0.0
class_loss: 1.8951525688171387, distance_loss: 0.32228535413742065
class_loss: 1.3566125631332397, distance_loss: 0.7526121735572815
class_loss: 1.0114283561706543, distance_loss: 1.1355950832366943
class_loss: 0.927234411239624, distance_loss: 1.4808186292648315
class_loss: 1.3550801277160645, distance_loss: 1.7805941104888916
class_loss: 1.017316222190857, distance_loss: 2.0529494285583496
class_loss: 0.8317900896072388, distance_loss: 2.3043086528778076
class_loss: 0.8503654599189758, distance_loss: 2.538158655166626
class_loss: 0.7487534880638123, distance_loss: 2.7561190128326416
class_loss: 0.8152099251747131, distance_loss: 2.9553873538970947
___PoisonTrain Local_Simple ,  epoch  13, local model 61, internal_epoch   2,  Average loss: 0.0126, Accuracy: 461/699 (65.9514%), train_poison_data_count: 220
Global model norm: 16.461897812519787.
Norm before scaling: 16.58490340629374. Distance: 4.215068652045312
Total norm for 3 adversaries is: 16.58490340629374. distance: 4.215068652045312
class_loss: 0.947569727897644, distance_loss: 3.138976573944092
class_loss: 1.0150747299194336, distance_loss: 3.2991113662719727
class_loss: 0.8620898723602295, distance_loss: 3.437338352203369
class_loss: 0.7384435534477234, distance_loss: 3.559777021408081
class_loss: 0.8026246428489685, distance_loss: 3.6700668334960938
class_loss: 0.6834039688110352, distance_loss: 3.772372245788574
class_loss: 0.7108942866325378, distance_loss: 3.863565683364868
class_loss: 0.780650794506073, distance_loss: 3.944768190383911
class_loss: 0.6278391480445862, distance_loss: 4.020591735839844
class_loss: 0.9131377935409546, distance_loss: 4.090851306915283
class_loss: 0.7514936327934265, distance_loss: 4.155282020568848
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.9331, Accuracy: 5048/8968 (56.2890%)
poison local model 73 index 1
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0295, Accuracy: 316/591 (53.4687%), train_poison_data_count: 195
class_loss: 3.831984043121338, distance_loss: 0.0
class_loss: 1.300590991973877, distance_loss: 0.4619220197200775
class_loss: 2.270202159881592, distance_loss: 0.8909752368927002
class_loss: 1.7443201541900635, distance_loss: 1.1996508836746216
class_loss: 1.5174635648727417, distance_loss: 1.5349130630493164
class_loss: 1.343698501586914, distance_loss: 1.8573530912399292
class_loss: 1.1272257566452026, distance_loss: 2.148670196533203
class_loss: 1.2006562948226929, distance_loss: 2.417776584625244
class_loss: 1.096344232559204, distance_loss: 2.669952154159546
class_loss: 1.9960651397705078, distance_loss: 2.9018125534057617
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0222, Accuracy: 244/591 (41.2860%), train_poison_data_count: 195
Global model norm: 16.461897812519787.
Norm before scaling: 16.708839060041694. Distance: 4.6846314872165244
Total norm for 3 adversaries is: 16.708839060041694. distance: 4.6846314872165244
class_loss: 1.2788785696029663, distance_loss: 3.1576437950134277
class_loss: 1.477899193763733, distance_loss: 3.391993761062622
class_loss: 1.3659716844558716, distance_loss: 3.600041627883911
class_loss: 1.3445265293121338, distance_loss: 3.787318706512451
class_loss: 1.322007417678833, distance_loss: 3.9509360790252686
class_loss: 1.1928220987319946, distance_loss: 4.098202228546143
class_loss: 1.0311264991760254, distance_loss: 4.235917568206787
class_loss: 1.026086688041687, distance_loss: 4.367175102233887
class_loss: 1.2647933959960938, distance_loss: 4.487166881561279
class_loss: 1.8120806217193604, distance_loss: 4.5921735763549805
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8275, Accuracy: 7043/8968 (78.5348%)
___Train Local_Simple,  epoch  13, local model 18, internal_epoch   1,  Average loss: 0.0019, Accuracy: 445/459 (96.9499%)
___Train Local_Simple,  epoch  13, local model 18, internal_epoch   2,  Average loss: 0.0015, Accuracy: 452/459 (98.4749%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5070, Accuracy: 8826/10000 (88.2600%)
poison local model 42 index 2
___PoisonTrain Local_Simple ,  epoch  13, local model 42, internal_epoch   1,  Average loss: 0.0260, Accuracy: 167/236 (70.7627%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  13, local model 42, internal_epoch   2,  Average loss: 0.0193, Accuracy: 124/236 (52.5424%), train_poison_data_count: 80
Global model norm: 16.461897812519787.
Norm before scaling: 16.311094961640567. Distance: 2.256854953132784
Total norm for 3 adversaries is: 16.311094961640567. distance: 2.256854953132784
class_loss: 2.661886692047119, distance_loss: 0.0
class_loss: 1.3455147743225098, distance_loss: 0.25550413131713867
class_loss: 1.1642752885818481, distance_loss: 0.6074085831642151
class_loss: 0.9663112163543701, distance_loss: 1.0150837898254395
class_loss: 1.1146403551101685, distance_loss: 1.3594650030136108
class_loss: 1.072080373764038, distance_loss: 1.6273725032806396
class_loss: 1.0443360805511475, distance_loss: 1.8609973192214966
class_loss: 1.3266432285308838, distance_loss: 2.0723602771759033
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.2014, Accuracy: 6255/8968 (69.7480%)
___Train Local_Simple,  epoch  13, local model 87, internal_epoch   1,  Average loss: 0.0012, Accuracy: 457/470 (97.2340%)
___Train Local_Simple,  epoch  13, local model 87, internal_epoch   2,  Average loss: 0.0011, Accuracy: 460/470 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2052, Accuracy: 9403/10000 (94.0300%)
___Train Local_Simple,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0018, Accuracy: 586/606 (96.6997%)
___Train Local_Simple,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0012, Accuracy: 592/606 (97.6898%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.5862, Accuracy: 8301/10000 (83.0100%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   1,  Average loss: 0.0022, Accuracy: 454/474 (95.7806%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   2,  Average loss: 0.0014, Accuracy: 458/474 (96.6245%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2297, Accuracy: 9215/10000 (92.1500%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 492/501 (98.2036%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   2,  Average loss: 0.0004, Accuracy: 499/501 (99.6008%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1148, Accuracy: 9627/10000 (96.2700%)
time spent on training: 56.37537240982056
Starting performing KrMLRFL...
Num data points: [519, 354, 699, 591, 459, 236, 470, 606, 474, 501]
Num selected data points: [519 459 470 474 501]
The chosen ones are users: [0, 4, 6, 8, 9], which are global users: [54, 18, 87, 50, 28]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 73, 42]
base_p: [-0.00446194  0.00042566  0.00568579 ...  0.00033481 -0.00151157
  0.0050128 ]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 5, 7]
layer1_inf_time: 3.918701171875
[PAIRWISE] pred_attackers_indx:  [2 3 5]
layer2_inf_t: 168.18115234375
assumed final_attacker_idxs:  [1 2 3 5 7]
final_attacker_idxs is: [1, 2, 3, 5, 7]
g_attacker_idxs: [55 61 73 42 41]
g_normal_idxs: [54 18 87 50 28]
filtered_attacker_idxs: [1, 2, 3, 5, 7]
final_attacker_idxs are: [1, 2, 3, 5, 7]
num_dps: [519, 354, 699, 591, 459, 236, 470, 606, 474, 501]
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1004, Accuracy: 9670/10000 (96.7000%)
epoch_acc: 96.7
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 10.9509, Accuracy: 33/8968 (0.3680%)
Done in 63.01370573043823 sec.
Server Epoch:14 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
___Train Local_Simple,  epoch  14, local model 37, internal_epoch   1,  Average loss: 0.0014, Accuracy: 841/860 (97.7907%)
___Train Local_Simple,  epoch  14, local model 37, internal_epoch   2,  Average loss: 0.0008, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2807, Accuracy: 9144/10000 (91.4400%)
___Train Local_Simple,  epoch  14, local model 92, internal_epoch   1,  Average loss: 0.0014, Accuracy: 916/937 (97.7588%)
___Train Local_Simple,  epoch  14, local model 92, internal_epoch   2,  Average loss: 0.0006, Accuracy: 923/937 (98.5059%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4624, Accuracy: 8651/10000 (86.5100%)
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0011, Accuracy: 588/602 (97.6744%)
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   2,  Average loss: 0.0005, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.8583, Accuracy: 7030/10000 (70.3000%)
___Train Local_Simple,  epoch  14, local model 76, internal_epoch   1,  Average loss: 0.0048, Accuracy: 76/78 (97.4359%)
___Train Local_Simple,  epoch  14, local model 76, internal_epoch   2,  Average loss: 0.0005, Accuracy: 78/78 (100.0000%)
class_loss: 3.044367790222168, distance_loss: 0.0
class_loss: 2.5195212364196777, distance_loss: 0.36022016406059265
class_loss: 1.4580903053283691, distance_loss: 0.7676855325698853
class_loss: 1.3150469064712524, distance_loss: 1.1322295665740967
class_loss: 1.4013586044311523, distance_loss: 1.467957615852356
class_loss: 1.3064299821853638, distance_loss: 1.7768547534942627
class_loss: 1.3195242881774902, distance_loss: 2.0552873611450195
class_loss: 1.29106605052948, distance_loss: 2.3062984943389893
class_loss: 1.1981894969940186, distance_loss: 2.5303843021392822
class_loss: 1.0396963357925415, distance_loss: 2.725480556488037
class_loss: 0.9918934106826782, distance_loss: 2.90202260017395
class_loss: 0.9239053726196289, distance_loss: 3.0651564598083496
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9693, Accuracy: 8441/10000 (84.4100%)
poison local model 13 index 0
___PoisonTrain Local_Simple ,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0243, Accuracy: 394/734 (53.6785%), train_poison_data_count: 240
class_loss: 1.064353346824646, distance_loss: 3.2247960567474365
class_loss: 1.1729583740234375, distance_loss: 3.362994909286499
class_loss: 1.0224162340164185, distance_loss: 3.4761922359466553
class_loss: 0.9466514587402344, distance_loss: 3.57059383392334
class_loss: 0.840176522731781, distance_loss: 3.6569607257843018
class_loss: 0.7542346119880676, distance_loss: 3.7411134243011475
class_loss: 0.7851040959358215, distance_loss: 3.8246166706085205
class_loss: 0.8272460103034973, distance_loss: 3.9042129516601562
class_loss: 0.8904728889465332, distance_loss: 3.9818646907806396
class_loss: 0.8045245409011841, distance_loss: 4.057170867919922
class_loss: 0.8392983078956604, distance_loss: 4.127723693847656
class_loss: 1.2080739736557007, distance_loss: 4.1914286613464355
___PoisonTrain Local_Simple ,  epoch  14, local model 13, internal_epoch   2,  Average loss: 0.0152, Accuracy: 394/734 (53.6785%), train_poison_data_count: 240
Global model norm: 16.439567174852396.
Norm before scaling: 16.612522117766503. Distance: 4.257939943978581
Total norm for 2 adversaries is: 16.612522117766503. distance: 4.257939943978581
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.3851, Accuracy: 4016/8968 (44.7814%)
___Train Local_Simple,  epoch  14, local model 99, internal_epoch   1,  Average loss: 0.0012, Accuracy: 366/377 (97.0822%)
___Train Local_Simple,  epoch  14, local model 99, internal_epoch   2,  Average loss: 0.0006, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1523, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch  14, local model 94, internal_epoch   1,  Average loss: 0.0016, Accuracy: 146/150 (97.3333%)
___Train Local_Simple,  epoch  14, local model 94, internal_epoch   2,  Average loss: 0.0004, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.4086, Accuracy: 8692/10000 (86.9200%)
___Train Local_Simple,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0015, Accuracy: 542/557 (97.3070%)
___Train Local_Simple,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 546/557 (98.0251%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2297, Accuracy: 9287/10000 (92.8700%)
poison local model 45 index 1
class_loss: 3.4643049240112305, distance_loss: 0.0
class_loss: 2.3821933269500732, distance_loss: 0.29621729254722595
class_loss: 1.2447123527526855, distance_loss: 0.7721750736236572
class_loss: 1.4312652349472046, distance_loss: 1.1795321702957153
class_loss: 1.3005818128585815, distance_loss: 1.5088449716567993
class_loss: 1.2336595058441162, distance_loss: 1.7939510345458984
class_loss: 1.2301424741744995, distance_loss: 2.0376222133636475
class_loss: 1.165024757385254, distance_loss: 2.2535696029663086
class_loss: 1.107641339302063, distance_loss: 2.449050188064575
class_loss: 0.994477391242981, distance_loss: 2.635822296142578
class_loss: 1.0174378156661987, distance_loss: 2.817657470703125
class_loss: 0.8930225968360901, distance_loss: 2.9915788173675537
class_loss: 0.756164014339447, distance_loss: 3.1537106037139893
class_loss: 0.8475233912467957, distance_loss: 3.3041059970855713
class_loss: 0.8300395607948303, distance_loss: 3.4369335174560547
class_loss: 0.7535631656646729, distance_loss: 3.551515579223633
class_loss: 0.7247621417045593, distance_loss: 3.652836322784424
class_loss: 0.9401612877845764, distance_loss: 3.7476580142974854
class_loss: 0.829571008682251, distance_loss: 3.8324215412139893
class_loss: 0.834692656993866, distance_loss: 3.9120726585388184
___PoisonTrain Local_Simple ,  epoch  14, local model 45, internal_epoch   1,  Average loss: 0.0248, Accuracy: 358/628 (57.0064%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  14, local model 45, internal_epoch   2,  Average loss: 0.0134, Accuracy: 378/628 (60.1911%), train_poison_data_count: 200
Global model norm: 16.439567174852396.
Norm before scaling: 16.524616720628405. Distance: 3.9888926307379675
Total norm for 2 adversaries is: 16.524616720628405. distance: 3.9888926307379675
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.0896, Accuracy: 4940/8968 (55.0847%)
___Train Local_Simple,  epoch  14, local model 44, internal_epoch   1,  Average loss: 0.0022, Accuracy: 500/517 (96.7118%)
___Train Local_Simple,  epoch  14, local model 44, internal_epoch   2,  Average loss: 0.0013, Accuracy: 500/517 (96.7118%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 45]
base_p: [-0.00078996  0.00035045 -0.00061122 ... -0.00119133 -0.00732102
 -0.00593942]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 8, 9]
layer1_inf_time: 4.73974609375
[PAIRWISE] pred_attackers_indx:  [4 8]
layer2_inf_t: 83.419677734375
assumed final_attacker_idxs:  [1 2 4 8 9]
final_attacker_idxs is: [1, 2, 4, 8, 9]
g_attacker_idxs: [92 95 13 45 44]
g_normal_idxs: [37 76 99 94 74]
filtered_attacker_idxs: [1, 2, 4, 8, 9]
final_attacker_idxs are: [1, 2, 4, 8, 9]
num_dps: [860, 937, 602, 78, 734, 377, 150, 557, 628, 517]
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2156, Accuracy: 9336/10000 (93.3600%)
time spent on training: 48.00986289978027
Starting performing KrMLRFL...
Num data points: [860, 937, 602, 78, 734, 377, 150, 557, 628, 517]
Num selected data points: [860  78 377 150 557]
The chosen ones are users: [0, 3, 5, 6, 7], which are global users: [37, 76, 99, 94, 74]
epoch_acc: 96.58
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1116, Accuracy: 9658/10000 (96.5800%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 9.5461, Accuracy: 116/8968 (1.2935%)
Done in 55.97019171714783 sec.
Server Epoch:15 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
___Train Local_Simple,  epoch  15, local model 60, internal_epoch   1,  Average loss: 0.0015, Accuracy: 326/338 (96.4497%)
___Train Local_Simple,  epoch  15, local model 60, internal_epoch   2,  Average loss: 0.0007, Accuracy: 334/338 (98.8166%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1605, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch  15, local model 49, internal_epoch   1,  Average loss: 0.0011, Accuracy: 494/506 (97.6285%)
___Train Local_Simple,  epoch  15, local model 49, internal_epoch   2,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2008, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch  15, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 362/371 (97.5741%)
___Train Local_Simple,  epoch  15, local model 65, internal_epoch   2,  Average loss: 0.0004, Accuracy: 368/371 (99.1914%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.4916, Accuracy: 8706/10000 (87.0600%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 370/376 (98.4043%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1373, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 982/1005 (97.7114%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   2,  Average loss: 0.0007, Accuracy: 993/1005 (98.8060%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2983, Accuracy: 9010/10000 (90.1000%)
___Train Local_Simple,  epoch  15, local model 24, internal_epoch   1,  Average loss: 0.0017, Accuracy: 362/379 (95.5145%)
___Train Local_Simple,  epoch  15, local model 24, internal_epoch   2,  Average loss: 0.0011, Accuracy: 370/379 (97.6253%)
class_loss: 2.155338764190674, distance_loss: 0.0
class_loss: 1.574064016342163, distance_loss: 0.2068294882774353
class_loss: 1.0202187299728394, distance_loss: 0.5480453372001648
class_loss: 0.7042215466499329, distance_loss: 0.8815269470214844
class_loss: 0.7829793691635132, distance_loss: 1.1619280576705933
class_loss: 1.0030103921890259, distance_loss: 1.398044466972351
class_loss: 0.9868588447570801, distance_loss: 1.606003999710083
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1929, Accuracy: 9387/10000 (93.8700%)
poison local model 7 index 0
___PoisonTrain Local_Simple ,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0197, Accuracy: 282/418 (67.4641%), train_poison_data_count: 140
class_loss: 0.7240248322486877, distance_loss: 1.8083902597427368
class_loss: 1.0611580610275269, distance_loss: 1.9867345094680786
class_loss: 0.7967102527618408, distance_loss: 2.1405651569366455
class_loss: 0.7308782935142517, distance_loss: 2.2788405418395996
class_loss: 0.78944331407547, distance_loss: 2.404043436050415
class_loss: 0.7980542778968811, distance_loss: 2.5120270252227783
class_loss: 0.46615609526634216, distance_loss: 2.605583429336548
___PoisonTrain Local_Simple ,  epoch  15, local model 7, internal_epoch   2,  Average loss: 0.0128, Accuracy: 295/418 (70.5742%), train_poison_data_count: 140
Global model norm: 16.426897349863996.
Norm before scaling: 16.372058866356348. Distance: 2.701393410734191
Total norm for 1 adversaries is: 16.372058866356348. distance: 2.701393410734191
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.2591, Accuracy: 8069/8968 (89.9755%)
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 644/658 (97.8723%)
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0012, Accuracy: 637/658 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3699, Accuracy: 8889/10000 (88.8900%)
___Train Local_Simple,  epoch  15, local model 76, internal_epoch   1,  Average loss: 0.0008, Accuracy: 77/78 (98.7179%)
___Train Local_Simple,  epoch  15, local model 76, internal_epoch   2,  Average loss: 0.0003, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1199, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch  15, local model 39, internal_epoch   1,  Average loss: 0.0013, Accuracy: 253/257 (98.4436%)
___Train Local_Simple,  epoch  15, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 256/257 (99.6109%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7]
base_p: [-0.00193913  0.00033284  0.00139051 ... -0.00140414 -0.00040525
 -0.00344852]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 5, 6, 7]
layer1_inf_time: 4.22412109375
[PAIRWISE] pred_attackers_indx:  [6]
layer2_inf_t: 33.104248046875
assumed final_attacker_idxs:  [0 1 3 4 5 6 7]
final_attacker_idxs is: [0, 1, 3, 4, 5, 6, 7]
g_attacker_idxs: [60 49 14 36 24  7  4]
g_normal_idxs: [65 76 39]
filtered_attacker_idxs: [0, 1, 3, 4, 5, 6, 7]
final_attacker_idxs are: [0, 1, 3, 4, 5, 6, 7]
num_dps: [338, 506, 371, 376, 1005, 379, 418, 658, 78, 257]
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1519, Accuracy: 9512/10000 (95.1200%)
time spent on training: 39.54408073425293
Starting performing KrMLRFL...
Num data points: [338, 506, 371, 376, 1005, 379, 418, 658, 78, 257]
Num selected data points: [371  78 257]
The chosen ones are users: [2, 8, 9], which are global users: [65, 76, 39]
epoch_acc: 95.76
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1284, Accuracy: 9576/10000 (95.7600%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 11.5454, Accuracy: 17/8968 (0.1896%)
Done in 46.56474494934082 sec.
Server Epoch:16 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 0
class_loss: 1.7824242115020752, distance_loss: 0.0
class_loss: 2.3508646488189697, distance_loss: 0.16146467626094818
class_loss: 1.1686203479766846, distance_loss: 0.4385368227958679
class_loss: 1.0329272747039795, distance_loss: 0.7933480143547058
class_loss: 0.8166713118553162, distance_loss: 1.1727665662765503
class_loss: 1.0276336669921875, distance_loss: 1.495642900466919
class_loss: 1.079472541809082, distance_loss: 1.7615793943405151
class_loss: 1.0040031671524048, distance_loss: 1.9885507822036743
class_loss: 1.0153287649154663, distance_loss: 2.1859383583068848
class_loss: 0.9857078790664673, distance_loss: 2.3614468574523926
class_loss: 0.8334973454475403, distance_loss: 2.5107812881469727
class_loss: 1.0204012393951416, distance_loss: 2.6452488899230957
class_loss: 0.802638828754425, distance_loss: 2.764881134033203
class_loss: 0.8051165342330933, distance_loss: 2.86904239654541
class_loss: 0.7095842957496643, distance_loss: 2.961327314376831
class_loss: 0.8702206611633301, distance_loss: 3.04632306098938
class_loss: 0.7233915328979492, distance_loss: 3.1249279975891113
class_loss: 0.6658372282981873, distance_loss: 3.1964786052703857
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0204, Accuracy: 385/554 (69.4946%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0134, Accuracy: 336/554 (60.6498%), train_poison_data_count: 180
Global model norm: 16.4262963467095.
Norm before scaling: 16.398881343743295. Distance: 3.266980925514531
Total norm for 2 adversaries is: 16.398881343743295. distance: 3.266980925514531
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.2136, Accuracy: 4608/8968 (51.3827%)
___Train Local_Simple,  epoch  16, local model 29, internal_epoch   1,  Average loss: 0.0013, Accuracy: 978/1002 (97.6048%)
___Train Local_Simple,  epoch  16, local model 29, internal_epoch   2,  Average loss: 0.0007, Accuracy: 986/1002 (98.4032%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5867, Accuracy: 8234/10000 (82.3400%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0017, Accuracy: 634/658 (96.3526%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   2,  Average loss: 0.0007, Accuracy: 651/658 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5160, Accuracy: 8679/10000 (86.7900%)
___Train Local_Simple,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0016, Accuracy: 587/606 (96.8647%)
___Train Local_Simple,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3924, Accuracy: 8884/10000 (88.8400%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0015, Accuracy: 369/377 (97.8780%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   2,  Average loss: 0.0008, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3190, Accuracy: 9009/10000 (90.0900%)
___Train Local_Simple,  epoch  16, local model 67, internal_epoch   1,  Average loss: 0.0019, Accuracy: 963/998 (96.4930%)
___Train Local_Simple,  epoch  16, local model 67, internal_epoch   2,  Average loss: 0.0009, Accuracy: 976/998 (97.7956%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.8569, Accuracy: 7874/10000 (78.7400%)
poison local model 91 index 1
class_loss: 3.491995096206665, distance_loss: 0.0
class_loss: 1.8481690883636475, distance_loss: 0.3006066381931305
class_loss: 1.4781066179275513, distance_loss: 0.7483894228935242
class_loss: 1.7460007667541504, distance_loss: 1.1571440696716309
class_loss: 1.5749996900558472, distance_loss: 1.5269514322280884
class_loss: 1.3621394634246826, distance_loss: 1.8380874395370483
class_loss: 1.5487722158432007, distance_loss: 2.120864152908325
class_loss: 1.3818433284759521, distance_loss: 2.3861448764801025
___PoisonTrain Local_Simple ,  epoch  16, local model 91, internal_epoch   1,  Average loss: 0.0335, Accuracy: 149/256 (58.2031%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  16, local model 91, internal_epoch   2,  Average loss: 0.0229, Accuracy: 105/256 (41.0156%), train_poison_data_count: 80
Global model norm: 16.4262963467095.
Norm before scaling: 16.269351645917414. Distance: 2.6300287670114213
Total norm for 2 adversaries is: 16.269351645917414. distance: 2.6300287670114213
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.1258, Accuracy: 6608/8968 (73.6842%)
___Train Local_Simple,  epoch  16, local model 76, internal_epoch   1,  Average loss: 0.0040, Accuracy: 76/78 (97.4359%)
___Train Local_Simple,  epoch  16, local model 76, internal_epoch   2,  Average loss: 0.0003, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3577, Accuracy: 8895/10000 (88.9500%)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0022, Accuracy: 600/633 (94.7867%)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0014, Accuracy: 612/633 (96.6825%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2872, Accuracy: 9007/10000 (90.0700%)
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0019, Accuracy: 622/647 (96.1360%)
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 639/647 (98.7635%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 91]
base_p: [-0.00240326  0.00043945 -0.00286972 ... -0.00236835 -0.00512412
 -0.00394738]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6]
layer1_inf_time: 4.299072265625
[PAIRWISE] pred_attackers_indx:  [0 6]
layer2_inf_t: 65.131103515625
assumed final_attacker_idxs:  [0 1 2 5 6]
final_attacker_idxs is: [0, 1, 2, 5, 6]
g_attacker_idxs: [26 29  4 67 91]
g_normal_idxs: [41 99 76  8 25]
filtered_attacker_idxs: [0, 1, 2, 5, 6]
final_attacker_idxs are: [0, 1, 2, 5, 6]
num_dps: [554, 1002, 658, 606, 377, 998, 256, 78, 633, 647]
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3043, Accuracy: 9038/10000 (90.3800%)
time spent on training: 46.8264594078064
Starting performing KrMLRFL...
Num data points: [554, 1002, 658, 606, 377, 998, 256, 78, 633, 647]
Num selected data points: [606 377  78 633 647]
The chosen ones are users: [3, 4, 7, 8, 9], which are global users: [41, 99, 76, 8, 25]
epoch_acc: 96.16
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1179, Accuracy: 9616/10000 (96.1600%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 9.6536, Accuracy: 152/8968 (1.6949%)
Done in 54.40567970275879 sec.
Server Epoch:17 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0011, Accuracy: 645/660 (97.7273%)
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   2,  Average loss: 0.0008, Accuracy: 651/660 (98.6364%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0559, Accuracy: 7338/10000 (73.3800%)
___Train Local_Simple,  epoch  17, local model 68, internal_epoch   1,  Average loss: 0.0011, Accuracy: 482/494 (97.5709%)
___Train Local_Simple,  epoch  17, local model 68, internal_epoch   2,  Average loss: 0.0006, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1519, Accuracy: 9516/10000 (95.1600%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 728/760 (95.7895%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 749/760 (98.5526%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2766, Accuracy: 9097/10000 (90.9700%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 417/423 (98.5816%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   2,  Average loss: 0.0006, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1623, Accuracy: 9492/10000 (94.9200%)
___Train Local_Simple,  epoch  17, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 813/835 (97.3653%)
___Train Local_Simple,  epoch  17, local model 31, internal_epoch   2,  Average loss: 0.0007, Accuracy: 828/835 (99.1617%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.2632, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0013, Accuracy: 866/892 (97.0852%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0010, Accuracy: 881/892 (98.7668%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3092, Accuracy: 8954/10000 (89.5400%)
___Train Local_Simple,  epoch  17, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Train Local_Simple,  epoch  17, local model 23, internal_epoch   2,  Average loss: 0.0003, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1397, Accuracy: 9550/10000 (95.5000%)
poison local model 7 index 0
class_loss: 2.1272192001342773, distance_loss: 0.0
class_loss: 1.9030532836914062, distance_loss: 0.20714659988880157
class_loss: 0.9334993958473206, distance_loss: 0.554625928401947
class_loss: 1.3267261981964111, distance_loss: 0.9350116848945618
class_loss: 1.7835520505905151, distance_loss: 1.2418338060379028
class_loss: 1.125969648361206, distance_loss: 1.495228886604309
class_loss: 1.0352455377578735, distance_loss: 1.739932656288147
class_loss: 1.2299596071243286, distance_loss: 1.974705696105957
class_loss: 1.1248588562011719, distance_loss: 2.17618465423584
class_loss: 1.1392526626586914, distance_loss: 2.345081329345703
class_loss: 0.9887790679931641, distance_loss: 2.490266799926758
class_loss: 1.1688146591186523, distance_loss: 2.6219422817230225
class_loss: 1.0018949508666992, distance_loss: 2.7410576343536377
class_loss: 0.9882515072822571, distance_loss: 2.8488430976867676
___PoisonTrain Local_Simple ,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0245, Accuracy: 260/418 (62.2010%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  17, local model 7, internal_epoch   2,  Average loss: 0.0183, Accuracy: 242/418 (57.8947%), train_poison_data_count: 140
Global model norm: 16.428231182484506.
Norm before scaling: 16.349360070260587. Distance: 2.9572437769358118
Total norm for 2 adversaries is: 16.349360070260587. distance: 2.9572437769358118
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.6300, Accuracy: 7265/8968 (81.0103%)
___Train Local_Simple,  epoch  17, local model 99, internal_epoch   1,  Average loss: 0.0009, Accuracy: 373/377 (98.9390%)
___Train Local_Simple,  epoch  17, local model 99, internal_epoch   2,  Average loss: 0.0005, Accuracy: 374/377 (99.2042%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1195, Accuracy: 9638/10000 (96.3800%)
poison local model 45 index 1
class_loss: 2.761392593383789, distance_loss: 0.0
class_loss: 1.6983535289764404, distance_loss: 0.26817256212234497
class_loss: 1.0892471075057983, distance_loss: 0.6884719729423523
class_loss: 1.4508213996887207, distance_loss: 1.0832288265228271
class_loss: 1.500564694404602, distance_loss: 1.3583061695098877
class_loss: 1.5058766603469849, distance_loss: 1.5821943283081055
class_loss: 1.3918366432189941, distance_loss: 1.8062429428100586
class_loss: 1.2003087997436523, distance_loss: 2.0158355236053467
class_loss: 1.2623274326324463, distance_loss: 2.2048327922821045
class_loss: 1.1502002477645874, distance_loss: 2.377748966217041
class_loss: 1.0650612115859985, distance_loss: 2.545501470565796
class_loss: 0.9040077328681946, distance_loss: 2.708918571472168
class_loss: 0.9196860194206238, distance_loss: 2.868791341781616
class_loss: 0.9176667928695679, distance_loss: 3.0217628479003906
class_loss: 1.0746979713439941, distance_loss: 3.163944959640503
class_loss: 1.056762933731079, distance_loss: 3.2919344902038574
class_loss: 0.8628101944923401, distance_loss: 3.4037060737609863
class_loss: 0.6982767581939697, distance_loss: 3.5040948390960693
class_loss: 0.8657550811767578, distance_loss: 3.596266984939575
class_loss: 0.8162645697593689, distance_loss: 3.6822738647460938
___PoisonTrain Local_Simple ,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0239, Accuracy: 343/628 (54.6178%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  17, local model 45, internal_epoch   2,  Average loss: 0.0146, Accuracy: 367/628 (58.4395%), train_poison_data_count: 200
Global model norm: 16.428231182484506.
Norm before scaling: 16.50159053650208. Distance: 3.7660013224497626
Total norm for 2 adversaries is: 16.50159053650208. distance: 3.7660013224497626
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.9309, Accuracy: 5016/8968 (55.9322%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 45]
base_p: [ 0.00288257  0.00030342 -0.00282486 ... -0.00297008  0.00275703
 -0.00199195]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 7, 9]
layer1_inf_time: 2.628662109375
[PAIRWISE] pred_attackers_indx:  [7 9]
layer2_inf_t: 32.751953125
assumed final_attacker_idxs:  [0 2 5 7 9]
final_attacker_idxs is: [0, 2, 5, 7, 9]
g_attacker_idxs: [66 59 10  7 45]
g_normal_idxs: [68 62 31 23 99]
filtered_attacker_idxs: [0, 2, 5, 7, 9]
final_attacker_idxs are: [0, 2, 5, 7, 9]
num_dps: [660, 494, 760, 423, 835, 892, 293, 418, 377, 628]
time spent on training: 46.72536778450012
Starting performing KrMLRFL...
Num data points: [660, 494, 760, 423, 835, 892, 293, 418, 377, 628]
Num selected data points: [494 423 835 293 377]
The chosen ones are users: [1, 3, 4, 6, 8], which are global users: [68, 62, 31, 23, 99]
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.0902, Accuracy: 9697/10000 (96.9700%)
epoch_acc: 96.97
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 13.2684, Accuracy: 38/8968 (0.4237%)
Done in 51.9819712638855 sec.
Server Epoch:18 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
poison local model 63 index 0
class_loss: 3.91821026802063, distance_loss: 0.0
class_loss: 2.2269017696380615, distance_loss: 0.323751837015152
class_loss: 0.8831902146339417, distance_loss: 0.797317385673523
class_loss: 1.090545892715454, distance_loss: 1.2965284585952759
class_loss: 1.376094102859497, distance_loss: 1.6676994562149048
class_loss: 1.5748275518417358, distance_loss: 1.9693902730941772
class_loss: 1.1572622060775757, distance_loss: 2.2453691959381104
class_loss: 1.216168761253357, distance_loss: 2.4991438388824463
class_loss: 1.253456950187683, distance_loss: 2.733250379562378
class_loss: 1.1995935440063477, distance_loss: 2.94744610786438
class_loss: 1.009470820426941, distance_loss: 3.1460931301116943
class_loss: 0.9881222248077393, distance_loss: 3.331066370010376
class_loss: 1.164084553718567, distance_loss: 3.5052390098571777
class_loss: 0.8886934518814087, distance_loss: 3.670858860015869
___PoisonTrain Local_Simple ,  epoch  18, local model 63, internal_epoch   1,  Average loss: 0.0224, Accuracy: 520/889 (58.4927%), train_poison_data_count: 280
class_loss: 0.6870840787887573, distance_loss: 3.829608678817749
class_loss: 0.541869044303894, distance_loss: 3.983602285385132
class_loss: 0.5212977528572083, distance_loss: 4.131221294403076
class_loss: 0.5718212723731995, distance_loss: 4.2686357498168945
class_loss: 0.3639522194862366, distance_loss: 4.3992695808410645
class_loss: 0.41065195202827454, distance_loss: 4.519163131713867
class_loss: 0.25133731961250305, distance_loss: 4.633984088897705
class_loss: 0.2917782962322235, distance_loss: 4.741491794586182
class_loss: 0.23064947128295898, distance_loss: 4.838722229003906
class_loss: 0.19100317358970642, distance_loss: 4.925459861755371
class_loss: 0.257830947637558, distance_loss: 5.005672931671143
class_loss: 0.2665769159793854, distance_loss: 5.078893184661865
class_loss: 0.13890549540519714, distance_loss: 5.147697925567627
class_loss: 0.1816158890724182, distance_loss: 5.212709903717041
___PoisonTrain Local_Simple ,  epoch  18, local model 63, internal_epoch   2,  Average loss: 0.0055, Accuracy: 787/889 (88.5264%), train_poison_data_count: 280
Global model norm: 16.43559132216955.
Norm before scaling: 16.970242654192884. Distance: 5.277051351424976
Total norm for 1 adversaries is: 16.970242654192884. distance: 5.277051351424976
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.1105, Accuracy: 8670/8968 (96.6771%)
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0019, Accuracy: 346/354 (97.7401%)
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   2,  Average loss: 0.0005, Accuracy: 351/354 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7084, Accuracy: 7795/10000 (77.9500%)
___Train Local_Simple,  epoch  18, local model 79, internal_epoch   1,  Average loss: 0.0017, Accuracy: 174/182 (95.6044%)
___Train Local_Simple,  epoch  18, local model 79, internal_epoch   2,  Average loss: 0.0005, Accuracy: 181/182 (99.4505%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1484, Accuracy: 9544/10000 (95.4400%)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0013, Accuracy: 422/436 (96.7890%)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   2,  Average loss: 0.0005, Accuracy: 432/436 (99.0826%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3377, Accuracy: 9033/10000 (90.3300%)
___Train Local_Simple,  epoch  18, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 419/423 (99.0544%)
___Train Local_Simple,  epoch  18, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0934, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  18, local model 56, internal_epoch   1,  Average loss: 0.0014, Accuracy: 860/880 (97.7273%)
___Train Local_Simple,  epoch  18, local model 56, internal_epoch   2,  Average loss: 0.0008, Accuracy: 865/880 (98.2955%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1399, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch  18, local model 96, internal_epoch   1,  Average loss: 0.0015, Accuracy: 658/672 (97.9167%)
___Train Local_Simple,  epoch  18, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 667/672 (99.2560%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3054, Accuracy: 9080/10000 (90.8000%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1131/1160 (97.5000%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1147/1160 (98.8793%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2357, Accuracy: 9385/10000 (93.8500%)
___Train Local_Simple,  epoch  18, local model 92, internal_epoch   1,  Average loss: 0.0012, Accuracy: 915/937 (97.6521%)
___Train Local_Simple,  epoch  18, local model 92, internal_epoch   2,  Average loss: 0.0007, Accuracy: 929/937 (99.1462%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4559, Accuracy: 8489/10000 (84.8900%)
___Train Local_Simple,  epoch  18, local model 86, internal_epoch   1,  Average loss: 0.0014, Accuracy: 244/250 (97.6000%)
___Train Local_Simple,  epoch  18, local model 86, internal_epoch   2,  Average loss: 0.0004, Accuracy: 249/250 (99.6000%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2222, Accuracy: 9274/10000 (92.7400%)
time spent on training: 41.98855209350586
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63]
base_p: [-0.00194448  0.00087506  0.00291042 ... -0.00083262 -0.01121368
 -0.00615095]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 7, 8]
layer1_inf_time: 3.90478515625
[PAIRWISE] pred_attackers_indx:  [0]
layer2_inf_t: 69.083984375
assumed final_attacker_idxs:  [0 5 6 7 8]
final_attacker_idxs is: [0, 5, 6, 7, 8]
g_attacker_idxs: [63 56 96 12 92]
g_normal_idxs: [55 79  9 62 86]
filtered_attacker_idxs: [0, 5, 6, 7, 8]
final_attacker_idxs are: [0, 5, 6, 7, 8]
num_dps: [889, 354, 182, 436, 423, 880, 672, 1160, 937, 250]
epoch_acc: 97.11
Starting performing KrMLRFL...
Num data points: [889, 354, 182, 436, 423, 880, 672, 1160, 937, 250]
Num selected data points: [354 182 436 423 250]
The chosen ones are users: [1, 2, 3, 4, 9], which are global users: [55, 79, 9, 62, 86]
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0851, Accuracy: 9711/10000 (97.1100%)
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 11.5951, Accuracy: 44/8968 (0.4906%)
Done in 48.00655150413513 sec.
Server Epoch:19 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0009, Accuracy: 492/501 (98.2036%)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0003, Accuracy: 500/501 (99.8004%)
class_loss: 3.4843037128448486, distance_loss: 0.0
class_loss: 2.299995183944702, distance_loss: 0.3172879219055176
class_loss: 1.4688122272491455, distance_loss: 0.8556148409843445
class_loss: 1.2117191553115845, distance_loss: 1.2533116340637207
class_loss: 1.3050979375839233, distance_loss: 1.5684188604354858
class_loss: 1.4617325067520142, distance_loss: 1.8582874536514282
class_loss: 1.3789085149765015, distance_loss: 2.125861883163452
class_loss: 1.2095626592636108, distance_loss: 2.366224765777588
class_loss: 1.1666451692581177, distance_loss: 2.579897880554199
class_loss: 1.1624714136123657, distance_loss: 2.7778584957122803
class_loss: 1.1119686365127563, distance_loss: 2.9642724990844727
class_loss: 1.213643193244934, distance_loss: 3.137882947921753
class_loss: 0.9608688354492188, distance_loss: 3.294682741165161
class_loss: 0.9304898977279663, distance_loss: 3.435792922973633
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0987, Accuracy: 9679/10000 (96.7900%)
poison local model 63 index 0
___PoisonTrain Local_Simple ,  epoch  19, local model 63, internal_epoch   1,  Average loss: 0.0229, Accuracy: 471/889 (52.9809%), train_poison_data_count: 280
class_loss: 1.022746205329895, distance_loss: 3.568202018737793
class_loss: 0.8550195693969727, distance_loss: 3.68769907951355
class_loss: 0.8662233948707581, distance_loss: 3.796543598175049
class_loss: 0.9101943969726562, distance_loss: 3.8964710235595703
class_loss: 1.0092297792434692, distance_loss: 3.988344430923462
class_loss: 0.7885593175888062, distance_loss: 4.075404167175293
class_loss: 0.6850310564041138, distance_loss: 4.157937526702881
class_loss: 0.8761451244354248, distance_loss: 4.232485771179199
class_loss: 0.873781144618988, distance_loss: 4.298577785491943
class_loss: 0.9462881684303284, distance_loss: 4.356058120727539
class_loss: 0.8482561707496643, distance_loss: 4.405919075012207
class_loss: 0.7899255752563477, distance_loss: 4.451541423797607
class_loss: 0.6899293661117554, distance_loss: 4.4965996742248535
class_loss: 0.9253951907157898, distance_loss: 4.5409464836120605
___PoisonTrain Local_Simple ,  epoch  19, local model 63, internal_epoch   2,  Average loss: 0.0136, Accuracy: 533/889 (59.9550%), train_poison_data_count: 280
Global model norm: 16.406172804877915.
Norm before scaling: 16.67244060954803. Distance: 4.581580202450816
Total norm for 3 adversaries is: 16.67244060954803. distance: 4.581580202450816
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.3153, Accuracy: 2764/8968 (30.8207%)
___Train Local_Simple,  epoch  19, local model 33, internal_epoch   1,  Average loss: 0.0023, Accuracy: 602/623 (96.6292%)
___Train Local_Simple,  epoch  19, local model 33, internal_epoch   2,  Average loss: 0.0021, Accuracy: 597/623 (95.8266%)
class_loss: 3.74170184135437, distance_loss: 0.0
class_loss: 2.026174545288086, distance_loss: 0.3637235164642334
class_loss: 1.6395090818405151, distance_loss: 0.8191287517547607
class_loss: 1.6684633493423462, distance_loss: 1.1324447393417358
class_loss: 1.1715337038040161, distance_loss: 1.393352746963501
class_loss: 1.0840623378753662, distance_loss: 1.6415764093399048
class_loss: 1.0793572664260864, distance_loss: 1.8794231414794922
class_loss: 0.9299060702323914, distance_loss: 2.1025028228759766
class_loss: 1.0019590854644775, distance_loss: 2.313955068588257
class_loss: 0.8475632667541504, distance_loss: 2.5186612606048584
class_loss: 0.8551139831542969, distance_loss: 2.7101526260375977
class_loss: 0.8005059957504272, distance_loss: 2.892265796661377
class_loss: 0.9459572434425354, distance_loss: 3.0562868118286133
class_loss: 0.7353441119194031, distance_loss: 3.1961731910705566
class_loss: 0.9759837985038757, distance_loss: 3.32437801361084
class_loss: 1.00567626953125, distance_loss: 3.4395463466644287
class_loss: 0.9898371696472168, distance_loss: 3.5463578701019287
class_loss: 0.7973800897598267, distance_loss: 3.647005558013916
class_loss: 0.8680700063705444, distance_loss: 3.742370843887329
class_loss: 0.7721258997917175, distance_loss: 3.8305187225341797
class_loss: 0.7621588110923767, distance_loss: 3.911130428314209
class_loss: 0.8244885206222534, distance_loss: 3.983704090118408
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2301, Accuracy: 9181/10000 (91.8100%)
poison local model 71 index 1
___PoisonTrain Local_Simple ,  epoch  19, local model 71, internal_epoch   1,  Average loss: 0.0184, Accuracy: 777/1384 (56.1416%), train_poison_data_count: 440
class_loss: 0.8387618660926819, distance_loss: 4.052708148956299
class_loss: 0.725834310054779, distance_loss: 4.112508773803711
class_loss: 0.6315366625785828, distance_loss: 4.163776397705078
class_loss: 0.7703027725219727, distance_loss: 4.208690166473389
class_loss: 0.580229640007019, distance_loss: 4.248170375823975
class_loss: 0.7671765685081482, distance_loss: 4.284405708312988
class_loss: 0.7263648509979248, distance_loss: 4.320615768432617
class_loss: 0.6572546362876892, distance_loss: 4.355258941650391
class_loss: 0.8172992467880249, distance_loss: 4.388866424560547
class_loss: 0.6964069604873657, distance_loss: 4.423940658569336
class_loss: 0.6534935235977173, distance_loss: 4.459431171417236
class_loss: 0.5132399797439575, distance_loss: 4.499116897583008
class_loss: 0.49078911542892456, distance_loss: 4.545304775238037
class_loss: 0.46683770418167114, distance_loss: 4.593308925628662
class_loss: 0.2513630986213684, distance_loss: 4.645869255065918
class_loss: 0.3862214982509613, distance_loss: 4.702105522155762
class_loss: 0.235708087682724, distance_loss: 4.760234355926514
class_loss: 0.15220709145069122, distance_loss: 4.817344665527344
class_loss: 0.2777542471885681, distance_loss: 4.873422622680664
class_loss: 0.28500205278396606, distance_loss: 4.9276509284973145
class_loss: 0.18877552449703217, distance_loss: 4.9872307777404785
class_loss: 0.0843314528465271, distance_loss: 5.04593563079834
___PoisonTrain Local_Simple ,  epoch  19, local model 71, internal_epoch   2,  Average loss: 0.0081, Accuracy: 1063/1384 (76.8064%), train_poison_data_count: 440
Global model norm: 16.406172804877915.
Norm before scaling: 16.849291397725565. Distance: 5.10781304519011
Total norm for 3 adversaries is: 16.849291397725565. distance: 5.10781304519011
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0587, Accuracy: 8722/8968 (97.2569%)
poison local model 13 index 2
class_loss: 3.8314013481140137, distance_loss: 0.0
class_loss: 2.0783920288085938, distance_loss: 0.3287566006183624
class_loss: 1.9767367839813232, distance_loss: 0.8450666666030884
class_loss: 1.793188214302063, distance_loss: 1.256404995918274
class_loss: 1.453094244003296, distance_loss: 1.6583044528961182
class_loss: 1.386589765548706, distance_loss: 2.0279881954193115
class_loss: 1.3535345792770386, distance_loss: 2.364605188369751
class_loss: 1.315213680267334, distance_loss: 2.6743319034576416
class_loss: 1.461172103881836, distance_loss: 2.954648971557617
class_loss: 1.0247048139572144, distance_loss: 3.203155040740967
class_loss: 1.0160257816314697, distance_loss: 3.4310739040374756
class_loss: 0.9141256809234619, distance_loss: 3.6415648460388184
class_loss: 1.1089527606964111, distance_loss: 3.84283185005188
class_loss: 0.9879961013793945, distance_loss: 4.020555019378662
class_loss: 0.9168124794960022, distance_loss: 4.1750407218933105
class_loss: 0.9554167985916138, distance_loss: 4.314273357391357
class_loss: 1.0888392925262451, distance_loss: 4.442786693572998
class_loss: 1.0929124355316162, distance_loss: 4.557233810424805
class_loss: 0.8211190700531006, distance_loss: 4.661242961883545
class_loss: 0.8321474194526672, distance_loss: 4.760263442993164
class_loss: 0.8370898962020874, distance_loss: 4.852452278137207
class_loss: 0.8736656308174133, distance_loss: 4.93612813949585
class_loss: 0.8721959590911865, distance_loss: 5.01320219039917
class_loss: 1.2941359281539917, distance_loss: 5.084469318389893
___PoisonTrain Local_Simple ,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0267, Accuracy: 369/734 (50.2725%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  19, local model 13, internal_epoch   2,  Average loss: 0.0159, Accuracy: 380/734 (51.7711%), train_poison_data_count: 240
Global model norm: 16.406172804877915.
Norm before scaling: 16.670374851966532. Distance: 5.155137375519069
Total norm for 3 adversaries is: 16.670374851966532. distance: 5.155137375519069
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.8609, Accuracy: 5590/8968 (62.3327%)
___Train Local_Simple,  epoch  19, local model 32, internal_epoch   1,  Average loss: 0.0020, Accuracy: 940/977 (96.2129%)
___Train Local_Simple,  epoch  19, local model 32, internal_epoch   2,  Average loss: 0.0011, Accuracy: 958/977 (98.0553%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2049, Accuracy: 9392/10000 (93.9200%)
___Train Local_Simple,  epoch  19, local model 76, internal_epoch   1,  Average loss: 0.0015, Accuracy: 76/78 (97.4359%)
___Train Local_Simple,  epoch  19, local model 76, internal_epoch   2,  Average loss: 0.0004, Accuracy: 77/78 (98.7179%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0823, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch  19, local model 97, internal_epoch   1,  Average loss: 0.0010, Accuracy: 478/487 (98.1520%)
___Train Local_Simple,  epoch  19, local model 97, internal_epoch   2,  Average loss: 0.0005, Accuracy: 483/487 (99.1786%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.4271, Accuracy: 8913/10000 (89.1300%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   2,  Average loss: 0.0005, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1700, Accuracy: 9458/10000 (94.5800%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0007, Accuracy: 634/647 (97.9907%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0004, Accuracy: 643/647 (99.3818%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 71, 13]
base_p: [-0.00234553  0.00045626  0.00281988 ... -0.00239551 -0.01413435
 -0.00157135]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 9]
layer1_inf_time: 2.88330078125
[PAIRWISE] pred_attackers_indx:  [1 3 4]
layer2_inf_t: 29.83349609375
assumed final_attacker_idxs:  [1 3 4 5 9]
final_attacker_idxs is: [1, 3, 4, 5, 9]
g_attacker_idxs: [63 71 13 32 25]
g_normal_idxs: [28 33 76 97 23]
filtered_attacker_idxs: [1, 3, 4, 5, 9]
final_attacker_idxs are: [1, 3, 4, 5, 9]
num_dps: [501, 889, 623, 1384, 734, 977, 78, 487, 293, 647]
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2378, Accuracy: 9283/10000 (92.8300%)
time spent on training: 57.43615794181824
Starting performing KrMLRFL...
Num data points: [501, 889, 623, 1384, 734, 977, 78, 487, 293, 647]
Num selected data points: [501 623  78 487 293]
The chosen ones are users: [0, 2, 6, 7, 8], which are global users: [28, 33, 76, 97, 23]
epoch_acc: 97.09
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0861, Accuracy: 9709/10000 (97.0900%)
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 12.0838, Accuracy: 10/8968 (0.1115%)
Done in 64.42422223091125 sec.
Server Epoch:20 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1131/1160 (97.5000%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   2,  Average loss: 0.0027, Accuracy: 1100/1160 (94.8276%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.3034, Accuracy: 9164/10000 (91.6400%)
___Train Local_Simple,  epoch  20, local model 56, internal_epoch   1,  Average loss: 0.0009, Accuracy: 865/880 (98.2955%)
___Train Local_Simple,  epoch  20, local model 56, internal_epoch   2,  Average loss: 0.0006, Accuracy: 870/880 (98.8636%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1922, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch  20, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch  20, local model 19, internal_epoch   2,  Average loss: 0.0002, Accuracy: 204/205 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1235, Accuracy: 9603/10000 (96.0300%)
poison local model 11 index 0
class_loss: 4.347886562347412, distance_loss: 0.0
class_loss: 2.688978910446167, distance_loss: 0.3364136219024658
class_loss: 1.5578722953796387, distance_loss: 0.844470739364624
class_loss: 1.2513196468353271, distance_loss: 1.3579511642456055
class_loss: 1.5366032123565674, distance_loss: 1.7965898513793945
class_loss: 1.651601791381836, distance_loss: 2.1609997749328613
class_loss: 1.7516388893127441, distance_loss: 2.474152088165283
class_loss: 1.694061040878296, distance_loss: 2.746782064437866
class_loss: 1.603201985359192, distance_loss: 2.983346700668335
class_loss: 1.5736387968063354, distance_loss: 3.1906049251556396
class_loss: 0.7033885717391968, distance_loss: 3.37351131439209
class_loss: 1.4520362615585327, distance_loss: 3.5529837608337402
class_loss: 1.5576759576797485, distance_loss: 3.706284523010254
class_loss: 1.525188684463501, distance_loss: 3.8342692852020264
class_loss: 1.3333185911178589, distance_loss: 3.9430248737335205
class_loss: 1.0333359241485596, distance_loss: 4.043252944946289
class_loss: 1.1698663234710693, distance_loss: 4.140609264373779
class_loss: 0.959408164024353, distance_loss: 4.2328104972839355
class_loss: 1.0252147912979126, distance_loss: 4.323699951171875
class_loss: 1.1584054231643677, distance_loss: 4.41181755065918
class_loss: 0.9960272312164307, distance_loss: 4.500517845153809
class_loss: 1.2976140975952148, distance_loss: 4.590732097625732
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0316, Accuracy: 291/645 (45.1163%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0209, Accuracy: 301/645 (46.6667%), train_poison_data_count: 205
Global model norm: 16.385174334998126.
Norm before scaling: 16.565589702966545. Distance: 4.70196985398806
Total norm for 3 adversaries is: 16.565589702966545. distance: 4.70196985398806
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.9484, Accuracy: 4917/8968 (54.8283%)
class_loss: 3.6776981353759766, distance_loss: 0.0
class_loss: 3.041471004486084, distance_loss: 0.3074391484260559
class_loss: 1.3743901252746582, distance_loss: 0.8127254247665405
class_loss: 1.3955798149108887, distance_loss: 1.2764726877212524
class_loss: 1.607650637626648, distance_loss: 1.6869593858718872
class_loss: 1.4865168333053589, distance_loss: 2.0423080921173096
class_loss: 1.3887150287628174, distance_loss: 2.359362840652466
class_loss: 1.2542935609817505, distance_loss: 2.6489837169647217
class_loss: 1.0232679843902588, distance_loss: 2.9117660522460938
class_loss: 1.1965055465698242, distance_loss: 3.15777587890625
class_loss: 1.1905142068862915, distance_loss: 3.377448797225952
class_loss: 1.2111989259719849, distance_loss: 3.56412410736084
poison local model 13 index 1
___PoisonTrain Local_Simple ,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0270, Accuracy: 385/734 (52.4523%), train_poison_data_count: 240
class_loss: 1.1619588136672974, distance_loss: 3.736400604248047
class_loss: 1.1980271339416504, distance_loss: 3.8971662521362305
class_loss: 1.2127243280410767, distance_loss: 4.039769649505615
class_loss: 1.1632276773452759, distance_loss: 4.163209438323975
class_loss: 1.045478105545044, distance_loss: 4.271069526672363
class_loss: 1.0841631889343262, distance_loss: 4.368109703063965
class_loss: 0.9012266993522644, distance_loss: 4.458828449249268
class_loss: 1.0282490253448486, distance_loss: 4.5455851554870605
class_loss: 1.097965121269226, distance_loss: 4.627081394195557
class_loss: 0.9867954254150391, distance_loss: 4.701424598693848
class_loss: 0.8467399477958679, distance_loss: 4.770244121551514
class_loss: 1.1792088747024536, distance_loss: 4.832784652709961
___PoisonTrain Local_Simple ,  epoch  20, local model 13, internal_epoch   2,  Average loss: 0.0176, Accuracy: 358/734 (48.7738%), train_poison_data_count: 240
Global model norm: 16.385174334998126.
Norm before scaling: 16.54735728021198. Distance: 4.895106008626714
Total norm for 3 adversaries is: 16.54735728021198. distance: 4.895106008626714
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.8457, Accuracy: 6249/8968 (69.6811%)
___Train Local_Simple,  epoch  20, local model 78, internal_epoch   1,  Average loss: 0.0008, Accuracy: 298/303 (98.3498%)
___Train Local_Simple,  epoch  20, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 301/303 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2077, Accuracy: 9380/10000 (93.8000%)
___Train Local_Simple,  epoch  20, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 497/506 (98.2213%)
___Train Local_Simple,  epoch  20, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%)
class_loss: 4.032910346984863, distance_loss: 0.0
class_loss: 2.5621678829193115, distance_loss: 0.3595820963382721
class_loss: 1.4289923906326294, distance_loss: 0.8968712687492371
class_loss: 1.323560357093811, distance_loss: 1.3851637840270996
class_loss: 1.4245314598083496, distance_loss: 1.808390736579895
class_loss: 1.4962797164916992, distance_loss: 2.181563138961792
class_loss: 1.014274001121521, distance_loss: 2.5142252445220947
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1834, Accuracy: 9433/10000 (94.3300%)
poison local model 34 index 2
___PoisonTrain Local_Simple ,  epoch  20, local model 34, internal_epoch   1,  Average loss: 0.0322, Accuracy: 229/413 (55.4479%), train_poison_data_count: 140
class_loss: 1.4291671514511108, distance_loss: 2.821342706680298
class_loss: 1.3832616806030273, distance_loss: 3.097583532333374
class_loss: 0.9768927693367004, distance_loss: 3.343578577041626
class_loss: 1.0624061822891235, distance_loss: 3.5715436935424805
class_loss: 0.9579511880874634, distance_loss: 3.78398060798645
class_loss: 0.9868131875991821, distance_loss: 3.9765405654907227
class_loss: 1.4333462715148926, distance_loss: 4.150402069091797
___PoisonTrain Local_Simple ,  epoch  20, local model 34, internal_epoch   2,  Average loss: 0.0199, Accuracy: 197/413 (47.6998%), train_poison_data_count: 140
Global model norm: 16.385174334998126.
Norm before scaling: 16.425794719822065. Distance: 4.309345363102857
Total norm for 3 adversaries is: 16.425794719822065. distance: 4.309345363102857
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.6246, Accuracy: 7413/8968 (82.6606%)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0016, Accuracy: 364/376 (96.8085%)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   2,  Average loss: 0.0008, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1578, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch  20, local model 99, internal_epoch   1,  Average loss: 0.0007, Accuracy: 373/377 (98.9390%)
___Train Local_Simple,  epoch  20, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1151, Accuracy: 9626/10000 (96.2600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 13, 34]
base_p: [-0.00480913  0.00033046  0.00165759 ... -0.0022793  -0.01628368
  0.00046193]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 7]
layer1_inf_time: 3.485595703125
[PAIRWISE] pred_attackers_indx:  [3 4 7]
layer2_inf_t: 33.33837890625
assumed final_attacker_idxs:  [0 3 4 6 7]
final_attacker_idxs is: [0, 3, 4, 6, 7]
g_attacker_idxs: [12 11 13 49 34]
g_normal_idxs: [56 19 78 14 99]
filtered_attacker_idxs: [0, 3, 4, 6, 7]
final_attacker_idxs are: [0, 3, 4, 6, 7]
num_dps: [1160, 880, 205, 645, 734, 303, 506, 413, 376, 377]
epoch_acc: 97.92999999999999
time spent on training: 53.94959092140198
Starting performing KrMLRFL...
Num data points: [1160, 880, 205, 645, 734, 303, 506, 413, 376, 377]
Num selected data points: [880 205 303 376 377]
The chosen ones are users: [1, 2, 5, 8, 9], which are global users: [56, 19, 78, 14, 99]
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0661, Accuracy: 9793/10000 (97.9300%)
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 12.0995, Accuracy: 23/8968 (0.2565%)
Done in 60.13809657096863 sec.
Server Epoch:21 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  21, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 726/739 (98.2409%)
___Train Local_Simple,  epoch  21, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 730/739 (98.7821%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3910, Accuracy: 8895/10000 (88.9500%)
___Train Local_Simple,  epoch  21, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 877/880 (99.6591%)
___Train Local_Simple,  epoch  21, local model 56, internal_epoch   2,  Average loss: 0.0002, Accuracy: 877/880 (99.6591%)
class_loss: 2.944648027420044, distance_loss: 0.0
class_loss: 1.8290053606033325, distance_loss: 0.2829744219779968
class_loss: 1.5959820747375488, distance_loss: 0.6841649413108826
class_loss: 1.0111112594604492, distance_loss: 1.0326017141342163
class_loss: 0.9209732413291931, distance_loss: 1.3793277740478516
class_loss: 0.8124274015426636, distance_loss: 1.6902036666870117
class_loss: 0.6214041709899902, distance_loss: 1.984131932258606
class_loss: 0.5994530320167542, distance_loss: 2.25876522064209
class_loss: 0.5347933173179626, distance_loss: 2.518941879272461
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1054, Accuracy: 9668/10000 (96.6800%)
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0191, Accuracy: 376/568 (66.1972%), train_poison_data_count: 180
class_loss: 0.6176050901412964, distance_loss: 2.761646032333374
class_loss: 0.5837267637252808, distance_loss: 2.978985071182251
class_loss: 0.5443888902664185, distance_loss: 3.1687185764312744
class_loss: 0.43201297521591187, distance_loss: 3.3326969146728516
class_loss: 0.30901050567626953, distance_loss: 3.477743148803711
class_loss: 0.24991457164287567, distance_loss: 3.614712715148926
class_loss: 0.3644200563430786, distance_loss: 3.7484445571899414
class_loss: 0.22014667093753815, distance_loss: 3.8748512268066406
class_loss: 0.15450282394886017, distance_loss: 3.992893934249878
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0061, Accuracy: 505/568 (88.9085%), train_poison_data_count: 180
Global model norm: 16.388004177086454.
Norm before scaling: 16.57968135219234. Distance: 4.104194189195603
Total norm for 1 adversaries is: 16.57968135219234. distance: 4.104194189195603
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0511, Accuracy: 8817/8968 (98.3162%)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 372/376 (98.9362%)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0805, Accuracy: 9769/10000 (97.6900%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 978/1005 (97.3134%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   2,  Average loss: 0.0009, Accuracy: 984/1005 (97.9104%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3040, Accuracy: 9129/10000 (91.2900%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 602/615 (97.8862%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   2,  Average loss: 0.0010, Accuracy: 604/615 (98.2114%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1725, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch  21, local model 46, internal_epoch   1,  Average loss: 0.0015, Accuracy: 691/710 (97.3239%)
___Train Local_Simple,  epoch  21, local model 46, internal_epoch   2,  Average loss: 0.0027, Accuracy: 675/710 (95.0704%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3751, Accuracy: 8750/10000 (87.5000%)
___Train Local_Simple,  epoch  21, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 374/377 (99.2042%)
___Train Local_Simple,  epoch  21, local model 99, internal_epoch   2,  Average loss: 0.0003, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1239, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  21, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 523/530 (98.6792%)
___Train Local_Simple,  epoch  21, local model 88, internal_epoch   2,  Average loss: 0.0007, Accuracy: 522/530 (98.4906%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1574, Accuracy: 9518/10000 (95.1800%)
___Train Local_Simple,  epoch  21, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 849/860 (98.7209%)
___Train Local_Simple,  epoch  21, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 853/860 (99.1860%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51]
base_p: [-0.00266843  0.00133064  0.00086737 ...  0.00180016 -0.00112505
  0.00372221]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 6, 9]
layer1_inf_time: 4.3662109375
[PAIRWISE] pred_attackers_indx:  [2]
layer2_inf_t: 45.0126953125
assumed final_attacker_idxs:  [0 2 4 6 9]
final_attacker_idxs is: [0, 2, 4, 6, 9]
g_attacker_idxs: [53 51 36 46 37]
g_normal_idxs: [56 14  6 99 88]
filtered_attacker_idxs: [0, 2, 4, 6, 9]
final_attacker_idxs are: [0, 2, 4, 6, 9]
num_dps: [739, 880, 568, 376, 1005, 615, 710, 377, 530, 860]
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1991, Accuracy: 9400/10000 (94.0000%)
time spent on training: 38.66079521179199
Starting performing KrMLRFL...
Num data points: [739, 880, 568, 376, 1005, 615, 710, 377, 530, 860]
Num selected data points: [880 376 615 377 530]
The chosen ones are users: [1, 3, 5, 7, 8], which are global users: [56, 14, 6, 99, 88]
epoch_acc: 97.96000000000001
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0631, Accuracy: 9796/10000 (97.9600%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 12.0314, Accuracy: 48/8968 (0.5352%)
Done in 45.5672767162323 sec.
Server Epoch:22 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 0
class_loss: 2.3979251384735107, distance_loss: 0.0
class_loss: 1.5013865232467651, distance_loss: 0.21789176762104034
class_loss: 1.0708885192871094, distance_loss: 0.5615575909614563
class_loss: 1.778225302696228, distance_loss: 0.9004442691802979
class_loss: 0.9992656707763672, distance_loss: 1.1950074434280396
class_loss: 0.7528030276298523, distance_loss: 1.4531257152557373
class_loss: 1.0283300876617432, distance_loss: 1.707878828048706
class_loss: 1.0211981534957886, distance_loss: 1.9352775812149048
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0286, Accuracy: 163/236 (69.0678%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0161, Accuracy: 146/236 (61.8644%), train_poison_data_count: 80
Global model norm: 16.359673469101544.
Norm before scaling: 16.152079709903557. Distance: 2.134504604174683
Total norm for 3 adversaries is: 16.152079709903557. distance: 2.134504604174683
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.4283, Accuracy: 3790/8968 (42.2614%)
poison local model 17 index 1
class_loss: 4.176234722137451, distance_loss: 0.0
class_loss: 2.0861194133758545, distance_loss: 0.35631629824638367
class_loss: 2.149996042251587, distance_loss: 0.8816277384757996
class_loss: 1.8783290386199951, distance_loss: 1.2162946462631226
class_loss: 1.1150329113006592, distance_loss: 1.5478342771530151
class_loss: 1.2565557956695557, distance_loss: 1.8901015520095825
class_loss: 1.2575147151947021, distance_loss: 2.209533214569092
class_loss: 1.3342561721801758, distance_loss: 2.4975204467773438
class_loss: 1.2495237588882446, distance_loss: 2.751530885696411
class_loss: 1.160584807395935, distance_loss: 2.979884386062622
___PoisonTrain Local_Simple ,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0285, Accuracy: 330/620 (53.2258%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  22, local model 17, internal_epoch   2,  Average loss: 0.0182, Accuracy: 308/620 (49.6774%), train_poison_data_count: 200
Global model norm: 16.359673469101544.
Norm before scaling: 16.457766031395046. Distance: 4.417372281312058
Total norm for 3 adversaries is: 16.457766031395046. distance: 4.417372281312058
class_loss: 1.2901372909545898, distance_loss: 3.1948742866516113
class_loss: 1.5503132343292236, distance_loss: 3.397578477859497
class_loss: 1.3263840675354004, distance_loss: 3.5758938789367676
class_loss: 1.0434633493423462, distance_loss: 3.7349112033843994
class_loss: 1.0721676349639893, distance_loss: 3.87546968460083
class_loss: 1.1989704370498657, distance_loss: 3.997880458831787
class_loss: 0.939224898815155, distance_loss: 4.106339931488037
class_loss: 0.9793112874031067, distance_loss: 4.199170112609863
class_loss: 0.8787915110588074, distance_loss: 4.277834415435791
class_loss: 1.0004268884658813, distance_loss: 4.3475494384765625
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.9686, Accuracy: 5818/8968 (64.8751%)
poison local model 2 index 2
class_loss: 1.7557557821273804, distance_loss: 0.0
class_loss: 1.4713571071624756, distance_loss: 0.17779338359832764
class_loss: 1.5815815925598145, distance_loss: 0.44055405259132385
class_loss: 0.6930022835731506, distance_loss: 0.8129390478134155
class_loss: 0.669292688369751, distance_loss: 1.160746455192566
class_loss: 0.6595829725265503, distance_loss: 1.459700107574463
class_loss: 1.1267577409744263, distance_loss: 1.71416175365448
class_loss: 0.7500039935112, distance_loss: 1.9281057119369507
class_loss: 0.5468660593032837, distance_loss: 2.1267848014831543
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0169, Accuracy: 427/548 (77.9197%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   2,  Average loss: 0.0102, Accuracy: 403/548 (73.5401%), train_poison_data_count: 180
Global model norm: 16.359673469101544.
Norm before scaling: 16.30197798072321. Distance: 3.3379104819022443
Total norm for 3 adversaries is: 16.30197798072321. distance: 3.3379104819022443
class_loss: 0.6982470154762268, distance_loss: 2.3125648498535156
class_loss: 0.6208196878433228, distance_loss: 2.479588508605957
class_loss: 0.5832217931747437, distance_loss: 2.630337953567505
class_loss: 0.4828225374221802, distance_loss: 2.766357183456421
class_loss: 0.6291715502738953, distance_loss: 2.8928327560424805
class_loss: 0.9409509301185608, distance_loss: 3.003687858581543
class_loss: 0.6162596940994263, distance_loss: 3.0960936546325684
class_loss: 0.49258139729499817, distance_loss: 3.181131601333618
class_loss: 0.5415663123130798, distance_loss: 3.2604825496673584
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.5880, Accuracy: 6756/8968 (75.3345%)
___Train Local_Simple,  epoch  22, local model 64, internal_epoch   1,  Average loss: 0.0014, Accuracy: 790/813 (97.1710%)
___Train Local_Simple,  epoch  22, local model 64, internal_epoch   2,  Average loss: 0.0007, Accuracy: 804/813 (98.8930%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3377, Accuracy: 8929/10000 (89.2900%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0005, Accuracy: 611/615 (99.3496%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   2,  Average loss: 0.0006, Accuracy: 610/615 (99.1870%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2151, Accuracy: 9380/10000 (93.8000%)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0013, Accuracy: 871/895 (97.3184%)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0009, Accuracy: 876/895 (97.8771%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.7166, Accuracy: 8250/10000 (82.5000%)
___Train Local_Simple,  epoch  22, local model 37, internal_epoch   1,  Average loss: 0.0004, Accuracy: 851/860 (98.9535%)
___Train Local_Simple,  epoch  22, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 856/860 (99.5349%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1614, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  22, local model 44, internal_epoch   1,  Average loss: 0.0013, Accuracy: 504/517 (97.4855%)
___Train Local_Simple,  epoch  22, local model 44, internal_epoch   2,  Average loss: 0.0007, Accuracy: 512/517 (99.0329%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1060, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  22, local model 77, internal_epoch   1,  Average loss: 0.0031, Accuracy: 574/589 (97.4533%)
___Train Local_Simple,  epoch  22, local model 77, internal_epoch   2,  Average loss: 0.0027, Accuracy: 561/589 (95.2462%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2294, Accuracy: 9246/10000 (92.4600%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 643/658 (97.7204%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   2,  Average loss: 0.0006, Accuracy: 653/658 (99.2401%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3417, Accuracy: 8999/10000 (89.9900%)
time spent on training: 53.86413049697876
Starting performing KrMLRFL...
Num data points: [236, 620, 548, 813, 615, 895, 860, 517, 589, 658]
Num selected data points: [813 615 895 860 517]
The chosen ones are users: [3, 4, 5, 6, 7], which are global users: [64, 6, 38, 37, 44]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 17, 2]
base_p: [-0.00141722  0.00045986 -0.00413639 ... -0.00143231 -0.00834534
  0.00109453]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 8, 9]
layer1_inf_time: 3.98046875
[PAIRWISE] pred_attackers_indx:  [0 1 2]
layer2_inf_t: 59.9951171875
assumed final_attacker_idxs:  [0 1 2 8 9]
final_attacker_idxs is: [0, 1, 2, 8, 9]
g_attacker_idxs: [42 17  2 77  4]
g_normal_idxs: [64  6 38 37 44]
filtered_attacker_idxs: [0, 1, 2, 8, 9]
final_attacker_idxs are: [0, 1, 2, 8, 9]
num_dps: [236, 620, 548, 813, 615, 895, 860, 517, 589, 658]
epoch_acc: 98.03
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0650, Accuracy: 9803/10000 (98.0300%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 13.0541, Accuracy: 6/8968 (0.0669%)
Done in 59.841256618499756 sec.
Server Epoch:23 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   1,  Average loss: 0.0015, Accuracy: 366/379 (96.5699%)
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   2,  Average loss: 0.0006, Accuracy: 374/379 (98.6807%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1166, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  23, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 881/895 (98.4358%)
___Train Local_Simple,  epoch  23, local model 38, internal_epoch   2,  Average loss: 0.0003, Accuracy: 890/895 (99.4413%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1677, Accuracy: 9451/10000 (94.5100%)
poison local model 52 index 0
class_loss: 3.4416582584381104, distance_loss: 0.0
class_loss: 2.164625406265259, distance_loss: 0.3429061472415924
class_loss: 1.4630314111709595, distance_loss: 0.8831798434257507
class_loss: 2.124067544937134, distance_loss: 1.3246792554855347
class_loss: 1.7746481895446777, distance_loss: 1.709245204925537
class_loss: 1.5105305910110474, distance_loss: 2.0734574794769287
class_loss: 1.3871351480484009, distance_loss: 2.404139757156372
class_loss: 1.2350268363952637, distance_loss: 2.708402156829834
___PoisonTrain Local_Simple ,  epoch  23, local model 52, internal_epoch   1,  Average loss: 0.0363, Accuracy: 141/253 (55.7312%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  23, local model 52, internal_epoch   2,  Average loss: 0.0233, Accuracy: 95/253 (37.5494%), train_poison_data_count: 80
Global model norm: 16.304670654639118.
Norm before scaling: 16.147778885637898. Distance: 2.9975028771521064
Total norm for 4 adversaries is: 16.147778885637898. distance: 2.9975028771521064
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1.5126, Accuracy: 3088/8968 (34.4335%)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0014, Accuracy: 869/892 (97.4215%)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 879/892 (98.5426%)
class_loss: 4.566015243530273, distance_loss: 0.0
class_loss: 2.599994421005249, distance_loss: 0.34490886330604553
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2114, Accuracy: 9319/10000 (93.1900%)
poison local model 11 index 1
class_loss: 1.7391763925552368, distance_loss: 0.8710386753082275
class_loss: 1.296216368675232, distance_loss: 1.4031059741973877
class_loss: 1.8139923810958862, distance_loss: 1.8898873329162598
class_loss: 1.6733487844467163, distance_loss: 2.3012020587921143
class_loss: 1.4984138011932373, distance_loss: 2.664046287536621
class_loss: 1.5991348028182983, distance_loss: 2.986483573913574
class_loss: 1.5018959045410156, distance_loss: 3.272871732711792
class_loss: 1.4811151027679443, distance_loss: 3.525191307067871
class_loss: 1.0945978164672852, distance_loss: 3.750518798828125
class_loss: 1.3864554166793823, distance_loss: 3.9751641750335693
class_loss: 1.3850440979003906, distance_loss: 4.1766157150268555
class_loss: 1.4792882204055786, distance_loss: 4.3515305519104
class_loss: 1.276623010635376, distance_loss: 4.501536846160889
class_loss: 1.0633729696273804, distance_loss: 4.636129379272461
class_loss: 0.9520998597145081, distance_loss: 4.762885093688965
class_loss: 0.9673222303390503, distance_loss: 4.8857421875
class_loss: 1.2536311149597168, distance_loss: 4.999428749084473
class_loss: 1.1775314807891846, distance_loss: 5.101436614990234
class_loss: 1.0936461687088013, distance_loss: 5.197159767150879
class_loss: 1.9612445831298828, distance_loss: 5.284252643585205
___PoisonTrain Local_Simple ,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0323, Accuracy: 291/645 (45.1163%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  23, local model 11, internal_epoch   2,  Average loss: 0.0217, Accuracy: 318/645 (49.3023%), train_poison_data_count: 205
Global model norm: 16.304670654639118.
Norm before scaling: 16.581035103323803. Distance: 5.395270869373126
Total norm for 4 adversaries is: 16.581035103323803. distance: 5.395270869373126
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.6351, Accuracy: 7605/8968 (84.8015%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0020, Accuracy: 77/78 (98.7179%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1255, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch  23, local model 97, internal_epoch   1,  Average loss: 0.0006, Accuracy: 481/487 (98.7680%)
___Train Local_Simple,  epoch  23, local model 97, internal_epoch   2,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3329, Accuracy: 9053/10000 (90.5300%)
poison local model 7 index 2
class_loss: 2.063636541366577, distance_loss: 0.0
class_loss: 2.520765781402588, distance_loss: 0.18487226963043213
class_loss: 1.8595510721206665, distance_loss: 0.526814341545105
class_loss: 1.3308650255203247, distance_loss: 0.9587226510047913
class_loss: 1.024822473526001, distance_loss: 1.3896565437316895
class_loss: 1.1987204551696777, distance_loss: 1.750481367111206
class_loss: 0.9901677370071411, distance_loss: 2.039299488067627
class_loss: 1.212496042251587, distance_loss: 2.3005177974700928
class_loss: 1.3778470754623413, distance_loss: 2.5258214473724365
class_loss: 1.1940882205963135, distance_loss: 2.72113299369812
class_loss: 1.1643353700637817, distance_loss: 2.893531084060669
class_loss: 1.1207934617996216, distance_loss: 3.0438175201416016
class_loss: 1.0667937994003296, distance_loss: 3.1792795658111572
class_loss: 0.9245466589927673, distance_loss: 3.3012304306030273
___PoisonTrain Local_Simple ,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0263, Accuracy: 264/418 (63.1579%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  23, local model 7, internal_epoch   2,  Average loss: 0.0193, Accuracy: 208/418 (49.7608%), train_poison_data_count: 140
Global model norm: 16.304670654639118.
Norm before scaling: 16.185773013571982. Distance: 3.419865963411817
Total norm for 4 adversaries is: 16.185773013571982. distance: 3.419865963411817
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5541, Accuracy: 8196/8968 (91.3916%)
poison local model 70 index 3
class_loss: 3.135909080505371, distance_loss: 0.0
class_loss: 3.090343713760376, distance_loss: 0.2948598861694336
class_loss: 1.3113787174224854, distance_loss: 0.7570487260818481
class_loss: 1.0596109628677368, distance_loss: 1.2368760108947754
class_loss: 1.4438817501068115, distance_loss: 1.6357485055923462
class_loss: 1.3489956855773926, distance_loss: 1.9509141445159912
class_loss: 1.499496579170227, distance_loss: 2.231123208999634
class_loss: 1.2251907587051392, distance_loss: 2.4872074127197266
class_loss: 1.3858579397201538, distance_loss: 2.719900608062744
class_loss: 1.258133888244629, distance_loss: 2.929168462753296
class_loss: 1.2403467893600464, distance_loss: 3.118415117263794
class_loss: 0.8270941972732544, distance_loss: 3.292522668838501
class_loss: 1.0405815839767456, distance_loss: 3.4741787910461426
class_loss: 0.9961075782775879, distance_loss: 3.642237424850464
class_loss: 0.9847652912139893, distance_loss: 3.792412042617798
class_loss: 0.7370359897613525, distance_loss: 3.925048351287842
class_loss: 0.6847712397575378, distance_loss: 4.0474324226379395
class_loss: 0.4351515769958496, distance_loss: 4.1658782958984375
class_loss: 0.5481315851211548, distance_loss: 4.283382415771484
class_loss: 0.3465266823768616, distance_loss: 4.399103164672852
class_loss: 0.42916956543922424, distance_loss: 4.514756679534912
class_loss: 0.2483036071062088, distance_loss: 4.631479740142822
class_loss: 0.4084770083427429, distance_loss: 4.740594863891602
___PoisonTrain Local_Simple ,  epoch  23, local model 70, internal_epoch   1,  Average loss: 0.0260, Accuracy: 362/724 (50.0000%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  23, local model 70, internal_epoch   2,  Average loss: 0.0096, Accuracy: 538/724 (74.3094%), train_poison_data_count: 240
Global model norm: 16.304670654639118.
Norm before scaling: 16.74237706962205. Distance: 4.952859287776276
Total norm for 4 adversaries is: 16.74237706962205. distance: 4.952859287776276
class_loss: 0.11572127044200897, distance_loss: 4.846961498260498
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0813, Accuracy: 8675/8968 (96.7328%)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 369/376 (98.1383%)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   2,  Average loss: 0.0009, Accuracy: 368/376 (97.8723%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1461, Accuracy: 9581/10000 (95.8100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 11, 7, 70]
base_p: [-0.00359832  0.00025432 -0.00050047 ... -0.00269584  0.00015068
  0.00168046]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 7, 8]
layer1_inf_time: 5.207275390625
[PAIRWISE] pred_attackers_indx:  [2 4 7 8]
layer2_inf_t: 33.82421875
assumed final_attacker_idxs:  [0 2 4 7 8]
final_attacker_idxs is: [0, 2, 4, 7, 8]
g_attacker_idxs: [24 52 11  7 70]
g_normal_idxs: [38 10 76 97 14]
filtered_attacker_idxs: [0, 2, 4, 7, 8]
final_attacker_idxs are: [0, 2, 4, 7, 8]
num_dps: [379, 895, 253, 892, 645, 78, 487, 418, 724, 376]
time spent on training: 61.16165828704834
Starting performing KrMLRFL...
Num data points: [379, 895, 253, 892, 645, 78, 487, 418, 724, 376]
Num selected data points: [895 892  78 487 376]
The chosen ones are users: [1, 3, 5, 6, 9], which are global users: [38, 10, 76, 97, 14]
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0732, Accuracy: 9762/10000 (97.6200%)
epoch_acc: 97.61999999999999
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 12.8540, Accuracy: 7/8968 (0.0781%)
Done in 67.46769285202026 sec.
Server Epoch:24 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   1,  Average loss: 0.0007, Accuracy: 590/602 (98.0066%)
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   2,  Average loss: 0.0003, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 2.0716, Accuracy: 6991/10000 (69.9100%)
___Train Local_Simple,  epoch  24, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch  24, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 485/487 (99.5893%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1138, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1125/1160 (96.9828%)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   2,  Average loss: 0.0018, Accuracy: 1120/1160 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1585, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  24, local model 89, internal_epoch   1,  Average loss: 0.0006, Accuracy: 488/492 (99.1870%)
___Train Local_Simple,  epoch  24, local model 89, internal_epoch   2,  Average loss: 0.0002, Accuracy: 489/492 (99.3902%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2626, Accuracy: 9257/10000 (92.5700%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 630/647 (97.3725%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0006, Accuracy: 641/647 (99.0726%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3111, Accuracy: 8963/10000 (89.6300%)
poison local model 34 index 0
class_loss: 4.662839412689209, distance_loss: 0.0
class_loss: 2.2888147830963135, distance_loss: 0.3710927367210388
class_loss: 1.6694977283477783, distance_loss: 0.8440920114517212
class_loss: 1.1934514045715332, distance_loss: 1.3151252269744873
class_loss: 1.305438756942749, distance_loss: 1.7232528924942017
class_loss: 1.1578607559204102, distance_loss: 2.0812528133392334
class_loss: 0.793746292591095, distance_loss: 2.3995227813720703
class_loss: 0.9973809719085693, distance_loss: 2.7031991481781006
class_loss: 1.1451090574264526, distance_loss: 2.97627854347229
class_loss: 1.0171537399291992, distance_loss: 3.222625255584717
___PoisonTrain Local_Simple ,  epoch  24, local model 34, internal_epoch   1,  Average loss: 0.0317, Accuracy: 225/413 (54.4794%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  24, local model 34, internal_epoch   2,  Average loss: 0.0177, Accuracy: 230/413 (55.6901%), train_poison_data_count: 140
Global model norm: 16.260789311806754.
Norm before scaling: 16.212212863988235. Distance: 4.13815775365273
Total norm for 2 adversaries is: 16.212212863988235. distance: 4.13815775365273
class_loss: 1.1603797674179077, distance_loss: 3.443244695663452
class_loss: 0.7948826551437378, distance_loss: 3.641101837158203
class_loss: 1.145668864250183, distance_loss: 3.8242199420928955
class_loss: 1.0414563417434692, distance_loss: 3.9870147705078125
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.8450, Accuracy: 7587/8968 (84.6008%)
___Train Local_Simple,  epoch  24, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch  24, local model 55, internal_epoch   2,  Average loss: 0.0005, Accuracy: 352/354 (99.4350%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.4032, Accuracy: 8757/10000 (87.5700%)
___Train Local_Simple,  epoch  24, local model 67, internal_epoch   1,  Average loss: 0.0012, Accuracy: 976/998 (97.7956%)
___Train Local_Simple,  epoch  24, local model 67, internal_epoch   2,  Average loss: 0.0007, Accuracy: 981/998 (98.2966%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.3247, Accuracy: 8971/10000 (89.7100%)
___Train Local_Simple,  epoch  24, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 871/880 (98.9773%)
___Train Local_Simple,  epoch  24, local model 56, internal_epoch   2,  Average loss: 0.0004, Accuracy: 876/880 (99.5455%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1031, Accuracy: 9697/10000 (96.9700%)
poison local model 2 index 1
class_loss: 2.8503334522247314, distance_loss: 0.0
class_loss: 1.4717291593551636, distance_loss: 0.22602860629558563
class_loss: 1.4827202558517456, distance_loss: 0.5358250737190247
class_loss: 0.5190809369087219, distance_loss: 0.9118750691413879
class_loss: 0.9403413534164429, distance_loss: 1.268784523010254
class_loss: 0.925227165222168, distance_loss: 1.5665862560272217
class_loss: 0.5446940064430237, distance_loss: 1.8135251998901367
class_loss: 0.7897101044654846, distance_loss: 2.0260274410247803
class_loss: 0.4471428096294403, distance_loss: 2.2120916843414307
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0182, Accuracy: 412/548 (75.1825%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   2,  Average loss: 0.0094, Accuracy: 409/548 (74.6350%), train_poison_data_count: 180
Global model norm: 16.260789311806754.
Norm before scaling: 16.197822254882947. Distance: 3.2685561463620885
Total norm for 2 adversaries is: 16.197822254882947. distance: 3.2685561463620885
class_loss: 0.6687191128730774, distance_loss: 2.382347822189331
class_loss: 0.7858908176422119, distance_loss: 2.5330870151519775
class_loss: 0.4644923806190491, distance_loss: 2.6660468578338623
class_loss: 0.6173785328865051, distance_loss: 2.788837432861328
class_loss: 0.4472665786743164, distance_loss: 2.897017002105713
class_loss: 0.5173435807228088, distance_loss: 2.9925808906555176
class_loss: 0.583996057510376, distance_loss: 3.074920654296875
class_loss: 0.49395760893821716, distance_loss: 3.144826889038086
class_loss: 0.5709747076034546, distance_loss: 3.2066774368286133
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.7547, Accuracy: 6073/8968 (67.7186%)
time spent on training: 48.63921356201172
Starting performing KrMLRFL...
Num data points: [602, 487, 1160, 492, 647, 413, 354, 998, 880, 548]
Num selected data points: [487 492 647 354 880]
The chosen ones are users: [1, 3, 4, 6, 8], which are global users: [97, 89, 25, 55, 56]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 2]
base_p: [-0.00180191  0.00048907 -0.001042   ... -0.00211643 -0.00727455
 -0.00107263]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 7, 9]
layer1_inf_time: 3.991943359375
[PAIRWISE] pred_attackers_indx:  [5 9]
layer2_inf_t: 37.3271484375
assumed final_attacker_idxs:  [0 2 5 7 9]
final_attacker_idxs is: [0, 2, 5, 7, 9]
g_attacker_idxs: [95 12 34 67  2]
g_normal_idxs: [97 89 25 55 56]
filtered_attacker_idxs: [0, 2, 5, 7, 9]
final_attacker_idxs are: [0, 2, 5, 7, 9]
num_dps: [602, 487, 1160, 492, 647, 413, 354, 998, 880, 548]
epoch_acc: 97.19
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0828, Accuracy: 9719/10000 (97.1900%)
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 13.0806, Accuracy: 44/8968 (0.4906%)
Done in 54.91120409965515 sec.
Server Epoch:25 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0025, Accuracy: 631/658 (95.8967%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   2,  Average loss: 0.0008, Accuracy: 648/658 (98.4802%)
class_loss: 3.6722965240478516, distance_loss: 0.0
class_loss: 2.095360040664673, distance_loss: 0.2938646674156189
class_loss: 1.3556292057037354, distance_loss: 0.6901589632034302
class_loss: 0.9586944580078125, distance_loss: 1.1531589031219482
class_loss: 1.1309703588485718, distance_loss: 1.5377784967422485
class_loss: 1.052972435951233, distance_loss: 1.8662854433059692
class_loss: 1.100826382637024, distance_loss: 2.155832052230835
class_loss: 1.2376207113265991, distance_loss: 2.4056572914123535
class_loss: 1.4123330116271973, distance_loss: 2.6165759563446045
class_loss: 1.3157082796096802, distance_loss: 2.8002445697784424
class_loss: 1.2187414169311523, distance_loss: 2.959672451019287
class_loss: 1.086354374885559, distance_loss: 3.099067211151123
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2681, Accuracy: 9181/10000 (91.8100%)
poison local model 1 index 0
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0232, Accuracy: 429/760 (56.4474%), train_poison_data_count: 240
class_loss: 1.0483591556549072, distance_loss: 3.2262113094329834
class_loss: 1.2398533821105957, distance_loss: 3.342175245285034
class_loss: 1.0232932567596436, distance_loss: 3.4496452808380127
class_loss: 0.8817481398582458, distance_loss: 3.5425772666931152
class_loss: 0.8866751194000244, distance_loss: 3.627410411834717
class_loss: 0.8153741359710693, distance_loss: 3.7068493366241455
class_loss: 0.8617347478866577, distance_loss: 3.7795047760009766
class_loss: 0.9178453087806702, distance_loss: 3.847691774368286
class_loss: 0.7862995266914368, distance_loss: 3.9146015644073486
class_loss: 0.7767766714096069, distance_loss: 3.978736162185669
class_loss: 0.7296016812324524, distance_loss: 4.041066646575928
class_loss: 0.9500800967216492, distance_loss: 4.098390579223633
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   2,  Average loss: 0.0144, Accuracy: 438/760 (57.6316%), train_poison_data_count: 240
Global model norm: 16.251860996201135.
Norm before scaling: 16.381783281631098. Distance: 4.148076100959995
Total norm for 4 adversaries is: 16.381783281631098. distance: 4.148076100959995
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.1551, Accuracy: 4517/8968 (50.3680%)
class_loss: 4.046683311462402, distance_loss: 0.0
class_loss: 2.8340423107147217, distance_loss: 0.3333978056907654
class_loss: 1.771727204322815, distance_loss: 0.793272078037262
class_loss: 1.1698862314224243, distance_loss: 1.281944990158081
class_loss: 1.202073574066162, distance_loss: 1.70753812789917
class_loss: 1.20496666431427, distance_loss: 2.0794124603271484
class_loss: 0.8980458378791809, distance_loss: 2.415771245956421
poison local model 20 index 1
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0306, Accuracy: 240/429 (55.9441%), train_poison_data_count: 140
class_loss: 1.1115550994873047, distance_loss: 2.733034133911133
class_loss: 1.2045685052871704, distance_loss: 3.0288095474243164
class_loss: 1.180702567100525, distance_loss: 3.2962841987609863
class_loss: 1.0752818584442139, distance_loss: 3.5375332832336426
class_loss: 1.0603318214416504, distance_loss: 3.7503654956817627
class_loss: 1.1256259679794312, distance_loss: 3.9397997856140137
class_loss: 0.9166829586029053, distance_loss: 4.108173847198486
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0179, Accuracy: 225/429 (52.4476%), train_poison_data_count: 140
Global model norm: 16.251860996201135.
Norm before scaling: 16.17283455033712. Distance: 4.260783707431495
Total norm for 4 adversaries is: 16.17283455033712. distance: 4.260783707431495
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.9216, Accuracy: 6297/8968 (70.2163%)
___Train Local_Simple,  epoch  25, local model 48, internal_epoch   1,  Average loss: 0.0007, Accuracy: 441/448 (98.4375%)
___Train Local_Simple,  epoch  25, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1132, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch  25, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch  25, local model 55, internal_epoch   2,  Average loss: 0.0004, Accuracy: 351/354 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3977, Accuracy: 8776/10000 (87.7600%)
___Train Local_Simple,  epoch  25, local model 98, internal_epoch   1,  Average loss: 0.0015, Accuracy: 796/818 (97.3105%)
___Train Local_Simple,  epoch  25, local model 98, internal_epoch   2,  Average loss: 0.0006, Accuracy: 811/818 (99.1443%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.2736, Accuracy: 9149/10000 (91.4900%)
poison local model 27 index 2
___PoisonTrain Local_Simple ,  epoch  25, local model 27, internal_epoch   1,  Average loss: 0.0331, Accuracy: 258/471 (54.7771%), train_poison_data_count: 160
class_loss: 4.094112873077393, distance_loss: 0.0
class_loss: 2.409411907196045, distance_loss: 0.3528089225292206
class_loss: 1.6358426809310913, distance_loss: 0.8976938724517822
class_loss: 1.8839523792266846, distance_loss: 1.3289552927017212
class_loss: 1.1362637281417847, distance_loss: 1.6912649869918823
class_loss: 1.4322110414505005, distance_loss: 2.02555251121521
class_loss: 1.4181703329086304, distance_loss: 2.330092668533325
class_loss: 1.5590399503707886, distance_loss: 2.6012933254241943
class_loss: 1.2856717109680176, distance_loss: 2.8586409091949463
class_loss: 1.27641761302948, distance_loss: 3.0872278213500977
class_loss: 1.2563529014587402, distance_loss: 3.2955920696258545
class_loss: 1.0971723794937134, distance_loss: 3.484130620956421
class_loss: 1.0778967142105103, distance_loss: 3.654639482498169
class_loss: 0.8247735500335693, distance_loss: 3.810225248336792
class_loss: 0.9900820255279541, distance_loss: 3.9500503540039062
class_loss: 1.0006654262542725, distance_loss: 4.076923370361328
___PoisonTrain Local_Simple ,  epoch  25, local model 27, internal_epoch   2,  Average loss: 0.0187, Accuracy: 239/471 (50.7431%), train_poison_data_count: 160
Global model norm: 16.251860996201135.
Norm before scaling: 16.287422167108254. Distance: 4.221666020572662
Total norm for 4 adversaries is: 16.287422167108254. distance: 4.221666020572662
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.4308, Accuracy: 7904/8968 (88.1356%)
poison local model 42 index 3
___PoisonTrain Local_Simple ,  epoch  25, local model 42, internal_epoch   1,  Average loss: 0.0313, Accuracy: 167/236 (70.7627%), train_poison_data_count: 80
class_loss: 3.499370574951172, distance_loss: 0.0
class_loss: 1.705979824066162, distance_loss: 0.2930707037448883
class_loss: 0.7406113743782043, distance_loss: 0.7096925377845764
class_loss: 1.4445632696151733, distance_loss: 1.1368464231491089
class_loss: 1.2636736631393433, distance_loss: 1.5128746032714844
class_loss: 0.9705651998519897, distance_loss: 1.8213814496994019
class_loss: 1.069618821144104, distance_loss: 2.0996978282928467
class_loss: 1.0492323637008667, distance_loss: 2.3521106243133545
___PoisonTrain Local_Simple ,  epoch  25, local model 42, internal_epoch   2,  Average loss: 0.0184, Accuracy: 133/236 (56.3559%), train_poison_data_count: 80
Global model norm: 16.251860996201135.
Norm before scaling: 16.03253394742673. Distance: 2.579984329678756
Total norm for 4 adversaries is: 16.03253394742673. distance: 2.579984329678756
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.0932, Accuracy: 5984/8968 (66.7261%)
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0017, Accuracy: 420/435 (96.5517%)
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   2,  Average loss: 0.0008, Accuracy: 426/435 (97.9310%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.8740, Accuracy: 8197/10000 (81.9700%)
___Train Local_Simple,  epoch  25, local model 44, internal_epoch   1,  Average loss: 0.0018, Accuracy: 501/517 (96.9052%)
___Train Local_Simple,  epoch  25, local model 44, internal_epoch   2,  Average loss: 0.0013, Accuracy: 503/517 (97.2921%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1001, Accuracy: 9653/10000 (96.5300%)
time spent on training: 60.401278495788574
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 20, 27, 42]
base_p: [-2.7352199e-03  2.4368614e-04 -3.4273665e-03 ... -3.1539425e-03
 -6.0425140e-03 -4.0568411e-06]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 7]
layer1_inf_time: 3.898681640625
[PAIRWISE] pred_attackers_indx:  [1 2 6 7]
layer2_inf_t: 45.390625
assumed final_attacker_idxs:  [0 1 2 6 7]
final_attacker_idxs is: [0, 1, 2, 6, 7]
g_attacker_idxs: [ 4  1 20 27 42]
g_normal_idxs: [48 55 98  0 44]
filtered_attacker_idxs: [0, 1, 2, 6, 7]
final_attacker_idxs are: [0, 1, 2, 6, 7]
num_dps: [658, 760, 429, 448, 354, 818, 471, 236, 435, 517]
Starting performing KrMLRFL...
Num data points: [658, 760, 429, 448, 354, 818, 471, 236, 435, 517]
Num selected data points: [448 354 818 435 517]
The chosen ones are users: [3, 4, 5, 8, 9], which are global users: [48, 55, 98, 0, 44]
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0605, Accuracy: 9818/10000 (98.1800%)
epoch_acc: 98.18
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 12.9875, Accuracy: 9/8968 (0.1004%)
Done in 66.72750878334045 sec.
Server Epoch:26 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
___Train Local_Simple,  epoch  26, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 634/647 (97.9907%)
___Train Local_Simple,  epoch  26, local model 25, internal_epoch   2,  Average loss: 0.0022, Accuracy: 625/647 (96.5997%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.6193, Accuracy: 8362/10000 (83.6200%)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0010, Accuracy: 620/633 (97.9463%)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   2,  Average loss: 0.0010, Accuracy: 623/633 (98.4202%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1098, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1132/1160 (97.5862%)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1138/1160 (98.1034%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1944, Accuracy: 9451/10000 (94.5100%)
___Train Local_Simple,  epoch  26, local model 99, internal_epoch   1,  Average loss: 0.0007, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch  26, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0801, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch  26, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 729/739 (98.6468%)
___Train Local_Simple,  epoch  26, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 730/739 (98.7821%)
class_loss: 3.3393917083740234, distance_loss: 0.0
class_loss: 1.9861438274383545, distance_loss: 0.29461774230003357
class_loss: 1.3378857374191284, distance_loss: 0.6996163129806519
class_loss: 0.8949728012084961, distance_loss: 1.130678653717041
class_loss: 0.9324579834938049, distance_loss: 1.5239285230636597
class_loss: 1.1201132535934448, distance_loss: 1.8533203601837158
class_loss: 1.008582353591919, distance_loss: 2.133005380630493
class_loss: 1.1071370840072632, distance_loss: 2.3783421516418457
class_loss: 0.8686639070510864, distance_loss: 2.5969138145446777
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.4167, Accuracy: 8763/10000 (87.6300%)
poison local model 26 index 0
___PoisonTrain Local_Simple ,  epoch  26, local model 26, internal_epoch   1,  Average loss: 0.0227, Accuracy: 383/554 (69.1336%), train_poison_data_count: 180
class_loss: 1.1054325103759766, distance_loss: 2.792666435241699
class_loss: 1.0110211372375488, distance_loss: 2.9662461280822754
class_loss: 0.9902667999267578, distance_loss: 3.1201701164245605
class_loss: 0.8994102478027344, distance_loss: 3.256761074066162
class_loss: 0.6326807737350464, distance_loss: 3.3785505294799805
class_loss: 0.5829598307609558, distance_loss: 3.493492841720581
class_loss: 0.8159720301628113, distance_loss: 3.601752519607544
class_loss: 0.7624214887619019, distance_loss: 3.7018253803253174
class_loss: 0.8206034898757935, distance_loss: 3.795232057571411
___PoisonTrain Local_Simple ,  epoch  26, local model 26, internal_epoch   2,  Average loss: 0.0138, Accuracy: 347/554 (62.6354%), train_poison_data_count: 180
Global model norm: 16.211647198320488.
Norm before scaling: 16.20569192239547. Distance: 3.8837561583186235
Total norm for 3 adversaries is: 16.20569192239547. distance: 3.8837561583186235
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.8649, Accuracy: 5845/8968 (65.1762%)
___Train Local_Simple,  epoch  26, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 326/338 (96.4497%)
___Train Local_Simple,  epoch  26, local model 60, internal_epoch   2,  Average loss: 0.0009, Accuracy: 337/338 (99.7041%)
class_loss: 4.072053909301758, distance_loss: 0.0
class_loss: 2.6674840450286865, distance_loss: 0.3177136778831482
class_loss: 1.3210387229919434, distance_loss: 0.7985739707946777
class_loss: 1.4470901489257812, distance_loss: 1.2787516117095947
class_loss: 1.4247772693634033, distance_loss: 1.6887140274047852
class_loss: 1.40547776222229, distance_loss: 2.0188064575195312
class_loss: 1.322758674621582, distance_loss: 2.3032426834106445
class_loss: 1.288377046585083, distance_loss: 2.5567054748535156
class_loss: 1.2823536396026611, distance_loss: 2.782594919204712
class_loss: 1.3185044527053833, distance_loss: 2.985476493835449
class_loss: 1.09007728099823, distance_loss: 3.171077013015747
class_loss: 1.1199512481689453, distance_loss: 3.3406691551208496
class_loss: 0.9315700531005859, distance_loss: 3.499091863632202
class_loss: 0.9588143825531006, distance_loss: 3.6473259925842285
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1558, Accuracy: 9492/10000 (94.9200%)
poison local model 63 index 1
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0244, Accuracy: 448/889 (50.3937%), train_poison_data_count: 280
class_loss: 0.9240884780883789, distance_loss: 3.788914442062378
class_loss: 0.8371379971504211, distance_loss: 3.9245362281799316
class_loss: 0.8905376195907593, distance_loss: 4.051112174987793
class_loss: 0.8817364573478699, distance_loss: 4.169690132141113
class_loss: 0.9241251349449158, distance_loss: 4.280184268951416
class_loss: 0.9803226590156555, distance_loss: 4.376512050628662
class_loss: 0.7722473740577698, distance_loss: 4.456482887268066
class_loss: 0.6957952976226807, distance_loss: 4.52661657333374
class_loss: 0.8816953301429749, distance_loss: 4.593777179718018
class_loss: 0.6938913464546204, distance_loss: 4.654059886932373
class_loss: 0.9121332168579102, distance_loss: 4.7114949226379395
class_loss: 0.9768204092979431, distance_loss: 4.766310691833496
class_loss: 0.7465698719024658, distance_loss: 4.819241046905518
class_loss: 0.875534176826477, distance_loss: 4.874364376068115
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   2,  Average loss: 0.0135, Accuracy: 546/889 (61.4173%), train_poison_data_count: 280
Global model norm: 16.211647198320488.
Norm before scaling: 16.447846264131837. Distance: 4.927336070035238
Total norm for 3 adversaries is: 16.447846264131837. distance: 4.927336070035238
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.0089, Accuracy: 4682/8968 (52.2079%)
poison local model 52 index 2
___PoisonTrain Local_Simple ,  epoch  26, local model 52, internal_epoch   1,  Average loss: 0.0425, Accuracy: 145/253 (57.3123%), train_poison_data_count: 80
class_loss: 5.32328462600708, distance_loss: 0.0
class_loss: 2.627262830734253, distance_loss: 0.4381253123283386
class_loss: 1.2123997211456299, distance_loss: 1.0484310388565063
class_loss: 1.5883524417877197, distance_loss: 1.5872080326080322
class_loss: 1.805970549583435, distance_loss: 2.028566598892212
class_loss: 1.4194203615188599, distance_loss: 2.420614719390869
class_loss: 1.2836418151855469, distance_loss: 2.779130220413208
class_loss: 1.27042818069458, distance_loss: 3.1121973991394043
___PoisonTrain Local_Simple ,  epoch  26, local model 52, internal_epoch   2,  Average loss: 0.0228, Accuracy: 100/253 (39.5257%), train_poison_data_count: 80
Global model norm: 16.211647198320488.
Norm before scaling: 16.051039351325898. Distance: 3.4223830311907837
Total norm for 3 adversaries is: 16.051039351325898. distance: 3.4223830311907837
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.1779, Accuracy: 5895/8968 (65.7337%)
___Train Local_Simple,  epoch  26, local model 90, internal_epoch   1,  Average loss: 0.0018, Accuracy: 664/683 (97.2182%)
___Train Local_Simple,  epoch  26, local model 90, internal_epoch   2,  Average loss: 0.0009, Accuracy: 674/683 (98.6823%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7986, Accuracy: 7838/10000 (78.3800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 63, 52]
base_p: [-0.00672607  0.00038215 -0.00187395 ... -0.00396892 -0.00615206
 -0.00047324]
[T_SCORE] attacker_local_idxs is:  [4, 5, 6, 7, 8]
layer1_inf_time: 3.636474609375
[PAIRWISE] pred_attackers_indx:  [5 7 8]
layer2_inf_t: 41.31884765625
assumed final_attacker_idxs:  [4 5 6 7 8]
final_attacker_idxs is: [4, 5, 6, 7, 8]
g_attacker_idxs: [53 26 60 63 52]
g_normal_idxs: [25  8 12 99 90]
filtered_attacker_idxs: [4, 5, 6, 7, 8]
final_attacker_idxs are: [4, 5, 6, 7, 8]
num_dps: [647, 633, 1160, 377, 739, 554, 338, 889, 253, 683]
time spent on training: 54.31605410575867
Starting performing KrMLRFL...
Num data points: [647, 633, 1160, 377, 739, 554, 338, 889, 253, 683]
Num selected data points: [ 647  633 1160  377  683]
The chosen ones are users: [0, 1, 2, 3, 9], which are global users: [25, 8, 12, 99, 90]
epoch_acc: 97.91
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0663, Accuracy: 9791/10000 (97.9100%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 11.0829, Accuracy: 42/8968 (0.4683%)
Done in 59.70318841934204 sec.
Server Epoch:27 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  27, local model 66, internal_epoch   1,  Average loss: 0.0007, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch  27, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 654/660 (99.0909%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2617, Accuracy: 9181/10000 (91.8100%)
___Train Local_Simple,  epoch  27, local model 33, internal_epoch   1,  Average loss: 0.0013, Accuracy: 605/623 (97.1108%)
___Train Local_Simple,  epoch  27, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 606/623 (97.2713%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1419, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  27, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 876/880 (99.5455%)
___Train Local_Simple,  epoch  27, local model 56, internal_epoch   2,  Average loss: 0.0002, Accuracy: 878/880 (99.7727%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0865, Accuracy: 9735/10000 (97.3500%)
___Train Local_Simple,  epoch  27, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 483/487 (99.1786%)
___Train Local_Simple,  epoch  27, local model 97, internal_epoch   2,  Average loss: 0.0003, Accuracy: 483/487 (99.1786%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1515, Accuracy: 9515/10000 (95.1500%)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 878/892 (98.4305%)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 885/892 (99.2152%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1604, Accuracy: 9473/10000 (94.7300%)
poison local model 13 index 0
class_loss: 3.332256555557251, distance_loss: 0.0
class_loss: 2.161559820175171, distance_loss: 0.3129703402519226
class_loss: 1.8451839685440063, distance_loss: 0.7550302743911743
class_loss: 1.4899566173553467, distance_loss: 1.0980174541473389
class_loss: 1.2529743909835815, distance_loss: 1.4378708600997925
class_loss: 1.3357253074645996, distance_loss: 1.7505476474761963
class_loss: 1.1784133911132812, distance_loss: 2.0310723781585693
class_loss: 1.0910766124725342, distance_loss: 2.2934136390686035
class_loss: 0.9408151507377625, distance_loss: 2.5321974754333496
class_loss: 1.0749311447143555, distance_loss: 2.7543349266052246
class_loss: 0.829239547252655, distance_loss: 2.9615442752838135
class_loss: 0.8945775628089905, distance_loss: 3.155576705932617
class_loss: 1.141042709350586, distance_loss: 3.344769239425659
class_loss: 1.0442779064178467, distance_loss: 3.502578020095825
class_loss: 0.7479332685470581, distance_loss: 3.6331703662872314
class_loss: 0.5175158381462097, distance_loss: 3.7535808086395264
class_loss: 0.4990151822566986, distance_loss: 3.8770060539245605
class_loss: 0.5006925463676453, distance_loss: 4.004035472869873
class_loss: 0.5518894791603088, distance_loss: 4.132876873016357
class_loss: 0.2295541912317276, distance_loss: 4.264955043792725
class_loss: 0.163556307554245, distance_loss: 4.396666526794434
class_loss: 0.5336324572563171, distance_loss: 4.523221492767334
class_loss: 0.40356314182281494, distance_loss: 4.640989780426025
class_loss: 0.3473748564720154, distance_loss: 4.743614196777344
___PoisonTrain Local_Simple ,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0237, Accuracy: 418/734 (56.9482%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  27, local model 13, internal_epoch   2,  Average loss: 0.0091, Accuracy: 559/734 (76.1580%), train_poison_data_count: 240
Global model norm: 16.19798993485573.
Norm before scaling: 16.545796043080514. Distance: 4.83418678553502
Total norm for 1 adversaries is: 16.545796043080514. distance: 4.83418678553502
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0072, Accuracy: 8950/8968 (99.7993%)
___Train Local_Simple,  epoch  27, local model 77, internal_epoch   1,  Average loss: 0.0014, Accuracy: 570/589 (96.7742%)
___Train Local_Simple,  epoch  27, local model 77, internal_epoch   2,  Average loss: 0.0009, Accuracy: 580/589 (98.4720%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0954, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 850/860 (98.8372%)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 854/860 (99.3023%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2224, Accuracy: 9377/10000 (93.7700%)
___Train Local_Simple,  epoch  27, local model 90, internal_epoch   1,  Average loss: 0.0009, Accuracy: 675/683 (98.8287%)
___Train Local_Simple,  epoch  27, local model 90, internal_epoch   2,  Average loss: 0.0006, Accuracy: 674/683 (98.6823%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.4069, Accuracy: 8710/10000 (87.1000%)
___Train Local_Simple,  epoch  27, local model 59, internal_epoch   1,  Average loss: 0.0015, Accuracy: 740/760 (97.3684%)
___Train Local_Simple,  epoch  27, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 748/760 (98.4211%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2796, Accuracy: 9062/10000 (90.6200%)
time spent on training: 38.30134201049805
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13]
base_p: [ 0.0015636   0.00031306 -0.00113657 ... -0.0013525   0.00056263
 -0.00222509]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 6, 9]
layer1_inf_time: 4.23876953125
[PAIRWISE] pred_attackers_indx:  [5]
layer2_inf_t: 60.379150390625
assumed final_attacker_idxs:  [0 1 5 6 9]
final_attacker_idxs is: [0, 1, 5, 6, 9]
g_attacker_idxs: [66 33 13 77 59]
g_normal_idxs: [56 97 10 37 90]
filtered_attacker_idxs: [0, 1, 5, 6, 9]
final_attacker_idxs are: [0, 1, 5, 6, 9]
num_dps: [660, 623, 880, 487, 892, 734, 589, 860, 683, 760]
Starting performing KrMLRFL...
Num data points: [660, 623, 880, 487, 892, 734, 589, 860, 683, 760]
Num selected data points: [880 487 892 860 683]
The chosen ones are users: [2, 3, 4, 7, 8], which are global users: [56, 97, 10, 37, 90]
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0780, Accuracy: 9749/10000 (97.4900%)
epoch_acc: 97.49
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 13.3824, Accuracy: 20/8968 (0.2230%)
Done in 43.96368050575256 sec.
Server Epoch:28 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  28, local model 55, internal_epoch   1,  Average loss: 0.0011, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch  28, local model 55, internal_epoch   2,  Average loss: 0.0004, Accuracy: 352/354 (99.4350%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4210, Accuracy: 8735/10000 (87.3500%)
___Train Local_Simple,  epoch  28, local model 58, internal_epoch   1,  Average loss: 0.0013, Accuracy: 269/276 (97.4638%)
___Train Local_Simple,  epoch  28, local model 58, internal_epoch   2,  Average loss: 0.0006, Accuracy: 272/276 (98.5507%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.4048, Accuracy: 9012/10000 (90.1200%)
___Train Local_Simple,  epoch  28, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 521/530 (98.3019%)
___Train Local_Simple,  epoch  28, local model 88, internal_epoch   2,  Average loss: 0.0005, Accuracy: 524/530 (98.8679%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1288, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch  28, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  28, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1144, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch  28, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 251/257 (97.6654%)
___Train Local_Simple,  epoch  28, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1196, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch  28, local model 75, internal_epoch   1,  Average loss: 0.0017, Accuracy: 661/686 (96.3557%)
___Train Local_Simple,  epoch  28, local model 75, internal_epoch   2,  Average loss: 0.0006, Accuracy: 678/686 (98.8338%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1542, Accuracy: 9509/10000 (95.0900%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0016, Accuracy: 692/713 (97.0547%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   2,  Average loss: 0.0012, Accuracy: 696/713 (97.6157%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.6631, Accuracy: 8575/10000 (85.7500%)
poison local model 61 index 0
class_loss: 4.594000339508057, distance_loss: 0.0
class_loss: 2.2897109985351562, distance_loss: 0.38452988862991333
class_loss: 1.5672286748886108, distance_loss: 0.9022554755210876
class_loss: 1.174120306968689, distance_loss: 1.3931424617767334
class_loss: 1.2325375080108643, distance_loss: 1.8335400819778442
class_loss: 1.297045111656189, distance_loss: 2.2232742309570312
class_loss: 1.1351433992385864, distance_loss: 2.5728914737701416
class_loss: 1.1738317012786865, distance_loss: 2.8868448734283447
class_loss: 1.337052345275879, distance_loss: 3.1683237552642822
class_loss: 1.066277265548706, distance_loss: 3.422914505004883
class_loss: 0.9565163254737854, distance_loss: 3.6536989212036133
___PoisonTrain Local_Simple ,  epoch  28, local model 61, internal_epoch   1,  Average loss: 0.0255, Accuracy: 368/699 (52.6466%), train_poison_data_count: 220
___PoisonTrain Local_Simple ,  epoch  28, local model 61, internal_epoch   2,  Average loss: 0.0126, Accuracy: 453/699 (64.8069%), train_poison_data_count: 220
Global model norm: 16.169648095467323.
Norm before scaling: 16.402751673154473. Distance: 5.152871244439122
Total norm for 2 adversaries is: 16.402751673154473. distance: 5.152871244439122
class_loss: 0.8461957573890686, distance_loss: 3.8656058311462402
class_loss: 1.0265380144119263, distance_loss: 4.058445453643799
class_loss: 1.0498523712158203, distance_loss: 4.229753494262695
class_loss: 0.8230938911437988, distance_loss: 4.378105163574219
class_loss: 0.7083504796028137, distance_loss: 4.512075901031494
class_loss: 0.8009358644485474, distance_loss: 4.6337385177612305
class_loss: 0.6810173988342285, distance_loss: 4.743126392364502
class_loss: 0.73415207862854, distance_loss: 4.840097427368164
class_loss: 0.6346969604492188, distance_loss: 4.9271345138549805
class_loss: 0.7365320324897766, distance_loss: 5.008261680603027
class_loss: 0.7924454808235168, distance_loss: 5.0828375816345215
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 0.9766, Accuracy: 4461/8968 (49.7435%)
___Train Local_Simple,  epoch  28, local model 95, internal_epoch   1,  Average loss: 0.0009, Accuracy: 591/602 (98.1728%)
___Train Local_Simple,  epoch  28, local model 95, internal_epoch   2,  Average loss: 0.0005, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 1.8324, Accuracy: 7549/10000 (75.4900%)
poison local model 93 index 1
class_loss: 3.417160987854004, distance_loss: 0.0
class_loss: 2.228339433670044, distance_loss: 0.3109973967075348
class_loss: 1.766106128692627, distance_loss: 0.8303152918815613
class_loss: 2.7757043838500977, distance_loss: 1.2454867362976074
class_loss: 1.3402255773544312, distance_loss: 1.5751738548278809
class_loss: 1.57871413230896, distance_loss: 1.9338237047195435
class_loss: 1.527297854423523, distance_loss: 2.2785346508026123
class_loss: 1.3935916423797607, distance_loss: 2.5876333713531494
class_loss: 1.3171690702438354, distance_loss: 2.8672049045562744
class_loss: 1.3109748363494873, distance_loss: 3.120438575744629
class_loss: 1.0836368799209595, distance_loss: 3.357161283493042
class_loss: 1.036154866218567, distance_loss: 3.5755083560943604
class_loss: 1.0065925121307373, distance_loss: 3.7769529819488525
___PoisonTrain Local_Simple ,  epoch  28, local model 93, internal_epoch   1,  Average loss: 0.0299, Accuracy: 313/623 (50.2408%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  28, local model 93, internal_epoch   2,  Average loss: 0.0154, Accuracy: 349/623 (56.0193%), train_poison_data_count: 200
Global model norm: 16.169648095467323.
Norm before scaling: 16.416671727110312. Distance: 4.906076416054982
Total norm for 2 adversaries is: 16.416671727110312. distance: 4.906076416054982
class_loss: 0.9873665571212769, distance_loss: 3.9637949466705322
class_loss: 0.8719067573547363, distance_loss: 4.134026527404785
class_loss: 0.9715012311935425, distance_loss: 4.290334701538086
class_loss: 0.9494352340698242, distance_loss: 4.432829856872559
class_loss: 0.7867693305015564, distance_loss: 4.562513828277588
class_loss: 0.8799464106559753, distance_loss: 4.683437347412109
class_loss: 1.0099482536315918, distance_loss: 4.795439720153809
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.0476, Accuracy: 4302/8968 (47.9706%)
time spent on training: 47.97682809829712
Starting performing KrMLRFL...
Num data points: [354, 276, 530, 293, 257, 686, 713, 699, 602, 623]
Num selected data points: [354 276 530 293 686]
The chosen ones are users: [0, 1, 2, 3, 5], which are global users: [55, 58, 88, 23, 75]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 93]
base_p: [-0.00275494  0.00027796  0.0012595  ... -0.00737801 -0.01796897
 -0.00531188]
[T_SCORE] attacker_local_idxs is:  [4, 6, 7, 8, 9]
layer1_inf_time: 3.765625
[PAIRWISE] pred_attackers_indx:  [7 9]
layer2_inf_t: 40.33251953125
assumed final_attacker_idxs:  [4 6 7 8 9]
final_attacker_idxs is: [4, 6, 7, 8, 9]
g_attacker_idxs: [39 82 61 95 93]
g_normal_idxs: [55 58 88 23 75]
filtered_attacker_idxs: [4, 6, 7, 8, 9]
final_attacker_idxs are: [4, 6, 7, 8, 9]
num_dps: [354, 276, 530, 293, 257, 686, 713, 699, 602, 623]
epoch_acc: 97.85000000000001
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0698, Accuracy: 9785/10000 (97.8500%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 12.1905, Accuracy: 45/8968 (0.5018%)
Done in 54.3535590171814 sec.
Server Epoch:29 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0003, Accuracy: 855/860 (99.4186%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1194, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch  29, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 400/408 (98.0392%)
___Train Local_Simple,  epoch  29, local model 43, internal_epoch   2,  Average loss: 0.0024, Accuracy: 394/408 (96.5686%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0872, Accuracy: 9727/10000 (97.2700%)
___Train Local_Simple,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0021, Accuracy: 461/474 (97.2574%)
___Train Local_Simple,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0007, Accuracy: 470/474 (99.1561%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2076, Accuracy: 9284/10000 (92.8400%)
___Train Local_Simple,  epoch  29, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1224/1246 (98.2343%)
___Train Local_Simple,  epoch  29, local model 84, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1233/1246 (98.9567%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0923, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 639/647 (98.7635%)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2273, Accuracy: 9308/10000 (93.0800%)
___Train Local_Simple,  epoch  29, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 494/501 (98.6028%)
___Train Local_Simple,  epoch  29, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0755, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 622/633 (98.2622%)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 630/633 (99.5261%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0802, Accuracy: 9734/10000 (97.3400%)
poison local model 16 index 0
class_loss: 3.221613883972168, distance_loss: 0.0
class_loss: 2.1971957683563232, distance_loss: 0.29108840227127075
class_loss: 1.4063925743103027, distance_loss: 0.735164225101471
class_loss: 1.0643393993377686, distance_loss: 1.0734859704971313
class_loss: 0.8114152550697327, distance_loss: 1.3786413669586182
class_loss: 0.923045814037323, distance_loss: 1.6673879623413086
class_loss: 1.0559314489364624, distance_loss: 1.9153516292572021
class_loss: 1.0470281839370728, distance_loss: 2.1313600540161133
class_loss: 1.1882562637329102, distance_loss: 2.3226420879364014
class_loss: 0.9845178127288818, distance_loss: 2.495858907699585
class_loss: 0.7742055654525757, distance_loss: 2.6562886238098145
class_loss: 0.6304583549499512, distance_loss: 2.8079776763916016
class_loss: 0.7089968323707581, distance_loss: 2.9595630168914795
class_loss: 0.608375072479248, distance_loss: 3.1034858226776123
class_loss: 0.07651263475418091, distance_loss: 3.242438793182373
class_loss: 0.5257720351219177, distance_loss: 3.3879425525665283
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0182, Accuracy: 583/915 (63.7158%), train_poison_data_count: 299
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 849/915 (92.7869%), train_poison_data_count: 299
Global model norm: 16.15155067203543.
Norm before scaling: 16.56860883804446. Distance: 4.555484342147686
Total norm for 1 adversaries is: 16.56860883804446. distance: 4.555484342147686
class_loss: 0.28926604986190796, distance_loss: 3.5126986503601074
class_loss: 0.28006550669670105, distance_loss: 3.624720335006714
class_loss: 0.34803202748298645, distance_loss: 3.727482318878174
class_loss: 0.4239378869533539, distance_loss: 3.820838212966919
class_loss: 0.33872541785240173, distance_loss: 3.904792308807373
class_loss: 0.34925997257232666, distance_loss: 3.981835126876831
class_loss: 0.16316841542720795, distance_loss: 4.054837703704834
class_loss: 0.11629258841276169, distance_loss: 4.123970985412598
class_loss: 0.2191762626171112, distance_loss: 4.190213680267334
class_loss: 0.11607301980257034, distance_loss: 4.253074645996094
class_loss: 0.19135627150535583, distance_loss: 4.314685821533203
class_loss: 0.09741286188364029, distance_loss: 4.378717422485352
class_loss: 0.09902841597795486, distance_loss: 4.440322399139404
class_loss: 0.01863984391093254, distance_loss: 4.498621940612793
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.0703, Accuracy: 8716/8968 (97.1900%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0009, Accuracy: 604/615 (98.2114%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 610/615 (99.1870%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1741, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 906/923 (98.1582%)
___Train Local_Simple,  epoch  29, local model 3, internal_epoch   2,  Average loss: 0.0011, Accuracy: 898/923 (97.2914%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1852, Accuracy: 9454/10000 (94.5400%)
time spent on training: 41.71052575111389
Starting performing KrMLRFL...
Num data points: [860, 408, 474, 1246, 647, 501, 633, 915, 615, 923]
Num selected data points: [860 408 474 501 615]
The chosen ones are users: [0, 1, 2, 5, 8], which are global users: [37, 43, 50, 28, 6]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16]
base_p: [-0.00207341  0.00049338 -0.0023101  ... -0.00084449 -0.00197972
  0.00228389]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 9]
layer1_inf_time: 3.53857421875
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 37.862548828125
assumed final_attacker_idxs:  [3 4 6 7 9]
final_attacker_idxs is: [3, 4, 6, 7, 9]
g_attacker_idxs: [84 25  8 16  3]
g_normal_idxs: [37 43 50 28  6]
filtered_attacker_idxs: [3, 4, 6, 7, 9]
final_attacker_idxs are: [3, 4, 6, 7, 9]
num_dps: [860, 408, 474, 1246, 647, 501, 633, 915, 615, 923]
epoch_acc: 98.39
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0491, Accuracy: 9839/10000 (98.3900%)
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 12.0041, Accuracy: 19/8968 (0.2119%)
Done in 48.813337087631226 sec.
Server Epoch:30 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
___Train Local_Simple,  epoch  30, local model 23, internal_epoch   1,  Average loss: 0.0003, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch  30, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0857, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch  30, local model 43, internal_epoch   1,  Average loss: 0.0008, Accuracy: 402/408 (98.5294%)
___Train Local_Simple,  epoch  30, local model 43, internal_epoch   2,  Average loss: 0.0011, Accuracy: 401/408 (98.2843%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1020, Accuracy: 9698/10000 (96.9800%)
poison local model 27 index 0
class_loss: 3.9194366931915283, distance_loss: 0.0
class_loss: 2.563859701156616, distance_loss: 0.30084410309791565
class_loss: 1.3853503465652466, distance_loss: 0.782593846321106
class_loss: 1.5677454471588135, distance_loss: 1.2707003355026245
class_loss: 1.7846367359161377, distance_loss: 1.6309218406677246
class_loss: 1.5173002481460571, distance_loss: 1.943069338798523
class_loss: 1.5383137464523315, distance_loss: 2.2209835052490234
class_loss: 1.3530420064926147, distance_loss: 2.4748711585998535
class_loss: 1.2791402339935303, distance_loss: 2.724055051803589
class_loss: 1.172654151916504, distance_loss: 2.9518561363220215
class_loss: 1.1572426557540894, distance_loss: 3.160285711288452
class_loss: 1.1491808891296387, distance_loss: 3.3475608825683594
class_loss: 1.0600084066390991, distance_loss: 3.5171542167663574
class_loss: 1.1035077571868896, distance_loss: 3.670121908187866
class_loss: 1.05083429813385, distance_loss: 3.8124606609344482
class_loss: 1.2685041427612305, distance_loss: 3.9462554454803467
___PoisonTrain Local_Simple ,  epoch  30, local model 27, internal_epoch   1,  Average loss: 0.0332, Accuracy: 232/471 (49.2569%), train_poison_data_count: 160
___PoisonTrain Local_Simple ,  epoch  30, local model 27, internal_epoch   2,  Average loss: 0.0196, Accuracy: 220/471 (46.7091%), train_poison_data_count: 160
Global model norm: 16.107181136986306.
Norm before scaling: 16.11110544021916. Distance: 4.091974470340445
Total norm for 3 adversaries is: 16.11110544021916. distance: 4.091974470340445
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.8069, Accuracy: 6324/8968 (70.5174%)
___Train Local_Simple,  epoch  30, local model 82, internal_epoch   1,  Average loss: 0.0011, Accuracy: 699/713 (98.0365%)
___Train Local_Simple,  epoch  30, local model 82, internal_epoch   2,  Average loss: 0.0004, Accuracy: 707/713 (99.1585%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.5529, Accuracy: 8734/10000 (87.3400%)
___Train Local_Simple,  epoch  30, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch  30, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1083, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch  30, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 493/499 (98.7976%)
___Train Local_Simple,  epoch  30, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0922, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch  30, local model 29, internal_epoch   1,  Average loss: 0.0008, Accuracy: 983/1002 (98.1038%)
___Train Local_Simple,  epoch  30, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 994/1002 (99.2016%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2735, Accuracy: 9094/10000 (90.9400%)
___Train Local_Simple,  epoch  30, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 769/776 (99.0979%)
___Train Local_Simple,  epoch  30, local model 47, internal_epoch   2,  Average loss: 0.0006, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0954, Accuracy: 9702/10000 (97.0200%)
poison local model 11 index 1
class_loss: 4.373291015625, distance_loss: 0.0
class_loss: 2.6158082485198975, distance_loss: 0.3085193932056427
class_loss: 1.5563960075378418, distance_loss: 0.7962132096290588
class_loss: 1.3948910236358643, distance_loss: 1.3056323528289795
class_loss: 1.7232064008712769, distance_loss: 1.7166529893875122
class_loss: 1.513008713722229, distance_loss: 2.0641510486602783
class_loss: 1.6410413980484009, distance_loss: 2.3694708347320557
class_loss: 1.4073922634124756, distance_loss: 2.640646457672119
class_loss: 1.5553264617919922, distance_loss: 2.884913921356201
class_loss: 1.3996890783309937, distance_loss: 3.1083202362060547
class_loss: 0.6127412915229797, distance_loss: 3.310608386993408
___PoisonTrain Local_Simple ,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0307, Accuracy: 325/645 (50.3876%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  30, local model 11, internal_epoch   2,  Average loss: 0.0216, Accuracy: 304/645 (47.1318%), train_poison_data_count: 205
Global model norm: 16.107181136986306.
Norm before scaling: 16.265443945618173. Distance: 4.8473206187951385
Total norm for 3 adversaries is: 16.265443945618173. distance: 4.8473206187951385
class_loss: 1.5157479047775269, distance_loss: 3.515368700027466
class_loss: 1.6141904592514038, distance_loss: 3.695244073867798
class_loss: 1.387027621269226, distance_loss: 3.842318296432495
class_loss: 1.054241418838501, distance_loss: 3.9673614501953125
class_loss: 1.0462843179702759, distance_loss: 4.083138465881348
class_loss: 1.1472634077072144, distance_loss: 4.194962501525879
class_loss: 1.162139892578125, distance_loss: 4.3038649559021
class_loss: 0.9526504278182983, distance_loss: 4.410266399383545
class_loss: 0.8479899764060974, distance_loss: 4.51651668548584
class_loss: 0.9606496691703796, distance_loss: 4.619290828704834
class_loss: 2.23895263671875, distance_loss: 4.715272903442383
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.7233, Accuracy: 6564/8968 (73.1936%)
poison local model 42 index 2
class_loss: 3.0747663974761963, distance_loss: 0.0
class_loss: 2.075305223464966, distance_loss: 0.255550742149353
class_loss: 1.01949942111969, distance_loss: 0.6400729417800903
class_loss: 1.1263073682785034, distance_loss: 1.0620392560958862
class_loss: 1.4884546995162964, distance_loss: 1.4666590690612793
class_loss: 1.0971206426620483, distance_loss: 1.7963900566101074
class_loss: 1.2631133794784546, distance_loss: 2.080925703048706
class_loss: 1.174383282661438, distance_loss: 2.3327419757843018
___PoisonTrain Local_Simple ,  epoch  30, local model 42, internal_epoch   1,  Average loss: 0.0309, Accuracy: 164/236 (69.4915%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  30, local model 42, internal_epoch   2,  Average loss: 0.0213, Accuracy: 122/236 (51.6949%), train_poison_data_count: 80
Global model norm: 16.107181136986306.
Norm before scaling: 15.900430330415048. Distance: 2.5617905541839012
Total norm for 3 adversaries is: 15.900430330415048. distance: 2.5617905541839012
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.1425, Accuracy: 6904/8968 (76.9848%)
time spent on training: 53.54091215133667
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 11, 42]
base_p: [-0.00446308  0.00039142 -0.00120465 ... -0.00248244 -0.01018846
 -0.00098147]
[T_SCORE] attacker_local_idxs is:  [2, 3, 6, 8, 9]
layer1_inf_time: 3.952880859375
[PAIRWISE] pred_attackers_indx:  [2 8 9]
layer2_inf_t: 57.846435546875
assumed final_attacker_idxs:  [2 3 6 8 9]
final_attacker_idxs is: [2, 3, 6, 8, 9]
g_attacker_idxs: [27 82 29 11 42]
g_normal_idxs: [23 43 37 35 47]
filtered_attacker_idxs: [2, 3, 6, 8, 9]
final_attacker_idxs are: [2, 3, 6, 8, 9]
num_dps: [293, 408, 471, 713, 860, 499, 1002, 776, 645, 236]
Starting performing KrMLRFL...
Num data points: [293, 408, 471, 713, 860, 499, 1002, 776, 645, 236]
Num selected data points: [293 408 860 499 776]
The chosen ones are users: [0, 1, 4, 5, 7], which are global users: [23, 43, 37, 35, 47]
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0512, Accuracy: 9832/10000 (98.3200%)
epoch_acc: 98.32
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 13.3971, Accuracy: 23/8968 (0.2565%)
Done in 59.157808780670166 sec.
Server Epoch:31 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
___Train Local_Simple,  epoch  31, local model 33, internal_epoch   1,  Average loss: 0.0010, Accuracy: 612/623 (98.2343%)
___Train Local_Simple,  epoch  31, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 611/623 (98.0738%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3299, Accuracy: 8961/10000 (89.6100%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1144/1160 (98.6207%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1155/1160 (99.5690%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2578, Accuracy: 9338/10000 (93.3800%)
poison local model 93 index 0
class_loss: 4.356251239776611, distance_loss: 0.0
class_loss: 2.4123823642730713, distance_loss: 0.329125314950943
class_loss: 1.242179274559021, distance_loss: 0.8724416494369507
class_loss: 1.7882981300354004, distance_loss: 1.3025119304656982
class_loss: 1.6148251295089722, distance_loss: 1.63191819190979
class_loss: 1.5169095993041992, distance_loss: 1.9312254190444946
class_loss: 1.481265664100647, distance_loss: 2.206557512283325
class_loss: 1.3762609958648682, distance_loss: 2.450632095336914
class_loss: 1.177280306816101, distance_loss: 2.6711370944976807
class_loss: 1.0742104053497314, distance_loss: 2.878253221511841
___PoisonTrain Local_Simple ,  epoch  31, local model 93, internal_epoch   1,  Average loss: 0.0290, Accuracy: 308/623 (49.4382%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  31, local model 93, internal_epoch   2,  Average loss: 0.0157, Accuracy: 323/623 (51.8459%), train_poison_data_count: 200
Global model norm: 16.064831041337435.
Norm before scaling: 16.17538269627936. Distance: 4.385877764722798
Total norm for 3 adversaries is: 16.17538269627936. distance: 4.385877764722798
class_loss: 1.202820062637329, distance_loss: 3.0787124633789062
class_loss: 1.1498311758041382, distance_loss: 3.262118339538574
class_loss: 0.9726512432098389, distance_loss: 3.431168556213379
class_loss: 0.8685650825500488, distance_loss: 3.590043544769287
class_loss: 0.9257700443267822, distance_loss: 3.7361056804656982
class_loss: 0.853637158870697, distance_loss: 3.869872808456421
class_loss: 0.8392382860183716, distance_loss: 3.99416184425354
class_loss: 0.941592276096344, distance_loss: 4.1066741943359375
class_loss: 0.9993013739585876, distance_loss: 4.20450496673584
class_loss: 0.9970521330833435, distance_loss: 4.295055866241455
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.3277, Accuracy: 2706/8968 (30.1740%)
___Train Local_Simple,  epoch  31, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 394/401 (98.2544%)
___Train Local_Simple,  epoch  31, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0999, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.0009, Accuracy: 597/606 (98.5149%)
___Train Local_Simple,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.3411, Accuracy: 8977/10000 (89.7700%)
___Train Local_Simple,  epoch  31, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 483/487 (99.1786%)
___Train Local_Simple,  epoch  31, local model 97, internal_epoch   2,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2432, Accuracy: 9329/10000 (93.2900%)
poison local model 20 index 1
class_loss: 4.975128173828125, distance_loss: 0.0
class_loss: 3.1633214950561523, distance_loss: 0.40301987528800964
class_loss: 2.072252035140991, distance_loss: 0.9265363216400146
class_loss: 1.4415056705474854, distance_loss: 1.4459820985794067
class_loss: 1.2073006629943848, distance_loss: 1.918591856956482
class_loss: 1.4018101692199707, distance_loss: 2.3273983001708984
class_loss: 1.2350085973739624, distance_loss: 2.6840739250183105
class_loss: 1.1874656677246094, distance_loss: 3.004098415374756
class_loss: 1.3417245149612427, distance_loss: 3.2940969467163086
___PoisonTrain Local_Simple ,  epoch  31, local model 20, internal_epoch   1,  Average loss: 0.0361, Accuracy: 215/429 (50.1166%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  31, local model 20, internal_epoch   2,  Average loss: 0.0187, Accuracy: 220/429 (51.2821%), train_poison_data_count: 140
Global model norm: 16.064831041337435.
Norm before scaling: 15.985732392878305. Distance: 4.520353277123371
Total norm for 3 adversaries is: 15.985732392878305. distance: 4.520353277123371
class_loss: 1.1027158498764038, distance_loss: 3.557467222213745
class_loss: 1.431471347808838, distance_loss: 3.794095277786255
class_loss: 0.9868539571762085, distance_loss: 4.003173351287842
class_loss: 1.0326796770095825, distance_loss: 4.191883087158203
class_loss: 0.9481377601623535, distance_loss: 4.3636250495910645
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.6432, Accuracy: 8133/8968 (90.6891%)
___Train Local_Simple,  epoch  31, local model 86, internal_epoch   1,  Average loss: 0.0008, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch  31, local model 86, internal_epoch   2,  Average loss: 0.0003, Accuracy: 249/250 (99.6000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1185, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch  31, local model 54, internal_epoch   1,  Average loss: 0.0009, Accuracy: 504/519 (97.1098%)
___Train Local_Simple,  epoch  31, local model 54, internal_epoch   2,  Average loss: 0.0010, Accuracy: 509/519 (98.0732%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1991, Accuracy: 9377/10000 (93.7700%)
poison local model 52 index 2
class_loss: 4.209575653076172, distance_loss: 0.0
class_loss: 2.5169179439544678, distance_loss: 0.3825345039367676
class_loss: 1.7076992988586426, distance_loss: 0.9376419186592102
class_loss: 2.452998399734497, distance_loss: 1.4126062393188477
class_loss: 1.721177339553833, distance_loss: 1.79866361618042
class_loss: 1.5989545583724976, distance_loss: 2.153228759765625
class_loss: 1.602352499961853, distance_loss: 2.485365867614746
class_loss: 1.521339774131775, distance_loss: 2.7941434383392334
___PoisonTrain Local_Simple ,  epoch  31, local model 52, internal_epoch   1,  Average loss: 0.0430, Accuracy: 130/253 (51.3834%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  31, local model 52, internal_epoch   2,  Average loss: 0.0255, Accuracy: 98/253 (38.7352%), train_poison_data_count: 80
Global model norm: 16.064831041337435.
Norm before scaling: 15.838827418072722. Distance: 3.076242403705368
Total norm for 3 adversaries is: 15.838827418072722. distance: 3.076242403705368
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.5329, Accuracy: 3444/8968 (38.4032%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93, 20, 52]
base_p: [-0.00297387  0.00026821 -0.0003322  ... -0.00236522 -0.0014853
 -0.00138705]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 9]
layer1_inf_time: 3.37060546875
[PAIRWISE] pred_attackers_indx:  [2 6 9]
layer2_inf_t: 80.144287109375
assumed final_attacker_idxs:  [0 1 2 6 9]
final_attacker_idxs is: [0, 1, 2, 6, 9]
g_attacker_idxs: [33 12 93 20 52]
g_normal_idxs: [15 41 97 86 54]
filtered_attacker_idxs: [0, 1, 2, 6, 9]
final_attacker_idxs are: [0, 1, 2, 6, 9]
num_dps: [623, 1160, 623, 401, 606, 487, 429, 250, 519, 253]
time spent on training: 52.85528802871704
Starting performing KrMLRFL...
Num data points: [623, 1160, 623, 401, 606, 487, 429, 250, 519, 253]
Num selected data points: [401 606 487 250 519]
The chosen ones are users: [3, 4, 5, 7, 8], which are global users: [15, 41, 97, 86, 54]
epoch_acc: 98.27
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0492, Accuracy: 9827/10000 (98.2700%)
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 12.5780, Accuracy: 32/8968 (0.3568%)
Done in 59.26641297340393 sec.
Server Epoch:32 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
___Train Local_Simple,  epoch  32, local model 24, internal_epoch   1,  Average loss: 0.0014, Accuracy: 369/379 (97.3615%)
___Train Local_Simple,  epoch  32, local model 24, internal_epoch   2,  Average loss: 0.0006, Accuracy: 375/379 (98.9446%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1243, Accuracy: 9603/10000 (96.0300%)
___Train Local_Simple,  epoch  32, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 879/895 (98.2123%)
___Train Local_Simple,  epoch  32, local model 38, internal_epoch   2,  Average loss: 0.0007, Accuracy: 885/895 (98.8827%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.2794, Accuracy: 9183/10000 (91.8300%)
poison local model 42 index 0
class_loss: 3.030195951461792, distance_loss: 0.0
class_loss: 2.076353073120117, distance_loss: 0.2517591118812561
class_loss: 1.0543591976165771, distance_loss: 0.6366599798202515
class_loss: 1.3135205507278442, distance_loss: 1.0531705617904663
class_loss: 1.4106454849243164, distance_loss: 1.420961618423462
class_loss: 0.8991078734397888, distance_loss: 1.7253859043121338
class_loss: 0.9883607625961304, distance_loss: 2.00812029838562
class_loss: 1.3305284976959229, distance_loss: 2.260246753692627
___PoisonTrain Local_Simple ,  epoch  32, local model 42, internal_epoch   1,  Average loss: 0.0317, Accuracy: 165/236 (69.9153%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  32, local model 42, internal_epoch   2,  Average loss: 0.0196, Accuracy: 128/236 (54.2373%), train_poison_data_count: 80
Global model norm: 16.029954527030696.
Norm before scaling: 15.789207944808823. Distance: 2.4862326148927507
Total norm for 2 adversaries is: 15.789207944808823. distance: 2.4862326148927507
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.3234, Accuracy: 5128/8968 (57.1811%)
___Train Local_Simple,  epoch  32, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 942/977 (96.4176%)
___Train Local_Simple,  epoch  32, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 961/977 (98.3623%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0929, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch  32, local model 60, internal_epoch   1,  Average loss: 0.0019, Accuracy: 332/338 (98.2249%)
___Train Local_Simple,  epoch  32, local model 60, internal_epoch   2,  Average loss: 0.0011, Accuracy: 332/338 (98.2249%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1101, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 626/633 (98.8942%)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   2,  Average loss: 0.0004, Accuracy: 628/633 (99.2101%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0570, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch  32, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 496/499 (99.3988%)
___Train Local_Simple,  epoch  32, local model 35, internal_epoch   2,  Average loss: 0.0003, Accuracy: 496/499 (99.3988%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1419, Accuracy: 9546/10000 (95.4600%)
___Train Local_Simple,  epoch  32, local model 92, internal_epoch   1,  Average loss: 0.0010, Accuracy: 920/937 (98.1857%)
___Train Local_Simple,  epoch  32, local model 92, internal_epoch   2,  Average loss: 0.0006, Accuracy: 926/937 (98.8260%)
class_loss: 4.277565956115723, distance_loss: 0.0
class_loss: 2.2927958965301514, distance_loss: 0.34009116888046265
class_loss: 1.3561813831329346, distance_loss: 0.8352547883987427
class_loss: 1.7452037334442139, distance_loss: 1.3284320831298828
class_loss: 1.5527873039245605, distance_loss: 1.6944983005523682
class_loss: 1.3672910928726196, distance_loss: 2.0068721771240234
class_loss: 1.4138315916061401, distance_loss: 2.294541835784912
class_loss: 1.4756231307983398, distance_loss: 2.5514163970947266
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1453, Accuracy: 9541/10000 (95.4100%)
poison local model 27 index 1
___PoisonTrain Local_Simple ,  epoch  32, local model 27, internal_epoch   1,  Average loss: 0.0329, Accuracy: 244/471 (51.8047%), train_poison_data_count: 160
class_loss: 1.335096836090088, distance_loss: 2.793314218521118
class_loss: 1.2859447002410889, distance_loss: 3.0066022872924805
class_loss: 1.076673150062561, distance_loss: 3.19635272026062
class_loss: 1.0877033472061157, distance_loss: 3.366048574447632
class_loss: 1.2722258567810059, distance_loss: 3.5206992626190186
class_loss: 1.0725901126861572, distance_loss: 3.6612415313720703
class_loss: 0.9952729940414429, distance_loss: 3.786137819290161
class_loss: 1.2188206911087036, distance_loss: 3.901752471923828
___PoisonTrain Local_Simple ,  epoch  32, local model 27, internal_epoch   2,  Average loss: 0.0198, Accuracy: 227/471 (48.1953%), train_poison_data_count: 160
Global model norm: 16.029954527030696.
Norm before scaling: 16.037171101338096. Distance: 4.034173659331916
Total norm for 2 adversaries is: 16.037171101338096. distance: 4.034173659331916
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.5699, Accuracy: 7630/8968 (85.0803%)
___Train Local_Simple,  epoch  32, local model 96, internal_epoch   1,  Average loss: 0.0011, Accuracy: 659/672 (98.0655%)
___Train Local_Simple,  epoch  32, local model 96, internal_epoch   2,  Average loss: 0.0003, Accuracy: 669/672 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1311, Accuracy: 9611/10000 (96.1100%)
time spent on training: 47.14484453201294
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 27]
base_p: [-0.00183816  0.00066247  0.00221846 ... -0.00324764 -0.01064549
  0.00176166]
[T_SCORE] attacker_local_idxs is:  [2, 4, 7, 8, 9]
layer1_inf_time: 3.313720703125
[PAIRWISE] pred_attackers_indx:  [2 8]
layer2_inf_t: 29.868408203125
assumed final_attacker_idxs:  [2 4 7 8 9]
final_attacker_idxs is: [2, 4, 7, 8, 9]
g_attacker_idxs: [42 60 92 27 96]
g_normal_idxs: [24 38 32  8 35]
filtered_attacker_idxs: [2, 4, 7, 8, 9]
final_attacker_idxs are: [2, 4, 7, 8, 9]
num_dps: [379, 895, 236, 977, 338, 633, 499, 937, 471, 672]
epoch_acc: 98.22999999999999
Starting performing KrMLRFL...
Num data points: [379, 895, 236, 977, 338, 633, 499, 937, 471, 672]
Num selected data points: [379 895 977 633 499]
The chosen ones are users: [0, 1, 3, 5, 6], which are global users: [24, 38, 32, 8, 35]
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0549, Accuracy: 9823/10000 (98.2300%)
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 13.7849, Accuracy: 7/8968 (0.0781%)
Done in 52.62149715423584 sec.
Server Epoch:33 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  33, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 876/880 (99.5455%)
___Train Local_Simple,  epoch  33, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0822, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch  33, local model 82, internal_epoch   1,  Average loss: 0.0010, Accuracy: 701/713 (98.3170%)
___Train Local_Simple,  epoch  33, local model 82, internal_epoch   2,  Average loss: 0.0006, Accuracy: 705/713 (98.8780%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.3035, Accuracy: 9053/10000 (90.5300%)
poison local model 85 index 0
class_loss: 4.986906051635742, distance_loss: 0.0
class_loss: 2.923708438873291, distance_loss: 0.3752295672893524
class_loss: 1.3563690185546875, distance_loss: 0.8864769339561462
class_loss: 1.2838023900985718, distance_loss: 1.4124099016189575
class_loss: 1.3302704095840454, distance_loss: 1.8669042587280273
class_loss: 1.335254430770874, distance_loss: 2.260918140411377
class_loss: 1.3860185146331787, distance_loss: 2.6065115928649902
class_loss: 1.4801807403564453, distance_loss: 2.9104840755462646
class_loss: 1.4037874937057495, distance_loss: 3.178506851196289
class_loss: 1.4364855289459229, distance_loss: 3.4135661125183105
class_loss: 1.3996189832687378, distance_loss: 3.6217501163482666
class_loss: 1.2344211339950562, distance_loss: 3.8058953285217285
class_loss: 1.1737412214279175, distance_loss: 3.973442554473877
class_loss: 1.1356765031814575, distance_loss: 4.1253485679626465
___PoisonTrain Local_Simple ,  epoch  33, local model 85, internal_epoch   1,  Average loss: 0.0339, Accuracy: 246/431 (57.0766%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  33, local model 85, internal_epoch   2,  Average loss: 0.0215, Accuracy: 172/431 (39.9072%), train_poison_data_count: 140
Global model norm: 15.990906992579017.
Norm before scaling: 15.909355415027967. Distance: 4.2674945465213945
Total norm for 4 adversaries is: 15.909355415027967. distance: 4.2674945465213945
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.8076, Accuracy: 7875/8968 (87.8122%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  33, local model 17, internal_epoch   1,  Average loss: 0.0350, Accuracy: 284/620 (45.8065%), train_poison_data_count: 200
class_loss: 5.780932903289795, distance_loss: 0.0
class_loss: 2.811079263687134, distance_loss: 0.41140085458755493
class_loss: 1.6013054847717285, distance_loss: 0.9828988909721375
class_loss: 1.4485942125320435, distance_loss: 1.543023705482483
class_loss: 1.5918421745300293, distance_loss: 2.041680335998535
class_loss: 1.7925571203231812, distance_loss: 2.4732542037963867
class_loss: 1.8044887781143188, distance_loss: 2.8505489826202393
class_loss: 1.6875079870224, distance_loss: 3.1852846145629883
class_loss: 1.6609077453613281, distance_loss: 3.4806180000305176
class_loss: 1.4984962940216064, distance_loss: 3.7448863983154297
class_loss: 1.5851942300796509, distance_loss: 3.9838898181915283
class_loss: 1.3837664127349854, distance_loss: 4.198153972625732
class_loss: 1.389736294746399, distance_loss: 4.391280174255371
class_loss: 1.2896485328674316, distance_loss: 4.566096305847168
class_loss: 1.0198447704315186, distance_loss: 4.725405693054199
class_loss: 0.9979547262191772, distance_loss: 4.872574329376221
class_loss: 1.1579396724700928, distance_loss: 5.010978698730469
class_loss: 1.0999703407287598, distance_loss: 5.135366439819336
class_loss: 1.058764934539795, distance_loss: 5.246159076690674
class_loss: 1.2622742652893066, distance_loss: 5.344472885131836
___PoisonTrain Local_Simple ,  epoch  33, local model 17, internal_epoch   2,  Average loss: 0.0198, Accuracy: 277/620 (44.6774%), train_poison_data_count: 200
Global model norm: 15.990906992579017.
Norm before scaling: 16.15071267837835. Distance: 5.432741735972306
Total norm for 4 adversaries is: 16.15071267837835. distance: 5.432741735972306
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.9745, Accuracy: 5446/8968 (60.7270%)
___Train Local_Simple,  epoch  33, local model 76, internal_epoch   1,  Average loss: 0.0025, Accuracy: 76/78 (97.4359%)
___Train Local_Simple,  epoch  33, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
class_loss: 3.5710511207580566, distance_loss: 0.0
class_loss: 2.4163894653320312, distance_loss: 0.33386436104774475
class_loss: 1.4180206060409546, distance_loss: 0.7860071659088135
class_loss: 1.2945733070373535, distance_loss: 1.2202095985412598
class_loss: 1.2919260263442993, distance_loss: 1.616651177406311
class_loss: 1.281074047088623, distance_loss: 1.9603605270385742
class_loss: 0.8383297920227051, distance_loss: 2.2709662914276123
class_loss: 1.0046650171279907, distance_loss: 2.554105281829834
class_loss: 1.0954023599624634, distance_loss: 2.8116817474365234
class_loss: 0.8410769701004028, distance_loss: 3.0434579849243164
class_loss: 0.7251104116439819, distance_loss: 3.250048875808716
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2259, Accuracy: 9254/10000 (92.5400%)
poison local model 61 index 2
___PoisonTrain Local_Simple ,  epoch  33, local model 61, internal_epoch   1,  Average loss: 0.0226, Accuracy: 410/699 (58.6552%), train_poison_data_count: 220
class_loss: 0.8036515116691589, distance_loss: 3.4369008541107178
class_loss: 0.7621384263038635, distance_loss: 3.6047191619873047
class_loss: 0.8119353652000427, distance_loss: 3.7562811374664307
class_loss: 0.6126999855041504, distance_loss: 3.8922674655914307
class_loss: 0.7532557249069214, distance_loss: 4.015903949737549
class_loss: 0.677190899848938, distance_loss: 4.122513294219971
class_loss: 0.6084375381469727, distance_loss: 4.217447757720947
class_loss: 0.9929253458976746, distance_loss: 4.306925296783447
class_loss: 0.672416627407074, distance_loss: 4.386765480041504
class_loss: 0.7647006511688232, distance_loss: 4.460901737213135
class_loss: 0.8208612203598022, distance_loss: 4.529604911804199
___PoisonTrain Local_Simple ,  epoch  33, local model 61, internal_epoch   2,  Average loss: 0.0118, Accuracy: 476/699 (68.0973%), train_poison_data_count: 220
Global model norm: 15.990906992579017.
Norm before scaling: 16.161273699127957. Distance: 4.592108608423544
Total norm for 4 adversaries is: 16.161273699127957. distance: 4.592108608423544
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.8830, Accuracy: 5257/8968 (58.6195%)
poison local model 26 index 3
class_loss: 3.2711267471313477, distance_loss: 0.0
class_loss: 2.7794957160949707, distance_loss: 0.23766426742076874
class_loss: 0.8239941000938416, distance_loss: 0.6433262228965759
class_loss: 0.6366982460021973, distance_loss: 1.0760884284973145
class_loss: 0.8192134499549866, distance_loss: 1.4742798805236816
class_loss: 0.9524660110473633, distance_loss: 1.8111138343811035
class_loss: 0.9094662070274353, distance_loss: 2.0928757190704346
class_loss: 0.8770833611488342, distance_loss: 2.3335556983947754
class_loss: 0.7394142746925354, distance_loss: 2.5391335487365723
___PoisonTrain Local_Simple ,  epoch  33, local model 26, internal_epoch   1,  Average loss: 0.0213, Accuracy: 405/554 (73.1047%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  33, local model 26, internal_epoch   2,  Average loss: 0.0123, Accuracy: 367/554 (66.2455%), train_poison_data_count: 180
Global model norm: 15.990906992579017.
Norm before scaling: 15.923907059513976. Distance: 3.620024192897822
Total norm for 4 adversaries is: 15.923907059513976. distance: 3.620024192897822
class_loss: 1.0283924341201782, distance_loss: 2.720186948776245
class_loss: 0.8521022200584412, distance_loss: 2.876270294189453
class_loss: 0.8683677911758423, distance_loss: 3.013705015182495
class_loss: 0.780116081237793, distance_loss: 3.133592367172241
class_loss: 0.9371653199195862, distance_loss: 3.2403006553649902
class_loss: 0.6224112510681152, distance_loss: 3.3308169841766357
class_loss: 0.7193348407745361, distance_loss: 3.414165735244751
class_loss: 0.5207706689834595, distance_loss: 3.48754620552063
class_loss: 0.5103936195373535, distance_loss: 3.5555429458618164
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.2557, Accuracy: 8459/8968 (94.3243%)
___Train Local_Simple,  epoch  33, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch  33, local model 86, internal_epoch   2,  Average loss: 0.0002, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1028, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  33, local model 89, internal_epoch   1,  Average loss: 0.0008, Accuracy: 487/492 (98.9837%)
___Train Local_Simple,  epoch  33, local model 89, internal_epoch   2,  Average loss: 0.0004, Accuracy: 488/492 (99.1870%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2578, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch  33, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 674/686 (98.2507%)
___Train Local_Simple,  epoch  33, local model 75, internal_epoch   2,  Average loss: 0.0007, Accuracy: 677/686 (98.6880%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 17, 61, 26]
base_p: [-0.00498254  0.00035095 -0.00098627 ... -0.00096332 -0.00953186
  0.0001532 ]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 5, 6]
layer1_inf_time: 4.0283203125
[PAIRWISE] pred_attackers_indx:  [2 3 5 6]
layer2_inf_t: 37.826416015625
assumed final_attacker_idxs:  [1 2 3 5 6]
final_attacker_idxs is: [1, 2, 3, 5, 6]
g_attacker_idxs: [82 85 17 61 26]
g_normal_idxs: [56 76 86 89 75]
filtered_attacker_idxs: [1, 2, 3, 5, 6]
final_attacker_idxs are: [1, 2, 3, 5, 6]
num_dps: [880, 713, 431, 620, 78, 699, 554, 250, 492, 686]
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1029, Accuracy: 9679/10000 (96.7900%)
time spent on training: 61.63300085067749
Starting performing KrMLRFL...
Num data points: [880, 713, 431, 620, 78, 699, 554, 250, 492, 686]
Num selected data points: [880  78 250 492 686]
The chosen ones are users: [0, 4, 7, 8, 9], which are global users: [56, 76, 86, 89, 75]
epoch_acc: 98.47
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0465, Accuracy: 9847/10000 (98.4700%)
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 13.7551, Accuracy: 20/8968 (0.2230%)
Done in 68.76983308792114 sec.
Server Epoch:34 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
___Train Local_Simple,  epoch  34, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 987/1005 (98.2090%)
___Train Local_Simple,  epoch  34, local model 36, internal_epoch   2,  Average loss: 0.0008, Accuracy: 984/1005 (97.9104%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.3351, Accuracy: 8938/10000 (89.3800%)
___Train Local_Simple,  epoch  34, local model 65, internal_epoch   1,  Average loss: 0.0004, Accuracy: 365/371 (98.3827%)
___Train Local_Simple,  epoch  34, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0994, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  34, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 660/672 (98.2143%)
___Train Local_Simple,  epoch  34, local model 96, internal_epoch   2,  Average loss: 0.0003, Accuracy: 669/672 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1488, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0007, Accuracy: 428/433 (98.8453%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0625, Accuracy: 9802/10000 (98.0200%)
poison local model 63 index 0
___PoisonTrain Local_Simple ,  epoch  34, local model 63, internal_epoch   1,  Average loss: 0.0229, Accuracy: 463/889 (52.0810%), train_poison_data_count: 280
class_loss: 4.1639084815979, distance_loss: 0.0
class_loss: 1.9883811473846436, distance_loss: 0.31830769777297974
class_loss: 1.497186541557312, distance_loss: 0.7799708843231201
class_loss: 1.462361216545105, distance_loss: 1.2164338827133179
class_loss: 1.4079562425613403, distance_loss: 1.5300968885421753
class_loss: 1.2332608699798584, distance_loss: 1.8038429021835327
class_loss: 1.216590166091919, distance_loss: 2.07977294921875
class_loss: 1.314071774482727, distance_loss: 2.3459243774414062
class_loss: 1.1316583156585693, distance_loss: 2.586716890335083
class_loss: 1.0446983575820923, distance_loss: 2.8022968769073486
class_loss: 1.1478002071380615, distance_loss: 2.996000051498413
class_loss: 0.9624949097633362, distance_loss: 3.1683425903320312
class_loss: 0.8651604652404785, distance_loss: 3.3249826431274414
class_loss: 0.9281631708145142, distance_loss: 3.4653356075286865
class_loss: 0.8719416856765747, distance_loss: 3.592029094696045
class_loss: 0.8700891137123108, distance_loss: 3.7096147537231445
class_loss: 0.7944110035896301, distance_loss: 3.815915822982788
class_loss: 1.1053789854049683, distance_loss: 3.916611909866333
class_loss: 0.8714244961738586, distance_loss: 4.0162553787231445
class_loss: 1.0985714197158813, distance_loss: 4.1103057861328125
class_loss: 0.8465210795402527, distance_loss: 4.190828323364258
class_loss: 0.9239886403083801, distance_loss: 4.259509563446045
class_loss: 0.9797495603561401, distance_loss: 4.317137718200684
class_loss: 0.7953027486801147, distance_loss: 4.3698649406433105
class_loss: 0.7525918483734131, distance_loss: 4.4217848777771
class_loss: 0.8116021156311035, distance_loss: 4.47533655166626
class_loss: 0.9622830152511597, distance_loss: 4.528955459594727
class_loss: 0.7697013020515442, distance_loss: 4.582033634185791
___PoisonTrain Local_Simple ,  epoch  34, local model 63, internal_epoch   2,  Average loss: 0.0140, Accuracy: 527/889 (59.2801%), train_poison_data_count: 280
Global model norm: 15.958141886838478.
Norm before scaling: 16.11184510645429. Distance: 4.631552513631195
Total norm for 2 adversaries is: 16.11184510645429. distance: 4.631552513631195
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.1960, Accuracy: 2881/8968 (32.1253%)
___Train Local_Simple,  epoch  34, local model 30, internal_epoch   1,  Average loss: 0.0012, Accuracy: 390/400 (97.5000%)
___Train Local_Simple,  epoch  34, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2506, Accuracy: 9201/10000 (92.0100%)
___Train Local_Simple,  epoch  34, local model 94, internal_epoch   1,  Average loss: 0.0015, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  34, local model 94, internal_epoch   2,  Average loss: 0.0004, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1835, Accuracy: 9418/10000 (94.1800%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 643/647 (99.3818%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%)
class_loss: 4.576757907867432, distance_loss: 0.0
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2258, Accuracy: 9294/10000 (92.9400%)
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  34, local model 52, internal_epoch   1,  Average loss: 0.0409, Accuracy: 138/253 (54.5455%), train_poison_data_count: 80
class_loss: 1.1884571313858032, distance_loss: 0.9309993982315063
class_loss: 2.1959288120269775, distance_loss: 1.4021559953689575
class_loss: 1.679076910018921, distance_loss: 1.7485514879226685
class_loss: 1.5203955173492432, distance_loss: 2.067399740219116
class_loss: 1.4323055744171143, distance_loss: 2.3684442043304443
class_loss: 1.5186257362365723, distance_loss: 2.64225172996521
___PoisonTrain Local_Simple ,  epoch  34, local model 52, internal_epoch   2,  Average loss: 0.0243, Accuracy: 92/253 (36.3636%), train_poison_data_count: 80
Global model norm: 15.958141886838478.
Norm before scaling: 15.737489606082747. Distance: 2.8956682080363962
Total norm for 2 adversaries is: 15.737489606082747. distance: 2.8956682080363962
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.5478, Accuracy: 3094/8968 (34.5004%)
___Train Local_Simple,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 464/474 (97.8903%)
___Train Local_Simple,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2565, Accuracy: 9289/10000 (92.8900%)
time spent on training: 45.689401388168335
Starting performing KrMLRFL...
Num data points: [1005, 371, 672, 433, 889, 400, 150, 647, 253, 474]
Num selected data points: [433 400 150 647 474]
The chosen ones are users: [3, 5, 6, 7, 9], which are global users: [83, 30, 94, 25, 50]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 52]
base_p: [-0.00155622  0.00030608  0.00130364 ... -0.00351617 -0.00862269
 -0.00015284]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 8]
layer1_inf_time: 2.935546875
[PAIRWISE] pred_attackers_indx:  [4 8]
layer2_inf_t: 30.04931640625
assumed final_attacker_idxs:  [0 1 2 4 8]
final_attacker_idxs is: [0, 1, 2, 4, 8]
g_attacker_idxs: [36 65 96 63 52]
g_normal_idxs: [83 30 94 25 50]
filtered_attacker_idxs: [0, 1, 2, 4, 8]
final_attacker_idxs are: [0, 1, 2, 4, 8]
num_dps: [1005, 371, 672, 433, 889, 400, 150, 647, 253, 474]
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0568, Accuracy: 9821/10000 (98.2100%)
epoch_acc: 98.21
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 12.2107, Accuracy: 56/8968 (0.6244%)
Done in 52.56590461730957 sec.
Server Epoch:35 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 0
___PoisonTrain Local_Simple ,  epoch  35, local model 45, internal_epoch   1,  Average loss: 0.0287, Accuracy: 349/628 (55.5732%), train_poison_data_count: 200
class_loss: 3.0892059803009033, distance_loss: 0.0
class_loss: 2.3388216495513916, distance_loss: 0.3281266391277313
class_loss: 1.7861820459365845, distance_loss: 0.794093906879425
class_loss: 2.691416025161743, distance_loss: 1.1804335117340088
class_loss: 1.392377257347107, distance_loss: 1.4805231094360352
class_loss: 1.2828906774520874, distance_loss: 1.8116055727005005
class_loss: 1.4484601020812988, distance_loss: 2.128225803375244
class_loss: 1.4950021505355835, distance_loss: 2.4191365242004395
class_loss: 1.2592146396636963, distance_loss: 2.6829962730407715
class_loss: 1.2520829439163208, distance_loss: 2.9259119033813477
class_loss: 0.9914293885231018, distance_loss: 3.1572835445404053
class_loss: 1.0670233964920044, distance_loss: 3.376770496368408
class_loss: 1.0408228635787964, distance_loss: 3.581378936767578
class_loss: 0.9827226400375366, distance_loss: 3.768364191055298
class_loss: 0.8490474224090576, distance_loss: 3.942389488220215
class_loss: 1.0277572870254517, distance_loss: 4.099759101867676
class_loss: 0.9902436137199402, distance_loss: 4.236135482788086
class_loss: 0.9690564870834351, distance_loss: 4.354007244110107
class_loss: 0.8501881957054138, distance_loss: 4.4628214836120605
class_loss: 1.171717643737793, distance_loss: 4.564202785491943
___PoisonTrain Local_Simple ,  epoch  35, local model 45, internal_epoch   2,  Average loss: 0.0158, Accuracy: 336/628 (53.5032%), train_poison_data_count: 200
Global model norm: 15.92231535747152.
Norm before scaling: 16.09676283995578. Distance: 4.661182428076337
Total norm for 4 adversaries is: 16.09676283995578. distance: 4.661182428076337
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.5140, Accuracy: 2218/8968 (24.7324%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0004, Accuracy: 609/615 (99.0244%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1331, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch  35, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 496/499 (99.3988%)
___Train Local_Simple,  epoch  35, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0980, Accuracy: 9700/10000 (97.0000%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  35, local model 17, internal_epoch   1,  Average loss: 0.0300, Accuracy: 324/620 (52.2581%), train_poison_data_count: 200
class_loss: 4.359653949737549, distance_loss: 0.0
class_loss: 2.4570257663726807, distance_loss: 0.3582141101360321
class_loss: 1.8626153469085693, distance_loss: 0.9086246490478516
class_loss: 1.5482405424118042, distance_loss: 1.3115030527114868
class_loss: 1.4249217510223389, distance_loss: 1.6391512155532837
class_loss: 1.262081503868103, distance_loss: 1.9567718505859375
class_loss: 1.4530397653579712, distance_loss: 2.2511725425720215
class_loss: 1.4225877523422241, distance_loss: 2.508584499359131
class_loss: 1.4338058233261108, distance_loss: 2.7358150482177734
class_loss: 1.3640764951705933, distance_loss: 2.93782901763916
class_loss: 1.1304317712783813, distance_loss: 3.121539354324341
class_loss: 1.1781883239746094, distance_loss: 3.288696050643921
class_loss: 1.1297608613967896, distance_loss: 3.4439570903778076
class_loss: 1.0290191173553467, distance_loss: 3.5830135345458984
class_loss: 0.8095271587371826, distance_loss: 3.7133629322052
class_loss: 0.9305967688560486, distance_loss: 3.8352668285369873
class_loss: 1.0459548234939575, distance_loss: 3.9476206302642822
class_loss: 0.80595862865448, distance_loss: 4.046894073486328
class_loss: 0.9224563241004944, distance_loss: 4.138340473175049
class_loss: 0.6141065955162048, distance_loss: 4.226546764373779
___PoisonTrain Local_Simple ,  epoch  35, local model 17, internal_epoch   2,  Average loss: 0.0155, Accuracy: 331/620 (53.3871%), train_poison_data_count: 200
Global model norm: 15.92231535747152.
Norm before scaling: 16.07193226827246. Distance: 4.318551503103898
Total norm for 4 adversaries is: 16.07193226827246. distance: 4.318551503103898
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.4286, Accuracy: 3195/8968 (35.6267%)
poison local model 20 index 2
___PoisonTrain Local_Simple ,  epoch  35, local model 20, internal_epoch   1,  Average loss: 0.0334, Accuracy: 216/429 (50.3497%), train_poison_data_count: 140
class_loss: 4.695751190185547, distance_loss: 0.0
class_loss: 2.6438984870910645, distance_loss: 0.37004706263542175
class_loss: 1.6827943325042725, distance_loss: 0.8953163623809814
class_loss: 1.4923627376556396, distance_loss: 1.3993088006973267
class_loss: 1.442315936088562, distance_loss: 1.8014432191848755
class_loss: 1.1738567352294922, distance_loss: 2.154221296310425
class_loss: 1.198548674583435, distance_loss: 2.4817378520965576
class_loss: 1.0630598068237305, distance_loss: 2.79020619392395
class_loss: 1.1804590225219727, distance_loss: 3.07045578956604
class_loss: 1.0245801210403442, distance_loss: 3.3239948749542236
class_loss: 0.9978041052818298, distance_loss: 3.5527827739715576
class_loss: 0.9251173734664917, distance_loss: 3.760571241378784
class_loss: 0.8009986281394958, distance_loss: 3.948937177658081
class_loss: 1.1277713775634766, distance_loss: 4.11466121673584
___PoisonTrain Local_Simple ,  epoch  35, local model 20, internal_epoch   2,  Average loss: 0.0166, Accuracy: 254/429 (59.2075%), train_poison_data_count: 140
Global model norm: 15.92231535747152.
Norm before scaling: 15.903164127696757. Distance: 4.2644989427727795
Total norm for 4 adversaries is: 15.903164127696757. distance: 4.2644989427727795
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.6614, Accuracy: 6774/8968 (75.5352%)
poison local model 73 index 3
class_loss: 3.3594930171966553, distance_loss: 0.0
class_loss: 1.5252913236618042, distance_loss: 0.4568074941635132
class_loss: 1.4082722663879395, distance_loss: 0.6325748562812805
class_loss: 0.9999225735664368, distance_loss: 0.8607962131500244
class_loss: 0.9868855476379395, distance_loss: 1.181166172027588
class_loss: 0.7616494297981262, distance_loss: 1.501438021659851
class_loss: 1.1208223104476929, distance_loss: 1.781930685043335
class_loss: 0.9443492889404297, distance_loss: 2.031162738800049
class_loss: 0.7158131003379822, distance_loss: 2.251826524734497
class_loss: 0.6518153548240662, distance_loss: 2.4497485160827637
class_loss: 1.0133626461029053, distance_loss: 2.672794818878174
class_loss: 1.1540158987045288, distance_loss: 2.8531172275543213
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.0211, Accuracy: 381/591 (64.4670%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0092, Accuracy: 461/591 (78.0034%), train_poison_data_count: 195
Global model norm: 15.92231535747152.
Norm before scaling: 16.06412815495775. Distance: 3.980349792559741
Total norm for 4 adversaries is: 16.06412815495775. distance: 3.980349792559741
class_loss: 0.7538048028945923, distance_loss: 2.9932591915130615
class_loss: 0.39507701992988586, distance_loss: 3.122133731842041
class_loss: 0.6000310182571411, distance_loss: 3.2517707347869873
class_loss: 0.43074682354927063, distance_loss: 3.38429594039917
class_loss: 0.4611218571662903, distance_loss: 3.516533851623535
class_loss: 0.3251342475414276, distance_loss: 3.6432242393493652
class_loss: 0.22939765453338623, distance_loss: 3.7621071338653564
class_loss: 0.0814608633518219, distance_loss: 3.870692491531372
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.1059, Accuracy: 8642/8968 (96.3649%)
___Train Local_Simple,  epoch  35, local model 43, internal_epoch   1,  Average loss: 0.0014, Accuracy: 398/408 (97.5490%)
___Train Local_Simple,  epoch  35, local model 43, internal_epoch   2,  Average loss: 0.0013, Accuracy: 398/408 (97.5490%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1280, Accuracy: 9591/10000 (95.9100%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 627/633 (99.0521%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   2,  Average loss: 0.0004, Accuracy: 627/633 (99.0521%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0605, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 548/557 (98.3842%)
___Train Local_Simple,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1608, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0015, Accuracy: 900/923 (97.5081%)
___Train Local_Simple,  epoch  35, local model 3, internal_epoch   2,  Average loss: 0.0012, Accuracy: 899/923 (97.3998%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.2297, Accuracy: 9314/10000 (93.1400%)
time spent on training: 59.07906484603882
Starting performing KrMLRFL...
Num data points: [628, 615, 499, 620, 429, 591, 408, 633, 557, 923]
Num selected data points: [615 499 408 633 557]
The chosen ones are users: [1, 2, 6, 7, 8], which are global users: [6, 35, 43, 8, 74]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 17, 20, 73]
base_p: [-3.8300604e-03  2.5674701e-04  7.6588243e-05 ... -2.8394535e-03
 -2.2910088e-03 -3.2482259e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 5, 9]
layer1_inf_time: 5.314453125
[PAIRWISE] pred_attackers_indx:  [0 3 4 5]
layer2_inf_t: 33.29638671875
assumed final_attacker_idxs:  [0 3 4 5 9]
final_attacker_idxs is: [0, 3, 4, 5, 9]
g_attacker_idxs: [45 17 20 73  3]
g_normal_idxs: [ 6 35 43  8 74]
filtered_attacker_idxs: [0, 3, 4, 5, 9]
final_attacker_idxs are: [0, 3, 4, 5, 9]
num_dps: [628, 615, 499, 620, 429, 591, 408, 633, 557, 923]
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0510, Accuracy: 9856/10000 (98.5600%)
epoch_acc: 98.56
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 12.2531, Accuracy: 39/8968 (0.4349%)
Done in 65.25804328918457 sec.
Server Epoch:36 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
___Train Local_Simple,  epoch  36, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch  36, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0556, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 369/376 (98.1383%)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1148, Accuracy: 9662/10000 (96.6200%)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 956/977 (97.8506%)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0006, Accuracy: 962/977 (98.4647%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1169, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 647/658 (98.3283%)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0006, Accuracy: 650/658 (98.7842%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1641, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  36, local model 30, internal_epoch   1,  Average loss: 0.0006, Accuracy: 397/400 (99.2500%)
___Train Local_Simple,  epoch  36, local model 30, internal_epoch   2,  Average loss: 0.0005, Accuracy: 396/400 (99.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.3165, Accuracy: 9075/10000 (90.7500%)
poison local model 63 index 0
class_loss: 3.3196563720703125, distance_loss: 0.0
class_loss: 2.045699119567871, distance_loss: 0.3206298351287842
class_loss: 1.1080323457717896, distance_loss: 0.7767911553382874
class_loss: 1.227975845336914, distance_loss: 1.131964921951294
class_loss: 1.484479308128357, distance_loss: 1.425254464149475
class_loss: 0.9880684614181519, distance_loss: 1.6853485107421875
class_loss: 0.8793758749961853, distance_loss: 1.9592440128326416
class_loss: 1.0343114137649536, distance_loss: 2.231243371963501
class_loss: 0.8438084125518799, distance_loss: 2.487043857574463
class_loss: 0.818361222743988, distance_loss: 2.7266101837158203
class_loss: 0.5915155410766602, distance_loss: 2.9489128589630127
class_loss: 0.6537805795669556, distance_loss: 3.1522767543792725
class_loss: 0.7844787836074829, distance_loss: 3.342740297317505
class_loss: 0.41166773438453674, distance_loss: 3.516357660293579
___PoisonTrain Local_Simple ,  epoch  36, local model 63, internal_epoch   1,  Average loss: 0.0182, Accuracy: 611/889 (68.7289%), train_poison_data_count: 280
___PoisonTrain Local_Simple ,  epoch  36, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 819/889 (92.1260%), train_poison_data_count: 280
Global model norm: 15.875947218142361.
Norm before scaling: 16.36104449158026. Distance: 4.91972880724794
Total norm for 1 adversaries is: 16.36104449158026. distance: 4.91972880724794
class_loss: 0.41481584310531616, distance_loss: 3.675624132156372
class_loss: 0.47440990805625916, distance_loss: 3.8205041885375977
class_loss: 0.4555988907814026, distance_loss: 3.9528605937957764
class_loss: 0.4831447899341583, distance_loss: 4.069509029388428
class_loss: 0.18556249141693115, distance_loss: 4.173742771148682
class_loss: 0.25732335448265076, distance_loss: 4.271886348724365
class_loss: 0.22209057211875916, distance_loss: 4.366272926330566
class_loss: 0.3356465995311737, distance_loss: 4.453493118286133
class_loss: 0.33730170130729675, distance_loss: 4.537417888641357
class_loss: 0.12512987852096558, distance_loss: 4.613343715667725
class_loss: 0.19326600432395935, distance_loss: 4.685135841369629
class_loss: 0.3188091218471527, distance_loss: 4.751633167266846
class_loss: 0.21292385458946228, distance_loss: 4.811543941497803
class_loss: 0.1270422786474228, distance_loss: 4.8679633140563965
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.0194, Accuracy: 8910/8968 (99.3533%)
___Train Local_Simple,  epoch  36, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch  36, local model 23, internal_epoch   2,  Average loss: 0.0003, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0684, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0008, Accuracy: 909/923 (98.4832%)
___Train Local_Simple,  epoch  36, local model 3, internal_epoch   2,  Average loss: 0.0006, Accuracy: 907/923 (98.2665%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1185, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0014, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   2,  Average loss: 0.0003, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1693, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  36, local model 84, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1220/1246 (97.9133%)
___Train Local_Simple,  epoch  36, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1234/1246 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0803, Accuracy: 9769/10000 (97.6900%)
time spent on training: 39.5367591381073
Starting performing KrMLRFL...
Num data points: [257, 376, 977, 658, 400, 889, 293, 923, 150, 1246]
Num selected data points: [257 376 400 293 150]
The chosen ones are users: [0, 1, 4, 6, 8], which are global users: [39, 14, 30, 23, 94]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63]
base_p: [-6.3196570e-04  3.9573759e-04 -3.5686418e-05 ... -3.0536950e-04
  4.7393143e-04 -9.1947615e-05]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 7, 9]
layer1_inf_time: 4.797119140625
[PAIRWISE] pred_attackers_indx:  [5]
layer2_inf_t: 30.724853515625
assumed final_attacker_idxs:  [2 3 5 7 9]
final_attacker_idxs is: [2, 3, 5, 7, 9]
g_attacker_idxs: [32  4 63  3 84]
g_normal_idxs: [39 14 30 23 94]
filtered_attacker_idxs: [2, 3, 5, 7, 9]
final_attacker_idxs are: [2, 3, 5, 7, 9]
num_dps: [257, 376, 977, 658, 400, 889, 293, 923, 150, 1246]
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0612, Accuracy: 9807/10000 (98.0700%)
epoch_acc: 98.07000000000001
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 11.0980, Accuracy: 54/8968 (0.6021%)
Done in 45.52790951728821 sec.
Server Epoch:37 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  37, local model 69, internal_epoch   1,  Average loss: 0.0014, Accuracy: 252/256 (98.4375%)
___Train Local_Simple,  epoch  37, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1360, Accuracy: 9557/10000 (95.5700%)
poison local model 2 index 0
class_loss: 1.9302619695663452, distance_loss: 0.0
class_loss: 1.0153435468673706, distance_loss: 0.17708618938922882
class_loss: 0.9161076545715332, distance_loss: 0.41962406039237976
class_loss: 0.6971419453620911, distance_loss: 0.7128396034240723
class_loss: 0.7032228112220764, distance_loss: 0.9983304142951965
class_loss: 1.1206071376800537, distance_loss: 1.2176644802093506
class_loss: 0.45098790526390076, distance_loss: 1.3745391368865967
class_loss: 0.6352856159210205, distance_loss: 1.533632516860962
class_loss: 0.6292552947998047, distance_loss: 1.7095674276351929
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0148, Accuracy: 430/548 (78.4672%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   2,  Average loss: 0.0084, Accuracy: 427/548 (77.9197%), train_poison_data_count: 180
Global model norm: 15.854493841671072.
Norm before scaling: 15.758177556815046. Distance: 2.777284602784176
Total norm for 4 adversaries is: 15.758177556815046. distance: 2.777284602784176
class_loss: 0.5092566013336182, distance_loss: 1.888075351715088
class_loss: 0.5683229565620422, distance_loss: 2.0509591102600098
class_loss: 0.5495865345001221, distance_loss: 2.1910972595214844
class_loss: 0.4392986297607422, distance_loss: 2.3190274238586426
class_loss: 0.5133790373802185, distance_loss: 2.43198299407959
class_loss: 0.5857042670249939, distance_loss: 2.5278711318969727
class_loss: 0.549564003944397, distance_loss: 2.6047556400299072
class_loss: 0.36574113368988037, distance_loss: 2.665714740753174
class_loss: 0.4968634247779846, distance_loss: 2.7223823070526123
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.8177, Accuracy: 5318/8968 (59.2997%)
poison local model 42 index 1
___PoisonTrain Local_Simple ,  epoch  37, local model 42, internal_epoch   1,  Average loss: 0.0296, Accuracy: 167/236 (70.7627%), train_poison_data_count: 80
class_loss: 2.302558660507202, distance_loss: 0.0
class_loss: 2.2918334007263184, distance_loss: 0.1985393613576889
class_loss: 0.9940963983535767, distance_loss: 0.6025151014328003
class_loss: 1.404423475265503, distance_loss: 0.9756749868392944
class_loss: 1.4337942600250244, distance_loss: 1.2315316200256348
class_loss: 0.9358749985694885, distance_loss: 1.4553669691085815
class_loss: 0.7882729172706604, distance_loss: 1.7005528211593628
class_loss: 1.0856209993362427, distance_loss: 1.9499634504318237
___PoisonTrain Local_Simple ,  epoch  37, local model 42, internal_epoch   2,  Average loss: 0.0180, Accuracy: 134/236 (56.7797%), train_poison_data_count: 80
Global model norm: 15.854493841671072.
Norm before scaling: 15.642809674314776. Distance: 2.187642556041304
Total norm for 4 adversaries is: 15.642809674314776. distance: 2.187642556041304
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.5114, Accuracy: 2249/8968 (25.0781%)
___Train Local_Simple,  epoch  37, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 641/647 (99.0726%)
___Train Local_Simple,  epoch  37, local model 25, internal_epoch   2,  Average loss: 0.0009, Accuracy: 643/647 (99.3818%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.5289, Accuracy: 8620/10000 (86.2000%)
poison local model 17 index 2
class_loss: 3.6935322284698486, distance_loss: 0.0
class_loss: 2.506481409072876, distance_loss: 0.3397468030452728
class_loss: 1.8177788257598877, distance_loss: 0.8350735306739807
class_loss: 1.5985004901885986, distance_loss: 1.1629177331924438
class_loss: 1.0273994207382202, distance_loss: 1.4584035873413086
class_loss: 1.2757329940795898, distance_loss: 1.7699246406555176
class_loss: 1.1998227834701538, distance_loss: 2.0673601627349854
class_loss: 1.1639338731765747, distance_loss: 2.3415942192077637
class_loss: 1.105478048324585, distance_loss: 2.5908727645874023
class_loss: 1.1852387189865112, distance_loss: 2.819270133972168
class_loss: 1.2160340547561646, distance_loss: 3.0383825302124023
class_loss: 1.0695596933364868, distance_loss: 3.2375521659851074
class_loss: 1.2727360725402832, distance_loss: 3.4178292751312256
class_loss: 1.0265538692474365, distance_loss: 3.5712337493896484
class_loss: 1.0868453979492188, distance_loss: 3.700941324234009
___PoisonTrain Local_Simple ,  epoch  37, local model 17, internal_epoch   1,  Average loss: 0.0267, Accuracy: 353/620 (56.9355%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  37, local model 17, internal_epoch   2,  Average loss: 0.0172, Accuracy: 308/620 (49.6774%), train_poison_data_count: 200
Global model norm: 15.854493841671072.
Norm before scaling: 15.959795507206097. Distance: 4.258923306937447
Total norm for 4 adversaries is: 15.959795507206097. distance: 4.258923306937447
class_loss: 0.9687818288803101, distance_loss: 3.809602737426758
class_loss: 1.038974404335022, distance_loss: 3.9082441329956055
class_loss: 0.9483742117881775, distance_loss: 4.000270366668701
class_loss: 0.8662267923355103, distance_loss: 4.089055061340332
class_loss: 1.1658846139907837, distance_loss: 4.172489643096924
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.9982, Accuracy: 4772/8968 (53.2114%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 856/860 (99.5349%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1232, Accuracy: 9643/10000 (96.4300%)
poison local model 45 index 3
class_loss: 2.883897542953491, distance_loss: 0.0
class_loss: 2.067594289779663, distance_loss: 0.2854379415512085
class_loss: 1.5226932764053345, distance_loss: 0.7662500739097595
class_loss: 1.5500177145004272, distance_loss: 1.0700743198394775
class_loss: 0.9481239318847656, distance_loss: 1.2982450723648071
class_loss: 1.0442043542861938, distance_loss: 1.6067636013031006
class_loss: 1.2532838582992554, distance_loss: 1.91256844997406
class_loss: 0.9579355716705322, distance_loss: 2.205460548400879
class_loss: 0.9114037752151489, distance_loss: 2.4742088317871094
class_loss: 0.8480063676834106, distance_loss: 2.7198917865753174
___PoisonTrain Local_Simple ,  epoch  37, local model 45, internal_epoch   1,  Average loss: 0.0223, Accuracy: 405/628 (64.4904%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  37, local model 45, internal_epoch   2,  Average loss: 0.0092, Accuracy: 473/628 (75.3185%), train_poison_data_count: 200
Global model norm: 15.854493841671072.
Norm before scaling: 16.110210408139654. Distance: 4.386022578747093
Total norm for 4 adversaries is: 16.110210408139654. distance: 4.386022578747093
class_loss: 0.8571348786354065, distance_loss: 2.9461028575897217
class_loss: 0.7423366904258728, distance_loss: 3.1473138332366943
class_loss: 0.8025720715522766, distance_loss: 3.3220980167388916
class_loss: 0.6210213899612427, distance_loss: 3.475642681121826
class_loss: 0.45547500252723694, distance_loss: 3.6169590950012207
class_loss: 0.60069739818573, distance_loss: 3.7538058757781982
class_loss: 0.45105305314064026, distance_loss: 3.8885657787323
class_loss: 0.35371336340904236, distance_loss: 4.022563457489014
class_loss: 0.370118647813797, distance_loss: 4.151187896728516
class_loss: 0.5040872097015381, distance_loss: 4.274481773376465
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.2261, Accuracy: 8048/8968 (89.7413%)
___Train Local_Simple,  epoch  37, local model 54, internal_epoch   1,  Average loss: 0.0005, Accuracy: 514/519 (99.0366%)
___Train Local_Simple,  epoch  37, local model 54, internal_epoch   2,  Average loss: 0.0010, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1024, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0003, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 399/400 (99.7500%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1343, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 428/435 (98.3908%)
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   2,  Average loss: 0.0004, Accuracy: 430/435 (98.8506%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1259, Accuracy: 9587/10000 (95.8700%)
time spent on training: 61.59441828727722
Starting performing KrMLRFL...
Num data points: [256, 548, 236, 647, 620, 860, 628, 519, 400, 435]
Num selected data points: [256 860 519 400 435]
The chosen ones are users: [0, 5, 7, 8, 9], which are global users: [69, 37, 54, 30, 0]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 42, 17, 45]
base_p: [-0.00313842  0.00024814 -0.00119674 ... -0.00199996 -0.00351498
 -0.00084644]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 6]
layer1_inf_time: 3.99169921875
[PAIRWISE] pred_attackers_indx:  [1 2 4 6]
layer2_inf_t: 32.032958984375
assumed final_attacker_idxs:  [1 2 3 4 6]
final_attacker_idxs is: [1, 2, 3, 4, 6]
g_attacker_idxs: [ 2 42 25 17 45]
g_normal_idxs: [69 37 54 30  0]
filtered_attacker_idxs: [1, 2, 3, 4, 6]
final_attacker_idxs are: [1, 2, 3, 4, 6]
num_dps: [256, 548, 236, 647, 620, 860, 628, 519, 400, 435]
epoch_acc: 98.32
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.0522, Accuracy: 9832/10000 (98.3200%)
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 12.1861, Accuracy: 48/8968 (0.5352%)
Done in 67.9560866355896 sec.
Server Epoch:38 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
___Train Local_Simple,  epoch  38, local model 33, internal_epoch   1,  Average loss: 0.0010, Accuracy: 609/623 (97.7528%)
___Train Local_Simple,  epoch  38, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 611/623 (98.0738%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1513, Accuracy: 9549/10000 (95.4900%)
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0231, Accuracy: 341/568 (60.0352%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0131, Accuracy: 371/568 (65.3169%), train_poison_data_count: 180
Global model norm: 15.805239250595186.
Norm before scaling: 15.803269176040464. Distance: 3.917911913260787
Total norm for 4 adversaries is: 15.803269176040464. distance: 3.917911913260787
class_loss: 3.2985715866088867, distance_loss: 0.0
class_loss: 2.4378111362457275, distance_loss: 0.2694327235221863
class_loss: 1.2293620109558105, distance_loss: 0.7422323226928711
class_loss: 1.2737222909927368, distance_loss: 1.149371862411499
class_loss: 1.2809655666351318, distance_loss: 1.4597669839859009
class_loss: 1.0958579778671265, distance_loss: 1.7297312021255493
class_loss: 0.9113656878471375, distance_loss: 1.9962198734283447
class_loss: 0.7374500632286072, distance_loss: 2.253112554550171
class_loss: 0.8775212168693542, distance_loss: 2.4930546283721924
class_loss: 0.8100367784500122, distance_loss: 2.7142767906188965
class_loss: 0.8122217655181885, distance_loss: 2.9192800521850586
class_loss: 0.8398456573486328, distance_loss: 3.1071927547454834
class_loss: 0.9611378908157349, distance_loss: 3.2745161056518555
class_loss: 0.7485389113426208, distance_loss: 3.4189612865448
class_loss: 1.0302925109863281, distance_loss: 3.5436148643493652
class_loss: 0.687123715877533, distance_loss: 3.6495378017425537
class_loss: 0.7445775866508484, distance_loss: 3.7456891536712646
class_loss: 0.821663498878479, distance_loss: 3.8337082862854004
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.8048, Accuracy: 5224/8968 (58.2516%)
poison local model 17 index 1
class_loss: 3.5672709941864014, distance_loss: 0.0
class_loss: 1.9766732454299927, distance_loss: 0.3421454131603241
class_loss: 2.6955816745758057, distance_loss: 0.8501158952713013
class_loss: 2.3378422260284424, distance_loss: 1.2005695104599
class_loss: 1.2308844327926636, distance_loss: 1.5257129669189453
class_loss: 1.2439689636230469, distance_loss: 1.8889901638031006
class_loss: 1.305597186088562, distance_loss: 2.2354769706726074
class_loss: 1.3011423349380493, distance_loss: 2.546041250228882
class_loss: 1.4359321594238281, distance_loss: 2.8252580165863037
class_loss: 1.6598525047302246, distance_loss: 3.076573610305786
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0302, Accuracy: 338/620 (54.5161%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0184, Accuracy: 324/620 (52.2581%), train_poison_data_count: 200
Global model norm: 15.805239250595186.
Norm before scaling: 15.890152075527737. Distance: 4.725403194279906
Total norm for 4 adversaries is: 15.890152075527737. distance: 4.725403194279906
class_loss: 1.2470369338989258, distance_loss: 3.313868761062622
class_loss: 1.065209150314331, distance_loss: 3.5291590690612793
class_loss: 1.2183821201324463, distance_loss: 3.727900505065918
class_loss: 1.0957396030426025, distance_loss: 3.9125587940216064
class_loss: 1.1307241916656494, distance_loss: 4.077880382537842
class_loss: 1.1335856914520264, distance_loss: 4.219716548919678
class_loss: 1.191725254058838, distance_loss: 4.340921878814697
class_loss: 1.085479974746704, distance_loss: 4.448355197906494
class_loss: 1.037367820739746, distance_loss: 4.546485900878906
class_loss: 1.211959719657898, distance_loss: 4.639301776885986
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.9011, Accuracy: 6491/8968 (72.3796%)
poison local model 63 index 2
___PoisonTrain Local_Simple ,  epoch  38, local model 63, internal_epoch   1,  Average loss: 0.0219, Accuracy: 515/889 (57.9303%), train_poison_data_count: 280
class_loss: 3.8641245365142822, distance_loss: 0.0
class_loss: 1.7702983617782593, distance_loss: 0.3172071874141693
class_loss: 0.9652175903320312, distance_loss: 0.7579975724220276
class_loss: 1.5594992637634277, distance_loss: 1.1965175867080688
class_loss: 1.7002651691436768, distance_loss: 1.488417148590088
class_loss: 1.1897627115249634, distance_loss: 1.7358964681625366
class_loss: 1.115365982055664, distance_loss: 1.985517978668213
class_loss: 1.1773662567138672, distance_loss: 2.2262983322143555
class_loss: 1.2513556480407715, distance_loss: 2.4419806003570557
class_loss: 1.0957382917404175, distance_loss: 2.6368520259857178
class_loss: 1.0122547149658203, distance_loss: 2.807436943054199
class_loss: 1.0734199285507202, distance_loss: 2.965641975402832
class_loss: 0.8602499961853027, distance_loss: 3.1151211261749268
class_loss: 0.864128053188324, distance_loss: 3.2548668384552
class_loss: 0.9680094122886658, distance_loss: 3.3870201110839844
class_loss: 1.0337108373641968, distance_loss: 3.5118322372436523
class_loss: 1.0894440412521362, distance_loss: 3.6299264430999756
class_loss: 0.6734610795974731, distance_loss: 3.738887310028076
class_loss: 0.8640830516815186, distance_loss: 3.8426239490509033
class_loss: 1.0261509418487549, distance_loss: 3.9378950595855713
class_loss: 0.8094220757484436, distance_loss: 4.013939380645752
class_loss: 0.860552191734314, distance_loss: 4.079847812652588
class_loss: 0.8483406901359558, distance_loss: 4.145875453948975
class_loss: 1.0440768003463745, distance_loss: 4.213632583618164
class_loss: 0.671642541885376, distance_loss: 4.2794928550720215
class_loss: 0.7260290384292603, distance_loss: 4.342835426330566
class_loss: 0.7229118347167969, distance_loss: 4.400450229644775
class_loss: 0.6548235416412354, distance_loss: 4.449337005615234
___PoisonTrain Local_Simple ,  epoch  38, local model 63, internal_epoch   2,  Average loss: 0.0135, Accuracy: 567/889 (63.7795%), train_poison_data_count: 280
Global model norm: 15.805239250595186.
Norm before scaling: 16.058136224782498. Distance: 4.492871678536992
Total norm for 4 adversaries is: 16.058136224782498. distance: 4.492871678536992
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.7850, Accuracy: 6180/8968 (68.9117%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 612/615 (99.5122%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0900, Accuracy: 9730/10000 (97.3000%)
___Train Local_Simple,  epoch  38, local model 24, internal_epoch   1,  Average loss: 0.0010, Accuracy: 368/379 (97.0976%)
___Train Local_Simple,  epoch  38, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 375/379 (98.9446%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1500, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch  38, local model 82, internal_epoch   1,  Average loss: 0.0010, Accuracy: 699/713 (98.0365%)
___Train Local_Simple,  epoch  38, local model 82, internal_epoch   2,  Average loss: 0.0003, Accuracy: 706/713 (99.0182%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.6842, Accuracy: 8658/10000 (86.5800%)
___Train Local_Simple,  epoch  38, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch  38, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0710, Accuracy: 9774/10000 (97.7400%)
___Train Local_Simple,  epoch  38, local model 80, internal_epoch   1,  Average loss: 0.0008, Accuracy: 427/431 (99.0719%)
___Train Local_Simple,  epoch  38, local model 80, internal_epoch   2,  Average loss: 0.0006, Accuracy: 425/431 (98.6079%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0950, Accuracy: 9724/10000 (97.2400%)
poison local model 81 index 3
class_loss: 4.173665523529053, distance_loss: 0.0
class_loss: 3.19307017326355, distance_loss: 0.3630428612232208
class_loss: 1.1440720558166504, distance_loss: 0.9477716684341431
class_loss: 1.3174511194229126, distance_loss: 1.4838075637817383
class_loss: 1.576255440711975, distance_loss: 1.9337337017059326
class_loss: 1.3519929647445679, distance_loss: 2.327082872390747
class_loss: 1.3886691331863403, distance_loss: 2.681994915008545
class_loss: 1.3687124252319336, distance_loss: 3.0047106742858887
class_loss: 1.4309567213058472, distance_loss: 3.2931911945343018
class_loss: 1.2021781206130981, distance_loss: 3.551896333694458
class_loss: 1.069112777709961, distance_loss: 3.7878072261810303
class_loss: 0.9556280374526978, distance_loss: 4.004639148712158
class_loss: 0.7631887197494507, distance_loss: 4.202638149261475
class_loss: 0.9925321936607361, distance_loss: 4.384579658508301
class_loss: 0.9104042649269104, distance_loss: 4.547173023223877
class_loss: 0.9208280444145203, distance_loss: 4.692417144775391
class_loss: 0.7913601994514465, distance_loss: 4.823843002319336
class_loss: 0.6416951417922974, distance_loss: 4.950958251953125
class_loss: 0.5375836491584778, distance_loss: 5.071948528289795
class_loss: 0.307902067899704, distance_loss: 5.190469264984131
___PoisonTrain Local_Simple ,  epoch  38, local model 81, internal_epoch   1,  Average loss: 0.0212, Accuracy: 728/1227 (59.3317%), train_poison_data_count: 391
class_loss: 0.37714341282844543, distance_loss: 5.323668956756592
class_loss: 0.3168680667877197, distance_loss: 5.452138900756836
class_loss: 0.4828474223613739, distance_loss: 5.5743608474731445
class_loss: 0.5270193815231323, distance_loss: 5.678683757781982
class_loss: 0.39421209692955017, distance_loss: 5.768851280212402
class_loss: 0.31848815083503723, distance_loss: 5.852241039276123
class_loss: 0.15158440172672272, distance_loss: 5.933750629425049
class_loss: 0.16956602036952972, distance_loss: 6.012924671173096
class_loss: 0.21451184153556824, distance_loss: 6.09067964553833
class_loss: 0.10666119307279587, distance_loss: 6.167330265045166
class_loss: 0.07280521839857101, distance_loss: 6.241481781005859
class_loss: 0.1939113438129425, distance_loss: 6.310885906219482
class_loss: 0.10073050111532211, distance_loss: 6.378017425537109
class_loss: 0.04577925428748131, distance_loss: 6.441338539123535
class_loss: 0.06520930677652359, distance_loss: 6.499475479125977
class_loss: 0.0815931111574173, distance_loss: 6.551137447357178
class_loss: 0.13757991790771484, distance_loss: 6.597774028778076
class_loss: 0.07858152687549591, distance_loss: 6.6386590003967285
class_loss: 0.08070210367441177, distance_loss: 6.6748270988464355
class_loss: 3.2619429930491606e-06, distance_loss: 6.707032203674316
___PoisonTrain Local_Simple ,  epoch  38, local model 81, internal_epoch   2,  Average loss: 0.0032, Accuracy: 1147/1227 (93.4800%), train_poison_data_count: 391
Global model norm: 15.805239250595186.
Norm before scaling: 16.798666328899074. Distance: 6.736945349912308
Total norm for 4 adversaries is: 16.798666328899074. distance: 6.736945349912308
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0192, Accuracy: 8914/8968 (99.3979%)
time spent on training: 58.06700563430786
Starting performing KrMLRFL...
Num data points: [623, 568, 620, 889, 615, 379, 713, 499, 431, 1227]
Num selected data points: [623 615 713 499 431]
The chosen ones are users: [0, 4, 6, 7, 8], which are global users: [33, 6, 82, 35, 80]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 17, 63, 81]
base_p: [-0.00644691  0.00035092 -0.00219356 ... -0.00207277 -0.0105525
  0.00187415]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 5, 9]
layer1_inf_time: 3.0205078125
[PAIRWISE] pred_attackers_indx:  [1 2 3 9]
layer2_inf_t: 46.88916015625
assumed final_attacker_idxs:  [1 2 3 5 9]
final_attacker_idxs is: [1, 2, 3, 5, 9]
g_attacker_idxs: [51 17 63 24 81]
g_normal_idxs: [33  6 82 35 80]
filtered_attacker_idxs: [1, 2, 3, 5, 9]
final_attacker_idxs are: [1, 2, 3, 5, 9]
num_dps: [623, 568, 620, 889, 615, 379, 713, 499, 431, 1227]
epoch_acc: 98.18
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0597, Accuracy: 9818/10000 (98.1800%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 13.0557, Accuracy: 10/8968 (0.1115%)
Done in 63.983500719070435 sec.
Server Epoch:39 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  39, local model 58, internal_epoch   1,  Average loss: 0.0009, Accuracy: 270/276 (97.8261%)
___Train Local_Simple,  epoch  39, local model 58, internal_epoch   2,  Average loss: 0.0005, Accuracy: 273/276 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1706, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch  39, local model 90, internal_epoch   1,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%)
___Train Local_Simple,  epoch  39, local model 90, internal_epoch   2,  Average loss: 0.0003, Accuracy: 679/683 (99.4143%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.6976, Accuracy: 8042/10000 (80.4200%)
___Train Local_Simple,  epoch  39, local model 30, internal_epoch   1,  Average loss: 0.0007, Accuracy: 396/400 (99.0000%)
___Train Local_Simple,  epoch  39, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1845, Accuracy: 9421/10000 (94.2100%)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0004, Accuracy: 724/731 (99.0424%)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 728/731 (99.5896%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2189, Accuracy: 9327/10000 (93.2700%)
___Train Local_Simple,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 595/606 (98.1848%)
___Train Local_Simple,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.4227, Accuracy: 8874/10000 (88.7400%)
___Train Local_Simple,  epoch  39, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 640/647 (98.9181%)
___Train Local_Simple,  epoch  39, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 642/647 (99.2272%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1134, Accuracy: 9628/10000 (96.2800%)
poison local model 16 index 0
___PoisonTrain Local_Simple ,  epoch  39, local model 16, internal_epoch   1,  Average loss: 0.0251, Accuracy: 480/915 (52.4590%), train_poison_data_count: 299
class_loss: 3.849170207977295, distance_loss: 0.0
class_loss: 2.357407331466675, distance_loss: 0.3326070308685303
class_loss: 1.675061583518982, distance_loss: 0.8180444240570068
class_loss: 1.6228008270263672, distance_loss: 1.227703332901001
class_loss: 1.1647347211837769, distance_loss: 1.602508306503296
class_loss: 1.5447032451629639, distance_loss: 1.9704880714416504
class_loss: 1.1260185241699219, distance_loss: 2.3109261989593506
class_loss: 1.2519325017929077, distance_loss: 2.61464786529541
class_loss: 1.240971326828003, distance_loss: 2.8865718841552734
class_loss: 1.3650041818618774, distance_loss: 3.133223533630371
class_loss: 1.3492801189422607, distance_loss: 3.357311725616455
class_loss: 1.3164632320404053, distance_loss: 3.559276580810547
class_loss: 1.1530073881149292, distance_loss: 3.739492177963257
class_loss: 1.0059294700622559, distance_loss: 3.9031827449798584
class_loss: 0.9745419025421143, distance_loss: 4.054917335510254
class_loss: 1.2548636198043823, distance_loss: 4.211758613586426
class_loss: 1.2662302255630493, distance_loss: 4.347055912017822
class_loss: 1.228336215019226, distance_loss: 4.4560627937316895
class_loss: 1.054861068725586, distance_loss: 4.548557281494141
class_loss: 0.9529945254325867, distance_loss: 4.632892608642578
class_loss: 0.8624914884567261, distance_loss: 4.713183403015137
class_loss: 0.866916835308075, distance_loss: 4.790199279785156
class_loss: 0.7991281747817993, distance_loss: 4.862419128417969
class_loss: 0.9043768644332886, distance_loss: 4.9306321144104
class_loss: 0.8911950588226318, distance_loss: 4.994535446166992
class_loss: 0.895338773727417, distance_loss: 5.053003311157227
class_loss: 0.9128817915916443, distance_loss: 5.107698917388916
class_loss: 0.7778533101081848, distance_loss: 5.159158229827881
class_loss: 0.811250627040863, distance_loss: 5.2072224617004395
class_loss: 1.2614694833755493, distance_loss: 5.251583099365234
___PoisonTrain Local_Simple ,  epoch  39, local model 16, internal_epoch   2,  Average loss: 0.0161, Accuracy: 508/915 (55.5191%), train_poison_data_count: 299
Global model norm: 15.761438484961783.
Norm before scaling: 16.129384472354523. Distance: 5.314314588418504
Total norm for 2 adversaries is: 16.129384472354523. distance: 5.314314588418504
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.8750, Accuracy: 5667/8968 (63.1913%)
poison local model 91 index 1
class_loss: 3.7035019397735596, distance_loss: 0.0
class_loss: 1.7883198261260986, distance_loss: 0.3298492729663849
class_loss: 2.1769983768463135, distance_loss: 0.8366746306419373
class_loss: 2.1667263507843018, distance_loss: 1.2579679489135742
class_loss: 1.6315475702285767, distance_loss: 1.62431800365448
___PoisonTrain Local_Simple ,  epoch  39, local model 91, internal_epoch   1,  Average loss: 0.0384, Accuracy: 136/256 (53.1250%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  39, local model 91, internal_epoch   2,  Average loss: 0.0237, Accuracy: 107/256 (41.7969%), train_poison_data_count: 80
Global model norm: 15.761438484961783.
Norm before scaling: 15.527436123939065. Distance: 2.8280988660416306
Total norm for 2 adversaries is: 15.527436123939065. distance: 2.8280988660416306
class_loss: 1.4078598022460938, distance_loss: 1.9714945554733276
class_loss: 1.5695157051086426, distance_loss: 2.2896368503570557
class_loss: 1.466313362121582, distance_loss: 2.5738582611083984
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.5408, Accuracy: 5095/8968 (56.8131%)
___Train Local_Simple,  epoch  39, local model 50, internal_epoch   1,  Average loss: 0.0013, Accuracy: 466/474 (98.3122%)
___Train Local_Simple,  epoch  39, local model 50, internal_epoch   2,  Average loss: 0.0010, Accuracy: 466/474 (98.3122%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3292, Accuracy: 8964/10000 (89.6400%)
___Train Local_Simple,  epoch  39, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 336/343 (97.9592%)
___Train Local_Simple,  epoch  39, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 342/343 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2329, Accuracy: 9331/10000 (93.3100%)
time spent on training: 46.740432024002075
Starting performing KrMLRFL...
Num data points: [276, 683, 400, 731, 606, 647, 915, 256, 474, 343]
Num selected data points: [276 400 731 474 343]
The chosen ones are users: [0, 2, 3, 8, 9], which are global users: [58, 30, 72, 50, 57]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 91]
base_p: [-0.00296061  0.00029179  0.00080998 ...  0.00133722 -0.00343886
 -0.001029  ]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 6, 7]
layer1_inf_time: 5.1572265625
[PAIRWISE] pred_attackers_indx:  [6 7]
layer2_inf_t: 42.091796875
assumed final_attacker_idxs:  [1 4 5 6 7]
final_attacker_idxs is: [1, 4, 5, 6, 7]
g_attacker_idxs: [90 41 25 16 91]
g_normal_idxs: [58 30 72 50 57]
filtered_attacker_idxs: [1, 4, 5, 6, 7]
final_attacker_idxs are: [1, 4, 5, 6, 7]
num_dps: [276, 683, 400, 731, 606, 647, 915, 256, 474, 343]
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0734, Accuracy: 9754/10000 (97.5400%)
epoch_acc: 97.54
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 11.8219, Accuracy: 59/8968 (0.6579%)
Done in 54.24334263801575 sec.
Server Epoch:40 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
___Train Local_Simple,  epoch  40, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 469/474 (98.9451%)
___Train Local_Simple,  epoch  40, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0921, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch  40, local model 77, internal_epoch   1,  Average loss: 0.0019, Accuracy: 568/589 (96.4346%)
___Train Local_Simple,  epoch  40, local model 77, internal_epoch   2,  Average loss: 0.0009, Accuracy: 582/589 (98.8115%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1033, Accuracy: 9678/10000 (96.7800%)
poison local model 73 index 0
class_loss: 2.992111921310425, distance_loss: 0.0
class_loss: 1.7523930072784424, distance_loss: 0.39925581216812134
class_loss: 1.0771702527999878, distance_loss: 0.510570764541626
class_loss: 1.2283210754394531, distance_loss: 0.76276695728302
class_loss: 1.0203993320465088, distance_loss: 1.0792430639266968
class_loss: 0.8534566760063171, distance_loss: 1.4043195247650146
class_loss: 0.9480210542678833, distance_loss: 1.6961853504180908
class_loss: 0.9028933048248291, distance_loss: 1.9416725635528564
class_loss: 0.8897312879562378, distance_loss: 2.156310558319092
class_loss: 1.3430516719818115, distance_loss: 2.3365671634674072
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.0220, Accuracy: 345/591 (58.3756%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0174, Accuracy: 315/591 (53.2995%), train_poison_data_count: 195
Global model norm: 15.722580065809213.
Norm before scaling: 15.591486030699826. Distance: 3.4896387959338178
Total norm for 3 adversaries is: 15.591486030699826. distance: 3.4896387959338178
class_loss: 0.8006069660186768, distance_loss: 2.5221853256225586
class_loss: 1.153668999671936, distance_loss: 2.6893904209136963
class_loss: 1.3298180103302002, distance_loss: 2.829511880874634
class_loss: 1.1333338022232056, distance_loss: 2.94704008102417
class_loss: 1.0649973154067993, distance_loss: 3.0478718280792236
class_loss: 0.8186748027801514, distance_loss: 3.136575937271118
class_loss: 0.8669902682304382, distance_loss: 3.2183048725128174
class_loss: 0.960945188999176, distance_loss: 3.290745735168457
class_loss: 0.8254297971725464, distance_loss: 3.357588052749634
class_loss: 1.3460832834243774, distance_loss: 3.4194836616516113
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.1028, Accuracy: 4896/8968 (54.5941%)
___Train Local_Simple,  epoch  40, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch  40, local model 21, internal_epoch   2,  Average loss: 0.0004, Accuracy: 310/312 (99.3590%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1955, Accuracy: 9332/10000 (93.3200%)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0009, Accuracy: 880/892 (98.6547%)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   2,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1372, Accuracy: 9567/10000 (95.6700%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 625/633 (98.7362%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0776, Accuracy: 9766/10000 (97.6600%)
___Train Local_Simple,  epoch  40, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 763/772 (98.8342%)
___Train Local_Simple,  epoch  40, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1838, Accuracy: 9465/10000 (94.6500%)
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0420, Accuracy: 133/253 (52.5692%), train_poison_data_count: 80
class_loss: 4.3969855308532715, distance_loss: 0.0
class_loss: 2.050929546356201, distance_loss: 0.3575332462787628
class_loss: 1.998725175857544, distance_loss: 0.897163987159729
class_loss: 2.1730616092681885, distance_loss: 1.3140945434570312
class_loss: 1.194236159324646, distance_loss: 1.6641241312026978
class_loss: 1.3471969366073608, distance_loss: 2.008908987045288
class_loss: 1.3227101564407349, distance_loss: 2.333739995956421
class_loss: 1.2280642986297607, distance_loss: 2.636322021484375
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   2,  Average loss: 0.0201, Accuracy: 124/253 (49.0119%), train_poison_data_count: 80
Global model norm: 15.722580065809213.
Norm before scaling: 15.52451182901726. Distance: 2.920511508975792
Total norm for 3 adversaries is: 15.52451182901726. distance: 2.920511508975792
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.6370, Accuracy: 2370/8968 (26.4273%)
poison local model 45 index 2
class_loss: 3.357693672180176, distance_loss: 0.0
class_loss: 2.11222243309021, distance_loss: 0.3357878029346466
class_loss: 1.7466111183166504, distance_loss: 0.8040057420730591
class_loss: 1.8775964975357056, distance_loss: 1.1213170289993286
class_loss: 0.9582401514053345, distance_loss: 1.3960717916488647
class_loss: 1.0806646347045898, distance_loss: 1.7009527683258057
class_loss: 1.1439905166625977, distance_loss: 1.998120903968811
class_loss: 1.2189438343048096, distance_loss: 2.277297258377075
class_loss: 1.0233591794967651, distance_loss: 2.537783622741699
class_loss: 1.1682757139205933, distance_loss: 2.779956579208374
___PoisonTrain Local_Simple ,  epoch  40, local model 45, internal_epoch   1,  Average loss: 0.0250, Accuracy: 375/628 (59.7134%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  40, local model 45, internal_epoch   2,  Average loss: 0.0138, Accuracy: 364/628 (57.9618%), train_poison_data_count: 200
Global model norm: 15.722580065809213.
Norm before scaling: 15.845945187392134. Distance: 4.4119012183218125
Total norm for 3 adversaries is: 15.845945187392134. distance: 4.4119012183218125
class_loss: 0.9724053740501404, distance_loss: 3.006009101867676
class_loss: 1.0021979808807373, distance_loss: 3.2146785259246826
class_loss: 0.9798813462257385, distance_loss: 3.399073839187622
class_loss: 0.7965352535247803, distance_loss: 3.560840129852295
class_loss: 0.890628457069397, distance_loss: 3.7091503143310547
class_loss: 0.7001689076423645, distance_loss: 3.848341226577759
class_loss: 0.9647506475448608, distance_loss: 3.9806876182556152
class_loss: 0.9128673076629639, distance_loss: 4.1038289070129395
class_loss: 0.7458813190460205, distance_loss: 4.215165138244629
class_loss: 0.7280225157737732, distance_loss: 4.3166632652282715
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.0321, Accuracy: 4920/8968 (54.8617%)
___Train Local_Simple,  epoch  40, local model 30, internal_epoch   1,  Average loss: 0.0003, Accuracy: 397/400 (99.2500%)
___Train Local_Simple,  epoch  40, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73, 52, 45]
base_p: [-0.00252347  0.00030307  0.00088464 ... -0.00093699 -0.00227274
 -0.00169925]
[T_SCORE] attacker_local_idxs is:  [1, 2, 6, 7, 8]
layer1_inf_time: 2.9970703125
[PAIRWISE] pred_attackers_indx:  [2 7 8]
layer2_inf_t: 37.128173828125
assumed final_attacker_idxs:  [1 2 6 7 8]
final_attacker_idxs is: [1, 2, 6, 7, 8]
g_attacker_idxs: [77 73 40 52 45]
g_normal_idxs: [50 21 10  8 30]
filtered_attacker_idxs: [1, 2, 6, 7, 8]
final_attacker_idxs are: [1, 2, 6, 7, 8]
num_dps: [474, 589, 591, 312, 892, 633, 772, 253, 628, 400]
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1502, Accuracy: 9541/10000 (95.4100%)
time spent on training: 55.215779304504395
Starting performing KrMLRFL...
Num data points: [474, 589, 591, 312, 892, 633, 772, 253, 628, 400]
Num selected data points: [474 312 892 633 400]
The chosen ones are users: [0, 3, 4, 5, 9], which are global users: [50, 21, 10, 8, 30]
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0576, Accuracy: 9820/10000 (98.2000%)
epoch_acc: 98.2
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 12.7476, Accuracy: 32/8968 (0.3568%)
Done in 60.515544414520264 sec.
Server Epoch:41 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%)
___Train Local_Simple,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2080, Accuracy: 9403/10000 (94.0300%)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0006, Accuracy: 429/436 (98.3945%)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   2,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0654, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch  41, local model 99, internal_epoch   1,  Average loss: 0.0006, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch  41, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0517, Accuracy: 9824/10000 (98.2400%)
poison local model 85 index 0
class_loss: 3.824545383453369, distance_loss: 0.0
class_loss: 3.1210319995880127, distance_loss: 0.30050337314605713
class_loss: 1.173996925354004, distance_loss: 0.8131889700889587
class_loss: 1.4295520782470703, distance_loss: 1.3313484191894531
class_loss: 1.3128613233566284, distance_loss: 1.7719630002975464
class_loss: 1.3738669157028198, distance_loss: 2.1499271392822266
class_loss: 1.2813453674316406, distance_loss: 2.480161428451538
___PoisonTrain Local_Simple ,  epoch  41, local model 85, internal_epoch   1,  Average loss: 0.0314, Accuracy: 252/431 (58.4687%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  41, local model 85, internal_epoch   2,  Average loss: 0.0196, Accuracy: 196/431 (45.4756%), train_poison_data_count: 140
Global model norm: 15.696873269678134.
Norm before scaling: 15.649986856960835. Distance: 4.047509103238175
Total norm for 3 adversaries is: 15.649986856960835. distance: 4.047509103238175
class_loss: 1.3805763721466064, distance_loss: 2.7713818550109863
class_loss: 1.3624088764190674, distance_loss: 3.027205228805542
class_loss: 1.2835251092910767, distance_loss: 3.251342296600342
class_loss: 1.174362063407898, distance_loss: 3.448716402053833
class_loss: 1.1119451522827148, distance_loss: 3.6243715286254883
class_loss: 1.0857515335083008, distance_loss: 3.7814579010009766
class_loss: 1.0463794469833374, distance_loss: 3.9205050468444824
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.8539, Accuracy: 6322/8968 (70.4951%)
___Train Local_Simple,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0013, Accuracy: 640/658 (97.2644%)
___Train Local_Simple,  epoch  41, local model 4, internal_epoch   2,  Average loss: 0.0007, Accuracy: 651/658 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1265, Accuracy: 9597/10000 (95.9700%)
poison local model 11 index 1
___PoisonTrain Local_Simple ,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0323, Accuracy: 318/645 (49.3023%), train_poison_data_count: 205
class_loss: 5.169647693634033, distance_loss: 0.0
class_loss: 2.8628551959991455, distance_loss: 0.3598010838031769
class_loss: 1.4923542737960815, distance_loss: 0.8858480453491211
class_loss: 1.2016788721084595, distance_loss: 1.4238988161087036
class_loss: 1.4676933288574219, distance_loss: 1.8749158382415771
class_loss: 1.5723739862442017, distance_loss: 2.2460479736328125
class_loss: 1.487775444984436, distance_loss: 2.5744245052337646
class_loss: 1.4503248929977417, distance_loss: 2.8657188415527344
class_loss: 1.4797214269638062, distance_loss: 3.123708724975586
class_loss: 1.459841012954712, distance_loss: 3.3511712551116943
class_loss: 1.1744766235351562, distance_loss: 3.5553338527679443
class_loss: 1.2214579582214355, distance_loss: 3.759305477142334
class_loss: 1.437246322631836, distance_loss: 3.944260597229004
class_loss: 1.304832935333252, distance_loss: 4.108345031738281
class_loss: 1.183428406715393, distance_loss: 4.250410556793213
class_loss: 1.264399766921997, distance_loss: 4.373376846313477
class_loss: 1.2878906726837158, distance_loss: 4.489564895629883
class_loss: 1.2617641687393188, distance_loss: 4.5960845947265625
class_loss: 1.027712345123291, distance_loss: 4.697458744049072
class_loss: 1.0044132471084595, distance_loss: 4.796046733856201
class_loss: 0.9573010206222534, distance_loss: 4.888016700744629
class_loss: 1.086580514907837, distance_loss: 4.974390506744385
___PoisonTrain Local_Simple ,  epoch  41, local model 11, internal_epoch   2,  Average loss: 0.0202, Accuracy: 300/645 (46.5116%), train_poison_data_count: 205
Global model norm: 15.696873269678134.
Norm before scaling: 15.86796738451449. Distance: 5.070881251806423
Total norm for 3 adversaries is: 15.86796738451449. distance: 5.070881251806423
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.9636, Accuracy: 4958/8968 (55.2855%)
___Train Local_Simple,  epoch  41, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 367/379 (96.8338%)
___Train Local_Simple,  epoch  41, local model 24, internal_epoch   2,  Average loss: 0.0006, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1174, Accuracy: 9623/10000 (96.2300%)
poison local model 42 index 2
class_loss: 3.525669574737549, distance_loss: 0.0
class_loss: 2.076829671859741, distance_loss: 0.27857545018196106
class_loss: 1.1008448600769043, distance_loss: 0.6621082425117493
class_loss: 1.1665961742401123, distance_loss: 1.0974229574203491
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0333, Accuracy: 168/236 (71.1864%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0194, Accuracy: 125/236 (52.9661%), train_poison_data_count: 80
Global model norm: 15.696873269678134.
Norm before scaling: 15.439150579143554. Distance: 2.5318093329440448
Total norm for 3 adversaries is: 15.439150579143554. distance: 2.5318093329440448
class_loss: 1.3018726110458374, distance_loss: 1.4693951606750488
class_loss: 1.165465235710144, distance_loss: 1.7803690433502197
class_loss: 1.0806437730789185, distance_loss: 2.0519509315490723
class_loss: 1.0412211418151855, distance_loss: 2.303684949874878
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.1241, Accuracy: 5671/8968 (63.2360%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0005, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   2,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0795, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch  41, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 642/647 (99.2272%)
___Train Local_Simple,  epoch  41, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1162, Accuracy: 9613/10000 (96.1300%)
time spent on training: 54.04048132896423
Starting performing KrMLRFL...
Num data points: [557, 436, 377, 431, 658, 645, 379, 236, 293, 647]
Num selected data points: [557 436 377 293 647]
The chosen ones are users: [0, 1, 2, 8, 9], which are global users: [74, 9, 99, 23, 25]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 11, 42]
base_p: [-0.00449215  0.00024199 -0.00170128 ... -0.00294977 -0.00588974
  0.00016202]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 6, 7]
layer1_inf_time: 3.033935546875
[PAIRWISE] pred_attackers_indx:  [3 5 7]
layer2_inf_t: 35.119384765625
assumed final_attacker_idxs:  [3 4 5 6 7]
final_attacker_idxs is: [3, 4, 5, 6, 7]
g_attacker_idxs: [85  4 11 24 42]
g_normal_idxs: [74  9 99 23 25]
filtered_attacker_idxs: [3, 4, 5, 6, 7]
final_attacker_idxs are: [3, 4, 5, 6, 7]
num_dps: [557, 436, 377, 431, 658, 645, 379, 236, 293, 647]
epoch_acc: 98.48
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0479, Accuracy: 9848/10000 (98.4800%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 13.1106, Accuracy: 32/8968 (0.3568%)
Done in 60.320348262786865 sec.
Server Epoch:42 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
poison local model 93 index 0
class_loss: 3.862671375274658, distance_loss: 0.0
class_loss: 2.003775119781494, distance_loss: 0.4229529798030853
class_loss: 2.2749524116516113, distance_loss: 0.8906631469726562
class_loss: 1.770857810974121, distance_loss: 1.2319715023040771
class_loss: 1.3712083101272583, distance_loss: 1.577807903289795
class_loss: 1.3989452123641968, distance_loss: 1.9253571033477783
class_loss: 1.3125646114349365, distance_loss: 2.2426419258117676
class_loss: 1.3120228052139282, distance_loss: 2.526273250579834
class_loss: 1.3037636280059814, distance_loss: 2.7815606594085693
class_loss: 1.1764713525772095, distance_loss: 3.0185892581939697
___PoisonTrain Local_Simple ,  epoch  42, local model 93, internal_epoch   1,  Average loss: 0.0286, Accuracy: 342/623 (54.8957%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  42, local model 93, internal_epoch   2,  Average loss: 0.0160, Accuracy: 318/623 (51.0433%), train_poison_data_count: 200
Global model norm: 15.677001844766757.
Norm before scaling: 15.888412456586876. Distance: 4.681822326469775
Total norm for 4 adversaries is: 15.888412456586876. distance: 4.681822326469775
class_loss: 1.2773188352584839, distance_loss: 3.2402231693267822
class_loss: 1.0410912036895752, distance_loss: 3.4440009593963623
class_loss: 1.198943018913269, distance_loss: 3.6324856281280518
class_loss: 0.9094608426094055, distance_loss: 3.8059141635894775
class_loss: 1.0234071016311646, distance_loss: 3.9661929607391357
class_loss: 0.934562087059021, distance_loss: 4.114350318908691
class_loss: 0.853075385093689, distance_loss: 4.250341892242432
class_loss: 0.8933925628662109, distance_loss: 4.371903896331787
class_loss: 0.8448821306228638, distance_loss: 4.483814716339111
class_loss: 0.9676051139831543, distance_loss: 4.585075855255127
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.5912, Accuracy: 2710/8968 (30.2186%)
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0007, Accuracy: 462/470 (98.2979%)
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   2,  Average loss: 0.0003, Accuracy: 467/470 (99.3617%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0897, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch  42, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch  42, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.3217, Accuracy: 8946/10000 (89.4600%)
poison local model 70 index 1
___PoisonTrain Local_Simple ,  epoch  42, local model 70, internal_epoch   1,  Average loss: 0.0276, Accuracy: 368/724 (50.8287%), train_poison_data_count: 240
class_loss: 4.002979278564453, distance_loss: 0.0
class_loss: 2.1926262378692627, distance_loss: 0.3331342935562134
class_loss: 1.3258532285690308, distance_loss: 0.7998697757720947
class_loss: 1.9905030727386475, distance_loss: 1.236769437789917
class_loss: 1.3156967163085938, distance_loss: 1.5893645286560059
class_loss: 1.2799123525619507, distance_loss: 1.9109032154083252
class_loss: 1.4676940441131592, distance_loss: 2.198300838470459
class_loss: 1.3666625022888184, distance_loss: 2.456882953643799
class_loss: 1.4169989824295044, distance_loss: 2.6796791553497314
class_loss: 1.3327631950378418, distance_loss: 2.8779592514038086
class_loss: 1.2003378868103027, distance_loss: 3.0561916828155518
class_loss: 1.0950270891189575, distance_loss: 3.216719150543213
class_loss: 1.1498470306396484, distance_loss: 3.3824522495269775
class_loss: 1.2907005548477173, distance_loss: 3.5322117805480957
class_loss: 1.3122049570083618, distance_loss: 3.6589317321777344
class_loss: 1.138444185256958, distance_loss: 3.761918783187866
class_loss: 0.8143812417984009, distance_loss: 3.853175640106201
class_loss: 0.9288666844367981, distance_loss: 3.9420559406280518
class_loss: 0.9989848136901855, distance_loss: 4.0257439613342285
class_loss: 0.8877161145210266, distance_loss: 4.104285717010498
class_loss: 0.9661414623260498, distance_loss: 4.181699275970459
class_loss: 0.9166039228439331, distance_loss: 4.25750207901001
class_loss: 0.8618054986000061, distance_loss: 4.329560279846191
class_loss: 1.2657232284545898, distance_loss: 4.399865627288818
___PoisonTrain Local_Simple ,  epoch  42, local model 70, internal_epoch   2,  Average loss: 0.0173, Accuracy: 382/724 (52.7624%), train_poison_data_count: 240
Global model norm: 15.677001844766757.
Norm before scaling: 15.875069685655369. Distance: 4.509452217482497
Total norm for 4 adversaries is: 15.875069685655369. distance: 4.509452217482497
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.2700, Accuracy: 8748/8968 (97.5468%)
___Train Local_Simple,  epoch  42, local model 15, internal_epoch   1,  Average loss: 0.0008, Accuracy: 395/401 (98.5037%)
___Train Local_Simple,  epoch  42, local model 15, internal_epoch   2,  Average loss: 0.0004, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1058, Accuracy: 9676/10000 (96.7600%)
___Train Local_Simple,  epoch  42, local model 90, internal_epoch   1,  Average loss: 0.0013, Accuracy: 667/683 (97.6574%)
___Train Local_Simple,  epoch  42, local model 90, internal_epoch   2,  Average loss: 0.0005, Accuracy: 677/683 (99.1215%)
class_loss: 4.253359794616699, distance_loss: 0.0
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4133, Accuracy: 8743/10000 (87.4300%)
poison local model 91 index 2
___PoisonTrain Local_Simple ,  epoch  42, local model 91, internal_epoch   1,  Average loss: 0.0383, Accuracy: 141/256 (55.0781%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  42, local model 91, internal_epoch   2,  Average loss: 0.0224, Accuracy: 112/256 (43.7500%), train_poison_data_count: 80
Global model norm: 15.677001844766757.
Norm before scaling: 15.44868095223869. Distance: 2.9156702428580448
Total norm for 4 adversaries is: 15.44868095223869. distance: 2.9156702428580448
class_loss: 1.9928535223007202, distance_loss: 0.35621389746665955
class_loss: 1.8193385601043701, distance_loss: 0.8944128155708313
class_loss: 1.7516257762908936, distance_loss: 1.354760766029358
class_loss: 1.522504448890686, distance_loss: 1.7284140586853027
class_loss: 1.4076989889144897, distance_loss: 2.0638961791992188
class_loss: 1.3507845401763916, distance_loss: 2.3749749660491943
class_loss: 1.4425795078277588, distance_loss: 2.657466411590576
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.6468, Accuracy: 3960/8968 (44.1570%)
___Train Local_Simple,  epoch  42, local model 86, internal_epoch   1,  Average loss: 0.0008, Accuracy: 245/250 (98.0000%)
___Train Local_Simple,  epoch  42, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1278, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch  42, local model 67, internal_epoch   1,  Average loss: 0.0009, Accuracy: 981/998 (98.2966%)
___Train Local_Simple,  epoch  42, local model 67, internal_epoch   2,  Average loss: 0.0006, Accuracy: 985/998 (98.6974%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.2111, Accuracy: 9318/10000 (93.1800%)
poison local model 20 index 3
___PoisonTrain Local_Simple ,  epoch  42, local model 20, internal_epoch   1,  Average loss: 0.0324, Accuracy: 231/429 (53.8462%), train_poison_data_count: 140
class_loss: 4.748095989227295, distance_loss: 0.0
class_loss: 2.76657772064209, distance_loss: 0.38958635926246643
class_loss: 1.1239819526672363, distance_loss: 0.9095172882080078
class_loss: 1.2352542877197266, distance_loss: 1.4074939489364624
class_loss: 1.6307425498962402, distance_loss: 1.8395228385925293
class_loss: 1.375985026359558, distance_loss: 2.1985697746276855
class_loss: 1.0116925239562988, distance_loss: 2.5183029174804688
class_loss: 1.2276577949523926, distance_loss: 2.8126680850982666
class_loss: 1.024199366569519, distance_loss: 3.080509901046753
class_loss: 1.0104304552078247, distance_loss: 3.324411153793335
class_loss: 0.92159503698349, distance_loss: 3.5467143058776855
class_loss: 1.0992413759231567, distance_loss: 3.747213840484619
class_loss: 0.9465740919113159, distance_loss: 3.9302217960357666
class_loss: 0.9290111064910889, distance_loss: 4.099212646484375
___PoisonTrain Local_Simple ,  epoch  42, local model 20, internal_epoch   2,  Average loss: 0.0167, Accuracy: 242/429 (56.4103%), train_poison_data_count: 140
Global model norm: 15.677001844766757.
Norm before scaling: 15.660061735808577. Distance: 4.25558844759198
Total norm for 4 adversaries is: 15.660061735808577. distance: 4.25558844759198
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.1453, Accuracy: 8845/8968 (98.6285%)
time spent on training: 62.21965003013611
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93, 70, 91, 20]
base_p: [-0.00342794  0.00012606  0.00056955 ... -0.00222122 -0.00242608
 -0.00251056]
[T_SCORE] attacker_local_idxs is:  [0, 3, 6, 8, 9]
layer1_inf_time: 3.839599609375
[PAIRWISE] pred_attackers_indx:  [0 3 6 9]
layer2_inf_t: 32.12841796875
assumed final_attacker_idxs:  [0 3 6 8 9]
final_attacker_idxs is: [0, 3, 6, 8, 9]
g_attacker_idxs: [93 70 91 67 20]
g_normal_idxs: [87 55 15 90 86]
filtered_attacker_idxs: [0, 3, 6, 8, 9]
final_attacker_idxs are: [0, 3, 6, 8, 9]
num_dps: [623, 470, 354, 724, 401, 683, 256, 250, 998, 429]
Starting performing KrMLRFL...
Num data points: [623, 470, 354, 724, 401, 683, 256, 250, 998, 429]
Num selected data points: [470 354 401 683 250]
The chosen ones are users: [1, 2, 4, 5, 7], which are global users: [87, 55, 15, 90, 86]
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0588, Accuracy: 9797/10000 (97.9700%)
epoch_acc: 97.97
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 12.2289, Accuracy: 25/8968 (0.2788%)
Done in 67.95829153060913 sec.
Server Epoch:43 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  43, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 575/589 (97.6231%)
___Train Local_Simple,  epoch  43, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 580/589 (98.4720%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0666, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch  43, local model 57, internal_epoch   1,  Average loss: 0.0009, Accuracy: 337/343 (98.2507%)
___Train Local_Simple,  epoch  43, local model 57, internal_epoch   2,  Average loss: 0.0011, Accuracy: 335/343 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1650, Accuracy: 9496/10000 (94.9600%)
___Train Local_Simple,  epoch  43, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch  43, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1346, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  43, local model 67, internal_epoch   1,  Average loss: 0.0014, Accuracy: 973/998 (97.4950%)
___Train Local_Simple,  epoch  43, local model 67, internal_epoch   2,  Average loss: 0.0012, Accuracy: 971/998 (97.2946%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2442, Accuracy: 9222/10000 (92.2200%)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0007, Accuracy: 370/376 (98.4043%)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2472, Accuracy: 9282/10000 (92.8200%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 481/487 (98.7680%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0918, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  43, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 495/501 (98.8024%)
___Train Local_Simple,  epoch  43, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0718, Accuracy: 9776/10000 (97.7600%)
poison local model 22 index 0
class_loss: 3.492231607437134, distance_loss: 0.0
class_loss: 2.0238630771636963, distance_loss: 0.36459434032440186
class_loss: 1.6699049472808838, distance_loss: 0.8119707107543945
class_loss: 1.138849139213562, distance_loss: 1.1620346307754517
class_loss: 1.0334806442260742, distance_loss: 1.4727141857147217
class_loss: 1.644277572631836, distance_loss: 1.777342438697815
class_loss: 1.4281176328659058, distance_loss: 2.0671546459198
class_loss: 1.3045241832733154, distance_loss: 2.334181308746338
class_loss: 1.100266933441162, distance_loss: 2.577157974243164
class_loss: 1.2110220193862915, distance_loss: 2.787745475769043
___PoisonTrain Local_Simple ,  epoch  43, local model 22, internal_epoch   1,  Average loss: 0.0275, Accuracy: 324/583 (55.5746%), train_poison_data_count: 187
___PoisonTrain Local_Simple ,  epoch  43, local model 22, internal_epoch   2,  Average loss: 0.0191, Accuracy: 292/583 (50.0858%), train_poison_data_count: 187
Global model norm: 15.64086548032534.
Norm before scaling: 15.700225653514954. Distance: 4.273450889775641
Total norm for 3 adversaries is: 15.700225653514954. distance: 4.273450889775641
class_loss: 1.1041194200515747, distance_loss: 3.0029754638671875
class_loss: 1.2817111015319824, distance_loss: 3.194619655609131
class_loss: 1.2095766067504883, distance_loss: 3.3614580631256104
class_loss: 1.0589394569396973, distance_loss: 3.505030870437622
class_loss: 0.9433577060699463, distance_loss: 3.6347954273223877
class_loss: 1.153402328491211, distance_loss: 3.7577154636383057
class_loss: 0.9235419034957886, distance_loss: 3.870913505554199
class_loss: 0.9549393653869629, distance_loss: 3.9778435230255127
class_loss: 0.8041154146194458, distance_loss: 4.078728675842285
class_loss: 1.710013508796692, distance_loss: 4.174509048461914
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 1.0653, Accuracy: 4325/8968 (48.2270%)
poison local model 70 index 1
class_loss: 3.4047722816467285, distance_loss: 0.0
class_loss: 2.595916271209717, distance_loss: 0.3283650875091553
class_loss: 1.4164249897003174, distance_loss: 0.762072741985321
class_loss: 1.9662522077560425, distance_loss: 1.1890498399734497
class_loss: 1.445646047592163, distance_loss: 1.56464684009552
class_loss: 1.4238144159317017, distance_loss: 1.891180396080017
class_loss: 1.4235442876815796, distance_loss: 2.1792378425598145
class_loss: 1.4696996212005615, distance_loss: 2.4321470260620117
class_loss: 1.4473870992660522, distance_loss: 2.654475688934326
class_loss: 1.3688195943832397, distance_loss: 2.85050106048584
class_loss: 1.2979685068130493, distance_loss: 3.0237162113189697
class_loss: 0.9665913581848145, distance_loss: 3.181124210357666
class_loss: 1.2541955709457397, distance_loss: 3.348257303237915
___PoisonTrain Local_Simple ,  epoch  43, local model 70, internal_epoch   1,  Average loss: 0.0279, Accuracy: 360/724 (49.7238%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  43, local model 70, internal_epoch   2,  Average loss: 0.0173, Accuracy: 386/724 (53.3149%), train_poison_data_count: 240
Global model norm: 15.64086548032534.
Norm before scaling: 15.823244327101703. Distance: 4.4967819999531375
Total norm for 3 adversaries is: 15.823244327101703. distance: 4.4967819999531375
class_loss: 1.2824727296829224, distance_loss: 3.495887041091919
class_loss: 1.3162734508514404, distance_loss: 3.614553928375244
class_loss: 0.8985348343849182, distance_loss: 3.7147679328918457
class_loss: 1.0460141897201538, distance_loss: 3.8123788833618164
class_loss: 0.9958377480506897, distance_loss: 3.9065682888031006
class_loss: 1.0762567520141602, distance_loss: 3.9973130226135254
class_loss: 1.089479923248291, distance_loss: 4.083817005157471
class_loss: 0.8673506379127502, distance_loss: 4.16766881942749
class_loss: 0.7498934268951416, distance_loss: 4.248981475830078
class_loss: 0.9103050827980042, distance_loss: 4.327449798583984
class_loss: 1.0545076131820679, distance_loss: 4.399517059326172
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.3640, Accuracy: 8071/8968 (89.9978%)
poison local model 93 index 2
class_loss: 3.1997623443603516, distance_loss: 0.0
class_loss: 2.3098862171173096, distance_loss: 0.2847716808319092
class_loss: 1.1193960905075073, distance_loss: 0.74300217628479
class_loss: 1.3282164335250854, distance_loss: 1.1306369304656982
class_loss: 1.3518197536468506, distance_loss: 1.4333730936050415
class_loss: 1.3649296760559082, distance_loss: 1.7135646343231201
class_loss: 1.5571539402008057, distance_loss: 1.986474633216858
class_loss: 1.3261998891830444, distance_loss: 2.243812084197998
class_loss: 1.321995496749878, distance_loss: 2.4801981449127197
class_loss: 1.243317723274231, distance_loss: 2.691169023513794
___PoisonTrain Local_Simple ,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0259, Accuracy: 346/623 (55.5377%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  43, local model 93, internal_epoch   2,  Average loss: 0.0146, Accuracy: 358/623 (57.4639%), train_poison_data_count: 200
Global model norm: 15.64086548032534.
Norm before scaling: 15.782303878795904. Distance: 4.174889778920839
Total norm for 3 adversaries is: 15.782303878795904. distance: 4.174889778920839
class_loss: 1.2843016386032104, distance_loss: 2.8831052780151367
class_loss: 1.0541300773620605, distance_loss: 3.0565874576568604
class_loss: 0.9907003045082092, distance_loss: 3.2168638706207275
class_loss: 0.906238317489624, distance_loss: 3.3646035194396973
class_loss: 0.8619973659515381, distance_loss: 3.5023856163024902
class_loss: 0.7191804051399231, distance_loss: 3.6340248584747314
class_loss: 0.7886273860931396, distance_loss: 3.7578585147857666
class_loss: 0.8150226473808289, distance_loss: 3.8761234283447266
class_loss: 0.7134691476821899, distance_loss: 3.985999822616577
class_loss: 0.9813157916069031, distance_loss: 4.085455894470215
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 1.0494, Accuracy: 4339/8968 (48.3831%)
time spent on training: 55.10581159591675
Starting performing KrMLRFL...
Num data points: [589, 343, 312, 998, 376, 487, 501, 583, 724, 623]
Num selected data points: [343 312 376 487 501]
The chosen ones are users: [1, 2, 4, 5, 6], which are global users: [57, 21, 14, 97, 28]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 70, 93]
base_p: [-0.00193997  0.00015401 -0.00035725 ... -0.00397549 -0.0021209
 -0.00349066]
[T_SCORE] attacker_local_idxs is:  [0, 3, 7, 8, 9]
layer1_inf_time: 3.24609375
[PAIRWISE] pred_attackers_indx:  [7 8 9]
layer2_inf_t: 52.890869140625
assumed final_attacker_idxs:  [0 3 7 8 9]
final_attacker_idxs is: [0, 3, 7, 8, 9]
g_attacker_idxs: [77 67 22 70 93]
g_normal_idxs: [57 21 14 97 28]
filtered_attacker_idxs: [0, 3, 7, 8, 9]
final_attacker_idxs are: [0, 3, 7, 8, 9]
num_dps: [589, 343, 312, 998, 376, 487, 501, 583, 724, 623]
epoch_acc: 98.28
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0520, Accuracy: 9828/10000 (98.2800%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 12.1776, Accuracy: 46/8968 (0.5129%)
Done in 61.11065363883972 sec.
Server Epoch:44 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
___Train Local_Simple,  epoch  44, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch  44, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 855/860 (99.4186%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1061, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  44, local model 49, internal_epoch   1,  Average loss: 0.0006, Accuracy: 499/506 (98.6166%)
___Train Local_Simple,  epoch  44, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 502/506 (99.2095%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1087, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 599/606 (98.8449%)
___Train Local_Simple,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1349, Accuracy: 9544/10000 (95.4400%)
___Train Local_Simple,  epoch  44, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 468/474 (98.7342%)
___Train Local_Simple,  epoch  44, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1247, Accuracy: 9604/10000 (96.0400%)
poison local model 71 index 0
class_loss: 3.71663498878479, distance_loss: 0.0
class_loss: 1.3157823085784912, distance_loss: 0.33597081899642944
class_loss: 1.531233787536621, distance_loss: 0.7793681025505066
class_loss: 1.8216055631637573, distance_loss: 1.0636767148971558
class_loss: 1.4560720920562744, distance_loss: 1.3155511617660522
class_loss: 1.1458802223205566, distance_loss: 1.5868651866912842
class_loss: 0.9644039869308472, distance_loss: 1.8548673391342163
class_loss: 1.061464548110962, distance_loss: 2.1097307205200195
class_loss: 0.9518100023269653, distance_loss: 2.351254463195801
class_loss: 0.8916191458702087, distance_loss: 2.572777271270752
class_loss: 0.824394166469574, distance_loss: 2.776625156402588
class_loss: 0.8937565684318542, distance_loss: 2.9617912769317627
class_loss: 1.1443517208099365, distance_loss: 3.1320579051971436
class_loss: 1.0048465728759766, distance_loss: 3.2850875854492188
class_loss: 0.8712325096130371, distance_loss: 3.423032283782959
class_loss: 0.7380197048187256, distance_loss: 3.550640344619751
class_loss: 0.7408034205436707, distance_loss: 3.6700363159179688
class_loss: 0.6847260594367981, distance_loss: 3.7812657356262207
class_loss: 0.7846431136131287, distance_loss: 3.8846640586853027
___PoisonTrain Local_Simple ,  epoch  44, local model 71, internal_epoch   1,  Average loss: 0.0180, Accuracy: 789/1384 (57.0087%), train_poison_data_count: 440
class_loss: 0.7342557311058044, distance_loss: 3.976503372192383
class_loss: 0.7312560677528381, distance_loss: 4.059825897216797
class_loss: 0.9204785227775574, distance_loss: 4.135745525360107
class_loss: 0.7584682703018188, distance_loss: 4.207574367523193
class_loss: 0.7788894772529602, distance_loss: 4.271894931793213
class_loss: 0.806613564491272, distance_loss: 4.324260711669922
class_loss: 0.7573918104171753, distance_loss: 4.370772361755371
class_loss: 0.7256590127944946, distance_loss: 4.4129438400268555
class_loss: 0.6904531717300415, distance_loss: 4.451770782470703
class_loss: 0.7223858833312988, distance_loss: 4.487896919250488
class_loss: 0.6834532022476196, distance_loss: 4.52332067489624
class_loss: 0.6458691358566284, distance_loss: 4.55769681930542
class_loss: 0.7094042301177979, distance_loss: 4.588184833526611
class_loss: 0.7323363423347473, distance_loss: 4.615793228149414
class_loss: 0.7856141328811646, distance_loss: 4.641282081604004
class_loss: 0.6357014179229736, distance_loss: 4.664276123046875
class_loss: 0.6600959897041321, distance_loss: 4.68505334854126
class_loss: 0.6838324666023254, distance_loss: 4.703706741333008
class_loss: 0.6909769773483276, distance_loss: 4.721519947052002
class_loss: 0.6932665109634399, distance_loss: 4.7378153800964355
class_loss: 0.7698384523391724, distance_loss: 4.753159999847412
class_loss: 0.7843113541603088, distance_loss: 4.767415523529053
class_loss: 0.6393012404441833, distance_loss: 4.779932022094727
class_loss: 0.6686122417449951, distance_loss: 4.792512893676758
class_loss: 0.884894847869873, distance_loss: 4.8064751625061035
___PoisonTrain Local_Simple ,  epoch  44, local model 71, internal_epoch   2,  Average loss: 0.0115, Accuracy: 889/1384 (64.2341%), train_poison_data_count: 440
Global model norm: 15.63288228916831.
Norm before scaling: 15.875950101520745. Distance: 4.824671229096555
Total norm for 3 adversaries is: 15.875950101520745. distance: 4.824671229096555
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.9141, Accuracy: 5046/8968 (56.2667%)
___Train Local_Simple,  epoch  44, local model 60, internal_epoch   1,  Average loss: 0.0018, Accuracy: 332/338 (98.2249%)
___Train Local_Simple,  epoch  44, local model 60, internal_epoch   2,  Average loss: 0.0016, Accuracy: 327/338 (96.7456%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2019, Accuracy: 9388/10000 (93.8800%)
poison local model 42 index 1
class_loss: 3.4562928676605225, distance_loss: 0.0
class_loss: 1.783978819847107, distance_loss: 0.2732919156551361
___PoisonTrain Local_Simple ,  epoch  44, local model 42, internal_epoch   1,  Average loss: 0.0310, Accuracy: 171/236 (72.4576%), train_poison_data_count: 80
class_loss: 0.8917487263679504, distance_loss: 0.6746756434440613
class_loss: 1.1862982511520386, distance_loss: 1.0571733713150024
class_loss: 1.0798730850219727, distance_loss: 1.3782310485839844
class_loss: 1.0408751964569092, distance_loss: 1.6489404439926147
class_loss: 0.8491421341896057, distance_loss: 1.9075982570648193
class_loss: 1.0133273601531982, distance_loss: 2.1538710594177246
___PoisonTrain Local_Simple ,  epoch  44, local model 42, internal_epoch   2,  Average loss: 0.0169, Accuracy: 141/236 (59.7458%), train_poison_data_count: 80
Global model norm: 15.63288228916831.
Norm before scaling: 15.392047642053164. Distance: 2.383742954381763
Total norm for 3 adversaries is: 15.392047642053164. distance: 2.383742954381763
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.3463, Accuracy: 3784/8968 (42.1945%)
___Train Local_Simple,  epoch  44, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 428/433 (98.8453%)
___Train Local_Simple,  epoch  44, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0558, Accuracy: 9809/10000 (98.0900%)
poison local model 26 index 2
class_loss: 3.3646843433380127, distance_loss: 0.0
class_loss: 1.6300039291381836, distance_loss: 0.27524691820144653
class_loss: 1.0910499095916748, distance_loss: 0.6313761472702026
class_loss: 1.0587806701660156, distance_loss: 0.9640488624572754
class_loss: 0.6809016466140747, distance_loss: 1.2716023921966553
class_loss: 0.6546668410301208, distance_loss: 1.540452003479004
class_loss: 0.7567296028137207, distance_loss: 1.7896384000778198
class_loss: 0.8495673537254333, distance_loss: 2.0148208141326904
class_loss: 0.9530030488967896, distance_loss: 2.212186098098755
___PoisonTrain Local_Simple ,  epoch  44, local model 26, internal_epoch   1,  Average loss: 0.0199, Accuracy: 395/554 (71.2996%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  44, local model 26, internal_epoch   2,  Average loss: 0.0127, Accuracy: 371/554 (66.9675%), train_poison_data_count: 180
Global model norm: 15.63288228916831.
Norm before scaling: 15.541667430287905. Distance: 3.3000001965147017
Total norm for 3 adversaries is: 15.541667430287905. distance: 3.3000001965147017
class_loss: 0.8762200474739075, distance_loss: 2.390862464904785
class_loss: 0.8697971701622009, distance_loss: 2.547210931777954
class_loss: 0.7297832369804382, distance_loss: 2.6840476989746094
class_loss: 0.869196355342865, distance_loss: 2.805311679840088
class_loss: 0.756152868270874, distance_loss: 2.9145095348358154
class_loss: 0.5684840679168701, distance_loss: 3.01782488822937
class_loss: 0.8025068640708923, distance_loss: 3.106438159942627
class_loss: 0.7392237782478333, distance_loss: 3.1792988777160645
class_loss: 0.8069989085197449, distance_loss: 3.242262601852417
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.6627, Accuracy: 6949/8968 (77.4866%)
___Train Local_Simple,  epoch  44, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 443/448 (98.8839%)
___Train Local_Simple,  epoch  44, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0846, Accuracy: 9740/10000 (97.4000%)
time spent on training: 54.682735204696655
Starting performing KrMLRFL...
Num data points: [860, 506, 606, 474, 1384, 338, 236, 433, 554, 448]
Num selected data points: [860 606 474 433 448]
The chosen ones are users: [0, 2, 3, 7, 9], which are global users: [37, 41, 50, 83, 48]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 42, 26]
base_p: [-0.00085947  0.00030539  0.00020016 ... -0.00117759 -0.00814805
 -0.00443361]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 6, 8]
layer1_inf_time: 3.38525390625
[PAIRWISE] pred_attackers_indx:  [4 6 8]
layer2_inf_t: 41.609619140625
assumed final_attacker_idxs:  [1 4 5 6 8]
final_attacker_idxs is: [1, 4, 5, 6, 8]
g_attacker_idxs: [49 71 60 42 26]
g_normal_idxs: [37 41 50 83 48]
filtered_attacker_idxs: [1, 4, 5, 6, 8]
final_attacker_idxs are: [1, 4, 5, 6, 8]
num_dps: [860, 506, 606, 474, 1384, 338, 236, 433, 554, 448]
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0478, Accuracy: 9853/10000 (98.5300%)
epoch_acc: 98.53
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 13.4825, Accuracy: 22/8968 (0.2453%)
Done in 61.019633054733276 sec.
Server Epoch:45 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
___Train Local_Simple,  epoch  45, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 469/474 (98.9451%)
___Train Local_Simple,  epoch  45, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0993, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch  45, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 984/1005 (97.9104%)
___Train Local_Simple,  epoch  45, local model 36, internal_epoch   2,  Average loss: 0.0009, Accuracy: 985/1005 (98.0100%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.2475, Accuracy: 9230/10000 (92.3000%)
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5185, Accuracy: 8808/10000 (88.0800%)
___Train Local_Simple,  epoch  45, local model 79, internal_epoch   1,  Average loss: 0.0005, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch  45, local model 79, internal_epoch   2,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0724, Accuracy: 9770/10000 (97.7000%)
___Train Local_Simple,  epoch  45, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 613/623 (98.3949%)
___Train Local_Simple,  epoch  45, local model 33, internal_epoch   2,  Average loss: 0.0010, Accuracy: 614/623 (98.5554%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1940, Accuracy: 9344/10000 (93.4400%)
___Train Local_Simple,  epoch  45, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 642/647 (99.2272%)
___Train Local_Simple,  epoch  45, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1692, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch  45, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 394/401 (98.2544%)
___Train Local_Simple,  epoch  45, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1870, Accuracy: 9461/10000 (94.6100%)
poison local model 1 index 0
class_loss: 3.5318949222564697, distance_loss: 0.0
class_loss: 2.522322654724121, distance_loss: 0.2794223725795746
class_loss: 1.132466435432434, distance_loss: 0.7190887928009033
class_loss: 0.9818066954612732, distance_loss: 1.1900825500488281
class_loss: 1.5148515701293945, distance_loss: 1.604852318763733
class_loss: 1.0967415571212769, distance_loss: 1.9481722116470337
class_loss: 1.2830747365951538, distance_loss: 2.255239486694336
class_loss: 1.3097602128982544, distance_loss: 2.5328352451324463
class_loss: 1.1930769681930542, distance_loss: 2.781118631362915
class_loss: 1.0793784856796265, distance_loss: 3.004749059677124
class_loss: 1.0824637413024902, distance_loss: 3.20497989654541
class_loss: 0.8994754552841187, distance_loss: 3.389357805252075
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0232, Accuracy: 462/760 (60.7895%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0088, Accuracy: 614/760 (80.7895%), train_poison_data_count: 240
Global model norm: 15.583025652182009.
Norm before scaling: 15.858282944236212. Distance: 4.871365488360672
Total norm for 1 adversaries is: 15.858282944236212. distance: 4.871365488360672
class_loss: 0.8712217807769775, distance_loss: 3.557145833969116
class_loss: 0.7591414451599121, distance_loss: 3.708097457885742
class_loss: 0.7160655856132507, distance_loss: 3.844789981842041
class_loss: 0.7444606423377991, distance_loss: 3.9691176414489746
class_loss: 0.5437741875648499, distance_loss: 4.087573528289795
class_loss: 0.5898793935775757, distance_loss: 4.20088005065918
class_loss: 0.5419502854347229, distance_loss: 4.313409328460693
class_loss: 0.35279425978660583, distance_loss: 4.424018859863281
class_loss: 0.37040162086486816, distance_loss: 4.528233528137207
class_loss: 0.4777906537055969, distance_loss: 4.629472732543945
class_loss: 0.3216438591480255, distance_loss: 4.7193922996521
class_loss: 0.36196258664131165, distance_loss: 4.798569202423096
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.1643, Accuracy: 8437/8968 (94.0789%)
___Train Local_Simple,  epoch  45, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch  45, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0768, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch  45, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 809/818 (98.8998%)
___Train Local_Simple,  epoch  45, local model 98, internal_epoch   2,  Average loss: 0.0004, Accuracy: 812/818 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1672, Accuracy: 9459/10000 (94.5900%)
time spent on training: 39.16617941856384
Starting performing KrMLRFL...
Num data points: [474, 1005, 739, 182, 623, 647, 401, 760, 371, 818]
Num selected data points: [474 182 623 647 401]
The chosen ones are users: [0, 3, 4, 5, 6], which are global users: [50, 79, 33, 25, 15]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1]
base_p: [-2.5263876e-03  4.8996508e-04  5.7197176e-05 ... -1.1118650e-03
 -2.9160902e-03 -4.2938441e-04]
[T_SCORE] attacker_local_idxs is:  [1, 2, 7, 8, 9]
layer1_inf_time: 3.35009765625
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 36.78662109375
assumed final_attacker_idxs:  [1 2 7 8 9]
final_attacker_idxs is: [1, 2, 7, 8, 9]
g_attacker_idxs: [36 53  1 65 98]
g_normal_idxs: [50 79 33 25 15]
filtered_attacker_idxs: [1, 2, 7, 8, 9]
final_attacker_idxs are: [1, 2, 7, 8, 9]
num_dps: [474, 1005, 739, 182, 623, 647, 401, 760, 371, 818]
epoch_acc: 98.50999999999999
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0479, Accuracy: 9851/10000 (98.5100%)
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 12.7216, Accuracy: 26/8968 (0.2899%)
Done in 45.85170221328735 sec.
Server Epoch:46 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  46, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 705/713 (98.8780%)
___Train Local_Simple,  epoch  46, local model 82, internal_epoch   2,  Average loss: 0.0025, Accuracy: 691/713 (96.9144%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3218, Accuracy: 8951/10000 (89.5100%)
___Train Local_Simple,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 644/658 (97.8723%)
___Train Local_Simple,  epoch  46, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 654/658 (99.3921%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1343, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch  46, local model 79, internal_epoch   1,  Average loss: 0.0009, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch  46, local model 79, internal_epoch   2,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0646, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch  46, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 957/977 (97.9529%)
___Train Local_Simple,  epoch  46, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 968/977 (99.0788%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1661, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch  46, local model 47, internal_epoch   1,  Average loss: 0.0016, Accuracy: 766/776 (98.7113%)
___Train Local_Simple,  epoch  46, local model 47, internal_epoch   2,  Average loss: 0.0051, Accuracy: 706/776 (90.9794%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.4104, Accuracy: 8688/10000 (86.8800%)
___Train Local_Simple,  epoch  46, local model 44, internal_epoch   1,  Average loss: 0.0009, Accuracy: 507/517 (98.0658%)
___Train Local_Simple,  epoch  46, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0627, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.0005, Accuracy: 488/492 (99.1870%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1801, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch  46, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 444/448 (99.1071%)
___Train Local_Simple,  epoch  46, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0937, Accuracy: 9710/10000 (97.1000%)
poison local model 70 index 0
class_loss: 3.3682894706726074, distance_loss: 0.0
class_loss: 1.863129734992981, distance_loss: 0.30738189816474915
class_loss: 1.958904504776001, distance_loss: 0.7773898243904114
class_loss: 1.5120019912719727, distance_loss: 1.2508318424224854
class_loss: 1.2068465948104858, distance_loss: 1.6228418350219727
class_loss: 1.1729291677474976, distance_loss: 1.9440566301345825
class_loss: 1.120421051979065, distance_loss: 2.246626853942871
class_loss: 1.3242067098617554, distance_loss: 2.5192065238952637
class_loss: 1.2178171873092651, distance_loss: 2.7640490531921387
class_loss: 0.9936118125915527, distance_loss: 2.9874773025512695
class_loss: 0.9316457509994507, distance_loss: 3.1897945404052734
class_loss: 0.3332127630710602, distance_loss: 3.380800247192383
class_loss: 0.8268983960151672, distance_loss: 3.5743656158447266
class_loss: 0.8060482740402222, distance_loss: 3.747568130493164
class_loss: 0.4999997317790985, distance_loss: 3.898087501525879
class_loss: 0.5578914284706116, distance_loss: 4.036407470703125
class_loss: 0.4550290107727051, distance_loss: 4.170011520385742
class_loss: 0.2787339687347412, distance_loss: 4.299139499664307
___PoisonTrain Local_Simple ,  epoch  46, local model 70, internal_epoch   1,  Average loss: 0.0235, Accuracy: 421/724 (58.1492%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  46, local model 70, internal_epoch   2,  Average loss: 0.0067, Accuracy: 621/724 (85.7735%), train_poison_data_count: 240
Global model norm: 15.54696087837462.
Norm before scaling: 16.02707955470161. Distance: 5.071618051654248
Total norm for 1 adversaries is: 16.02707955470161. distance: 5.071618051654248
class_loss: 0.2333289235830307, distance_loss: 4.4271626472473145
class_loss: 0.2647949457168579, distance_loss: 4.549139022827148
class_loss: 0.24200554192066193, distance_loss: 4.664259433746338
class_loss: 0.27430763840675354, distance_loss: 4.770119667053223
class_loss: 0.23947477340698242, distance_loss: 4.87161111831665
class_loss: 0.16208842396736145, distance_loss: 4.968801021575928
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0341, Accuracy: 8846/8968 (98.6396%)
___Train Local_Simple,  epoch  46, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 580/589 (98.4720%)
___Train Local_Simple,  epoch  46, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 584/589 (99.1511%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0720, Accuracy: 9773/10000 (97.7300%)
time spent on training: 40.7286639213562
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70]
base_p: [ 1.07616186e-04  5.97387552e-05  7.09308311e-04 ... -1.05611235e-03
 -2.22486258e-03  1.48689002e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 8]
layer1_inf_time: 3.656494140625
[PAIRWISE] pred_attackers_indx:  [8]
layer2_inf_t: 37.022705078125
assumed final_attacker_idxs:  [0 1 3 4 8]
final_attacker_idxs is: [0, 1, 3, 4, 8]
g_attacker_idxs: [82  4 32 47 70]
g_normal_idxs: [79 44 89 48 77]
filtered_attacker_idxs: [0, 1, 3, 4, 8]
final_attacker_idxs are: [0, 1, 3, 4, 8]
num_dps: [713, 658, 182, 977, 776, 517, 492, 448, 724, 589]
Starting performing KrMLRFL...
Num data points: [713, 658, 182, 977, 776, 517, 492, 448, 724, 589]
Num selected data points: [182 517 492 448 589]
The chosen ones are users: [2, 5, 6, 7, 9], which are global users: [79, 44, 89, 48, 77]
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0466, Accuracy: 9849/10000 (98.4900%)
epoch_acc: 98.49
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 12.6204, Accuracy: 42/8968 (0.4683%)
Done in 47.20519995689392 sec.
Server Epoch:47 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 0
___PoisonTrain Local_Simple ,  epoch  47, local model 27, internal_epoch   1,  Average loss: 0.0331, Accuracy: 237/471 (50.3185%), train_poison_data_count: 160
class_loss: 4.492801666259766, distance_loss: 0.0
class_loss: 2.734630584716797, distance_loss: 0.3641233742237091
class_loss: 1.7434264421463013, distance_loss: 0.8893742561340332
class_loss: 1.5801068544387817, distance_loss: 1.3019226789474487
class_loss: 1.1872105598449707, distance_loss: 1.6400775909423828
class_loss: 1.2332924604415894, distance_loss: 1.9534958600997925
class_loss: 1.2323678731918335, distance_loss: 2.2455239295959473
class_loss: 1.409538745880127, distance_loss: 2.5145816802978516
class_loss: 1.2058801651000977, distance_loss: 2.78145694732666
class_loss: 1.047102451324463, distance_loss: 3.0254225730895996
class_loss: 1.0117406845092773, distance_loss: 3.2469680309295654
class_loss: 1.0976533889770508, distance_loss: 3.447160005569458
class_loss: 0.9208495020866394, distance_loss: 3.6301910877227783
class_loss: 0.997308611869812, distance_loss: 3.7941665649414062
class_loss: 0.9149464964866638, distance_loss: 3.943721055984497
class_loss: 1.2453593015670776, distance_loss: 4.081759929656982
___PoisonTrain Local_Simple ,  epoch  47, local model 27, internal_epoch   2,  Average loss: 0.0179, Accuracy: 235/471 (49.8938%), train_poison_data_count: 160
Global model norm: 15.523648341704796.
Norm before scaling: 15.526703996254476. Distance: 4.22421837071734
Total norm for 2 adversaries is: 15.526703996254476. distance: 4.22421837071734
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.8091, Accuracy: 6009/8968 (67.0049%)
___Train Local_Simple,  epoch  47, local model 30, internal_epoch   1,  Average loss: 0.0004, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch  47, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1504, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  47, local model 33, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch  47, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0805, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%)
___Train Local_Simple,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1185, Accuracy: 9593/10000 (95.9300%)
___Train Local_Simple,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0010, Accuracy: 427/434 (98.3871%)
___Train Local_Simple,  epoch  47, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 431/434 (99.3088%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1696, Accuracy: 9401/10000 (94.0100%)
poison local model 52 index 1
class_loss: 4.321402549743652, distance_loss: 0.0
class_loss: 1.3294856548309326, distance_loss: 0.40468141436576843
class_loss: 2.950376272201538, distance_loss: 0.9337193369865417
class_loss: 1.737884283065796, distance_loss: 1.2298378944396973
___PoisonTrain Local_Simple ,  epoch  47, local model 52, internal_epoch   1,  Average loss: 0.0409, Accuracy: 136/253 (53.7549%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  47, local model 52, internal_epoch   2,  Average loss: 0.0189, Accuracy: 127/253 (50.1976%), train_poison_data_count: 80
Global model norm: 15.523648341704796.
Norm before scaling: 15.36030335206251. Distance: 2.8391288686583285
Total norm for 2 adversaries is: 15.36030335206251. distance: 2.8391288686583285
class_loss: 1.1730469465255737, distance_loss: 1.5569976568222046
class_loss: 1.2889410257339478, distance_loss: 1.9028908014297485
class_loss: 1.170823097229004, distance_loss: 2.237363576889038
class_loss: 1.137502670288086, distance_loss: 2.5486435890197754
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.7610, Accuracy: 1604/8968 (17.8858%)
___Train Local_Simple,  epoch  47, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1226/1246 (98.3949%)
___Train Local_Simple,  epoch  47, local model 84, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1238/1246 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0888, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 404/408 (99.0196%)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0007, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0560, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch  47, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 418/423 (98.8180%)
___Train Local_Simple,  epoch  47, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0608, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch  47, local model 18, internal_epoch   1,  Average loss: 0.0012, Accuracy: 447/459 (97.3856%)
___Train Local_Simple,  epoch  47, local model 18, internal_epoch   2,  Average loss: 0.0007, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1263, Accuracy: 9570/10000 (95.7000%)
time spent on training: 46.463541984558105
Starting performing KrMLRFL...
Num data points: [471, 400, 623, 606, 434, 253, 1246, 408, 423, 459]
Num selected data points: [400 606 434 408 423]
The chosen ones are users: [1, 3, 4, 7, 8], which are global users: [30, 41, 5, 43, 62]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 52]
base_p: [-0.00189739  0.00041641  0.000103   ...  0.00219236 -0.00428351
  0.00162218]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 6, 9]
layer1_inf_time: 3.951171875
[PAIRWISE] pred_attackers_indx:  [0 5]
layer2_inf_t: 37.4404296875
assumed final_attacker_idxs:  [0 2 5 6 9]
final_attacker_idxs is: [0, 2, 5, 6, 9]
g_attacker_idxs: [27 33 52 84 18]
g_normal_idxs: [30 41  5 43 62]
filtered_attacker_idxs: [0, 2, 5, 6, 9]
final_attacker_idxs are: [0, 2, 5, 6, 9]
num_dps: [471, 400, 623, 606, 434, 253, 1246, 408, 423, 459]
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0461, Accuracy: 9853/10000 (98.5300%)
epoch_acc: 98.53
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 13.1999, Accuracy: 32/8968 (0.3568%)
Done in 52.198725938797 sec.
Server Epoch:48 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
___Train Local_Simple,  epoch  48, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  48, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0641, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch  48, local model 29, internal_epoch   1,  Average loss: 0.0012, Accuracy: 982/1002 (98.0040%)
___Train Local_Simple,  epoch  48, local model 29, internal_epoch   2,  Average loss: 0.0007, Accuracy: 992/1002 (99.0020%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.2127, Accuracy: 9315/10000 (93.1500%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0004, Accuracy: 465/470 (98.9362%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0882, Accuracy: 9726/10000 (97.2600%)
___Train Local_Simple,  epoch  48, local model 78, internal_epoch   1,  Average loss: 0.0006, Accuracy: 300/303 (99.0099%)
___Train Local_Simple,  epoch  48, local model 78, internal_epoch   2,  Average loss: 0.0003, Accuracy: 301/303 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1313, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch  48, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch  48, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3473, Accuracy: 9043/10000 (90.4300%)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   2,  Average loss: 0.0003, Accuracy: 431/433 (99.5381%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0694, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0715, Accuracy: 9768/10000 (97.6800%)
poison local model 45 index 0
___PoisonTrain Local_Simple ,  epoch  48, local model 45, internal_epoch   1,  Average loss: 0.0305, Accuracy: 325/628 (51.7516%), train_poison_data_count: 200
class_loss: 4.020242691040039, distance_loss: 0.0
class_loss: 2.6476998329162598, distance_loss: 0.3595934212207794
class_loss: 1.5549569129943848, distance_loss: 0.9067746996879578
class_loss: 2.16286039352417, distance_loss: 1.3472249507904053
class_loss: 1.4335347414016724, distance_loss: 1.6974318027496338
class_loss: 1.485154628753662, distance_loss: 2.0257387161254883
class_loss: 1.5489375591278076, distance_loss: 2.3217904567718506
class_loss: 1.6128971576690674, distance_loss: 2.5816855430603027
class_loss: 1.437362551689148, distance_loss: 2.810216188430786
class_loss: 1.2736185789108276, distance_loss: 3.0154643058776855
___PoisonTrain Local_Simple ,  epoch  48, local model 45, internal_epoch   2,  Average loss: 0.0150, Accuracy: 339/628 (53.9809%), train_poison_data_count: 200
Global model norm: 15.484331640958466.
Norm before scaling: 15.651042749930633. Distance: 4.550989550624411
Total norm for 3 adversaries is: 15.651042749930633. distance: 4.550989550624411
class_loss: 1.1118581295013428, distance_loss: 3.206657886505127
class_loss: 1.0021626949310303, distance_loss: 3.3889858722686768
class_loss: 1.0118452310562134, distance_loss: 3.5649466514587402
class_loss: 0.9891064167022705, distance_loss: 3.7288901805877686
class_loss: 1.0702656507492065, distance_loss: 3.8813226222991943
class_loss: 0.7865628004074097, distance_loss: 4.019336223602295
class_loss: 0.9553565382957458, distance_loss: 4.1432271003723145
class_loss: 0.8820632696151733, distance_loss: 4.255910873413086
class_loss: 0.7504911422729492, distance_loss: 4.36012601852417
class_loss: 0.8353386521339417, distance_loss: 4.4589972496032715
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.6086, Accuracy: 3418/8968 (38.1133%)
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  48, local model 52, internal_epoch   1,  Average loss: 0.0394, Accuracy: 129/253 (50.9881%), train_poison_data_count: 80
class_loss: 4.75076961517334, distance_loss: 0.0
class_loss: 2.4031925201416016, distance_loss: 0.3910263180732727
class_loss: 1.3446452617645264, distance_loss: 0.9080268740653992
class_loss: 1.4699110984802246, distance_loss: 1.3274502754211426
class_loss: 1.3137885332107544, distance_loss: 1.6846705675125122
class_loss: 1.2657606601715088, distance_loss: 2.0002198219299316
class_loss: 1.1676888465881348, distance_loss: 2.2939720153808594
class_loss: 1.0232326984405518, distance_loss: 2.5691213607788086
___PoisonTrain Local_Simple ,  epoch  48, local model 52, internal_epoch   2,  Average loss: 0.0189, Accuracy: 121/253 (47.8261%), train_poison_data_count: 80
Global model norm: 15.484331640958466.
Norm before scaling: 15.270773325026337. Distance: 2.826677658071681
Total norm for 3 adversaries is: 15.270773325026337. distance: 2.826677658071681
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.4601, Accuracy: 3298/8968 (36.7752%)
poison local model 17 index 2
class_loss: 4.6834025382995605, distance_loss: 0.0
class_loss: 2.980771541595459, distance_loss: 0.36589258909225464
class_loss: 2.211562395095825, distance_loss: 0.9239404201507568
class_loss: 1.7877203226089478, distance_loss: 1.3768504858016968
class_loss: 1.405145525932312, distance_loss: 1.8022984266281128
class_loss: 1.3186801671981812, distance_loss: 2.2082102298736572
class_loss: 1.356921911239624, distance_loss: 2.5723273754119873
class_loss: 1.4243842363357544, distance_loss: 2.8920109272003174
class_loss: 1.4007861614227295, distance_loss: 3.1769800186157227
class_loss: 1.1939964294433594, distance_loss: 3.4323203563690186
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0319, Accuracy: 311/620 (50.1613%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0182, Accuracy: 314/620 (50.6452%), train_poison_data_count: 200
Global model norm: 15.484331640958466.
Norm before scaling: 15.589829068522278. Distance: 5.110179592791339
Total norm for 3 adversaries is: 15.589829068522278. distance: 5.110179592791339
class_loss: 1.2901620864868164, distance_loss: 3.673703193664551
class_loss: 1.2762221097946167, distance_loss: 3.8948330879211426
class_loss: 1.286716103553772, distance_loss: 4.093042850494385
class_loss: 1.1291166543960571, distance_loss: 4.270537853240967
class_loss: 1.0529476404190063, distance_loss: 4.428909778594971
class_loss: 0.991354763507843, distance_loss: 4.5714921951293945
class_loss: 1.2229962348937988, distance_loss: 4.702247619628906
class_loss: 1.0094120502471924, distance_loss: 4.8188886642456055
class_loss: 0.9756196141242981, distance_loss: 4.924191951751709
class_loss: 1.01981782913208, distance_loss: 5.0195207595825195
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.0352, Accuracy: 5660/8968 (63.1133%)
time spent on training: 52.53555655479431
Starting performing KrMLRFL...
Num data points: [257, 1002, 470, 303, 739, 433, 205, 628, 253, 620]
Num selected data points: [257 470 303 433 205]
The chosen ones are users: [0, 2, 3, 5, 6], which are global users: [39, 87, 78, 83, 19]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 52, 17]
base_p: [-4.4116825e-03  9.7453594e-05 -5.4509705e-04 ... -1.3941452e-03
 -2.7992204e-03 -4.6756119e-05]
[T_SCORE] attacker_local_idxs is:  [1, 4, 7, 8, 9]
layer1_inf_time: 3.8408203125
[PAIRWISE] pred_attackers_indx:  [7 8 9]
layer2_inf_t: 29.014892578125
assumed final_attacker_idxs:  [1 4 7 8 9]
final_attacker_idxs is: [1, 4, 7, 8, 9]
g_attacker_idxs: [29 53 45 52 17]
g_normal_idxs: [39 87 78 83 19]
filtered_attacker_idxs: [1, 4, 7, 8, 9]
final_attacker_idxs are: [1, 4, 7, 8, 9]
num_dps: [257, 1002, 470, 303, 739, 433, 205, 628, 253, 620]
epoch_acc: 98.71
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0423, Accuracy: 9871/10000 (98.7100%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 13.2332, Accuracy: 26/8968 (0.2899%)
Done in 58.890193462371826 sec.
Server Epoch:49 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
___Train Local_Simple,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0009, Accuracy: 907/923 (98.2665%)
___Train Local_Simple,  epoch  49, local model 3, internal_epoch   2,  Average loss: 0.0004, Accuracy: 915/923 (99.1333%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0940, Accuracy: 9707/10000 (97.0700%)
poison local model 34 index 0
___PoisonTrain Local_Simple ,  epoch  49, local model 34, internal_epoch   1,  Average loss: 0.0346, Accuracy: 221/413 (53.5109%), train_poison_data_count: 140
class_loss: 4.754551410675049, distance_loss: 0.0
class_loss: 2.2724244594573975, distance_loss: 0.38472262024879456
class_loss: 1.2836860418319702, distance_loss: 0.9378570318222046
class_loss: 1.681206226348877, distance_loss: 1.4319267272949219
class_loss: 1.730069637298584, distance_loss: 1.8252137899398804
class_loss: 1.336069941520691, distance_loss: 2.176090955734253
class_loss: 1.2345092296600342, distance_loss: 2.499743700027466
class_loss: 1.2695940732955933, distance_loss: 2.808332681655884
class_loss: 1.2236872911453247, distance_loss: 3.085613250732422
class_loss: 1.1765793561935425, distance_loss: 3.3367598056793213
class_loss: 1.1269340515136719, distance_loss: 3.562410831451416
class_loss: 0.9522693753242493, distance_loss: 3.7649195194244385
class_loss: 0.9035502672195435, distance_loss: 3.9499459266662598
class_loss: 1.0026848316192627, distance_loss: 4.122175693511963
___PoisonTrain Local_Simple ,  epoch  49, local model 34, internal_epoch   2,  Average loss: 0.0185, Accuracy: 199/413 (48.1840%), train_poison_data_count: 140
Global model norm: 15.469008934859332.
Norm before scaling: 15.412009750699747. Distance: 4.286763003875022
Total norm for 3 adversaries is: 15.412009750699747. distance: 4.286763003875022
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7183, Accuracy: 7368/8968 (82.1588%)
___Train Local_Simple,  epoch  49, local model 32, internal_epoch   1,  Average loss: 0.0012, Accuracy: 955/977 (97.7482%)
___Train Local_Simple,  epoch  49, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 958/977 (98.0553%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2434, Accuracy: 9207/10000 (92.0700%)
___Train Local_Simple,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 431/434 (99.3088%)
___Train Local_Simple,  epoch  49, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/434 (99.7696%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1606, Accuracy: 9432/10000 (94.3200%)
poison local model 73 index 1
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0241, Accuracy: 331/591 (56.0068%), train_poison_data_count: 195
class_loss: 3.3497090339660645, distance_loss: 0.0
class_loss: 2.399641513824463, distance_loss: 0.4244379997253418
class_loss: 1.3625351190567017, distance_loss: 0.6059859395027161
class_loss: 1.023510456085205, distance_loss: 0.9232063293457031
class_loss: 0.9333274364471436, distance_loss: 1.275347113609314
class_loss: 0.9246542453765869, distance_loss: 1.6034748554229736
class_loss: 1.1118695735931396, distance_loss: 1.8892046213150024
class_loss: 1.1058716773986816, distance_loss: 2.137254476547241
class_loss: 0.9030050039291382, distance_loss: 2.354471445083618
class_loss: 1.1513080596923828, distance_loss: 2.545992136001587
class_loss: 1.3957524299621582, distance_loss: 2.7565109729766846
class_loss: 1.4260324239730835, distance_loss: 2.936075448989868
class_loss: 1.2444005012512207, distance_loss: 3.089095115661621
class_loss: 1.179850697517395, distance_loss: 3.226466178894043
class_loss: 1.13954496383667, distance_loss: 3.351179361343384
class_loss: 1.0416992902755737, distance_loss: 3.465508460998535
class_loss: 1.0515954494476318, distance_loss: 3.5712175369262695
class_loss: 1.026278018951416, distance_loss: 3.668487310409546
class_loss: 1.0115689039230347, distance_loss: 3.756120204925537
class_loss: 1.7315490245819092, distance_loss: 3.837008476257324
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0207, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Global model norm: 15.469008934859332.
Norm before scaling: 15.395960468736039. Distance: 3.933650360154652
Total norm for 3 adversaries is: 15.395960468736039. distance: 3.933650360154652
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.9345, Accuracy: 7020/8968 (78.2783%)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0484, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch  49, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 764/772 (98.9637%)
___Train Local_Simple,  epoch  49, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1101, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch  49, local model 88, internal_epoch   1,  Average loss: 0.0007, Accuracy: 523/530 (98.6792%)
___Train Local_Simple,  epoch  49, local model 88, internal_epoch   2,  Average loss: 0.0003, Accuracy: 526/530 (99.2453%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0846, Accuracy: 9726/10000 (97.2600%)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0003, Accuracy: 728/731 (99.5896%)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.2282, Accuracy: 9264/10000 (92.6400%)
poison local model 13 index 2
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0304, Accuracy: 369/734 (50.2725%), train_poison_data_count: 240
class_loss: 4.453648090362549, distance_loss: 0.0
class_loss: 2.1816461086273193, distance_loss: 0.38279256224632263
class_loss: 2.140129327774048, distance_loss: 0.9438986778259277
class_loss: 2.1783413887023926, distance_loss: 1.4027291536331177
class_loss: 1.5073752403259277, distance_loss: 1.8351925611495972
class_loss: 1.4687702655792236, distance_loss: 2.2518630027770996
class_loss: 1.4803742170333862, distance_loss: 2.6256940364837646
class_loss: 1.4856170415878296, distance_loss: 2.9589972496032715
class_loss: 1.394891619682312, distance_loss: 3.2647154331207275
class_loss: 1.2375887632369995, distance_loss: 3.542628049850464
class_loss: 1.3476066589355469, distance_loss: 3.7964038848876953
class_loss: 1.4422811269760132, distance_loss: 4.018387794494629
class_loss: 1.180153489112854, distance_loss: 4.221251487731934
class_loss: 1.2056742906570435, distance_loss: 4.411032199859619
class_loss: 1.3153125047683716, distance_loss: 4.582531452178955
class_loss: 1.1946980953216553, distance_loss: 4.73538875579834
class_loss: 1.1525930166244507, distance_loss: 4.87703800201416
class_loss: 0.9777592420578003, distance_loss: 5.008815288543701
class_loss: 1.0338236093521118, distance_loss: 5.1308393478393555
class_loss: 0.9704457521438599, distance_loss: 5.24261999130249
class_loss: 0.7884094715118408, distance_loss: 5.344486236572266
class_loss: 0.9868571758270264, distance_loss: 5.440539836883545
class_loss: 0.8942746520042419, distance_loss: 5.5271687507629395
class_loss: 0.9390847086906433, distance_loss: 5.6059160232543945
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0172, Accuracy: 359/734 (48.9101%), train_poison_data_count: 240
Global model norm: 15.469008934859332.
Norm before scaling: 15.813846093581548. Distance: 5.685184887888226
Total norm for 3 adversaries is: 15.813846093581548. distance: 5.685184887888226
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.6801, Accuracy: 7155/8968 (79.7837%)
time spent on training: 51.36840105056763
Starting performing KrMLRFL...
Num data points: [923, 413, 977, 434, 591, 376, 772, 530, 731, 734]
Num selected data points: [434 376 772 530 731]
The chosen ones are users: [3, 5, 6, 7, 8], which are global users: [5, 14, 40, 88, 72]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 73, 13]
base_p: [ 6.1057508e-05  4.5046955e-04  1.5982692e-03 ... -6.1392784e-04
 -4.5048781e-03  8.9978054e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 9]
layer1_inf_time: 3.86279296875
[PAIRWISE] pred_attackers_indx:  [1 4 9]
layer2_inf_t: 88.63134765625
assumed final_attacker_idxs:  [0 1 2 4 9]
final_attacker_idxs is: [0, 1, 2, 4, 9]
g_attacker_idxs: [ 3 34 32 73 13]
g_normal_idxs: [ 5 14 40 88 72]
filtered_attacker_idxs: [0, 1, 2, 4, 9]
final_attacker_idxs are: [0, 1, 2, 4, 9]
num_dps: [923, 413, 977, 434, 591, 376, 772, 530, 731, 734]
epoch_acc: 98.38
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0501, Accuracy: 9838/10000 (98.3800%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 12.8115, Accuracy: 63/8968 (0.7025%)
Done in 58.03346848487854 sec.
Server Epoch:50 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1134/1160 (97.7586%)
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   2,  Average loss: 0.0025, Accuracy: 1115/1160 (96.1207%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.4881, Accuracy: 8832/10000 (88.3200%)
___Train Local_Simple,  epoch  50, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch  50, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1298, Accuracy: 9590/10000 (95.9000%)
___Train Local_Simple,  epoch  50, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch  50, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0650, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch  50, local model 98, internal_epoch   1,  Average loss: 0.0010, Accuracy: 802/818 (98.0440%)
___Train Local_Simple,  epoch  50, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 814/818 (99.5110%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.3057, Accuracy: 9096/10000 (90.9600%)
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0243, Accuracy: 339/568 (59.6831%), train_poison_data_count: 180
class_loss: 3.070268154144287, distance_loss: 0.0
class_loss: 2.920440196990967, distance_loss: 0.2929626703262329
class_loss: 1.2556896209716797, distance_loss: 0.8185123205184937
class_loss: 1.7666627168655396, distance_loss: 1.221056342124939
class_loss: 1.2553126811981201, distance_loss: 1.559147596359253
class_loss: 0.9763821959495544, distance_loss: 1.8978006839752197
class_loss: 0.9058037400245667, distance_loss: 2.2304842472076416
class_loss: 0.8420268893241882, distance_loss: 2.54835844039917
class_loss: 0.8151649832725525, distance_loss: 2.845031499862671
class_loss: 0.8036615252494812, distance_loss: 3.116478204727173
class_loss: 0.7388853430747986, distance_loss: 3.365151882171631
class_loss: 0.7698016166687012, distance_loss: 3.589529514312744
class_loss: 0.8258376121520996, distance_loss: 3.7858917713165283
class_loss: 0.6738861799240112, distance_loss: 3.9563992023468018
class_loss: 0.8106446862220764, distance_loss: 4.1103315353393555
class_loss: 0.8797029852867126, distance_loss: 4.248881816864014
class_loss: 0.7571279406547546, distance_loss: 4.372743129730225
class_loss: 0.6276426315307617, distance_loss: 4.4848952293396
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0121, Accuracy: 367/568 (64.6127%), train_poison_data_count: 180
Global model norm: 15.415481989251504.
Norm before scaling: 15.561394954805726. Distance: 4.588871032232642
Total norm for 4 adversaries is: 15.561394954805726. distance: 4.588871032232642
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.7078, Accuracy: 6421/8968 (71.5990%)
___Train Local_Simple,  epoch  50, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 430/433 (99.3072%)
___Train Local_Simple,  epoch  50, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0531, Accuracy: 9835/10000 (98.3500%)
poison local model 52 index 1
class_loss: 3.7844996452331543, distance_loss: 0.0
class_loss: 1.973983883857727, distance_loss: 0.36091142892837524
class_loss: 2.634807586669922, distance_loss: 0.9153499603271484
class_loss: 1.9984428882598877, distance_loss: 1.2376166582107544
___PoisonTrain Local_Simple ,  epoch  50, local model 52, internal_epoch   1,  Average loss: 0.0411, Accuracy: 131/253 (51.7787%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  50, local model 52, internal_epoch   2,  Average loss: 0.0185, Accuracy: 154/253 (60.8696%), train_poison_data_count: 80
Global model norm: 15.415481989251504.
Norm before scaling: 15.242844200358615. Distance: 2.9348109497323582
Total norm for 4 adversaries is: 15.242844200358615. distance: 2.9348109497323582
class_loss: 1.2860852479934692, distance_loss: 1.5629477500915527
class_loss: 1.1683212518692017, distance_loss: 1.9312338829040527
class_loss: 1.185119867324829, distance_loss: 2.286447763442993
class_loss: 1.049752116203308, distance_loss: 2.6212005615234375
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 1.7273, Accuracy: 1629/8968 (18.1646%)
___Train Local_Simple,  epoch  50, local model 90, internal_epoch   1,  Average loss: 0.0008, Accuracy: 673/683 (98.5359%)
___Train Local_Simple,  epoch  50, local model 90, internal_epoch   2,  Average loss: 0.0003, Accuracy: 680/683 (99.5608%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.5571, Accuracy: 8595/10000 (85.9500%)
poison local model 71 index 2
___PoisonTrain Local_Simple ,  epoch  50, local model 71, internal_epoch   1,  Average loss: 0.0194, Accuracy: 785/1384 (56.7197%), train_poison_data_count: 440
class_loss: 3.8059709072113037, distance_loss: 0.0
class_loss: 1.7048600912094116, distance_loss: 0.36220782995224
class_loss: 2.168370008468628, distance_loss: 0.8820505738258362
class_loss: 1.7978768348693848, distance_loss: 1.2582014799118042
class_loss: 1.4472770690917969, distance_loss: 1.6068719625473022
class_loss: 1.1938996315002441, distance_loss: 1.9655572175979614
class_loss: 1.4094094038009644, distance_loss: 2.3020122051239014
class_loss: 1.2490456104278564, distance_loss: 2.6148812770843506
class_loss: 1.1447021961212158, distance_loss: 2.9053685665130615
class_loss: 1.0749627351760864, distance_loss: 3.1735329627990723
class_loss: 0.8093802332878113, distance_loss: 3.423008680343628
class_loss: 0.9836822152137756, distance_loss: 3.655618906021118
class_loss: 1.115813136100769, distance_loss: 3.872119665145874
class_loss: 0.6382931470870972, distance_loss: 4.068223476409912
class_loss: 0.7755599021911621, distance_loss: 4.246481895446777
class_loss: 0.9195669889450073, distance_loss: 4.409738063812256
class_loss: 0.8052802085876465, distance_loss: 4.553125858306885
class_loss: 0.6453205943107605, distance_loss: 4.689635276794434
class_loss: 0.7701759934425354, distance_loss: 4.81614351272583
class_loss: 0.8183631896972656, distance_loss: 4.9300079345703125
class_loss: 0.6177526116371155, distance_loss: 5.031507968902588
class_loss: 0.9013029336929321, distance_loss: 5.123960494995117
class_loss: 0.763360321521759, distance_loss: 5.211696147918701
class_loss: 0.6725058555603027, distance_loss: 5.2913899421691895
class_loss: 0.7720545530319214, distance_loss: 5.3595194816589355
class_loss: 0.6053563356399536, distance_loss: 5.423210620880127
class_loss: 0.6489022374153137, distance_loss: 5.483030796051025
class_loss: 0.588005781173706, distance_loss: 5.540231227874756
class_loss: 0.523158073425293, distance_loss: 5.597404479980469
class_loss: 0.40573132038116455, distance_loss: 5.655569553375244
class_loss: 0.43947988748550415, distance_loss: 5.71315860748291
class_loss: 0.4696348309516907, distance_loss: 5.7683820724487305
class_loss: 0.32088905572891235, distance_loss: 5.816540718078613
class_loss: 0.22098717093467712, distance_loss: 5.86496639251709
class_loss: 0.2715848684310913, distance_loss: 5.916723728179932
class_loss: 0.3078700304031372, distance_loss: 5.970471382141113
class_loss: 0.17572741210460663, distance_loss: 6.028336048126221
class_loss: 0.22309613227844238, distance_loss: 6.086466312408447
class_loss: 0.1770847886800766, distance_loss: 6.140854835510254
class_loss: 0.11328691989183426, distance_loss: 6.194624900817871
___PoisonTrain Local_Simple ,  epoch  50, local model 71, internal_epoch   2,  Average loss: 0.0059, Accuracy: 1172/1384 (84.6821%), train_poison_data_count: 440
Global model norm: 15.415481989251504.
Norm before scaling: 16.25081691155767. Distance: 6.41151918640098
Total norm for 4 adversaries is: 16.25081691155767. distance: 6.41151918640098
class_loss: 0.1101483628153801, distance_loss: 6.245012283325195
class_loss: 0.2954951524734497, distance_loss: 6.292374134063721
class_loss: 0.07502114772796631, distance_loss: 6.3341522216796875
class_loss: 0.01181635819375515, distance_loss: 6.373775959014893
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0811, Accuracy: 8721/8968 (97.2458%)
poison local model 11 index 3
class_loss: 4.520391941070557, distance_loss: 0.0
class_loss: 2.8083910942077637, distance_loss: 0.3745335340499878
class_loss: 1.270882487297058, distance_loss: 0.9423909783363342
class_loss: 1.4404911994934082, distance_loss: 1.3841520547866821
class_loss: 1.3199489116668701, distance_loss: 1.7511788606643677
class_loss: 1.0893797874450684, distance_loss: 2.1059682369232178
class_loss: 1.3338685035705566, distance_loss: 2.436852216720581
class_loss: 1.4341919422149658, distance_loss: 2.7377641201019287
class_loss: 1.2559614181518555, distance_loss: 3.0058786869049072
class_loss: 1.1023284196853638, distance_loss: 3.2455997467041016
class_loss: 0.9423890113830566, distance_loss: 3.4625918865203857
___PoisonTrain Local_Simple ,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0287, Accuracy: 379/645 (58.7597%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  50, local model 11, internal_epoch   2,  Average loss: 0.0123, Accuracy: 449/645 (69.6124%), train_poison_data_count: 205
Global model norm: 15.415481989251504.
Norm before scaling: 15.86558481797034. Distance: 5.156216707989114
Total norm for 4 adversaries is: 15.86558481797034. distance: 5.156216707989114
class_loss: 1.0137171745300293, distance_loss: 3.6885321140289307
class_loss: 1.1665945053100586, distance_loss: 3.8920915126800537
class_loss: 1.07753586769104, distance_loss: 4.0639777183532715
class_loss: 0.8369936347007751, distance_loss: 4.209540367126465
class_loss: 0.6914966106414795, distance_loss: 4.339612007141113
class_loss: 0.6485174894332886, distance_loss: 4.462902069091797
class_loss: 0.6496277451515198, distance_loss: 4.584211349487305
class_loss: 0.5629297494888306, distance_loss: 4.703057765960693
class_loss: 0.7534508109092712, distance_loss: 4.819077968597412
class_loss: 0.5310274958610535, distance_loss: 4.9347357749938965
class_loss: 0.00773788895457983, distance_loss: 5.047430515289307
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.1000, Accuracy: 8603/8968 (95.9300%)
time spent on training: 60.697453022003174
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 52, 71, 11]
base_p: [-0.00474932  0.00033499 -0.00136529 ...  0.0001499  -0.01218791
 -0.00678906]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 8, 9]
layer1_inf_time: 4.307861328125
[PAIRWISE] pred_attackers_indx:  [4 6 8 9]
layer2_inf_t: 44.690673828125
assumed final_attacker_idxs:  [3 4 6 8 9]
final_attacker_idxs is: [3 4 6 8 9]
g_attacker_idxs: [98 51 52 71 11]
g_normal_idxs: [12 23 87 83 90]
filtered_attacker_idxs: [3, 4, 6, 8, 9]
final_attacker_idxs are: [3, 4, 6, 8, 9]
num_dps: [1160, 293, 470, 818, 568, 433, 253, 683, 1384, 645]
Starting performing KrMLRFL...
Num data points: [1160, 293, 470, 818, 568, 433, 253, 683, 1384, 645]
Num selected data points: [1160  293  470  433  683]
The chosen ones are users: [0, 1, 2, 5, 7], which are global users: [12, 23, 87, 83, 90]
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0625, Accuracy: 9795/10000 (97.9500%)
epoch_acc: 97.95
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 11.8732, Accuracy: 20/8968 (0.2230%)
Done in 66.95792412757874 sec.
Server Epoch:51 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0245, Accuracy: 321/568 (56.5141%), train_poison_data_count: 180
class_loss: 3.6010923385620117, distance_loss: 0.0
class_loss: 2.1956868171691895, distance_loss: 0.3562462627887726
class_loss: 1.5324275493621826, distance_loss: 0.8324865698814392
class_loss: 1.199808120727539, distance_loss: 1.244102120399475
class_loss: 1.3459876775741577, distance_loss: 1.594041347503662
class_loss: 1.3204402923583984, distance_loss: 1.9099637269973755
class_loss: 1.0109854936599731, distance_loss: 2.20249605178833
class_loss: 0.8292576670646667, distance_loss: 2.481346845626831
class_loss: 0.8839330673217773, distance_loss: 2.7447052001953125
class_loss: 0.9811195731163025, distance_loss: 2.987980842590332
class_loss: 0.9307273030281067, distance_loss: 3.204608201980591
class_loss: 0.7708244919776917, distance_loss: 3.399998188018799
class_loss: 0.9356858134269714, distance_loss: 3.579063653945923
class_loss: 0.8164504766464233, distance_loss: 3.7415010929107666
class_loss: 0.8393340110778809, distance_loss: 3.886547088623047
class_loss: 0.7878161072731018, distance_loss: 4.015536308288574
class_loss: 0.7598307132720947, distance_loss: 4.129073619842529
class_loss: 0.7327083945274353, distance_loss: 4.2297563552856445
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0133, Accuracy: 353/568 (62.1479%), train_poison_data_count: 180
Global model norm: 15.52386360370779.
Norm before scaling: 15.631612370381104. Distance: 4.321928691185723
Total norm for 3 adversaries is: 15.631612370381104. distance: 4.321928691185723
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 1.0700, Accuracy: 4859/8968 (54.1815%)
___Train Local_Simple,  epoch  51, local model 28, internal_epoch   1,  Average loss: 0.0007, Accuracy: 493/501 (98.4032%)
___Train Local_Simple,  epoch  51, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 499/501 (99.6008%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0711, Accuracy: 9789/10000 (97.8900%)
poison local model 20 index 1
___PoisonTrain Local_Simple ,  epoch  51, local model 20, internal_epoch   1,  Average loss: 0.0341, Accuracy: 228/429 (53.1469%), train_poison_data_count: 140
class_loss: 4.250777244567871, distance_loss: 0.0
class_loss: 2.7076385021209717, distance_loss: 0.3494678735733032
class_loss: 1.9645447731018066, distance_loss: 0.8907389640808105
class_loss: 1.1385040283203125, distance_loss: 1.4322282075881958
class_loss: 1.699256420135498, distance_loss: 1.9023306369781494
class_loss: 1.5555167198181152, distance_loss: 2.311408758163452
class_loss: 1.3294086456298828, distance_loss: 2.6634883880615234
class_loss: 1.4658212661743164, distance_loss: 2.9784858226776123
class_loss: 1.4344031810760498, distance_loss: 3.2602124214172363
class_loss: 1.2912375926971436, distance_loss: 3.5130276679992676
class_loss: 1.2512587308883667, distance_loss: 3.7417712211608887
class_loss: 1.0589431524276733, distance_loss: 3.949444055557251
class_loss: 1.1095274686813354, distance_loss: 4.137644290924072
class_loss: 1.218568205833435, distance_loss: 4.302316665649414
___PoisonTrain Local_Simple ,  epoch  51, local model 20, internal_epoch   2,  Average loss: 0.0206, Accuracy: 196/429 (45.6876%), train_poison_data_count: 140
Global model norm: 15.52386360370779.
Norm before scaling: 15.522833955932064. Distance: 4.442099967467152
Total norm for 3 adversaries is: 15.522833955932064. distance: 4.442099967467152
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.8663, Accuracy: 6221/8968 (69.3689%)
___Train Local_Simple,  epoch  51, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch  51, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 2.1113, Accuracy: 7426/10000 (74.2600%)
___Train Local_Simple,  epoch  51, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 430/433 (99.3072%)
___Train Local_Simple,  epoch  51, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0644, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch  51, local model 18, internal_epoch   1,  Average loss: 0.0019, Accuracy: 445/459 (96.9499%)
___Train Local_Simple,  epoch  51, local model 18, internal_epoch   2,  Average loss: 0.0021, Accuracy: 440/459 (95.8606%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3648, Accuracy: 8845/10000 (88.4500%)
___Train Local_Simple,  epoch  51, local model 55, internal_epoch   1,  Average loss: 0.0014, Accuracy: 345/354 (97.4576%)
___Train Local_Simple,  epoch  51, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.5430, Accuracy: 8251/10000 (82.5100%)
poison local model 42 index 2
___PoisonTrain Local_Simple ,  epoch  51, local model 42, internal_epoch   1,  Average loss: 0.0295, Accuracy: 166/236 (70.3390%), train_poison_data_count: 80
class_loss: 3.390098810195923, distance_loss: 0.0
class_loss: 1.776254415512085, distance_loss: 0.2602200210094452
class_loss: 0.8693018555641174, distance_loss: 0.6595464944839478
class_loss: 0.9320163726806641, distance_loss: 1.0769016742706299
class_loss: 1.399094820022583, distance_loss: 1.4318735599517822
class_loss: 1.3653316497802734, distance_loss: 1.7125824689865112
class_loss: 0.9288032650947571, distance_loss: 1.9560991525650024
class_loss: 1.0171716213226318, distance_loss: 2.183647394180298
___PoisonTrain Local_Simple ,  epoch  51, local model 42, internal_epoch   2,  Average loss: 0.0200, Accuracy: 135/236 (57.2034%), train_poison_data_count: 80
Global model norm: 15.52386360370779.
Norm before scaling: 15.297296442260077. Distance: 2.3824455604057606
Total norm for 3 adversaries is: 15.297296442260077. distance: 2.3824455604057606
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 1.3606, Accuracy: 4468/8968 (49.8216%)
___Train Local_Simple,  epoch  51, local model 29, internal_epoch   1,  Average loss: 0.0007, Accuracy: 991/1002 (98.9022%)
___Train Local_Simple,  epoch  51, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 994/1002 (99.2016%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.3285, Accuracy: 9094/10000 (90.9400%)
___Train Local_Simple,  epoch  51, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 695/710 (97.8873%)
___Train Local_Simple,  epoch  51, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 707/710 (99.5775%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.2608, Accuracy: 9165/10000 (91.6500%)
time spent on training: 53.164167404174805
Starting performing KrMLRFL...
Num data points: [568, 501, 429, 602, 433, 459, 354, 236, 1002, 710]
Num selected data points: [ 501  433  459  354 1002]
The chosen ones are users: [1, 4, 5, 6, 8], which are global users: [28, 83, 18, 55, 29]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 20, 42]
base_p: [-0.00162745  0.00064655 -0.00061295 ... -0.0008243  -0.00942692
  0.00470365]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 7, 9]
layer1_inf_time: 2.848876953125
[PAIRWISE] pred_attackers_indx:  [0 2 7]
layer2_inf_t: 37.25341796875
assumed final_attacker_idxs:  [0 2 3 7 9]
final_attacker_idxs is: [0 2 3 7 9]
g_attacker_idxs: [51 20 95 42 46]
g_normal_idxs: [28 83 18 55 29]
filtered_attacker_idxs: [0, 2, 3, 7, 9]
final_attacker_idxs are: [0, 2, 3, 7, 9]
num_dps: [568, 501, 429, 602, 433, 459, 354, 236, 1002, 710]
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0653, Accuracy: 9800/10000 (98.0000%)
epoch_acc: 98.0
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 12.8102, Accuracy: 13/8968 (0.1450%)
Done in 59.991859912872314 sec.
Server Epoch:52 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  52, local model 87, internal_epoch   1,  Average loss: 0.0005, Accuracy: 467/470 (99.3617%)
___Train Local_Simple,  epoch  52, local model 87, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1334, Accuracy: 9606/10000 (96.0600%)
poison local model 73 index 0
class_loss: 4.096092700958252, distance_loss: 0.0
class_loss: 1.1397331953048706, distance_loss: 0.43389269709587097
class_loss: 3.0244882106781006, distance_loss: 0.8531345725059509
class_loss: 1.62064528465271, distance_loss: 1.1431331634521484
class_loss: 1.2367157936096191, distance_loss: 1.515066385269165
class_loss: 1.2682695388793945, distance_loss: 1.8954365253448486
class_loss: 1.281214952468872, distance_loss: 2.2490718364715576
class_loss: 1.2566642761230469, distance_loss: 2.5672850608825684
class_loss: 1.463667392730713, distance_loss: 2.8559536933898926
class_loss: 2.11419415473938, distance_loss: 3.1235029697418213
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0313, Accuracy: 326/591 (55.1607%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0204, Accuracy: 288/591 (48.7310%), train_poison_data_count: 195
Global model norm: 15.491426126966672.
Norm before scaling: 15.613344774076428. Distance: 4.891155372599224
Total norm for 3 adversaries is: 15.613344774076428. distance: 4.891155372599224
class_loss: 1.1849573850631714, distance_loss: 3.392565965652466
class_loss: 1.1963032484054565, distance_loss: 3.640075206756592
class_loss: 1.320239782333374, distance_loss: 3.8587756156921387
class_loss: 1.2400318384170532, distance_loss: 4.050339698791504
class_loss: 1.1797575950622559, distance_loss: 4.2151994705200195
class_loss: 1.1025439500808716, distance_loss: 4.358146667480469
class_loss: 1.4107271432876587, distance_loss: 4.484850883483887
class_loss: 1.040917992591858, distance_loss: 4.596023082733154
class_loss: 1.0352096557617188, distance_loss: 4.6966047286987305
class_loss: 1.3193341493606567, distance_loss: 4.788488388061523
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.8174, Accuracy: 8408/8968 (93.7556%)
___Train Local_Simple,  epoch  52, local model 89, internal_epoch   1,  Average loss: 0.0003, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch  52, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1261, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch  52, local model 48, internal_epoch   1,  Average loss: 0.0008, Accuracy: 439/448 (97.9911%)
___Train Local_Simple,  epoch  52, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1034, Accuracy: 9658/10000 (96.5800%)
poison local model 81 index 1
class_loss: 3.9530112743377686, distance_loss: 0.0
class_loss: 3.2285315990448, distance_loss: 0.2928239405155182
class_loss: 1.7401734590530396, distance_loss: 0.8057019114494324
class_loss: 1.4246675968170166, distance_loss: 1.3379091024398804
class_loss: 1.4706013202667236, distance_loss: 1.8176652193069458
class_loss: 1.6307560205459595, distance_loss: 2.234560966491699
class_loss: 1.5963505506515503, distance_loss: 2.5923011302948
class_loss: 1.5044395923614502, distance_loss: 2.9049813747406006
class_loss: 1.504042387008667, distance_loss: 3.1804187297821045
class_loss: 1.4121707677841187, distance_loss: 3.4238879680633545
class_loss: 1.3107895851135254, distance_loss: 3.641779661178589
class_loss: 1.09969961643219, distance_loss: 3.8363358974456787
class_loss: 1.113743782043457, distance_loss: 4.018038749694824
class_loss: 1.015444278717041, distance_loss: 4.184382438659668
class_loss: 1.0966752767562866, distance_loss: 4.334350109100342
class_loss: 0.877072274684906, distance_loss: 4.467475891113281
class_loss: 0.8993057012557983, distance_loss: 4.589846611022949
class_loss: 0.8993644714355469, distance_loss: 4.701091766357422
class_loss: 0.8426399230957031, distance_loss: 4.803894519805908
class_loss: 1.3069905042648315, distance_loss: 4.898372173309326
___PoisonTrain Local_Simple ,  epoch  52, local model 81, internal_epoch   1,  Average loss: 0.0244, Accuracy: 607/1227 (49.4703%), train_poison_data_count: 391
___PoisonTrain Local_Simple ,  epoch  52, local model 81, internal_epoch   2,  Average loss: 0.0151, Accuracy: 704/1227 (57.3757%), train_poison_data_count: 391
Global model norm: 15.491426126966672.
Norm before scaling: 16.16503950497077. Distance: 6.099464593122408
Total norm for 3 adversaries is: 16.16503950497077. distance: 6.099464593122408
class_loss: 1.1259706020355225, distance_loss: 4.999763488769531
class_loss: 1.372715950012207, distance_loss: 5.091120719909668
class_loss: 1.3170939683914185, distance_loss: 5.163516521453857
class_loss: 0.9194979667663574, distance_loss: 5.23029088973999
class_loss: 0.9563792943954468, distance_loss: 5.299121856689453
class_loss: 0.9296760559082031, distance_loss: 5.369422912597656
class_loss: 0.9095624089241028, distance_loss: 5.441753387451172
class_loss: 0.9280973076820374, distance_loss: 5.513240337371826
class_loss: 0.8969099521636963, distance_loss: 5.580837249755859
class_loss: 0.7843416333198547, distance_loss: 5.642789840698242
class_loss: 0.8323385119438171, distance_loss: 5.7008562088012695
class_loss: 0.9185978174209595, distance_loss: 5.754522323608398
class_loss: 0.8802254796028137, distance_loss: 5.798539638519287
class_loss: 0.8217583894729614, distance_loss: 5.835604190826416
class_loss: 0.7495602369308472, distance_loss: 5.8712477684021
class_loss: 0.742093563079834, distance_loss: 5.909780502319336
class_loss: 0.8334549069404602, distance_loss: 5.947178840637207
class_loss: 0.7628547549247742, distance_loss: 5.982137680053711
class_loss: 0.5323700904846191, distance_loss: 6.016607284545898
class_loss: 1.3566898107528687, distance_loss: 6.052010536193848
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.3447, Accuracy: 7788/8968 (86.8421%)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 881/892 (98.7668%)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 881/892 (98.7668%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3034, Accuracy: 9089/10000 (90.8900%)
___Train Local_Simple,  epoch  52, local model 92, internal_epoch   1,  Average loss: 0.0011, Accuracy: 914/937 (97.5454%)
___Train Local_Simple,  epoch  52, local model 92, internal_epoch   2,  Average loss: 0.0005, Accuracy: 928/937 (99.0395%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.2126, Accuracy: 9289/10000 (92.8900%)
___Train Local_Simple,  epoch  52, local model 62, internal_epoch   1,  Average loss: 0.0005, Accuracy: 418/423 (98.8180%)
___Train Local_Simple,  epoch  52, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0926, Accuracy: 9699/10000 (96.9900%)
poison local model 26 index 2
class_loss: 2.5909926891326904, distance_loss: 0.0
class_loss: 2.596500873565674, distance_loss: 0.2214507758617401
class_loss: 0.876585066318512, distance_loss: 0.620191216468811
class_loss: 0.7912935614585876, distance_loss: 1.025193214416504
class_loss: 1.0934250354766846, distance_loss: 1.3603507280349731
class_loss: 1.2476288080215454, distance_loss: 1.6642810106277466
class_loss: 0.9247220754623413, distance_loss: 1.9410473108291626
class_loss: 1.0422323942184448, distance_loss: 2.191932439804077
class_loss: 1.0521612167358398, distance_loss: 2.408768653869629
class_loss: 1.0381349325180054, distance_loss: 2.5976977348327637
class_loss: 1.0529050827026367, distance_loss: 2.75927472114563
class_loss: 0.8533689975738525, distance_loss: 2.8994927406311035
class_loss: 0.7187091708183289, distance_loss: 3.024254083633423
class_loss: 0.7193986177444458, distance_loss: 3.135695457458496
class_loss: 0.8710194230079651, distance_loss: 3.2343649864196777
class_loss: 0.7817803025245667, distance_loss: 3.3158774375915527
class_loss: 0.7772001028060913, distance_loss: 3.390434741973877
class_loss: 0.7570794224739075, distance_loss: 3.4622902870178223
___PoisonTrain Local_Simple ,  epoch  52, local model 26, internal_epoch   1,  Average loss: 0.0220, Accuracy: 384/554 (69.3141%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  52, local model 26, internal_epoch   2,  Average loss: 0.0137, Accuracy: 363/554 (65.5235%), train_poison_data_count: 180
Global model norm: 15.491426126966672.
Norm before scaling: 15.433935827327725. Distance: 3.5339442414751634
Total norm for 3 adversaries is: 15.433935827327725. distance: 3.5339442414751634
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 1.0880, Accuracy: 4840/8968 (53.9697%)
___Train Local_Simple,  epoch  52, local model 29, internal_epoch   1,  Average loss: 0.0003, Accuracy: 997/1002 (99.5010%)
___Train Local_Simple,  epoch  52, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 993/1002 (99.1018%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1061, Accuracy: 9664/10000 (96.6400%)
time spent on training: 53.80411124229431
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73, 81, 26]
base_p: [-0.0010277   0.00032736  0.00152602 ... -0.00048196 -0.00301066
 -0.00058079]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 8, 9]
layer1_inf_time: 3.314453125
[PAIRWISE] pred_attackers_indx:  [1 4 8]
layer2_inf_t: 45.13427734375
assumed final_attacker_idxs:  [1 4 6 8 9]
final_attacker_idxs is: [1 4 6 8 9]
g_attacker_idxs: [73 81 92 26 29]
g_normal_idxs: [87 89 48 10 62]
filtered_attacker_idxs: [1, 4, 6, 8, 9]
final_attacker_idxs are: [1, 4, 6, 8, 9]
num_dps: [470, 591, 492, 448, 1227, 892, 937, 423, 554, 1002]
Starting performing KrMLRFL...
Num data points: [470, 591, 492, 448, 1227, 892, 937, 423, 554, 1002]
Num selected data points: [470 492 448 892 423]
The chosen ones are users: [0, 2, 3, 5, 7], which are global users: [87, 89, 48, 10, 62]
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0847, Accuracy: 9733/10000 (97.3300%)
epoch_acc: 97.33000000000001
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 12.1325, Accuracy: 58/8968 (0.6467%)
Done in 60.29610538482666 sec.
Server Epoch:53 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
___Train Local_Simple,  epoch  53, local model 38, internal_epoch   1,  Average loss: 0.0008, Accuracy: 881/895 (98.4358%)
___Train Local_Simple,  epoch  53, local model 38, internal_epoch   2,  Average loss: 0.0006, Accuracy: 886/895 (98.9944%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.6512, Accuracy: 8644/10000 (86.4400%)
___Train Local_Simple,  epoch  53, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 294/303 (97.0297%)
___Train Local_Simple,  epoch  53, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1468, Accuracy: 9574/10000 (95.7400%)
poison local model 26 index 0
class_loss: 2.634972333908081, distance_loss: 0.0
class_loss: 1.801653265953064, distance_loss: 0.20854951441287994
class_loss: 1.3847451210021973, distance_loss: 0.5466605424880981
class_loss: 0.9356025457382202, distance_loss: 0.9329668283462524
class_loss: 0.9675743579864502, distance_loss: 1.2734097242355347
class_loss: 0.9337174892425537, distance_loss: 1.5356242656707764
class_loss: 0.848680853843689, distance_loss: 1.7770171165466309
class_loss: 0.8051885366439819, distance_loss: 2.0108630657196045
class_loss: 0.8901009559631348, distance_loss: 2.2230823040008545
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   1,  Average loss: 0.0202, Accuracy: 386/554 (69.6751%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   2,  Average loss: 0.0136, Accuracy: 357/554 (64.4404%), train_poison_data_count: 180
Global model norm: 15.486952181310915.
Norm before scaling: 15.404005030240665. Distance: 3.4374243988046573
Total norm for 2 adversaries is: 15.404005030240665. distance: 3.4374243988046573
class_loss: 0.9854024648666382, distance_loss: 2.4190454483032227
class_loss: 0.781764805316925, distance_loss: 2.592956066131592
class_loss: 1.034604787826538, distance_loss: 2.7514779567718506
class_loss: 0.7394266128540039, distance_loss: 2.89068865776062
class_loss: 0.6495628952980042, distance_loss: 3.014512300491333
class_loss: 0.7517970204353333, distance_loss: 3.1209330558776855
class_loss: 0.8884575366973877, distance_loss: 3.216956377029419
class_loss: 0.9576246738433838, distance_loss: 3.3005595207214355
class_loss: 0.7462720274925232, distance_loss: 3.370759963989258
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.8742, Accuracy: 6013/8968 (67.0495%)
___Train Local_Simple,  epoch  53, local model 18, internal_epoch   1,  Average loss: 0.0011, Accuracy: 452/459 (98.4749%)
___Train Local_Simple,  epoch  53, local model 18, internal_epoch   2,  Average loss: 0.0006, Accuracy: 455/459 (99.1285%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1125, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch  53, local model 72, internal_epoch   1,  Average loss: 0.0009, Accuracy: 720/731 (98.4952%)
___Train Local_Simple,  epoch  53, local model 72, internal_epoch   2,  Average loss: 0.0003, Accuracy: 727/731 (99.4528%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.3833, Accuracy: 9006/10000 (90.0600%)
___Train Local_Simple,  epoch  53, local model 75, internal_epoch   1,  Average loss: 0.0007, Accuracy: 674/686 (98.2507%)
___Train Local_Simple,  epoch  53, local model 75, internal_epoch   2,  Average loss: 0.0005, Accuracy: 678/686 (98.8338%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1245, Accuracy: 9600/10000 (96.0000%)
poison local model 93 index 1
___PoisonTrain Local_Simple ,  epoch  53, local model 93, internal_epoch   1,  Average loss: 0.0245, Accuracy: 349/623 (56.0193%), train_poison_data_count: 200
class_loss: 3.4250574111938477, distance_loss: 0.0
class_loss: 1.8355004787445068, distance_loss: 0.34628716111183167
class_loss: 2.0157930850982666, distance_loss: 0.7987493276596069
class_loss: 1.4569140672683716, distance_loss: 1.1069495677947998
class_loss: 0.9859837889671326, distance_loss: 1.3574845790863037
class_loss: 1.0188467502593994, distance_loss: 1.6249269247055054
class_loss: 1.1484594345092773, distance_loss: 1.879054069519043
class_loss: 1.1985336542129517, distance_loss: 2.1201672554016113
class_loss: 1.084626317024231, distance_loss: 2.345099925994873
class_loss: 1.1116344928741455, distance_loss: 2.5469441413879395
class_loss: 0.8649194240570068, distance_loss: 2.7381269931793213
class_loss: 1.0702035427093506, distance_loss: 2.9164249897003174
class_loss: 0.8921976685523987, distance_loss: 3.0789921283721924
class_loss: 0.9993428587913513, distance_loss: 3.2241320610046387
class_loss: 0.9102582931518555, distance_loss: 3.354499101638794
class_loss: 0.8206958770751953, distance_loss: 3.4697494506835938
___PoisonTrain Local_Simple ,  epoch  53, local model 93, internal_epoch   2,  Average loss: 0.0142, Accuracy: 367/623 (58.9085%), train_poison_data_count: 200
Global model norm: 15.486952181310915.
Norm before scaling: 15.565609785929123. Distance: 3.9709975719343613
Total norm for 2 adversaries is: 15.565609785929123. distance: 3.9709975719343613
class_loss: 0.9333043694496155, distance_loss: 3.577300548553467
class_loss: 0.7805338501930237, distance_loss: 3.6820285320281982
class_loss: 0.7686398029327393, distance_loss: 3.7853100299835205
class_loss: 0.7931756377220154, distance_loss: 3.8800301551818848
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.9832, Accuracy: 4753/8968 (52.9996%)
___Train Local_Simple,  epoch  53, local model 39, internal_epoch   1,  Average loss: 0.0009, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  53, local model 39, internal_epoch   2,  Average loss: 0.0007, Accuracy: 254/257 (98.8327%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1218, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  53, local model 44, internal_epoch   1,  Average loss: 0.0021, Accuracy: 506/517 (97.8723%)
___Train Local_Simple,  epoch  53, local model 44, internal_epoch   2,  Average loss: 0.0038, Accuracy: 491/517 (94.9710%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1340, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch  53, local model 90, internal_epoch   1,  Average loss: 0.0008, Accuracy: 673/683 (98.5359%)
___Train Local_Simple,  epoch  53, local model 90, internal_epoch   2,  Average loss: 0.0004, Accuracy: 677/683 (99.1215%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4439, Accuracy: 8691/10000 (86.9100%)
time spent on training: 46.38192343711853
Starting performing KrMLRFL...
Num data points: [895, 303, 554, 459, 731, 686, 623, 257, 517, 683]
Num selected data points: [895 303 459 731 686 257 517 683]
The chosen ones are users: [0, 1, 3, 4, 5, 7, 8, 9], which are global users: [38, 78, 18, 72, 75, 39, 44, 90]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 93]
base_p: [-0.00117862  0.00073084 -0.00126484 ... -0.00320078 -0.00454168
 -0.00211997]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 6, 8]
layer1_inf_time: 2.934326171875
[PAIRWISE] pred_attackers_indx:  [2 6]
layer2_inf_t: 37.306884765625
assumed final_attacker_idxs:  [0 2 5 6 8]
final_attacker_idxs is: [0 2 5 6 8]
g_attacker_idxs: [38 26 75 93 44]
g_normal_idxs: [78 18 72 39 90]
filtered_attacker_idxs: [2, 6]
final_attacker_idxs are: [2, 6]
num_dps: [895, 303, 554, 459, 731, 686, 623, 257, 517, 683]
epoch_acc: 98.03
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0571, Accuracy: 9803/10000 (98.0300%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 13.0776, Accuracy: 1/8968 (0.0112%)
Done in 53.22010326385498 sec.
Server Epoch:54 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
___Train Local_Simple,  epoch  54, local model 31, internal_epoch   1,  Average loss: 0.0006, Accuracy: 822/835 (98.4431%)
___Train Local_Simple,  epoch  54, local model 31, internal_epoch   2,  Average loss: 0.0002, Accuracy: 830/835 (99.4012%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1168, Accuracy: 9655/10000 (96.5500%)
poison local model 1 index 0
___PoisonTrain Local_Simple ,  epoch  54, local model 1, internal_epoch   1,  Average loss: 0.0265, Accuracy: 386/760 (50.7895%), train_poison_data_count: 240
class_loss: 4.219659328460693, distance_loss: 0.0
class_loss: 2.759060859680176, distance_loss: 0.29173243045806885
class_loss: 1.2124882936477661, distance_loss: 0.7306475639343262
class_loss: 0.9215520024299622, distance_loss: 1.2066044807434082
class_loss: 1.1443372964859009, distance_loss: 1.6350079774856567
class_loss: 1.345211386680603, distance_loss: 2.003225803375244
class_loss: 1.4403916597366333, distance_loss: 2.3173327445983887
class_loss: 1.5542315244674683, distance_loss: 2.58604097366333
class_loss: 1.4386532306671143, distance_loss: 2.815138578414917
class_loss: 1.3038322925567627, distance_loss: 3.013615131378174
class_loss: 1.4939147233963013, distance_loss: 3.1884560585021973
class_loss: 1.339535117149353, distance_loss: 3.3420588970184326
class_loss: 1.3493857383728027, distance_loss: 3.4781455993652344
class_loss: 1.2324639558792114, distance_loss: 3.5984408855438232
class_loss: 1.3091458082199097, distance_loss: 3.7064104080200195
class_loss: 1.0653222799301147, distance_loss: 3.803880214691162
class_loss: 0.9552123546600342, distance_loss: 3.8932650089263916
class_loss: 1.0616581439971924, distance_loss: 3.976473569869995
class_loss: 1.034666657447815, distance_loss: 4.05416202545166
class_loss: 0.7315302491188049, distance_loss: 4.127844333648682
class_loss: 0.8993223905563354, distance_loss: 4.200592994689941
class_loss: 0.9135023355484009, distance_loss: 4.269944190979004
class_loss: 0.9011653661727905, distance_loss: 4.335646152496338
class_loss: 0.8301435112953186, distance_loss: 4.39434814453125
___PoisonTrain Local_Simple ,  epoch  54, local model 1, internal_epoch   2,  Average loss: 0.0162, Accuracy: 400/760 (52.6316%), train_poison_data_count: 240
Global model norm: 15.473254355234936.
Norm before scaling: 15.582120361991366. Distance: 4.450719136626112
Total norm for 2 adversaries is: 15.582120361991366. distance: 4.450719136626112
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 1.0489, Accuracy: 3993/8968 (44.5250%)
___Train Local_Simple,  epoch  54, local model 38, internal_epoch   1,  Average loss: 0.0004, Accuracy: 888/895 (99.2179%)
___Train Local_Simple,  epoch  54, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1203, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   1,  Average loss: 0.0005, Accuracy: 431/436 (98.8532%)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1535, Accuracy: 9540/10000 (95.4000%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 606/615 (98.5366%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 612/615 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0832, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  54, local model 19, internal_epoch   1,  Average loss: 0.0009, Accuracy: 200/205 (97.5610%)
___Train Local_Simple,  epoch  54, local model 19, internal_epoch   2,  Average loss: 0.0002, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1168, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch  54, local model 65, internal_epoch   1,  Average loss: 0.0004, Accuracy: 368/371 (99.1914%)
___Train Local_Simple,  epoch  54, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1583, Accuracy: 9552/10000 (95.5200%)
___Train Local_Simple,  epoch  54, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 647/660 (98.0303%)
___Train Local_Simple,  epoch  54, local model 66, internal_epoch   2,  Average loss: 0.0006, Accuracy: 652/660 (98.7879%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.3118, Accuracy: 9036/10000 (90.3600%)
poison local model 73 index 1
class_loss: 3.387514591217041, distance_loss: 0.0
class_loss: 1.5802574157714844, distance_loss: 0.3102489113807678
class_loss: 2.778434991836548, distance_loss: 0.7423998713493347
class_loss: 1.382736325263977, distance_loss: 1.0471009016036987
class_loss: 1.1731352806091309, distance_loss: 1.3791135549545288
class_loss: 1.1298613548278809, distance_loss: 1.739851713180542
class_loss: 1.0361719131469727, distance_loss: 2.0767016410827637
class_loss: 1.2486835718154907, distance_loss: 2.3879361152648926
class_loss: 1.2593719959259033, distance_loss: 2.6703648567199707
class_loss: 1.290328860282898, distance_loss: 2.9256017208099365
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0275, Accuracy: 333/591 (56.3452%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0202, Accuracy: 279/591 (47.2081%), train_poison_data_count: 195
Global model norm: 15.473254355234936.
Norm before scaling: 15.510449732464894. Distance: 4.568251446659567
Total norm for 2 adversaries is: 15.510449732464894. distance: 4.568251446659567
class_loss: 1.2211627960205078, distance_loss: 3.1775124073028564
class_loss: 1.401300311088562, distance_loss: 3.401421308517456
class_loss: 1.4286481142044067, distance_loss: 3.5925018787384033
class_loss: 1.158023476600647, distance_loss: 3.7572851181030273
class_loss: 1.0658459663391113, distance_loss: 3.9052493572235107
class_loss: 1.2037919759750366, distance_loss: 4.043086051940918
class_loss: 0.9830225110054016, distance_loss: 4.165647506713867
class_loss: 1.010971188545227, distance_loss: 4.2761311531066895
class_loss: 0.9766488075256348, distance_loss: 4.3767547607421875
class_loss: 1.4809340238571167, distance_loss: 4.468839168548584
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.8536, Accuracy: 8472/8968 (94.4692%)
___Train Local_Simple,  epoch  54, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch  54, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 73]
base_p: [-2.0778328e-03  3.1519681e-04 -9.9620782e-05 ... -1.5828758e-04
 -3.4689493e-03 -2.0113587e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 7, 8]
layer1_inf_time: 3.55126953125
[PAIRWISE] pred_attackers_indx:  [1 8]
layer2_inf_t: 34.9453125
assumed final_attacker_idxs:  [0 1 2 7 8]
final_attacker_idxs is: [0 1 2 7 8]
g_attacker_idxs: [31  1 38 66 73]
g_normal_idxs: [ 9  6 19 65 15]
filtered_attacker_idxs: [1, 7, 8]
final_attacker_idxs are: [1, 7, 8]
num_dps: [835, 760, 895, 436, 615, 205, 371, 660, 591, 401]
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0803, Accuracy: 9759/10000 (97.5900%)
time spent on training: 46.88351511955261
Starting performing KrMLRFL...
Num data points: [835, 760, 895, 436, 615, 205, 371, 660, 591, 401]
Num selected data points: [835 895 436 615 205 371 401]
The chosen ones are users: [0, 2, 3, 4, 5, 6, 9], which are global users: [31, 38, 9, 6, 19, 65, 15]
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0454, Accuracy: 9853/10000 (98.5300%)
epoch_acc: 98.53
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 15.1614, Accuracy: 9/8968 (0.1004%)
Done in 53.434521436691284 sec.
Server Epoch:55 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  55, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch  55, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2189, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch  55, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 682/686 (99.4169%)
___Train Local_Simple,  epoch  55, local model 75, internal_epoch   2,  Average loss: 0.0005, Accuracy: 679/686 (98.9796%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0681, Accuracy: 9782/10000 (97.8200%)
poison local model 1 index 0
class_loss: 4.382034778594971, distance_loss: 0.0
class_loss: 2.960026502609253, distance_loss: 0.3138887882232666
class_loss: 1.2610284090042114, distance_loss: 0.7877445220947266
class_loss: 1.0149445533752441, distance_loss: 1.3031306266784668
class_loss: 1.2731074094772339, distance_loss: 1.7585448026657104
class_loss: 1.3252153396606445, distance_loss: 2.1452863216400146
class_loss: 1.4846673011779785, distance_loss: 2.489292621612549
class_loss: 1.341131329536438, distance_loss: 2.793931722640991
class_loss: 1.3861325979232788, distance_loss: 3.0639708042144775
class_loss: 1.5024601221084595, distance_loss: 3.302253007888794
class_loss: 1.2375640869140625, distance_loss: 3.5117013454437256
class_loss: 1.2277809381484985, distance_loss: 3.7013120651245117
___PoisonTrain Local_Simple ,  epoch  55, local model 1, internal_epoch   1,  Average loss: 0.0268, Accuracy: 413/760 (54.3421%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  55, local model 1, internal_epoch   2,  Average loss: 0.0163, Accuracy: 418/760 (55.0000%), train_poison_data_count: 240
Global model norm: 15.450158986875396.
Norm before scaling: 15.583330178217984. Distance: 5.0372809047713645
Total norm for 2 adversaries is: 15.583330178217984. distance: 5.0372809047713645
class_loss: 1.3559001684188843, distance_loss: 3.872929811477661
class_loss: 1.2569407224655151, distance_loss: 4.0253214836120605
class_loss: 1.3210595846176147, distance_loss: 4.161313056945801
class_loss: 1.02566659450531, distance_loss: 4.2823166847229
class_loss: 1.0852365493774414, distance_loss: 4.393865585327148
class_loss: 1.006156086921692, distance_loss: 4.495827674865723
class_loss: 0.8962751030921936, distance_loss: 4.592132568359375
class_loss: 0.8202769160270691, distance_loss: 4.680471897125244
class_loss: 0.9644226431846619, distance_loss: 4.762020111083984
class_loss: 0.9412489533424377, distance_loss: 4.8387298583984375
class_loss: 0.8143642544746399, distance_loss: 4.90949821472168
class_loss: 0.8959537148475647, distance_loss: 4.975991725921631
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1.2333, Accuracy: 3729/8968 (41.5812%)
___Train Local_Simple,  epoch  55, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 851/860 (98.9535%)
___Train Local_Simple,  epoch  55, local model 37, internal_epoch   2,  Average loss: 0.0006, Accuracy: 853/860 (99.1860%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1697, Accuracy: 9463/10000 (94.6300%)
___Train Local_Simple,  epoch  55, local model 94, internal_epoch   1,  Average loss: 0.0013, Accuracy: 147/150 (98.0000%)
___Train Local_Simple,  epoch  55, local model 94, internal_epoch   2,  Average loss: 0.0002, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1022, Accuracy: 9695/10000 (96.9500%)
poison local model 51 index 1
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0287, Accuracy: 310/568 (54.5775%), train_poison_data_count: 180
class_loss: 5.381799221038818, distance_loss: 0.0
class_loss: 2.160545825958252, distance_loss: 0.49669787287712097
class_loss: 1.382285714149475, distance_loss: 1.0759435892105103
class_loss: 1.6042624711990356, distance_loss: 1.5751535892486572
class_loss: 1.4433479309082031, distance_loss: 2.02687931060791
class_loss: 1.3813295364379883, distance_loss: 2.4342494010925293
class_loss: 1.143731713294983, distance_loss: 2.806565761566162
class_loss: 0.8294622302055359, distance_loss: 3.148364543914795
class_loss: 0.9912742972373962, distance_loss: 3.4651412963867188
class_loss: 0.8099751472473145, distance_loss: 3.7527801990509033
class_loss: 1.0662134885787964, distance_loss: 4.01507043838501
class_loss: 1.0386494398117065, distance_loss: 4.242833614349365
class_loss: 0.6285464763641357, distance_loss: 4.44572639465332
class_loss: 1.060344934463501, distance_loss: 4.632083892822266
class_loss: 0.7227529883384705, distance_loss: 4.796412467956543
class_loss: 0.7750757932662964, distance_loss: 4.945220947265625
class_loss: 0.764252245426178, distance_loss: 5.077788829803467
class_loss: 0.8226794004440308, distance_loss: 5.196372032165527
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0135, Accuracy: 351/568 (61.7958%), train_poison_data_count: 180
Global model norm: 15.450158986875396.
Norm before scaling: 15.645467063927414. Distance: 5.302362440915745
Total norm for 2 adversaries is: 15.645467063927414. distance: 5.302362440915745
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 0.9677, Accuracy: 4771/8968 (53.2003%)
___Train Local_Simple,  epoch  55, local model 29, internal_epoch   1,  Average loss: 0.0005, Accuracy: 988/1002 (98.6028%)
___Train Local_Simple,  epoch  55, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 996/1002 (99.4012%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1509, Accuracy: 9555/10000 (95.5500%)
___Train Local_Simple,  epoch  55, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 251/257 (97.6654%)
___Train Local_Simple,  epoch  55, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1220, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  55, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 331/338 (97.9290%)
___Train Local_Simple,  epoch  55, local model 60, internal_epoch   2,  Average loss: 0.0006, Accuracy: 336/338 (99.4083%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0816, Accuracy: 9728/10000 (97.2800%)
___Train Local_Simple,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 430/434 (99.0783%)
___Train Local_Simple,  epoch  55, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 432/434 (99.5392%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.5755, Accuracy: 8855/10000 (88.5500%)
time spent on training: 47.25649333000183
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 51]
base_p: [-0.00157208  0.00030299 -0.00039342 ... -0.001799   -0.01510745
  0.00290795]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 6, 8]
layer1_inf_time: 5.259033203125
[PAIRWISE] pred_attackers_indx:  [2 5]
layer2_inf_t: 50.273193359375
assumed final_attacker_idxs:  [0 2 5 6 8]
final_attacker_idxs is: [0 2 5 6 8]
g_attacker_idxs: [53  1 51 29 60]
g_normal_idxs: [75 37 94 39  5]
filtered_attacker_idxs: [0, 2, 5, 6, 8]
final_attacker_idxs are: [0, 2, 5, 6, 8]
num_dps: [739, 686, 760, 860, 150, 568, 1002, 257, 338, 434]
Starting performing KrMLRFL...
Num data points: [739, 686, 760, 860, 150, 568, 1002, 257, 338, 434]
Num selected data points: [686 860 150 257 434]
The chosen ones are users: [1, 3, 4, 7, 9], which are global users: [75, 37, 94, 39, 5]
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0462, Accuracy: 9842/10000 (98.4200%)
epoch_acc: 98.42
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 13.1136, Accuracy: 34/8968 (0.3791%)
Done in 53.833752393722534 sec.
Server Epoch:56 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  56, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 682/686 (99.4169%)
___Train Local_Simple,  epoch  56, local model 75, internal_epoch   2,  Average loss: 0.0005, Accuracy: 679/686 (98.9796%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0570, Accuracy: 9824/10000 (98.2400%)
___Train Local_Simple,  epoch  56, local model 78, internal_epoch   1,  Average loss: 0.0007, Accuracy: 299/303 (98.6799%)
___Train Local_Simple,  epoch  56, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.2653, Accuracy: 9216/10000 (92.1600%)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 370/376 (98.4043%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0976, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  56, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/257 (98.4436%)
___Train Local_Simple,  epoch  56, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0580, Accuracy: 9813/10000 (98.1300%)
poison local model 7 index 0
class_loss: 3.201589822769165, distance_loss: 0.0
class_loss: 2.1661574840545654, distance_loss: 0.24398726224899292
class_loss: 1.4761947393417358, distance_loss: 0.6015883088111877
class_loss: 1.082309603691101, distance_loss: 0.999526858329773
class_loss: 0.8612194061279297, distance_loss: 1.3771657943725586
class_loss: 1.20408296585083, distance_loss: 1.7052438259124756
class_loss: 1.1213040351867676, distance_loss: 1.9944218397140503
___PoisonTrain Local_Simple ,  epoch  56, local model 7, internal_epoch   1,  Average loss: 0.0266, Accuracy: 263/418 (62.9187%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  56, local model 7, internal_epoch   2,  Average loss: 0.0190, Accuracy: 230/418 (55.0239%), train_poison_data_count: 140
Global model norm: 15.404955455563337.
Norm before scaling: 15.193954289395576. Distance: 3.3194851910490204
Total norm for 2 adversaries is: 15.193954289395576. distance: 3.3194851910490204
class_loss: 1.1997287273406982, distance_loss: 2.2568917274475098
class_loss: 1.036342978477478, distance_loss: 2.4839727878570557
class_loss: 1.1097030639648438, distance_loss: 2.681764841079712
class_loss: 1.1808432340621948, distance_loss: 2.849499464035034
class_loss: 1.1375699043273926, distance_loss: 2.9896771907806396
class_loss: 1.2112382650375366, distance_loss: 3.1102375984191895
class_loss: 1.0667980909347534, distance_loss: 3.2168562412261963
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.7937, Accuracy: 7006/8968 (78.1222%)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   1,  Average loss: 0.0004, Accuracy: 886/892 (99.3274%)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   2,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1312, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  56, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 768/772 (99.4819%)
___Train Local_Simple,  epoch  56, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 771/772 (99.8705%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0725, Accuracy: 9774/10000 (97.7400%)
poison local model 2 index 1
___PoisonTrain Local_Simple ,  epoch  56, local model 2, internal_epoch   1,  Average loss: 0.0178, Accuracy: 445/548 (81.2044%), train_poison_data_count: 180
class_loss: 2.7290451526641846, distance_loss: 0.0
class_loss: 1.8632746934890747, distance_loss: 0.20258277654647827
class_loss: 0.8767454028129578, distance_loss: 0.5187527537345886
class_loss: 1.0604181289672852, distance_loss: 0.8638458251953125
class_loss: 0.6303815245628357, distance_loss: 1.2295827865600586
class_loss: 0.6851770877838135, distance_loss: 1.5840787887573242
class_loss: 0.8185603022575378, distance_loss: 1.894729733467102
class_loss: 0.6661933660507202, distance_loss: 2.166766881942749
class_loss: 0.4241129755973816, distance_loss: 2.3975839614868164
class_loss: 0.7772312760353088, distance_loss: 2.608398914337158
class_loss: 0.8411075472831726, distance_loss: 2.7904956340789795
class_loss: 0.8514400124549866, distance_loss: 2.9482972621917725
class_loss: 0.6039719581604004, distance_loss: 3.0821633338928223
class_loss: 0.9155176281929016, distance_loss: 3.1981899738311768
class_loss: 0.9150524735450745, distance_loss: 3.300039529800415
class_loss: 0.6315312385559082, distance_loss: 3.3883578777313232
class_loss: 0.6586698293685913, distance_loss: 3.466357469558716
class_loss: 0.47837889194488525, distance_loss: 3.5368082523345947
___PoisonTrain Local_Simple ,  epoch  56, local model 2, internal_epoch   2,  Average loss: 0.0122, Accuracy: 378/548 (68.9781%), train_poison_data_count: 180
Global model norm: 15.404955455563337.
Norm before scaling: 15.212694408519228. Distance: 3.603535738426252
Total norm for 2 adversaries is: 15.212694408519228. distance: 3.603535738426252
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.6784, Accuracy: 7024/8968 (78.3229%)
___Train Local_Simple,  epoch  56, local model 68, internal_epoch   1,  Average loss: 0.0006, Accuracy: 488/494 (98.7854%)
___Train Local_Simple,  epoch  56, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1555, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  56, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 512/519 (98.6513%)
___Train Local_Simple,  epoch  56, local model 54, internal_epoch   2,  Average loss: 0.0006, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1196, Accuracy: 9642/10000 (96.4200%)
time spent on training: 46.815672874450684
Starting performing KrMLRFL...
Num data points: [686, 303, 376, 257, 418, 892, 772, 548, 494, 519]
Num selected data points: [686 303 376 257 892 772 494 519]
The chosen ones are users: [0, 1, 2, 3, 5, 6, 8, 9], which are global users: [75, 78, 14, 39, 10, 40, 68, 54]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 2]
base_p: [-0.00325231  0.00016806 -0.00071764 ... -0.00097889 -0.00185218
 -0.00200026]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 8]
layer1_inf_time: 4.198486328125
[PAIRWISE] pred_attackers_indx:  [4 7]
layer2_inf_t: 37.05908203125
assumed final_attacker_idxs:  [2 4 5 7 8]
final_attacker_idxs is: [2 4 5 7 8]
g_attacker_idxs: [14  7 10  2 68]
g_normal_idxs: [75 78 39 40 54]
filtered_attacker_idxs: [4, 7]
final_attacker_idxs are: [4, 7]
num_dps: [686, 303, 376, 257, 418, 892, 772, 548, 494, 519]
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0401, Accuracy: 9869/10000 (98.6900%)
epoch_acc: 98.69
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 13.9241, Accuracy: 16/8968 (0.1784%)
Done in 53.55130577087402 sec.
Server Epoch:57 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  57, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  57, local model 94, internal_epoch   2,  Average loss: 0.0002, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0731, Accuracy: 9768/10000 (97.6800%)
___Train Local_Simple,  epoch  57, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 442/448 (98.6607%)
___Train Local_Simple,  epoch  57, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0750, Accuracy: 9765/10000 (97.6500%)
___Train Local_Simple,  epoch  57, local model 82, internal_epoch   1,  Average loss: 0.0007, Accuracy: 702/713 (98.4572%)
___Train Local_Simple,  epoch  57, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.4836, Accuracy: 8869/10000 (88.6900%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 637/647 (98.4544%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 645/647 (99.6909%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1144, Accuracy: 9637/10000 (96.3700%)
poison local model 26 index 0
___PoisonTrain Local_Simple ,  epoch  57, local model 26, internal_epoch   1,  Average loss: 0.0238, Accuracy: 385/554 (69.4946%), train_poison_data_count: 180
class_loss: 3.3552963733673096, distance_loss: 0.0
class_loss: 2.3560149669647217, distance_loss: 0.27661141753196716
class_loss: 1.5109058618545532, distance_loss: 0.6721329689025879
class_loss: 0.9209767580032349, distance_loss: 1.1095019578933716
class_loss: 1.151131272315979, distance_loss: 1.479137897491455
class_loss: 0.94333815574646, distance_loss: 1.821547269821167
class_loss: 0.9814701080322266, distance_loss: 2.1344027519226074
class_loss: 0.924264669418335, distance_loss: 2.409456253051758
class_loss: 1.0262128114700317, distance_loss: 2.6468045711517334
class_loss: 0.9752227067947388, distance_loss: 2.8498706817626953
class_loss: 0.9976022839546204, distance_loss: 3.0248727798461914
class_loss: 1.0492767095565796, distance_loss: 3.1752986907958984
class_loss: 0.8240883946418762, distance_loss: 3.305687427520752
class_loss: 0.8287003040313721, distance_loss: 3.421966314315796
class_loss: 0.8431143760681152, distance_loss: 3.5241289138793945
___PoisonTrain Local_Simple ,  epoch  57, local model 26, internal_epoch   2,  Average loss: 0.0142, Accuracy: 347/554 (62.6354%), train_poison_data_count: 180
Global model norm: 15.368550754541623.
Norm before scaling: 15.230396115016593. Distance: 3.8336016657801784
Total norm for 3 adversaries is: 15.230396115016593. distance: 3.8336016657801784
class_loss: 0.7970332503318787, distance_loss: 3.61281156539917
class_loss: 0.7059836387634277, distance_loss: 3.690290927886963
class_loss: 0.8190582990646362, distance_loss: 3.762812376022339
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.8982, Accuracy: 6309/8968 (70.3501%)
poison local model 16 index 1
class_loss: 3.87752628326416, distance_loss: 0.0
class_loss: 2.9230453968048096, distance_loss: 0.30756428837776184
class_loss: 1.6072614192962646, distance_loss: 0.7979369759559631
class_loss: 1.3216866254806519, distance_loss: 1.265615701675415
class_loss: 1.574844241142273, distance_loss: 1.6356544494628906
class_loss: 1.1889255046844482, distance_loss: 1.9647753238677979
class_loss: 1.0799267292022705, distance_loss: 2.271454095840454
class_loss: 1.2186561822891235, distance_loss: 2.5498852729797363
class_loss: 1.2199430465698242, distance_loss: 2.8015167713165283
class_loss: 1.0715752840042114, distance_loss: 3.026953935623169
class_loss: 1.1328396797180176, distance_loss: 3.231574535369873
class_loss: 1.0675750970840454, distance_loss: 3.4184796810150146
class_loss: 1.315220594406128, distance_loss: 3.5927603244781494
class_loss: 1.1715919971466064, distance_loss: 3.7529802322387695
class_loss: 0.8997207283973694, distance_loss: 3.8967702388763428
___PoisonTrain Local_Simple ,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0248, Accuracy: 513/915 (56.0656%), train_poison_data_count: 299
___PoisonTrain Local_Simple ,  epoch  57, local model 16, internal_epoch   2,  Average loss: 0.0168, Accuracy: 510/915 (55.7377%), train_poison_data_count: 299
Global model norm: 15.368550754541623.
Norm before scaling: 15.597966359927492. Distance: 5.101388084152375
Total norm for 3 adversaries is: 15.597966359927492. distance: 5.101388084152375
class_loss: 1.7215977907180786, distance_loss: 4.059534549713135
class_loss: 1.310500144958496, distance_loss: 4.179285526275635
class_loss: 0.973014771938324, distance_loss: 4.27311897277832
class_loss: 1.0300930738449097, distance_loss: 4.3603692054748535
class_loss: 0.9984553456306458, distance_loss: 4.440028190612793
class_loss: 0.9839805364608765, distance_loss: 4.513835430145264
class_loss: 0.840472936630249, distance_loss: 4.586369514465332
class_loss: 0.9164412021636963, distance_loss: 4.657613754272461
class_loss: 1.036963939666748, distance_loss: 4.723167896270752
class_loss: 1.312968134880066, distance_loss: 4.785243511199951
class_loss: 0.9354190230369568, distance_loss: 4.843151092529297
class_loss: 0.9565954804420471, distance_loss: 4.897982597351074
class_loss: 0.7162436246871948, distance_loss: 4.945311546325684
class_loss: 0.7841644883155823, distance_loss: 4.989295959472656
class_loss: 0.8455631136894226, distance_loss: 5.02854061126709
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5317, Accuracy: 7281/8968 (81.1887%)
poison local model 7 index 2
class_loss: 3.221954107284546, distance_loss: 0.0
class_loss: 3.105715036392212, distance_loss: 0.29774209856987
class_loss: 1.0359596014022827, distance_loss: 0.749230146408081
class_loss: 1.7301557064056396, distance_loss: 1.2059762477874756
class_loss: 1.1942157745361328, distance_loss: 1.5593385696411133
class_loss: 1.0821022987365723, distance_loss: 1.856562852859497
class_loss: 1.0882527828216553, distance_loss: 2.1371099948883057
___PoisonTrain Local_Simple ,  epoch  57, local model 7, internal_epoch   1,  Average loss: 0.0298, Accuracy: 251/418 (60.0478%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  57, local model 7, internal_epoch   2,  Average loss: 0.0193, Accuracy: 214/418 (51.1962%), train_poison_data_count: 140
Global model norm: 15.368550754541623.
Norm before scaling: 15.19139520120452. Distance: 3.4582060978169054
Total norm for 3 adversaries is: 15.19139520120452. distance: 3.4582060978169054
class_loss: 1.1653242111206055, distance_loss: 2.3989577293395996
class_loss: 1.2088414430618286, distance_loss: 2.628998279571533
class_loss: 1.2242430448532104, distance_loss: 2.8237955570220947
class_loss: 1.2011371850967407, distance_loss: 2.9897818565368652
class_loss: 1.09089195728302, distance_loss: 3.1322553157806396
class_loss: 1.1847487688064575, distance_loss: 3.2544796466827393
class_loss: 1.0064259767532349, distance_loss: 3.359445333480835
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.4546, Accuracy: 8599/8968 (95.8854%)
___Train Local_Simple,  epoch  57, local model 90, internal_epoch   1,  Average loss: 0.0005, Accuracy: 677/683 (99.1215%)
___Train Local_Simple,  epoch  57, local model 90, internal_epoch   2,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.5856, Accuracy: 8402/10000 (84.0200%)
___Train Local_Simple,  epoch  57, local model 68, internal_epoch   1,  Average loss: 0.0004, Accuracy: 489/494 (98.9879%)
___Train Local_Simple,  epoch  57, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0771, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch  57, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch  57, local model 43, internal_epoch   2,  Average loss: 0.0005, Accuracy: 404/408 (99.0196%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0614, Accuracy: 9789/10000 (97.8900%)
time spent on training: 55.47771644592285
Starting performing KrMLRFL...
Num data points: [150, 448, 713, 647, 554, 915, 418, 683, 494, 408]
Num selected data points: [150 448 683 494 408]
The chosen ones are users: [0, 1, 7, 8, 9], which are global users: [94, 48, 90, 68, 43]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 16, 7]
base_p: [ 0.00025208  0.00020529  0.00029798 ... -0.00233311 -0.00321683
 -0.00182939]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 6]
layer1_inf_time: 5.658203125
[PAIRWISE] pred_attackers_indx:  [4 5 6]
layer2_inf_t: 36.207763671875
assumed final_attacker_idxs:  [2 3 4 5 6]
final_attacker_idxs is: [2 3 4 5 6]
g_attacker_idxs: [82 25 26 16  7]
g_normal_idxs: [94 48 90 68 43]
filtered_attacker_idxs: [2, 3, 4, 5, 6]
final_attacker_idxs are: [2, 3, 4, 5, 6]
num_dps: [150, 448, 713, 647, 554, 915, 418, 683, 494, 408]
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0481, Accuracy: 9851/10000 (98.5100%)
epoch_acc: 98.50999999999999
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 14.1585, Accuracy: 10/8968 (0.1115%)
Done in 61.415908098220825 sec.
Server Epoch:58 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0010, Accuracy: 546/557 (98.0251%)
___Train Local_Simple,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0811, Accuracy: 9743/10000 (97.4300%)
poison local model 27 index 0
___PoisonTrain Local_Simple ,  epoch  58, local model 27, internal_epoch   1,  Average loss: 0.0362, Accuracy: 241/471 (51.1677%), train_poison_data_count: 160
class_loss: 4.252965450286865, distance_loss: 0.0
class_loss: 3.6167891025543213, distance_loss: 0.31481480598449707
class_loss: 1.4120205640792847, distance_loss: 0.8561705350875854
class_loss: 1.7877907752990723, distance_loss: 1.427575707435608
class_loss: 1.6929861307144165, distance_loss: 1.8633400201797485
class_loss: 1.490086555480957, distance_loss: 2.2385475635528564
class_loss: 1.388784646987915, distance_loss: 2.585012197494507
class_loss: 1.4177860021591187, distance_loss: 2.8959598541259766
___PoisonTrain Local_Simple ,  epoch  58, local model 27, internal_epoch   2,  Average loss: 0.0209, Accuracy: 221/471 (46.9214%), train_poison_data_count: 160
Global model norm: 15.327632728939006.
Norm before scaling: 15.327125508952665. Distance: 4.6980238716879885
Total norm for 3 adversaries is: 15.327125508952665. distance: 4.6980238716879885
class_loss: 1.496023178100586, distance_loss: 3.183642625808716
class_loss: 1.2998954057693481, distance_loss: 3.4412734508514404
class_loss: 1.3880443572998047, distance_loss: 3.673536539077759
class_loss: 1.1790276765823364, distance_loss: 3.8841094970703125
class_loss: 1.3209580183029175, distance_loss: 4.0755743980407715
class_loss: 1.1238032579421997, distance_loss: 4.251795768737793
class_loss: 1.056119441986084, distance_loss: 4.410260200500488
class_loss: 1.000766396522522, distance_loss: 4.554090976715088
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.5888, Accuracy: 7505/8968 (83.6864%)
___Train Local_Simple,  epoch  58, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch  58, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0916, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  58, local model 19, internal_epoch   1,  Average loss: 0.0023, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch  58, local model 19, internal_epoch   2,  Average loss: 0.0020, Accuracy: 198/205 (96.5854%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0807, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch  58, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 272/276 (98.5507%)
___Train Local_Simple,  epoch  58, local model 58, internal_epoch   2,  Average loss: 0.0002, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1140, Accuracy: 9623/10000 (96.2300%)
___Train Local_Simple,  epoch  58, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 430/433 (99.3072%)
___Train Local_Simple,  epoch  58, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0580, Accuracy: 9806/10000 (98.0600%)
poison local model 91 index 1
___PoisonTrain Local_Simple ,  epoch  58, local model 91, internal_epoch   1,  Average loss: 0.0391, Accuracy: 138/256 (53.9062%), train_poison_data_count: 80
class_loss: 4.255427360534668, distance_loss: 0.0
class_loss: 2.541729688644409, distance_loss: 0.35192471742630005
class_loss: 1.5846924781799316, distance_loss: 0.8856801390647888
class_loss: 1.626751184463501, distance_loss: 1.2799752950668335
class_loss: 1.5185664892196655, distance_loss: 1.609660029411316
class_loss: 1.4493321180343628, distance_loss: 1.9117777347564697
class_loss: 1.2361719608306885, distance_loss: 2.204965829849243
class_loss: 1.2541680335998535, distance_loss: 2.4780142307281494
___PoisonTrain Local_Simple ,  epoch  58, local model 91, internal_epoch   2,  Average loss: 0.0213, Accuracy: 95/256 (37.1094%), train_poison_data_count: 80
Global model norm: 15.327632728939006.
Norm before scaling: 15.073673646693804. Distance: 2.7337100719157656
Total norm for 3 adversaries is: 15.073673646693804. distance: 2.7337100719157656
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 1.2637, Accuracy: 4767/8968 (53.1557%)
___Train Local_Simple,  epoch  58, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 658/672 (97.9167%)
___Train Local_Simple,  epoch  58, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 671/672 (99.8512%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1246, Accuracy: 9619/10000 (96.1900%)
poison local model 17 index 2
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   1,  Average loss: 0.0297, Accuracy: 323/620 (52.0968%), train_poison_data_count: 200
class_loss: 4.124702453613281, distance_loss: 0.0
class_loss: 2.987236261367798, distance_loss: 0.3199974298477173
class_loss: 1.5317919254302979, distance_loss: 0.8294342160224915
class_loss: 1.9592094421386719, distance_loss: 1.2981274127960205
class_loss: 1.3904550075531006, distance_loss: 1.6723928451538086
class_loss: 1.280895471572876, distance_loss: 2.015242338180542
class_loss: 1.3057482242584229, distance_loss: 2.3227081298828125
class_loss: 1.3185350894927979, distance_loss: 2.590372323989868
class_loss: 1.2346144914627075, distance_loss: 2.8238213062286377
class_loss: 1.2601248025894165, distance_loss: 3.028294563293457
class_loss: 1.0161670446395874, distance_loss: 3.215219020843506
class_loss: 1.1257373094558716, distance_loss: 3.388291597366333
class_loss: 1.1397106647491455, distance_loss: 3.5452005863189697
class_loss: 0.951833963394165, distance_loss: 3.6870474815368652
class_loss: 1.0193806886672974, distance_loss: 3.811884641647339
class_loss: 1.0344339609146118, distance_loss: 3.922168254852295
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   2,  Average loss: 0.0159, Accuracy: 336/620 (54.1935%), train_poison_data_count: 200
Global model norm: 15.327632728939006.
Norm before scaling: 15.422442424813253. Distance: 4.323901598153869
Total norm for 3 adversaries is: 15.422442424813253. distance: 4.323901598153869
class_loss: 0.967098593711853, distance_loss: 4.016679286956787
class_loss: 0.868582010269165, distance_loss: 4.100636005401611
class_loss: 0.8331875205039978, distance_loss: 4.176034450531006
class_loss: 0.9079519510269165, distance_loss: 4.247051239013672
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.8842, Accuracy: 4890/8968 (54.5272%)
___Train Local_Simple,  epoch  58, local model 57, internal_epoch   1,  Average loss: 0.0019, Accuracy: 333/343 (97.0845%)
___Train Local_Simple,  epoch  58, local model 57, internal_epoch   2,  Average loss: 0.0008, Accuracy: 337/343 (98.2507%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1261, Accuracy: 9583/10000 (95.8300%)
time spent on training: 53.71968698501587
Starting performing KrMLRFL...
Num data points: [557, 471, 686, 205, 276, 433, 256, 672, 620, 343]
Num selected data points: [557 686 205 276 433 343]
The chosen ones are users: [0, 2, 3, 4, 5, 9], which are global users: [74, 75, 19, 58, 83, 57]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 91, 17]
base_p: [-0.00094385  0.00039947  0.00010334 ... -0.00323407 -0.00646572
 -0.00044014]
[T_SCORE] attacker_local_idxs is:  [1, 2, 6, 7, 8]
layer1_inf_time: 3.835205078125
[PAIRWISE] pred_attackers_indx:  [1 6 8]
layer2_inf_t: 203.822998046875
assumed final_attacker_idxs:  [1 2 6 7 8]
final_attacker_idxs is: [1 2 6 7 8]
g_attacker_idxs: [27 75 91 96 17]
g_normal_idxs: [74 19 58 83 57]
filtered_attacker_idxs: [1, 6, 7, 8]
final_attacker_idxs are: [1, 6, 7, 8]
num_dps: [557, 471, 686, 205, 276, 433, 256, 672, 620, 343]
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0392, Accuracy: 9876/10000 (98.7600%)
epoch_acc: 98.76
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 12.4329, Accuracy: 30/8968 (0.3345%)
Done in 62.08324193954468 sec.
Server Epoch:59 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  59, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 581/589 (98.6418%)
___Train Local_Simple,  epoch  59, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 587/589 (99.6604%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0586, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 887/892 (99.4395%)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 890/892 (99.7758%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0834, Accuracy: 9717/10000 (97.1700%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   2,  Average loss: 0.0002, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0756, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch  59, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch  59, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0887, Accuracy: 9699/10000 (96.9900%)
poison local model 91 index 0
___PoisonTrain Local_Simple ,  epoch  59, local model 91, internal_epoch   1,  Average loss: 0.0392, Accuracy: 145/256 (56.6406%), train_poison_data_count: 80
class_loss: 4.108312129974365, distance_loss: 0.0
class_loss: 2.5137839317321777, distance_loss: 0.36526215076446533
class_loss: 1.644797921180725, distance_loss: 0.8563690781593323
class_loss: 1.7691322565078735, distance_loss: 1.2806912660598755
___PoisonTrain Local_Simple ,  epoch  59, local model 91, internal_epoch   2,  Average loss: 0.0217, Accuracy: 105/256 (41.0156%), train_poison_data_count: 80
Global model norm: 15.288895330748076.
Norm before scaling: 15.03646791742132. Distance: 2.6499976679953625
Total norm for 2 adversaries is: 15.03646791742132. distance: 2.6499976679953625
class_loss: 1.5320916175842285, distance_loss: 1.61473548412323
class_loss: 1.3973907232284546, distance_loss: 1.91092050075531
class_loss: 1.2921686172485352, distance_loss: 2.181469440460205
class_loss: 1.321577787399292, distance_loss: 2.4281160831451416
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 1.3121, Accuracy: 4851/8968 (54.0923%)
poison local model 13 index 1
___PoisonTrain Local_Simple ,  epoch  59, local model 13, internal_epoch   1,  Average loss: 0.0259, Accuracy: 414/734 (56.4033%), train_poison_data_count: 240
class_loss: 3.8887646198272705, distance_loss: 0.0
class_loss: 2.075324773788452, distance_loss: 0.3432403802871704
class_loss: 1.7626322507858276, distance_loss: 0.8489589691162109
class_loss: 1.8156722784042358, distance_loss: 1.2328425645828247
class_loss: 1.1686829328536987, distance_loss: 1.6043413877487183
class_loss: 1.1373131275177002, distance_loss: 1.9732530117034912
class_loss: 1.146265983581543, distance_loss: 2.3107759952545166
class_loss: 1.511351227760315, distance_loss: 2.612229824066162
class_loss: 1.0929783582687378, distance_loss: 2.8781895637512207
class_loss: 1.0455011129379272, distance_loss: 3.1173012256622314
class_loss: 1.090301513671875, distance_loss: 3.3305001258850098
class_loss: 1.2777377367019653, distance_loss: 3.5235507488250732
class_loss: 1.098975658416748, distance_loss: 3.7114417552948
class_loss: 1.1210075616836548, distance_loss: 3.882021188735962
class_loss: 1.1965097188949585, distance_loss: 4.027439117431641
class_loss: 1.0251327753067017, distance_loss: 4.152001857757568
class_loss: 1.0105044841766357, distance_loss: 4.2577385902404785
___PoisonTrain Local_Simple ,  epoch  59, local model 13, internal_epoch   2,  Average loss: 0.0159, Accuracy: 377/734 (51.3624%), train_poison_data_count: 240
Global model norm: 15.288895330748076.
Norm before scaling: 15.511464954798607. Distance: 4.927049417627665
Total norm for 2 adversaries is: 15.511464954798607. distance: 4.927049417627665
class_loss: 0.8559447526931763, distance_loss: 4.355600357055664
class_loss: 0.8872942328453064, distance_loss: 4.449863910675049
class_loss: 0.8581193089485168, distance_loss: 4.54019832611084
class_loss: 0.8488540053367615, distance_loss: 4.6265549659729
class_loss: 0.8565146923065186, distance_loss: 4.707733631134033
class_loss: 0.8599690794944763, distance_loss: 4.782451629638672
class_loss: 1.0645025968551636, distance_loss: 4.851408958435059
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 1.0424, Accuracy: 4915/8968 (54.8060%)
___Train Local_Simple,  epoch  59, local model 98, internal_epoch   1,  Average loss: 0.0008, Accuracy: 802/818 (98.0440%)
___Train Local_Simple,  epoch  59, local model 98, internal_epoch   2,  Average loss: 0.0002, Accuracy: 814/818 (99.5110%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1632, Accuracy: 9501/10000 (95.0100%)
___Train Local_Simple,  epoch  59, local model 21, internal_epoch   1,  Average loss: 0.0008, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch  59, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1131, Accuracy: 9630/10000 (96.3000%)
___Train Local_Simple,  epoch  59, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 702/713 (98.4572%)
___Train Local_Simple,  epoch  59, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2690, Accuracy: 9096/10000 (90.9600%)
___Train Local_Simple,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%)
___Train Local_Simple,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0625, Accuracy: 9794/10000 (97.9400%)
time spent on training: 46.50966024398804
Starting performing KrMLRFL...
Num data points: [589, 892, 303, 731, 256, 734, 818, 312, 713, 557]
Num selected data points: [892 303 731 312 557]
The chosen ones are users: [1, 2, 3, 7, 9], which are global users: [10, 78, 72, 21, 74]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 13]
base_p: [-7.8909099e-05  3.1924993e-04 -6.2659569e-04 ... -6.3281506e-04
 -5.4088905e-03 -1.1618957e-03]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 6, 8]
layer1_inf_time: 4.74267578125
[PAIRWISE] pred_attackers_indx:  [4 5]
layer2_inf_t: 301.25
assumed final_attacker_idxs:  [0 4 5 6 8]
final_attacker_idxs is: [0 4 5 6 8]
g_attacker_idxs: [77 91 13 98 82]
g_normal_idxs: [10 78 72 21 74]
filtered_attacker_idxs: [0, 4, 5, 6, 8]
final_attacker_idxs are: [0, 4, 5, 6, 8]
num_dps: [589, 892, 303, 731, 256, 734, 818, 312, 713, 557]
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0379, Accuracy: 9878/10000 (98.7800%)
epoch_acc: 98.78
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 13.4373, Accuracy: 20/8968 (0.2230%)
Done in 52.273812770843506 sec.
Server Epoch:60 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  60, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch  60, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 681/686 (99.2711%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1781, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch  60, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch  60, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.0670, Accuracy: 9788/10000 (97.8800%)
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0261, Accuracy: 321/568 (56.5141%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0131, Accuracy: 386/568 (67.9577%), train_poison_data_count: 180
Global model norm: 15.2296947939092.
Norm before scaling: 15.351306554005072. Distance: 4.746347729829846
Total norm for 3 adversaries is: 15.351306554005072. distance: 4.746347729829846
class_loss: 3.9886951446533203, distance_loss: 0.0
class_loss: 2.4418606758117676, distance_loss: 0.3690086901187897
class_loss: 1.577366828918457, distance_loss: 0.8925408124923706
class_loss: 1.7530713081359863, distance_loss: 1.293749213218689
class_loss: 1.3940560817718506, distance_loss: 1.6494784355163574
class_loss: 0.8532575964927673, distance_loss: 1.995789885520935
class_loss: 0.926563560962677, distance_loss: 2.3355119228363037
class_loss: 1.000163197517395, distance_loss: 2.658487319946289
class_loss: 0.9019931554794312, distance_loss: 2.962707757949829
class_loss: 0.8322879672050476, distance_loss: 3.241680860519409
class_loss: 0.6912933588027954, distance_loss: 3.4934768676757812
class_loss: 1.0511271953582764, distance_loss: 3.720672845840454
class_loss: 0.8706598281860352, distance_loss: 3.9206435680389404
class_loss: 0.9073712229728699, distance_loss: 4.097503662109375
class_loss: 0.8430062532424927, distance_loss: 4.254591464996338
class_loss: 0.7535063624382019, distance_loss: 4.395510196685791
class_loss: 0.741567075252533, distance_loss: 4.522972583770752
class_loss: 0.735092043876648, distance_loss: 4.638851165771484
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.9887, Accuracy: 4834/8968 (53.9028%)
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 426/435 (97.9310%)
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1093, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  60, local model 31, internal_epoch   1,  Average loss: 0.0003, Accuracy: 827/835 (99.0419%)
___Train Local_Simple,  epoch  60, local model 31, internal_epoch   2,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1223, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  60, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 958/977 (98.0553%)
___Train Local_Simple,  epoch  60, local model 32, internal_epoch   2,  Average loss: 0.0007, Accuracy: 966/977 (98.8741%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1300, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  60, local model 67, internal_epoch   1,  Average loss: 0.0008, Accuracy: 984/998 (98.5972%)
___Train Local_Simple,  epoch  60, local model 67, internal_epoch   2,  Average loss: 0.0005, Accuracy: 989/998 (99.0982%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1350, Accuracy: 9553/10000 (95.5300%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  60, local model 17, internal_epoch   1,  Average loss: 0.0314, Accuracy: 305/620 (49.1935%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  60, local model 17, internal_epoch   2,  Average loss: 0.0171, Accuracy: 327/620 (52.7419%), train_poison_data_count: 200
Global model norm: 15.2296947939092.
Norm before scaling: 15.352928632757305. Distance: 4.729721753765436
Total norm for 3 adversaries is: 15.352928632757305. distance: 4.729721753765436
class_loss: 4.3932785987854, distance_loss: 0.0
class_loss: 2.8805832862854004, distance_loss: 0.3360520899295807
class_loss: 1.6220160722732544, distance_loss: 0.8845526576042175
class_loss: 1.8832179307937622, distance_loss: 1.3725109100341797
class_loss: 1.6133912801742554, distance_loss: 1.7520896196365356
class_loss: 1.5038621425628662, distance_loss: 2.104496717453003
class_loss: 1.501286506652832, distance_loss: 2.423825263977051
class_loss: 1.4511933326721191, distance_loss: 2.708397150039673
class_loss: 1.4106254577636719, distance_loss: 2.9599456787109375
class_loss: 1.180586576461792, distance_loss: 3.1860227584838867
class_loss: 1.1057987213134766, distance_loss: 3.3971107006073
class_loss: 1.3242396116256714, distance_loss: 3.594122886657715
class_loss: 1.022596001625061, distance_loss: 3.769599676132202
class_loss: 1.118517279624939, distance_loss: 3.9286270141601562
class_loss: 0.9346910715103149, distance_loss: 4.07643985748291
class_loss: 1.131054162979126, distance_loss: 4.212865352630615
class_loss: 1.0652791261672974, distance_loss: 4.337333679199219
class_loss: 0.9290437698364258, distance_loss: 4.450038433074951
class_loss: 1.0265424251556396, distance_loss: 4.553893566131592
class_loss: 0.9581884741783142, distance_loss: 4.645287990570068
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.9564, Accuracy: 5348/8968 (59.6343%)
___Train Local_Simple,  epoch  60, local model 29, internal_epoch   1,  Average loss: 0.0005, Accuracy: 990/1002 (98.8024%)
___Train Local_Simple,  epoch  60, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2455, Accuracy: 9233/10000 (92.3300%)
poison local model 7 index 2
class_loss: 3.7565343379974365, distance_loss: 0.0
class_loss: 2.2471377849578857, distance_loss: 0.2717776298522949
class_loss: 1.462836503982544, distance_loss: 0.6730742454528809
class_loss: 0.6837193965911865, distance_loss: 1.1378971338272095
class_loss: 1.2929863929748535, distance_loss: 1.5448567867279053
class_loss: 1.3049637079238892, distance_loss: 1.8673954010009766
class_loss: 0.9846698641777039, distance_loss: 2.136232852935791
___PoisonTrain Local_Simple ,  epoch  60, local model 7, internal_epoch   1,  Average loss: 0.0281, Accuracy: 274/418 (65.5502%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  60, local model 7, internal_epoch   2,  Average loss: 0.0177, Accuracy: 254/418 (60.7656%), train_poison_data_count: 140
Global model norm: 15.2296947939092.
Norm before scaling: 15.062775035578966. Distance: 3.394710909146351
Total norm for 3 adversaries is: 15.062775035578966. distance: 3.394710909146351
class_loss: 1.3034698963165283, distance_loss: 2.379075765609741
class_loss: 1.0474627017974854, distance_loss: 2.5884592533111572
class_loss: 1.1556702852249146, distance_loss: 2.768519639968872
class_loss: 1.0499722957611084, distance_loss: 2.925663471221924
class_loss: 1.0211806297302246, distance_loss: 3.06241774559021
class_loss: 0.9753006100654602, distance_loss: 3.1819911003112793
class_loss: 0.8365612626075745, distance_loss: 3.288464307785034
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.5548, Accuracy: 7819/8968 (87.1878%)
time spent on training: 51.249396324157715
Starting performing KrMLRFL...
Num data points: [686, 250, 568, 435, 835, 977, 998, 620, 1002, 418]
Num selected data points: [ 686  250  435  835 1002]
The chosen ones are users: [0, 1, 3, 4, 8], which are global users: [75, 86, 0, 31, 29]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 17, 7]
base_p: [-0.00124051  0.00039686  0.0002193  ... -0.00452747 -0.0137228
  0.00350857]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 7, 9]
layer1_inf_time: 4.27685546875
[PAIRWISE] pred_attackers_indx:  [2 7 9]
layer2_inf_t: 43.15283203125
assumed final_attacker_idxs:  [2 5 6 7 9]
final_attacker_idxs is: [2 5 6 7 9]
g_attacker_idxs: [51 32 67 17  7]
g_normal_idxs: [75 86  0 31 29]
filtered_attacker_idxs: [2, 5, 6, 7, 9]
final_attacker_idxs are: [2, 5, 6, 7, 9]
num_dps: [686, 250, 568, 435, 835, 977, 998, 620, 1002, 418]
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.0430, Accuracy: 9859/10000 (98.5900%)
epoch_acc: 98.59
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 13.5293, Accuracy: 19/8968 (0.2119%)
Done in 57.085044622421265 sec.
Server Epoch:61 choose agents : [36, 9, 6, 79, 4, 52, 48, 5, 87, 73].
___Train Local_Simple,  epoch  61, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 984/1005 (97.9104%)
___Train Local_Simple,  epoch  61, local model 36, internal_epoch   2,  Average loss: 0.0009, Accuracy: 987/1005 (98.2090%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3624, Accuracy: 8885/10000 (88.8500%)
___Train Local_Simple,  epoch  61, local model 9, internal_epoch   1,  Average loss: 0.0005, Accuracy: 432/436 (99.0826%)
___Train Local_Simple,  epoch  61, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/436 (99.3119%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1628, Accuracy: 9509/10000 (95.0900%)
___Train Local_Simple,  epoch  61, local model 6, internal_epoch   1,  Average loss: 0.0004, Accuracy: 612/615 (99.5122%)
___Train Local_Simple,  epoch  61, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0905, Accuracy: 9697/10000 (96.9700%)
___Train Local_Simple,  epoch  61, local model 79, internal_epoch   1,  Average loss: 0.0009, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch  61, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0633, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch  61, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 645/658 (98.0243%)
___Train Local_Simple,  epoch  61, local model 4, internal_epoch   2,  Average loss: 0.0005, Accuracy: 652/658 (99.0881%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.2033, Accuracy: 9378/10000 (93.7800%)
poison local model 52 index 0
___PoisonTrain Local_Simple ,  epoch  61, local model 52, internal_epoch   1,  Average loss: 0.0388, Accuracy: 147/253 (58.1028%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  61, local model 52, internal_epoch   2,  Average loss: 0.0201, Accuracy: 112/253 (44.2688%), train_poison_data_count: 80
Global model norm: 15.16917739599263.
Norm before scaling: 14.937691020941267. Distance: 2.8668081256059894
Total norm for 2 adversaries is: 14.937691020941267. distance: 2.8668081256059894
class_loss: 4.525985240936279, distance_loss: 0.0
class_loss: 2.4244649410247803, distance_loss: 0.3799040615558624
class_loss: 1.505385398864746, distance_loss: 0.9120070338249207
class_loss: 1.3701072931289673, distance_loss: 1.336655855178833
class_loss: 1.2763742208480835, distance_loss: 1.6899465322494507
class_loss: 1.2741754055023193, distance_loss: 2.020005941390991
class_loss: 1.2577989101409912, distance_loss: 2.329944372177124
class_loss: 1.269234538078308, distance_loss: 2.6089770793914795
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.6209, Accuracy: 2515/8968 (28.0442%)
___Train Local_Simple,  epoch  61, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 442/448 (98.6607%)
___Train Local_Simple,  epoch  61, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1060, Accuracy: 9676/10000 (96.7600%)
___Train Local_Simple,  epoch  61, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 429/434 (98.8479%)
___Train Local_Simple,  epoch  61, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 432/434 (99.5392%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3772, Accuracy: 9041/10000 (90.4100%)
___Train Local_Simple,  epoch  61, local model 87, internal_epoch   1,  Average loss: 0.0004, Accuracy: 464/470 (98.7234%)
___Train Local_Simple,  epoch  61, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0948, Accuracy: 9734/10000 (97.3400%)
poison local model 73 index 1
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   1,  Average loss: 0.0254, Accuracy: 350/591 (59.2217%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   2,  Average loss: 0.0194, Accuracy: 301/591 (50.9306%), train_poison_data_count: 195
Global model norm: 15.16917739599263.
Norm before scaling: 15.136240415829198. Distance: 4.467440753494816
Total norm for 2 adversaries is: 15.136240415829198. distance: 4.467440753494816
class_loss: 3.4265918731689453, distance_loss: 0.0
class_loss: 1.5478652715682983, distance_loss: 0.4044468402862549
class_loss: 1.9676240682601929, distance_loss: 0.6592947244644165
class_loss: 1.5282789468765259, distance_loss: 0.9084623456001282
class_loss: 1.4589844942092896, distance_loss: 1.289224624633789
class_loss: 1.0790860652923584, distance_loss: 1.68360435962677
class_loss: 0.9716022610664368, distance_loss: 2.0400025844573975
class_loss: 0.9638699293136597, distance_loss: 2.3554816246032715
class_loss: 1.000351071357727, distance_loss: 2.633267641067505
class_loss: 1.0926131010055542, distance_loss: 2.8783299922943115
class_loss: 1.3201406002044678, distance_loss: 3.1285908222198486
class_loss: 1.385241985321045, distance_loss: 3.34114933013916
class_loss: 1.1174821853637695, distance_loss: 3.5205013751983643
class_loss: 1.108127474784851, distance_loss: 3.67901611328125
class_loss: 1.100074052810669, distance_loss: 3.826514720916748
class_loss: 1.0338084697723389, distance_loss: 3.9605307579040527
class_loss: 1.114555835723877, distance_loss: 4.082376956939697
class_loss: 1.1432230472564697, distance_loss: 4.191504001617432
class_loss: 0.9175616502761841, distance_loss: 4.289383411407471
class_loss: 1.2038547992706299, distance_loss: 4.373469829559326
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.0543, Accuracy: 7370/8968 (82.1811%)
time spent on training: 42.210615158081055
Starting performing KrMLRFL...
Num data points: [1005, 436, 615, 182, 658, 253, 448, 434, 470, 591]
Num selected data points: [436 615 182 448 434 470]
The chosen ones are users: [1, 2, 3, 6, 7, 8], which are global users: [9, 6, 79, 48, 5, 87]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 73]
base_p: [-0.00120889  0.00025947  0.00084086 ...  0.00130541 -0.00545904
 -0.00264043]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 7, 9]
layer1_inf_time: 4.05126953125
[PAIRWISE] pred_attackers_indx:  [5 9]
layer2_inf_t: 49.18115234375
assumed final_attacker_idxs:  [0 4 5 7 9]
final_attacker_idxs is: [0 4 5 7 9]
g_attacker_idxs: [36  4 52  5 73]
g_normal_idxs: [ 9  6 79 48 87]
filtered_attacker_idxs: [0, 4, 5, 9]
final_attacker_idxs are: [0, 4, 5, 9]
num_dps: [1005, 436, 615, 182, 658, 253, 448, 434, 470, 591]
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0441, Accuracy: 9862/10000 (98.6200%)
epoch_acc: 98.61999999999999
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 13.0713, Accuracy: 28/8968 (0.3122%)
Done in 50.31328773498535 sec.
Server Epoch:62 choose agents : [10, 31, 95, 82, 33, 30, 68, 11, 28, 70].
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 889/892 (99.6637%)
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 889/892 (99.6637%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0614, Accuracy: 9803/10000 (98.0300%)
___Train Local_Simple,  epoch  62, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 831/835 (99.5210%)
___Train Local_Simple,  epoch  62, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0844, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 596/602 (99.0033%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.9961, Accuracy: 8019/10000 (80.1900%)
___Train Local_Simple,  epoch  62, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 699/713 (98.0365%)
___Train Local_Simple,  epoch  62, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.4585, Accuracy: 8751/10000 (87.5100%)
___Train Local_Simple,  epoch  62, local model 33, internal_epoch   1,  Average loss: 0.0005, Accuracy: 615/623 (98.7159%)
___Train Local_Simple,  epoch  62, local model 33, internal_epoch   2,  Average loss: 0.0002, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0721, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch  62, local model 30, internal_epoch   1,  Average loss: 0.0004, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch  62, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0962, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch  62, local model 68, internal_epoch   1,  Average loss: 0.0005, Accuracy: 486/494 (98.3806%)
___Train Local_Simple,  epoch  62, local model 68, internal_epoch   2,  Average loss: 0.0004, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1822, Accuracy: 9476/10000 (94.7600%)
poison local model 11 index 0
___PoisonTrain Local_Simple ,  epoch  62, local model 11, internal_epoch   1,  Average loss: 0.0317, Accuracy: 321/645 (49.7674%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  62, local model 11, internal_epoch   2,  Average loss: 0.0190, Accuracy: 341/645 (52.8682%), train_poison_data_count: 205
Global model norm: 15.137349281222216.
Norm before scaling: 15.268286575486192. Distance: 4.648123389137751
Total norm for 2 adversaries is: 15.268286575486192. distance: 4.648123389137751
class_loss: 4.986249923706055, distance_loss: 0.0
class_loss: 2.572194814682007, distance_loss: 0.3678651750087738
class_loss: 1.6191550493240356, distance_loss: 0.866743803024292
class_loss: 1.5205726623535156, distance_loss: 1.3436574935913086
class_loss: 1.5711314678192139, distance_loss: 1.734140157699585
class_loss: 1.2947657108306885, distance_loss: 2.074002504348755
class_loss: 1.4505118131637573, distance_loss: 2.382556915283203
class_loss: 1.3693418502807617, distance_loss: 2.6559839248657227
class_loss: 1.4439727067947388, distance_loss: 2.89644193649292
class_loss: 1.4577702283859253, distance_loss: 3.104809045791626
class_loss: 1.1678388118743896, distance_loss: 3.2877981662750244
class_loss: 1.2624003887176514, distance_loss: 3.465226888656616
class_loss: 1.2401496171951294, distance_loss: 3.62640643119812
class_loss: 1.1765296459197998, distance_loss: 3.7680020332336426
class_loss: 1.2913674116134644, distance_loss: 3.8910224437713623
class_loss: 1.1140153408050537, distance_loss: 3.9974803924560547
class_loss: 0.9522268772125244, distance_loss: 4.094359397888184
class_loss: 1.0238184928894043, distance_loss: 4.187524318695068
class_loss: 0.9744462966918945, distance_loss: 4.2737603187561035
class_loss: 0.774710476398468, distance_loss: 4.357879638671875
class_loss: 0.8957293629646301, distance_loss: 4.441011905670166
class_loss: 1.5329622030258179, distance_loss: 4.5218658447265625
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.8175, Accuracy: 6159/8968 (68.6775%)
___Train Local_Simple,  epoch  62, local model 28, internal_epoch   1,  Average loss: 0.0003, Accuracy: 499/501 (99.6008%)
___Train Local_Simple,  epoch  62, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0541, Accuracy: 9830/10000 (98.3000%)
poison local model 70 index 1
___PoisonTrain Local_Simple ,  epoch  62, local model 70, internal_epoch   1,  Average loss: 0.0270, Accuracy: 375/724 (51.7956%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  62, local model 70, internal_epoch   2,  Average loss: 0.0178, Accuracy: 375/724 (51.7956%), train_poison_data_count: 240
Global model norm: 15.137349281222216.
Norm before scaling: 15.411123127937598. Distance: 4.949120090768819
Total norm for 2 adversaries is: 15.411123127937598. distance: 4.949120090768819
class_loss: 3.0015032291412354, distance_loss: 0.0
class_loss: 2.620732545852661, distance_loss: 0.29527565836906433
class_loss: 1.7556188106536865, distance_loss: 0.7639328241348267
class_loss: 1.8050544261932373, distance_loss: 1.1935445070266724
class_loss: 1.3561819791793823, distance_loss: 1.56703519821167
class_loss: 1.1862943172454834, distance_loss: 1.9086644649505615
class_loss: 1.2988224029541016, distance_loss: 2.2350268363952637
class_loss: 1.4280401468276978, distance_loss: 2.5264832973480225
class_loss: 1.3204646110534668, distance_loss: 2.7812862396240234
class_loss: 1.2526556253433228, distance_loss: 3.006610155105591
class_loss: 1.2005704641342163, distance_loss: 3.2102246284484863
class_loss: 1.3022598028182983, distance_loss: 3.396167755126953
class_loss: 1.4295858144760132, distance_loss: 3.5940144062042236
class_loss: 1.2934249639511108, distance_loss: 3.7626588344573975
class_loss: 1.209167718887329, distance_loss: 3.9032819271087646
class_loss: 0.9869344234466553, distance_loss: 4.032032012939453
class_loss: 1.0816782712936401, distance_loss: 4.157648086547852
class_loss: 0.8548564314842224, distance_loss: 4.2791900634765625
class_loss: 0.9633687138557434, distance_loss: 4.397161960601807
class_loss: 0.9676726460456848, distance_loss: 4.50880241394043
class_loss: 1.0276323556900024, distance_loss: 4.611351490020752
class_loss: 1.0265717506408691, distance_loss: 4.704151630401611
class_loss: 0.9851168990135193, distance_loss: 4.787580490112305
class_loss: 1.048121690750122, distance_loss: 4.856312274932861
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.7320, Accuracy: 6545/8968 (72.9817%)
time spent on training: 50.924506425857544
Starting performing KrMLRFL...
Num data points: [892, 835, 602, 713, 623, 400, 494, 645, 501, 724]
Num selected data points: [892 835 623 400 494 501]
The chosen ones are users: [0, 1, 4, 5, 6, 8], which are global users: [10, 31, 33, 30, 68, 28]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 70]
base_p: [-0.00122024  0.00037478 -0.00185055 ... -0.00273784 -0.00591227
 -0.00141162]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 7, 9]
layer1_inf_time: 3.27685546875
[PAIRWISE] pred_attackers_indx:  [7 9]
layer2_inf_t: 37.296142578125
assumed final_attacker_idxs:  [1 2 3 7 9]
final_attacker_idxs is: [1 2 3 7 9]
g_attacker_idxs: [31 95 82 11 70]
g_normal_idxs: [10 33 30 68 28]
filtered_attacker_idxs: [2, 3, 7, 9]
final_attacker_idxs are: [2, 3, 7, 9]
num_dps: [892, 835, 602, 713, 623, 400, 494, 645, 501, 724]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0377, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 15.1148, Accuracy: 12/8968 (0.1338%)
Done in 56.70498752593994 sec.
Server Epoch:63 choose agents : [63, 99, 35, 31, 85, 62, 21, 81, 52, 26].
poison local model 63 index 0
___PoisonTrain Local_Simple ,  epoch  63, local model 63, internal_epoch   1,  Average loss: 0.0270, Accuracy: 451/889 (50.7312%), train_poison_data_count: 280
___PoisonTrain Local_Simple ,  epoch  63, local model 63, internal_epoch   2,  Average loss: 0.0145, Accuracy: 542/889 (60.9674%), train_poison_data_count: 280
Global model norm: 15.09336381817043.
Norm before scaling: 15.336762804939019. Distance: 5.388938927609305
Total norm for 5 adversaries is: 15.336762804939019. distance: 5.388938927609305
class_loss: 4.132461071014404, distance_loss: 0.0
class_loss: 3.1697239875793457, distance_loss: 0.3072049617767334
class_loss: 1.6100140810012817, distance_loss: 0.828062117099762
class_loss: 1.588675618171692, distance_loss: 1.3736395835876465
class_loss: 1.533125877380371, distance_loss: 1.8047144412994385
class_loss: 1.5234700441360474, distance_loss: 2.1727664470672607
class_loss: 1.282517433166504, distance_loss: 2.5158863067626953
class_loss: 1.3429572582244873, distance_loss: 2.826441764831543
class_loss: 1.509300708770752, distance_loss: 3.09967041015625
class_loss: 1.4388021230697632, distance_loss: 3.341370105743408
class_loss: 1.261378526687622, distance_loss: 3.5558440685272217
class_loss: 1.333622932434082, distance_loss: 3.7498104572296143
class_loss: 1.290534496307373, distance_loss: 3.92382550239563
class_loss: 1.011369228363037, distance_loss: 4.0809197425842285
class_loss: 1.0148309469223022, distance_loss: 4.226823329925537
class_loss: 0.9786354899406433, distance_loss: 4.3650054931640625
class_loss: 0.8360052108764648, distance_loss: 4.49436616897583
class_loss: 0.7358688116073608, distance_loss: 4.615217208862305
class_loss: 0.9791558980941772, distance_loss: 4.728525638580322
class_loss: 1.0968286991119385, distance_loss: 4.833012104034424
class_loss: 0.8419675827026367, distance_loss: 4.924925327301025
class_loss: 0.8845013380050659, distance_loss: 5.008828639984131
class_loss: 1.1518610715866089, distance_loss: 5.087404251098633
class_loss: 0.8933840990066528, distance_loss: 5.149559020996094
class_loss: 0.786625325679779, distance_loss: 5.202048301696777
class_loss: 0.7277615070343018, distance_loss: 5.251298427581787
class_loss: 0.9614614844322205, distance_loss: 5.298447132110596
class_loss: 0.9965677857398987, distance_loss: 5.34548282623291
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 1.4580, Accuracy: 2254/8968 (25.1338%)
___Train Local_Simple,  epoch  63, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 374/377 (99.2042%)
___Train Local_Simple,  epoch  63, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0498, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch  63, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 494/499 (98.9980%)
___Train Local_Simple,  epoch  63, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0795, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch  63, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch  63, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0569, Accuracy: 9827/10000 (98.2700%)
poison local model 85 index 1
___PoisonTrain Local_Simple ,  epoch  63, local model 85, internal_epoch   1,  Average loss: 0.0332, Accuracy: 259/431 (60.0928%), train_poison_data_count: 140
class_loss: 4.9842610359191895, distance_loss: 0.0
class_loss: 3.392953872680664, distance_loss: 0.3838835060596466
class_loss: 1.1387945413589478, distance_loss: 0.9119126796722412
class_loss: 1.0393697023391724, distance_loss: 1.4596675634384155
class_loss: 1.358730673789978, distance_loss: 1.9371705055236816
class_loss: 1.2515586614608765, distance_loss: 2.3448848724365234
class_loss: 1.1550846099853516, distance_loss: 2.6931028366088867
___PoisonTrain Local_Simple ,  epoch  63, local model 85, internal_epoch   2,  Average loss: 0.0203, Accuracy: 179/431 (41.5313%), train_poison_data_count: 140
Global model norm: 15.09336381817043.
Norm before scaling: 15.011715192394842. Distance: 4.277571162618985
Total norm for 5 adversaries is: 15.011715192394842. distance: 4.277571162618985
class_loss: 1.3795350790023804, distance_loss: 2.992985248565674
class_loss: 1.367722749710083, distance_loss: 3.2509756088256836
class_loss: 1.3445584774017334, distance_loss: 3.4755473136901855
class_loss: 1.2916748523712158, distance_loss: 3.6738953590393066
class_loss: 1.2396410703659058, distance_loss: 3.848597526550293
class_loss: 1.197332501411438, distance_loss: 4.006372928619385
class_loss: 0.9319442510604858, distance_loss: 4.147934436798096
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.6908, Accuracy: 7619/8968 (84.9576%)
___Train Local_Simple,  epoch  63, local model 62, internal_epoch   1,  Average loss: 0.0005, Accuracy: 418/423 (98.8180%)
___Train Local_Simple,  epoch  63, local model 62, internal_epoch   2,  Average loss: 0.0003, Accuracy: 420/423 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0713, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1540, Accuracy: 9474/10000 (94.7400%)
poison local model 81 index 2
___PoisonTrain Local_Simple ,  epoch  63, local model 81, internal_epoch   1,  Average loss: 0.0287, Accuracy: 552/1227 (44.9878%), train_poison_data_count: 391
___PoisonTrain Local_Simple ,  epoch  63, local model 81, internal_epoch   2,  Average loss: 0.0150, Accuracy: 686/1227 (55.9087%), train_poison_data_count: 391
Global model norm: 15.09336381817043.
Norm before scaling: 15.792399662019731. Distance: 6.9358210551092
Total norm for 5 adversaries is: 15.792399662019731. distance: 6.9358210551092
class_loss: 6.718944549560547, distance_loss: 0.0
class_loss: 3.1124045848846436, distance_loss: 0.5080317854881287
class_loss: 1.857619285583496, distance_loss: 1.1295363903045654
class_loss: 1.4209859371185303, distance_loss: 1.7323428392410278
class_loss: 1.607869029045105, distance_loss: 2.2740135192871094
class_loss: 1.59316885471344, distance_loss: 2.7498345375061035
class_loss: 1.6394280195236206, distance_loss: 3.1674466133117676
class_loss: 1.6251566410064697, distance_loss: 3.5348803997039795
class_loss: 1.5630652904510498, distance_loss: 3.8625600337982178
class_loss: 1.5662086009979248, distance_loss: 4.156644344329834
class_loss: 1.4401637315750122, distance_loss: 4.422318935394287
class_loss: 1.5026086568832397, distance_loss: 4.6627197265625
class_loss: 1.428146481513977, distance_loss: 4.877788543701172
class_loss: 1.2782301902770996, distance_loss: 5.07095193862915
class_loss: 1.1823840141296387, distance_loss: 5.244167327880859
class_loss: 1.088000774383545, distance_loss: 5.399787902832031
class_loss: 1.3255374431610107, distance_loss: 5.5391340255737305
class_loss: 1.1209170818328857, distance_loss: 5.664615631103516
class_loss: 0.9581495523452759, distance_loss: 5.778498649597168
class_loss: 1.1384917497634888, distance_loss: 5.882623672485352
class_loss: 1.0956565141677856, distance_loss: 5.98514986038208
class_loss: 1.2673836946487427, distance_loss: 6.078157424926758
class_loss: 1.1932796239852905, distance_loss: 6.158653259277344
class_loss: 1.137555718421936, distance_loss: 6.230426788330078
class_loss: 0.8435398936271667, distance_loss: 6.299293518066406
class_loss: 0.8702251315116882, distance_loss: 6.3663201332092285
class_loss: 1.0290858745574951, distance_loss: 6.430153846740723
class_loss: 0.9010178446769714, distance_loss: 6.48645544052124
class_loss: 0.9463962316513062, distance_loss: 6.534709453582764
class_loss: 0.7676019072532654, distance_loss: 6.577751159667969
class_loss: 0.8484057784080505, distance_loss: 6.6189961433410645
class_loss: 0.826076328754425, distance_loss: 6.657885551452637
class_loss: 0.8846166729927063, distance_loss: 6.694135665893555
class_loss: 0.9249048233032227, distance_loss: 6.728327751159668
class_loss: 0.7512221336364746, distance_loss: 6.761955738067627
class_loss: 0.7489289045333862, distance_loss: 6.793793201446533
class_loss: 0.7644880414009094, distance_loss: 6.825656414031982
class_loss: 0.5887677669525146, distance_loss: 6.85419225692749
class_loss: 0.8407399654388428, distance_loss: 6.882269859313965
class_loss: 1.1369099617004395, distance_loss: 6.906932353973389
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.2823, Accuracy: 8419/8968 (93.8782%)
poison local model 52 index 3
___PoisonTrain Local_Simple ,  epoch  63, local model 52, internal_epoch   1,  Average loss: 0.0404, Accuracy: 142/253 (56.1265%), train_poison_data_count: 80
class_loss: 4.4634928703308105, distance_loss: 0.0
class_loss: 2.492419481277466, distance_loss: 0.3801605999469757
class_loss: 1.705702543258667, distance_loss: 0.9683980345726013
class_loss: 1.5594881772994995, distance_loss: 1.4183224439620972
class_loss: 1.3779174089431763, distance_loss: 1.7617775201797485
class_loss: 1.1585280895233154, distance_loss: 2.0975003242492676
class_loss: 1.09591543674469, distance_loss: 2.4096078872680664
class_loss: 1.0350253582000732, distance_loss: 2.6943392753601074
___PoisonTrain Local_Simple ,  epoch  63, local model 52, internal_epoch   2,  Average loss: 0.0184, Accuracy: 144/253 (56.9170%), train_poison_data_count: 80
Global model norm: 15.09336381817043.
Norm before scaling: 14.892311601098694. Distance: 2.957833709076512
Total norm for 5 adversaries is: 14.892311601098694. distance: 2.957833709076512
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 1.4585, Accuracy: 3132/8968 (34.9242%)
poison local model 26 index 0
___PoisonTrain Local_Simple ,  epoch  63, local model 26, internal_epoch   1,  Average loss: 0.0240, Accuracy: 390/554 (70.3971%), train_poison_data_count: 180
class_loss: 3.52736234664917, distance_loss: 0.0
class_loss: 2.278414011001587, distance_loss: 0.2624741792678833
class_loss: 1.2563246488571167, distance_loss: 0.641802191734314
class_loss: 1.0634148120880127, distance_loss: 1.1246715784072876
class_loss: 0.9047779440879822, distance_loss: 1.5400288105010986
class_loss: 0.9318468570709229, distance_loss: 1.8924890756607056
class_loss: 0.9392719864845276, distance_loss: 2.2090039253234863
class_loss: 1.1859620809555054, distance_loss: 2.4937307834625244
class_loss: 1.2037323713302612, distance_loss: 2.7398569583892822
class_loss: 1.1406292915344238, distance_loss: 2.9480412006378174
class_loss: 1.1484103202819824, distance_loss: 3.122673511505127
class_loss: 1.0483323335647583, distance_loss: 3.2744438648223877
class_loss: 0.845732569694519, distance_loss: 3.4070537090301514
class_loss: 0.8629598021507263, distance_loss: 3.526444911956787
class_loss: 1.0846574306488037, distance_loss: 3.632272481918335
class_loss: 0.8672367334365845, distance_loss: 3.722115993499756
class_loss: 0.739250123500824, distance_loss: 3.801213026046753
class_loss: 0.8407847285270691, distance_loss: 3.8736073970794678
___PoisonTrain Local_Simple ,  epoch  63, local model 26, internal_epoch   2,  Average loss: 0.0155, Accuracy: 329/554 (59.3863%), train_poison_data_count: 180
Global model norm: 15.09336381817043.
Norm before scaling: 14.971955595235483. Distance: 3.9433674767360434
Total norm for 5 adversaries is: 14.971955595235483. distance: 3.9433674767360434
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.8344, Accuracy: 6266/8968 (69.8707%)
time spent on training: 68.32175397872925
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 85, 81, 52, 26]
base_p: [-0.00215799  0.00020532 -0.00108961 ... -0.00283213 -0.01101256
  0.0003715 ]
[T_SCORE] attacker_local_idxs is:  [0, 4, 7, 8, 9]
layer1_inf_time: 2.774658203125
[PAIRWISE] pred_attackers_indx:  [0 4 7 9]
layer2_inf_t: 28.109375
assumed final_attacker_idxs:  [0 4 7 8 9]
final_attacker_idxs is: [0 4 7 8 9]
g_attacker_idxs: [63 85 81 52 26]
g_normal_idxs: [99 35 31 62 21]
filtered_attacker_idxs: [0, 4, 7, 8, 9]
final_attacker_idxs are: [0, 4, 7, 8, 9]
num_dps: [889, 377, 499, 835, 431, 423, 312, 1227, 253, 554]
Starting performing KrMLRFL...
Num data points: [889, 377, 499, 835, 431, 423, 312, 1227, 253, 554]
Num selected data points: [377 499 835 423 312]
The chosen ones are users: [1, 2, 3, 5, 6], which are global users: [99, 35, 31, 62, 21]
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0411, Accuracy: 9863/10000 (98.6300%)
epoch_acc: 98.63
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 14.3760, Accuracy: 29/8968 (0.3234%)
Done in 77.65827918052673 sec.
Server Epoch:64 choose agents : [27, 54, 48, 85, 16, 43, 52, 29, 93, 78].
poison local model 27 index 0
class_loss: 4.592966556549072, distance_loss: 0.0
___PoisonTrain Local_Simple ,  epoch  64, local model 27, internal_epoch   1,  Average loss: 0.0355, Accuracy: 252/471 (53.5032%), train_poison_data_count: 160
___PoisonTrain Local_Simple ,  epoch  64, local model 27, internal_epoch   2,  Average loss: 0.0220, Accuracy: 194/471 (41.1890%), train_poison_data_count: 160
Global model norm: 15.038343124028511.
Norm before scaling: 15.08193463045327. Distance: 4.667917265667965
Total norm for 5 adversaries is: 15.08193463045327. distance: 4.667917265667965
class_loss: 2.9438133239746094, distance_loss: 0.3672984540462494
class_loss: 1.7517513036727905, distance_loss: 0.9315161108970642
class_loss: 1.6444675922393799, distance_loss: 1.4249553680419922
class_loss: 1.46966552734375, distance_loss: 1.8104404211044312
class_loss: 1.253612756729126, distance_loss: 2.175511598587036
class_loss: 1.373687505722046, distance_loss: 2.513904094696045
class_loss: 1.6733530759811401, distance_loss: 2.822711229324341
class_loss: 1.5111690759658813, distance_loss: 3.116642475128174
class_loss: 1.283591866493225, distance_loss: 3.3809542655944824
class_loss: 1.526729702949524, distance_loss: 3.6190478801727295
class_loss: 1.4068289995193481, distance_loss: 3.8360166549682617
class_loss: 1.3377344608306885, distance_loss: 4.030093193054199
class_loss: 1.2549965381622314, distance_loss: 4.207248210906982
class_loss: 1.0005406141281128, distance_loss: 4.368959903717041
class_loss: 1.0274899005889893, distance_loss: 4.5165886878967285
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.7051, Accuracy: 6927/8968 (77.2413%)
___Train Local_Simple,  epoch  64, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 515/519 (99.2293%)
___Train Local_Simple,  epoch  64, local model 54, internal_epoch   2,  Average loss: 0.0003, Accuracy: 515/519 (99.2293%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1158, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  64, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch  64, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0618, Accuracy: 9803/10000 (98.0300%)
poison local model 85 index 1
___PoisonTrain Local_Simple ,  epoch  64, local model 85, internal_epoch   1,  Average loss: 0.0324, Accuracy: 237/431 (54.9884%), train_poison_data_count: 140
class_loss: 3.583656072616577, distance_loss: 0.0
class_loss: 2.5322835445404053, distance_loss: 0.34956490993499756
class_loss: 2.218982458114624, distance_loss: 0.8681051731109619
class_loss: 1.660342812538147, distance_loss: 1.3453388214111328
class_loss: 1.4829983711242676, distance_loss: 1.8027175664901733
class_loss: 1.1413424015045166, distance_loss: 2.2300360202789307
class_loss: 1.3388816118240356, distance_loss: 2.6168172359466553
___PoisonTrain Local_Simple ,  epoch  64, local model 85, internal_epoch   2,  Average loss: 0.0191, Accuracy: 207/431 (48.0278%), train_poison_data_count: 140
Global model norm: 15.038343124028511.
Norm before scaling: 14.998095582231432. Distance: 4.540853071687339
Total norm for 5 adversaries is: 14.998095582231432. distance: 4.540853071687339
class_loss: 1.2630281448364258, distance_loss: 2.964207410812378
class_loss: 1.3695638179779053, distance_loss: 3.2712948322296143
class_loss: 1.270848035812378, distance_loss: 3.5464630126953125
class_loss: 1.1505476236343384, distance_loss: 3.792078733444214
class_loss: 1.2968837022781372, distance_loss: 4.012417316436768
class_loss: 1.0773990154266357, distance_loss: 4.206942558288574
class_loss: 0.8249053955078125, distance_loss: 4.379769325256348
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.7853, Accuracy: 7262/8968 (80.9768%)
poison local model 16 index 2
___PoisonTrain Local_Simple ,  epoch  64, local model 16, internal_epoch   1,  Average loss: 0.0251, Accuracy: 527/915 (57.5956%), train_poison_data_count: 299
class_loss: 4.510033130645752, distance_loss: 0.0
class_loss: 2.764369487762451, distance_loss: 0.3761511743068695
class_loss: 2.3447108268737793, distance_loss: 0.9618116021156311
class_loss: 1.5299142599105835, distance_loss: 1.3740688562393188
class_loss: 1.1562904119491577, distance_loss: 1.7523114681243896
class_loss: 1.098907709121704, distance_loss: 2.1297996044158936
class_loss: 1.2662765979766846, distance_loss: 2.484830141067505
class_loss: 1.097409963607788, distance_loss: 2.803784132003784
class_loss: 1.1420254707336426, distance_loss: 3.089977741241455
class_loss: 1.2605338096618652, distance_loss: 3.353637218475342
class_loss: 0.9807320833206177, distance_loss: 3.593905210494995
class_loss: 1.005123496055603, distance_loss: 3.814378023147583
class_loss: 1.1193134784698486, distance_loss: 4.0143327713012695
class_loss: 0.8723530173301697, distance_loss: 4.189428806304932
class_loss: 0.8282811641693115, distance_loss: 4.3420233726501465
class_loss: 1.459633708000183, distance_loss: 4.507100582122803
class_loss: 1.2862179279327393, distance_loss: 4.6434736251831055
class_loss: 1.0745291709899902, distance_loss: 4.756124496459961
class_loss: 0.927385151386261, distance_loss: 4.86004114151001
class_loss: 0.911404550075531, distance_loss: 4.959059238433838
class_loss: 0.7993232607841492, distance_loss: 5.052759647369385
class_loss: 0.8429572582244873, distance_loss: 5.142988204956055
class_loss: 1.1114732027053833, distance_loss: 5.229061603546143
class_loss: 0.8717548847198486, distance_loss: 5.309118270874023
class_loss: 0.8798345923423767, distance_loss: 5.384616851806641
class_loss: 0.7370948195457458, distance_loss: 5.4555277824401855
class_loss: 0.8434690237045288, distance_loss: 5.519868850708008
class_loss: 0.9146249890327454, distance_loss: 5.572165012359619
class_loss: 0.9264313578605652, distance_loss: 5.61582612991333
class_loss: 1.1928390264511108, distance_loss: 5.654810428619385
___PoisonTrain Local_Simple ,  epoch  64, local model 16, internal_epoch   2,  Average loss: 0.0162, Accuracy: 513/915 (56.0656%), train_poison_data_count: 299
Global model norm: 15.038343124028511.
Norm before scaling: 15.520575863880966. Distance: 5.7269371919753125
Total norm for 5 adversaries is: 15.520575863880966. distance: 5.7269371919753125
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.3330, Accuracy: 7867/8968 (87.7230%)
___Train Local_Simple,  epoch  64, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 403/408 (98.7745%)
___Train Local_Simple,  epoch  64, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 405/408 (99.2647%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0606, Accuracy: 9804/10000 (98.0400%)
poison local model 52 index 3
___PoisonTrain Local_Simple ,  epoch  64, local model 52, internal_epoch   1,  Average loss: 0.0402, Accuracy: 147/253 (58.1028%), train_poison_data_count: 80
class_loss: 4.428792476654053, distance_loss: 0.0
class_loss: 2.6232926845550537, distance_loss: 0.42549094557762146
class_loss: 1.5649442672729492, distance_loss: 0.9478452801704407
class_loss: 1.5601025819778442, distance_loss: 1.3728790283203125
class_loss: 1.266427755355835, distance_loss: 1.7534492015838623
class_loss: 1.1654163599014282, distance_loss: 2.098689079284668
class_loss: 1.24659264087677, distance_loss: 2.4192540645599365
class_loss: 1.0420894622802734, distance_loss: 2.7088301181793213
___PoisonTrain Local_Simple ,  epoch  64, local model 52, internal_epoch   2,  Average loss: 0.0187, Accuracy: 144/253 (56.9170%), train_poison_data_count: 80
Global model norm: 15.038343124028511.
Norm before scaling: 14.826075003182737. Distance: 2.97433829121182
Total norm for 5 adversaries is: 14.826075003182737. distance: 2.97433829121182
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 1.3326, Accuracy: 4403/8968 (49.0968%)
___Train Local_Simple,  epoch  64, local model 29, internal_epoch   1,  Average loss: 0.0005, Accuracy: 992/1002 (99.0020%)
___Train Local_Simple,  epoch  64, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 998/1002 (99.6008%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2796, Accuracy: 9228/10000 (92.2800%)
poison local model 93 index 0
___PoisonTrain Local_Simple ,  epoch  64, local model 93, internal_epoch   1,  Average loss: 0.0330, Accuracy: 303/623 (48.6356%), train_poison_data_count: 200
class_loss: 4.170895576477051, distance_loss: 0.0
class_loss: 2.2854106426239014, distance_loss: 0.4056180715560913
class_loss: 4.231849670410156, distance_loss: 1.0196853876113892
class_loss: 1.6666884422302246, distance_loss: 1.3419508934020996
class_loss: 1.5012493133544922, distance_loss: 1.812376618385315
class_loss: 1.5339655876159668, distance_loss: 2.2993762493133545
class_loss: 1.3930162191390991, distance_loss: 2.7576165199279785
class_loss: 1.4251186847686768, distance_loss: 3.1713454723358154
class_loss: 1.229865312576294, distance_loss: 3.547593355178833
class_loss: 1.0988003015518188, distance_loss: 3.8934826850891113
class_loss: 1.0685584545135498, distance_loss: 4.212975978851318
class_loss: 1.0529271364212036, distance_loss: 4.505057334899902
class_loss: 1.1172294616699219, distance_loss: 4.768276691436768
class_loss: 1.029085636138916, distance_loss: 5.006046295166016
class_loss: 1.0523228645324707, distance_loss: 5.224262714385986
class_loss: 1.0232493877410889, distance_loss: 5.423829078674316
class_loss: 1.0483850240707397, distance_loss: 5.602698802947998
class_loss: 1.0191307067871094, distance_loss: 5.763072490692139
class_loss: 0.9665818214416504, distance_loss: 5.90744686126709
class_loss: 0.8799834847450256, distance_loss: 6.041200637817383
___PoisonTrain Local_Simple ,  epoch  64, local model 93, internal_epoch   2,  Average loss: 0.0165, Accuracy: 318/623 (51.0433%), train_poison_data_count: 200
Global model norm: 15.038343124028511.
Norm before scaling: 15.544058417131458. Distance: 6.164830458538137
Total norm for 5 adversaries is: 15.544058417131458. distance: 6.164830458538137
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 1.2813, Accuracy: 4287/8968 (47.8033%)
___Train Local_Simple,  epoch  64, local model 78, internal_epoch   1,  Average loss: 0.0005, Accuracy: 299/303 (98.6799%)
___Train Local_Simple,  epoch  64, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.2235, Accuracy: 9393/10000 (93.9300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 85, 16, 52, 93]
base_p: [-2.6753843e-03  1.5266240e-04  8.0747996e-05 ... -2.8615221e-03
 -1.2521431e-02 -1.8277839e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 8]
layer1_inf_time: 4.740234375
[PAIRWISE] pred_attackers_indx:  [0 3 4 6 8]
layer2_inf_t: 124.684326171875
assumed final_attacker_idxs:  [0 3 4 6 8]
final_attacker_idxs is: [0 3 4 6 8]
g_attacker_idxs: [27 85 16 52 93]
g_normal_idxs: [54 48 43 29 78]
filtered_attacker_idxs: [0, 3, 4, 6, 8]
final_attacker_idxs are: [0, 3, 4, 6, 8]
num_dps: [471, 519, 448, 431, 915, 408, 253, 1002, 623, 303]
time spent on training: 70.61001825332642
Starting performing KrMLRFL...
Num data points: [471, 519, 448, 431, 915, 408, 253, 1002, 623, 303]
Num selected data points: [ 519  448  408 1002  303]
The chosen ones are users: [1, 2, 5, 7, 9], which are global users: [54, 48, 43, 29, 78]
epoch_acc: 98.48
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0460, Accuracy: 9848/10000 (98.4800%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 13.6197, Accuracy: 11/8968 (0.1227%)
Done in 76.72621393203735 sec.
Server Epoch:65 choose agents : [5, 85, 24, 0, 35, 65, 46, 29, 45, 69].
___Train Local_Simple,  epoch  65, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 431/434 (99.3088%)
___Train Local_Simple,  epoch  65, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1210, Accuracy: 9548/10000 (95.4800%)
poison local model 85 index 0
class_loss: 4.962891578674316, distance_loss: 0.0
class_loss: 2.7553606033325195, distance_loss: 0.42603540420532227
class_loss: 1.283206582069397, distance_loss: 0.9504103660583496
class_loss: 1.2715532779693604, distance_loss: 1.4597097635269165
class_loss: 1.6159090995788574, distance_loss: 1.914605736732483
class_loss: 1.3414055109024048, distance_loss: 2.3186264038085938
class_loss: 1.4302005767822266, distance_loss: 2.674661874771118
___PoisonTrain Local_Simple ,  epoch  65, local model 85, internal_epoch   1,  Average loss: 0.0340, Accuracy: 252/431 (58.4687%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  65, local model 85, internal_epoch   2,  Average loss: 0.0224, Accuracy: 172/431 (39.9072%), train_poison_data_count: 140
Global model norm: 15.005593337849005.
Norm before scaling: 14.934465810432215. Distance: 4.423133266689741
Total norm for 2 adversaries is: 14.934465810432215. distance: 4.423133266689741
class_loss: 1.6127110719680786, distance_loss: 2.9944210052490234
class_loss: 1.497643232345581, distance_loss: 3.2746469974517822
class_loss: 1.4893324375152588, distance_loss: 3.5248987674713135
class_loss: 1.475079894065857, distance_loss: 3.7443525791168213
class_loss: 1.2675812244415283, distance_loss: 3.93973708152771
class_loss: 1.2839422225952148, distance_loss: 4.116348743438721
class_loss: 1.025454044342041, distance_loss: 4.276366233825684
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.7588, Accuracy: 7721/8968 (86.0950%)
___Train Local_Simple,  epoch  65, local model 24, internal_epoch   1,  Average loss: 0.0009, Accuracy: 371/379 (97.8892%)
___Train Local_Simple,  epoch  65, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0693, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch  65, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 426/435 (97.9310%)
___Train Local_Simple,  epoch  65, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1485, Accuracy: 9552/10000 (95.5200%)
___Train Local_Simple,  epoch  65, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch  65, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1082, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch  65, local model 65, internal_epoch   1,  Average loss: 0.0006, Accuracy: 366/371 (98.6523%)
___Train Local_Simple,  epoch  65, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1627, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  65, local model 46, internal_epoch   1,  Average loss: 0.0011, Accuracy: 692/710 (97.4648%)
___Train Local_Simple,  epoch  65, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 698/710 (98.3099%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1649, Accuracy: 9463/10000 (94.6300%)
___Train Local_Simple,  epoch  65, local model 29, internal_epoch   1,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch  65, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0801, Accuracy: 9740/10000 (97.4000%)
poison local model 45 index 1
___PoisonTrain Local_Simple ,  epoch  65, local model 45, internal_epoch   1,  Average loss: 0.0266, Accuracy: 334/628 (53.1847%), train_poison_data_count: 200
class_loss: 3.5112898349761963, distance_loss: 0.0
class_loss: 2.57248854637146, distance_loss: 0.30945906043052673
class_loss: 1.4839895963668823, distance_loss: 0.7805445194244385
class_loss: 1.5774518251419067, distance_loss: 1.2106552124023438
class_loss: 1.0927400588989258, distance_loss: 1.5515387058258057
class_loss: 1.181342601776123, distance_loss: 1.8627456426620483
class_loss: 1.3289376497268677, distance_loss: 2.1483705043792725
class_loss: 1.471449375152588, distance_loss: 2.4051671028137207
class_loss: 1.3847883939743042, distance_loss: 2.6344265937805176
class_loss: 1.0850379467010498, distance_loss: 2.837618350982666
___PoisonTrain Local_Simple ,  epoch  65, local model 45, internal_epoch   2,  Average loss: 0.0154, Accuracy: 362/628 (57.6433%), train_poison_data_count: 200
Global model norm: 15.005593337849005.
Norm before scaling: 15.085054471502684. Distance: 4.2494098029133065
Total norm for 2 adversaries is: 15.085054471502684. distance: 4.2494098029133065
class_loss: 1.116876244544983, distance_loss: 3.022235155105591
class_loss: 1.1579134464263916, distance_loss: 3.1915981769561768
class_loss: 1.0354411602020264, distance_loss: 3.3542964458465576
class_loss: 1.0093947649002075, distance_loss: 3.5069189071655273
class_loss: 0.9429970979690552, distance_loss: 3.650886058807373
class_loss: 0.9394684433937073, distance_loss: 3.780379295349121
class_loss: 0.839343786239624, distance_loss: 3.8967294692993164
class_loss: 0.9895806312561035, distance_loss: 3.9983413219451904
class_loss: 0.8616307973861694, distance_loss: 4.089691162109375
class_loss: 0.7880340218544006, distance_loss: 4.170504570007324
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.8681, Accuracy: 5832/8968 (65.0312%)
___Train Local_Simple,  epoch  65, local model 69, internal_epoch   1,  Average loss: 0.0010, Accuracy: 251/256 (98.0469%)
___Train Local_Simple,  epoch  65, local model 69, internal_epoch   2,  Average loss: 0.0003, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1653, Accuracy: 9451/10000 (94.5100%)
time spent on training: 46.32741570472717
Starting performing KrMLRFL...
Num data points: [434, 431, 379, 435, 499, 371, 710, 1002, 628, 256]
Num selected data points: [434 435 499 371 256]
The chosen ones are users: [0, 3, 4, 5, 9], which are global users: [5, 0, 35, 65, 69]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 45]
base_p: [-0.00060558  0.00024432 -0.00088523 ... -0.0020679   0.00101782
 -0.00136235]
[T_SCORE] attacker_local_idxs is:  [1, 2, 6, 7, 8]
layer1_inf_time: 3.362060546875
[PAIRWISE] pred_attackers_indx:  [1 8]
layer2_inf_t: 32.930419921875
assumed final_attacker_idxs:  [1 2 6 7 8]
final_attacker_idxs is: [1 2 6 7 8]
g_attacker_idxs: [85 24 46 29 45]
g_normal_idxs: [ 5  0 35 65 69]
filtered_attacker_idxs: [1, 2, 6, 7, 8]
final_attacker_idxs are: [1, 2, 6, 7, 8]
num_dps: [434, 431, 379, 435, 499, 371, 710, 1002, 628, 256]
epoch_acc: 98.7
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0405, Accuracy: 9870/10000 (98.7000%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 13.6156, Accuracy: 11/8968 (0.1227%)
Done in 52.602269887924194 sec.
Server Epoch:66 choose agents : [10, 16, 41, 45, 65, 81, 24, 64, 48, 29].
___Train Local_Simple,  epoch  66, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%)
___Train Local_Simple,  epoch  66, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1052, Accuracy: 9656/10000 (96.5600%)
poison local model 16 index 0
class_loss: 4.657155513763428, distance_loss: 0.0
class_loss: 2.767577886581421, distance_loss: 0.3267223834991455
___PoisonTrain Local_Simple ,  epoch  66, local model 16, internal_epoch   1,  Average loss: 0.0266, Accuracy: 462/915 (50.4918%), train_poison_data_count: 299
class_loss: 0.9685089588165283, distance_loss: 0.8465810418128967
class_loss: 1.3126559257507324, distance_loss: 1.3168779611587524
class_loss: 1.5286245346069336, distance_loss: 1.6957379579544067
class_loss: 1.4167702198028564, distance_loss: 2.029047727584839
class_loss: 1.5058711767196655, distance_loss: 2.3272876739501953
class_loss: 1.5583186149597168, distance_loss: 2.5879294872283936
class_loss: 1.3465451002120972, distance_loss: 2.813399076461792
class_loss: 1.3316417932510376, distance_loss: 3.0119340419769287
class_loss: 1.2174673080444336, distance_loss: 3.189703941345215
class_loss: 1.172803521156311, distance_loss: 3.352632522583008
class_loss: 1.0843886137008667, distance_loss: 3.502138376235962
class_loss: 1.0302082300186157, distance_loss: 3.63885760307312
class_loss: 1.4663171768188477, distance_loss: 3.76037335395813
class_loss: 1.0544592142105103, distance_loss: 3.892306327819824
class_loss: 1.1194779872894287, distance_loss: 4.0071330070495605
class_loss: 1.0970593690872192, distance_loss: 4.10182523727417
class_loss: 0.9778135418891907, distance_loss: 4.185128688812256
class_loss: 0.9857769012451172, distance_loss: 4.2634735107421875
class_loss: 0.9728555083274841, distance_loss: 4.335580825805664
class_loss: 0.8890683054924011, distance_loss: 4.399789810180664
class_loss: 0.9412065148353577, distance_loss: 4.457392692565918
class_loss: 0.9274644255638123, distance_loss: 4.511684417724609
class_loss: 0.7417067289352417, distance_loss: 4.561417579650879
class_loss: 0.8614881634712219, distance_loss: 4.608129501342773
class_loss: 0.8256841897964478, distance_loss: 4.653359413146973
class_loss: 0.7715787291526794, distance_loss: 4.695165157318115
class_loss: 0.9262665510177612, distance_loss: 4.73318338394165
class_loss: 1.1102062463760376, distance_loss: 4.766165256500244
___PoisonTrain Local_Simple ,  epoch  66, local model 16, internal_epoch   2,  Average loss: 0.0155, Accuracy: 506/915 (55.3005%), train_poison_data_count: 299
Global model norm: 14.976021483772714.
Norm before scaling: 15.254845021528714. Distance: 4.819944890130642
Total norm for 3 adversaries is: 15.254845021528714. distance: 4.819944890130642
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.7991, Accuracy: 5730/8968 (63.8938%)
___Train Local_Simple,  epoch  66, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%)
___Train Local_Simple,  epoch  66, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0814, Accuracy: 9753/10000 (97.5300%)
poison local model 45 index 1
___PoisonTrain Local_Simple ,  epoch  66, local model 45, internal_epoch   1,  Average loss: 0.0286, Accuracy: 335/628 (53.3439%), train_poison_data_count: 200
class_loss: 4.072477340698242, distance_loss: 0.0
class_loss: 2.9460110664367676, distance_loss: 0.3253960609436035
class_loss: 1.2141858339309692, distance_loss: 0.854762077331543
class_loss: 2.1702113151550293, distance_loss: 1.311307430267334
class_loss: 1.2390549182891846, distance_loss: 1.6699696779251099
class_loss: 1.314746618270874, distance_loss: 1.9961663484573364
class_loss: 1.335970163345337, distance_loss: 2.288217067718506
class_loss: 1.3492834568023682, distance_loss: 2.543168067932129
class_loss: 1.2353947162628174, distance_loss: 2.7669782638549805
class_loss: 1.0636253356933594, distance_loss: 2.9700124263763428
___PoisonTrain Local_Simple ,  epoch  66, local model 45, internal_epoch   2,  Average loss: 0.0139, Accuracy: 378/628 (60.1911%), train_poison_data_count: 200
Global model norm: 14.976021483772714.
Norm before scaling: 15.053112349486069. Distance: 4.4673835425842645
Total norm for 3 adversaries is: 15.053112349486069. distance: 4.4673835425842645
class_loss: 0.9529910087585449, distance_loss: 3.162853240966797
class_loss: 0.7723938822746277, distance_loss: 3.3444483280181885
class_loss: 1.0266003608703613, distance_loss: 3.518739700317383
class_loss: 0.9191205501556396, distance_loss: 3.677239418029785
class_loss: 1.0321732759475708, distance_loss: 3.8199679851531982
class_loss: 0.8941454887390137, distance_loss: 3.9492642879486084
class_loss: 0.7821429967880249, distance_loss: 4.068601131439209
class_loss: 0.7245210409164429, distance_loss: 4.1809306144714355
class_loss: 0.8841158151626587, distance_loss: 4.285990238189697
class_loss: 0.7412592172622681, distance_loss: 4.382091999053955
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 1.0313, Accuracy: 5020/8968 (55.9768%)
___Train Local_Simple,  epoch  66, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch  66, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0501, Accuracy: 9842/10000 (98.4200%)
poison local model 81 index 2
___PoisonTrain Local_Simple ,  epoch  66, local model 81, internal_epoch   1,  Average loss: 0.0244, Accuracy: 600/1227 (48.8998%), train_poison_data_count: 391
class_loss: 4.4170122146606445, distance_loss: 0.0
class_loss: 3.3430240154266357, distance_loss: 0.35102543234825134
class_loss: 1.8548234701156616, distance_loss: 0.889872670173645
class_loss: 1.3877451419830322, distance_loss: 1.4483195543289185
class_loss: 1.4555039405822754, distance_loss: 1.930511474609375
class_loss: 1.566771388053894, distance_loss: 2.3406341075897217
class_loss: 1.49582040309906, distance_loss: 2.70023512840271
class_loss: 1.4743096828460693, distance_loss: 3.020958423614502
class_loss: 1.445401668548584, distance_loss: 3.305255651473999
class_loss: 1.29088294506073, distance_loss: 3.558410882949829
class_loss: 1.1346827745437622, distance_loss: 3.7863943576812744
class_loss: 0.9955810308456421, distance_loss: 3.9952869415283203
class_loss: 1.0033912658691406, distance_loss: 4.187875270843506
class_loss: 1.0988802909851074, distance_loss: 4.36353063583374
class_loss: 0.9806571006774902, distance_loss: 4.524490833282471
class_loss: 0.9547941088676453, distance_loss: 4.668332576751709
class_loss: 0.9010804891586304, distance_loss: 4.797369003295898
class_loss: 0.8487898111343384, distance_loss: 4.912493705749512
class_loss: 0.8711628913879395, distance_loss: 5.017184257507324
class_loss: 1.4701340198516846, distance_loss: 5.116179466247559
class_loss: 0.9214088916778564, distance_loss: 5.218298435211182
class_loss: 0.966452419757843, distance_loss: 5.310454368591309
class_loss: 0.9657518267631531, distance_loss: 5.389985084533691
class_loss: 0.9287515878677368, distance_loss: 5.459352493286133
class_loss: 0.8852778673171997, distance_loss: 5.524109363555908
class_loss: 0.9715007543563843, distance_loss: 5.585041046142578
class_loss: 0.8078336715698242, distance_loss: 5.640737056732178
class_loss: 0.746961236000061, distance_loss: 5.691762924194336
class_loss: 0.9563047885894775, distance_loss: 5.741030216217041
class_loss: 1.0165534019470215, distance_loss: 5.786458492279053
class_loss: 0.6080010533332825, distance_loss: 5.825307369232178
class_loss: 0.8082296252250671, distance_loss: 5.86113166809082
class_loss: 0.7809467911720276, distance_loss: 5.896927356719971
class_loss: 0.836008608341217, distance_loss: 5.933138370513916
class_loss: 0.7606085538864136, distance_loss: 5.969252586364746
class_loss: 0.8135665059089661, distance_loss: 6.0060882568359375
class_loss: 0.7976013422012329, distance_loss: 6.041214942932129
class_loss: 0.616016685962677, distance_loss: 6.070788383483887
class_loss: 0.7004687786102295, distance_loss: 6.099507808685303
class_loss: 1.1478828191757202, distance_loss: 6.128055572509766
___PoisonTrain Local_Simple ,  epoch  66, local model 81, internal_epoch   2,  Average loss: 0.0139, Accuracy: 732/1227 (59.6577%), train_poison_data_count: 391
Global model norm: 14.976021483772714.
Norm before scaling: 15.57067999284081. Distance: 6.1869722391716975
Total norm for 3 adversaries is: 15.57067999284081. distance: 6.1869722391716975
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.2745, Accuracy: 8117/8968 (90.5107%)
___Train Local_Simple,  epoch  66, local model 24, internal_epoch   1,  Average loss: 0.0008, Accuracy: 371/379 (97.8892%)
___Train Local_Simple,  epoch  66, local model 24, internal_epoch   2,  Average loss: 0.0007, Accuracy: 375/379 (98.9446%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1417, Accuracy: 9578/10000 (95.7800%)
___Train Local_Simple,  epoch  66, local model 64, internal_epoch   1,  Average loss: 0.0009, Accuracy: 799/813 (98.2780%)
___Train Local_Simple,  epoch  66, local model 64, internal_epoch   2,  Average loss: 0.0004, Accuracy: 806/813 (99.1390%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1532, Accuracy: 9438/10000 (94.3800%)
___Train Local_Simple,  epoch  66, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch  66, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0624, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch  66, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch  66, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.1013, Accuracy: 9674/10000 (96.7400%)
time spent on training: 59.994240522384644
Starting performing KrMLRFL...
Num data points: [892, 915, 606, 628, 371, 1227, 379, 813, 448, 1002]
Num selected data points: [892 606 371 813 448]
The chosen ones are users: [0, 2, 4, 7, 8], which are global users: [10, 41, 65, 64, 48]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 45, 81]
base_p: [-0.00246652  0.00028887 -0.00012139 ... -0.00213462 -0.00729279
 -0.00155406]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 6, 9]
layer1_inf_time: 3.769287109375
[PAIRWISE] pred_attackers_indx:  [1 3 5]
layer2_inf_t: 31.511962890625
assumed final_attacker_idxs:  [1 3 5 6 9]
final_attacker_idxs is: [1 3 5 6 9]
g_attacker_idxs: [16 45 81 24 29]
g_normal_idxs: [10 41 65 64 48]
filtered_attacker_idxs: [1, 3, 5, 6, 9]
final_attacker_idxs are: [1, 3, 5, 6, 9]
num_dps: [892, 915, 606, 628, 371, 1227, 379, 813, 448, 1002]
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0408, Accuracy: 9880/10000 (98.8000%)
epoch_acc: 98.8
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 13.8438, Accuracy: 20/8968 (0.2230%)
Done in 67.37856674194336 sec.
Server Epoch:67 choose agents : [43, 96, 61, 70, 67, 8, 68, 93, 30, 71].
___Train Local_Simple,  epoch  67, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch  67, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0524, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch  67, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 664/672 (98.8095%)
___Train Local_Simple,  epoch  67, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1546, Accuracy: 9494/10000 (94.9400%)
poison local model 61 index 0
___PoisonTrain Local_Simple ,  epoch  67, local model 61, internal_epoch   1,  Average loss: 0.0249, Accuracy: 394/699 (56.3662%), train_poison_data_count: 220
class_loss: 4.389540195465088, distance_loss: 0.0
class_loss: 3.0395326614379883, distance_loss: 0.3855842649936676
class_loss: 1.6523276567459106, distance_loss: 0.9323511123657227
class_loss: 1.1952507495880127, distance_loss: 1.3985471725463867
class_loss: 1.0413107872009277, distance_loss: 1.8095786571502686
class_loss: 1.2037051916122437, distance_loss: 2.174564838409424
class_loss: 1.0502793788909912, distance_loss: 2.5106091499328613
class_loss: 1.2504019737243652, distance_loss: 2.816828966140747
class_loss: 0.8901272416114807, distance_loss: 3.098597288131714
class_loss: 0.9392030239105225, distance_loss: 3.349884033203125
class_loss: 0.7817426919937134, distance_loss: 3.5767126083374023
class_loss: 0.9489008188247681, distance_loss: 3.779496431350708
class_loss: 0.8895764350891113, distance_loss: 3.9618115425109863
class_loss: 0.861800491809845, distance_loss: 4.124131202697754
class_loss: 0.849908173084259, distance_loss: 4.267282009124756
class_loss: 0.7210149168968201, distance_loss: 4.396031379699707
class_loss: 0.7312084436416626, distance_loss: 4.512509346008301
class_loss: 0.7183629870414734, distance_loss: 4.617886066436768
class_loss: 0.7212966084480286, distance_loss: 4.713803768157959
class_loss: 0.7324911952018738, distance_loss: 4.800820827484131
___PoisonTrain Local_Simple ,  epoch  67, local model 61, internal_epoch   2,  Average loss: 0.0124, Accuracy: 459/699 (65.6652%), train_poison_data_count: 220
Global model norm: 14.932207135468067.
Norm before scaling: 15.169637591685767. Distance: 5.035471975106699
Total norm for 4 adversaries is: 15.169637591685767. distance: 5.035471975106699
class_loss: 0.8355355262756348, distance_loss: 4.883037567138672
class_loss: 0.6606346964836121, distance_loss: 4.9617919921875
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.8301, Accuracy: 5665/8968 (63.1690%)
poison local model 70 index 1
___PoisonTrain Local_Simple ,  epoch  67, local model 70, internal_epoch   1,  Average loss: 0.0299, Accuracy: 342/724 (47.2376%), train_poison_data_count: 240
class_loss: 4.197235107421875, distance_loss: 0.0
class_loss: 2.8104588985443115, distance_loss: 0.3207579553127289
class_loss: 1.7573806047439575, distance_loss: 0.822138249874115
class_loss: 1.2984775304794312, distance_loss: 1.3214751482009888
class_loss: 1.3383476734161377, distance_loss: 1.7525904178619385
class_loss: 1.4359161853790283, distance_loss: 2.120767831802368
class_loss: 1.4156358242034912, distance_loss: 2.4392709732055664
class_loss: 1.5638580322265625, distance_loss: 2.713987112045288
class_loss: 1.6289149522781372, distance_loss: 2.9506542682647705
class_loss: 1.514847755432129, distance_loss: 3.1585938930511475
class_loss: 1.5118194818496704, distance_loss: 3.3413729667663574
class_loss: 1.1955206394195557, distance_loss: 3.500399112701416
___PoisonTrain Local_Simple ,  epoch  67, local model 70, internal_epoch   2,  Average loss: 0.0176, Accuracy: 363/724 (50.1381%), train_poison_data_count: 240
Global model norm: 14.932207135468067.
Norm before scaling: 15.135398127874199. Distance: 4.7528059852982345
Total norm for 4 adversaries is: 15.135398127874199. distance: 4.7528059852982345
class_loss: 1.2152574062347412, distance_loss: 3.651230812072754
class_loss: 1.336780309677124, distance_loss: 3.789400339126587
class_loss: 1.241368293762207, distance_loss: 3.912254571914673
class_loss: 1.280692458152771, distance_loss: 4.019234657287598
class_loss: 1.0483547449111938, distance_loss: 4.113250732421875
class_loss: 1.0908467769622803, distance_loss: 4.200185775756836
class_loss: 1.0400301218032837, distance_loss: 4.284064292907715
class_loss: 0.8188259601593018, distance_loss: 4.365861415863037
class_loss: 0.8911603093147278, distance_loss: 4.444039344787598
class_loss: 0.8262068629264832, distance_loss: 4.519620418548584
class_loss: 0.8521942496299744, distance_loss: 4.591774940490723
class_loss: 1.0914973020553589, distance_loss: 4.65910530090332
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.5559, Accuracy: 7252/8968 (80.8653%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   1,  Average loss: 0.0005, Accuracy: 984/998 (98.5972%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   2,  Average loss: 0.0009, Accuracy: 978/998 (97.9960%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1912, Accuracy: 9398/10000 (93.9800%)
___Train Local_Simple,  epoch  67, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 624/633 (98.5782%)
___Train Local_Simple,  epoch  67, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 630/633 (99.5261%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0748, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch  67, local model 68, internal_epoch   1,  Average loss: 0.0004, Accuracy: 489/494 (98.9879%)
___Train Local_Simple,  epoch  67, local model 68, internal_epoch   2,  Average loss: 0.0003, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1769, Accuracy: 9478/10000 (94.7800%)
poison local model 93 index 2
___PoisonTrain Local_Simple ,  epoch  67, local model 93, internal_epoch   1,  Average loss: 0.0306, Accuracy: 326/623 (52.3274%), train_poison_data_count: 200
class_loss: 4.423211574554443, distance_loss: 0.0
class_loss: 2.390859603881836, distance_loss: 0.3644932508468628
class_loss: 1.7534466981887817, distance_loss: 0.9552590250968933
class_loss: 1.8281686305999756, distance_loss: 1.3847105503082275
class_loss: 1.51491117477417, distance_loss: 1.7448066473007202
class_loss: 1.502023458480835, distance_loss: 2.0928587913513184
class_loss: 1.504451870918274, distance_loss: 2.4076147079467773
class_loss: 1.4642733335494995, distance_loss: 2.6820240020751953
class_loss: 1.4029990434646606, distance_loss: 2.920793294906616
class_loss: 1.2660629749298096, distance_loss: 3.1353750228881836
class_loss: 0.9341739416122437, distance_loss: 3.336193323135376
class_loss: 1.1957074403762817, distance_loss: 3.524624824523926
class_loss: 0.8879830241203308, distance_loss: 3.69767427444458
class_loss: 1.1041735410690308, distance_loss: 3.859724521636963
___PoisonTrain Local_Simple ,  epoch  67, local model 93, internal_epoch   2,  Average loss: 0.0152, Accuracy: 350/623 (56.1798%), train_poison_data_count: 200
Global model norm: 14.932207135468067.
Norm before scaling: 15.139810672115422. Distance: 4.705404850631836
Total norm for 4 adversaries is: 15.139810672115422. distance: 4.705404850631836
class_loss: 1.1295408010482788, distance_loss: 4.009782791137695
class_loss: 0.8816931247711182, distance_loss: 4.150187015533447
class_loss: 0.9089882373809814, distance_loss: 4.278732776641846
class_loss: 0.6633639931678772, distance_loss: 4.397280216217041
class_loss: 0.8017788529396057, distance_loss: 4.507204055786133
class_loss: 0.9828004240989685, distance_loss: 4.607424259185791
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.8941, Accuracy: 5593/8968 (62.3662%)
___Train Local_Simple,  epoch  67, local model 30, internal_epoch   1,  Average loss: 0.0003, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch  67, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 399/400 (99.7500%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1517, Accuracy: 9512/10000 (95.1200%)
poison local model 71 index 3
___PoisonTrain Local_Simple ,  epoch  67, local model 71, internal_epoch   1,  Average loss: 0.0146, Accuracy: 1042/1384 (75.2890%), train_poison_data_count: 440
class_loss: 4.249474048614502, distance_loss: 0.0
class_loss: 1.7885322570800781, distance_loss: 0.3534449338912964
class_loss: 1.18691885471344, distance_loss: 0.8692954182624817
class_loss: 1.7636456489562988, distance_loss: 1.3114988803863525
class_loss: 1.3799412250518799, distance_loss: 1.615268349647522
class_loss: 1.0573033094406128, distance_loss: 1.9096789360046387
class_loss: 0.9503028392791748, distance_loss: 2.1943819522857666
class_loss: 0.9149562120437622, distance_loss: 2.4634475708007812
class_loss: 0.9556291699409485, distance_loss: 2.7154245376586914
class_loss: 0.9748126268386841, distance_loss: 2.9511570930480957
class_loss: 0.6446528434753418, distance_loss: 3.169996500015259
class_loss: 0.6441137194633484, distance_loss: 3.3784101009368896
class_loss: 0.5733574628829956, distance_loss: 3.572681427001953
class_loss: 0.3952861428260803, distance_loss: 3.7613296508789062
class_loss: 0.2770693600177765, distance_loss: 3.935145378112793
class_loss: 0.30864211916923523, distance_loss: 4.097330093383789
class_loss: 0.33686521649360657, distance_loss: 4.246039867401123
class_loss: 0.4159109592437744, distance_loss: 4.386005401611328
class_loss: 0.2958296239376068, distance_loss: 4.5153303146362305
class_loss: 0.32589948177337646, distance_loss: 4.636108875274658
class_loss: 0.21947970986366272, distance_loss: 4.749026775360107
class_loss: 0.5449885129928589, distance_loss: 4.852120876312256
class_loss: 0.12971195578575134, distance_loss: 4.954823017120361
class_loss: 0.1793513149023056, distance_loss: 5.0489583015441895
class_loss: 0.12526722252368927, distance_loss: 5.1341962814331055
class_loss: 0.13009318709373474, distance_loss: 5.2115797996521
class_loss: 0.12390097975730896, distance_loss: 5.279004096984863
class_loss: 0.19264788925647736, distance_loss: 5.337204933166504
class_loss: 0.05936255678534508, distance_loss: 5.3893723487854
class_loss: 0.03762800991535187, distance_loss: 5.436651706695557
class_loss: 0.09047303348779678, distance_loss: 5.479536056518555
class_loss: 0.14321938157081604, distance_loss: 5.51708459854126
class_loss: 0.19572953879833221, distance_loss: 5.552983283996582
class_loss: 0.11563222855329514, distance_loss: 5.585453033447266
class_loss: 0.11479134112596512, distance_loss: 5.615695476531982
class_loss: 0.03860021010041237, distance_loss: 5.643249988555908
class_loss: 0.09783066809177399, distance_loss: 5.669975280761719
class_loss: 0.05478481203317642, distance_loss: 5.694363594055176
class_loss: 0.20906390249729156, distance_loss: 5.716508388519287
class_loss: 0.046238359063863754, distance_loss: 5.733802318572998
class_loss: 0.03838381916284561, distance_loss: 5.748718738555908
class_loss: 0.044465433806180954, distance_loss: 5.761923789978027
class_loss: 0.12037692964076996, distance_loss: 5.775374412536621
class_loss: 0.03727345168590546, distance_loss: 5.787500858306885
___PoisonTrain Local_Simple ,  epoch  67, local model 71, internal_epoch   2,  Average loss: 0.0017, Accuracy: 1337/1384 (96.6040%), train_poison_data_count: 440
Global model norm: 14.932207135468067.
Norm before scaling: 15.733557944122325. Distance: 5.7992826741686
Total norm for 4 adversaries is: 15.733557944122325. distance: 5.7992826741686
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0774, Accuracy: 8690/8968 (96.9001%)
time spent on training: 64.44406747817993
Starting performing KrMLRFL...
Num data points: [408, 672, 699, 724, 998, 633, 494, 623, 400, 1384]
Num selected data points: [408 672 633 494 400]
The chosen ones are users: [0, 1, 5, 6, 8], which are global users: [43, 96, 8, 68, 30]
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0398, Accuracy: 9873/10000 (98.7300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 70, 93, 71]
base_p: [-0.00206275  0.00057418 -0.00038465 ... -0.00133636 -0.00939938
  0.00098713]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 9]
layer1_inf_time: 2.950927734375
[PAIRWISE] pred_attackers_indx:  [2 3 7 9]
layer2_inf_t: 32.086669921875
assumed final_attacker_idxs:  [2 3 4 7 9]
final_attacker_idxs is: [2 3 4 7 9]
g_attacker_idxs: [61 70 67 93 71]
g_normal_idxs: [43 96  8 68 30]
filtered_attacker_idxs: [2, 3, 4, 7, 9]
final_attacker_idxs are: [2, 3, 4, 7, 9]
num_dps: [408, 672, 699, 724, 998, 633, 494, 623, 400, 1384]
epoch_acc: 98.72999999999999
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 13.4437, Accuracy: 11/8968 (0.1227%)
Done in 70.76647138595581 sec.
Server Epoch:68 choose agents : [77, 32, 80, 30, 53, 41, 13, 49, 17, 31].
___Train Local_Simple,  epoch  68, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 584/589 (99.1511%)
___Train Local_Simple,  epoch  68, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/589 (99.8302%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0492, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0014, Accuracy: 957/977 (97.9529%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   2,  Average loss: 0.0022, Accuracy: 944/977 (96.6223%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3128, Accuracy: 8910/10000 (89.1000%)
___Train Local_Simple,  epoch  68, local model 80, internal_epoch   1,  Average loss: 0.0004, Accuracy: 428/431 (99.3039%)
___Train Local_Simple,  epoch  68, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0802, Accuracy: 9762/10000 (97.6200%)
___Train Local_Simple,  epoch  68, local model 30, internal_epoch   1,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Train Local_Simple,  epoch  68, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0842, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch  68, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch  68, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3976, Accuracy: 8941/10000 (89.4100%)
___Train Local_Simple,  epoch  68, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%)
___Train Local_Simple,  epoch  68, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2065, Accuracy: 9428/10000 (94.2800%)
poison local model 13 index 0
___PoisonTrain Local_Simple ,  epoch  68, local model 13, internal_epoch   1,  Average loss: 0.0254, Accuracy: 408/734 (55.5858%), train_poison_data_count: 240
class_loss: 4.3825459480285645, distance_loss: 0.0
class_loss: 2.2241690158843994, distance_loss: 0.32382509112358093
class_loss: 1.450806736946106, distance_loss: 0.8123994469642639
class_loss: 1.4369657039642334, distance_loss: 1.2309738397598267
class_loss: 1.111485481262207, distance_loss: 1.5815210342407227
class_loss: 1.098258137702942, distance_loss: 1.8908134698867798
class_loss: 1.031954288482666, distance_loss: 2.1667768955230713
class_loss: 1.1076745986938477, distance_loss: 2.422147035598755
class_loss: 1.1979514360427856, distance_loss: 2.654482841491699
class_loss: 1.1634608507156372, distance_loss: 2.864823341369629
class_loss: 1.3175337314605713, distance_loss: 3.0578320026397705
class_loss: 1.1015851497650146, distance_loss: 3.237248659133911
class_loss: 1.1069718599319458, distance_loss: 3.414663791656494
class_loss: 1.1361984014511108, distance_loss: 3.568591356277466
___PoisonTrain Local_Simple ,  epoch  68, local model 13, internal_epoch   2,  Average loss: 0.0163, Accuracy: 371/734 (50.5450%), train_poison_data_count: 240
Global model norm: 14.887652489740397.
Norm before scaling: 14.949255495447392. Distance: 4.536570404922463
Total norm for 2 adversaries is: 14.949255495447392. distance: 4.536570404922463
class_loss: 1.1405988931655884, distance_loss: 3.694605588912964
class_loss: 0.8059824109077454, distance_loss: 3.801884174346924
class_loss: 0.9014790654182434, distance_loss: 3.9009950160980225
class_loss: 1.0588321685791016, distance_loss: 3.9978771209716797
class_loss: 1.100006103515625, distance_loss: 4.08897590637207
class_loss: 1.0431216955184937, distance_loss: 4.173043727874756
class_loss: 0.993802547454834, distance_loss: 4.251407146453857
class_loss: 0.8244011998176575, distance_loss: 4.327208042144775
class_loss: 0.9817848801612854, distance_loss: 4.399394512176514
class_loss: 0.8480045199394226, distance_loss: 4.4658613204956055
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.9116, Accuracy: 6094/8968 (67.9527%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 497/506 (98.2213%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   2,  Average loss: 0.0006, Accuracy: 500/506 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1219, Accuracy: 9601/10000 (96.0100%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  68, local model 17, internal_epoch   1,  Average loss: 0.0334, Accuracy: 300/620 (48.3871%), train_poison_data_count: 200
class_loss: 4.008330821990967, distance_loss: 0.0
class_loss: 3.087794542312622, distance_loss: 0.3133324980735779
class_loss: 1.5464342832565308, distance_loss: 0.8326174020767212
class_loss: 2.04624605178833, distance_loss: 1.3825790882110596
class_loss: 1.8318290710449219, distance_loss: 1.8120275735855103
class_loss: 1.5246301889419556, distance_loss: 2.19608998298645
class_loss: 1.671055555343628, distance_loss: 2.550412654876709
class_loss: 1.7101328372955322, distance_loss: 2.8686773777008057
class_loss: 1.7240716218948364, distance_loss: 3.1497576236724854
class_loss: 1.5383130311965942, distance_loss: 3.3981587886810303
class_loss: 1.4463248252868652, distance_loss: 3.623234987258911
class_loss: 1.1738462448120117, distance_loss: 3.826638698577881
class_loss: 1.2472339868545532, distance_loss: 4.013250350952148
class_loss: 1.0212998390197754, distance_loss: 4.184383392333984
class_loss: 0.9386472702026367, distance_loss: 4.342590808868408
class_loss: 0.9409942030906677, distance_loss: 4.486733913421631
class_loss: 0.9974374175071716, distance_loss: 4.618833541870117
class_loss: 1.2734864950180054, distance_loss: 4.738570690155029
class_loss: 1.0640116930007935, distance_loss: 4.844754219055176
class_loss: 1.0812677145004272, distance_loss: 4.94185209274292
___PoisonTrain Local_Simple ,  epoch  68, local model 17, internal_epoch   2,  Average loss: 0.0180, Accuracy: 322/620 (51.9355%), train_poison_data_count: 200
Global model norm: 14.887652489740397.
Norm before scaling: 15.035146608693973. Distance: 5.0396120703220735
Total norm for 2 adversaries is: 15.035146608693973. distance: 5.0396120703220735
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.9683, Accuracy: 5903/8968 (65.8229%)
___Train Local_Simple,  epoch  68, local model 31, internal_epoch   1,  Average loss: 0.0007, Accuracy: 831/835 (99.5210%)
___Train Local_Simple,  epoch  68, local model 31, internal_epoch   2,  Average loss: 0.0121, Accuracy: 722/835 (86.4671%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.3119, Accuracy: 9042/10000 (90.4200%)
time spent on training: 44.851964235305786
Starting performing KrMLRFL...
Num data points: [589, 977, 431, 400, 739, 606, 734, 506, 620, 835]
Num selected data points: [589 431 400 606 835]
The chosen ones are users: [0, 2, 3, 5, 9], which are global users: [77, 80, 30, 41, 31]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 17]
base_p: [-0.00036906 -0.00035876  0.00199832 ... -0.00013804  0.00209586
  0.00607271]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 7, 8]
layer1_inf_time: 3.339111328125
[PAIRWISE] pred_attackers_indx:  [6 8]
layer2_inf_t: 61.610595703125
assumed final_attacker_idxs:  [1 4 6 7 8]
final_attacker_idxs is: [1 4 6 7 8]
g_attacker_idxs: [32 53 13 49 17]
g_normal_idxs: [77 80 30 41 31]
filtered_attacker_idxs: [1, 4, 6, 7, 8]
final_attacker_idxs are: [1, 4, 6, 7, 8]
num_dps: [589, 977, 431, 400, 739, 606, 734, 506, 620, 835]
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1249, Accuracy: 9717/10000 (97.1700%)
epoch_acc: 97.17
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 9.0613, Accuracy: 43/8968 (0.4795%)
Done in 50.88391590118408 sec.
Server Epoch:69 choose agents : [46, 56, 12, 72, 79, 17, 71, 70, 74, 27].
___Train Local_Simple,  epoch  69, local model 46, internal_epoch   1,  Average loss: 0.0019, Accuracy: 684/710 (96.3380%)
___Train Local_Simple,  epoch  69, local model 46, internal_epoch   2,  Average loss: 0.0032, Accuracy: 672/710 (94.6479%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.7961, Accuracy: 7747/10000 (77.4700%)
___Train Local_Simple,  epoch  69, local model 56, internal_epoch   1,  Average loss: 0.0006, Accuracy: 871/880 (98.9773%)
___Train Local_Simple,  epoch  69, local model 56, internal_epoch   2,  Average loss: 0.0003, Accuracy: 877/880 (99.6591%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2474, Accuracy: 9281/10000 (92.8100%)
___Train Local_Simple,  epoch  69, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1138/1160 (98.1034%)
___Train Local_Simple,  epoch  69, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1152/1160 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2754, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0009, Accuracy: 721/731 (98.6320%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   2,  Average loss: 0.0006, Accuracy: 723/731 (98.9056%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2628, Accuracy: 9242/10000 (92.4200%)
___Train Local_Simple,  epoch  69, local model 79, internal_epoch   1,  Average loss: 0.0018, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch  69, local model 79, internal_epoch   2,  Average loss: 0.0006, Accuracy: 181/182 (99.4505%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1012, Accuracy: 9659/10000 (96.5900%)
poison local model 17 index 0
class_loss: 3.1660149097442627, distance_loss: 0.0
class_loss: 2.466398000717163, distance_loss: 0.26534923911094666
class_loss: 1.5313003063201904, distance_loss: 0.6884670853614807
class_loss: 1.5164101123809814, distance_loss: 1.1263341903686523
class_loss: 1.6703944206237793, distance_loss: 1.4868429899215698
class_loss: 1.599524736404419, distance_loss: 1.7961424589157104
class_loss: 1.4147707223892212, distance_loss: 2.0749027729034424
class_loss: 1.504761815071106, distance_loss: 2.3261499404907227
class_loss: 1.369838833808899, distance_loss: 2.552152633666992
class_loss: 1.2193421125411987, distance_loss: 2.757918357849121
___PoisonTrain Local_Simple ,  epoch  69, local model 17, internal_epoch   1,  Average loss: 0.0282, Accuracy: 325/620 (52.4194%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  69, local model 17, internal_epoch   2,  Average loss: 0.0174, Accuracy: 326/620 (52.5806%), train_poison_data_count: 200
Global model norm: 15.074131696755632.
Norm before scaling: 15.192515106419643. Distance: 4.195650737063546
Total norm for 4 adversaries is: 15.192515106419643. distance: 4.195650737063546
class_loss: 1.2601879835128784, distance_loss: 2.9513638019561768
class_loss: 1.129692554473877, distance_loss: 3.131214141845703
class_loss: 1.1326568126678467, distance_loss: 3.2964632511138916
class_loss: 1.0497533082962036, distance_loss: 3.4494147300720215
class_loss: 1.175045132637024, distance_loss: 3.5871336460113525
class_loss: 1.0956465005874634, distance_loss: 3.7122128009796143
class_loss: 1.07637357711792, distance_loss: 3.8260626792907715
class_loss: 1.0091444253921509, distance_loss: 3.930203914642334
class_loss: 0.9598908424377441, distance_loss: 4.025814056396484
class_loss: 0.8925260901451111, distance_loss: 4.111456394195557
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 1.0493, Accuracy: 5097/8968 (56.8354%)
poison local model 71 index 1
___PoisonTrain Local_Simple ,  epoch  69, local model 71, internal_epoch   1,  Average loss: 0.0170, Accuracy: 831/1384 (60.0434%), train_poison_data_count: 440
___PoisonTrain Local_Simple ,  epoch  69, local model 71, internal_epoch   2,  Average loss: 0.0057, Accuracy: 1182/1384 (85.4046%), train_poison_data_count: 440
Global model norm: 15.074131696755632.
Norm before scaling: 15.597344177318849. Distance: 4.646023779188728
Total norm for 4 adversaries is: 15.597344177318849. distance: 4.646023779188728
class_loss: 2.5923850536346436, distance_loss: 0.0
class_loss: 1.6878105401992798, distance_loss: 0.2104073464870453
class_loss: 1.3813064098358154, distance_loss: 0.5209361910820007
class_loss: 1.2265061140060425, distance_loss: 0.8838551044464111
class_loss: 1.7948871850967407, distance_loss: 1.1473053693771362
class_loss: 1.2721292972564697, distance_loss: 1.3268206119537354
class_loss: 1.1970924139022827, distance_loss: 1.496674656867981
class_loss: 1.0947972536087036, distance_loss: 1.6790367364883423
class_loss: 1.0256366729736328, distance_loss: 1.8603345155715942
class_loss: 0.7868713140487671, distance_loss: 2.037241220474243
class_loss: 0.8687677383422852, distance_loss: 2.2097818851470947
class_loss: 0.7641535997390747, distance_loss: 2.377694606781006
class_loss: 0.9515538215637207, distance_loss: 2.5341129302978516
class_loss: 0.9781008362770081, distance_loss: 2.6763389110565186
class_loss: 0.7480185031890869, distance_loss: 2.7998414039611816
class_loss: 0.7975712418556213, distance_loss: 2.9121267795562744
class_loss: 0.7742919325828552, distance_loss: 3.0156173706054688
class_loss: 0.697527289390564, distance_loss: 3.1069869995117188
class_loss: 0.7654808759689331, distance_loss: 3.1923248767852783
class_loss: 0.6406989097595215, distance_loss: 3.2703728675842285
class_loss: 0.6517666578292847, distance_loss: 3.3480846881866455
class_loss: 0.7636639475822449, distance_loss: 3.421917200088501
class_loss: 0.6605050563812256, distance_loss: 3.5032825469970703
class_loss: 0.8259572982788086, distance_loss: 3.5753700733184814
class_loss: 0.8145902156829834, distance_loss: 3.629561424255371
class_loss: 0.5429019331932068, distance_loss: 3.671030282974243
class_loss: 0.6282971501350403, distance_loss: 3.711632013320923
class_loss: 0.4983524978160858, distance_loss: 3.7526614665985107
class_loss: 0.6616758108139038, distance_loss: 3.7974929809570312
class_loss: 0.5160017609596252, distance_loss: 3.8476195335388184
class_loss: 0.4516648054122925, distance_loss: 3.905102252960205
class_loss: 0.3442521393299103, distance_loss: 3.967738151550293
class_loss: 0.3231689929962158, distance_loss: 4.032979965209961
class_loss: 0.3089636564254761, distance_loss: 4.093621730804443
class_loss: 0.24186581373214722, distance_loss: 4.143759250640869
class_loss: 0.19209320843219757, distance_loss: 4.187626838684082
class_loss: 0.12377355992794037, distance_loss: 4.232000350952148
class_loss: 0.16397710144519806, distance_loss: 4.280213832855225
class_loss: 0.142587348818779, distance_loss: 4.331998348236084
class_loss: 0.2891206443309784, distance_loss: 4.3883490562438965
class_loss: 0.045665547251701355, distance_loss: 4.444450855255127
class_loss: 0.0969080850481987, distance_loss: 4.498769760131836
class_loss: 0.038876891136169434, distance_loss: 4.550859451293945
class_loss: 0.004291057586669922, distance_loss: 4.599682807922363
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0129, Accuracy: 8915/8968 (99.4090%)
poison local model 70 index 2
class_loss: 3.246779203414917, distance_loss: 0.0
class_loss: 1.725881814956665, distance_loss: 0.2648819088935852
class_loss: 1.4336732625961304, distance_loss: 0.6209812164306641
class_loss: 1.135637640953064, distance_loss: 0.969498872756958
class_loss: 1.1747764348983765, distance_loss: 1.249808669090271
class_loss: 1.0398250818252563, distance_loss: 1.4786518812179565
class_loss: 1.1491583585739136, distance_loss: 1.6793981790542603
class_loss: 1.1430915594100952, distance_loss: 1.8533748388290405
class_loss: 1.0969164371490479, distance_loss: 2.002183675765991
class_loss: 0.9749357104301453, distance_loss: 2.1333839893341064
class_loss: 0.9886012673377991, distance_loss: 2.2588565349578857
class_loss: 1.2387243509292603, distance_loss: 2.3758440017700195
___PoisonTrain Local_Simple ,  epoch  69, local model 70, internal_epoch   1,  Average loss: 0.0226, Accuracy: 414/724 (57.1823%), train_poison_data_count: 240
class_loss: 1.6573078632354736, distance_loss: 2.539003610610962
class_loss: 1.4861595630645752, distance_loss: 2.6507275104522705
class_loss: 1.1524958610534668, distance_loss: 2.7266011238098145
class_loss: 0.8242323994636536, distance_loss: 2.7972140312194824
class_loss: 0.8766975402832031, distance_loss: 2.878096103668213
class_loss: 0.8414372801780701, distance_loss: 2.9639365673065186
class_loss: 0.8615269660949707, distance_loss: 3.051213264465332
class_loss: 0.980333685874939, distance_loss: 3.135167121887207
class_loss: 0.8504204154014587, distance_loss: 3.219214677810669
class_loss: 0.810520350933075, distance_loss: 3.3011929988861084
class_loss: 0.7644341588020325, distance_loss: 3.38323712348938
class_loss: 1.2866308689117432, distance_loss: 3.4669249057769775
___PoisonTrain Local_Simple ,  epoch  69, local model 70, internal_epoch   2,  Average loss: 0.0171, Accuracy: 411/724 (56.7680%), train_poison_data_count: 240
Global model norm: 15.074131696755632.
Norm before scaling: 15.245293062820704. Distance: 3.592639652051765
Total norm for 4 adversaries is: 15.245293062820704. distance: 3.592639652051765
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.1406, Accuracy: 8690/8968 (96.9001%)
___Train Local_Simple,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0014, Accuracy: 546/557 (98.0251%)
___Train Local_Simple,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 542/557 (97.3070%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.3595, Accuracy: 8983/10000 (89.8300%)
poison local model 27 index 3
class_loss: 2.143930196762085, distance_loss: 0.0
class_loss: 2.4461746215820312, distance_loss: 0.2033555805683136
class_loss: 1.4550542831420898, distance_loss: 0.5705715417861938
class_loss: 1.4268370866775513, distance_loss: 0.9308505058288574
class_loss: 1.4002816677093506, distance_loss: 1.196616768836975
class_loss: 1.114507794380188, distance_loss: 1.4168895483016968
class_loss: 1.0702037811279297, distance_loss: 1.625915288925171
class_loss: 1.0652259588241577, distance_loss: 1.8255586624145508
___PoisonTrain Local_Simple ,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0257, Accuracy: 279/471 (59.2357%), train_poison_data_count: 160
___PoisonTrain Local_Simple ,  epoch  69, local model 27, internal_epoch   2,  Average loss: 0.0111, Accuracy: 372/471 (78.9809%), train_poison_data_count: 160
Global model norm: 15.074131696755632.
Norm before scaling: 15.217440507702626. Distance: 3.2932503829836524
Total norm for 4 adversaries is: 15.217440507702626. distance: 3.2932503829836524
class_loss: 0.8403008580207825, distance_loss: 2.041206121444702
class_loss: 0.8140614032745361, distance_loss: 2.2408344745635986
class_loss: 0.6757117509841919, distance_loss: 2.424865961074829
class_loss: 0.6587933897972107, distance_loss: 2.5969417095184326
class_loss: 0.6505023837089539, distance_loss: 2.75226092338562
class_loss: 0.4560687839984894, distance_loss: 2.8958840370178223
class_loss: 0.6730504631996155, distance_loss: 3.0331010818481445
class_loss: 0.4370484948158264, distance_loss: 3.1567893028259277
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.2349, Accuracy: 8247/8968 (91.9603%)
time spent on training: 64.87725877761841
Starting performing KrMLRFL...
Num data points: [710, 880, 1160, 731, 182, 620, 1384, 724, 557, 471]
Num selected data points: [ 880 1160  731  182  557]
The chosen ones are users: [1, 2, 3, 4, 8], which are global users: [56, 12, 72, 79, 74]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 71, 70, 27]
base_p: [ 0.00033626  0.00021876 -0.00075098 ... -0.00466523  0.00801063
 -0.00300533]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 7, 9]
layer1_inf_time: 3.274169921875
[PAIRWISE] pred_attackers_indx:  [5 6 7 9]
layer2_inf_t: 40.343017578125
assumed final_attacker_idxs:  [0 5 6 7 9]
final_attacker_idxs is: [0 5 6 7 9]
g_attacker_idxs: [46 17 71 70 27]
g_normal_idxs: [56 12 72 79 74]
filtered_attacker_idxs: [0, 5, 6, 7, 9]
final_attacker_idxs are: [0, 5, 6, 7, 9]
num_dps: [710, 880, 1160, 731, 182, 620, 1384, 724, 557, 471]
epoch_acc: 98.08
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0544, Accuracy: 9808/10000 (98.0800%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 13.7407, Accuracy: 11/8968 (0.1227%)
Done in 69.76402616500854 sec.
Server Epoch:70 choose agents : [4, 49, 74, 6, 16, 59, 46, 66, 84, 63].
___Train Local_Simple,  epoch  70, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 648/658 (98.4802%)
___Train Local_Simple,  epoch  70, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 656/658 (99.6960%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2048, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch  70, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 497/506 (98.2213%)
___Train Local_Simple,  epoch  70, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1123, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 550/557 (98.7433%)
___Train Local_Simple,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 553/557 (99.2819%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0785, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch  70, local model 6, internal_epoch   1,  Average loss: 0.0005, Accuracy: 610/615 (99.1870%)
___Train Local_Simple,  epoch  70, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 611/615 (99.3496%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0966, Accuracy: 9697/10000 (96.9700%)
poison local model 16 index 0
___PoisonTrain Local_Simple ,  epoch  70, local model 16, internal_epoch   1,  Average loss: 0.0274, Accuracy: 466/915 (50.9290%), train_poison_data_count: 299
class_loss: 4.083211421966553, distance_loss: 0.0
class_loss: 2.540757417678833, distance_loss: 0.37122824788093567
class_loss: 2.051591634750366, distance_loss: 0.8742610216140747
class_loss: 1.731652021408081, distance_loss: 1.3373572826385498
class_loss: 1.377676248550415, distance_loss: 1.7537480592727661
class_loss: 1.315536379814148, distance_loss: 2.1401216983795166
class_loss: 1.3327213525772095, distance_loss: 2.4898338317871094
class_loss: 1.4600735902786255, distance_loss: 2.792527437210083
class_loss: 1.4517638683319092, distance_loss: 3.053778648376465
class_loss: 1.4393199682235718, distance_loss: 3.2814040184020996
class_loss: 1.2403262853622437, distance_loss: 3.4816174507141113
class_loss: 1.339089274406433, distance_loss: 3.660611867904663
class_loss: 1.1087921857833862, distance_loss: 3.822840452194214
class_loss: 1.2042871713638306, distance_loss: 3.965728282928467
class_loss: 1.3890743255615234, distance_loss: 4.090358257293701
class_loss: 1.207213282585144, distance_loss: 4.215366363525391
class_loss: 1.2297682762145996, distance_loss: 4.3275532722473145
class_loss: 1.3952487707138062, distance_loss: 4.4174346923828125
class_loss: 1.1176701784133911, distance_loss: 4.496656894683838
class_loss: 1.1915929317474365, distance_loss: 4.572434902191162
class_loss: 1.0485132932662964, distance_loss: 4.645769119262695
class_loss: 0.9573270082473755, distance_loss: 4.7142415046691895
class_loss: 0.9904472231864929, distance_loss: 4.7764201164245605
class_loss: 0.9515916705131531, distance_loss: 4.834052562713623
class_loss: 0.9239044189453125, distance_loss: 4.886269569396973
class_loss: 0.9109740853309631, distance_loss: 4.933160305023193
class_loss: 0.8717966675758362, distance_loss: 4.976761817932129
class_loss: 0.6951519250869751, distance_loss: 5.016505241394043
class_loss: 0.8334655165672302, distance_loss: 5.054530620574951
class_loss: 1.039315104484558, distance_loss: 5.090971946716309
___PoisonTrain Local_Simple ,  epoch  70, local model 16, internal_epoch   2,  Average loss: 0.0168, Accuracy: 500/915 (54.6448%), train_poison_data_count: 299
Global model norm: 15.156775522461276.
Norm before scaling: 15.504962249877204. Distance: 5.139719967468475
Total norm for 2 adversaries is: 15.504962249877204. distance: 5.139719967468475
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 1.1074, Accuracy: 5563/8968 (62.0317%)
___Train Local_Simple,  epoch  70, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 745/760 (98.0263%)
___Train Local_Simple,  epoch  70, local model 59, internal_epoch   2,  Average loss: 0.0009, Accuracy: 750/760 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1540, Accuracy: 9452/10000 (94.5200%)
___Train Local_Simple,  epoch  70, local model 46, internal_epoch   1,  Average loss: 0.0012, Accuracy: 691/710 (97.3239%)
___Train Local_Simple,  epoch  70, local model 46, internal_epoch   2,  Average loss: 0.0008, Accuracy: 702/710 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.2431, Accuracy: 9210/10000 (92.1000%)
___Train Local_Simple,  epoch  70, local model 66, internal_epoch   1,  Average loss: 0.0013, Accuracy: 641/660 (97.1212%)
___Train Local_Simple,  epoch  70, local model 66, internal_epoch   2,  Average loss: 0.0013, Accuracy: 648/660 (98.1818%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.5908, Accuracy: 8291/10000 (82.9100%)
___Train Local_Simple,  epoch  70, local model 84, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1218/1246 (97.7528%)
___Train Local_Simple,  epoch  70, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1233/1246 (98.9567%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0914, Accuracy: 9701/10000 (97.0100%)
poison local model 63 index 1
class_loss: 3.9441025257110596, distance_loss: 0.0
class_loss: 2.474574089050293, distance_loss: 0.32172852754592896
class_loss: 1.8094356060028076, distance_loss: 0.7696759700775146
class_loss: 1.0568623542785645, distance_loss: 1.2691898345947266
class_loss: 1.3012547492980957, distance_loss: 1.68398118019104
class_loss: 1.3576545715332031, distance_loss: 2.035276174545288
class_loss: 1.6098536252975464, distance_loss: 2.3380186557769775
class_loss: 1.3016839027404785, distance_loss: 2.6057069301605225
class_loss: 1.4020904302597046, distance_loss: 2.847081184387207
class_loss: 1.517905831336975, distance_loss: 3.0553243160247803
class_loss: 1.5023633241653442, distance_loss: 3.2322745323181152
class_loss: 1.4515303373336792, distance_loss: 3.38222599029541
class_loss: 1.2318423986434937, distance_loss: 3.511709213256836
class_loss: 1.198952555656433, distance_loss: 3.623690605163574
___PoisonTrain Local_Simple ,  epoch  70, local model 63, internal_epoch   1,  Average loss: 0.0261, Accuracy: 443/889 (49.8313%), train_poison_data_count: 280
___PoisonTrain Local_Simple ,  epoch  70, local model 63, internal_epoch   2,  Average loss: 0.0133, Accuracy: 544/889 (61.1924%), train_poison_data_count: 280
Global model norm: 15.156775522461276.
Norm before scaling: 15.418052872205271. Distance: 4.622722580514267
Total norm for 2 adversaries is: 15.418052872205271. distance: 4.622722580514267
class_loss: 0.9696238040924072, distance_loss: 3.7249648571014404
class_loss: 1.0553964376449585, distance_loss: 3.8179712295532227
class_loss: 1.02024507522583, distance_loss: 3.9062962532043457
class_loss: 0.6926306486129761, distance_loss: 3.9883689880371094
class_loss: 0.9922229051589966, distance_loss: 4.065273761749268
class_loss: 0.8108708262443542, distance_loss: 4.136585712432861
class_loss: 1.0488511323928833, distance_loss: 4.20475435256958
class_loss: 0.8949936032295227, distance_loss: 4.268034934997559
class_loss: 0.7332236766815186, distance_loss: 4.327182769775391
class_loss: 0.8196372985839844, distance_loss: 4.382718086242676
class_loss: 0.7286474108695984, distance_loss: 4.433821678161621
class_loss: 0.8650283813476562, distance_loss: 4.482470989227295
class_loss: 0.5766764283180237, distance_loss: 4.52808952331543
class_loss: 0.6018329858779907, distance_loss: 4.573029518127441
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 1.0480, Accuracy: 5062/8968 (56.4451%)
time spent on training: 53.940834522247314
Starting performing KrMLRFL...
Num data points: [658, 506, 557, 615, 915, 760, 710, 660, 1246, 889]
Num selected data points: [658 506 557 615 660]
The chosen ones are users: [0, 1, 2, 3, 7], which are global users: [4, 49, 74, 6, 66]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 63]
base_p: [ 7.1060658e-04  1.7097965e-04 -6.3053798e-05 ... -3.7957206e-03
 -4.7261268e-03 -4.3293238e-03]
[T_SCORE] attacker_local_idxs is:  [4, 5, 6, 8, 9]
layer1_inf_time: 4.223388671875
[PAIRWISE] pred_attackers_indx:  [4 9]
layer2_inf_t: 39.53857421875
assumed final_attacker_idxs:  [4 5 6 8 9]
final_attacker_idxs is: [4 5 6 8 9]
g_attacker_idxs: [16 59 46 84 63]
g_normal_idxs: [ 4 49 74  6 66]
filtered_attacker_idxs: [4, 5, 6, 8, 9]
final_attacker_idxs are: [4, 5, 6, 8, 9]
num_dps: [658, 506, 557, 615, 915, 760, 710, 660, 1246, 889]
epoch_acc: 98.32
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0541, Accuracy: 9832/10000 (98.3200%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 12.5976, Accuracy: 20/8968 (0.2230%)
Done in 60.18090105056763 sec.
Server Epoch:71 choose agents : [23, 92, 22, 91, 70, 58, 35, 12, 55, 94].
___Train Local_Simple,  epoch  71, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 289/293 (98.6348%)
___Train Local_Simple,  epoch  71, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 288/293 (98.2935%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0805, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch  71, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch  71, local model 92, internal_epoch   2,  Average loss: 0.0007, Accuracy: 925/937 (98.7193%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1324, Accuracy: 9591/10000 (95.9100%)
poison local model 22 index 0
___Train Local_Simple,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0013, Accuracy: 568/583 (97.4271%)
___Train Local_Simple,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0005, Accuracy: 579/583 (99.3139%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1145, Accuracy: 9657/10000 (96.5700%)
poison local model 91 index 1
___Train Local_Simple,  epoch  71, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch  71, local model 91, internal_epoch   2,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0693, Accuracy: 9780/10000 (97.8000%)
poison local model 70 index 2
___Train Local_Simple,  epoch  71, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 705/724 (97.3757%)
___Train Local_Simple,  epoch  71, local model 70, internal_epoch   2,  Average loss: 0.0010, Accuracy: 714/724 (98.6188%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1415, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0009, Accuracy: 270/276 (97.8261%)
___Train Local_Simple,  epoch  71, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 274/276 (99.2754%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1141, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch  71, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 496/499 (99.3988%)
___Train Local_Simple,  epoch  71, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1117, Accuracy: 9642/10000 (96.4200%)
___Train Local_Simple,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1136/1160 (97.9310%)
___Train Local_Simple,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1145/1160 (98.7069%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.3689, Accuracy: 9127/10000 (91.2700%)
___Train Local_Simple,  epoch  71, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 346/354 (97.7401%)
___Train Local_Simple,  epoch  71, local model 55, internal_epoch   2,  Average loss: 0.0009, Accuracy: 351/354 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.4957, Accuracy: 8465/10000 (84.6500%)
___Train Local_Simple,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0008, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1980, Accuracy: 9372/10000 (93.7200%)
time spent on training: 43.65465688705444
Starting performing KrMLRFL...
Num data points: [293, 937, 583, 256, 724, 276, 499, 1160, 354, 150]
Num selected data points: [293 276 499 354 150]
The chosen ones are users: [0, 5, 6, 8, 9], which are global users: [23, 58, 35, 55, 94]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 91, 70]
base_p: [ 0.00053535  0.00025812 -0.00042722 ... -0.00164689  0.00332247
 -0.00060651]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 7]
layer1_inf_time: 3.340087890625
[PAIRWISE] pred_attackers_indx:  [7 8]
layer2_inf_t: 74.18798828125
assumed final_attacker_idxs:  [1 2 3 4 7 8]
final_attacker_idxs is: [1 2 3 4 7 8]
g_attacker_idxs: [92 22 91 70 12 55]
g_normal_idxs: [23 58 35 94]
filtered_attacker_idxs: [1, 2, 3, 4, 7]
final_attacker_idxs are: [1, 2, 3, 4, 7]
num_dps: [293, 937, 583, 256, 724, 276, 499, 1160, 354, 150]
epoch_acc: 98.27
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0572, Accuracy: 9827/10000 (98.2700%)
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 12.6170, Accuracy: 42/8968 (0.4683%)
Done in 48.31335234642029 sec.
Server Epoch:72 choose agents : [60, 54, 79, 77, 63, 99, 67, 88, 28, 37].
___Train Local_Simple,  epoch  72, local model 60, internal_epoch   1,  Average loss: 0.0014, Accuracy: 328/338 (97.0414%)
___Train Local_Simple,  epoch  72, local model 60, internal_epoch   2,  Average loss: 0.0004, Accuracy: 336/338 (99.4083%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1487, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0007, Accuracy: 512/519 (98.6513%)
___Train Local_Simple,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0005, Accuracy: 513/519 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0973, Accuracy: 9679/10000 (96.7900%)
___Train Local_Simple,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0010, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0003, Accuracy: 181/182 (99.4505%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0627, Accuracy: 9805/10000 (98.0500%)
___Train Local_Simple,  epoch  72, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 579/589 (98.3022%)
___Train Local_Simple,  epoch  72, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 587/589 (99.6604%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0606, Accuracy: 9821/10000 (98.2100%)
poison local model 63 index 0
___Train Local_Simple,  epoch  72, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 867/889 (97.5253%)
___Train Local_Simple,  epoch  72, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 877/889 (98.6502%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0901, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch  72, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 373/377 (98.9390%)
___Train Local_Simple,  epoch  72, local model 99, internal_epoch   2,  Average loss: 0.0003, Accuracy: 374/377 (99.2042%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0565, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch  72, local model 67, internal_epoch   1,  Average loss: 0.0008, Accuracy: 986/998 (98.7976%)
___Train Local_Simple,  epoch  72, local model 67, internal_epoch   2,  Average loss: 0.0005, Accuracy: 991/998 (99.2986%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1077, Accuracy: 9657/10000 (96.5700%)
___Train Local_Simple,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0005, Accuracy: 525/530 (99.0566%)
___Train Local_Simple,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0001, Accuracy: 529/530 (99.8113%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1139, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch  72, local model 28, internal_epoch   1,  Average loss: 0.0005, Accuracy: 497/501 (99.2016%)
___Train Local_Simple,  epoch  72, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 499/501 (99.6008%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0744, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch  72, local model 37, internal_epoch   1,  Average loss: 0.0003, Accuracy: 854/860 (99.3023%)
___Train Local_Simple,  epoch  72, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 858/860 (99.7674%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0962, Accuracy: 9710/10000 (97.1000%)
time spent on training: 36.9952495098114
Starting performing KrMLRFL...
Num data points: [338, 519, 182, 589, 889, 377, 998, 530, 501, 860]
Num selected data points: [519 182 377 530 501 860]
The chosen ones are users: [1, 2, 5, 7, 8, 9], which are global users: [54, 79, 99, 88, 28, 37]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63]
base_p: [ 0.00043046  0.00031568 -0.0001361  ... -0.0016162  -0.00234824
 -0.00061402]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 9]
layer1_inf_time: 3.723388671875
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 36.122314453125
assumed final_attacker_idxs:  [0 3 4 6 9]
final_attacker_idxs is: [0 3 4 6 9]
g_attacker_idxs: [60 77 63 67 37]
g_normal_idxs: [54 79 99 88 28]
filtered_attacker_idxs: [0, 3, 4, 6]
final_attacker_idxs are: [0, 3, 4, 6]
num_dps: [338, 519, 182, 589, 889, 377, 998, 530, 501, 860]
epoch_acc: 98.34
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0492, Accuracy: 9834/10000 (98.3400%)
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 12.9065, Accuracy: 40/8968 (0.4460%)
Done in 41.46379470825195 sec.
Server Epoch:73 choose agents : [4, 88, 6, 99, 49, 69, 66, 79, 36, 64].
___Train Local_Simple,  epoch  73, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch  73, local model 4, internal_epoch   2,  Average loss: 0.0011, Accuracy: 643/658 (97.7204%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1367, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch  73, local model 88, internal_epoch   1,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch  73, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0732, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch  73, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 613/615 (99.6748%)
___Train Local_Simple,  epoch  73, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0807, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0490, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch  73, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%)
___Train Local_Simple,  epoch  73, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0767, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch  73, local model 69, internal_epoch   1,  Average loss: 0.0013, Accuracy: 250/256 (97.6562%)
___Train Local_Simple,  epoch  73, local model 69, internal_epoch   2,  Average loss: 0.0004, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1231, Accuracy: 9569/10000 (95.6900%)
___Train Local_Simple,  epoch  73, local model 66, internal_epoch   1,  Average loss: 0.0008, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch  73, local model 66, internal_epoch   2,  Average loss: 0.0004, Accuracy: 655/660 (99.2424%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.2321, Accuracy: 9277/10000 (92.7700%)
___Train Local_Simple,  epoch  73, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 177/182 (97.2527%)
___Train Local_Simple,  epoch  73, local model 79, internal_epoch   2,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0616, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 989/1005 (98.4080%)
___Train Local_Simple,  epoch  73, local model 36, internal_epoch   2,  Average loss: 0.0010, Accuracy: 982/1005 (97.7114%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1728, Accuracy: 9449/10000 (94.4900%)
___Train Local_Simple,  epoch  73, local model 64, internal_epoch   1,  Average loss: 0.0009, Accuracy: 798/813 (98.1550%)
___Train Local_Simple,  epoch  73, local model 64, internal_epoch   2,  Average loss: 0.0003, Accuracy: 809/813 (99.5080%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1673, Accuracy: 9452/10000 (94.5200%)
time spent on training: 30.379457712173462
Starting performing KrMLRFL...
Num data points: [658, 530, 615, 377, 506, 256, 660, 182, 1005, 813]
Num selected data points: [530 615 377 506 256 182 813]
The chosen ones are users: [1, 2, 3, 4, 5, 7, 9], which are global users: [88, 6, 99, 49, 69, 79, 64]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [ 1.7968565e-04  3.0527264e-04  1.5622936e-05 ... -3.3967197e-04
 -1.9860119e-03 -7.2427839e-04]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 8, 9]
layer1_inf_time: 3.258544921875
[PAIRWISE] pred_attackers_indx:  [1 3 8]
layer2_inf_t: 87.72265625
assumed final_attacker_idxs:  [0 1 3 5 6 8 9]
final_attacker_idxs is: [0 1 3 5 6 8 9]
g_attacker_idxs: [ 4 88 99 69 66 36 64]
g_normal_idxs: [ 6 49 79]
filtered_attacker_idxs: [0, 6, 8]
final_attacker_idxs are: [0, 6, 8]
num_dps: [658, 530, 615, 377, 506, 256, 660, 182, 1005, 813]
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0438, Accuracy: 9861/10000 (98.6100%)
epoch_acc: 98.61
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 13.6746, Accuracy: 13/8968 (0.1450%)
Done in 35.55638265609741 sec.
Server Epoch:74 choose agents : [33, 90, 7, 26, 13, 51, 24, 40, 35, 98].
___Train Local_Simple,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0011, Accuracy: 613/623 (98.3949%)
___Train Local_Simple,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 604/623 (96.9502%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.0868, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch  74, local model 90, internal_epoch   1,  Average loss: 0.0007, Accuracy: 673/683 (98.5359%)
___Train Local_Simple,  epoch  74, local model 90, internal_epoch   2,  Average loss: 0.0004, Accuracy: 679/683 (99.4143%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.6382, Accuracy: 8604/10000 (86.0400%)
poison local model 7 index 0
___Train Local_Simple,  epoch  74, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 410/418 (98.0861%)
___Train Local_Simple,  epoch  74, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1200, Accuracy: 9619/10000 (96.1900%)
poison local model 26 index 1
___Train Local_Simple,  epoch  74, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 549/554 (99.0975%)
___Train Local_Simple,  epoch  74, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.0806, Accuracy: 9757/10000 (97.5700%)
poison local model 13 index 2
___Train Local_Simple,  epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%)
___Train Local_Simple,  epoch  74, local model 13, internal_epoch   2,  Average loss: 0.0005, Accuracy: 728/734 (99.1826%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1533, Accuracy: 9537/10000 (95.3700%)
poison local model 51 index 3
___Train Local_Simple,  epoch  74, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch  74, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1602, Accuracy: 9475/10000 (94.7500%)
___Train Local_Simple,  epoch  74, local model 24, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/379 (98.1530%)
___Train Local_Simple,  epoch  74, local model 24, internal_epoch   2,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1007, Accuracy: 9694/10000 (96.9400%)
___Train Local_Simple,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0010, Accuracy: 766/772 (99.2228%)
___Train Local_Simple,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0028, Accuracy: 736/772 (95.3368%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.2849, Accuracy: 9196/10000 (91.9600%)
___Train Local_Simple,  epoch  74, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch  74, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.0751, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch  74, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 806/818 (98.5330%)
___Train Local_Simple,  epoch  74, local model 98, internal_epoch   2,  Average loss: 0.0004, Accuracy: 812/818 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1865, Accuracy: 9464/10000 (94.6400%)
time spent on training: 57.748096227645874
Starting performing KrMLRFL...
Num data points: [623, 683, 418, 554, 734, 568, 379, 772, 499, 818]
Num selected data points: [623 683 379 499 818]
The chosen ones are users: [0, 1, 6, 8, 9], which are global users: [33, 90, 24, 35, 98]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 26, 13, 51]
base_p: [ 6.0644001e-04  1.6168877e-04 -2.2945926e-05 ... -9.7438693e-05
 -1.3118833e-02  9.6961856e-05]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 7]
layer1_inf_time: 2.88037109375
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 189.622314453125
assumed final_attacker_idxs:  [2 3 4 5 7]
final_attacker_idxs is: [2 3 4 5 7]
g_attacker_idxs: [ 7 26 13 51 40]
g_normal_idxs: [33 90 24 35 98]
filtered_attacker_idxs: [2, 3, 4, 5, 7]
final_attacker_idxs are: [2, 3, 4, 5, 7]
num_dps: [623, 683, 418, 554, 734, 568, 379, 772, 499, 818]
epoch_acc: 98.42999999999999
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.0473, Accuracy: 9843/10000 (98.4300%)
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 14.4685, Accuracy: 3/8968 (0.0335%)
Done in 66.96911716461182 sec.
Server Epoch:75 choose agents : [46, 27, 26, 85, 41, 77, 52, 61, 3, 82].
___Train Local_Simple,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0008, Accuracy: 693/710 (97.6056%)
___Train Local_Simple,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 704/710 (99.1549%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1011, Accuracy: 9676/10000 (96.7600%)
poison local model 27 index 0
___Train Local_Simple,  epoch  75, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 466/471 (98.9384%)
___Train Local_Simple,  epoch  75, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 469/471 (99.5754%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1442, Accuracy: 9518/10000 (95.1800%)
poison local model 26 index 1
___Train Local_Simple,  epoch  75, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 546/554 (98.5560%)
___Train Local_Simple,  epoch  75, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1236, Accuracy: 9605/10000 (96.0500%)
poison local model 85 index 2
___Train Local_Simple,  epoch  75, local model 85, internal_epoch   1,  Average loss: 0.0005, Accuracy: 428/431 (99.3039%)
___Train Local_Simple,  epoch  75, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1509, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  75, local model 41, internal_epoch   1,  Average loss: 0.0006, Accuracy: 596/606 (98.3498%)
___Train Local_Simple,  epoch  75, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.2934, Accuracy: 9216/10000 (92.1600%)
___Train Local_Simple,  epoch  75, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 581/589 (98.6418%)
___Train Local_Simple,  epoch  75, local model 77, internal_epoch   2,  Average loss: 0.0017, Accuracy: 574/589 (97.4533%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1353, Accuracy: 9558/10000 (95.5800%)
poison local model 52 index 3
___Train Local_Simple,  epoch  75, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch  75, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.0828, Accuracy: 9746/10000 (97.4600%)
poison local model 61 index 0
___Train Local_Simple,  epoch  75, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 689/699 (98.5694%)
___Train Local_Simple,  epoch  75, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 696/699 (99.5708%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.3777, Accuracy: 8845/10000 (88.4500%)
___Train Local_Simple,  epoch  75, local model 3, internal_epoch   1,  Average loss: 0.0009, Accuracy: 906/923 (98.1582%)
___Train Local_Simple,  epoch  75, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 915/923 (99.1333%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1293, Accuracy: 9567/10000 (95.6700%)
___Train Local_Simple,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.4219, Accuracy: 8898/10000 (88.9800%)
time spent on training: 57.04437208175659
Starting performing KrMLRFL...
Num data points: [710, 471, 554, 431, 606, 589, 253, 699, 923, 713]
Num selected data points: [710 923 713]
The chosen ones are users: [0, 8, 9], which are global users: [46, 3, 82]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 26, 85, 52, 61]
base_p: [ 0.0004694   0.00025726  0.00018608 ... -0.00265561  0.00046398
 -0.00218049]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 6, 7]
layer1_inf_time: 3.716552734375
[PAIRWISE] pred_attackers_indx:  [3 4 5 7]
layer2_inf_t: 132.231689453125
assumed final_attacker_idxs:  [1 2 3 4 5 6 7]
final_attacker_idxs is: [1 2 3 4 5 6 7]
g_attacker_idxs: [27 26 85 41 77 52 61]
g_normal_idxs: [46  3 82]
filtered_attacker_idxs: [1, 2, 3, 4, 5, 6, 7]
final_attacker_idxs are: [1, 2, 3, 4, 5, 6, 7]
num_dps: [710, 471, 554, 431, 606, 589, 253, 699, 923, 713]
epoch_acc: 97.47
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.0764, Accuracy: 9747/10000 (97.4700%)
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 12.8475, Accuracy: 7/8968 (0.0781%)
Done in 64.27977633476257 sec.
Server Epoch:76 choose agents : [78, 9, 54, 62, 26, 53, 28, 22, 94, 70].
___Train Local_Simple,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 297/303 (98.0198%)
___Train Local_Simple,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0002, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1588, Accuracy: 9490/10000 (94.9000%)
___Train Local_Simple,  epoch  76, local model 9, internal_epoch   1,  Average loss: 0.0004, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch  76, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 432/436 (99.0826%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0600, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch  76, local model 54, internal_epoch   1,  Average loss: 0.0005, Accuracy: 513/519 (98.8439%)
___Train Local_Simple,  epoch  76, local model 54, internal_epoch   2,  Average loss: 0.0009, Accuracy: 510/519 (98.2659%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1090, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  76, local model 62, internal_epoch   1,  Average loss: 0.0007, Accuracy: 418/423 (98.8180%)
___Train Local_Simple,  epoch  76, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0669, Accuracy: 9792/10000 (97.9200%)
poison local model 26 index 0
___Train Local_Simple,  epoch  76, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 548/554 (98.9170%)
___Train Local_Simple,  epoch  76, local model 26, internal_epoch   2,  Average loss: 0.0008, Accuracy: 547/554 (98.7365%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0595, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 729/739 (98.6468%)
___Train Local_Simple,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.2262, Accuracy: 9290/10000 (92.9000%)
___Train Local_Simple,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 497/501 (99.2016%)
___Train Local_Simple,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0007, Accuracy: 496/501 (99.0020%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0762, Accuracy: 9765/10000 (97.6500%)
poison local model 22 index 1
___Train Local_Simple,  epoch  76, local model 22, internal_epoch   1,  Average loss: 0.0016, Accuracy: 570/583 (97.7702%)
___Train Local_Simple,  epoch  76, local model 22, internal_epoch   2,  Average loss: 0.0013, Accuracy: 564/583 (96.7410%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1673, Accuracy: 9521/10000 (95.2100%)
___Train Local_Simple,  epoch  76, local model 94, internal_epoch   1,  Average loss: 0.0018, Accuracy: 147/150 (98.0000%)
___Train Local_Simple,  epoch  76, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.5938, Accuracy: 8713/10000 (87.1300%)
poison local model 70 index 2
___Train Local_Simple,  epoch  76, local model 70, internal_epoch   1,  Average loss: 0.0012, Accuracy: 706/724 (97.5138%)
___Train Local_Simple,  epoch  76, local model 70, internal_epoch   2,  Average loss: 0.0005, Accuracy: 717/724 (99.0331%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1068, Accuracy: 9681/10000 (96.8100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 22, 70]
base_p: [-0.00013026  0.00025146  0.00016083 ...  0.00011481  0.0017003
 -0.00113517]
[T_SCORE] attacker_local_idxs is:  [4, 5, 6, 7, 9]
layer1_inf_time: 3.02099609375
[PAIRWISE] pred_attackers_indx:  [7 9]
layer2_inf_t: 61.2939453125
assumed final_attacker_idxs:  [4 5 6 7 9]
final_attacker_idxs is: [4 5 6 7 9]
g_attacker_idxs: [26 53 28 22 70]
g_normal_idxs: [78  9 54 62 94]
filtered_attacker_idxs: [4, 5, 7, 9]
final_attacker_idxs are: [4, 5, 7, 9]
num_dps: [303, 436, 519, 423, 554, 739, 501, 583, 150, 724]
time spent on training: 48.211827754974365
Starting performing KrMLRFL...
Num data points: [303, 436, 519, 423, 554, 739, 501, 583, 150, 724]
Num selected data points: [303 436 519 423 501 150]
The chosen ones are users: [0, 1, 2, 3, 6, 8], which are global users: [78, 9, 54, 62, 28, 94]
epoch_acc: 98.83
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0365, Accuracy: 9883/10000 (98.8300%)
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 13.1713, Accuracy: 11/8968 (0.1227%)
Done in 54.73751974105835 sec.
Server Epoch:77 choose agents : [68, 69, 90, 8, 66, 70, 0, 14, 40, 45].
___Train Local_Simple,  epoch  77, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 489/494 (98.9879%)
___Train Local_Simple,  epoch  77, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.0689, Accuracy: 9781/10000 (97.8100%)
___Train Local_Simple,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1006, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch  77, local model 90, internal_epoch   1,  Average loss: 0.0004, Accuracy: 676/683 (98.9751%)
___Train Local_Simple,  epoch  77, local model 90, internal_epoch   2,  Average loss: 0.0003, Accuracy: 681/683 (99.7072%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.5882, Accuracy: 8520/10000 (85.2000%)
___Train Local_Simple,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 629/633 (99.3681%)
___Train Local_Simple,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1192, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  77, local model 66, internal_epoch   1,  Average loss: 0.0005, Accuracy: 654/660 (99.0909%)
___Train Local_Simple,  epoch  77, local model 66, internal_epoch   2,  Average loss: 0.0002, Accuracy: 659/660 (99.8485%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1266, Accuracy: 9581/10000 (95.8100%)
poison local model 70 index 0
___Train Local_Simple,  epoch  77, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 713/724 (98.4807%)
___Train Local_Simple,  epoch  77, local model 70, internal_epoch   2,  Average loss: 0.0003, Accuracy: 722/724 (99.7238%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1358, Accuracy: 9578/10000 (95.7800%)
___Train Local_Simple,  epoch  77, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 427/435 (98.1609%)
___Train Local_Simple,  epoch  77, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1508, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  77, local model 14, internal_epoch   1,  Average loss: 0.0006, Accuracy: 370/376 (98.4043%)
___Train Local_Simple,  epoch  77, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1320, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0009, Accuracy: 764/772 (98.9637%)
___Train Local_Simple,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0102, Accuracy: 660/772 (85.4922%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.5659, Accuracy: 7767/10000 (77.6700%)
poison local model 45 index 1
___Train Local_Simple,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 621/628 (98.8854%)
___Train Local_Simple,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 622/628 (99.0446%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1550, Accuracy: 9524/10000 (95.2400%)
time spent on training: 44.36174821853638
Starting performing KrMLRFL...
Num data points: [494, 256, 683, 633, 660, 724, 435, 376, 772, 628]
Num selected data points: [494 256 683 633 435 376]
The chosen ones are users: [0, 1, 2, 3, 6, 7], which are global users: [68, 69, 90, 8, 0, 14]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 45]
base_p: [ 0.00050422  0.00026317  0.00028086 ... -0.00280078 -0.00262547
 -0.00263771]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 8, 9]
layer1_inf_time: 3.57275390625
[PAIRWISE] pred_attackers_indx:  [8]
layer2_inf_t: 36.484619140625
assumed final_attacker_idxs:  [1 4 5 8 9]
final_attacker_idxs is: [1 4 5 8 9]
g_attacker_idxs: [69 66 70 40 45]
g_normal_idxs: [68 90  8  0 14]
filtered_attacker_idxs: [4, 5, 8, 9]
final_attacker_idxs are: [4, 5, 8, 9]
num_dps: [494, 256, 683, 633, 660, 724, 435, 376, 772, 628]
epoch_acc: 98.7
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.0413, Accuracy: 9870/10000 (98.7000%)
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 13.0853, Accuracy: 14/8968 (0.1561%)
Done in 51.166468143463135 sec.
Server Epoch:78 choose agents : [23, 19, 72, 15, 37, 80, 27, 95, 1, 46].
___Train Local_Simple,  epoch  78, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch  78, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0704, Accuracy: 9771/10000 (97.7100%)
___Train Local_Simple,  epoch  78, local model 19, internal_epoch   1,  Average loss: 0.0002, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch  78, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0596, Accuracy: 9804/10000 (98.0400%)
___Train Local_Simple,  epoch  78, local model 72, internal_epoch   1,  Average loss: 0.0005, Accuracy: 723/731 (98.9056%)
___Train Local_Simple,  epoch  78, local model 72, internal_epoch   2,  Average loss: 0.0004, Accuracy: 726/731 (99.3160%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1765, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  78, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 395/401 (98.5037%)
___Train Local_Simple,  epoch  78, local model 15, internal_epoch   2,  Average loss: 0.0004, Accuracy: 398/401 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1070, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  78, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%)
___Train Local_Simple,  epoch  78, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 859/860 (99.8837%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0842, Accuracy: 9726/10000 (97.2600%)
___Train Local_Simple,  epoch  78, local model 80, internal_epoch   1,  Average loss: 0.0005, Accuracy: 427/431 (99.0719%)
___Train Local_Simple,  epoch  78, local model 80, internal_epoch   2,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1323, Accuracy: 9614/10000 (96.1400%)
poison local model 27 index 0
___Train Local_Simple,  epoch  78, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch  78, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1154, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  78, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch  78, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 1.2789, Accuracy: 7624/10000 (76.2400%)
poison local model 1 index 1
___Train Local_Simple,  epoch  78, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch  78, local model 1, internal_epoch   2,  Average loss: 0.0003, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0965, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  78, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch  78, local model 46, internal_epoch   2,  Average loss: 0.0002, Accuracy: 707/710 (99.5775%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1626, Accuracy: 9503/10000 (95.0300%)
time spent on training: 40.97596073150635
Starting performing KrMLRFL...
Num data points: [293, 205, 731, 401, 860, 431, 471, 602, 760, 710]
Num selected data points: [293 205 731 401 860 431]
The chosen ones are users: [0, 1, 2, 3, 4, 5], which are global users: [23, 19, 72, 15, 37, 80]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 1]
base_p: [-3.4272671e-05  2.7900934e-04  1.1447631e-04 ... -3.1396747e-04
 -1.8529668e-03 -1.5345886e-03]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 5.113037109375
[PAIRWISE] pred_attackers_indx:  [2 3 5 6 8 9]
layer2_inf_t: 149.662353515625
assumed final_attacker_idxs:  [2 3 5 6 7 8 9]
final_attacker_idxs is: [2 3 5 6 7 8 9]
g_attacker_idxs: [72 15 80 27 95  1 46]
g_normal_idxs: [23 19 37]
filtered_attacker_idxs: [6, 7, 8, 9]
final_attacker_idxs are: [6, 7, 8, 9]
num_dps: [293, 205, 731, 401, 860, 431, 471, 602, 760, 710]
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0378, Accuracy: 9874/10000 (98.7400%)
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 13.0177, Accuracy: 23/8968 (0.2565%)
Done in 50.01287341117859 sec.
Server Epoch:79 choose agents : [54, 97, 77, 68, 98, 52, 78, 88, 45, 95].
___Train Local_Simple,  epoch  79, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 516/519 (99.4220%)
___Train Local_Simple,  epoch  79, local model 54, internal_epoch   2,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0875, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch  79, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 484/487 (99.3840%)
___Train Local_Simple,  epoch  79, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1870, Accuracy: 9448/10000 (94.4800%)
___Train Local_Simple,  epoch  79, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch  79, local model 77, internal_epoch   2,  Average loss: 0.0009, Accuracy: 579/589 (98.3022%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1498, Accuracy: 9476/10000 (94.7600%)
___Train Local_Simple,  epoch  79, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch  79, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0561, Accuracy: 9821/10000 (98.2100%)
___Train Local_Simple,  epoch  79, local model 98, internal_epoch   1,  Average loss: 0.0004, Accuracy: 810/818 (99.0220%)
___Train Local_Simple,  epoch  79, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 814/818 (99.5110%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.2533, Accuracy: 9338/10000 (93.3800%)
poison local model 52 index 0
___Train Local_Simple,  epoch  79, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch  79, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0953, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  79, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 299/303 (98.6799%)
___Train Local_Simple,  epoch  79, local model 78, internal_epoch   2,  Average loss: 0.0002, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1504, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch  79, local model 88, internal_epoch   1,  Average loss: 0.0002, Accuracy: 527/530 (99.4340%)
___Train Local_Simple,  epoch  79, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0892, Accuracy: 9703/10000 (97.0300%)
poison local model 45 index 1
___Train Local_Simple,  epoch  79, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch  79, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1471, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  79, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Train Local_Simple,  epoch  79, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 45]
base_p: [ 0.00055268  0.0002411   0.00035248 ... -0.00179654  0.0056657
  0.00252214]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 8, 9]
layer1_inf_time: 4.426513671875
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1908, Accuracy: 9366/10000 (93.6600%)
time spent on training: 72.92904281616211
Starting performing KrMLRFL...
Num data points: [519, 487, 589, 494, 818, 253, 303, 530, 628, 602]
Num selected data points: [519 487 494 303 530]
The chosen ones are users: [0, 1, 3, 6, 7], which are global users: [54, 97, 68, 78, 88]
[PAIRWISE] pred_attackers_indx:  [0 1 2 3 6 7 9]
layer2_inf_t: 279.9306640625
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 8 9]
g_attacker_idxs: [54 97 77 68 98 52 78 88 45 95]
g_normal_idxs: []
filtered_attacker_idxs: [2, 4, 5, 8, 9]
final_attacker_idxs are: [2, 4, 5, 8, 9]
num_dps: [519, 487, 589, 494, 818, 253, 303, 530, 628, 602]
epoch_acc: 98.48
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0425, Accuracy: 9848/10000 (98.4800%)
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 13.9016, Accuracy: 17/8968 (0.1896%)
Done in 79.95950245857239 sec.
Server Epoch:80 choose agents : [42, 38, 63, 31, 47, 12, 77, 37, 23, 83].
poison local model 42 index 0
___Train Local_Simple,  epoch  80, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch  80, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0475, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch  80, local model 38, internal_epoch   1,  Average loss: 0.0007, Accuracy: 880/895 (98.3240%)
___Train Local_Simple,  epoch  80, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1319, Accuracy: 9599/10000 (95.9900%)
poison local model 63 index 1
___Train Local_Simple,  epoch  80, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 863/889 (97.0754%)
___Train Local_Simple,  epoch  80, local model 63, internal_epoch   2,  Average loss: 0.0012, Accuracy: 870/889 (97.8628%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1016, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 831/835 (99.5210%)
___Train Local_Simple,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 833/835 (99.7605%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0766, Accuracy: 9768/10000 (97.6800%)
___Train Local_Simple,  epoch  80, local model 47, internal_epoch   1,  Average loss: 0.0003, Accuracy: 769/776 (99.0979%)
___Train Local_Simple,  epoch  80, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1733, Accuracy: 9461/10000 (94.6100%)
___Train Local_Simple,  epoch  80, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1152/1160 (99.3103%)
___Train Local_Simple,  epoch  80, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1148/1160 (98.9655%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1577, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  80, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 580/589 (98.4720%)
___Train Local_Simple,  epoch  80, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 579/589 (98.3022%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0668, Accuracy: 9804/10000 (98.0400%)
___Train Local_Simple,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0003, Accuracy: 856/860 (99.5349%)
___Train Local_Simple,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0006, Accuracy: 854/860 (99.3023%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0903, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  80, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch  80, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1492, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  80, local model 83, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch  80, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 432/433 (99.7691%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 63]
base_p: [ 0.00282317  0.0003726  -0.00044224 ... -0.00070654 -0.0030062
 -0.00019321]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 6]
layer1_inf_time: 4.9033203125
[PAIRWISE] pred_attackers_indx:  [1 2 4]
layer2_inf_t: 46.74658203125
assumed final_attacker_idxs:  [0 1 2 4 5 6]
final_attacker_idxs is: [0 1 2 4 5 6]
g_attacker_idxs: [42 38 63 47 12 77]
g_normal_idxs: [31 37 23 83]
filtered_attacker_idxs: [0, 2, 4, 5, 6]
final_attacker_idxs are: [0, 2, 4, 5, 6]
num_dps: [236, 895, 889, 835, 776, 1160, 589, 860, 293, 433]
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0686, Accuracy: 9779/10000 (97.7900%)
time spent on training: 64.66854953765869
Starting performing KrMLRFL...
Num data points: [236, 895, 889, 835, 776, 1160, 589, 860, 293, 433]
Num selected data points: [895 835 860 293 433]
The chosen ones are users: [1, 3, 7, 8, 9], which are global users: [38, 31, 37, 23, 83]
epoch_acc: 98.66
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0407, Accuracy: 9866/10000 (98.6600%)
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 14.1692, Accuracy: 10/8968 (0.1115%)
Done in 71.37058115005493 sec.
Server Epoch:81 choose agents : [94, 48, 35, 79, 29, 17, 27, 1, 41, 25].
___Train Local_Simple,  epoch  81, local model 94, internal_epoch   1,  Average loss: 0.0014, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  81, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1879, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  81, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 444/448 (99.1071%)
___Train Local_Simple,  epoch  81, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0784, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0800, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  81, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch  81, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0427, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0004, Accuracy: 994/1002 (99.2016%)
___Train Local_Simple,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0901, Accuracy: 9718/10000 (97.1800%)
poison local model 17 index 0
___Train Local_Simple,  epoch  81, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 606/620 (97.7419%)
___Train Local_Simple,  epoch  81, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 613/620 (98.8710%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1282, Accuracy: 9636/10000 (96.3600%)
poison local model 27 index 1
___Train Local_Simple,  epoch  81, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 462/471 (98.0892%)
___Train Local_Simple,  epoch  81, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.3337, Accuracy: 9274/10000 (92.7400%)
poison local model 1 index 2
___Train Local_Simple,  epoch  81, local model 1, internal_epoch   1,  Average loss: 0.0010, Accuracy: 743/760 (97.7632%)
___Train Local_Simple,  epoch  81, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 748/760 (98.4211%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.3079, Accuracy: 8967/10000 (89.6700%)
___Train Local_Simple,  epoch  81, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%)
___Train Local_Simple,  epoch  81, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1153, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch  81, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%)
___Train Local_Simple,  epoch  81, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1356, Accuracy: 9566/10000 (95.6600%)
time spent on training: 44.149096727371216
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 27, 1]
base_p: [ 0.00047063  0.00027735 -0.00074829 ... -0.00084722  0.0009886
  0.00147241]
[T_SCORE] attacker_local_idxs is:  [4, 5, 6, 7, 9]
layer1_inf_time: 3.062255859375
[PAIRWISE] pred_attackers_indx:  [5 6 7]
layer2_inf_t: 136.265625
assumed final_attacker_idxs:  [4 5 6 7 9]
final_attacker_idxs is: [4 5 6 7 9]
g_attacker_idxs: [29 17 27  1 25]
g_normal_idxs: [94 48 35 79 41]
filtered_attacker_idxs: [4, 5, 6, 7, 9]
final_attacker_idxs are: [4, 5, 6, 7, 9]
num_dps: [150, 448, 499, 182, 1002, 620, 471, 760, 606, 647]
epoch_acc: 98.3
Num data points: [150, 448, 499, 182, 1002, 620, 471, 760, 606, 647]
Num selected data points: [150 448 499 182 606]
The chosen ones are users: [0, 1, 2, 3, 8], which are global users: [94, 48, 35, 79, 41]
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0491, Accuracy: 9830/10000 (98.3000%)
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 13.1305, Accuracy: 43/8968 (0.4795%)
Done in 53.13337016105652 sec.
Server Epoch:82 choose agents : [26, 77, 17, 61, 14, 0, 73, 94, 96, 25].
poison local model 26 index 0
___Train Local_Simple,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1782, Accuracy: 9460/10000 (94.6000%)
___Train Local_Simple,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 586/589 (99.4907%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0484, Accuracy: 9853/10000 (98.5300%)
poison local model 17 index 1
___Train Local_Simple,  epoch  82, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 605/620 (97.5806%)
___Train Local_Simple,  epoch  82, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 612/620 (98.7097%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1475, Accuracy: 9562/10000 (95.6200%)
poison local model 61 index 2
___Train Local_Simple,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 687/699 (98.2833%)
___Train Local_Simple,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0008, Accuracy: 685/699 (97.9971%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.3225, Accuracy: 9048/10000 (90.4800%)
___Train Local_Simple,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0004, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0856, Accuracy: 9760/10000 (97.6000%)
___Train Local_Simple,  epoch  82, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 429/435 (98.6207%)
___Train Local_Simple,  epoch  82, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0915, Accuracy: 9714/10000 (97.1400%)
poison local model 73 index 3
___Train Local_Simple,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0011, Accuracy: 584/591 (98.8156%)
___Train Local_Simple,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0024, Accuracy: 564/591 (95.4315%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.3620, Accuracy: 8771/10000 (87.7100%)
___Train Local_Simple,  epoch  82, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  82, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1175, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 664/672 (98.8095%)
___Train Local_Simple,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0005, Accuracy: 664/672 (98.8095%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1745, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch  82, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 642/647 (99.2272%)
___Train Local_Simple,  epoch  82, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 642/647 (99.2272%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1622, Accuracy: 9446/10000 (94.4600%)
time spent on training: 50.86915636062622
Starting performing KrMLRFL...
Num data points: [554, 589, 620, 699, 376, 435, 591, 150, 672, 647]
Num selected data points: [376 435 150 672 647]
The chosen ones are users: [4, 5, 7, 8, 9], which are global users: [14, 0, 94, 96, 25]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 17, 61, 73]
base_p: [ 2.9563904e-05  3.4147501e-04  4.1707419e-04 ... -2.0223707e-03
  2.7504414e-03  1.0158792e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 6]
layer1_inf_time: 2.77783203125
[PAIRWISE] pred_attackers_indx:  [2 6]
layer2_inf_t: 30.529541015625
assumed final_attacker_idxs:  [0 1 2 3 6]
final_attacker_idxs is: [0 1 2 3 6]
g_attacker_idxs: [26 77 17 61 73]
g_normal_idxs: [14  0 94 96 25]
filtered_attacker_idxs: [0, 1, 2, 3, 6]
final_attacker_idxs are: [0, 1, 2, 3, 6]
num_dps: [554, 589, 620, 699, 376, 435, 591, 150, 672, 647]
epoch_acc: 98.46000000000001
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0484, Accuracy: 9846/10000 (98.4600%)
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 11.3185, Accuracy: 66/8968 (0.7360%)
Done in 58.28211307525635 sec.
Server Epoch:83 choose agents : [55, 99, 45, 50, 70, 11, 57, 98, 58, 43].
___Train Local_Simple,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0011, Accuracy: 347/354 (98.0226%)
___Train Local_Simple,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.3663, Accuracy: 8891/10000 (88.9100%)
___Train Local_Simple,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0004, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0382, Accuracy: 9878/10000 (98.7800%)
poison local model 45 index 0
___Train Local_Simple,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 617/628 (98.2484%)
___Train Local_Simple,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 622/628 (99.0446%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1292, Accuracy: 9600/10000 (96.0000%)
___Train Local_Simple,  epoch  83, local model 50, internal_epoch   1,  Average loss: 0.0010, Accuracy: 468/474 (98.7342%)
___Train Local_Simple,  epoch  83, local model 50, internal_epoch   2,  Average loss: 0.0008, Accuracy: 467/474 (98.5232%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0936, Accuracy: 9693/10000 (96.9300%)
poison local model 70 index 1
___Train Local_Simple,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 709/724 (97.9282%)
___Train Local_Simple,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0004, Accuracy: 719/724 (99.3094%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2165, Accuracy: 9342/10000 (93.4200%)
poison local model 11 index 2
___Train Local_Simple,  epoch  83, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 634/645 (98.2946%)
___Train Local_Simple,  epoch  83, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 640/645 (99.2248%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2116, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch  83, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 339/343 (98.8338%)
___Train Local_Simple,  epoch  83, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 341/343 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0924, Accuracy: 9717/10000 (97.1700%)
___Train Local_Simple,  epoch  83, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 806/818 (98.5330%)
___Train Local_Simple,  epoch  83, local model 98, internal_epoch   2,  Average loss: 0.0004, Accuracy: 815/818 (99.6333%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1962, Accuracy: 9426/10000 (94.2600%)
___Train Local_Simple,  epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 272/276 (98.5507%)
___Train Local_Simple,  epoch  83, local model 58, internal_epoch   2,  Average loss: 0.0003, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1144, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch  83, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch  83, local model 43, internal_epoch   2,  Average loss: 0.0004, Accuracy: 403/408 (98.7745%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 70, 11]
base_p: [ 0.0003572   0.00024274  0.00101365 ... -0.00268579 -0.00301107
  0.00042203]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 7]
layer1_inf_time: 2.856689453125
[PAIRWISE] pred_attackers_indx:  [0 2 4 5 7]
layer2_inf_t: 29.790283203125
assumed final_attacker_idxs:  [0 2 4 5 7]
final_attacker_idxs is: [0 2 4 5 7]
g_attacker_idxs: [55 45 70 11 98]
g_normal_idxs: [99 50 57 58 43]
filtered_attacker_idxs: [2, 4, 5, 7]
final_attacker_idxs are: [2, 4, 5, 7]
num_dps: [354, 377, 628, 474, 724, 645, 343, 818, 276, 408]
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0533, Accuracy: 9826/10000 (98.2600%)
time spent on training: 45.591758012771606
Starting performing KrMLRFL...
Num data points: [354, 377, 628, 474, 724, 645, 343, 818, 276, 408]
Num selected data points: [354 377 474 343 276 408]
The chosen ones are users: [0, 1, 3, 6, 8, 9], which are global users: [55, 99, 50, 57, 58, 43]
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0372, Accuracy: 9873/10000 (98.7300%)
epoch_acc: 98.72999999999999
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 12.4065, Accuracy: 13/8968 (0.1450%)
Done in 52.34052634239197 sec.
Server Epoch:84 choose agents : [42, 11, 89, 50, 55, 83, 51, 21, 0, 79].
poison local model 42 index 0
___Train Local_Simple,  epoch  84, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch  84, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0442, Accuracy: 9853/10000 (98.5300%)
poison local model 11 index 1
___Train Local_Simple,  epoch  84, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 637/645 (98.7597%)
___Train Local_Simple,  epoch  84, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 642/645 (99.5349%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.1519, Accuracy: 9526/10000 (95.2600%)
___Train Local_Simple,  epoch  84, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch  84, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0631, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch  84, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch  84, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0708, Accuracy: 9759/10000 (97.5900%)
___Train Local_Simple,  epoch  84, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch  84, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.1466, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch  84, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch  84, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0387, Accuracy: 9873/10000 (98.7300%)
poison local model 51 index 2
___Train Local_Simple,  epoch  84, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%)
___Train Local_Simple,  epoch  84, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0936, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  84, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 309/312 (99.0385%)
___Train Local_Simple,  epoch  84, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0905, Accuracy: 9696/10000 (96.9600%)
___Train Local_Simple,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0004, Accuracy: 432/435 (99.3103%)
___Train Local_Simple,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0932, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  84, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch  84, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0392, Accuracy: 9879/10000 (98.7900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 11, 51]
base_p: [ 2.5760382e-04  1.8332526e-04 -4.0170737e-05 ... -2.1105707e-03
 -3.9734766e-03  6.3923746e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 6, 8]
layer1_inf_time: 4.2490234375
[PAIRWISE] pred_attackers_indx:  [1 6 8]
layer2_inf_t: 349.987060546875
assumed final_attacker_idxs:  [0 1 4 6 8]
final_attacker_idxs is: [0 1 4 6 8]
g_attacker_idxs: [42 11 55 51  0]
g_normal_idxs: [89 50 83 21 79]
filtered_attacker_idxs: [0, 1, 6]
final_attacker_idxs are: [0, 1, 6]
num_dps: [236, 645, 492, 474, 354, 433, 568, 312, 435, 182]
time spent on training: 45.19801688194275
Starting performing KrMLRFL...
Num data points: [236, 645, 492, 474, 354, 433, 568, 312, 435, 182]
Num selected data points: [492 474 354 433 312 435 182]
The chosen ones are users: [2, 3, 4, 5, 7, 8, 9], which are global users: [89, 50, 55, 83, 21, 0, 79]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0363, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 13.2030, Accuracy: 20/8968 (0.2230%)
Done in 50.97304892539978 sec.
Server Epoch:85 choose agents : [7, 65, 20, 13, 16, 67, 55, 61, 24, 46].
poison local model 7 index 0
___Train Local_Simple,  epoch  85, local model 7, internal_epoch   1,  Average loss: 0.0008, Accuracy: 411/418 (98.3254%)
___Train Local_Simple,  epoch  85, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.2377, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 368/371 (99.1914%)
___Train Local_Simple,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0567, Accuracy: 9815/10000 (98.1500%)
poison local model 20 index 1
___Train Local_Simple,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 421/429 (98.1352%)
___Train Local_Simple,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0002, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1807, Accuracy: 9465/10000 (94.6500%)
poison local model 13 index 2
___Train Local_Simple,  epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0004, Accuracy: 724/734 (98.6376%)
___Train Local_Simple,  epoch  85, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1027, Accuracy: 9685/10000 (96.8500%)
poison local model 16 index 3
___Train Local_Simple,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 905/915 (98.9071%)
___Train Local_Simple,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 910/915 (99.4536%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0776, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch  85, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 991/998 (99.2986%)
___Train Local_Simple,  epoch  85, local model 67, internal_epoch   2,  Average loss: 0.0008, Accuracy: 979/998 (98.0962%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1021, Accuracy: 9683/10000 (96.8300%)
___Train Local_Simple,  epoch  85, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch  85, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.2450, Accuracy: 9204/10000 (92.0400%)
poison local model 61 index 0
___Train Local_Simple,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0006, Accuracy: 693/699 (99.1416%)
___Train Local_Simple,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0003, Accuracy: 696/699 (99.5708%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1806, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch  85, local model 24, internal_epoch   1,  Average loss: 0.0008, Accuracy: 373/379 (98.4169%)
___Train Local_Simple,  epoch  85, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0763, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch  85, local model 46, internal_epoch   1,  Average loss: 0.0003, Accuracy: 706/710 (99.4366%)
___Train Local_Simple,  epoch  85, local model 46, internal_epoch   2,  Average loss: 0.0001, Accuracy: 710/710 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 20, 13, 16, 61]
base_p: [ 0.00062902  0.00026833  0.00038921 ... -0.00417301 -0.00087076
 -0.00130726]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 7, 9]
layer1_inf_time: 3.98291015625
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1066, Accuracy: 9655/10000 (96.5500%)
time spent on training: 58.77434539794922
Starting performing KrMLRFL...
Num data points: [418, 371, 429, 734, 915, 998, 354, 699, 379, 710]
Num selected data points: [371 998 354 379]
The chosen ones are users: [1, 5, 6, 8], which are global users: [65, 67, 55, 24]
[PAIRWISE] pred_attackers_indx:  [0 2 3 4]
layer2_inf_t: 167.900634765625
assumed final_attacker_idxs:  [0 2 3 4 7 9]
final_attacker_idxs is: [0 2 3 4 7 9]
g_attacker_idxs: [ 7 20 13 16 61 46]
g_normal_idxs: [65 67 55 24]
filtered_attacker_idxs: [0, 2, 3, 4, 7, 9]
final_attacker_idxs are: [0, 2, 3, 4, 7, 9]
num_dps: [418, 371, 429, 734, 915, 998, 354, 699, 379, 710]
epoch_acc: 98.38
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0496, Accuracy: 9838/10000 (98.3800%)
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 13.4780, Accuracy: 13/8968 (0.1450%)
Done in 67.79075741767883 sec.
Server Epoch:86 choose agents : [85, 65, 12, 51, 68, 15, 75, 90, 26, 71].
poison local model 85 index 0
___Train Local_Simple,  epoch  86, local model 85, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch  86, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0713, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch  86, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch  86, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0431, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch  86, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1145/1160 (98.7069%)
___Train Local_Simple,  epoch  86, local model 12, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1153/1160 (99.3966%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1403, Accuracy: 9600/10000 (96.0000%)
poison local model 51 index 1
___Train Local_Simple,  epoch  86, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 559/568 (98.4155%)
___Train Local_Simple,  epoch  86, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0958, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0004, Accuracy: 491/494 (99.3927%)
___Train Local_Simple,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1055, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0008, Accuracy: 396/401 (98.7531%)
___Train Local_Simple,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0005, Accuracy: 398/401 (99.2519%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1629, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  86, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch  86, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0771, Accuracy: 9740/10000 (97.4000%)
___Train Local_Simple,  epoch  86, local model 90, internal_epoch   1,  Average loss: 0.0003, Accuracy: 678/683 (99.2679%)
___Train Local_Simple,  epoch  86, local model 90, internal_epoch   2,  Average loss: 0.0004, Accuracy: 677/683 (99.1215%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.5566, Accuracy: 8442/10000 (84.4200%)
poison local model 26 index 2
___Train Local_Simple,  epoch  86, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 548/554 (98.9170%)
___Train Local_Simple,  epoch  86, local model 26, internal_epoch   2,  Average loss: 0.0008, Accuracy: 545/554 (98.3755%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.3891, Accuracy: 9108/10000 (91.0800%)
poison local model 71 index 3
___Train Local_Simple,  epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1370/1384 (98.9884%)
___Train Local_Simple,  epoch  86, local model 71, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1363/1384 (98.4827%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.2883, Accuracy: 9067/10000 (90.6700%)
time spent on training: 52.260294675827026
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 51, 26, 71]
base_p: [-8.5927546e-05  2.8633699e-04 -5.6195538e-04 ...  8.4288418e-04
  3.4739077e-04  2.0898879e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 8, 9]
layer1_inf_time: 3.062744140625
[PAIRWISE] pred_attackers_indx:  [9]
layer2_inf_t: 30.39697265625
assumed final_attacker_idxs:  [0 2 3 8 9]
final_attacker_idxs is: [0 2 3 8 9]
g_attacker_idxs: [85 12 51 26 71]
g_normal_idxs: [65 68 15 75 90]
filtered_attacker_idxs: [0, 2, 3, 8, 9]
final_attacker_idxs are: [0, 2, 3, 8, 9]
num_dps: [431, 371, 1160, 568, 494, 401, 686, 683, 554, 1384]
Starting performing KrMLRFL...
Num data points: [431, 371, 1160, 568, 494, 401, 686, 683, 554, 1384]
Num selected data points: [371 494 401 686 683]
The chosen ones are users: [1, 4, 5, 6, 7], which are global users: [65, 68, 15, 75, 90]
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0457, Accuracy: 9848/10000 (98.4800%)
epoch_acc: 98.48
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 14.3252, Accuracy: 10/8968 (0.1115%)
Done in 60.114113569259644 sec.
Server Epoch:87 choose agents : [57, 55, 95, 96, 74, 18, 53, 39, 52, 60].
___Train Local_Simple,  epoch  87, local model 57, internal_epoch   1,  Average loss: 0.0012, Accuracy: 337/343 (98.2507%)
___Train Local_Simple,  epoch  87, local model 57, internal_epoch   2,  Average loss: 0.0006, Accuracy: 338/343 (98.5423%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1503, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch  87, local model 55, internal_epoch   1,  Average loss: 0.0007, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch  87, local model 55, internal_epoch   2,  Average loss: 0.0003, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2411, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 597/602 (99.1694%)
___Train Local_Simple,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0003, Accuracy: 597/602 (99.1694%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.9339, Accuracy: 7849/10000 (78.4900%)
___Train Local_Simple,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0005, Accuracy: 667/672 (99.2560%)
___Train Local_Simple,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 671/672 (99.8512%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2055, Accuracy: 9334/10000 (93.3400%)
___Train Local_Simple,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%)
___Train Local_Simple,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0609, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch  87, local model 18, internal_epoch   1,  Average loss: 0.0010, Accuracy: 449/459 (97.8214%)
___Train Local_Simple,  epoch  87, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1104, Accuracy: 9610/10000 (96.1000%)
___Train Local_Simple,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2717, Accuracy: 9198/10000 (91.9800%)
___Train Local_Simple,  epoch  87, local model 39, internal_epoch   1,  Average loss: 0.0008, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  87, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0678, Accuracy: 9778/10000 (97.7800%)
poison local model 52 index 0
___Train Local_Simple,  epoch  87, local model 52, internal_epoch   1,  Average loss: 0.0012, Accuracy: 245/253 (96.8379%)
___Train Local_Simple,  epoch  87, local model 52, internal_epoch   2,  Average loss: 0.0006, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0947, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 332/338 (98.2249%)
___Train Local_Simple,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0004, Accuracy: 336/338 (99.4083%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0794, Accuracy: 9754/10000 (97.5400%)
time spent on training: 35.68849229812622
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00030223  0.00026346  0.00182403 ... -0.00246345 -0.00529853
 -0.00190378]
[T_SCORE] attacker_local_idxs is:  [2, 3, 6, 8, 9]
layer1_inf_time: 4.20458984375
[PAIRWISE] pred_attackers_indx:  [0 1 2 4 6]
layer2_inf_t: 482.8388671875
assumed final_attacker_idxs:  [0 1 2 3 4 6 8 9]
final_attacker_idxs is: [0 1 2 3 4 6 8 9]
g_attacker_idxs: [57 55 95 96 74 53 52 60]
g_normal_idxs: [18 39]
filtered_attacker_idxs: [2, 3, 6, 8, 9]
final_attacker_idxs are: [2, 3, 6, 8, 9]
num_dps: [343, 354, 602, 672, 557, 459, 739, 257, 253, 338]
Num data points: [343, 354, 602, 672, 557, 459, 739, 257, 253, 338]
Num selected data points: [343 354 557 459 257]
The chosen ones are users: [0, 1, 4, 5, 7], which are global users: [57, 55, 74, 18, 39]
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0399, Accuracy: 9879/10000 (98.7900%)
epoch_acc: 98.79
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 12.6975, Accuracy: 36/8968 (0.4014%)
Done in 41.87031316757202 sec.
Server Epoch:88 choose agents : [43, 49, 84, 46, 1, 11, 5, 7, 3, 45].
___Train Local_Simple,  epoch  88, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch  88, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.0427, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 502/506 (99.2095%)
___Train Local_Simple,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.0807, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch  88, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1224/1246 (98.2343%)
___Train Local_Simple,  epoch  88, local model 84, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1234/1246 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1150, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0004, Accuracy: 704/710 (99.1549%)
___Train Local_Simple,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0001, Accuracy: 709/710 (99.8592%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1401, Accuracy: 9556/10000 (95.5600%)
poison local model 1 index 0
___Train Local_Simple,  epoch  88, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 747/760 (98.2895%)
___Train Local_Simple,  epoch  88, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.3735, Accuracy: 8835/10000 (88.3500%)
poison local model 11 index 1
___Train Local_Simple,  epoch  88, local model 11, internal_epoch   1,  Average loss: 0.0012, Accuracy: 635/645 (98.4496%)
___Train Local_Simple,  epoch  88, local model 11, internal_epoch   2,  Average loss: 0.0050, Accuracy: 583/645 (90.3876%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.3447, Accuracy: 8925/10000 (89.2500%)
___Train Local_Simple,  epoch  88, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/434 (99.0783%)
___Train Local_Simple,  epoch  88, local model 5, internal_epoch   2,  Average loss: 0.0005, Accuracy: 431/434 (99.3088%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1663, Accuracy: 9359/10000 (93.5900%)
poison local model 7 index 2
___Train Local_Simple,  epoch  88, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 410/418 (98.0861%)
___Train Local_Simple,  epoch  88, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2111, Accuracy: 9376/10000 (93.7600%)
___Train Local_Simple,  epoch  88, local model 3, internal_epoch   1,  Average loss: 0.0004, Accuracy: 913/923 (98.9166%)
___Train Local_Simple,  epoch  88, local model 3, internal_epoch   2,  Average loss: 0.0001, Accuracy: 921/923 (99.7833%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1064, Accuracy: 9692/10000 (96.9200%)
poison local model 45 index 3
___Train Local_Simple,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 618/628 (98.4076%)
___Train Local_Simple,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0007, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.2238, Accuracy: 9268/10000 (92.6800%)
time spent on training: 48.17541432380676
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 11, 7, 45]
base_p: [ 0.00105363  0.00022895 -0.00082592 ... -0.00366826 -0.00443009
  0.00372823]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 7, 9]
layer1_inf_time: 3.297607421875
[PAIRWISE] pred_attackers_indx:  [4 5 7 9]
layer2_inf_t: 38.44189453125
assumed final_attacker_idxs:  [3 4 5 7 9]
final_attacker_idxs is: [3 4 5 7 9]
g_attacker_idxs: [46  1 11  7 45]
g_normal_idxs: [43 49 84  5  3]
filtered_attacker_idxs: [3, 4, 5, 7, 9]
final_attacker_idxs are: [3, 4, 5, 7, 9]
num_dps: [408, 506, 1246, 710, 760, 645, 434, 418, 923, 628]
Starting performing KrMLRFL...
Num data points: [408, 506, 1246, 710, 760, 645, 434, 418, 923, 628]
Num selected data points: [ 408  506 1246  434  923]
The chosen ones are users: [0, 1, 2, 6, 8], which are global users: [43, 49, 84, 5, 3]
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.0413, Accuracy: 9868/10000 (98.6800%)
epoch_acc: 98.68
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 15.4907, Accuracy: 4/8968 (0.0446%)
Done in 55.922457695007324 sec.
Server Epoch:89 choose agents : [54, 29, 4, 38, 52, 86, 28, 34, 15, 75].
___Train Local_Simple,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 515/519 (99.2293%)
___Train Local_Simple,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0005, Accuracy: 515/519 (99.2293%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1152, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch  89, local model 29, internal_epoch   1,  Average loss: 0.0005, Accuracy: 989/1002 (98.7026%)
___Train Local_Simple,  epoch  89, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 991/1002 (98.9022%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1643, Accuracy: 9462/10000 (94.6200%)
___Train Local_Simple,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 650/658 (98.7842%)
___Train Local_Simple,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 655/658 (99.5441%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1676, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch  89, local model 38, internal_epoch   1,  Average loss: 0.0004, Accuracy: 887/895 (99.1061%)
___Train Local_Simple,  epoch  89, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 891/895 (99.5531%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1114, Accuracy: 9631/10000 (96.3100%)
poison local model 52 index 0
___Train Local_Simple,  epoch  89, local model 52, internal_epoch   1,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Train Local_Simple,  epoch  89, local model 52, internal_epoch   2,  Average loss: 0.0000, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0652, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch  89, local model 86, internal_epoch   1,  Average loss: 0.0003, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch  89, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0910, Accuracy: 9737/10000 (97.3700%)
___Train Local_Simple,  epoch  89, local model 28, internal_epoch   1,  Average loss: 0.0003, Accuracy: 497/501 (99.2016%)
___Train Local_Simple,  epoch  89, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0510, Accuracy: 9841/10000 (98.4100%)
poison local model 34 index 1
___Train Local_Simple,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0004, Accuracy: 409/413 (99.0315%)
___Train Local_Simple,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1662, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  89, local model 15, internal_epoch   1,  Average loss: 0.0003, Accuracy: 400/401 (99.7506%)
___Train Local_Simple,  epoch  89, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0487, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch  89, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch  89, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0490, Accuracy: 9853/10000 (98.5300%)
time spent on training: 40.05158519744873
Starting performing KrMLRFL...
Num data points: [519, 1002, 658, 895, 253, 250, 501, 413, 401, 686]
Num selected data points: [ 519 1002  895  250  501  401  686]
The chosen ones are users: [0, 1, 3, 5, 6, 8, 9], which are global users: [54, 29, 38, 86, 28, 15, 75]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 34]
base_p: [ 0.0001172   0.00027727  0.00046114 ... -0.00200769  0.00163957
  0.0006717 ]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 8]
layer1_inf_time: 2.82861328125
[PAIRWISE] pred_attackers_indx:  [2 3]
layer2_inf_t: 35.063232421875
assumed final_attacker_idxs:  [2 3 4 7 8]
final_attacker_idxs is: [2 3 4 7 8]
g_attacker_idxs: [ 4 38 52 34 15]
g_normal_idxs: [54 29 86 28 75]
filtered_attacker_idxs: [2, 4, 7]
final_attacker_idxs are: [2, 4, 7]
num_dps: [519, 1002, 658, 895, 253, 250, 501, 413, 401, 686]
epoch_acc: 98.68
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0395, Accuracy: 9868/10000 (98.6800%)
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 14.4368, Accuracy: 8/8968 (0.0892%)
Done in 45.4613082408905 sec.
Server Epoch:90 choose agents : [66, 24, 28, 36, 54, 92, 27, 46, 29, 52].
___Train Local_Simple,  epoch  90, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch  90, local model 66, internal_epoch   2,  Average loss: 0.0001, Accuracy: 658/660 (99.6970%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1029, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0007, Accuracy: 372/379 (98.1530%)
___Train Local_Simple,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0750, Accuracy: 9762/10000 (97.6200%)
___Train Local_Simple,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0423, Accuracy: 9872/10000 (98.7200%)
___Train Local_Simple,  epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 994/1005 (98.9055%)
___Train Local_Simple,  epoch  90, local model 36, internal_epoch   2,  Average loss: 0.0004, Accuracy: 994/1005 (98.9055%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1295, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch  90, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch  90, local model 54, internal_epoch   2,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0886, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 929/937 (99.1462%)
___Train Local_Simple,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0001, Accuracy: 937/937 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1921, Accuracy: 9358/10000 (93.5800%)
poison local model 27 index 0
___Train Local_Simple,  epoch  90, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 466/471 (98.9384%)
___Train Local_Simple,  epoch  90, local model 27, internal_epoch   2,  Average loss: 0.0002, Accuracy: 470/471 (99.7877%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1497, Accuracy: 9489/10000 (94.8900%)
___Train Local_Simple,  epoch  90, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch  90, local model 46, internal_epoch   2,  Average loss: 0.0002, Accuracy: 708/710 (99.7183%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1552, Accuracy: 9516/10000 (95.1600%)
___Train Local_Simple,  epoch  90, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch  90, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0738, Accuracy: 9781/10000 (97.8100%)
poison local model 52 index 1
___Train Local_Simple,  epoch  90, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 247/253 (97.6285%)
___Train Local_Simple,  epoch  90, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1251, Accuracy: 9644/10000 (96.4400%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 52]
base_p: [ 0.00062374  0.00083852  0.00138776 ... -0.0029971  -0.0015268
 -0.00109707]
[T_SCORE] attacker_local_idxs is:  [3, 5, 6, 7, 9]
layer1_inf_time: 3.009033203125
[PAIRWISE] pred_attackers_indx:  [0 3 6 9]
layer2_inf_t: 349.093505859375
assumed final_attacker_idxs:  [0 3 5 6 7 9]
final_attacker_idxs is: [0 3 5 6 7 9]
g_attacker_idxs: [66 36 92 27 46 52]
g_normal_idxs: [24 28 54 29]
filtered_attacker_idxs: [0, 3, 5, 6, 7, 9]
final_attacker_idxs are: [0, 3, 5, 6, 7, 9]
num_dps: [660, 379, 501, 1005, 519, 937, 471, 710, 1002, 253]
time spent on training: 39.73528289794922
Starting performing KrMLRFL...
Num data points: [660, 379, 501, 1005, 519, 937, 471, 710, 1002, 253]
Num selected data points: [ 379  501  519 1002]
The chosen ones are users: [1, 2, 4, 8], which are global users: [24, 28, 54, 29]
epoch_acc: 98.66
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0428, Accuracy: 9866/10000 (98.6600%)
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 14.3869, Accuracy: 19/8968 (0.2119%)
Done in 45.93188142776489 sec.
Server Epoch:91 choose agents : [18, 22, 59, 69, 37, 56, 36, 68, 39, 46].
___Train Local_Simple,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0008, Accuracy: 453/459 (98.6928%)
___Train Local_Simple,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0003, Accuracy: 457/459 (99.5643%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1906, Accuracy: 9434/10000 (94.3400%)
poison local model 22 index 0
___Train Local_Simple,  epoch  91, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 573/583 (98.2847%)
___Train Local_Simple,  epoch  91, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 582/583 (99.8285%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.0813, Accuracy: 9753/10000 (97.5300%)
___Train Local_Simple,  epoch  91, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch  91, local model 59, internal_epoch   2,  Average loss: 0.0004, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.3051, Accuracy: 9094/10000 (90.9400%)
___Train Local_Simple,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0011, Accuracy: 251/256 (98.0469%)
___Train Local_Simple,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1097, Accuracy: 9649/10000 (96.4900%)
___Train Local_Simple,  epoch  91, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%)
___Train Local_Simple,  epoch  91, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 858/860 (99.7674%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1662, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 874/880 (99.3182%)
___Train Local_Simple,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 878/880 (99.7727%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.0884, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 994/1005 (98.9055%)
___Train Local_Simple,  epoch  91, local model 36, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1003/1005 (99.8010%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1643, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch  91, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 491/494 (99.3927%)
___Train Local_Simple,  epoch  91, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1715, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch  91, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  91, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.0473, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch  91, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch  91, local model 46, internal_epoch   2,  Average loss: 0.0002, Accuracy: 707/710 (99.5775%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22]
base_p: [ 4.1253120e-04  5.1726028e-04  1.1325278e-03 ...  6.6578388e-05
 -3.6342070e-03 -2.1733344e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 6, 9]
layer1_inf_time: 4.50390625
[PAIRWISE] pred_attackers_indx:  [1 4 6]
layer2_inf_t: 37.7412109375
assumed final_attacker_idxs:  [1 2 4 6 9]
final_attacker_idxs is: [1 2 4 6 9]
g_attacker_idxs: [22 59 37 36 46]
g_normal_idxs: [18 69 56 68 39]
filtered_attacker_idxs: [1, 2, 6, 9]
final_attacker_idxs are: [1, 2, 6, 9]
num_dps: [459, 583, 760, 256, 860, 880, 1005, 494, 257, 710]
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1448, Accuracy: 9543/10000 (95.4300%)
time spent on training: 37.46779227256775
Starting performing KrMLRFL...
Num data points: [459, 583, 760, 256, 860, 880, 1005, 494, 257, 710]
Num selected data points: [459 256 860 880 494 257]
The chosen ones are users: [0, 3, 4, 5, 7, 8], which are global users: [18, 69, 37, 56, 68, 39]
epoch_acc: 98.64
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.0410, Accuracy: 9864/10000 (98.6400%)
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 14.7301, Accuracy: 16/8968 (0.1784%)
Done in 42.591912269592285 sec.
Server Epoch:92 choose agents : [72, 95, 79, 51, 47, 29, 10, 16, 84, 27].
___Train Local_Simple,  epoch  92, local model 72, internal_epoch   1,  Average loss: 0.0002, Accuracy: 728/731 (99.5896%)
___Train Local_Simple,  epoch  92, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 727/731 (99.4528%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1013, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch  92, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Train Local_Simple,  epoch  92, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.5943, Accuracy: 8445/10000 (84.4500%)
___Train Local_Simple,  epoch  92, local model 79, internal_epoch   1,  Average loss: 0.0005, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch  92, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0485, Accuracy: 9848/10000 (98.4800%)
poison local model 51 index 0
___Train Local_Simple,  epoch  92, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch  92, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1498, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  92, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 763/776 (98.3247%)
___Train Local_Simple,  epoch  92, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 771/776 (99.3557%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1488, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch  92, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch  92, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0828, Accuracy: 9717/10000 (97.1700%)
___Train Local_Simple,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0005, Accuracy: 881/892 (98.7668%)
___Train Local_Simple,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1579, Accuracy: 9512/10000 (95.1200%)
poison local model 16 index 1
___Train Local_Simple,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 904/915 (98.7978%)
___Train Local_Simple,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 905/915 (98.9071%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0649, Accuracy: 9803/10000 (98.0300%)
___Train Local_Simple,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1229/1246 (98.6356%)
___Train Local_Simple,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1236/1246 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.2252, Accuracy: 9452/10000 (94.5200%)
poison local model 27 index 2
___Train Local_Simple,  epoch  92, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 462/471 (98.0892%)
___Train Local_Simple,  epoch  92, local model 27, internal_epoch   2,  Average loss: 0.0001, Accuracy: 470/471 (99.7877%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1763, Accuracy: 9423/10000 (94.2300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 16, 27]
base_p: [ 0.00079301  0.00035486  0.00128929 ...  0.00039306 -0.00366703
 -0.00211773]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 7, 8, 9]
layer1_inf_time: 6.0302734375
[PAIRWISE] pred_attackers_indx:  [1 3 7]
layer2_inf_t: 255.6845703125
assumed final_attacker_idxs:  [1 3 4 7 8 9]
final_attacker_idxs is: [1 3 4 7 8 9]
g_attacker_idxs: [95 51 47 16 84 27]
g_normal_idxs: [72 79 29 10]
filtered_attacker_idxs: [1, 3, 4, 7, 8, 9]
final_attacker_idxs are: [1, 3, 4, 7, 8, 9]
num_dps: [731, 602, 182, 568, 776, 1002, 892, 915, 1246, 471]
time spent on training: 42.9404513835907
Starting performing KrMLRFL...
Num data points: [731, 602, 182, 568, 776, 1002, 892, 915, 1246, 471]
Num selected data points: [ 731  182 1002  892]
The chosen ones are users: [0, 2, 5, 6], which are global users: [72, 79, 29, 10]
epoch_acc: 98.68
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0408, Accuracy: 9868/10000 (98.6800%)
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 15.1272, Accuracy: 13/8968 (0.1450%)
Done in 51.332239866256714 sec.
Server Epoch:93 choose agents : [47, 97, 40, 98, 33, 92, 96, 76, 73, 72].
___Train Local_Simple,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 770/776 (99.2268%)
___Train Local_Simple,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1212, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch  93, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 484/487 (99.3840%)
___Train Local_Simple,  epoch  93, local model 97, internal_epoch   2,  Average loss: 0.0003, Accuracy: 482/487 (98.9733%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1183, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0006, Accuracy: 763/772 (98.8342%)
___Train Local_Simple,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0012, Accuracy: 763/772 (98.8342%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1731, Accuracy: 9518/10000 (95.1800%)
___Train Local_Simple,  epoch  93, local model 98, internal_epoch   1,  Average loss: 0.0006, Accuracy: 808/818 (98.7775%)
___Train Local_Simple,  epoch  93, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 813/818 (99.3888%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0636, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch  93, local model 33, internal_epoch   1,  Average loss: 0.0005, Accuracy: 616/623 (98.8764%)
___Train Local_Simple,  epoch  93, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1008, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 922/937 (98.3991%)
___Train Local_Simple,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.2065, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch  93, local model 96, internal_epoch   1,  Average loss: 0.0004, Accuracy: 665/672 (98.9583%)
___Train Local_Simple,  epoch  93, local model 96, internal_epoch   2,  Average loss: 0.0002, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1116, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch  93, local model 76, internal_epoch   1,  Average loss: 0.0002, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch  93, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0371, Accuracy: 9875/10000 (98.7500%)
poison local model 73 index 0
___Train Local_Simple,  epoch  93, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%)
___Train Local_Simple,  epoch  93, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 586/591 (99.1540%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0764, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch  93, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch  93, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0616, Accuracy: 9788/10000 (97.8800%)
time spent on training: 34.544485092163086
Starting performing KrMLRFL...
Num data points: [776, 487, 772, 818, 623, 937, 672, 78, 591, 731]
Num selected data points: [487 623  78 731]
The chosen ones are users: [1, 4, 7, 9], which are global users: [97, 33, 76, 72]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73]
base_p: [ 0.00084845  0.00037799  0.00059715 ...  0.00184308 -0.00057206
  0.00070726]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 8]
layer1_inf_time: 3.13037109375
[PAIRWISE] pred_attackers_indx:  [0 2 5 6 8]
layer2_inf_t: 30.230712890625
assumed final_attacker_idxs:  [0 2 3 5 6 8]
final_attacker_idxs is: [0 2 3 5 6 8]
g_attacker_idxs: [47 40 98 92 96 73]
g_normal_idxs: [97 33 76 72]
filtered_attacker_idxs: [0, 2, 3, 5, 6, 8]
final_attacker_idxs are: [0, 2, 3, 5, 6, 8]
num_dps: [776, 487, 772, 818, 623, 937, 672, 78, 591, 731]
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0371, Accuracy: 9881/10000 (98.8100%)
epoch_acc: 98.81
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 15.2126, Accuracy: 7/8968 (0.0781%)
Done in 41.73421502113342 sec.
Server Epoch:94 choose agents : [68, 38, 40, 13, 30, 2, 83, 51, 27, 88].
___Train Local_Simple,  epoch  94, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Train Local_Simple,  epoch  94, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0751, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch  94, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 891/895 (99.5531%)
___Train Local_Simple,  epoch  94, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0684, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch  94, local model 40, internal_epoch   1,  Average loss: 0.0006, Accuracy: 762/772 (98.7047%)
___Train Local_Simple,  epoch  94, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1522, Accuracy: 9591/10000 (95.9100%)
poison local model 13 index 0
___Train Local_Simple,  epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 725/734 (98.7738%)
___Train Local_Simple,  epoch  94, local model 13, internal_epoch   2,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1684, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch  94, local model 30, internal_epoch   1,  Average loss: 0.0004, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch  94, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1152, Accuracy: 9666/10000 (96.6600%)
poison local model 2 index 1
___Train Local_Simple,  epoch  94, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 536/548 (97.8102%)
___Train Local_Simple,  epoch  94, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1101, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch  94, local model 83, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch  94, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0416, Accuracy: 9877/10000 (98.7700%)
poison local model 51 index 2
___Train Local_Simple,  epoch  94, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%)
___Train Local_Simple,  epoch  94, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1425, Accuracy: 9577/10000 (95.7700%)
poison local model 27 index 3
___Train Local_Simple,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 468/471 (99.3631%)
___Train Local_Simple,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0008, Accuracy: 464/471 (98.5138%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1461, Accuracy: 9520/10000 (95.2000%)
___Train Local_Simple,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 523/530 (98.6792%)
___Train Local_Simple,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0003, Accuracy: 525/530 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1848, Accuracy: 9415/10000 (94.1500%)
time spent on training: 52.30032253265381
Starting performing KrMLRFL...
Num data points: [494, 895, 772, 734, 400, 548, 433, 568, 471, 530]
Num selected data points: [494 895 400 433 530]
The chosen ones are users: [0, 1, 4, 6, 9], which are global users: [68, 38, 30, 83, 88]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 2, 51, 27]
base_p: [ 0.00030855  0.00031139  0.00057497 ... -0.00256614 -0.00466882
 -0.00059875]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 7, 8]
layer1_inf_time: 5.2451171875
[PAIRWISE] pred_attackers_indx:  [3 5 7 8]
layer2_inf_t: 46.048828125
assumed final_attacker_idxs:  [2 3 5 7 8]
final_attacker_idxs is: [2 3 5 7 8]
g_attacker_idxs: [40 13  2 51 27]
g_normal_idxs: [68 38 30 83 88]
filtered_attacker_idxs: [2, 3, 5, 7, 8]
final_attacker_idxs are: [2, 3, 5, 7, 8]
num_dps: [494, 895, 772, 734, 400, 548, 433, 568, 471, 530]
epoch_acc: 98.67
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0405, Accuracy: 9867/10000 (98.6700%)
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 15.5821, Accuracy: 8/8968 (0.0892%)
Done in 60.32131767272949 sec.
Server Epoch:95 choose agents : [6, 49, 50, 32, 22, 78, 64, 66, 82, 47].
___Train Local_Simple,  epoch  95, local model 6, internal_epoch   1,  Average loss: 0.0008, Accuracy: 606/615 (98.5366%)
___Train Local_Simple,  epoch  95, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 614/615 (99.8374%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1323, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0920, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0006, Accuracy: 468/474 (98.7342%)
___Train Local_Simple,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0975, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 958/977 (98.0553%)
___Train Local_Simple,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0008, Accuracy: 968/977 (99.0788%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1480, Accuracy: 9541/10000 (95.4100%)
poison local model 22 index 0
___Train Local_Simple,  epoch  95, local model 22, internal_epoch   1,  Average loss: 0.0017, Accuracy: 571/583 (97.9417%)
___Train Local_Simple,  epoch  95, local model 22, internal_epoch   2,  Average loss: 0.0024, Accuracy: 562/583 (96.3979%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.5435, Accuracy: 8497/10000 (84.9700%)
___Train Local_Simple,  epoch  95, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch  95, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2023, Accuracy: 9421/10000 (94.2100%)
___Train Local_Simple,  epoch  95, local model 64, internal_epoch   1,  Average loss: 0.0008, Accuracy: 804/813 (98.8930%)
___Train Local_Simple,  epoch  95, local model 64, internal_epoch   2,  Average loss: 0.0005, Accuracy: 808/813 (99.3850%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1920, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  95, local model 66, internal_epoch   1,  Average loss: 0.0007, Accuracy: 650/660 (98.4848%)
___Train Local_Simple,  epoch  95, local model 66, internal_epoch   2,  Average loss: 0.0003, Accuracy: 655/660 (99.2424%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0789, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch  95, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch  95, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.3632, Accuracy: 8995/10000 (89.9500%)
___Train Local_Simple,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 770/776 (99.2268%)
___Train Local_Simple,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 771/776 (99.3557%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0867, Accuracy: 9754/10000 (97.5400%)
time spent on training: 36.26209235191345
Starting performing KrMLRFL...
Num data points: [615, 506, 474, 977, 583, 303, 813, 660, 713, 776]
Num selected data points: [615 506 474 303 813 713]
The chosen ones are users: [0, 1, 2, 5, 6, 8], which are global users: [6, 49, 50, 78, 64, 82]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22]
base_p: [ 0.00018966  0.00032153  0.00134019 ...  0.00043352 -0.00272992
 -0.00022533]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 9]
layer1_inf_time: 4.190673828125
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 379.123046875
assumed final_attacker_idxs:  [3 4 6 7 9]
final_attacker_idxs is: [3 4 6 7 9]
g_attacker_idxs: [32 22 64 66 47]
g_normal_idxs: [ 6 49 50 78 82]
filtered_attacker_idxs: [3, 4, 7, 9]
final_attacker_idxs are: [3, 4, 7, 9]
num_dps: [615, 506, 474, 977, 583, 303, 813, 660, 713, 776]
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0415, Accuracy: 9869/10000 (98.6900%)
epoch_acc: 98.69
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 13.5594, Accuracy: 13/8968 (0.1450%)
Done in 42.91026592254639 sec.
Server Epoch:96 choose agents : [1, 14, 49, 15, 89, 79, 44, 9, 13, 68].
poison local model 1 index 0
___Train Local_Simple,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 754/760 (99.2105%)
___Train Local_Simple,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0003, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1346, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch  96, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch  96, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 371/376 (98.6702%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1844, Accuracy: 9548/10000 (95.4800%)
___Train Local_Simple,  epoch  96, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch  96, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0523, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch  96, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch  96, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0581, Accuracy: 9800/10000 (98.0000%)
___Train Local_Simple,  epoch  96, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 490/492 (99.5935%)
___Train Local_Simple,  epoch  96, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1172, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  96, local model 79, internal_epoch   1,  Average loss: 0.0007, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch  96, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0460, Accuracy: 9852/10000 (98.5200%)
___Train Local_Simple,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0009, Accuracy: 509/517 (98.4526%)
___Train Local_Simple,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0004, Accuracy: 511/517 (98.8395%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0594, Accuracy: 9819/10000 (98.1900%)
___Train Local_Simple,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0905, Accuracy: 9735/10000 (97.3500%)
poison local model 13 index 1
___Train Local_Simple,  epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%)
___Train Local_Simple,  epoch  96, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1035, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  96, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Train Local_Simple,  epoch  96, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.1005, Accuracy: 9700/10000 (97.0000%)
type of model <class 'models.MnistNet.MnistNet'>
time spent on training: 44.538782596588135
Starting performing KrMLRFL...
Num data points: [760, 376, 506, 401, 492, 182, 517, 436, 734, 494]
Num selected data points: [376 506 401 492 182 517 436 494]
The chosen ones are users: [1, 2, 3, 4, 5, 6, 7, 9], which are global users: [14, 49, 15, 89, 79, 44, 9, 68]
selected_attackers: [1, 13]
base_p: [ 0.0001983   0.00021475  0.00054276 ...  0.00096558  0.00052566
 -0.00070421]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 8]
layer1_inf_time: 3.77880859375
[PAIRWISE] pred_attackers_indx:  [0 3 6 7 8]
layer2_inf_t: 86.240966796875
assumed final_attacker_idxs:  [0 1 3 4 6 7 8]
final_attacker_idxs is: [0 1 3 4 6 7 8]
g_attacker_idxs: [ 1 14 15 89 44  9 13]
g_normal_idxs: [49 79 68]
filtered_attacker_idxs: [0, 8]
final_attacker_idxs are: [0, 8]
num_dps: [760, 376, 506, 401, 492, 182, 517, 436, 734, 494]
epoch_acc: 98.8
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0351, Accuracy: 9880/10000 (98.8000%)
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 13.9194, Accuracy: 17/8968 (0.1896%)
Done in 51.869768381118774 sec.
Server Epoch:97 choose agents : [90, 51, 82, 94, 53, 48, 52, 72, 54, 36].
___Train Local_Simple,  epoch  97, local model 90, internal_epoch   1,  Average loss: 0.0004, Accuracy: 678/683 (99.2679%)
___Train Local_Simple,  epoch  97, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 681/683 (99.7072%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.4827, Accuracy: 8760/10000 (87.6000%)
poison local model 51 index 0
___Train Local_Simple,  epoch  97, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 565/568 (99.4718%)
___Train Local_Simple,  epoch  97, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1101, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch  97, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 711/713 (99.7195%)
___Train Local_Simple,  epoch  97, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.3428, Accuracy: 9134/10000 (91.3400%)
___Train Local_Simple,  epoch  97, local model 94, internal_epoch   1,  Average loss: 0.0012, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  97, local model 94, internal_epoch   2,  Average loss: 0.0005, Accuracy: 148/150 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.2139, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch  97, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch  97, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.2020, Accuracy: 9398/10000 (93.9800%)
___Train Local_Simple,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0006, Accuracy: 442/448 (98.6607%)
___Train Local_Simple,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0565, Accuracy: 9799/10000 (97.9900%)
poison local model 52 index 1
___Train Local_Simple,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0003, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0670, Accuracy: 9791/10000 (97.9100%)
___Train Local_Simple,  epoch  97, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch  97, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0840, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  97, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch  97, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1124, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 990/1005 (98.5075%)
___Train Local_Simple,  epoch  97, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 994/1005 (98.9055%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1696, Accuracy: 9471/10000 (94.7100%)
time spent on training: 40.17521786689758
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 52]
base_p: [ 0.00065827  0.0002779   0.00059174 ...  0.00114225 -0.00194144
 -0.00080971]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 6, 9]
layer1_inf_time: 4.46337890625
[PAIRWISE] pred_attackers_indx:  [0 1 2 7]
layer2_inf_t: 63.990478515625
assumed final_attacker_idxs:  [0 1 2 4 6 7 9]
final_attacker_idxs is: [0 1 2 4 6 7 9]
g_attacker_idxs: [90 51 82 53 52 72 36]
g_normal_idxs: [94 48 54]
filtered_attacker_idxs: [1, 2, 4, 6, 9]
final_attacker_idxs are: [1, 2, 4, 6, 9]
num_dps: [683, 568, 713, 150, 739, 448, 253, 731, 519, 1005]
Starting performing KrMLRFL...
Num data points: [683, 568, 713, 150, 739, 448, 253, 731, 519, 1005]
Num selected data points: [683 150 448 731 519]
The chosen ones are users: [0, 3, 5, 7, 8], which are global users: [90, 94, 48, 72, 54]
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0402, Accuracy: 9862/10000 (98.6200%)
epoch_acc: 98.61999999999999
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 13.5598, Accuracy: 25/8968 (0.2788%)
Done in 47.22835946083069 sec.
Server Epoch:98 choose agents : [94, 90, 75, 70, 69, 80, 96, 82, 37, 1].
___Train Local_Simple,  epoch  98, local model 94, internal_epoch   1,  Average loss: 0.0003, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  98, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0940, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Train Local_Simple,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0704, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch  98, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 682/686 (99.4169%)
___Train Local_Simple,  epoch  98, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0637, Accuracy: 9809/10000 (98.0900%)
poison local model 70 index 0
___Train Local_Simple,  epoch  98, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 710/724 (98.0663%)
___Train Local_Simple,  epoch  98, local model 70, internal_epoch   2,  Average loss: 0.0010, Accuracy: 709/724 (97.9282%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.9446, Accuracy: 8692/10000 (86.9200%)
___Train Local_Simple,  epoch  98, local model 69, internal_epoch   1,  Average loss: 0.0004, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch  98, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0956, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch  98, local model 80, internal_epoch   1,  Average loss: 0.0005, Accuracy: 426/431 (98.8399%)
___Train Local_Simple,  epoch  98, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0947, Accuracy: 9735/10000 (97.3500%)
___Train Local_Simple,  epoch  98, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 665/672 (98.9583%)
___Train Local_Simple,  epoch  98, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0919, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch  98, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch  98, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.3761, Accuracy: 9019/10000 (90.1900%)
___Train Local_Simple,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 859/860 (99.8837%)
___Train Local_Simple,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0896, Accuracy: 9742/10000 (97.4200%)
poison local model 1 index 1
___Train Local_Simple,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 752/760 (98.9474%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1444, Accuracy: 9548/10000 (95.4800%)
time spent on training: 41.769590854644775
Starting performing KrMLRFL...
Num data points: [150, 683, 686, 724, 256, 431, 672, 713, 860, 760]
Num selected data points: [150 683 686 256 431 860]
The chosen ones are users: [0, 1, 2, 4, 5, 8], which are global users: [94, 90, 75, 69, 80, 37]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 1]
base_p: [ 0.00051472  0.00025805  0.00038223 ... -0.00141501  0.00181106
 -0.00022074]
[T_SCORE] attacker_local_idxs is:  [3, 5, 6, 7, 9]
layer1_inf_time: 3.15185546875
[PAIRWISE] pred_attackers_indx:  [3]
layer2_inf_t: 34.231689453125
assumed final_attacker_idxs:  [3 5 6 7 9]
final_attacker_idxs is: [3 5 6 7 9]
g_attacker_idxs: [70 80 96 82  1]
g_normal_idxs: [94 90 75 69 37]
filtered_attacker_idxs: [3, 6, 7, 9]
final_attacker_idxs are: [3, 6, 7, 9]
num_dps: [150, 683, 686, 724, 256, 431, 672, 713, 860, 760]
epoch_acc: 98.75
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0358, Accuracy: 9875/10000 (98.7500%)
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 14.0151, Accuracy: 16/8968 (0.1784%)
Done in 48.63335824012756 sec.
Server Epoch:99 choose agents : [82, 36, 17, 29, 79, 33, 64, 19, 15, 66].
___Train Local_Simple,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.2827, Accuracy: 9188/10000 (91.8800%)
___Train Local_Simple,  epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 996/1005 (99.1045%)
___Train Local_Simple,  epoch  99, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 993/1005 (98.8060%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1461, Accuracy: 9569/10000 (95.6900%)
poison local model 17 index 0
___Train Local_Simple,  epoch  99, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 610/620 (98.3871%)
___Train Local_Simple,  epoch  99, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 616/620 (99.3548%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0775, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch  99, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Train Local_Simple,  epoch  99, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0705, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch  99, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch  99, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0396, Accuracy: 9870/10000 (98.7000%)
___Train Local_Simple,  epoch  99, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch  99, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0395, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch  99, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 809/813 (99.5080%)
___Train Local_Simple,  epoch  99, local model 64, internal_epoch   2,  Average loss: 0.0005, Accuracy: 806/813 (99.1390%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0912, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch  99, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch  99, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 204/205 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0459, Accuracy: 9851/10000 (98.5100%)
___Train Local_Simple,  epoch  99, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 396/401 (98.7531%)
___Train Local_Simple,  epoch  99, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0941, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0007, Accuracy: 649/660 (98.3333%)
___Train Local_Simple,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 649/660 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1188, Accuracy: 9599/10000 (95.9900%)
time spent on training: 38.8423330783844
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17]
base_p: [ 3.7908554e-05  3.0841678e-04 -3.7380587e-04 ... -9.5954537e-04
 -1.3785288e-03 -3.5946816e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 9]
layer1_inf_time: 3.1748046875
[PAIRWISE] pred_attackers_indx:  [1 2]
layer2_inf_t: 41.016845703125
assumed final_attacker_idxs:  [0 1 2 6 9]
final_attacker_idxs is: [0 1 2 6 9]
g_attacker_idxs: [82 36 17 64 66]
g_normal_idxs: [29 79 33 19 15]
filtered_attacker_idxs: [0, 1, 2, 9]
final_attacker_idxs are: [0, 1, 2, 9]
num_dps: [713, 1005, 620, 1002, 182, 623, 813, 205, 401, 660]
Starting performing KrMLRFL...
Num data points: [713, 1005, 620, 1002, 182, 623, 813, 205, 401, 660]
Num selected data points: [1002  182  623  813  205  401]
The chosen ones are users: [3, 4, 5, 6, 7, 8], which are global users: [29, 79, 33, 64, 19, 15]
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0351, Accuracy: 9874/10000 (98.7400%)
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 15.3454, Accuracy: 11/8968 (0.1227%)
Done in 46.3223831653595 sec.
Server Epoch:100 choose agents : [76, 67, 89, 86, 25, 4, 77, 85, 94, 91].
___Train Local_Simple,  epoch 100, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 100, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0350, Accuracy: 9872/10000 (98.7200%)
___Train Local_Simple,  epoch 100, local model 67, internal_epoch   1,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
___Train Local_Simple,  epoch 100, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1297, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0003, Accuracy: 488/492 (99.1870%)
___Train Local_Simple,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0928, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch 100, local model 86, internal_epoch   1,  Average loss: 0.0002, Accuracy: 249/250 (99.6000%)
___Train Local_Simple,  epoch 100, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0585, Accuracy: 9809/10000 (98.0900%)
___Train Local_Simple,  epoch 100, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 641/647 (99.0726%)
___Train Local_Simple,  epoch 100, local model 25, internal_epoch   2,  Average loss: 0.0004, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1012, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0002, Accuracy: 655/658 (99.5441%)
___Train Local_Simple,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 655/658 (99.5441%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1912, Accuracy: 9445/10000 (94.4500%)
___Train Local_Simple,  epoch 100, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 580/589 (98.4720%)
___Train Local_Simple,  epoch 100, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 586/589 (99.4907%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0655, Accuracy: 9799/10000 (97.9900%)
poison local model 85 index 0
___Train Local_Simple,  epoch 100, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 100, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0502, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 100, local model 94, internal_epoch   1,  Average loss: 0.0008, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 100, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1147, Accuracy: 9597/10000 (95.9700%)
poison local model 91 index 1
___Train Local_Simple,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0508, Accuracy: 9832/10000 (98.3200%)
time spent on training: 43.159037828445435
Starting performing KrMLRFL...
Num data points: [78, 998, 492, 250, 647, 658, 589, 431, 150, 256]
Num selected data points: [ 78 492 250 150]
The chosen ones are users: [0, 2, 3, 8], which are global users: [76, 89, 86, 94]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 91]
base_p: [ 0.00039075  0.00019507  0.00050819 ...  0.00086343  0.00187278
 -0.00016247]
[T_SCORE] attacker_local_idxs is:  [1, 5, 6, 7, 9]
layer1_inf_time: 5.577880859375
[PAIRWISE] pred_attackers_indx:  [1 4 5]
layer2_inf_t: 68.9404296875
assumed final_attacker_idxs:  [1 4 5 6 7 9]
final_attacker_idxs is: [1 4 5 6 7 9]
g_attacker_idxs: [67 25  4 77 85 91]
g_normal_idxs: [76 89 86 94]
filtered_attacker_idxs: [1, 4, 5, 6, 7, 9]
final_attacker_idxs are: [1, 4, 5, 6, 7, 9]
num_dps: [78, 998, 492, 250, 647, 658, 589, 431, 150, 256]
epoch_acc: 98.68
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0375, Accuracy: 9868/10000 (98.6800%)
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 14.9883, Accuracy: 16/8968 (0.1784%)
Done in 48.843533754348755 sec.
Server Epoch:101 choose agents : [20, 58, 95, 86, 54, 98, 80, 19, 94, 33].
poison local model 20 index 0
___Train Local_Simple,  epoch 101, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 101, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 429/429 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1612, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 270/276 (97.8261%)
___Train Local_Simple,  epoch 101, local model 58, internal_epoch   2,  Average loss: 0.0003, Accuracy: 275/276 (99.6377%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1212, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0003, Accuracy: 599/602 (99.5017%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.2834, Accuracy: 8970/10000 (89.7000%)
___Train Local_Simple,  epoch 101, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 101, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0951, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch 101, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch 101, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1534, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0009, Accuracy: 804/818 (98.2885%)
___Train Local_Simple,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 813/818 (99.3888%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1707, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0747, Accuracy: 9790/10000 (97.9000%)
___Train Local_Simple,  epoch 101, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch 101, local model 19, internal_epoch   2,  Average loss: 0.0002, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0632, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0002, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1623, Accuracy: 9427/10000 (94.2700%)
___Train Local_Simple,  epoch 101, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 101, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0690, Accuracy: 9774/10000 (97.7400%)
time spent on training: 35.56867694854736
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20]
base_p: [ 0.00036445  0.00013286 -0.00059859 ... -0.00211656 -0.00169214
 -0.00014823]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 6, 9]
layer1_inf_time: 3.443603515625
[PAIRWISE] pred_attackers_indx:  [0]
layer2_inf_t: 33.097900390625
assumed final_attacker_idxs:  [0 2 5 6 9]
final_attacker_idxs is: [0 2 5 6 9]
g_attacker_idxs: [20 95 98 80 33]
g_normal_idxs: [58 86 54 19 94]
filtered_attacker_idxs: [0, 2, 5]
final_attacker_idxs are: [0, 2, 5]
num_dps: [429, 276, 602, 250, 519, 818, 431, 205, 150, 623]
Starting performing KrMLRFL...
Num data points: [429, 276, 602, 250, 519, 818, 431, 205, 150, 623]
Num selected data points: [276 250 519 431 205 150 623]
The chosen ones are users: [1, 3, 4, 6, 7, 8, 9], which are global users: [58, 86, 54, 80, 19, 94, 33]
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0341, Accuracy: 9890/10000 (98.9000%)
epoch_acc: 98.9
___Test Local_Simple poisoned: True, epoch: 101: Average loss: 14.5150, Accuracy: 12/8968 (0.1338%)
Done in 41.47875094413757 sec.
Server Epoch:102 choose agents : [47, 89, 52, 39, 94, 10, 36, 79, 53, 74].
___Train Local_Simple,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0003, Accuracy: 771/776 (99.3557%)
___Train Local_Simple,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0005, Accuracy: 774/776 (99.7423%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0487, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Train Local_Simple,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0581, Accuracy: 9814/10000 (98.1400%)
poison local model 52 index 0
___Train Local_Simple,  epoch 102, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 252/253 (99.6047%)
___Train Local_Simple,  epoch 102, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.1033, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch 102, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 252/257 (98.0545%)
___Train Local_Simple,  epoch 102, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0725, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch 102, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 102, local model 94, internal_epoch   2,  Average loss: 0.0003, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0903, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch 102, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 887/892 (99.4395%)
___Train Local_Simple,  epoch 102, local model 10, internal_epoch   2,  Average loss: 0.0003, Accuracy: 886/892 (99.3274%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0846, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 990/1005 (98.5075%)
___Train Local_Simple,  epoch 102, local model 36, internal_epoch   2,  Average loss: 0.0006, Accuracy: 997/1005 (99.2040%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.3334, Accuracy: 8943/10000 (89.4300%)
___Train Local_Simple,  epoch 102, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 102, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0441, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 102, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 102, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 733/739 (99.1881%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.2056, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch 102, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%)
___Train Local_Simple,  epoch 102, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0809, Accuracy: 9733/10000 (97.3300%)
time spent on training: 37.06701326370239
Starting performing KrMLRFL...
Num data points: [776, 492, 253, 257, 150, 892, 1005, 182, 739, 557]
Num selected data points: [492 257 150 892 182 557]
The chosen ones are users: [1, 3, 4, 5, 7, 9], which are global users: [89, 39, 94, 10, 79, 74]
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0407, Accuracy: 9864/10000 (98.6400%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00043149  0.00024784  0.00086103 ... -0.00291538  0.00067975
 -0.00056411]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 8]
layer1_inf_time: 3.15966796875
[PAIRWISE] pred_attackers_indx:  [6 8 9]
layer2_inf_t: 28.119384765625
assumed final_attacker_idxs:  [0 1 2 6 8 9]
final_attacker_idxs is: [0 1 2 6 8 9]
g_attacker_idxs: [47 89 52 36 53 74]
g_normal_idxs: [39 94 10 79]
filtered_attacker_idxs: [0, 2, 6, 8]
final_attacker_idxs are: [0, 2, 6, 8]
num_dps: [776, 492, 253, 257, 150, 892, 1005, 182, 739, 557]
epoch_acc: 98.64
___Test Local_Simple poisoned: True, epoch: 102: Average loss: 14.3858, Accuracy: 22/8968 (0.2453%)
Done in 43.96797728538513 sec.
Server Epoch:103 choose agents : [6, 10, 27, 69, 28, 15, 13, 81, 44, 66].
___Train Local_Simple,  epoch 103, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Train Local_Simple,  epoch 103, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0660, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 103, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 103, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0592, Accuracy: 9806/10000 (98.0600%)
poison local model 27 index 0
___Train Local_Simple,  epoch 103, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 459/471 (97.4522%)
___Train Local_Simple,  epoch 103, local model 27, internal_epoch   2,  Average loss: 0.0002, Accuracy: 470/471 (99.7877%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.3859, Accuracy: 9173/10000 (91.7300%)
___Train Local_Simple,  epoch 103, local model 69, internal_epoch   1,  Average loss: 0.0009, Accuracy: 252/256 (98.4375%)
___Train Local_Simple,  epoch 103, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0771, Accuracy: 9749/10000 (97.4900%)
___Train Local_Simple,  epoch 103, local model 28, internal_epoch   1,  Average loss: 0.0003, Accuracy: 498/501 (99.4012%)
___Train Local_Simple,  epoch 103, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0574, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 103, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch 103, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0741, Accuracy: 9761/10000 (97.6100%)
poison local model 13 index 1
___Train Local_Simple,  epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0009, Accuracy: 724/734 (98.6376%)
___Train Local_Simple,  epoch 103, local model 13, internal_epoch   2,  Average loss: 0.0006, Accuracy: 728/734 (99.1826%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.2488, Accuracy: 9199/10000 (91.9900%)
poison local model 81 index 2
___Train Local_Simple,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1220/1227 (99.4295%)
___Train Local_Simple,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1217/1227 (99.1850%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.2642, Accuracy: 9231/10000 (92.3100%)
___Train Local_Simple,  epoch 103, local model 44, internal_epoch   1,  Average loss: 0.0011, Accuracy: 508/517 (98.2592%)
___Train Local_Simple,  epoch 103, local model 44, internal_epoch   2,  Average loss: 0.0015, Accuracy: 503/517 (97.2921%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.1404, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0005, Accuracy: 650/660 (98.4848%)
___Train Local_Simple,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0002, Accuracy: 656/660 (99.3939%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.1744, Accuracy: 9455/10000 (94.5500%)
time spent on training: 47.24894833564758
Starting performing KrMLRFL...
Num data points: [615, 892, 471, 256, 501, 401, 734, 1227, 517, 660]
Num selected data points: [615 892 256 501 401 517]
The chosen ones are users: [0, 1, 3, 4, 5, 8], which are global users: [6, 10, 69, 28, 15, 44]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 13, 81]
base_p: [ 0.00029633  0.00029726 -0.00013405 ... -0.00572553 -0.00073409
 -0.0017497 ]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 7, 9]
layer1_inf_time: 3.458984375
[PAIRWISE] pred_attackers_indx:  [6 7]
layer2_inf_t: 70.712890625
assumed final_attacker_idxs:  [2 5 6 7 9]
final_attacker_idxs is: [2 5 6 7 9]
g_attacker_idxs: [27 15 13 81 66]
g_normal_idxs: [ 6 10 69 28 44]
filtered_attacker_idxs: [2, 6, 7, 9]
final_attacker_idxs are: [2, 6, 7, 9]
num_dps: [615, 892, 471, 256, 501, 401, 734, 1227, 517, 660]
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0342, Accuracy: 9893/10000 (98.9300%)
___Test Local_Simple poisoned: True, epoch: 103: Average loss: 14.6416, Accuracy: 12/8968 (0.1338%)
Done in 54.30981159210205 sec.
Server Epoch:104 choose agents : [29, 45, 66, 74, 73, 21, 79, 80, 25, 96].
___Train Local_Simple,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0577, Accuracy: 9818/10000 (98.1800%)
poison local model 45 index 0
___Train Local_Simple,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.2007, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch 104, local model 66, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/660 (98.9394%)
___Train Local_Simple,  epoch 104, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 654/660 (99.0909%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0802, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch 104, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%)
___Train Local_Simple,  epoch 104, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0554, Accuracy: 9834/10000 (98.3400%)
poison local model 73 index 1
___Train Local_Simple,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0007, Accuracy: 581/591 (98.3080%)
___Train Local_Simple,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0007, Accuracy: 587/591 (99.3232%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1058, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch 104, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch 104, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0905, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch 104, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch 104, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0410, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 104, local model 80, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 104, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0901, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch 104, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 640/647 (98.9181%)
___Train Local_Simple,  epoch 104, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 645/647 (99.6909%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1175, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch 104, local model 96, internal_epoch   1,  Average loss: 0.0005, Accuracy: 666/672 (99.1071%)
___Train Local_Simple,  epoch 104, local model 96, internal_epoch   2,  Average loss: 0.0003, Accuracy: 669/672 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1030, Accuracy: 9668/10000 (96.6800%)
time spent on training: 41.5301251411438
Starting performing KrMLRFL...
Num data points: [1002, 628, 660, 557, 591, 312, 182, 431, 647, 672]
Num selected data points: [1002  557  312  182  431  647]
The chosen ones are users: [0, 3, 5, 6, 7, 8], which are global users: [29, 74, 21, 79, 80, 25]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 73]
base_p: [ 0.00060549  0.00021929 -0.00018764 ... -0.00210746  0.00018993
  0.00022271]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 7, 9]
layer1_inf_time: 5.442138671875
[PAIRWISE] pred_attackers_indx:  [1 4]
layer2_inf_t: 235.748291015625
assumed final_attacker_idxs:  [1 2 4 7 9]
final_attacker_idxs is: [1 2 4 7 9]
g_attacker_idxs: [45 66 73 80 96]
g_normal_idxs: [29 74 21 79 25]
filtered_attacker_idxs: [1, 2, 4, 9]
final_attacker_idxs are: [1, 2, 4, 9]
num_dps: [1002, 628, 660, 557, 591, 312, 182, 431, 647, 672]
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0354, Accuracy: 9882/10000 (98.8200%)
epoch_acc: 98.82
___Test Local_Simple poisoned: True, epoch: 104: Average loss: 14.2768, Accuracy: 23/8968 (0.2565%)
Done in 46.7022819519043 sec.
Server Epoch:105 choose agents : [59, 53, 27, 94, 48, 51, 20, 52, 93, 89].
___Train Local_Simple,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 747/760 (98.2895%)
___Train Local_Simple,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0004, Accuracy: 756/760 (99.4737%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.2019, Accuracy: 9353/10000 (93.5300%)
___Train Local_Simple,  epoch 105, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 105, local model 53, internal_epoch   2,  Average loss: 0.0005, Accuracy: 731/739 (98.9175%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1935, Accuracy: 9412/10000 (94.1200%)
poison local model 27 index 0
___Train Local_Simple,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 465/471 (98.7261%)
___Train Local_Simple,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0009, Accuracy: 466/471 (98.9384%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1544, Accuracy: 9507/10000 (95.0700%)
___Train Local_Simple,  epoch 105, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 105, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1636, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch 105, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 443/448 (98.8839%)
___Train Local_Simple,  epoch 105, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0753, Accuracy: 9757/10000 (97.5700%)
poison local model 51 index 1
___Train Local_Simple,  epoch 105, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%)
___Train Local_Simple,  epoch 105, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1204, Accuracy: 9628/10000 (96.2800%)
poison local model 20 index 2
___Train Local_Simple,  epoch 105, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 105, local model 20, internal_epoch   2,  Average loss: 0.0005, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.3139, Accuracy: 9257/10000 (92.5700%)
poison local model 52 index 3
___Train Local_Simple,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 251/253 (99.2095%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1050, Accuracy: 9709/10000 (97.0900%)
poison local model 93 index 0
___Train Local_Simple,  epoch 105, local model 93, internal_epoch   1,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 105, local model 93, internal_epoch   2,  Average loss: 0.0004, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.3013, Accuracy: 9295/10000 (92.9500%)
___Train Local_Simple,  epoch 105, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 105, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0824, Accuracy: 9735/10000 (97.3500%)
time spent on training: 61.740989446640015
Starting performing KrMLRFL...
Num data points: [760, 739, 471, 150, 448, 568, 429, 253, 623, 492]
Num selected data points: [150 448 492]
The chosen ones are users: [3, 4, 9], which are global users: [94, 48, 89]
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0501, Accuracy: 9831/10000 (98.3100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 51, 20, 52, 93]
base_p: [ 0.00015735  0.00019853  0.00075676 ...  0.00022189 -0.0040523
 -0.0003508 ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6, 7, 8]
layer1_inf_time: 4.050537109375
[PAIRWISE] pred_attackers_indx:  [0 2 6 7 8]
layer2_inf_t: 38.539794921875
assumed final_attacker_idxs:  [0 1 2 5 6 7 8]
final_attacker_idxs is: [0 1 2 5 6 7 8]
g_attacker_idxs: [59 53 27 51 20 52 93]
g_normal_idxs: [94 48 89]
filtered_attacker_idxs: [0, 1, 2, 5, 6, 7, 8]
final_attacker_idxs are: [0, 1, 2, 5, 6, 7, 8]
num_dps: [760, 739, 471, 150, 448, 568, 429, 253, 623, 492]
epoch_acc: 98.31
___Test Local_Simple poisoned: True, epoch: 105: Average loss: 13.7831, Accuracy: 31/8968 (0.3457%)
Done in 68.20373296737671 sec.
Server Epoch:106 choose agents : [46, 20, 0, 79, 78, 82, 87, 33, 62, 76].
___Train Local_Simple,  epoch 106, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch 106, local model 46, internal_epoch   2,  Average loss: 0.0002, Accuracy: 705/710 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.2263, Accuracy: 9350/10000 (93.5000%)
poison local model 20 index 0
___Train Local_Simple,  epoch 106, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 106, local model 20, internal_epoch   2,  Average loss: 0.0002, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.3688, Accuracy: 9114/10000 (91.1400%)
___Train Local_Simple,  epoch 106, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 429/435 (98.6207%)
___Train Local_Simple,  epoch 106, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0869, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0442, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0671, Accuracy: 9784/10000 (97.8400%)
___Train Local_Simple,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 701/713 (98.3170%)
___Train Local_Simple,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.5580, Accuracy: 8800/10000 (88.0000%)
___Train Local_Simple,  epoch 106, local model 87, internal_epoch   1,  Average loss: 0.0004, Accuracy: 467/470 (99.3617%)
___Train Local_Simple,  epoch 106, local model 87, internal_epoch   2,  Average loss: 0.0006, Accuracy: 466/470 (99.1489%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0544, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 106, local model 33, internal_epoch   1,  Average loss: 0.0004, Accuracy: 616/623 (98.8764%)
___Train Local_Simple,  epoch 106, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0649, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch 106, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 106, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0688, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0471, Accuracy: 9844/10000 (98.4400%)
time spent on training: 37.67922520637512
Starting performing KrMLRFL...
Num data points: [710, 429, 435, 182, 303, 713, 470, 623, 423, 78]
Num selected data points: [435 182 303 470 623 423  78]
The chosen ones are users: [2, 3, 4, 6, 7, 8, 9], which are global users: [0, 79, 78, 87, 33, 62, 76]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20]
base_p: [-0.00019737  0.00017695 -0.00060958 ... -0.0001384  -0.00013195
 -0.00049277]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 7]
layer1_inf_time: 4.112060546875
[PAIRWISE] pred_attackers_indx:  [0 5 7 8]
layer2_inf_t: 38.427490234375
assumed final_attacker_idxs:  [0 1 2 5 7 8]
final_attacker_idxs is: [0 1 2 5 7 8]
g_attacker_idxs: [46 20  0 82 33 62]
g_normal_idxs: [79 78 87 76]
filtered_attacker_idxs: [0, 1, 5]
final_attacker_idxs are: [0, 1, 5]
num_dps: [710, 429, 435, 182, 303, 713, 470, 623, 423, 78]
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0324, Accuracy: 9888/10000 (98.8800%)
epoch_acc: 98.88
___Test Local_Simple poisoned: True, epoch: 106: Average loss: 14.9409, Accuracy: 10/8968 (0.1115%)
Done in 44.71447014808655 sec.
Server Epoch:107 choose agents : [56, 34, 5, 20, 94, 22, 14, 63, 4, 67].
___Train Local_Simple,  epoch 107, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 874/880 (99.3182%)
___Train Local_Simple,  epoch 107, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0900, Accuracy: 9731/10000 (97.3100%)
poison local model 34 index 0
___Train Local_Simple,  epoch 107, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 107, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0839, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch 107, local model 5, internal_epoch   1,  Average loss: 0.0006, Accuracy: 431/434 (99.3088%)
___Train Local_Simple,  epoch 107, local model 5, internal_epoch   2,  Average loss: 0.0001, Accuracy: 432/434 (99.5392%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.1426, Accuracy: 9471/10000 (94.7100%)
poison local model 20 index 1
___Train Local_Simple,  epoch 107, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 107, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.2717, Accuracy: 9287/10000 (92.8700%)
___Train Local_Simple,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0017, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.4712, Accuracy: 8913/10000 (89.1300%)
poison local model 22 index 2
___Train Local_Simple,  epoch 107, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 573/583 (98.2847%)
___Train Local_Simple,  epoch 107, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0950, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch 107, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 374/376 (99.4681%)
___Train Local_Simple,  epoch 107, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0520, Accuracy: 9833/10000 (98.3300%)
poison local model 63 index 3
___Train Local_Simple,  epoch 107, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 872/889 (98.0877%)
___Train Local_Simple,  epoch 107, local model 63, internal_epoch   2,  Average loss: 0.0003, Accuracy: 884/889 (99.4376%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0753, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch 107, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 649/658 (98.6322%)
___Train Local_Simple,  epoch 107, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 651/658 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.2283, Accuracy: 9388/10000 (93.8800%)
___Train Local_Simple,  epoch 107, local model 67, internal_epoch   1,  Average loss: 0.0003, Accuracy: 991/998 (99.2986%)
___Train Local_Simple,  epoch 107, local model 67, internal_epoch   2,  Average loss: 0.0001, Accuracy: 995/998 (99.6994%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.1700, Accuracy: 9519/10000 (95.1900%)
time spent on training: 50.933382511138916
Starting performing KrMLRFL...
Num data points: [880, 413, 434, 429, 150, 583, 376, 889, 658, 998]
Num selected data points: [880 434 150 376]
The chosen ones are users: [0, 2, 4, 6], which are global users: [56, 5, 94, 14]
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0484, Accuracy: 9842/10000 (98.4200%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 20, 22, 63]
base_p: [ 0.00128624  0.00026108  0.00043971 ...  0.0016066  -0.00049474
 -0.00037777]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 7, 9]
layer1_inf_time: 2.842041015625
[PAIRWISE] pred_attackers_indx:  [0 2 4 6 8 9]
layer2_inf_t: 33.42822265625
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 8 9]
g_attacker_idxs: [56 34  5 20 94 22 14 63  4 67]
g_normal_idxs: []
filtered_attacker_idxs: [1, 3, 5, 7, 8, 9]
final_attacker_idxs are: [1, 3, 5, 7, 8, 9]
num_dps: [880, 413, 434, 429, 150, 583, 376, 889, 658, 998]
epoch_acc: 98.42
___Test Local_Simple poisoned: True, epoch: 107: Average loss: 15.2277, Accuracy: 12/8968 (0.1338%)
Done in 60.22475743293762 sec.
Server Epoch:108 choose agents : [91, 64, 77, 14, 67, 90, 75, 97, 92, 40].
poison local model 91 index 0
___Train Local_Simple,  epoch 108, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 108, local model 91, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0631, Accuracy: 9792/10000 (97.9200%)
___Train Local_Simple,  epoch 108, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 804/813 (98.8930%)
___Train Local_Simple,  epoch 108, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.5484, Accuracy: 8834/10000 (88.3400%)
___Train Local_Simple,  epoch 108, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 579/589 (98.3022%)
___Train Local_Simple,  epoch 108, local model 77, internal_epoch   2,  Average loss: 0.0014, Accuracy: 577/589 (97.9626%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.1840, Accuracy: 9385/10000 (93.8500%)
___Train Local_Simple,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0004, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0008, Accuracy: 371/376 (98.6702%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.1066, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch 108, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 991/998 (99.2986%)
___Train Local_Simple,  epoch 108, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0930, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch 108, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Train Local_Simple,  epoch 108, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.5111, Accuracy: 8854/10000 (88.5400%)
___Train Local_Simple,  epoch 108, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 677/686 (98.6880%)
___Train Local_Simple,  epoch 108, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0681, Accuracy: 9800/10000 (98.0000%)
___Train Local_Simple,  epoch 108, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 108, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0566, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch 108, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 927/937 (98.9328%)
___Train Local_Simple,  epoch 108, local model 92, internal_epoch   2,  Average loss: 0.0006, Accuracy: 929/937 (99.1462%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.2220, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 765/772 (99.0933%)
___Train Local_Simple,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0011, Accuracy: 757/772 (98.0570%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 2.5111, Accuracy: 6973/10000 (69.7300%)
time spent on training: 38.108617305755615
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91]
base_p: [ 0.00045451  0.00029844  0.0015076  ... -0.00562805 -0.00777814
 -0.00079414]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 8, 9]
layer1_inf_time: 3.951171875
Num data points: [256, 813, 589, 376, 998, 683, 686, 487, 937, 772]
Num selected data points: [813 376 683 686 487]
The chosen ones are users: [1, 3, 5, 6, 7], which are global users: [64, 14, 90, 75, 97]
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0398, Accuracy: 9873/10000 (98.7300%)
[PAIRWISE] pred_attackers_indx:  [1 2 4 8]
layer2_inf_t: 276.765869140625
assumed final_attacker_idxs:  [0 1 2 4 8 9]
final_attacker_idxs is: [0 1 2 4 8 9]
g_attacker_idxs: [91 64 77 67 92 40]
g_normal_idxs: [14 90 75 97]
filtered_attacker_idxs: [0, 2, 4, 8, 9]
final_attacker_idxs are: [0, 2, 4, 8, 9]
num_dps: [256, 813, 589, 376, 998, 683, 686, 487, 937, 772]
epoch_acc: 98.72999999999999
___Test Local_Simple poisoned: True, epoch: 108: Average loss: 14.5279, Accuracy: 8/8968 (0.0892%)
Done in 45.156729221343994 sec.
Server Epoch:109 choose agents : [76, 6, 8, 88, 2, 82, 12, 27, 61, 21].
___Train Local_Simple,  epoch 109, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 109, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0379, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 109, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 612/615 (99.5122%)
___Train Local_Simple,  epoch 109, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 612/615 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0785, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0004, Accuracy: 629/633 (99.3681%)
___Train Local_Simple,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0513, Accuracy: 9831/10000 (98.3100%)
___Train Local_Simple,  epoch 109, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 526/530 (99.2453%)
___Train Local_Simple,  epoch 109, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 526/530 (99.2453%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.2115, Accuracy: 9437/10000 (94.3700%)
poison local model 2 index 0
___Train Local_Simple,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0010, Accuracy: 539/548 (98.3577%)
___Train Local_Simple,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0008, Accuracy: 541/548 (98.7226%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.1971, Accuracy: 9356/10000 (93.5600%)
___Train Local_Simple,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.3180, Accuracy: 9038/10000 (90.3800%)
___Train Local_Simple,  epoch 109, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1139/1160 (98.1897%)
___Train Local_Simple,  epoch 109, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1150/1160 (99.1379%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.1670, Accuracy: 9494/10000 (94.9400%)
poison local model 27 index 1
___Train Local_Simple,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 465/471 (98.7261%)
___Train Local_Simple,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 464/471 (98.5138%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.2888, Accuracy: 9267/10000 (92.6700%)
poison local model 61 index 2
___Train Local_Simple,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 685/699 (97.9971%)
___Train Local_Simple,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0005, Accuracy: 693/699 (99.1416%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.3149, Accuracy: 8937/10000 (89.3700%)
___Train Local_Simple,  epoch 109, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 308/312 (98.7179%)
___Train Local_Simple,  epoch 109, local model 21, internal_epoch   2,  Average loss: 0.0004, Accuracy: 309/312 (99.0385%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.1834, Accuracy: 9434/10000 (94.3400%)
time spent on training: 48.5718035697937
Starting performing KrMLRFL...
Num data points: [78, 615, 633, 530, 548, 713, 1160, 471, 699, 312]
Num selected data points: [ 78 615 633 530 312]
The chosen ones are users: [0, 1, 2, 3, 9], which are global users: [76, 6, 8, 88, 21]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 27, 61]
base_p: [ 0.00045438  0.00034704 -0.00049252 ... -0.00039661  0.00807265
  0.001074  ]
[T_SCORE] attacker_local_idxs is:  [4, 5, 6, 7, 8]
layer1_inf_time: 3.18896484375
[PAIRWISE] pred_attackers_indx:  [6]
layer2_inf_t: 73.318115234375
assumed final_attacker_idxs:  [4 5 6 7 8]
final_attacker_idxs is: [4 5 6 7 8]
g_attacker_idxs: [ 2 82 12 27 61]
g_normal_idxs: [76  6  8 88 21]
filtered_attacker_idxs: [4, 5, 6, 7, 8]
final_attacker_idxs are: [4, 5, 6, 7, 8]
num_dps: [78, 615, 633, 530, 548, 713, 1160, 471, 699, 312]
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0403, Accuracy: 9868/10000 (98.6800%)
epoch_acc: 98.68
___Test Local_Simple poisoned: True, epoch: 109: Average loss: 13.8568, Accuracy: 27/8968 (0.3011%)
Done in 55.33096480369568 sec.
Server Epoch:110 choose agents : [35, 57, 43, 34, 76, 26, 92, 3, 13, 16].
___Train Local_Simple,  epoch 110, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 110, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0629, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch 110, local model 57, internal_epoch   1,  Average loss: 0.0009, Accuracy: 338/343 (98.5423%)
___Train Local_Simple,  epoch 110, local model 57, internal_epoch   2,  Average loss: 0.0010, Accuracy: 336/343 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0986, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch 110, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 403/408 (98.7745%)
___Train Local_Simple,  epoch 110, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 405/408 (99.2647%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0714, Accuracy: 9777/10000 (97.7700%)
poison local model 34 index 0
___Train Local_Simple,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0004, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1281, Accuracy: 9635/10000 (96.3500%)
___Train Local_Simple,  epoch 110, local model 76, internal_epoch   1,  Average loss: 0.0002, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 110, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0362, Accuracy: 9883/10000 (98.8300%)
poison local model 26 index 1
___Train Local_Simple,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 549/554 (99.0975%)
___Train Local_Simple,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1128, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch 110, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch 110, local model 92, internal_epoch   2,  Average loss: 0.0006, Accuracy: 926/937 (98.8260%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1287, Accuracy: 9552/10000 (95.5200%)
___Train Local_Simple,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0006, Accuracy: 912/923 (98.8082%)
___Train Local_Simple,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 914/923 (99.0249%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1156, Accuracy: 9627/10000 (96.2700%)
poison local model 13 index 2
___Train Local_Simple,  epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 727/734 (99.0463%)
___Train Local_Simple,  epoch 110, local model 13, internal_epoch   2,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1322, Accuracy: 9579/10000 (95.7900%)
poison local model 16 index 3
___Train Local_Simple,  epoch 110, local model 16, internal_epoch   1,  Average loss: 0.0008, Accuracy: 901/915 (98.4699%)
___Train Local_Simple,  epoch 110, local model 16, internal_epoch   2,  Average loss: 0.0003, Accuracy: 911/915 (99.5628%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1409, Accuracy: 9654/10000 (96.5400%)
time spent on training: 49.67530918121338
Starting performing KrMLRFL...
Num data points: [499, 343, 408, 413, 78, 554, 937, 923, 734, 915]
Num selected data points: [499 343 408  78]
The chosen ones are users: [0, 1, 2, 4], which are global users: [35, 57, 43, 76]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 26, 13, 16]
base_p: [ 8.4732473e-04  2.3235008e-04  3.0922783e-03 ... -4.6566129e-05
 -8.8819489e-03 -1.0642335e-03]
[T_SCORE] attacker_local_idxs is:  [3, 5, 6, 7, 8, 9]
layer1_inf_time: 3.744873046875
[PAIRWISE] pred_attackers_indx:  [2 3 5 7 8 9]
layer2_inf_t: 43.1650390625
assumed final_attacker_idxs:  [2 3 5 6 7 8 9]
final_attacker_idxs is: [2 3 5 6 7 8 9]
g_attacker_idxs: [43 34 26 92  3 13 16]
g_normal_idxs: [35 57 76]
filtered_attacker_idxs: [3, 5, 6, 7, 8, 9]
final_attacker_idxs are: [3, 5, 6, 7, 8, 9]
num_dps: [499, 343, 408, 413, 78, 554, 937, 923, 734, 915]
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0346, Accuracy: 9887/10000 (98.8700%)
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 110: Average loss: 12.7765, Accuracy: 28/8968 (0.3122%)
Done in 56.54545760154724 sec.
Server Epoch:111 choose agents : [53, 42, 38, 29, 92, 24, 85, 68, 45, 33].
___Train Local_Simple,  epoch 111, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 111, local model 53, internal_epoch   2,  Average loss: 0.0001, Accuracy: 738/739 (99.8647%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.2989, Accuracy: 9138/10000 (91.3800%)
poison local model 42 index 0
___Train Local_Simple,  epoch 111, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 111, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0406, Accuracy: 9856/10000 (98.5600%)
___Train Local_Simple,  epoch 111, local model 38, internal_epoch   1,  Average loss: 0.0004, Accuracy: 885/895 (98.8827%)
___Train Local_Simple,  epoch 111, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 894/895 (99.8883%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.2342, Accuracy: 9324/10000 (93.2400%)
___Train Local_Simple,  epoch 111, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 999/1002 (99.7006%)
___Train Local_Simple,  epoch 111, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0824, Accuracy: 9748/10000 (97.4800%)
___Train Local_Simple,  epoch 111, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 927/937 (98.9328%)
___Train Local_Simple,  epoch 111, local model 92, internal_epoch   2,  Average loss: 0.0005, Accuracy: 928/937 (99.0395%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1543, Accuracy: 9491/10000 (94.9100%)
___Train Local_Simple,  epoch 111, local model 24, internal_epoch   1,  Average loss: 0.0005, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 111, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0633, Accuracy: 9791/10000 (97.9100%)
poison local model 85 index 1
___Train Local_Simple,  epoch 111, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 111, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0474, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 490/494 (99.1903%)
___Train Local_Simple,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1223, Accuracy: 9626/10000 (96.2600%)
poison local model 45 index 2
___Train Local_Simple,  epoch 111, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 621/628 (98.8854%)
___Train Local_Simple,  epoch 111, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 625/628 (99.5223%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1138, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch 111, local model 33, internal_epoch   1,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Train Local_Simple,  epoch 111, local model 33, internal_epoch   2,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0669, Accuracy: 9781/10000 (97.8100%)
time spent on training: 48.77911376953125
Starting performing KrMLRFL...
Num data points: [739, 236, 895, 1002, 937, 379, 431, 494, 628, 623]
Num selected data points: [895 494 623]
The chosen ones are users: [2, 7, 9], which are global users: [38, 68, 33]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 85, 45]
base_p: [ 0.00035144  0.00025421  0.0015081  ... -0.00050256  0.00024437
  0.00100946]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 6, 8]
layer1_inf_time: 4.041259765625
[PAIRWISE] pred_attackers_indx:  [0 2 3 4 5]
layer2_inf_t: 354.197021484375
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 8]
final_attacker_idxs is: [0 1 2 3 4 5 6 8]
g_attacker_idxs: [53 42 38 29 92 24 85 45]
g_normal_idxs: [68 33]
filtered_attacker_idxs: [0, 1, 3, 4, 5, 6, 8]
final_attacker_idxs are: [0, 1, 3, 4, 5, 6, 8]
num_dps: [739, 236, 895, 1002, 937, 379, 431, 494, 628, 623]
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0794, Accuracy: 9739/10000 (97.3900%)
epoch_acc: 97.39
___Test Local_Simple poisoned: True, epoch: 111: Average loss: 17.3499, Accuracy: 0/8968 (0.0000%)
Done in 56.29376482963562 sec.
Server Epoch:112 choose agents : [10, 49, 41, 67, 42, 86, 48, 92, 8, 21].
___Train Local_Simple,  epoch 112, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 888/892 (99.5516%)
___Train Local_Simple,  epoch 112, local model 10, internal_epoch   2,  Average loss: 0.0002, Accuracy: 888/892 (99.5516%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1695, Accuracy: 9498/10000 (94.9800%)
___Train Local_Simple,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0006, Accuracy: 502/506 (99.2095%)
___Train Local_Simple,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1133, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch 112, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 594/606 (98.0198%)
___Train Local_Simple,  epoch 112, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1582, Accuracy: 9448/10000 (94.4800%)
___Train Local_Simple,  epoch 112, local model 67, internal_epoch   1,  Average loss: 0.0003, Accuracy: 992/998 (99.3988%)
___Train Local_Simple,  epoch 112, local model 67, internal_epoch   2,  Average loss: 0.0003, Accuracy: 989/998 (99.0982%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.0660, Accuracy: 9785/10000 (97.8500%)
poison local model 42 index 0
___Train Local_Simple,  epoch 112, local model 42, internal_epoch   1,  Average loss: 0.0016, Accuracy: 229/236 (97.0339%)
___Train Local_Simple,  epoch 112, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1760, Accuracy: 9483/10000 (94.8300%)
___Train Local_Simple,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0002, Accuracy: 249/250 (99.6000%)
___Train Local_Simple,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.0870, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch 112, local model 48, internal_epoch   1,  Average loss: 0.0013, Accuracy: 436/448 (97.3214%)
___Train Local_Simple,  epoch 112, local model 48, internal_epoch   2,  Average loss: 0.0006, Accuracy: 444/448 (99.1071%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1054, Accuracy: 9695/10000 (96.9500%)
___Train Local_Simple,  epoch 112, local model 92, internal_epoch   1,  Average loss: 0.0010, Accuracy: 918/937 (97.9723%)
___Train Local_Simple,  epoch 112, local model 92, internal_epoch   2,  Average loss: 0.0005, Accuracy: 930/937 (99.2529%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.3139, Accuracy: 9047/10000 (90.4700%)
___Train Local_Simple,  epoch 112, local model 8, internal_epoch   1,  Average loss: 0.0009, Accuracy: 625/633 (98.7362%)
___Train Local_Simple,  epoch 112, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 629/633 (99.3681%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.0662, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch 112, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 304/312 (97.4359%)
___Train Local_Simple,  epoch 112, local model 21, internal_epoch   2,  Average loss: 0.0011, Accuracy: 306/312 (98.0769%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1987, Accuracy: 9399/10000 (93.9900%)
time spent on training: 35.59666657447815
Starting performing KrMLRFL...
Num data points: [892, 506, 606, 998, 236, 250, 448, 937, 633, 312]
Num selected data points: [892 250 448 633 312]
The chosen ones are users: [0, 5, 6, 8, 9], which are global users: [10, 86, 48, 8, 21]
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.0411, Accuracy: 9867/10000 (98.6700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42]
base_p: [3.3590943e-04 2.5101379e-04 2.7941954e-03 ... 6.0522556e-04 2.7823076e-03
 3.0167401e-05]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 8]
layer1_inf_time: 3.149169921875
[PAIRWISE] pred_attackers_indx:  [0 1 2 4 6]
layer2_inf_t: 27.039794921875
assumed final_attacker_idxs:  [0 1 2 3 4 6 7 8]
final_attacker_idxs is: [0 1 2 3 4 6 7 8]
g_attacker_idxs: [10 49 41 67 42 48 92  8]
g_normal_idxs: [86 21]
filtered_attacker_idxs: [1, 2, 3, 4, 7]
final_attacker_idxs are: [1, 2, 3, 4, 7]
num_dps: [892, 506, 606, 998, 236, 250, 448, 937, 633, 312]
epoch_acc: 98.67
___Test Local_Simple poisoned: True, epoch: 112: Average loss: 13.7040, Accuracy: 18/8968 (0.2007%)
Done in 42.39173078536987 sec.
Server Epoch:113 choose agents : [52, 99, 38, 24, 20, 14, 86, 59, 36, 53].
poison local model 52 index 0
___Train Local_Simple,  epoch 113, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch 113, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1801, Accuracy: 9467/10000 (94.6700%)
___Train Local_Simple,  epoch 113, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 372/377 (98.6737%)
___Train Local_Simple,  epoch 113, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0507, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 113, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 894/895 (99.8883%)
___Train Local_Simple,  epoch 113, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 892/895 (99.6648%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0687, Accuracy: 9785/10000 (97.8500%)
___Train Local_Simple,  epoch 113, local model 24, internal_epoch   1,  Average loss: 0.0007, Accuracy: 373/379 (98.4169%)
___Train Local_Simple,  epoch 113, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0644, Accuracy: 9787/10000 (97.8700%)
poison local model 20 index 1
___Train Local_Simple,  epoch 113, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 421/429 (98.1352%)
___Train Local_Simple,  epoch 113, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 428/429 (99.7669%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.2477, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1046, Accuracy: 9712/10000 (97.1200%)
___Train Local_Simple,  epoch 113, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 113, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0819, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch 113, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch 113, local model 59, internal_epoch   2,  Average loss: 0.0006, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.2184, Accuracy: 9293/10000 (92.9300%)
___Train Local_Simple,  epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 991/1005 (98.6070%)
___Train Local_Simple,  epoch 113, local model 36, internal_epoch   2,  Average loss: 0.0003, Accuracy: 997/1005 (99.2040%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1861, Accuracy: 9450/10000 (94.5000%)
___Train Local_Simple,  epoch 113, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 113, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1478, Accuracy: 9543/10000 (95.4300%)
time spent on training: 44.26838970184326
Starting performing KrMLRFL...
Num data points: [253, 377, 895, 379, 429, 376, 250, 760, 1005, 739]
Num selected data points: [377 895 379 376 250]
The chosen ones are users: [1, 2, 3, 5, 6], which are global users: [99, 38, 24, 14, 86]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 20]
base_p: [ 0.00010091  0.00015761  0.00165654 ... -0.00369012 -0.00492408
 -0.00072461]
[T_SCORE] attacker_local_idxs is:  [0, 4, 7, 8, 9]
layer1_inf_time: 2.8212890625
[PAIRWISE] pred_attackers_indx:  [4 7 8]
layer2_inf_t: 272.50927734375
assumed final_attacker_idxs:  [0 4 7 8 9]
final_attacker_idxs is: [0 4 7 8 9]
g_attacker_idxs: [52 20 59 36 53]
g_normal_idxs: [99 38 24 14 86]
filtered_attacker_idxs: [0, 4, 7, 8, 9]
final_attacker_idxs are: [0, 4, 7, 8, 9]
num_dps: [253, 377, 895, 379, 429, 376, 250, 760, 1005, 739]
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0390, Accuracy: 9878/10000 (98.7800%)
epoch_acc: 98.78
___Test Local_Simple poisoned: True, epoch: 113: Average loss: 14.7681, Accuracy: 8/8968 (0.0892%)
Done in 51.23080563545227 sec.
Server Epoch:114 choose agents : [88, 93, 50, 49, 14, 96, 72, 79, 38, 28].
___Train Local_Simple,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0790, Accuracy: 9756/10000 (97.5600%)
poison local model 93 index 0
___Train Local_Simple,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.2472, Accuracy: 9250/10000 (92.5000%)
___Train Local_Simple,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 469/474 (98.9451%)
___Train Local_Simple,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0930, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch 114, local model 49, internal_epoch   1,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%)
___Train Local_Simple,  epoch 114, local model 49, internal_epoch   2,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0753, Accuracy: 9749/10000 (97.4900%)
___Train Local_Simple,  epoch 114, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch 114, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0748, Accuracy: 9796/10000 (97.9600%)
___Train Local_Simple,  epoch 114, local model 96, internal_epoch   1,  Average loss: 0.0005, Accuracy: 667/672 (99.2560%)
___Train Local_Simple,  epoch 114, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.1127, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 114, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 114, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0766, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch 114, local model 79, internal_epoch   1,  Average loss: 0.0005, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 114, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0462, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 114, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/895 (99.6648%)
___Train Local_Simple,  epoch 114, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0690, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch 114, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 498/501 (99.4012%)
___Train Local_Simple,  epoch 114, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0430, Accuracy: 9864/10000 (98.6400%)
time spent on training: 37.47205138206482
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93]
base_p: [ 0.00044967  0.00027719 -0.00026318 ... -0.00171036 -0.00045548
 -0.00022225]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 8, 9]
layer1_inf_time: 3.511962890625
Num data points: [530, 623, 474, 506, 376, 672, 731, 182, 895, 501]
Num selected data points: [530 474 506 376 731 182 895 501]
The chosen ones are users: [0, 2, 3, 4, 6, 7, 8, 9], which are global users: [88, 50, 49, 14, 72, 79, 38, 28]
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0323, Accuracy: 9893/10000 (98.9300%)
[PAIRWISE] pred_attackers_indx:  [1 5]
layer2_inf_t: 208.733642578125
assumed final_attacker_idxs:  [0 1 5 8 9]
final_attacker_idxs is: [0 1 5 8 9]
g_attacker_idxs: [88 93 96 38 28]
g_normal_idxs: [50 49 14 72 79]
filtered_attacker_idxs: [1, 5]
final_attacker_idxs are: [1, 5]
num_dps: [530, 623, 474, 506, 376, 672, 731, 182, 895, 501]
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: True, epoch: 114: Average loss: 14.7212, Accuracy: 10/8968 (0.1115%)
Done in 44.85844540596008 sec.
Server Epoch:115 choose agents : [72, 59, 80, 22, 31, 62, 54, 58, 24, 42].
___Train Local_Simple,  epoch 115, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 115, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0431, Accuracy: 9867/10000 (98.6700%)
___Train Local_Simple,  epoch 115, local model 59, internal_epoch   1,  Average loss: 0.0013, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 115, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 756/760 (99.4737%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.2522, Accuracy: 9193/10000 (91.9300%)
___Train Local_Simple,  epoch 115, local model 80, internal_epoch   1,  Average loss: 0.0003, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 115, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0989, Accuracy: 9731/10000 (97.3100%)
poison local model 22 index 0
___Train Local_Simple,  epoch 115, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 115, local model 22, internal_epoch   2,  Average loss: 0.0003, Accuracy: 580/583 (99.4854%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0799, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 830/835 (99.4012%)
___Train Local_Simple,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 833/835 (99.7605%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0848, Accuracy: 9750/10000 (97.5000%)
___Train Local_Simple,  epoch 115, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 115, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0571, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 115, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch 115, local model 54, internal_epoch   2,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0885, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 271/276 (98.1884%)
___Train Local_Simple,  epoch 115, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.4557, Accuracy: 9064/10000 (90.6400%)
___Train Local_Simple,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0003, Accuracy: 377/379 (99.4723%)
___Train Local_Simple,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0001, Accuracy: 379/379 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0506, Accuracy: 9839/10000 (98.3900%)
poison local model 42 index 1
___Train Local_Simple,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0410, Accuracy: 9869/10000 (98.6900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 42]
base_p: [ 0.00018708  0.00016961  0.0007914  ... -0.00109416 -0.00059814
 -0.00030236]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 9]
layer1_inf_time: 3.96044921875
[PAIRWISE] pred_attackers_indx:  [1 5 7 9]
layer2_inf_t: 100.0673828125
assumed final_attacker_idxs:  [1 2 3 4 5 7 9]
final_attacker_idxs is: [1 2 3 4 5 7 9]
g_attacker_idxs: [59 80 22 31 62 58 42]
g_normal_idxs: [72 54 24]
filtered_attacker_idxs: [1, 3, 9]
final_attacker_idxs are: [1, 3, 9]
num_dps: [731, 760, 431, 583, 835, 423, 519, 276, 379, 236]
epoch_acc: 98.83
time spent on training: 39.31054139137268
Starting performing KrMLRFL...
Num data points: [731, 760, 431, 583, 835, 423, 519, 276, 379, 236]
Num selected data points: [731 431 835 423 519 276 379]
The chosen ones are users: [0, 2, 4, 5, 6, 7, 8], which are global users: [72, 80, 31, 62, 54, 58, 24]
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0348, Accuracy: 9883/10000 (98.8300%)
___Test Local_Simple poisoned: True, epoch: 115: Average loss: 14.2767, Accuracy: 32/8968 (0.3568%)
Done in 46.23016881942749 sec.
Server Epoch:116 choose agents : [76, 96, 97, 23, 75, 77, 27, 3, 46, 82].
___Train Local_Simple,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0336, Accuracy: 9888/10000 (98.8800%)
___Train Local_Simple,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0005, Accuracy: 666/672 (99.1071%)
___Train Local_Simple,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 672/672 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0893, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch 116, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 116, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.1512, Accuracy: 9571/10000 (95.7100%)
___Train Local_Simple,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.1373, Accuracy: 9615/10000 (96.1500%)
___Train Local_Simple,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0558, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 116, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 581/589 (98.6418%)
___Train Local_Simple,  epoch 116, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 581/589 (98.6418%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0717, Accuracy: 9773/10000 (97.7300%)
poison local model 27 index 0
___Train Local_Simple,  epoch 116, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 466/471 (98.9384%)
___Train Local_Simple,  epoch 116, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 469/471 (99.5754%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.1913, Accuracy: 9436/10000 (94.3600%)
___Train Local_Simple,  epoch 116, local model 3, internal_epoch   1,  Average loss: 0.0009, Accuracy: 908/923 (98.3749%)
___Train Local_Simple,  epoch 116, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 916/923 (99.2416%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.1795, Accuracy: 9266/10000 (92.6600%)
___Train Local_Simple,  epoch 116, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 700/710 (98.5915%)
___Train Local_Simple,  epoch 116, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 695/710 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.1456, Accuracy: 9526/10000 (95.2600%)
___Train Local_Simple,  epoch 116, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 706/713 (99.0182%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27]
base_p: [ 0.00025216  0.00030485 -0.00108777 ... -0.00149094  0.00291075
  0.00042513]
[T_SCORE] attacker_local_idxs is:  [1, 5, 6, 7, 8]
layer1_inf_time: 3.013427734375
[PAIRWISE] pred_attackers_indx:  [6 7 8]
layer2_inf_t: 33.7080078125
assumed final_attacker_idxs:  [1 5 6 7 8]
final_attacker_idxs is: [1 5 6 7 8]
g_attacker_idxs: [96 77 27  3 46]
g_normal_idxs: [76 97 23 75 82]
filtered_attacker_idxs: [1, 5, 6, 7, 8]
final_attacker_idxs are: [1, 5, 6, 7, 8]
num_dps: [78, 672, 487, 293, 686, 589, 471, 923, 710, 713]
___Train Local_Simple,  epoch 116, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.4089, Accuracy: 8988/10000 (89.8800%)
time spent on training: 38.29142642021179
Starting performing KrMLRFL...
Num data points: [78, 672, 487, 293, 686, 589, 471, 923, 710, 713]
Num selected data points: [ 78 487 293 686 713]
The chosen ones are users: [0, 2, 3, 4, 9], which are global users: [76, 97, 23, 75, 82]
epoch_acc: 98.25
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0538, Accuracy: 9825/10000 (98.2500%)
___Test Local_Simple poisoned: True, epoch: 116: Average loss: 15.9442, Accuracy: 4/8968 (0.0446%)
Done in 44.261831760406494 sec.
Server Epoch:117 choose agents : [26, 45, 67, 43, 13, 71, 84, 76, 25, 94].
poison local model 26 index 0
___Train Local_Simple,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0009, Accuracy: 544/554 (98.1949%)
___Train Local_Simple,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0009, Accuracy: 545/554 (98.3755%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0631, Accuracy: 9794/10000 (97.9400%)
poison local model 45 index 1
___Train Local_Simple,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0013, Accuracy: 616/628 (98.0892%)
___Train Local_Simple,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 621/628 (98.8854%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.2581, Accuracy: 9301/10000 (93.0100%)
___Train Local_Simple,  epoch 117, local model 67, internal_epoch   1,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
___Train Local_Simple,  epoch 117, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.2048, Accuracy: 9357/10000 (93.5700%)
___Train Local_Simple,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0005, Accuracy: 404/408 (99.0196%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0515, Accuracy: 9831/10000 (98.3100%)
poison local model 13 index 2
___Train Local_Simple,  epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%)
___Train Local_Simple,  epoch 117, local model 13, internal_epoch   2,  Average loss: 0.0000, Accuracy: 733/734 (99.8638%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0865, Accuracy: 9722/10000 (97.2200%)
poison local model 71 index 3
___Train Local_Simple,  epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1363/1384 (98.4827%)
___Train Local_Simple,  epoch 117, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1377/1384 (99.4942%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.6252, Accuracy: 8731/10000 (87.3100%)
___Train Local_Simple,  epoch 117, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1228/1246 (98.5554%)
___Train Local_Simple,  epoch 117, local model 84, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1232/1246 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0796, Accuracy: 9759/10000 (97.5900%)
___Train Local_Simple,  epoch 117, local model 76, internal_epoch   1,  Average loss: 0.0008, Accuracy: 76/78 (97.4359%)
___Train Local_Simple,  epoch 117, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0473, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch 117, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 639/647 (98.7635%)
___Train Local_Simple,  epoch 117, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.1609, Accuracy: 9496/10000 (94.9600%)
___Train Local_Simple,  epoch 117, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 117, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 45, 13, 71]
base_p: [ 0.00110791 -0.00084039  0.00179727 ...  0.00224923 -0.00851775
 -0.00170605]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 5, 6]
layer1_inf_time: 4.1728515625
[PAIRWISE] pred_attackers_indx:  [0 1 4 5]
layer2_inf_t: 125.657958984375
assumed final_attacker_idxs:  [0 1 2 4 5 6]
final_attacker_idxs is: [0 1 2 4 5 6]
g_attacker_idxs: [26 45 67 13 71 84]
g_normal_idxs: [43 76 25 94]
filtered_attacker_idxs: [0, 1, 2, 4, 5, 6]
final_attacker_idxs are: [0, 1, 2, 4, 5, 6]
num_dps: [554, 628, 998, 408, 734, 1384, 1246, 78, 647, 150]
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0891, Accuracy: 9716/10000 (97.1600%)
time spent on training: 49.30031681060791
Starting performing KrMLRFL...
Num data points: [554, 628, 998, 408, 734, 1384, 1246, 78, 647, 150]
Num selected data points: [408  78 647 150]
The chosen ones are users: [3, 7, 8, 9], which are global users: [43, 76, 25, 94]
epoch_acc: 98.27
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0501, Accuracy: 9827/10000 (98.2700%)
___Test Local_Simple poisoned: True, epoch: 117: Average loss: 13.0438, Accuracy: 40/8968 (0.4460%)
Done in 55.416900396347046 sec.
Server Epoch:118 choose agents : [22, 34, 40, 46, 26, 19, 80, 62, 14, 24].
poison local model 22 index 0
___Train Local_Simple,  epoch 118, local model 22, internal_epoch   1,  Average loss: 0.0016, Accuracy: 568/583 (97.4271%)
___Train Local_Simple,  epoch 118, local model 22, internal_epoch   2,  Average loss: 0.0006, Accuracy: 576/583 (98.7993%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.2351, Accuracy: 9224/10000 (92.2400%)
poison local model 34 index 1
___Train Local_Simple,  epoch 118, local model 34, internal_epoch   1,  Average loss: 0.0003, Accuracy: 410/413 (99.2736%)
___Train Local_Simple,  epoch 118, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.1976, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch 118, local model 40, internal_epoch   1,  Average loss: 0.0006, Accuracy: 764/772 (98.9637%)
___Train Local_Simple,  epoch 118, local model 40, internal_epoch   2,  Average loss: 0.0004, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.1664, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch 118, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 695/710 (97.8873%)
___Train Local_Simple,  epoch 118, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 702/710 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.1649, Accuracy: 9458/10000 (94.5800%)
poison local model 26 index 2
___Train Local_Simple,  epoch 118, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 548/554 (98.9170%)
___Train Local_Simple,  epoch 118, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0695, Accuracy: 9790/10000 (97.9000%)
___Train Local_Simple,  epoch 118, local model 19, internal_epoch   1,  Average loss: 0.0009, Accuracy: 200/205 (97.5610%)
___Train Local_Simple,  epoch 118, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.2703, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0640, Accuracy: 9810/10000 (98.1000%)
___Train Local_Simple,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0005, Accuracy: 419/423 (99.0544%)
___Train Local_Simple,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0582, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 118, local model 14, internal_epoch   1,  Average loss: 0.0004, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch 118, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.1298, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0009, Accuracy: 371/379 (97.8892%)
___Train Local_Simple,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 377/379 (99.4723%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 34, 26]
base_p: [-2.0096451e-04  1.8562004e-04  1.1250377e-05 ... -1.3296008e-03
 -1.0620229e-02 -1.7102510e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 4]
layer1_inf_time: 3.93115234375
[PAIRWISE] pred_attackers_indx:  [0 3]
layer2_inf_t: 257.197998046875
assumed final_attacker_idxs:  [0 1 2 3 4]
final_attacker_idxs is: [0 1 2 3 4]
g_attacker_idxs: [22 34 40 46 26]
g_normal_idxs: [19 80 62 14 24]
filtered_attacker_idxs: [0, 1, 2, 3, 4]
final_attacker_idxs are: [0, 1, 2, 3, 4]
num_dps: [583, 413, 772, 710, 554, 205, 431, 423, 376, 379]
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0960, Accuracy: 9694/10000 (96.9400%)
time spent on training: 42.686113119125366
Starting performing KrMLRFL...
Num data points: [583, 413, 772, 710, 554, 205, 431, 423, 376, 379]
Num selected data points: [205 431 423 376 379]
The chosen ones are users: [5, 6, 7, 8, 9], which are global users: [19, 80, 62, 14, 24]
epoch_acc: 98.91
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0357, Accuracy: 9891/10000 (98.9100%)
___Test Local_Simple poisoned: True, epoch: 118: Average loss: 13.2733, Accuracy: 23/8968 (0.2565%)
Done in 49.74294900894165 sec.
Server Epoch:119 choose agents : [26, 9, 89, 40, 45, 94, 67, 51, 1, 44].
poison local model 26 index 0
___Train Local_Simple,  epoch 119, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 119, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0574, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 119, local model 9, internal_epoch   1,  Average loss: 0.0005, Accuracy: 429/436 (98.3945%)
___Train Local_Simple,  epoch 119, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 432/436 (99.0826%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0714, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch 119, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 119, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0723, Accuracy: 9770/10000 (97.7000%)
___Train Local_Simple,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 767/772 (99.3523%)
___Train Local_Simple,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 771/772 (99.8705%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0886, Accuracy: 9745/10000 (97.4500%)
poison local model 45 index 1
___Train Local_Simple,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 622/628 (99.0446%)
___Train Local_Simple,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0842, Accuracy: 9745/10000 (97.4500%)
___Train Local_Simple,  epoch 119, local model 94, internal_epoch   1,  Average loss: 0.0008, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 119, local model 94, internal_epoch   2,  Average loss: 0.0002, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.1327, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch 119, local model 67, internal_epoch   1,  Average loss: 0.0002, Accuracy: 993/998 (99.4990%)
___Train Local_Simple,  epoch 119, local model 67, internal_epoch   2,  Average loss: 0.0003, Accuracy: 992/998 (99.3988%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.1660, Accuracy: 9527/10000 (95.2700%)
poison local model 51 index 2
___Train Local_Simple,  epoch 119, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 561/568 (98.7676%)
___Train Local_Simple,  epoch 119, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 565/568 (99.4718%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.1165, Accuracy: 9630/10000 (96.3000%)
poison local model 1 index 3
___Train Local_Simple,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 750/760 (98.6842%)
___Train Local_Simple,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0008, Accuracy: 748/760 (98.4211%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.2182, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch 119, local model 44, internal_epoch   1,  Average loss: 0.0006, Accuracy: 511/517 (98.8395%)
___Train Local_Simple,  epoch 119, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0730, Accuracy: 9774/10000 (97.7400%)
time spent on training: 49.58948874473572
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 45, 51, 1]
base_p: [ 1.0424480e-03  2.2244081e-04  4.9323775e-05 ...  2.2046268e-04
 -2.2861362e-03  5.5859238e-04]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 7, 8]
layer1_inf_time: 4.216552734375
[PAIRWISE] pred_attackers_indx:  [2 3 7]
layer2_inf_t: 137.667724609375
assumed final_attacker_idxs:  [0 2 3 4 6 7 8]
final_attacker_idxs is: [0 2 3 4 6 7 8]
g_attacker_idxs: [26 89 40 45 67 51  1]
g_normal_idxs: [ 9 94 44]
filtered_attacker_idxs: [0, 3, 4, 6, 7, 8]
final_attacker_idxs are: [0, 3, 4, 6, 7, 8]
num_dps: [554, 436, 492, 772, 628, 150, 998, 568, 760, 517]
Starting performing KrMLRFL...
Num data points: [554, 436, 492, 772, 628, 150, 998, 568, 760, 517]
Num selected data points: [436 492 150 517]
The chosen ones are users: [1, 2, 5, 9], which are global users: [9, 89, 94, 44]
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0351, Accuracy: 9893/10000 (98.9300%)
___Test Local_Simple poisoned: True, epoch: 119: Average loss: 13.8913, Accuracy: 16/8968 (0.1784%)
Done in 55.611292600631714 sec.
Server Epoch:120 choose agents : [83, 45, 42, 87, 19, 2, 72, 4, 7, 52].
___Train Local_Simple,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0516, Accuracy: 9840/10000 (98.4000%)
poison local model 45 index 0
___Train Local_Simple,  epoch 120, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 617/628 (98.2484%)
___Train Local_Simple,  epoch 120, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 621/628 (98.8854%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.1508, Accuracy: 9509/10000 (95.0900%)
poison local model 42 index 1
___Train Local_Simple,  epoch 120, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 120, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0455, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 120, local model 87, internal_epoch   1,  Average loss: 0.0003, Accuracy: 467/470 (99.3617%)
___Train Local_Simple,  epoch 120, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0949, Accuracy: 9715/10000 (97.1500%)
___Train Local_Simple,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0003, Accuracy: 204/205 (99.5122%)
___Train Local_Simple,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0550, Accuracy: 9817/10000 (98.1700%)
poison local model 2 index 2
___Train Local_Simple,  epoch 120, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 541/548 (98.7226%)
___Train Local_Simple,  epoch 120, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 545/548 (99.4526%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.1216, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 729/731 (99.7264%)
___Train Local_Simple,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.1136, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch 120, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 649/658 (98.6322%)
___Train Local_Simple,  epoch 120, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 652/658 (99.0881%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.2355, Accuracy: 9284/10000 (92.8400%)
poison local model 7 index 3
___Train Local_Simple,  epoch 120, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 411/418 (98.3254%)
___Train Local_Simple,  epoch 120, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.2143, Accuracy: 9424/10000 (94.2400%)
poison local model 52 index 0
___Train Local_Simple,  epoch 120, local model 52, internal_epoch   1,  Average loss: 0.0003, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 120, local model 52, internal_epoch   2,  Average loss: 0.0000, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.1030, Accuracy: 9702/10000 (97.0200%)
time spent on training: 63.75014400482178
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 42, 2, 7, 52]
base_p: [ 0.00024127  0.00016122  0.00062903 ... -0.00171633 -0.00237209
  0.00024966]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 8, 9]
layer1_inf_time: 4.51806640625
[PAIRWISE] pred_attackers_indx:  [1 6 7]
layer2_inf_t: 130.751220703125
assumed final_attacker_idxs:  [1 2 5 6 7 8 9]
final_attacker_idxs is: [1 2 5 6 7 8 9]
g_attacker_idxs: [45 42  2 72  4  7 52]
g_normal_idxs: [83 87 19]
filtered_attacker_idxs: [1, 2, 5, 7, 8, 9]
final_attacker_idxs are: [1, 2, 5, 7, 8, 9]
num_dps: [433, 628, 236, 470, 205, 548, 731, 658, 418, 253]
Starting performing KrMLRFL...
Num data points: [433, 628, 236, 470, 205, 548, 731, 658, 418, 253]
Num selected data points: [433 470 205 731]
The chosen ones are users: [0, 3, 4, 6], which are global users: [83, 87, 19, 72]
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0370, Accuracy: 9885/10000 (98.8500%)
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: True, epoch: 120: Average loss: 12.9795, Accuracy: 40/8968 (0.4460%)
Done in 70.5500693321228 sec.
Server Epoch:121 choose agents : [91, 95, 30, 2, 92, 86, 78, 48, 18, 28].
poison local model 91 index 0
___Train Local_Simple,  epoch 121, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 121, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0658, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch 121, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 121, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.1074, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch 121, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch 121, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0840, Accuracy: 9746/10000 (97.4600%)
poison local model 2 index 1
___Train Local_Simple,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 541/548 (98.7226%)
___Train Local_Simple,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0001, Accuracy: 548/548 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.1003, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch 121, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 121, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 934/937 (99.6798%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.1725, Accuracy: 9419/10000 (94.1900%)
___Train Local_Simple,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0003, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0829, Accuracy: 9753/10000 (97.5300%)
___Train Local_Simple,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 299/303 (98.6799%)
___Train Local_Simple,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.1325, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch 121, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch 121, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0459, Accuracy: 9856/10000 (98.5600%)
___Train Local_Simple,  epoch 121, local model 18, internal_epoch   1,  Average loss: 0.0008, Accuracy: 449/459 (97.8214%)
___Train Local_Simple,  epoch 121, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 457/459 (99.5643%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.3968, Accuracy: 9079/10000 (90.7900%)
___Train Local_Simple,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 498/501 (99.4012%)
___Train Local_Simple,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 2]
base_p: [ 4.0172040e-04  2.0456314e-04  4.1364040e-04 ... -7.0993602e-04
 -4.5430511e-03  1.1764467e-05]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 8]
layer1_inf_time: 3.508056640625
[PAIRWISE] pred_attackers_indx:  [3 6 8]
layer2_inf_t: 190.20263671875
assumed final_attacker_idxs:  [0 1 3 4 6 8]
final_attacker_idxs is: [0 1 3 4 6 8]
g_attacker_idxs: [91 95  2 92 78 18]
g_normal_idxs: [30 86 48 28]
filtered_attacker_idxs: [0, 1, 3, 4]
final_attacker_idxs are: [0, 1, 3, 4]
num_dps: [256, 602, 400, 548, 937, 250, 303, 448, 459, 501]
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0827, Accuracy: 9751/10000 (97.5100%)
time spent on training: 40.61216759681702
Starting performing KrMLRFL...
Num data points: [256, 602, 400, 548, 937, 250, 303, 448, 459, 501]
Num selected data points: [400 250 303 448 459 501]
The chosen ones are users: [2, 5, 6, 7, 8, 9], which are global users: [30, 86, 78, 48, 18, 28]
epoch_acc: 98.72
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0402, Accuracy: 9872/10000 (98.7200%)
___Test Local_Simple poisoned: True, epoch: 121: Average loss: 14.7386, Accuracy: 4/8968 (0.0446%)
Done in 47.327871799468994 sec.
Server Epoch:122 choose agents : [68, 70, 48, 49, 61, 85, 9, 91, 86, 57].
___Train Local_Simple,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 489/494 (98.9879%)
___Train Local_Simple,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0947, Accuracy: 9699/10000 (96.9900%)
poison local model 70 index 0
___Train Local_Simple,  epoch 122, local model 70, internal_epoch   1,  Average loss: 0.0006, Accuracy: 716/724 (98.8950%)
___Train Local_Simple,  epoch 122, local model 70, internal_epoch   2,  Average loss: 0.0005, Accuracy: 718/724 (99.1713%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.1218, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch 122, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch 122, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0421, Accuracy: 9856/10000 (98.5600%)
___Train Local_Simple,  epoch 122, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%)
___Train Local_Simple,  epoch 122, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 503/506 (99.4071%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0733, Accuracy: 9768/10000 (97.6800%)
poison local model 61 index 1
___Train Local_Simple,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 687/699 (98.2833%)
___Train Local_Simple,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0003, Accuracy: 694/699 (99.2847%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.5161, Accuracy: 8355/10000 (83.5500%)
poison local model 85 index 2
___Train Local_Simple,  epoch 122, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 122, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0495, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 122, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 122, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.1154, Accuracy: 9647/10000 (96.4700%)
poison local model 91 index 3
___Train Local_Simple,  epoch 122, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 122, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0639, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 122, local model 86, internal_epoch   1,  Average loss: 0.0003, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 122, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0647, Accuracy: 9805/10000 (98.0500%)
___Train Local_Simple,  epoch 122, local model 57, internal_epoch   1,  Average loss: 0.0013, Accuracy: 336/343 (97.9592%)
___Train Local_Simple,  epoch 122, local model 57, internal_epoch   2,  Average loss: 0.0008, Accuracy: 337/343 (98.2507%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 61, 85, 91]
base_p: [ 0.00019817  0.00016637 -0.00045309 ... -0.00262083  0.00215646
 -0.00148526]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 7, 9]
layer1_inf_time: 4.333740234375
[PAIRWISE] pred_attackers_indx:  [4 9]
layer2_inf_t: 156.890380859375
assumed final_attacker_idxs:  [1 4 5 7 9]
final_attacker_idxs is: [1 4 5 7 9]
g_attacker_idxs: [70 61 85 91 57]
g_normal_idxs: [68 48 49  9 86]
filtered_attacker_idxs: [1, 4, 5, 7]
final_attacker_idxs are: [1, 4, 5, 7]
num_dps: [494, 724, 448, 506, 699, 431, 436, 256, 250, 343]
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.3242, Accuracy: 9053/10000 (90.5300%)
time spent on training: 59.11069297790527
Starting performing KrMLRFL...
Num data points: [494, 724, 448, 506, 699, 431, 436, 256, 250, 343]
Num selected data points: [494 448 506 436 250 343]
The chosen ones are users: [0, 2, 3, 6, 8, 9], which are global users: [68, 48, 49, 9, 86, 57]
epoch_acc: 98.94
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0331, Accuracy: 9894/10000 (98.9400%)
___Test Local_Simple poisoned: True, epoch: 122: Average loss: 14.1836, Accuracy: 8/8968 (0.0892%)
Done in 64.97661399841309 sec.
Server Epoch:123 choose agents : [15, 30, 86, 55, 11, 69, 59, 60, 95, 29].
___Train Local_Simple,  epoch 123, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 398/401 (99.2519%)
___Train Local_Simple,  epoch 123, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0803, Accuracy: 9753/10000 (97.5300%)
___Train Local_Simple,  epoch 123, local model 30, internal_epoch   1,  Average loss: 0.0001, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch 123, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.1034, Accuracy: 9678/10000 (96.7800%)
___Train Local_Simple,  epoch 123, local model 86, internal_epoch   1,  Average loss: 0.0002, Accuracy: 249/250 (99.6000%)
___Train Local_Simple,  epoch 123, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0578, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 123, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 347/354 (98.0226%)
___Train Local_Simple,  epoch 123, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.4442, Accuracy: 8736/10000 (87.3600%)
poison local model 11 index 0
___Train Local_Simple,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 639/645 (99.0698%)
___Train Local_Simple,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 644/645 (99.8450%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.2277, Accuracy: 9431/10000 (94.3100%)
___Train Local_Simple,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0663, Accuracy: 9789/10000 (97.8900%)
___Train Local_Simple,  epoch 123, local model 59, internal_epoch   1,  Average loss: 0.0007, Accuracy: 754/760 (99.2105%)
___Train Local_Simple,  epoch 123, local model 59, internal_epoch   2,  Average loss: 0.0003, Accuracy: 757/760 (99.6053%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.2925, Accuracy: 9110/10000 (91.1000%)
___Train Local_Simple,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0007, Accuracy: 333/338 (98.5207%)
___Train Local_Simple,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.1081, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch 123, local model 95, internal_epoch   1,  Average loss: 0.0001, Accuracy: 600/602 (99.6678%)
___Train Local_Simple,  epoch 123, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.1274, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch 123, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%)
___Train Local_Simple,  epoch 123, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0833, Accuracy: 9725/10000 (97.2500%)
time spent on training: 35.35372877120972
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11]
base_p: [ 3.6969781e-04  1.9641966e-04  3.2963697e-05 ... -3.8667023e-04
 -6.3760579e-04 -2.1614134e-05]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 7, 8]
layer1_inf_time: 4.23583984375
[PAIRWISE] pred_attackers_indx:  [3 4 6]
layer2_inf_t: 92.65234375
assumed final_attacker_idxs:  [0 3 4 6 7 8]
final_attacker_idxs is: [0 3 4 6 7 8]
g_attacker_idxs: [15 55 11 59 60 95]
g_normal_idxs: [30 86 69 29]
filtered_attacker_idxs: [4, 6, 7, 8]
final_attacker_idxs are: [4, 6, 7, 8]
num_dps: [401, 400, 250, 354, 645, 256, 760, 338, 602, 1002]
Starting performing KrMLRFL...
Num data points: [401, 400, 250, 354, 645, 256, 760, 338, 602, 1002]
Num selected data points: [ 401  400  250  354  256 1002]
The chosen ones are users: [0, 1, 2, 3, 5, 9], which are global users: [15, 30, 86, 55, 69, 29]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0382, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 123: Average loss: 13.5225, Accuracy: 26/8968 (0.2899%)
Done in 41.632622957229614 sec.
Server Epoch:124 choose agents : [37, 94, 29, 55, 21, 2, 92, 61, 40, 88].
___Train Local_Simple,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 856/860 (99.5349%)
___Train Local_Simple,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 852/860 (99.0698%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0956, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1310, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0535, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0004, Accuracy: 350/354 (98.8701%)
___Train Local_Simple,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.2184, Accuracy: 9346/10000 (93.4600%)
___Train Local_Simple,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 308/312 (98.7179%)
___Train Local_Simple,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1370, Accuracy: 9545/10000 (95.4500%)
poison local model 2 index 0
___Train Local_Simple,  epoch 124, local model 2, internal_epoch   1,  Average loss: 0.0011, Accuracy: 540/548 (98.5401%)
___Train Local_Simple,  epoch 124, local model 2, internal_epoch   2,  Average loss: 0.0005, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1754, Accuracy: 9452/10000 (94.5200%)
___Train Local_Simple,  epoch 124, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 124, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 930/937 (99.2529%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.2530, Accuracy: 9189/10000 (91.8900%)
poison local model 61 index 1
___Train Local_Simple,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0006, Accuracy: 690/699 (98.7124%)
___Train Local_Simple,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0003, Accuracy: 695/699 (99.4278%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.4667, Accuracy: 8482/10000 (84.8200%)
___Train Local_Simple,  epoch 124, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 767/772 (99.3523%)
___Train Local_Simple,  epoch 124, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0841, Accuracy: 9740/10000 (97.4000%)
___Train Local_Simple,  epoch 124, local model 88, internal_epoch   1,  Average loss: 0.0004, Accuracy: 529/530 (99.8113%)
___Train Local_Simple,  epoch 124, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 526/530 (99.2453%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 61]
base_p: [ 1.8525869e-04  2.6518479e-04 -7.7635562e-04 ...  1.2158900e-03
  2.0962134e-03  8.1717968e-05]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 3.949462890625
[PAIRWISE] pred_attackers_indx:  [0 8 9]
layer2_inf_t: 349.542724609375
assumed final_attacker_idxs:  [0 5 6 7 8 9]
final_attacker_idxs is: [0 5 6 7 8 9]
g_attacker_idxs: [37  2 92 61 40 88]
g_normal_idxs: [94 29 55 21]
filtered_attacker_idxs: [5, 6, 7, 8]
final_attacker_idxs are: [5, 6, 7, 8]
num_dps: [860, 150, 1002, 354, 312, 548, 937, 699, 772, 530]
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.5672, Accuracy: 8954/10000 (89.5400%)
time spent on training: 42.8480703830719
Starting performing KrMLRFL...
Num data points: [860, 150, 1002, 354, 312, 548, 937, 699, 772, 530]
Num selected data points: [ 860  150 1002  354  312  530]
The chosen ones are users: [0, 1, 2, 3, 4, 9], which are global users: [37, 94, 29, 55, 21, 88]
epoch_acc: 98.67
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0411, Accuracy: 9867/10000 (98.6700%)
___Test Local_Simple poisoned: True, epoch: 124: Average loss: 13.0958, Accuracy: 23/8968 (0.2565%)
Done in 50.73159122467041 sec.
Server Epoch:125 choose agents : [82, 53, 22, 44, 39, 85, 4, 84, 46, 69].
___Train Local_Simple,  epoch 125, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch 125, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.5374, Accuracy: 8775/10000 (87.7500%)
___Train Local_Simple,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1564, Accuracy: 9492/10000 (94.9200%)
poison local model 22 index 0
___Train Local_Simple,  epoch 125, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 125, local model 22, internal_epoch   2,  Average loss: 0.0003, Accuracy: 580/583 (99.4854%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0927, Accuracy: 9716/10000 (97.1600%)
___Train Local_Simple,  epoch 125, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 513/517 (99.2263%)
___Train Local_Simple,  epoch 125, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 515/517 (99.6132%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1063, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch 125, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch 125, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0569, Accuracy: 9831/10000 (98.3100%)
poison local model 85 index 1
___Train Local_Simple,  epoch 125, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 125, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0492, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 125, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 645/658 (98.0243%)
___Train Local_Simple,  epoch 125, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 654/658 (99.3921%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1741, Accuracy: 9454/10000 (94.5400%)
___Train Local_Simple,  epoch 125, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1227/1246 (98.4751%)
___Train Local_Simple,  epoch 125, local model 84, internal_epoch   2,  Average loss: 0.0011, Accuracy: 1219/1246 (97.8331%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1102, Accuracy: 9657/10000 (96.5700%)
___Train Local_Simple,  epoch 125, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/710 (99.4366%)
___Train Local_Simple,  epoch 125, local model 46, internal_epoch   2,  Average loss: 0.0002, Accuracy: 708/710 (99.7183%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1050, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 125, local model 69, internal_epoch   1,  Average loss: 0.0006, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 125, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 85]
base_p: [-1.7365292e-03  5.2846968e-05 -1.4459393e-03 ... -9.1460347e-04
 -2.2481307e-03  1.3161674e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6, 7, 8]
layer1_inf_time: 4.65478515625
[PAIRWISE] pred_attackers_indx:  [0 1 6 8 9]
layer2_inf_t: 46.92626953125
assumed final_attacker_idxs:  [0 1 2 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 5 6 7 8 9]
g_attacker_idxs: [82 53 22 85  4 84 46 69]
g_normal_idxs: [44 39]
filtered_attacker_idxs: [0, 1, 2, 5, 6, 7, 8]
final_attacker_idxs are: [0, 1, 2, 5, 6, 7, 8]
num_dps: [713, 739, 583, 517, 257, 431, 658, 1246, 710, 256]
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1003, Accuracy: 9660/10000 (96.6000%)
time spent on training: 41.935126543045044
Starting performing KrMLRFL...
Num data points: [713, 739, 583, 517, 257, 431, 658, 1246, 710, 256]
Num selected data points: [517 257 256]
The chosen ones are users: [3, 4, 9], which are global users: [44, 39, 69]
epoch_acc: 98.65
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0406, Accuracy: 9865/10000 (98.6500%)
___Test Local_Simple poisoned: True, epoch: 125: Average loss: 13.6417, Accuracy: 9/8968 (0.1004%)
Done in 50.72788882255554 sec.
Server Epoch:126 choose agents : [1, 3, 16, 55, 51, 43, 89, 32, 94, 54].
poison local model 1 index 0
___Train Local_Simple,  epoch 126, local model 1, internal_epoch   1,  Average loss: 0.0004, Accuracy: 757/760 (99.6053%)
___Train Local_Simple,  epoch 126, local model 1, internal_epoch   2,  Average loss: 0.0005, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0983, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch 126, local model 3, internal_epoch   1,  Average loss: 0.0006, Accuracy: 914/923 (99.0249%)
___Train Local_Simple,  epoch 126, local model 3, internal_epoch   2,  Average loss: 0.0002, Accuracy: 920/923 (99.6750%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1045, Accuracy: 9712/10000 (97.1200%)
poison local model 16 index 1
___Train Local_Simple,  epoch 126, local model 16, internal_epoch   1,  Average loss: 0.0008, Accuracy: 900/915 (98.3607%)
___Train Local_Simple,  epoch 126, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 908/915 (99.2350%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0707, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch 126, local model 55, internal_epoch   1,  Average loss: 0.0007, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch 126, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 352/354 (99.4350%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.2864, Accuracy: 9118/10000 (91.1800%)
poison local model 51 index 2
___Train Local_Simple,  epoch 126, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 126, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1306, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch 126, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 126, local model 43, internal_epoch   2,  Average loss: 0.0005, Accuracy: 405/408 (99.2647%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0488, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 126, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 126, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0755, Accuracy: 9769/10000 (97.6900%)
___Train Local_Simple,  epoch 126, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 963/977 (98.5670%)
___Train Local_Simple,  epoch 126, local model 32, internal_epoch   2,  Average loss: 0.0006, Accuracy: 966/977 (98.8741%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1836, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch 126, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 126, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0830, Accuracy: 9735/10000 (97.3500%)
___Train Local_Simple,  epoch 126, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch 126, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 16, 51]
base_p: [ 0.00088373  0.0001941   0.00155164 ...  0.0043584   0.00191548
 -0.00024992]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 7]
layer1_inf_time: 3.8193359375
[PAIRWISE] pred_attackers_indx:  [2 3 4 6 7]
layer2_inf_t: 59.791748046875
assumed final_attacker_idxs:  [0 1 2 3 4 6 7]
final_attacker_idxs is: [0 1 2 3 4 6 7]
g_attacker_idxs: [ 1  3 16 55 51 89 32]
g_normal_idxs: [43 94 54]
filtered_attacker_idxs: [0, 1, 2, 4, 7]
final_attacker_idxs are: [0, 1, 2, 4, 7]
num_dps: [760, 923, 915, 354, 568, 408, 492, 977, 150, 519]
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1063, Accuracy: 9667/10000 (96.6700%)
time spent on training: 53.564180850982666
Starting performing KrMLRFL...
Num data points: [760, 923, 915, 354, 568, 408, 492, 977, 150, 519]
Num selected data points: [354 408 492 150 519]
The chosen ones are users: [3, 5, 6, 8, 9], which are global users: [55, 43, 89, 94, 54]
epoch_acc: 98.65
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0422, Accuracy: 9865/10000 (98.6500%)
___Test Local_Simple poisoned: True, epoch: 126: Average loss: 13.2940, Accuracy: 24/8968 (0.2676%)
Done in 60.40086507797241 sec.
Server Epoch:127 choose agents : [53, 94, 92, 75, 27, 52, 78, 35, 29, 41].
___Train Local_Simple,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0001, Accuracy: 738/739 (99.8647%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1228, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1778, Accuracy: 9427/10000 (94.2700%)
___Train Local_Simple,  epoch 127, local model 92, internal_epoch   1,  Average loss: 0.0010, Accuracy: 920/937 (98.1857%)
___Train Local_Simple,  epoch 127, local model 92, internal_epoch   2,  Average loss: 0.0008, Accuracy: 920/937 (98.1857%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1740, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch 127, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch 127, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0442, Accuracy: 9864/10000 (98.6400%)
poison local model 27 index 0
___Train Local_Simple,  epoch 127, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 464/471 (98.5138%)
___Train Local_Simple,  epoch 127, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1518, Accuracy: 9550/10000 (95.5000%)
poison local model 52 index 1
___Train Local_Simple,  epoch 127, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 247/253 (97.6285%)
___Train Local_Simple,  epoch 127, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1308, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch 127, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch 127, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1250, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch 127, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 127, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0534, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 127, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Train Local_Simple,  epoch 127, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0737, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch 127, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%)
___Train Local_Simple,  epoch 127, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 604/606 (99.6700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 52]
base_p: [-0.00102231  0.0002297   0.00120349 ... -0.00383432 -0.00504321
 -0.0003116 ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 8]
layer1_inf_time: 4.26416015625
[PAIRWISE] pred_attackers_indx:  [0 1 2 3 4 5]
layer2_inf_t: 84.836181640625
assumed final_attacker_idxs:  [0 1 2 3 4 5 8]
final_attacker_idxs is: [0 1 2 3 4 5 8]
g_attacker_idxs: [53 94 92 75 27 52 29]
g_normal_idxs: [78 35 41]
filtered_attacker_idxs: [0, 2, 4, 5, 8]
final_attacker_idxs are: [0, 2, 4, 5, 8]
num_dps: [739, 150, 937, 686, 471, 253, 303, 499, 1002, 606]
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0948, Accuracy: 9683/10000 (96.8300%)
time spent on training: 39.1917405128479
Starting performing KrMLRFL...
Num data points: [739, 150, 937, 686, 471, 253, 303, 499, 1002, 606]
Num selected data points: [150 686 303 499 606]
The chosen ones are users: [1, 3, 6, 7, 9], which are global users: [94, 75, 78, 35, 41]
epoch_acc: 98.89
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0355, Accuracy: 9889/10000 (98.8900%)
___Test Local_Simple poisoned: True, epoch: 127: Average loss: 14.0651, Accuracy: 11/8968 (0.1227%)
Done in 43.565053939819336 sec.
Server Epoch:128 choose agents : [38, 61, 45, 57, 19, 53, 67, 98, 62, 65].
___Train Local_Simple,  epoch 128, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 891/895 (99.5531%)
___Train Local_Simple,  epoch 128, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 892/895 (99.6648%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1252, Accuracy: 9605/10000 (96.0500%)
poison local model 61 index 0
___Train Local_Simple,  epoch 128, local model 61, internal_epoch   1,  Average loss: 0.0007, Accuracy: 692/699 (98.9986%)
___Train Local_Simple,  epoch 128, local model 61, internal_epoch   2,  Average loss: 0.0002, Accuracy: 696/699 (99.5708%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.3527, Accuracy: 8937/10000 (89.3700%)
poison local model 45 index 1
___Train Local_Simple,  epoch 128, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 622/628 (99.0446%)
___Train Local_Simple,  epoch 128, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1085, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch 128, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 340/343 (99.1254%)
___Train Local_Simple,  epoch 128, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 342/343 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.2151, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch 128, local model 19, internal_epoch   1,  Average loss: 0.0003, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch 128, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0486, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 128, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 728/739 (98.5115%)
___Train Local_Simple,  epoch 128, local model 53, internal_epoch   2,  Average loss: 0.0006, Accuracy: 732/739 (99.0528%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.2472, Accuracy: 9200/10000 (92.0000%)
___Train Local_Simple,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0002, Accuracy: 991/998 (99.2986%)
___Train Local_Simple,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0005, Accuracy: 986/998 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1866, Accuracy: 9404/10000 (94.0400%)
___Train Local_Simple,  epoch 128, local model 98, internal_epoch   1,  Average loss: 0.0005, Accuracy: 811/818 (99.1443%)
___Train Local_Simple,  epoch 128, local model 98, internal_epoch   2,  Average loss: 0.0002, Accuracy: 816/818 (99.7555%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1370, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch 128, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 128, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0584, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 128, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 128, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0663, Accuracy: 9781/10000 (97.8100%)
time spent on training: 62.40902256965637
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 45]
base_p: [ 0.00020319  0.00023454 -0.00092463 ...  0.00241596  0.00130825
  0.00042614]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 6, 7]
layer1_inf_time: 4.105224609375
[PAIRWISE] pred_attackers_indx:  [1 2 3 6]
layer2_inf_t: 291.099853515625
assumed final_attacker_idxs:  [1 2 3 5 6 7]
final_attacker_idxs is: [1 2 3 5 6 7]
g_attacker_idxs: [61 45 57 53 67 98]
g_normal_idxs: [38 19 62 65]
filtered_attacker_idxs: [1, 2, 5, 6, 7]
final_attacker_idxs are: [1, 2, 5, 6, 7]
num_dps: [895, 699, 628, 343, 205, 739, 998, 818, 423, 371]
Starting performing KrMLRFL...
Num data points: [895, 699, 628, 343, 205, 739, 998, 818, 423, 371]
Num selected data points: [895 343 205 423 371]
The chosen ones are users: [0, 3, 4, 8, 9], which are global users: [38, 57, 19, 62, 65]
epoch_acc: 98.7
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0388, Accuracy: 9870/10000 (98.7000%)
___Test Local_Simple poisoned: True, epoch: 128: Average loss: 15.2461, Accuracy: 4/8968 (0.0446%)
Done in 70.85587954521179 sec.
Server Epoch:129 choose agents : [91, 9, 42, 71, 78, 68, 19, 23, 20, 28].
poison local model 91 index 0
___Train Local_Simple,  epoch 129, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 129, local model 91, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0674, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch 129, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 129, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0722, Accuracy: 9767/10000 (97.6700%)
poison local model 42 index 1
___Train Local_Simple,  epoch 129, local model 42, internal_epoch   1,  Average loss: 0.0007, Accuracy: 232/236 (98.3051%)
___Train Local_Simple,  epoch 129, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0711, Accuracy: 9773/10000 (97.7300%)
poison local model 71 index 2
___Train Local_Simple,  epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1372/1384 (99.1329%)
___Train Local_Simple,  epoch 129, local model 71, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1382/1384 (99.8555%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.2221, Accuracy: 9310/10000 (93.1000%)
___Train Local_Simple,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0002, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.1242, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch 129, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 129, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 492/494 (99.5951%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0657, Accuracy: 9781/10000 (97.8100%)
___Train Local_Simple,  epoch 129, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 129, local model 19, internal_epoch   2,  Average loss: 0.0002, Accuracy: 204/205 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0844, Accuracy: 9748/10000 (97.4800%)
___Train Local_Simple,  epoch 129, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 129, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0463, Accuracy: 9851/10000 (98.5100%)
poison local model 20 index 3
___Train Local_Simple,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 420/429 (97.9021%)
___Train Local_Simple,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 425/429 (99.0676%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.2341, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch 129, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 499/501 (99.6008%)
___Train Local_Simple,  epoch 129, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0469, Accuracy: 9850/10000 (98.5000%)
time spent on training: 51.04435634613037
Starting performing KrMLRFL...
Num data points: [256, 436, 236, 1384, 303, 494, 205, 293, 429, 501]
Num selected data points: [436 303 494 205 293 501]
The chosen ones are users: [1, 4, 5, 6, 7, 9], which are global users: [9, 78, 68, 19, 23, 28]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 42, 71, 20]
base_p: [ 0.00019611  0.0001633  -0.00061521 ... -0.00208047 -0.00157556
  0.00016464]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 8, 9]
layer1_inf_time: 4.900634765625
[PAIRWISE] pred_attackers_indx:  [3 8]
layer2_inf_t: 166.886474609375
assumed final_attacker_idxs:  [0 2 3 8 9]
final_attacker_idxs is: [0 2 3 8 9]
g_attacker_idxs: [91 42 71 20 28]
g_normal_idxs: [ 9 78 68 19 23]
filtered_attacker_idxs: [0, 2, 3, 8]
final_attacker_idxs are: [0, 2, 3, 8]
num_dps: [256, 436, 236, 1384, 303, 494, 205, 293, 429, 501]
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0338, Accuracy: 9890/10000 (98.9000%)
epoch_acc: 98.9
___Test Local_Simple poisoned: True, epoch: 129: Average loss: 15.9080, Accuracy: 3/8968 (0.0335%)
Done in 56.62399482727051 sec.
Server Epoch:130 choose agents : [39, 57, 6, 94, 26, 99, 32, 33, 7, 73].
___Train Local_Simple,  epoch 130, local model 39, internal_epoch   1,  Average loss: 0.0003, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 130, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0569, Accuracy: 9821/10000 (98.2100%)
___Train Local_Simple,  epoch 130, local model 57, internal_epoch   1,  Average loss: 0.0005, Accuracy: 340/343 (99.1254%)
___Train Local_Simple,  epoch 130, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 341/343 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.2046, Accuracy: 9375/10000 (93.7500%)
___Train Local_Simple,  epoch 130, local model 6, internal_epoch   1,  Average loss: 0.0003, Accuracy: 612/615 (99.5122%)
___Train Local_Simple,  epoch 130, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 611/615 (99.3496%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0534, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch 130, local model 94, internal_epoch   1,  Average loss: 0.0011, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 130, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.1120, Accuracy: 9620/10000 (96.2000%)
poison local model 26 index 0
___Train Local_Simple,  epoch 130, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 130, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0515, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0000, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0403, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 130, local model 32, internal_epoch   1,  Average loss: 0.0007, Accuracy: 967/977 (98.9765%)
___Train Local_Simple,  epoch 130, local model 32, internal_epoch   2,  Average loss: 0.0004, Accuracy: 971/977 (99.3859%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.1192, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0420, Accuracy: 9865/10000 (98.6500%)
poison local model 7 index 1
___Train Local_Simple,  epoch 130, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 411/418 (98.3254%)
___Train Local_Simple,  epoch 130, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0936, Accuracy: 9704/10000 (97.0400%)
poison local model 73 index 2
___Train Local_Simple,  epoch 130, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%)
___Train Local_Simple,  epoch 130, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0658, Accuracy: 9778/10000 (97.7800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 7, 73]
base_p: [ 0.00096939  0.00018264 -0.00080298 ... -0.00197369 -0.00167195
  0.00028409]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 8, 9]
layer1_inf_time: 2.778564453125
[PAIRWISE] pred_attackers_indx:  [6 9]
layer2_inf_t: 34.289794921875
assumed final_attacker_idxs:  [1 4 6 8 9]
final_attacker_idxs is: [1 4 6 8 9]
g_attacker_idxs: [57 26 32  7 73]
g_normal_idxs: [39  6 94 99 33]
filtered_attacker_idxs: [4, 6, 8, 9]
final_attacker_idxs are: [4, 6, 8, 9]
num_dps: [257, 343, 615, 150, 554, 377, 977, 623, 418, 591]
time spent on training: 47.5551221370697
Starting performing KrMLRFL...
Num data points: [257, 343, 615, 150, 554, 377, 977, 623, 418, 591]
Num selected data points: [257 343 615 150 377 623]
The chosen ones are users: [0, 1, 2, 3, 5, 7], which are global users: [39, 57, 6, 94, 99, 33]
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0316, Accuracy: 9902/10000 (99.0200%)
epoch_acc: 99.02
___Test Local_Simple poisoned: True, epoch: 130: Average loss: 14.5087, Accuracy: 14/8968 (0.1561%)
Done in 56.866270780563354 sec.
Server Epoch:131 choose agents : [66, 3, 2, 14, 43, 81, 63, 64, 34, 98].
___Train Local_Simple,  epoch 131, local model 66, internal_epoch   1,  Average loss: 0.0010, Accuracy: 646/660 (97.8788%)
___Train Local_Simple,  epoch 131, local model 66, internal_epoch   2,  Average loss: 0.0006, Accuracy: 649/660 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.5158, Accuracy: 8667/10000 (86.6700%)
___Train Local_Simple,  epoch 131, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 912/923 (98.8082%)
___Train Local_Simple,  epoch 131, local model 3, internal_epoch   2,  Average loss: 0.0002, Accuracy: 919/923 (99.5666%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1656, Accuracy: 9425/10000 (94.2500%)
poison local model 2 index 0
___Train Local_Simple,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1124, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch 131, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch 131, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0631, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0407, Accuracy: 9866/10000 (98.6600%)
poison local model 81 index 1
___Train Local_Simple,  epoch 131, local model 81, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1219/1227 (99.3480%)
___Train Local_Simple,  epoch 131, local model 81, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1211/1227 (98.6960%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.2811, Accuracy: 9184/10000 (91.8400%)
poison local model 63 index 2
___Train Local_Simple,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 870/889 (97.8628%)
___Train Local_Simple,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0009, Accuracy: 876/889 (98.5377%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0816, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 809/813 (99.5080%)
___Train Local_Simple,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0004, Accuracy: 809/813 (99.5080%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1389, Accuracy: 9513/10000 (95.1300%)
poison local model 34 index 3
___Train Local_Simple,  epoch 131, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%)
___Train Local_Simple,  epoch 131, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0634, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 131, local model 98, internal_epoch   1,  Average loss: 0.0004, Accuracy: 810/818 (99.0220%)
___Train Local_Simple,  epoch 131, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 810/818 (99.0220%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1623, Accuracy: 9497/10000 (94.9700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 81, 63, 34]
base_p: [ 0.00204518  0.00028241 -0.00094524 ...  0.00193787 -0.00050766
 -0.0013027 ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6, 7, 8, 9]
layer1_inf_time: 4.060546875
[PAIRWISE] pred_attackers_indx:  [0 1 5 7 9]
layer2_inf_t: 35.10546875
assumed final_attacker_idxs:  [0 1 2 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 5 6 7 8 9]
g_attacker_idxs: [66  3  2 81 63 64 34 98]
g_normal_idxs: [14 43]
filtered_attacker_idxs: [0, 1, 2, 5, 6, 8, 9]
final_attacker_idxs are: [0, 1, 2, 5, 6, 8, 9]
num_dps: [660, 923, 548, 376, 408, 1227, 889, 813, 413, 818]
time spent on training: 158.55158734321594
Starting performing KrMLRFL...
Num data points: [660, 923, 548, 376, 408, 1227, 889, 813, 413, 818]
Num selected data points: [376 408 813]
The chosen ones are users: [3, 4, 7], which are global users: [14, 43, 64]
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0415, Accuracy: 9864/10000 (98.6400%)
epoch_acc: 98.64
___Test Local_Simple poisoned: True, epoch: 131: Average loss: 13.4598, Accuracy: 24/8968 (0.2676%)
Done in 171.28025126457214 sec.
Server Epoch:132 choose agents : [54, 58, 51, 55, 72, 42, 69, 93, 80, 15].
___Train Local_Simple,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0003, Accuracy: 514/519 (99.0366%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0532, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 276/276 (100.0000%)
___Train Local_Simple,  epoch 132, local model 58, internal_epoch   2,  Average loss: 0.0002, Accuracy: 275/276 (99.6377%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0805, Accuracy: 9733/10000 (97.3300%)
poison local model 51 index 0
___Train Local_Simple,  epoch 132, local model 51, internal_epoch   1,  Average loss: 0.0011, Accuracy: 560/568 (98.5915%)
___Train Local_Simple,  epoch 132, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.1290, Accuracy: 9546/10000 (95.4600%)
___Train Local_Simple,  epoch 132, local model 55, internal_epoch   1,  Average loss: 0.0005, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch 132, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.3474, Accuracy: 9011/10000 (90.1100%)
___Train Local_Simple,  epoch 132, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 729/731 (99.7264%)
___Train Local_Simple,  epoch 132, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0954, Accuracy: 9704/10000 (97.0400%)
poison local model 42 index 1
___Train Local_Simple,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0460, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 132, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 132, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0898, Accuracy: 9698/10000 (96.9800%)
poison local model 93 index 2
___Train Local_Simple,  epoch 132, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Train Local_Simple,  epoch 132, local model 93, internal_epoch   2,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.2093, Accuracy: 9439/10000 (94.3900%)
___Train Local_Simple,  epoch 132, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 132, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0555, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 132, local model 15, internal_epoch   1,  Average loss: 0.0011, Accuracy: 394/401 (98.2544%)
___Train Local_Simple,  epoch 132, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.1597, Accuracy: 9589/10000 (95.8900%)
time spent on training: 46.9491024017334
Starting performing KrMLRFL...
Num data points: [519, 276, 568, 354, 731, 236, 256, 623, 431, 401]
Num selected data points: [519 276 354 731 256 431 401]
The chosen ones are users: [0, 1, 3, 4, 6, 8, 9], which are global users: [54, 58, 55, 72, 69, 80, 15]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 42, 93]
base_p: [-0.00026186  0.00014443  0.00094812 ...  0.00301901  0.00474089
  0.00066039]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 7, 9]
layer1_inf_time: 3.95703125
[PAIRWISE] pred_attackers_indx:  [4 7 8]
layer2_inf_t: 51.11767578125
assumed final_attacker_idxs:  [2 3 4 5 7 8 9]
final_attacker_idxs is: [2 3 4 5 7 8 9]
g_attacker_idxs: [51 55 72 42 93 80 15]
g_normal_idxs: [54 58 69]
filtered_attacker_idxs: [2, 5, 7]
final_attacker_idxs are: [2, 5, 7]
num_dps: [519, 276, 568, 354, 731, 236, 256, 623, 431, 401]
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0313, Accuracy: 9893/10000 (98.9300%)
___Test Local_Simple poisoned: True, epoch: 132: Average loss: 14.7659, Accuracy: 8/8968 (0.0892%)
Done in 53.8410108089447 sec.
Server Epoch:133 choose agents : [56, 32, 45, 76, 63, 81, 78, 59, 13, 19].
___Train Local_Simple,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 876/880 (99.5455%)
___Train Local_Simple,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0561, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 133, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 961/977 (98.3623%)
___Train Local_Simple,  epoch 133, local model 32, internal_epoch   2,  Average loss: 0.0006, Accuracy: 964/977 (98.6694%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.1184, Accuracy: 9588/10000 (95.8800%)
poison local model 45 index 0
___Train Local_Simple,  epoch 133, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 621/628 (98.8854%)
___Train Local_Simple,  epoch 133, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 625/628 (99.5223%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.1225, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch 133, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 133, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0309, Accuracy: 9900/10000 (99.0000%)
poison local model 63 index 1
___Train Local_Simple,  epoch 133, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 870/889 (97.8628%)
___Train Local_Simple,  epoch 133, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 881/889 (99.1001%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0524, Accuracy: 9822/10000 (98.2200%)
poison local model 81 index 2
___Train Local_Simple,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1220/1227 (99.4295%)
___Train Local_Simple,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1210/1227 (98.6145%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.8712, Accuracy: 8129/10000 (81.2900%)
___Train Local_Simple,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0735, Accuracy: 9771/10000 (97.7100%)
___Train Local_Simple,  epoch 133, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch 133, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 745/760 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.2442, Accuracy: 9273/10000 (92.7300%)
poison local model 13 index 3
___Train Local_Simple,  epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 728/734 (99.1826%)
___Train Local_Simple,  epoch 133, local model 13, internal_epoch   2,  Average loss: 0.0001, Accuracy: 732/734 (99.7275%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0966, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0702, Accuracy: 9778/10000 (97.7800%)
time spent on training: 52.63343334197998
Starting performing KrMLRFL...
Num data points: [880, 977, 628, 78, 889, 1227, 303, 760, 734, 205]
Num selected data points: [880  78 303 205]
The chosen ones are users: [0, 3, 6, 9], which are global users: [56, 76, 78, 19]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 63, 81, 13]
base_p: [ 1.6259104e-03  2.6479363e-04  1.2650117e-03 ... -8.8796020e-05
 -6.3001364e-04 -2.3381785e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 5, 7, 8]
layer1_inf_time: 2.954345703125
[PAIRWISE] pred_attackers_indx:  [1 2 4 5 8]
layer2_inf_t: 35.677490234375
assumed final_attacker_idxs:  [1 2 4 5 7 8]
final_attacker_idxs is: [1 2 4 5 7 8]
g_attacker_idxs: [32 45 63 81 59 13]
g_normal_idxs: [56 76 78 19]
filtered_attacker_idxs: [1, 2, 4, 5, 7, 8]
final_attacker_idxs are: [1, 2, 4, 5, 7, 8]
num_dps: [880, 977, 628, 78, 889, 1227, 303, 760, 734, 205]
epoch_acc: 98.88
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0346, Accuracy: 9888/10000 (98.8800%)
___Test Local_Simple poisoned: True, epoch: 133: Average loss: 15.8640, Accuracy: 8/8968 (0.0892%)
Done in 60.25206232070923 sec.
Server Epoch:134 choose agents : [85, 46, 71, 25, 11, 70, 83, 24, 65, 68].
poison local model 85 index 0
___Train Local_Simple,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0826, Accuracy: 9735/10000 (97.3500%)
___Train Local_Simple,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 705/710 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.1415, Accuracy: 9522/10000 (95.2200%)
poison local model 71 index 1
___Train Local_Simple,  epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1375/1384 (99.3497%)
___Train Local_Simple,  epoch 134, local model 71, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1378/1384 (99.5665%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.1276, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch 134, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 645/647 (99.6909%)
___Train Local_Simple,  epoch 134, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 645/647 (99.6909%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0975, Accuracy: 9685/10000 (96.8500%)
poison local model 11 index 2
___Train Local_Simple,  epoch 134, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 636/645 (98.6047%)
___Train Local_Simple,  epoch 134, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 641/645 (99.3798%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.3021, Accuracy: 9144/10000 (91.4400%)
poison local model 70 index 3
___Train Local_Simple,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0005, Accuracy: 713/724 (98.4807%)
___Train Local_Simple,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0008, Accuracy: 716/724 (98.8950%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.1400, Accuracy: 9548/10000 (95.4800%)
___Train Local_Simple,  epoch 134, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Train Local_Simple,  epoch 134, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0386, Accuracy: 9872/10000 (98.7200%)
___Train Local_Simple,  epoch 134, local model 24, internal_epoch   1,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 134, local model 24, internal_epoch   2,  Average loss: 0.0001, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0717, Accuracy: 9767/10000 (97.6700%)
___Train Local_Simple,  epoch 134, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 134, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0587, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 134, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 492/494 (99.5951%)
___Train Local_Simple,  epoch 134, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 71, 11, 70]
base_p: [ 0.00027113  0.00025304 -0.00045435 ... -0.00177857 -0.00302511
 -0.00205394]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 5]
layer1_inf_time: 3.595703125
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0475, Accuracy: 9847/10000 (98.4700%)
time spent on training: 75.84106302261353
Starting performing KrMLRFL...
Num data points: [431, 710, 1384, 647, 645, 724, 433, 379, 371, 494]
Num selected data points: [647 433 379 371 494]
The chosen ones are users: [3, 6, 7, 8, 9], which are global users: [25, 83, 24, 65, 68]
[PAIRWISE] pred_attackers_indx:  [2 4 5]
layer2_inf_t: 626.6640625
assumed final_attacker_idxs:  [0 1 2 4 5]
final_attacker_idxs is: [0 1 2 4 5]
g_attacker_idxs: [85 46 71 11 70]
g_normal_idxs: [25 83 24 65 68]
filtered_attacker_idxs: [0, 1, 2, 4, 5]
final_attacker_idxs are: [0, 1, 2, 4, 5]
num_dps: [431, 710, 1384, 647, 645, 724, 433, 379, 371, 494]
epoch_acc: 98.98
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0317, Accuracy: 9898/10000 (98.9800%)
___Test Local_Simple poisoned: True, epoch: 134: Average loss: 15.4867, Accuracy: 15/8968 (0.1673%)
Done in 84.0476942062378 sec.
Server Epoch:135 choose agents : [13, 77, 92, 8, 70, 84, 35, 9, 22, 90].
poison local model 13 index 0
___Train Local_Simple,  epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 721/734 (98.2289%)
___Train Local_Simple,  epoch 135, local model 13, internal_epoch   2,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1729, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch 135, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 581/589 (98.6418%)
___Train Local_Simple,  epoch 135, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 582/589 (98.8115%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0704, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1661, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0003, Accuracy: 628/633 (99.2101%)
___Train Local_Simple,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 631/633 (99.6840%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0543, Accuracy: 9829/10000 (98.2900%)
poison local model 70 index 1
___Train Local_Simple,  epoch 135, local model 70, internal_epoch   1,  Average loss: 0.0007, Accuracy: 712/724 (98.3425%)
___Train Local_Simple,  epoch 135, local model 70, internal_epoch   2,  Average loss: 0.0006, Accuracy: 713/724 (98.4807%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1334, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch 135, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1232/1246 (98.8764%)
___Train Local_Simple,  epoch 135, local model 84, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1231/1246 (98.7961%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0792, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch 135, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 135, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0559, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0623, Accuracy: 9801/10000 (98.0100%)
poison local model 22 index 2
___Train Local_Simple,  epoch 135, local model 22, internal_epoch   1,  Average loss: 0.0010, Accuracy: 573/583 (98.2847%)
___Train Local_Simple,  epoch 135, local model 22, internal_epoch   2,  Average loss: 0.0007, Accuracy: 575/583 (98.6278%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1382, Accuracy: 9530/10000 (95.3000%)
___Train Local_Simple,  epoch 135, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 678/683 (99.2679%)
___Train Local_Simple,  epoch 135, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.2557, Accuracy: 9180/10000 (91.8000%)
time spent on training: 40.96352767944336
Starting performing KrMLRFL...
Num data points: [734, 589, 937, 633, 724, 1246, 499, 436, 583, 683]
Num selected data points: [633 499 436 683]
The chosen ones are users: [3, 6, 7, 9], which are global users: [8, 35, 9, 90]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 70, 22]
base_p: [ 0.00108     0.00017916  0.0016213  ... -0.00258483 -0.0022311
 -0.0012895 ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 5, 8]
layer1_inf_time: 3.61083984375
[PAIRWISE] pred_attackers_indx:  [0 5]
layer2_inf_t: 36.801025390625
assumed final_attacker_idxs:  [0 1 2 4 5 8]
final_attacker_idxs is: [0 1 2 4 5 8]
g_attacker_idxs: [13 77 92 70 84 22]
g_normal_idxs: [ 8 35  9 90]
filtered_attacker_idxs: [0, 1, 2, 4, 5, 8]
final_attacker_idxs are: [0, 1, 2, 4, 5, 8]
num_dps: [734, 589, 937, 633, 724, 1246, 499, 436, 583, 683]
epoch_acc: 98.87
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0335, Accuracy: 9887/10000 (98.8700%)
___Test Local_Simple poisoned: True, epoch: 135: Average loss: 14.7612, Accuracy: 13/8968 (0.1450%)
Done in 44.84653639793396 sec.
Server Epoch:136 choose agents : [11, 77, 46, 32, 88, 6, 67, 15, 4, 66].
poison local model 11 index 0
___Train Local_Simple,  epoch 136, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 631/645 (97.8295%)
___Train Local_Simple,  epoch 136, local model 11, internal_epoch   2,  Average loss: 0.0002, Accuracy: 643/645 (99.6899%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1803, Accuracy: 9468/10000 (94.6800%)
___Train Local_Simple,  epoch 136, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 575/589 (97.6231%)
___Train Local_Simple,  epoch 136, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 583/589 (98.9813%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0862, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch 136, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch 136, local model 46, internal_epoch   2,  Average loss: 0.0041, Accuracy: 671/710 (94.5070%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.6074, Accuracy: 8214/10000 (82.1400%)
___Train Local_Simple,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0014, Accuracy: 955/977 (97.7482%)
___Train Local_Simple,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0015, Accuracy: 948/977 (97.0317%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1752, Accuracy: 9419/10000 (94.1900%)
___Train Local_Simple,  epoch 136, local model 88, internal_epoch   1,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch 136, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0603, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0521, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 991/998 (99.2986%)
___Train Local_Simple,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0003, Accuracy: 991/998 (99.2986%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1660, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 398/401 (99.2519%)
___Train Local_Simple,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 397/401 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0835, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch 136, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 651/658 (98.9362%)
___Train Local_Simple,  epoch 136, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 654/658 (99.3921%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1481, Accuracy: 9585/10000 (95.8500%)
___Train Local_Simple,  epoch 136, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 651/660 (98.6364%)
___Train Local_Simple,  epoch 136, local model 66, internal_epoch   2,  Average loss: 0.0003, Accuracy: 656/660 (99.3939%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1221, Accuracy: 9584/10000 (95.8400%)
time spent on training: 33.724029541015625
Starting performing KrMLRFL...
Num data points: [645, 589, 710, 977, 530, 615, 998, 401, 658, 660]
Num selected data points: [589 530 615 401 658]
The chosen ones are users: [1, 4, 5, 7, 8], which are global users: [77, 88, 6, 15, 4]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11]
base_p: [-0.00065889  0.00018325 -0.00123129 ... -0.0033007  -0.00189542
 -0.00195262]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 6, 9]
layer1_inf_time: 4.4990234375
[PAIRWISE] pred_attackers_indx:  [0 3]
layer2_inf_t: 219.72802734375
assumed final_attacker_idxs:  [0 2 3 6 9]
final_attacker_idxs is: [0 2 3 6 9]
g_attacker_idxs: [11 46 32 67 66]
g_normal_idxs: [77 88  6 15  4]
filtered_attacker_idxs: [0, 2, 3, 6, 9]
final_attacker_idxs are: [0, 2, 3, 6, 9]
num_dps: [645, 589, 710, 977, 530, 615, 998, 401, 658, 660]
epoch_acc: 98.97
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0332, Accuracy: 9897/10000 (98.9700%)
___Test Local_Simple poisoned: True, epoch: 136: Average loss: 14.4271, Accuracy: 9/8968 (0.1004%)
Done in 38.400503396987915 sec.
Server Epoch:137 choose agents : [16, 42, 69, 68, 41, 61, 82, 45, 15, 21].
poison local model 16 index 0
___Train Local_Simple,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0008, Accuracy: 899/915 (98.2514%)
___Train Local_Simple,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0002, Accuracy: 911/915 (99.5628%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0640, Accuracy: 9805/10000 (98.0500%)
poison local model 42 index 1
___Train Local_Simple,  epoch 137, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 137, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0497, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch 137, local model 69, internal_epoch   1,  Average loss: 0.0003, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 137, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0704, Accuracy: 9778/10000 (97.7800%)
___Train Local_Simple,  epoch 137, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 137, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0947, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%)
___Train Local_Simple,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 599/606 (98.8449%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.9435, Accuracy: 7949/10000 (79.4900%)
poison local model 61 index 2
___Train Local_Simple,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 691/699 (98.8555%)
___Train Local_Simple,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 697/699 (99.7139%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.3299, Accuracy: 8814/10000 (88.1400%)
___Train Local_Simple,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.3690, Accuracy: 9048/10000 (90.4800%)
poison local model 45 index 3
___Train Local_Simple,  epoch 137, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 137, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0901, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch 137, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Train Local_Simple,  epoch 137, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0481, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 311/312 (99.6795%)
___Train Local_Simple,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0816, Accuracy: 9732/10000 (97.3200%)
time spent on training: 48.348140478134155
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 42, 61, 45]
base_p: [ 0.00070529  0.00018467  0.00135572 ... -0.00140756 -0.00080319
 -0.00060052]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 6, 7]
layer1_inf_time: 2.987548828125
[PAIRWISE] pred_attackers_indx:  [0 4 7]
layer2_inf_t: 37.847900390625
assumed final_attacker_idxs:  [0 1 4 5 6 7]
final_attacker_idxs is: [0 1 4 5 6 7]
g_attacker_idxs: [16 42 41 61 82 45]
g_normal_idxs: [69 68 15 21]
filtered_attacker_idxs: [0, 1, 4, 5, 6, 7]
final_attacker_idxs are: [0, 1, 4, 5, 6, 7]
num_dps: [915, 236, 256, 494, 606, 699, 713, 628, 401, 312]
Starting performing KrMLRFL...
Num data points: [915, 236, 256, 494, 606, 699, 713, 628, 401, 312]
Num selected data points: [256 494 401 312]
The chosen ones are users: [2, 3, 8, 9], which are global users: [69, 68, 15, 21]
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0346, Accuracy: 9889/10000 (98.8900%)
epoch_acc: 98.89
___Test Local_Simple poisoned: True, epoch: 137: Average loss: 14.7396, Accuracy: 12/8968 (0.1338%)
Done in 53.74831032752991 sec.
Server Epoch:138 choose agents : [54, 24, 11, 9, 53, 63, 78, 93, 61, 45].
___Train Local_Simple,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%)
___Train Local_Simple,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0437, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 138, local model 24, internal_epoch   1,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 138, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0505, Accuracy: 9852/10000 (98.5200%)
poison local model 11 index 0
___Train Local_Simple,  epoch 138, local model 11, internal_epoch   1,  Average loss: 0.0020, Accuracy: 636/645 (98.6047%)
___Train Local_Simple,  epoch 138, local model 11, internal_epoch   2,  Average loss: 0.0053, Accuracy: 586/645 (90.8527%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.3670, Accuracy: 8875/10000 (88.7500%)
___Train Local_Simple,  epoch 138, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 138, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.1082, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.3869, Accuracy: 8924/10000 (89.2400%)
poison local model 63 index 1
___Train Local_Simple,  epoch 138, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 876/889 (98.5377%)
___Train Local_Simple,  epoch 138, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 879/889 (98.8751%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0558, Accuracy: 9814/10000 (98.1400%)
___Train Local_Simple,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.1395, Accuracy: 9583/10000 (95.8300%)
poison local model 93 index 2
___Train Local_Simple,  epoch 138, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 617/623 (99.0369%)
___Train Local_Simple,  epoch 138, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.5243, Accuracy: 8763/10000 (87.6300%)
poison local model 61 index 3
___Train Local_Simple,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 687/699 (98.2833%)
___Train Local_Simple,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0003, Accuracy: 696/699 (99.5708%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.2478, Accuracy: 9144/10000 (91.4400%)
poison local model 45 index 0
___Train Local_Simple,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0015, Accuracy: 611/628 (97.2930%)
___Train Local_Simple,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 619/628 (98.5669%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.1879, Accuracy: 9393/10000 (93.9300%)
time spent on training: 58.06069278717041
Starting performing KrMLRFL...
Num data points: [519, 379, 645, 436, 739, 889, 303, 623, 699, 628]
Num selected data points: [519 379 436 303]
The chosen ones are users: [0, 1, 3, 6], which are global users: [54, 24, 9, 78]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 63, 93, 61, 45]
base_p: [ 0.00210252  0.00018965  0.00241457 ... -0.00075151  0.00658141
  0.00043619]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 8, 9]
layer1_inf_time: 2.773193359375
[PAIRWISE] pred_attackers_indx:  [2 7 9]
layer2_inf_t: 33.65478515625
assumed final_attacker_idxs:  [2 4 5 7 8 9]
final_attacker_idxs is: [2 4 5 7 8 9]
g_attacker_idxs: [11 53 63 93 61 45]
g_normal_idxs: [54 24  9 78]
filtered_attacker_idxs: [2, 4, 5, 7, 8, 9]
final_attacker_idxs are: [2, 4, 5, 7, 8, 9]
num_dps: [519, 379, 645, 436, 739, 889, 303, 623, 699, 628]
epoch_acc: 98.87
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0362, Accuracy: 9887/10000 (98.8700%)
___Test Local_Simple poisoned: True, epoch: 138: Average loss: 15.2721, Accuracy: 9/8968 (0.1004%)
Done in 64.34992551803589 sec.
Server Epoch:139 choose agents : [23, 48, 95, 57, 33, 52, 35, 60, 12, 65].
___Train Local_Simple,  epoch 139, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 139, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.1025, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch 139, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 443/448 (98.8839%)
___Train Local_Simple,  epoch 139, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0544, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 139, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 596/602 (99.0033%)
___Train Local_Simple,  epoch 139, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 1.1078, Accuracy: 8035/10000 (80.3500%)
___Train Local_Simple,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 339/343 (98.8338%)
___Train Local_Simple,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 341/343 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.2472, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch 139, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 139, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0418, Accuracy: 9870/10000 (98.7000%)
poison local model 52 index 0
___Train Local_Simple,  epoch 139, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch 139, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0843, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0003, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0877, Accuracy: 9750/10000 (97.5000%)
___Train Local_Simple,  epoch 139, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 332/338 (98.2249%)
___Train Local_Simple,  epoch 139, local model 60, internal_epoch   2,  Average loss: 0.0020, Accuracy: 326/338 (96.4497%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.1226, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1150/1160 (99.1379%)
___Train Local_Simple,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1148/1160 (98.9655%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.4870, Accuracy: 9083/10000 (90.8300%)
___Train Local_Simple,  epoch 139, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 139, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0633, Accuracy: 9800/10000 (98.0000%)
time spent on training: 36.10746121406555
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00018653  0.00017013  0.00176898 ... -0.00034113 -0.00907695
 -0.0004127 ]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 7, 8]
layer1_inf_time: 2.762451171875
[PAIRWISE] pred_attackers_indx:  [0 2 3]
layer2_inf_t: 29.33740234375
assumed final_attacker_idxs:  [0 2 3 5 7 8]
final_attacker_idxs is: [0 2 3 5 7 8]
g_attacker_idxs: [23 95 57 52 60 12]
g_normal_idxs: [48 33 35 65]
filtered_attacker_idxs: [2, 5, 7, 8]
final_attacker_idxs are: [2, 5, 7, 8]
num_dps: [293, 448, 602, 343, 623, 253, 499, 338, 1160, 371]
epoch_acc: 99.02
Starting performing KrMLRFL...
Num data points: [293, 448, 602, 343, 623, 253, 499, 338, 1160, 371]
Num selected data points: [293 448 343 623 499 371]
The chosen ones are users: [0, 1, 3, 4, 6, 9], which are global users: [23, 48, 57, 33, 35, 65]
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0314, Accuracy: 9902/10000 (99.0200%)
___Test Local_Simple poisoned: True, epoch: 139: Average loss: 14.6540, Accuracy: 13/8968 (0.1450%)
Done in 53.304404497146606 sec.
Server Epoch:140 choose agents : [52, 37, 2, 77, 29, 53, 22, 26, 57, 16].
poison local model 52 index 0
___Train Local_Simple,  epoch 140, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch 140, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0908, Accuracy: 9728/10000 (97.2800%)
___Train Local_Simple,  epoch 140, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch 140, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 859/860 (99.8837%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0837, Accuracy: 9745/10000 (97.4500%)
poison local model 2 index 1
___Train Local_Simple,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 543/548 (99.0876%)
___Train Local_Simple,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 545/548 (99.4526%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.1105, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 586/589 (99.4907%)
___Train Local_Simple,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0009, Accuracy: 579/589 (98.3022%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0944, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch 140, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 999/1002 (99.7006%)
___Train Local_Simple,  epoch 140, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0669, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch 140, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 140, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.2555, Accuracy: 9254/10000 (92.5400%)
poison local model 22 index 2
___Train Local_Simple,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 576/583 (98.7993%)
___Train Local_Simple,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 582/583 (99.8285%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0904, Accuracy: 9724/10000 (97.2400%)
poison local model 26 index 3
___Train Local_Simple,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0703, Accuracy: 9782/10000 (97.8200%)
___Train Local_Simple,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0004, Accuracy: 340/343 (99.1254%)
___Train Local_Simple,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0001, Accuracy: 343/343 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0760, Accuracy: 9786/10000 (97.8600%)
poison local model 16 index 0
___Train Local_Simple,  epoch 140, local model 16, internal_epoch   1,  Average loss: 0.0004, Accuracy: 907/915 (99.1257%)
___Train Local_Simple,  epoch 140, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 908/915 (99.2350%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0902, Accuracy: 9716/10000 (97.1600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 2, 22, 26, 16]
base_p: [-0.00016188  0.00015692  0.00018963 ... -0.00135277 -0.00134518
  0.00037546]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 6, 7, 9]
layer1_inf_time: 3.076416015625
[PAIRWISE] pred_attackers_indx:  [1 2 3 4 5 7 8]
layer2_inf_t: 532.127197265625
assumed final_attacker_idxs:  [1 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [1 2 3 4 5 6 7 8 9]
g_attacker_idxs: [37  2 77 29 53 22 26 57 16]
g_normal_idxs: [52]
filtered_attacker_idxs: [2, 3, 4, 5, 6, 7, 9]
final_attacker_idxs are: [2, 3, 4, 5, 6, 7, 9]
num_dps: [253, 860, 548, 589, 1002, 739, 583, 554, 343, 915]
time spent on training: 65.40215110778809
Starting performing KrMLRFL...
Num data points: [253, 860, 548, 589, 1002, 739, 583, 554, 343, 915]
Num selected data points: [253 860 343]
The chosen ones are users: [0, 1, 8], which are global users: [52, 37, 57]
epoch_acc: 98.47
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0454, Accuracy: 9847/10000 (98.4700%)
___Test Local_Simple poisoned: True, epoch: 140: Average loss: 12.9118, Accuracy: 56/8968 (0.6244%)
Done in 72.27199339866638 sec.
Server Epoch:141 choose agents : [99, 14, 0, 96, 26, 72, 51, 16, 25, 7].
___Train Local_Simple,  epoch 141, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch 141, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0481, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 374/376 (99.4681%)
___Train Local_Simple,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0000, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0653, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/435 (99.0805%)
___Train Local_Simple,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0881, Accuracy: 9737/10000 (97.3700%)
___Train Local_Simple,  epoch 141, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 661/672 (98.3631%)
___Train Local_Simple,  epoch 141, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 666/672 (99.1071%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.1302, Accuracy: 9557/10000 (95.5700%)
poison local model 26 index 0
___Train Local_Simple,  epoch 141, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 549/554 (99.0975%)
___Train Local_Simple,  epoch 141, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0904, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 141, local model 72, internal_epoch   1,  Average loss: 0.0003, Accuracy: 728/731 (99.5896%)
___Train Local_Simple,  epoch 141, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 729/731 (99.7264%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0845, Accuracy: 9730/10000 (97.3000%)
poison local model 51 index 1
___Train Local_Simple,  epoch 141, local model 51, internal_epoch   1,  Average loss: 0.0016, Accuracy: 557/568 (98.0634%)
___Train Local_Simple,  epoch 141, local model 51, internal_epoch   2,  Average loss: 0.0005, Accuracy: 565/568 (99.4718%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.1288, Accuracy: 9560/10000 (95.6000%)
poison local model 16 index 2
___Train Local_Simple,  epoch 141, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 905/915 (98.9071%)
___Train Local_Simple,  epoch 141, local model 16, internal_epoch   2,  Average loss: 0.0006, Accuracy: 904/915 (98.7978%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0913, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch 141, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 645/647 (99.6909%)
___Train Local_Simple,  epoch 141, local model 25, internal_epoch   2,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.1401, Accuracy: 9582/10000 (95.8200%)
poison local model 7 index 3
___Train Local_Simple,  epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.1171, Accuracy: 9651/10000 (96.5100%)
time spent on training: 50.40674185752869
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 51, 16, 7]
base_p: [0.00155799 0.00026105 0.00071767 ... 0.0019878  0.00307868 0.00362179]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 9]
layer1_inf_time: 3.25439453125
[PAIRWISE] pred_attackers_indx:  [3 4 6 7 9]
layer2_inf_t: 121.8603515625
assumed final_attacker_idxs:  [3 4 6 7 9]
final_attacker_idxs is: [3 4 6 7 9]
g_attacker_idxs: [96 26 51 16  7]
g_normal_idxs: [99 14  0 72 25]
filtered_attacker_idxs: [3, 4, 6, 7, 9]
final_attacker_idxs are: [3, 4, 6, 7, 9]
num_dps: [377, 376, 435, 672, 554, 731, 568, 915, 647, 418]
Num data points: [377, 376, 435, 672, 554, 731, 568, 915, 647, 418]
Num selected data points: [377 376 435 731 647]
The chosen ones are users: [0, 1, 2, 5, 8], which are global users: [99, 14, 0, 72, 25]
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0312, Accuracy: 9907/10000 (99.0700%)
epoch_acc: 99.07000000000001
___Test Local_Simple poisoned: True, epoch: 141: Average loss: 13.4668, Accuracy: 19/8968 (0.2119%)
Done in 57.31900954246521 sec.
Server Epoch:142 choose agents : [4, 10, 57, 65, 81, 72, 58, 68, 15, 86].
___Train Local_Simple,  epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0009, Accuracy: 651/658 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.1814, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch 142, local model 10, internal_epoch   1,  Average loss: 0.0003, Accuracy: 888/892 (99.5516%)
___Train Local_Simple,  epoch 142, local model 10, internal_epoch   2,  Average loss: 0.0002, Accuracy: 887/892 (99.4395%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0519, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 142, local model 57, internal_epoch   1,  Average loss: 0.0001, Accuracy: 342/343 (99.7085%)
___Train Local_Simple,  epoch 142, local model 57, internal_epoch   2,  Average loss: 0.0000, Accuracy: 343/343 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0537, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0431, Accuracy: 9875/10000 (98.7500%)
poison local model 81 index 0
___Train Local_Simple,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1218/1227 (99.2665%)
___Train Local_Simple,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1206/1227 (98.2885%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.2234, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch 142, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 142, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0348, Accuracy: 9892/10000 (98.9200%)
___Train Local_Simple,  epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0004, Accuracy: 272/276 (98.5507%)
___Train Local_Simple,  epoch 142, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 275/276 (99.6377%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0899, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0440, Accuracy: 9864/10000 (98.6400%)
___Train Local_Simple,  epoch 142, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch 142, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.6319, Accuracy: 8891/10000 (88.9100%)
___Train Local_Simple,  epoch 142, local model 86, internal_epoch   1,  Average loss: 0.0002, Accuracy: 249/250 (99.6000%)
___Train Local_Simple,  epoch 142, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [81]
base_p: [ 2.2672117e-05  2.1067262e-04  4.0886132e-04 ...  4.4291615e-03
 -1.2158379e-03 -9.7505003e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 8]
layer1_inf_time: 3.039794921875
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 31.168701171875
assumed final_attacker_idxs:  [0 2 4 5 8]
final_attacker_idxs is: [0 2 4 5 8]
g_attacker_idxs: [ 4 57 81 72 15]
g_normal_idxs: [10 65 58 68 86]
filtered_attacker_idxs: [0, 4]
final_attacker_idxs are: [0, 4]
num_dps: [658, 892, 343, 371, 1227, 731, 276, 494, 401, 250]
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0498, Accuracy: 9846/10000 (98.4600%)
time spent on training: 38.207942962646484
Starting performing KrMLRFL...
Num data points: [658, 892, 343, 371, 1227, 731, 276, 494, 401, 250]
Num selected data points: [892 343 371 731 276 494 401 250]
The chosen ones are users: [1, 2, 3, 5, 6, 7, 8, 9], which are global users: [10, 57, 65, 72, 58, 68, 15, 86]
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0295, Accuracy: 9902/10000 (99.0200%)
epoch_acc: 99.02
___Test Local_Simple poisoned: True, epoch: 142: Average loss: 13.8722, Accuracy: 15/8968 (0.1673%)
Done in 46.78339624404907 sec.
Server Epoch:143 choose agents : [24, 18, 7, 23, 70, 50, 51, 38, 10, 67].
___Train Local_Simple,  epoch 143, local model 24, internal_epoch   1,  Average loss: 0.0002, Accuracy: 377/379 (99.4723%)
___Train Local_Simple,  epoch 143, local model 24, internal_epoch   2,  Average loss: 0.0000, Accuracy: 379/379 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0541, Accuracy: 9820/10000 (98.2000%)
___Train Local_Simple,  epoch 143, local model 18, internal_epoch   1,  Average loss: 0.0016, Accuracy: 447/459 (97.3856%)
___Train Local_Simple,  epoch 143, local model 18, internal_epoch   2,  Average loss: 0.0017, Accuracy: 445/459 (96.9499%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.4803, Accuracy: 8770/10000 (87.7000%)
poison local model 7 index 0
___Train Local_Simple,  epoch 143, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 415/418 (99.2823%)
___Train Local_Simple,  epoch 143, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.1224, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0650, Accuracy: 9783/10000 (97.8300%)
poison local model 70 index 1
___Train Local_Simple,  epoch 143, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 712/724 (98.3425%)
___Train Local_Simple,  epoch 143, local model 70, internal_epoch   2,  Average loss: 0.0017, Accuracy: 705/724 (97.3757%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.2323, Accuracy: 9307/10000 (93.0700%)
___Train Local_Simple,  epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 468/474 (98.7342%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.2257, Accuracy: 9403/10000 (94.0300%)
poison local model 51 index 2
___Train Local_Simple,  epoch 143, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%)
___Train Local_Simple,  epoch 143, local model 51, internal_epoch   2,  Average loss: 0.0009, Accuracy: 559/568 (98.4155%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.1108, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch 143, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 892/895 (99.6648%)
___Train Local_Simple,  epoch 143, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.1185, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch 143, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Train Local_Simple,  epoch 143, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 888/892 (99.5516%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0531, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 143, local model 67, internal_epoch   1,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
___Train Local_Simple,  epoch 143, local model 67, internal_epoch   2,  Average loss: 0.0001, Accuracy: 998/998 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 70, 51]
base_p: [ 0.00080429  0.0002326   0.00017298 ...  0.00222646 -0.00084928
  0.00028632]
[T_SCORE] attacker_local_idxs is:  [2, 4, 6, 7, 9]
layer1_inf_time: 2.866455078125
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.2024, Accuracy: 9372/10000 (93.7200%)
time spent on training: 41.581082820892334
Starting performing KrMLRFL...
Num data points: [379, 459, 418, 293, 724, 474, 568, 895, 892, 998]
Num selected data points: [379 459 293 474 895 892]
The chosen ones are users: [0, 1, 3, 5, 7, 8], which are global users: [24, 18, 23, 50, 38, 10]
[PAIRWISE] pred_attackers_indx:  [1 2 4 6]
layer2_inf_t: 288.041748046875
assumed final_attacker_idxs:  [1 2 4 6 7 9]
final_attacker_idxs is: [1 2 4 6 7 9]
g_attacker_idxs: [18  7 70 51 38 67]
g_normal_idxs: [24 23 50 10]
filtered_attacker_idxs: [2, 4, 6, 9]
final_attacker_idxs are: [2, 4, 6, 9]
num_dps: [379, 459, 418, 293, 724, 474, 568, 895, 892, 998]
epoch_acc: 98.86
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0360, Accuracy: 9886/10000 (98.8600%)
___Test Local_Simple poisoned: True, epoch: 143: Average loss: 14.7398, Accuracy: 5/8968 (0.0558%)
Done in 57.73885178565979 sec.
Server Epoch:144 choose agents : [58, 60, 32, 0, 92, 89, 28, 59, 83, 37].
___Train Local_Simple,  epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch 144, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0572, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 144, local model 60, internal_epoch   1,  Average loss: 0.0007, Accuracy: 330/338 (97.6331%)
___Train Local_Simple,  epoch 144, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 337/338 (99.7041%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0966, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch 144, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 954/977 (97.6459%)
___Train Local_Simple,  epoch 144, local model 32, internal_epoch   2,  Average loss: 0.0011, Accuracy: 955/977 (97.7482%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.1289, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 430/435 (98.8506%)
___Train Local_Simple,  epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0005, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.1313, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch 144, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 144, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.1938, Accuracy: 9320/10000 (93.2000%)
___Train Local_Simple,  epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 490/492 (99.5935%)
___Train Local_Simple,  epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0002, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.1178, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch 144, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 144, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0460, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 144, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 745/760 (98.0263%)
___Train Local_Simple,  epoch 144, local model 59, internal_epoch   2,  Average loss: 0.0006, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.2430, Accuracy: 9259/10000 (92.5900%)
___Train Local_Simple,  epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 433/433 (100.0000%)
___Train Local_Simple,  epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0000, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0376, Accuracy: 9884/10000 (98.8400%)
___Train Local_Simple,  epoch 144, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 854/860 (99.3023%)
___Train Local_Simple,  epoch 144, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0941, Accuracy: 9733/10000 (97.3300%)
time spent on training: 32.601330280303955
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [ 0.00116085  0.00025846  0.00193002 ... -0.00045823 -0.00107071
 -0.001665  ]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 5, 7]
layer1_inf_time: 3.746337890625
[PAIRWISE] pred_attackers_indx:  [1 2 4]
layer2_inf_t: 485.05517578125
assumed final_attacker_idxs:  [1 2 4 5 7]
final_attacker_idxs is: [1 2 4 5 7]
g_attacker_idxs: [60 32 92 89 59]
g_normal_idxs: [58  0 28 83 37]
filtered_attacker_idxs: [1, 2, 4, 7]
final_attacker_idxs are: [1, 2, 4, 7]
num_dps: [276, 338, 977, 435, 937, 492, 501, 760, 433, 860]
Num data points: [276, 338, 977, 435, 937, 492, 501, 760, 433, 860]
Num selected data points: [276 435 492 501 433 860]
The chosen ones are users: [0, 3, 5, 6, 8, 9], which are global users: [58, 0, 89, 28, 83, 37]
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0392, Accuracy: 9888/10000 (98.8800%)
epoch_acc: 98.88
___Test Local_Simple poisoned: True, epoch: 144: Average loss: 13.7584, Accuracy: 25/8968 (0.2788%)
Done in 58.067511796951294 sec.
Server Epoch:145 choose agents : [39, 76, 61, 79, 92, 12, 85, 45, 89, 74].
___Train Local_Simple,  epoch 145, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 145, local model 39, internal_epoch   2,  Average loss: 0.0007, Accuracy: 252/257 (98.0545%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0939, Accuracy: 9728/10000 (97.2800%)
___Train Local_Simple,  epoch 145, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 145, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0393, Accuracy: 9889/10000 (98.8900%)
poison local model 61 index 0
___Train Local_Simple,  epoch 145, local model 61, internal_epoch   1,  Average loss: 0.0007, Accuracy: 692/699 (98.9986%)
___Train Local_Simple,  epoch 145, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 692/699 (98.9986%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.2940, Accuracy: 8979/10000 (89.7900%)
___Train Local_Simple,  epoch 145, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 145, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0392, Accuracy: 9884/10000 (98.8400%)
___Train Local_Simple,  epoch 145, local model 92, internal_epoch   1,  Average loss: 0.0008, Accuracy: 921/937 (98.2924%)
___Train Local_Simple,  epoch 145, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 929/937 (99.1462%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.1740, Accuracy: 9387/10000 (93.8700%)
___Train Local_Simple,  epoch 145, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1149/1160 (99.0517%)
___Train Local_Simple,  epoch 145, local model 12, internal_epoch   2,  Average loss: 0.0015, Accuracy: 1141/1160 (98.3621%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.1549, Accuracy: 9511/10000 (95.1100%)
poison local model 85 index 1
___Train Local_Simple,  epoch 145, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 145, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0530, Accuracy: 9827/10000 (98.2700%)
poison local model 45 index 2
___Train Local_Simple,  epoch 145, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 145, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.1145, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch 145, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Train Local_Simple,  epoch 145, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0558, Accuracy: 9833/10000 (98.3300%)
___Train Local_Simple,  epoch 145, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%)
___Train Local_Simple,  epoch 145, local model 74, internal_epoch   2,  Average loss: 0.0006, Accuracy: 554/557 (99.4614%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.1395, Accuracy: 9539/10000 (95.3900%)
time spent on training: 48.789185523986816
Starting performing KrMLRFL...
Num data points: [257, 78, 699, 182, 937, 1160, 431, 628, 492, 557]
Num selected data points: [257  78 182 492 557]
The chosen ones are users: [0, 1, 3, 8, 9], which are global users: [39, 76, 79, 89, 74]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 85, 45]
base_p: [ 9.3497336e-05  1.0823831e-04  1.0233610e-03 ... -2.3800433e-03
  5.7456642e-04  1.0702312e-03]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 6, 7]
layer1_inf_time: 2.551513671875
[PAIRWISE] pred_attackers_indx:  [2 4 5 7 9]
layer2_inf_t: 28.7666015625
assumed final_attacker_idxs:  [2 4 5 6 7 9]
final_attacker_idxs is: [2 4 5 6 7 9]
g_attacker_idxs: [61 92 12 85 45 74]
g_normal_idxs: [39 76 79 89]
filtered_attacker_idxs: [2, 4, 5, 6, 7]
final_attacker_idxs are: [2, 4, 5, 6, 7]
num_dps: [257, 78, 699, 182, 937, 1160, 431, 628, 492, 557]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0395, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 145: Average loss: 13.5019, Accuracy: 26/8968 (0.2899%)
Done in 53.541642904281616 sec.
Server Epoch:146 choose agents : [43, 60, 28, 10, 84, 51, 62, 75, 34, 47].
___Train Local_Simple,  epoch 146, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 408/408 (100.0000%)
___Train Local_Simple,  epoch 146, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 408/408 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0444, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch 146, local model 60, internal_epoch   1,  Average loss: 0.0006, Accuracy: 333/338 (98.5207%)
___Train Local_Simple,  epoch 146, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.1126, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch 146, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 146, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0541, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%)
___Train Local_Simple,  epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 884/892 (99.1031%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0843, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch 146, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1229/1246 (98.6356%)
___Train Local_Simple,  epoch 146, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1230/1246 (98.7159%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0779, Accuracy: 9757/10000 (97.5700%)
poison local model 51 index 0
___Train Local_Simple,  epoch 146, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%)
___Train Local_Simple,  epoch 146, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0728, Accuracy: 9771/10000 (97.7100%)
___Train Local_Simple,  epoch 146, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 419/423 (99.0544%)
___Train Local_Simple,  epoch 146, local model 62, internal_epoch   2,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0640, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 675/686 (98.3965%)
___Train Local_Simple,  epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0007, Accuracy: 678/686 (98.8338%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0685, Accuracy: 9786/10000 (97.8600%)
poison local model 34 index 1
___Train Local_Simple,  epoch 146, local model 34, internal_epoch   1,  Average loss: 0.0003, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 146, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.1170, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch 146, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 770/776 (99.2268%)
___Train Local_Simple,  epoch 146, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 773/776 (99.6134%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0823, Accuracy: 9738/10000 (97.3800%)
time spent on training: 39.35177826881409
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 34]
base_p: [-2.8690696e-04  8.1013888e-05 -2.5875866e-05 ... -9.4655156e-04
  2.7759373e-04 -1.5847608e-03]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 8, 9]
layer1_inf_time: 2.845458984375
[PAIRWISE] pred_attackers_indx:  [1 2 3 5 6 8]
layer2_inf_t: 31.82763671875
assumed final_attacker_idxs:  [1 2 3 4 5 6 8 9]
final_attacker_idxs is: [1 2 3 4 5 6 8 9]
g_attacker_idxs: [60 28 10 84 51 62 34 47]
g_normal_idxs: [43 75]
filtered_attacker_idxs: [1, 4, 5, 8, 9]
final_attacker_idxs are: [1, 4, 5, 8, 9]
num_dps: [408, 338, 501, 892, 1246, 568, 423, 686, 413, 776]
Starting performing KrMLRFL...
Num data points: [408, 338, 501, 892, 1246, 568, 423, 686, 413, 776]
Num selected data points: [408 501 892 423 686]
The chosen ones are users: [0, 2, 3, 6, 7], which are global users: [43, 28, 10, 62, 75]
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0321, Accuracy: 9899/10000 (98.9900%)
epoch_acc: 98.99
___Test Local_Simple poisoned: True, epoch: 146: Average loss: 14.1016, Accuracy: 8/8968 (0.0892%)
Done in 44.954946756362915 sec.
Server Epoch:147 choose agents : [23, 91, 10, 92, 61, 60, 58, 8, 4, 30].
___Train Local_Simple,  epoch 147, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 147, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0568, Accuracy: 9807/10000 (98.0700%)
poison local model 91 index 0
___Train Local_Simple,  epoch 147, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 147, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0643, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 147, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 890/892 (99.7758%)
___Train Local_Simple,  epoch 147, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0543, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 926/937 (98.8260%)
___Train Local_Simple,  epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 932/937 (99.4664%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.2577, Accuracy: 9100/10000 (91.0000%)
poison local model 61 index 1
___Train Local_Simple,  epoch 147, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 689/699 (98.5694%)
___Train Local_Simple,  epoch 147, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 695/699 (99.4278%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.2253, Accuracy: 9200/10000 (92.0000%)
___Train Local_Simple,  epoch 147, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 335/338 (99.1124%)
___Train Local_Simple,  epoch 147, local model 60, internal_epoch   2,  Average loss: 0.0007, Accuracy: 335/338 (99.1124%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.1481, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 275/276 (99.6377%)
___Train Local_Simple,  epoch 147, local model 58, internal_epoch   2,  Average loss: 0.0000, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0482, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 147, local model 8, internal_epoch   1,  Average loss: 0.0003, Accuracy: 629/633 (99.3681%)
___Train Local_Simple,  epoch 147, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0613, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0003, Accuracy: 654/658 (99.3921%)
___Train Local_Simple,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 653/658 (99.2401%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.1201, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch 147, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch 147, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.1030, Accuracy: 9682/10000 (96.8200%)
time spent on training: 41.9457151889801
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 61]
base_p: [-6.0573220e-06  1.8418953e-04  1.0555089e-03 ... -1.5872717e-03
  3.5882741e-04 -4.6201050e-04]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 8]
layer1_inf_time: 4.630615234375
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 546.590087890625
assumed final_attacker_idxs:  [1 3 4 5 8]
final_attacker_idxs is: [1 3 4 5 8]
g_attacker_idxs: [91 92 61 60  4]
g_normal_idxs: [23 10 58  8 30]
filtered_attacker_idxs: [1, 3, 4, 5, 8]
final_attacker_idxs are: [1, 3, 4, 5, 8]
num_dps: [293, 256, 892, 937, 699, 338, 276, 633, 658, 400]
Num data points: [293, 256, 892, 937, 699, 338, 276, 633, 658, 400]
Num selected data points: [293 892 276 633 400]
The chosen ones are users: [0, 2, 6, 7, 9], which are global users: [23, 10, 58, 8, 30]
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0355, Accuracy: 9887/10000 (98.8700%)
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 147: Average loss: 13.8784, Accuracy: 16/8968 (0.1784%)
Done in 73.38130402565002 sec.
Server Epoch:148 choose agents : [44, 12, 8, 23, 62, 21, 55, 96, 46, 69].
___Train Local_Simple,  epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%)
___Train Local_Simple,  epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0001, Accuracy: 517/517 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0697, Accuracy: 9769/10000 (97.6900%)
___Train Local_Simple,  epoch 148, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1149/1160 (99.0517%)
___Train Local_Simple,  epoch 148, local model 12, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1155/1160 (99.5690%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.1455, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch 148, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Train Local_Simple,  epoch 148, local model 8, internal_epoch   2,  Average loss: 0.0000, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0439, Accuracy: 9863/10000 (98.6300%)
___Train Local_Simple,  epoch 148, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 148, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0419, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 148, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 148, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0396, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 148, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch 148, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.1051, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch 148, local model 55, internal_epoch   1,  Average loss: 0.0006, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch 148, local model 55, internal_epoch   2,  Average loss: 0.0003, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.4338, Accuracy: 8695/10000 (86.9500%)
___Train Local_Simple,  epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0005, Accuracy: 666/672 (99.1071%)
___Train Local_Simple,  epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 672/672 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0831, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch 148, local model 46, internal_epoch   1,  Average loss: 0.0004, Accuracy: 704/710 (99.1549%)
___Train Local_Simple,  epoch 148, local model 46, internal_epoch   2,  Average loss: 0.0007, Accuracy: 702/710 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.1482, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch 148, local model 69, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 148, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [ 0.000337    0.00032158 -0.00048508 ... -0.00019445  0.00307318
  0.00028672]
[T_SCORE] attacker_local_idxs is:  [0, 1, 6, 7, 8]
layer1_inf_time: 2.9677734375
[PAIRWISE] pred_attackers_indx:  [6 8]
layer2_inf_t: 43.092041015625
assumed final_attacker_idxs:  [0 1 6 7 8]
final_attacker_idxs is: [0 1 6 7 8]
g_attacker_idxs: [44 12 55 96 46]
g_normal_idxs: [ 8 23 62 21 69]
filtered_attacker_idxs: [1, 7, 8]
final_attacker_idxs are: [1, 7, 8]
num_dps: [517, 1160, 633, 293, 423, 312, 354, 672, 710, 256]
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0859, Accuracy: 9709/10000 (97.0900%)
time spent on training: 31.594958305358887
Starting performing KrMLRFL...
Num data points: [517, 1160, 633, 293, 423, 312, 354, 672, 710, 256]
Num selected data points: [517 633 293 423 312 354 256]
The chosen ones are users: [0, 2, 3, 4, 5, 6, 9], which are global users: [44, 8, 23, 62, 21, 55, 69]
epoch_acc: 98.98
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0332, Accuracy: 9898/10000 (98.9800%)
___Test Local_Simple poisoned: True, epoch: 148: Average loss: 13.7321, Accuracy: 18/8968 (0.2007%)
Done in 37.771257162094116 sec.
Server Epoch:149 choose agents : [79, 19, 31, 41, 50, 9, 29, 42, 88, 71].
___Train Local_Simple,  epoch 149, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 149, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0345, Accuracy: 9894/10000 (98.9400%)
___Train Local_Simple,  epoch 149, local model 19, internal_epoch   1,  Average loss: 0.0005, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 149, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.2412, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch 149, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%)
___Train Local_Simple,  epoch 149, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0619, Accuracy: 9824/10000 (98.2400%)
___Train Local_Simple,  epoch 149, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%)
___Train Local_Simple,  epoch 149, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.3417, Accuracy: 9139/10000 (91.3900%)
___Train Local_Simple,  epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0006, Accuracy: 469/474 (98.9451%)
___Train Local_Simple,  epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 472/474 (99.5781%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.3728, Accuracy: 9151/10000 (91.5100%)
___Train Local_Simple,  epoch 149, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 149, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0785, Accuracy: 9754/10000 (97.5400%)
___Train Local_Simple,  epoch 149, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 998/1002 (99.6008%)
___Train Local_Simple,  epoch 149, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.2140, Accuracy: 9407/10000 (94.0700%)
poison local model 42 index 0
___Train Local_Simple,  epoch 149, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch 149, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0575, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 529/530 (99.8113%)
___Train Local_Simple,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0530, Accuracy: 9829/10000 (98.2900%)
poison local model 71 index 1
___Train Local_Simple,  epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1371/1384 (99.0607%)
___Train Local_Simple,  epoch 149, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1375/1384 (99.3497%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.1506, Accuracy: 9510/10000 (95.1000%)
time spent on training: 40.756970167160034
Starting performing KrMLRFL...
Num data points: [182, 205, 835, 606, 474, 436, 1002, 236, 530, 1384]
Num selected data points: [182 205 835 474 436 530]
The chosen ones are users: [0, 1, 2, 4, 5, 8], which are global users: [79, 19, 31, 50, 9, 88]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 71]
base_p: [ 0.0004347   0.00024159  0.0003131  ... -0.00158015 -0.00102766
 -0.00012989]
[T_SCORE] attacker_local_idxs is:  [2, 3, 6, 7, 9]
layer1_inf_time: 3.295654296875
[PAIRWISE] pred_attackers_indx:  [3 4 6 9]
layer2_inf_t: 31.280517578125
assumed final_attacker_idxs:  [2 3 4 6 7 9]
final_attacker_idxs is: [2 3 4 6 7 9]
g_attacker_idxs: [31 41 50 29 42 71]
g_normal_idxs: [79 19  9 88]
filtered_attacker_idxs: [3, 6, 7, 9]
final_attacker_idxs are: [3, 6, 7, 9]
num_dps: [182, 205, 835, 606, 474, 436, 1002, 236, 530, 1384]
epoch_acc: 98.94
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0336, Accuracy: 9894/10000 (98.9400%)
___Test Local_Simple poisoned: True, epoch: 149: Average loss: 14.5215, Accuracy: 14/8968 (0.1561%)
Done in 46.77264165878296 sec.
Server Epoch:150 choose agents : [45, 46, 81, 9, 23, 32, 10, 68, 55, 80].
poison local model 45 index 0
___Train Local_Simple,  epoch 150, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 150, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.1905, Accuracy: 9438/10000 (94.3800%)
___Train Local_Simple,  epoch 150, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 703/710 (99.0141%)
___Train Local_Simple,  epoch 150, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 702/710 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.1300, Accuracy: 9581/10000 (95.8100%)
poison local model 81 index 1
___Train Local_Simple,  epoch 150, local model 81, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1221/1227 (99.5110%)
___Train Local_Simple,  epoch 150, local model 81, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1216/1227 (99.1035%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.2246, Accuracy: 9390/10000 (93.9000%)
___Train Local_Simple,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0400, Accuracy: 9879/10000 (98.7900%)
___Train Local_Simple,  epoch 150, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 150, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0442, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch 150, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 962/977 (98.4647%)
___Train Local_Simple,  epoch 150, local model 32, internal_epoch   2,  Average loss: 0.0015, Accuracy: 948/977 (97.0317%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.2584, Accuracy: 9154/10000 (91.5400%)
___Train Local_Simple,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0408, Accuracy: 9872/10000 (98.7200%)
___Train Local_Simple,  epoch 150, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 150, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0458, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch 150, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 150, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.2265, Accuracy: 9321/10000 (93.2100%)
___Train Local_Simple,  epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0733, Accuracy: 9784/10000 (97.8400%)
time spent on training: 40.52184748649597
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 81]
base_p: [ 0.00050758  0.00021841  0.00027621 ...  0.00448342 -0.00112258
 -0.00064186]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 8]
layer1_inf_time: 4.050537109375
[PAIRWISE] pred_attackers_indx:  [0 2 5]
layer2_inf_t: 171.105712890625
assumed final_attacker_idxs:  [0 1 2 5 8]
final_attacker_idxs is: [0 1 2 5 8]
g_attacker_idxs: [45 46 81 32 55]
g_normal_idxs: [ 9 23 10 68 80]
filtered_attacker_idxs: [0, 1, 2, 5]
final_attacker_idxs are: [0, 1, 2, 5]
num_dps: [628, 710, 1227, 436, 293, 977, 892, 494, 354, 431]
Starting performing KrMLRFL...
Num data points: [628, 710, 1227, 436, 293, 977, 892, 494, 354, 431]
Num selected data points: [436 293 892 494 354 431]
The chosen ones are users: [3, 4, 6, 7, 8, 9], which are global users: [9, 23, 10, 68, 55, 80]
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0323, Accuracy: 9907/10000 (99.0700%)
epoch_acc: 99.07000000000001
___Test Local_Simple poisoned: True, epoch: 150: Average loss: 15.0816, Accuracy: 9/8968 (0.1004%)
Done in 63.02778339385986 sec.
Server Epoch:151 choose agents : [34, 10, 86, 99, 14, 53, 39, 47, 25, 43].
poison local model 34 index 0
___Train Local_Simple,  epoch 151, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 151, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.1363, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0388, Accuracy: 9876/10000 (98.7600%)
___Train Local_Simple,  epoch 151, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 151, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0781, Accuracy: 9767/10000 (97.6700%)
___Train Local_Simple,  epoch 151, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch 151, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0388, Accuracy: 9878/10000 (98.7800%)
___Train Local_Simple,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%)
___Train Local_Simple,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0000, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0912, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch 151, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 733/739 (99.1881%)
___Train Local_Simple,  epoch 151, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.2108, Accuracy: 9330/10000 (93.3000%)
___Train Local_Simple,  epoch 151, local model 39, internal_epoch   1,  Average loss: 0.0051, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 151, local model 39, internal_epoch   2,  Average loss: 0.1955, Accuracy: 99/257 (38.5214%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 3.2730, Accuracy: 1139/10000 (11.3900%)
___Train Local_Simple,  epoch 151, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 767/776 (98.8402%)
___Train Local_Simple,  epoch 151, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 772/776 (99.4845%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.1350, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch 151, local model 25, internal_epoch   1,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%)
___Train Local_Simple,  epoch 151, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0772, Accuracy: 9759/10000 (97.5900%)
___Train Local_Simple,  epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0403, Accuracy: 9873/10000 (98.7300%)
time spent on training: 35.40908646583557
Starting performing KrMLRFL...
Num data points: [413, 892, 250, 377, 376, 739, 257, 776, 647, 408]
Num selected data points: [892 250 377 376 257 408]
The chosen ones are users: [1, 2, 3, 4, 6, 9], which are global users: [10, 86, 99, 14, 39, 43]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34]
base_p: [ 0.00259326  0.00014926  0.00087497 ... -0.02799243 -0.0181944
  0.00066192]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 7, 8]
layer1_inf_time: 2.9853515625
[PAIRWISE] pred_attackers_indx:  [6]
layer2_inf_t: 28.78125
assumed final_attacker_idxs:  [0 4 5 6 7 8]
final_attacker_idxs is: [0 4 5 6 7 8]
g_attacker_idxs: [34 14 53 39 47 25]
g_normal_idxs: [10 86 99 43]
filtered_attacker_idxs: [0, 5, 7, 8]
final_attacker_idxs are: [0, 5, 7, 8]
num_dps: [413, 892, 250, 377, 376, 739, 257, 776, 647, 408]
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.2180, Accuracy: 9458/10000 (94.5800%)
epoch_acc: 94.58
___Test Local_Simple poisoned: True, epoch: 151: Average loss: 6.4007, Accuracy: 132/8968 (1.4719%)
Done in 42.055235147476196 sec.
Server Epoch:152 choose agents : [42, 25, 89, 12, 90, 84, 71, 75, 6, 50].
poison local model 42 index 0
___Train Local_Simple,  epoch 152, local model 42, internal_epoch   1,  Average loss: 0.0026, Accuracy: 224/236 (94.9153%)
___Train Local_Simple,  epoch 152, local model 42, internal_epoch   2,  Average loss: 0.0007, Accuracy: 234/236 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.3006, Accuracy: 8969/10000 (89.6900%)
___Train Local_Simple,  epoch 152, local model 25, internal_epoch   1,  Average loss: 0.0011, Accuracy: 637/647 (98.4544%)
___Train Local_Simple,  epoch 152, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.1734, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0009, Accuracy: 485/492 (98.5772%)
___Train Local_Simple,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0003, Accuracy: 490/492 (99.5935%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.3019, Accuracy: 9165/10000 (91.6500%)
___Train Local_Simple,  epoch 152, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1135/1160 (97.8448%)
___Train Local_Simple,  epoch 152, local model 12, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1144/1160 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.1605, Accuracy: 9501/10000 (95.0100%)
___Train Local_Simple,  epoch 152, local model 90, internal_epoch   1,  Average loss: 0.0009, Accuracy: 672/683 (98.3895%)
___Train Local_Simple,  epoch 152, local model 90, internal_epoch   2,  Average loss: 0.0007, Accuracy: 673/683 (98.5359%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.3987, Accuracy: 8763/10000 (87.6300%)
___Train Local_Simple,  epoch 152, local model 84, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1207/1246 (96.8700%)
___Train Local_Simple,  epoch 152, local model 84, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1227/1246 (98.4751%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.1035, Accuracy: 9671/10000 (96.7100%)
poison local model 71 index 1
___Train Local_Simple,  epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1352/1384 (97.6879%)
___Train Local_Simple,  epoch 152, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1369/1384 (98.9162%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.6128, Accuracy: 8216/10000 (82.1600%)
___Train Local_Simple,  epoch 152, local model 75, internal_epoch   1,  Average loss: 0.0013, Accuracy: 672/686 (97.9592%)
___Train Local_Simple,  epoch 152, local model 75, internal_epoch   2,  Average loss: 0.0004, Accuracy: 679/686 (98.9796%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.2230, Accuracy: 9391/10000 (93.9100%)
___Train Local_Simple,  epoch 152, local model 6, internal_epoch   1,  Average loss: 0.0011, Accuracy: 604/615 (98.2114%)
___Train Local_Simple,  epoch 152, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 609/615 (99.0244%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.3043, Accuracy: 9099/10000 (90.9900%)
___Train Local_Simple,  epoch 152, local model 50, internal_epoch   1,  Average loss: 0.0014, Accuracy: 466/474 (98.3122%)
___Train Local_Simple,  epoch 152, local model 50, internal_epoch   2,  Average loss: 0.0006, Accuracy: 468/474 (98.7342%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.2688, Accuracy: 9169/10000 (91.6900%)
time spent on training: 39.36368107795715
Starting performing KrMLRFL...
Num data points: [236, 647, 492, 1160, 683, 1246, 1384, 686, 615, 474]
Num selected data points: [647 492 683 686 615 474]
The chosen ones are users: [1, 2, 4, 7, 8, 9], which are global users: [25, 89, 90, 75, 6, 50]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 71]
base_p: [ 2.4072081e-04  4.8119575e-05 -9.0406230e-04 ...  4.0512681e-03
  3.1904019e-02 -4.1707456e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 6]
layer1_inf_time: 3.145263671875
[PAIRWISE] pred_attackers_indx:  [6]
layer2_inf_t: 26.88330078125
assumed final_attacker_idxs:  [0 2 3 5 6]
final_attacker_idxs is: [0 2 3 5 6]
g_attacker_idxs: [42 89 12 84 71]
g_normal_idxs: [25 90 75  6 50]
filtered_attacker_idxs: [0, 3, 5, 6]
final_attacker_idxs are: [0, 3, 5, 6]
num_dps: [236, 647, 492, 1160, 683, 1246, 1384, 686, 615, 474]
epoch_acc: 98.08
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0611, Accuracy: 9808/10000 (98.0800%)
___Test Local_Simple poisoned: True, epoch: 152: Average loss: 13.2065, Accuracy: 30/8968 (0.3345%)
Done in 45.58649563789368 sec.
Server Epoch:153 choose agents : [45, 62, 66, 43, 68, 9, 78, 97, 53, 33].
poison local model 45 index 0
___Train Local_Simple,  epoch 153, local model 45, internal_epoch   1,  Average loss: 0.0014, Accuracy: 613/628 (97.6115%)
___Train Local_Simple,  epoch 153, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 618/628 (98.4076%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.2415, Accuracy: 9239/10000 (92.3900%)
___Train Local_Simple,  epoch 153, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch 153, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0576, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 153, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 649/660 (98.3333%)
___Train Local_Simple,  epoch 153, local model 66, internal_epoch   2,  Average loss: 0.0009, Accuracy: 652/660 (98.7879%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.2207, Accuracy: 9267/10000 (92.6700%)
___Train Local_Simple,  epoch 153, local model 43, internal_epoch   1,  Average loss: 0.0018, Accuracy: 396/408 (97.0588%)
___Train Local_Simple,  epoch 153, local model 43, internal_epoch   2,  Average loss: 0.0007, Accuracy: 402/408 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1114, Accuracy: 9657/10000 (96.5700%)
___Train Local_Simple,  epoch 153, local model 68, internal_epoch   1,  Average loss: 0.0008, Accuracy: 485/494 (98.1781%)
___Train Local_Simple,  epoch 153, local model 68, internal_epoch   2,  Average loss: 0.0005, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1185, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch 153, local model 9, internal_epoch   1,  Average loss: 0.0006, Accuracy: 430/436 (98.6239%)
___Train Local_Simple,  epoch 153, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0586, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 300/303 (99.0099%)
___Train Local_Simple,  epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.2383, Accuracy: 9248/10000 (92.4800%)
___Train Local_Simple,  epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1164, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch 153, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 729/739 (98.6468%)
___Train Local_Simple,  epoch 153, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.2386, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch 153, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 615/623 (98.7159%)
___Train Local_Simple,  epoch 153, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1036, Accuracy: 9671/10000 (96.7100%)
time spent on training: 34.121129274368286
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45]
base_p: [ 0.00034165  0.0001164   0.00084841 ... -0.00059462 -0.00623333
 -0.00794955]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 8, 9]
layer1_inf_time: 5.308349609375
[PAIRWISE] pred_attackers_indx:  [0 3 4 9]
layer2_inf_t: 166.8046875
assumed final_attacker_idxs:  [0 2 3 4 8 9]
final_attacker_idxs is: [0 2 3 4 8 9]
g_attacker_idxs: [45 66 43 68 53 33]
g_normal_idxs: [62  9 78 97]
filtered_attacker_idxs: [0, 2, 8]
final_attacker_idxs are: [0, 2, 8]
num_dps: [628, 423, 660, 408, 494, 436, 303, 487, 739, 623]
Starting performing KrMLRFL...
Num data points: [628, 423, 660, 408, 494, 436, 303, 487, 739, 623]
Num selected data points: [423 408 494 436 303 487 623]
The chosen ones are users: [1, 3, 4, 5, 6, 7, 9], which are global users: [62, 43, 68, 9, 78, 97, 33]
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0430, Accuracy: 9849/10000 (98.4900%)
epoch_acc: 98.49
___Test Local_Simple poisoned: True, epoch: 153: Average loss: 14.3340, Accuracy: 6/8968 (0.0669%)
Done in 38.23792767524719 sec.
Server Epoch:154 choose agents : [51, 97, 17, 55, 76, 41, 2, 45, 84, 20].
poison local model 51 index 0
___Train Local_Simple,  epoch 154, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 562/568 (98.9437%)
___Train Local_Simple,  epoch 154, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1277, Accuracy: 9616/10000 (96.1600%)
___Train Local_Simple,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.0926, Accuracy: 9705/10000 (97.0500%)
poison local model 17 index 1
___Train Local_Simple,  epoch 154, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 608/620 (98.0645%)
___Train Local_Simple,  epoch 154, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 611/620 (98.5484%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1030, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch 154, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 345/354 (97.4576%)
___Train Local_Simple,  epoch 154, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.4468, Accuracy: 8525/10000 (85.2500%)
___Train Local_Simple,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0013, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.0607, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%)
___Train Local_Simple,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1175, Accuracy: 9598/10000 (95.9800%)
poison local model 2 index 2
___Train Local_Simple,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0016, Accuracy: 539/548 (98.3577%)
___Train Local_Simple,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0004, Accuracy: 547/548 (99.8175%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1156, Accuracy: 9673/10000 (96.7300%)
poison local model 45 index 3
___Train Local_Simple,  epoch 154, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 612/628 (97.4522%)
___Train Local_Simple,  epoch 154, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 615/628 (97.9299%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.2473, Accuracy: 9275/10000 (92.7500%)
___Train Local_Simple,  epoch 154, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1231/1246 (98.7961%)
___Train Local_Simple,  epoch 154, local model 84, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1229/1246 (98.6356%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1056, Accuracy: 9679/10000 (96.7900%)
poison local model 20 index 0
___Train Local_Simple,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0002, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.2064, Accuracy: 9428/10000 (94.2800%)
time spent on training: 46.79669904708862
Starting performing KrMLRFL...
Num data points: [568, 487, 620, 354, 78, 606, 548, 628, 1246, 429]
Num selected data points: [487 354  78 606]
The chosen ones are users: [1, 3, 4, 5], which are global users: [97, 55, 76, 41]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 17, 2, 45, 20]
base_p: [ 3.6917627e-04  6.7900866e-05  1.6226061e-03 ... -5.4097176e-04
  2.5623068e-03  9.3355775e-06]
[T_SCORE] attacker_local_idxs is:  [0, 2, 6, 7, 8, 9]
layer1_inf_time: 3.423583984375
[PAIRWISE] pred_attackers_indx:  [2 7 8 9]
layer2_inf_t: 39.0634765625
assumed final_attacker_idxs:  [0 2 6 7 8 9]
final_attacker_idxs is: [0 2 6 7 8 9]
g_attacker_idxs: [51 17  2 45 84 20]
g_normal_idxs: [97 55 76 41]
filtered_attacker_idxs: [0, 2, 6, 7, 8, 9]
final_attacker_idxs are: [0, 2, 6, 7, 8, 9]
num_dps: [568, 487, 620, 354, 78, 606, 548, 628, 1246, 429]
epoch_acc: 98.44000000000001
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.0497, Accuracy: 9844/10000 (98.4400%)
___Test Local_Simple poisoned: True, epoch: 154: Average loss: 12.0043, Accuracy: 43/8968 (0.4795%)
Done in 52.45436334609985 sec.
Server Epoch:155 choose agents : [62, 65, 21, 43, 30, 89, 26, 59, 36, 22].
___Train Local_Simple,  epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 418/423 (98.8180%)
___Train Local_Simple,  epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0541, Accuracy: 9833/10000 (98.3300%)
___Train Local_Simple,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0004, Accuracy: 367/371 (98.9218%)
___Train Local_Simple,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0566, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 155, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 311/312 (99.6795%)
___Train Local_Simple,  epoch 155, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0985, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch 155, local model 43, internal_epoch   1,  Average loss: 0.0004, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 155, local model 43, internal_epoch   2,  Average loss: 0.0004, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0483, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 155, local model 30, internal_epoch   1,  Average loss: 0.0005, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch 155, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.1094, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch 155, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 155, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0697, Accuracy: 9771/10000 (97.7100%)
poison local model 26 index 0
___Train Local_Simple,  epoch 155, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 155, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0881, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch 155, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 744/760 (97.8947%)
___Train Local_Simple,  epoch 155, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 756/760 (99.4737%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.1830, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 990/1005 (98.5075%)
___Train Local_Simple,  epoch 155, local model 36, internal_epoch   2,  Average loss: 0.0002, Accuracy: 999/1005 (99.4030%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.2225, Accuracy: 9388/10000 (93.8800%)
poison local model 22 index 1
___Train Local_Simple,  epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0016, Accuracy: 570/583 (97.7702%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0842, Accuracy: 9709/10000 (97.0900%)
time spent on training: 37.29040598869324
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 22]
base_p: [ 0.00013292  0.00020174 -0.0009261  ...  0.00075966 -0.01160035
 -0.00156803]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 5.41552734375
[PAIRWISE] pred_attackers_indx:  [6 8 9]
layer2_inf_t: 115.32275390625
assumed final_attacker_idxs:  [5 6 7 8 9]
final_attacker_idxs is: [5 6 7 8 9]
g_attacker_idxs: [89 26 59 36 22]
g_normal_idxs: [62 65 21 43 30]
filtered_attacker_idxs: [6, 7, 8, 9]
final_attacker_idxs are: [6, 7, 8, 9]
num_dps: [423, 371, 312, 408, 400, 492, 554, 760, 1005, 583]
Starting performing KrMLRFL...
Num data points: [423, 371, 312, 408, 400, 492, 554, 760, 1005, 583]
Num selected data points: [423 371 312 408 400 492]
The chosen ones are users: [0, 1, 2, 3, 4, 5], which are global users: [62, 65, 21, 43, 30, 89]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0361, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 155: Average loss: 12.9607, Accuracy: 20/8968 (0.2230%)
Done in 48.875049352645874 sec.
Server Epoch:156 choose agents : [63, 13, 18, 4, 59, 27, 16, 95, 55, 62].
poison local model 63 index 0
___Train Local_Simple,  epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0014, Accuracy: 866/889 (97.4128%)
___Train Local_Simple,  epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 878/889 (98.7627%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0913, Accuracy: 9697/10000 (96.9700%)
poison local model 13 index 1
___Train Local_Simple,  epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 724/734 (98.6376%)
___Train Local_Simple,  epoch 156, local model 13, internal_epoch   2,  Average loss: 0.0006, Accuracy: 730/734 (99.4550%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.2057, Accuracy: 9302/10000 (93.0200%)
___Train Local_Simple,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0015, Accuracy: 451/459 (98.2571%)
___Train Local_Simple,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0014, Accuracy: 442/459 (96.2963%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.2611, Accuracy: 9170/10000 (91.7000%)
___Train Local_Simple,  epoch 156, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 652/658 (99.0881%)
___Train Local_Simple,  epoch 156, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 651/658 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0724, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 755/760 (99.3421%)
___Train Local_Simple,  epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0004, Accuracy: 755/760 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.1493, Accuracy: 9484/10000 (94.8400%)
poison local model 27 index 2
___Train Local_Simple,  epoch 156, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 464/471 (98.5138%)
___Train Local_Simple,  epoch 156, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 467/471 (99.1507%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.2237, Accuracy: 9352/10000 (93.5200%)
poison local model 16 index 3
___Train Local_Simple,  epoch 156, local model 16, internal_epoch   1,  Average loss: 0.0010, Accuracy: 900/915 (98.3607%)
___Train Local_Simple,  epoch 156, local model 16, internal_epoch   2,  Average loss: 0.0009, Accuracy: 898/915 (98.1421%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.1062, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch 156, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch 156, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.4740, Accuracy: 8619/10000 (86.1900%)
___Train Local_Simple,  epoch 156, local model 55, internal_epoch   1,  Average loss: 0.0005, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch 156, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.2924, Accuracy: 9086/10000 (90.8600%)
___Train Local_Simple,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0470, Accuracy: 9834/10000 (98.3400%)
time spent on training: 49.831339836120605
Starting performing KrMLRFL...
Num data points: [889, 734, 459, 658, 760, 471, 915, 602, 354, 423]
Num selected data points: [459 354 423]
The chosen ones are users: [2, 8, 9], which are global users: [18, 55, 62]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 13, 27, 16]
base_p: [ 0.00192779 -0.00015409  0.00092684 ...  0.00344694  0.00068217
 -0.00071364]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 5, 6, 7]
layer1_inf_time: 4.345458984375
[PAIRWISE] pred_attackers_indx:  [0 3 6 7 8]
layer2_inf_t: 392.11083984375
assumed final_attacker_idxs:  [0 1 3 4 5 6 7 8]
final_attacker_idxs is: [0 1 3 4 5 6 7 8]
g_attacker_idxs: [63 13  4 59 27 16 95 55]
g_normal_idxs: [18 62]
filtered_attacker_idxs: [0, 1, 3, 4, 5, 6, 7]
final_attacker_idxs are: [0, 1, 3, 4, 5, 6, 7]
num_dps: [889, 734, 459, 658, 760, 471, 915, 602, 354, 423]
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0602, Accuracy: 9796/10000 (97.9600%)
epoch_acc: 97.96000000000001
___Test Local_Simple poisoned: True, epoch: 156: Average loss: 12.6762, Accuracy: 10/8968 (0.1115%)
Done in 58.205747842788696 sec.
Server Epoch:157 choose agents : [2, 87, 97, 89, 53, 23, 77, 7, 83, 75].
poison local model 2 index 0
___Train Local_Simple,  epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0013, Accuracy: 535/548 (97.6277%)
___Train Local_Simple,  epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0004, Accuracy: 545/548 (99.4526%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.2683, Accuracy: 9032/10000 (90.3200%)
___Train Local_Simple,  epoch 157, local model 87, internal_epoch   1,  Average loss: 0.0005, Accuracy: 466/470 (99.1489%)
___Train Local_Simple,  epoch 157, local model 87, internal_epoch   2,  Average loss: 0.0004, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0876, Accuracy: 9730/10000 (97.3000%)
___Train Local_Simple,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0838, Accuracy: 9726/10000 (97.2600%)
___Train Local_Simple,  epoch 157, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 157, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0846, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch 157, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 157, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.2097, Accuracy: 9373/10000 (93.7300%)
___Train Local_Simple,  epoch 157, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 289/293 (98.6348%)
___Train Local_Simple,  epoch 157, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0709, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch 157, local model 77, internal_epoch   1,  Average loss: 0.0012, Accuracy: 576/589 (97.7929%)
___Train Local_Simple,  epoch 157, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 585/589 (99.3209%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0712, Accuracy: 9783/10000 (97.8300%)
poison local model 7 index 1
___Train Local_Simple,  epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 411/418 (98.3254%)
___Train Local_Simple,  epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.2297, Accuracy: 9306/10000 (93.0600%)
___Train Local_Simple,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0488, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 682/686 (99.4169%)
___Train Local_Simple,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 682/686 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0631, Accuracy: 9813/10000 (98.1300%)
time spent on training: 67.8122341632843
Starting performing KrMLRFL...
Num data points: [548, 470, 487, 492, 739, 293, 589, 418, 433, 686]
Num selected data points: [470 487 492 293 433 686]
The chosen ones are users: [1, 2, 3, 5, 8, 9], which are global users: [87, 97, 89, 23, 83, 75]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 7]
base_p: [ 0.00033191  0.00016636 -0.00287496 ... -0.00144973 -0.00749104
 -0.00022703]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 7, 9]
layer1_inf_time: 3.221435546875
[PAIRWISE] pred_attackers_indx:  [0 6 7]
layer2_inf_t: 35.92041015625
assumed final_attacker_idxs:  [0 4 6 7 9]
final_attacker_idxs is: [0 4 6 7 9]
g_attacker_idxs: [ 2 53 77  7 75]
g_normal_idxs: [87 97 89 23 83]
filtered_attacker_idxs: [0, 4, 6, 7]
final_attacker_idxs are: [0, 4, 6, 7]
num_dps: [548, 470, 487, 492, 739, 293, 589, 418, 433, 686]
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0375, Accuracy: 9869/10000 (98.6900%)
epoch_acc: 98.69
___Test Local_Simple poisoned: True, epoch: 157: Average loss: 13.1367, Accuracy: 23/8968 (0.2565%)
Done in 76.37282919883728 sec.
Server Epoch:158 choose agents : [74, 48, 9, 90, 32, 35, 47, 1, 59, 72].
___Train Local_Simple,  epoch 158, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 550/557 (98.7433%)
___Train Local_Simple,  epoch 158, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0751, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch 158, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 444/448 (99.1071%)
___Train Local_Simple,  epoch 158, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0912, Accuracy: 9717/10000 (97.1700%)
___Train Local_Simple,  epoch 158, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 158, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0498, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 158, local model 90, internal_epoch   1,  Average loss: 0.0005, Accuracy: 674/683 (98.6823%)
___Train Local_Simple,  epoch 158, local model 90, internal_epoch   2,  Average loss: 0.0003, Accuracy: 681/683 (99.7072%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.9247, Accuracy: 8159/10000 (81.5900%)
___Train Local_Simple,  epoch 158, local model 32, internal_epoch   1,  Average loss: 0.0012, Accuracy: 959/977 (98.1576%)
___Train Local_Simple,  epoch 158, local model 32, internal_epoch   2,  Average loss: 0.0014, Accuracy: 951/977 (97.3388%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.1577, Accuracy: 9501/10000 (95.0100%)
___Train Local_Simple,  epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0895, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch 158, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 768/776 (98.9691%)
___Train Local_Simple,  epoch 158, local model 47, internal_epoch   2,  Average loss: 0.0001, Accuracy: 774/776 (99.7423%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0613, Accuracy: 9807/10000 (98.0700%)
poison local model 1 index 0
___Train Local_Simple,  epoch 158, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch 158, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.3073, Accuracy: 9121/10000 (91.2100%)
___Train Local_Simple,  epoch 158, local model 59, internal_epoch   1,  Average loss: 0.0007, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch 158, local model 59, internal_epoch   2,  Average loss: 0.0003, Accuracy: 756/760 (99.4737%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.2170, Accuracy: 9342/10000 (93.4200%)
___Train Local_Simple,  epoch 158, local model 72, internal_epoch   1,  Average loss: 0.0002, Accuracy: 728/731 (99.5896%)
___Train Local_Simple,  epoch 158, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 727/731 (99.4528%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.1224, Accuracy: 9589/10000 (95.8900%)
time spent on training: 37.38307785987854
Starting performing KrMLRFL...
Num data points: [557, 448, 436, 683, 977, 499, 776, 760, 760, 731]
Num selected data points: [557 448 436 683 499 731]
The chosen ones are users: [0, 1, 2, 3, 5, 9], which are global users: [74, 48, 9, 90, 35, 72]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1]
base_p: [ 0.00097637  0.00018078  0.00100594 ...  0.0018331  -0.00213441
 -0.00160788]
[T_SCORE] attacker_local_idxs is:  [4, 6, 7, 8, 9]
layer1_inf_time: 3.946533203125
[PAIRWISE] pred_attackers_indx:  [4 5 6 7 9]
layer2_inf_t: 42.49462890625
assumed final_attacker_idxs:  [4 5 6 7 8 9]
final_attacker_idxs is: [4 5 6 7 8 9]
g_attacker_idxs: [32 35 47  1 59 72]
g_normal_idxs: [74 48  9 90]
filtered_attacker_idxs: [4, 6, 7, 8]
final_attacker_idxs are: [4, 6, 7, 8]
num_dps: [557, 448, 436, 683, 977, 499, 776, 760, 760, 731]
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0349, Accuracy: 9887/10000 (98.8700%)
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 158: Average loss: 13.3814, Accuracy: 19/8968 (0.2119%)
Done in 44.44436287879944 sec.
Server Epoch:159 choose agents : [74, 18, 90, 75, 52, 53, 31, 8, 97, 54].
___Train Local_Simple,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%)
___Train Local_Simple,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0570, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 159, local model 18, internal_epoch   1,  Average loss: 0.0003, Accuracy: 457/459 (99.5643%)
___Train Local_Simple,  epoch 159, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0733, Accuracy: 9773/10000 (97.7300%)
___Train Local_Simple,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%)
___Train Local_Simple,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.1016, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch 159, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Train Local_Simple,  epoch 159, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0666, Accuracy: 9786/10000 (97.8600%)
poison local model 52 index 0
___Train Local_Simple,  epoch 159, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch 159, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.1018, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch 159, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 728/739 (98.5115%)
___Train Local_Simple,  epoch 159, local model 53, internal_epoch   2,  Average loss: 0.0001, Accuracy: 739/739 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.2917, Accuracy: 9158/10000 (91.5800%)
___Train Local_Simple,  epoch 159, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 832/835 (99.6407%)
___Train Local_Simple,  epoch 159, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0665, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0004, Accuracy: 627/633 (99.0521%)
___Train Local_Simple,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 631/633 (99.6840%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0577, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0661, Accuracy: 9786/10000 (97.8600%)
___Train Local_Simple,  epoch 159, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch 159, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 517/519 (99.6146%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0736, Accuracy: 9756/10000 (97.5600%)
time spent on training: 36.5647337436676
Starting performing KrMLRFL...
Num data points: [557, 459, 683, 686, 253, 739, 835, 633, 487, 519]
Num selected data points: [557 459 683 686 835 633 487 519]
The chosen ones are users: [0, 1, 2, 3, 6, 7, 8, 9], which are global users: [74, 18, 90, 75, 31, 8, 97, 54]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00046882  0.00020755  0.00025657 ... -0.00254005  0.00340196
  0.00076877]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 6]
layer1_inf_time: 3.259033203125
[PAIRWISE] pred_attackers_indx:  [0 5 6 7]
layer2_inf_t: 244.2919921875
assumed final_attacker_idxs:  [0 1 3 4 5 6 7]
final_attacker_idxs is: [0 1 3 4 5 6 7]
g_attacker_idxs: [74 18 75 52 53 31  8]
g_normal_idxs: [90 97 54]
filtered_attacker_idxs: [4, 5]
final_attacker_idxs are: [4, 5]
num_dps: [557, 459, 683, 686, 253, 739, 835, 633, 487, 519]
epoch_acc: 98.89
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0338, Accuracy: 9889/10000 (98.8900%)
___Test Local_Simple poisoned: True, epoch: 159: Average loss: 13.9635, Accuracy: 17/8968 (0.1896%)
Done in 43.61156368255615 sec.
Server Epoch:160 choose agents : [55, 28, 52, 44, 22, 6, 49, 95, 68, 79].
___Train Local_Simple,  epoch 160, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 160, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0807, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch 160, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 160, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0455, Accuracy: 9855/10000 (98.5500%)
poison local model 52 index 0
___Train Local_Simple,  epoch 160, local model 52, internal_epoch   1,  Average loss: 0.0006, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch 160, local model 52, internal_epoch   2,  Average loss: 0.0003, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0746, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch 160, local model 44, internal_epoch   1,  Average loss: 0.0005, Accuracy: 513/517 (99.2263%)
___Train Local_Simple,  epoch 160, local model 44, internal_epoch   2,  Average loss: 0.0007, Accuracy: 510/517 (98.6460%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.2847, Accuracy: 9208/10000 (92.0800%)
poison local model 22 index 1
___Train Local_Simple,  epoch 160, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 573/583 (98.2847%)
___Train Local_Simple,  epoch 160, local model 22, internal_epoch   2,  Average loss: 0.0004, Accuracy: 579/583 (99.3139%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.2636, Accuracy: 9169/10000 (91.6900%)
___Train Local_Simple,  epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 613/615 (99.6748%)
___Train Local_Simple,  epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 613/615 (99.6748%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.1326, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch 160, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 502/506 (99.2095%)
___Train Local_Simple,  epoch 160, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0883, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch 160, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch 160, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.7473, Accuracy: 8558/10000 (85.5800%)
___Train Local_Simple,  epoch 160, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 160, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0710, Accuracy: 9769/10000 (97.6900%)
___Train Local_Simple,  epoch 160, local model 79, internal_epoch   1,  Average loss: 0.0005, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch 160, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0423, Accuracy: 9859/10000 (98.5900%)
time spent on training: 41.67168641090393
Starting performing KrMLRFL...
Num data points: [354, 501, 253, 517, 583, 615, 506, 602, 494, 182]
Num selected data points: [354 501 517 615 506 494 182]
The chosen ones are users: [0, 1, 3, 5, 6, 8, 9], which are global users: [55, 28, 44, 6, 49, 68, 79]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 22]
base_p: [ 0.00028655  0.00014411  0.00028153 ... -0.00142735 -0.00754637
 -0.00108484]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 7]
layer1_inf_time: 4.270751953125
[PAIRWISE] pred_attackers_indx:  [4 7]
layer2_inf_t: 45.97216796875
assumed final_attacker_idxs:  [0 2 3 4 7]
final_attacker_idxs is: [0 2 3 4 7]
g_attacker_idxs: [55 52 44 22 95]
g_normal_idxs: [28  6 49 68 79]
filtered_attacker_idxs: [2, 4, 7]
final_attacker_idxs are: [2, 4, 7]
num_dps: [354, 501, 253, 517, 583, 615, 506, 602, 494, 182]
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0352, Accuracy: 9885/10000 (98.8500%)
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: True, epoch: 160: Average loss: 15.0065, Accuracy: 6/8968 (0.0669%)
Done in 49.711785316467285 sec.
Server Epoch:161 choose agents : [46, 0, 57, 92, 62, 55, 27, 23, 9, 38].
___Train Local_Simple,  epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 706/710 (99.4366%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.1594, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0006, Accuracy: 430/435 (98.8506%)
___Train Local_Simple,  epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0949, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 340/343 (99.1254%)
___Train Local_Simple,  epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 341/343 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.1023, Accuracy: 9681/10000 (96.8100%)
___Train Local_Simple,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 928/937 (99.0395%)
___Train Local_Simple,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 933/937 (99.5731%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.2513, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch 161, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 161, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0517, Accuracy: 9830/10000 (98.3000%)
___Train Local_Simple,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.1008, Accuracy: 9698/10000 (96.9800%)
poison local model 27 index 0
___Train Local_Simple,  epoch 161, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 461/471 (97.8769%)
___Train Local_Simple,  epoch 161, local model 27, internal_epoch   2,  Average loss: 0.0001, Accuracy: 470/471 (99.7877%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.1603, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch 161, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 161, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0361, Accuracy: 9883/10000 (98.8300%)
___Train Local_Simple,  epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0534, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 161, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 893/895 (99.7765%)
___Train Local_Simple,  epoch 161, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 894/895 (99.8883%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.1619, Accuracy: 9588/10000 (95.8800%)
time spent on training: 37.40390872955322
Starting performing KrMLRFL...
Num data points: [710, 435, 343, 937, 423, 354, 471, 293, 436, 895]
Num selected data points: [435 343 423 354 293 436 895]
The chosen ones are users: [1, 2, 4, 5, 7, 8, 9], which are global users: [0, 57, 62, 55, 23, 9, 38]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27]
base_p: [ 3.6004186e-04  1.5905127e-04  8.5234642e-05 ...  1.3156235e-03
  1.4503971e-03 -1.3962463e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 5, 6, 9]
layer1_inf_time: 4.1533203125
[PAIRWISE] pred_attackers_indx:  [0 5 6 8 9]
layer2_inf_t: 261.666748046875
assumed final_attacker_idxs:  [0 3 5 6 8 9]
final_attacker_idxs is: [0 3 5 6 8 9]
g_attacker_idxs: [46 92 55 27  9 38]
g_normal_idxs: [ 0 57 62 23]
filtered_attacker_idxs: [0, 3, 6]
final_attacker_idxs are: [0, 3, 6]
num_dps: [710, 435, 343, 937, 423, 354, 471, 293, 436, 895]
epoch_acc: 98.77
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0361, Accuracy: 9877/10000 (98.7700%)
___Test Local_Simple poisoned: True, epoch: 161: Average loss: 15.7438, Accuracy: 7/8968 (0.0781%)
Done in 43.04675364494324 sec.
Server Epoch:162 choose agents : [55, 64, 28, 20, 33, 0, 46, 91, 16, 65].
___Train Local_Simple,  epoch 162, local model 55, internal_epoch   1,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Train Local_Simple,  epoch 162, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0588, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 162, local model 64, internal_epoch   1,  Average loss: 0.0005, Accuracy: 807/813 (99.2620%)
___Train Local_Simple,  epoch 162, local model 64, internal_epoch   2,  Average loss: 0.0002, Accuracy: 809/813 (99.5080%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.2567, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0406, Accuracy: 9876/10000 (98.7600%)
poison local model 20 index 0
___Train Local_Simple,  epoch 162, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 425/429 (99.0676%)
___Train Local_Simple,  epoch 162, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.2403, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch 162, local model 33, internal_epoch   1,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 162, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0497, Accuracy: 9851/10000 (98.5100%)
___Train Local_Simple,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0003, Accuracy: 433/435 (99.5402%)
___Train Local_Simple,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.1075, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch 162, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch 162, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 705/710 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0806, Accuracy: 9741/10000 (97.4100%)
poison local model 91 index 1
___Train Local_Simple,  epoch 162, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 162, local model 91, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0804, Accuracy: 9758/10000 (97.5800%)
poison local model 16 index 2
___Train Local_Simple,  epoch 162, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 904/915 (98.7978%)
___Train Local_Simple,  epoch 162, local model 16, internal_epoch   2,  Average loss: 0.0003, Accuracy: 909/915 (99.3443%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0767, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch 162, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 162, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0572, Accuracy: 9816/10000 (98.1600%)
time spent on training: 48.49027967453003
Starting performing KrMLRFL...
Num data points: [354, 813, 501, 429, 623, 435, 710, 256, 915, 371]
Num selected data points: [354 813 501 623 435 256 371]
The chosen ones are users: [0, 1, 2, 4, 5, 7, 9], which are global users: [55, 64, 28, 33, 0, 91, 65]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 91, 16]
base_p: [ 0.00034658  0.00013697  0.0013678  ... -0.00230841 -0.00820088
 -0.00353227]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 6, 8]
layer1_inf_time: 3.442626953125
[PAIRWISE] pred_attackers_indx:  [1 3 5 8]
layer2_inf_t: 34.390869140625
assumed final_attacker_idxs:  [0 1 3 5 6 8]
final_attacker_idxs is: [0 1 3 5 6 8]
g_attacker_idxs: [55 64 20  0 46 16]
g_normal_idxs: [28 33 91 65]
filtered_attacker_idxs: [3, 6, 8]
final_attacker_idxs are: [3, 6, 8]
num_dps: [354, 813, 501, 429, 623, 435, 710, 256, 915, 371]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0341, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 162: Average loss: 14.8801, Accuracy: 12/8968 (0.1338%)
Done in 54.00049686431885 sec.
Server Epoch:163 choose agents : [68, 49, 29, 31, 62, 52, 18, 63, 64, 93].
___Train Local_Simple,  epoch 163, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 163, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0457, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0485, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 163, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 1000/1002 (99.8004%)
___Train Local_Simple,  epoch 163, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0991, Accuracy: 9682/10000 (96.8200%)
___Train Local_Simple,  epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0588, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 163, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 163, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0476, Accuracy: 9844/10000 (98.4400%)
poison local model 52 index 0
___Train Local_Simple,  epoch 163, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 163, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0674, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0003, Accuracy: 456/459 (99.3464%)
___Train Local_Simple,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.1250, Accuracy: 9607/10000 (96.0700%)
poison local model 63 index 1
___Train Local_Simple,  epoch 163, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 873/889 (98.2002%)
___Train Local_Simple,  epoch 163, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 879/889 (98.8751%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0595, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 163, local model 64, internal_epoch   1,  Average loss: 0.0002, Accuracy: 809/813 (99.5080%)
___Train Local_Simple,  epoch 163, local model 64, internal_epoch   2,  Average loss: 0.0004, Accuracy: 807/813 (99.2620%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0893, Accuracy: 9720/10000 (97.2000%)
poison local model 93 index 2
___Train Local_Simple,  epoch 163, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Train Local_Simple,  epoch 163, local model 93, internal_epoch   2,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.2304, Accuracy: 9354/10000 (93.5400%)
time spent on training: 53.246679067611694
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 63, 93]
base_p: [ 2.6601925e-03  2.7640536e-04 -1.5004072e-04 ... -2.5516748e-04
  5.0776452e-04 -6.4767897e-05]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 4.48291015625
[PAIRWISE] pred_attackers_indx:  [1 5 6 8 9]
layer2_inf_t: 531.105712890625
assumed final_attacker_idxs:  [1 5 6 7 8 9]
final_attacker_idxs is: [1 5 6 7 8 9]
g_attacker_idxs: [49 52 18 63 64 93]
g_normal_idxs: [68 29 31 62]
filtered_attacker_idxs: [1, 5, 7, 9]
final_attacker_idxs are: [1, 5, 7, 9]
num_dps: [494, 506, 1002, 835, 423, 253, 459, 889, 813, 623]
Num data points: [494, 506, 1002, 835, 423, 253, 459, 889, 813, 623]
Num selected data points: [ 494 1002  835  423  459  813]
The chosen ones are users: [0, 2, 3, 4, 6, 8], which are global users: [68, 29, 31, 62, 18, 64]
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0327, Accuracy: 9885/10000 (98.8500%)
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: True, epoch: 163: Average loss: 15.1389, Accuracy: 19/8968 (0.2119%)
Done in 61.34356379508972 sec.
Server Epoch:164 choose agents : [26, 71, 40, 52, 69, 25, 34, 82, 13, 80].
poison local model 26 index 0
___Train Local_Simple,  epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 548/554 (98.9170%)
___Train Local_Simple,  epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0935, Accuracy: 9723/10000 (97.2300%)
poison local model 71 index 1
___Train Local_Simple,  epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1372/1384 (99.1329%)
___Train Local_Simple,  epoch 164, local model 71, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1382/1384 (99.8555%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.2165, Accuracy: 9287/10000 (92.8700%)
___Train Local_Simple,  epoch 164, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 767/772 (99.3523%)
___Train Local_Simple,  epoch 164, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0902, Accuracy: 9724/10000 (97.2400%)
poison local model 52 index 2
___Train Local_Simple,  epoch 164, local model 52, internal_epoch   1,  Average loss: 0.0007, Accuracy: 248/253 (98.0237%)
___Train Local_Simple,  epoch 164, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 251/253 (99.2095%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0690, Accuracy: 9784/10000 (97.8400%)
___Train Local_Simple,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0004, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.1708, Accuracy: 9429/10000 (94.2900%)
___Train Local_Simple,  epoch 164, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 645/647 (99.6909%)
___Train Local_Simple,  epoch 164, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 644/647 (99.5363%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0944, Accuracy: 9705/10000 (97.0500%)
poison local model 34 index 3
___Train Local_Simple,  epoch 164, local model 34, internal_epoch   1,  Average loss: 0.0003, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 164, local model 34, internal_epoch   2,  Average loss: 0.0003, Accuracy: 411/413 (99.5157%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.1343, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch 164, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 711/713 (99.7195%)
___Train Local_Simple,  epoch 164, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.6895, Accuracy: 8765/10000 (87.6500%)
poison local model 13 index 0
___Train Local_Simple,  epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 726/734 (98.9101%)
___Train Local_Simple,  epoch 164, local model 13, internal_epoch   2,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.1196, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch 164, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 164, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0510, Accuracy: 9857/10000 (98.5700%)
time spent on training: 61.53917193412781
Starting performing KrMLRFL...
Num data points: [554, 1384, 772, 253, 256, 647, 413, 713, 734, 431]
Num selected data points: [253 256 647 431]
The chosen ones are users: [3, 4, 5, 9], which are global users: [52, 69, 25, 80]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 71, 52, 34, 13]
base_p: [ 4.0774047e-04  2.0733476e-04 -8.2704239e-05 ... -1.5974194e-03
 -8.5614622e-04 -7.2515756e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 7, 8]
layer1_inf_time: 4.589111328125
[PAIRWISE] pred_attackers_indx:  [1 2 6 8]
layer2_inf_t: 39.2431640625
assumed final_attacker_idxs:  [0 1 2 6 7 8]
final_attacker_idxs is: [0 1 2 6 7 8]
g_attacker_idxs: [26 71 40 34 82 13]
g_normal_idxs: [52 69 25 80]
filtered_attacker_idxs: [0, 1, 2, 6, 7, 8]
final_attacker_idxs are: [0, 1, 2, 6, 7, 8]
num_dps: [554, 1384, 772, 253, 256, 647, 413, 713, 734, 431]
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0349, Accuracy: 9885/10000 (98.8500%)
___Test Local_Simple poisoned: True, epoch: 164: Average loss: 14.7162, Accuracy: 13/8968 (0.1450%)
Done in 69.5986979007721 sec.
Server Epoch:165 choose agents : [91, 45, 92, 26, 17, 20, 82, 86, 68, 37].
poison local model 91 index 0
___Train Local_Simple,  epoch 165, local model 91, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 165, local model 91, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0759, Accuracy: 9750/10000 (97.5000%)
poison local model 45 index 1
___Train Local_Simple,  epoch 165, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 165, local model 45, internal_epoch   2,  Average loss: 0.0010, Accuracy: 616/628 (98.0892%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.1544, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch 165, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 165, local model 92, internal_epoch   2,  Average loss: 0.0010, Accuracy: 920/937 (98.1857%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.3198, Accuracy: 8895/10000 (88.9500%)
poison local model 26 index 2
___Train Local_Simple,  epoch 165, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 548/554 (98.9170%)
___Train Local_Simple,  epoch 165, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0614, Accuracy: 9814/10000 (98.1400%)
poison local model 17 index 3
___Train Local_Simple,  epoch 165, local model 17, internal_epoch   1,  Average loss: 0.0020, Accuracy: 600/620 (96.7742%)
___Train Local_Simple,  epoch 165, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 609/620 (98.2258%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.2196, Accuracy: 9245/10000 (92.4500%)
poison local model 20 index 0
___Train Local_Simple,  epoch 165, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 165, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.4325, Accuracy: 9070/10000 (90.7000%)
___Train Local_Simple,  epoch 165, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 710/713 (99.5792%)
___Train Local_Simple,  epoch 165, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.5598, Accuracy: 8893/10000 (88.9300%)
___Train Local_Simple,  epoch 165, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 165, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 249/250 (99.6000%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0819, Accuracy: 9768/10000 (97.6800%)
___Train Local_Simple,  epoch 165, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 491/494 (99.3927%)
___Train Local_Simple,  epoch 165, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.1524, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch 165, local model 37, internal_epoch   1,  Average loss: 0.0003, Accuracy: 853/860 (99.1860%)
___Train Local_Simple,  epoch 165, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.2098, Accuracy: 9410/10000 (94.1000%)
time spent on training: 54.37861728668213
Starting performing KrMLRFL...
Num data points: [256, 628, 937, 554, 620, 429, 713, 250, 494, 860]
Num selected data points: [256 250 494 860]
The chosen ones are users: [0, 7, 8, 9], which are global users: [91, 86, 68, 37]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 45, 26, 17, 20]
base_p: [ 0.00035136  0.00014704  0.0015842  ... -0.00033848 -0.00156131
 -0.0002609 ]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 5, 6]
layer1_inf_time: 3.653564453125
[PAIRWISE] pred_attackers_indx:  [4 5]
layer2_inf_t: 56.868896484375
assumed final_attacker_idxs:  [1 2 3 4 5 6]
final_attacker_idxs is: [1 2 3 4 5 6]
g_attacker_idxs: [45 92 26 17 20 82]
g_normal_idxs: [91 86 68 37]
filtered_attacker_idxs: [1, 2, 3, 4, 5, 6]
final_attacker_idxs are: [1, 2, 3, 4, 5, 6]
num_dps: [256, 628, 937, 554, 620, 429, 713, 250, 494, 860]
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0642, Accuracy: 9794/10000 (97.9400%)
epoch_acc: 97.94
___Test Local_Simple poisoned: True, epoch: 165: Average loss: 13.9142, Accuracy: 29/8968 (0.3234%)
Done in 61.868799448013306 sec.
Server Epoch:166 choose agents : [13, 86, 10, 11, 9, 91, 16, 92, 50, 63].
poison local model 13 index 0
___Train Local_Simple,  epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0013, Accuracy: 716/734 (97.5477%)
___Train Local_Simple,  epoch 166, local model 13, internal_epoch   2,  Average loss: 0.0015, Accuracy: 716/734 (97.5477%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.1629, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch 166, local model 86, internal_epoch   1,  Average loss: 0.0003, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 166, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0752, Accuracy: 9776/10000 (97.7600%)
___Train Local_Simple,  epoch 166, local model 10, internal_epoch   1,  Average loss: 0.0004, Accuracy: 885/892 (99.2152%)
___Train Local_Simple,  epoch 166, local model 10, internal_epoch   2,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.2108, Accuracy: 9344/10000 (93.4400%)
poison local model 11 index 1
___Train Local_Simple,  epoch 166, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 637/645 (98.7597%)
___Train Local_Simple,  epoch 166, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 641/645 (99.3798%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.2508, Accuracy: 9316/10000 (93.1600%)
___Train Local_Simple,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0007, Accuracy: 428/436 (98.1651%)
___Train Local_Simple,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0007, Accuracy: 428/436 (98.1651%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0728, Accuracy: 9779/10000 (97.7900%)
poison local model 91 index 2
___Train Local_Simple,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.1045, Accuracy: 9669/10000 (96.6900%)
poison local model 16 index 3
___Train Local_Simple,  epoch 166, local model 16, internal_epoch   1,  Average loss: 0.0011, Accuracy: 897/915 (98.0328%)
___Train Local_Simple,  epoch 166, local model 16, internal_epoch   2,  Average loss: 0.0016, Accuracy: 893/915 (97.5956%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.1908, Accuracy: 9460/10000 (94.6000%)
___Train Local_Simple,  epoch 166, local model 92, internal_epoch   1,  Average loss: 0.0010, Accuracy: 919/937 (98.0790%)
___Train Local_Simple,  epoch 166, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 929/937 (99.1462%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.2043, Accuracy: 9317/10000 (93.1700%)
___Train Local_Simple,  epoch 166, local model 50, internal_epoch   1,  Average loss: 0.0006, Accuracy: 467/474 (98.5232%)
___Train Local_Simple,  epoch 166, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.1631, Accuracy: 9483/10000 (94.8300%)
poison local model 63 index 0
___Train Local_Simple,  epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 871/889 (97.9753%)
___Train Local_Simple,  epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 877/889 (98.6502%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0778, Accuracy: 9750/10000 (97.5000%)
time spent on training: 63.82792019844055
Starting performing KrMLRFL...
Num data points: [734, 250, 892, 645, 436, 256, 915, 937, 474, 889]
Num selected data points: [250 892 436 256 474]
The chosen ones are users: [1, 2, 4, 5, 8], which are global users: [86, 10, 9, 91, 50]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 11, 91, 16, 63]
base_p: [2.4370849e-03 2.2959709e-04 3.0124905e-03 ... 1.0303512e-02 3.5866722e-03
 8.6516142e-05]
[T_SCORE] attacker_local_idxs is:  [0, 3, 6, 7, 9]
layer1_inf_time: 4.09716796875
[PAIRWISE] pred_attackers_indx:  [0 6 9]
layer2_inf_t: 82.268310546875
assumed final_attacker_idxs:  [0 3 6 7 9]
final_attacker_idxs is: [0 3 6 7 9]
g_attacker_idxs: [13 11 16 92 63]
g_normal_idxs: [86 10  9 91 50]
filtered_attacker_idxs: [0, 3, 6, 7, 9]
final_attacker_idxs are: [0, 3, 6, 7, 9]
num_dps: [734, 250, 892, 645, 436, 256, 915, 937, 474, 889]
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0523, Accuracy: 9829/10000 (98.2900%)
epoch_acc: 98.29
___Test Local_Simple poisoned: True, epoch: 166: Average loss: 13.6357, Accuracy: 12/8968 (0.1338%)
Done in 73.45895981788635 sec.
Server Epoch:167 choose agents : [43, 87, 29, 30, 75, 32, 89, 81, 52, 2].
___Train Local_Simple,  epoch 167, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 167, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.0493, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 167, local model 87, internal_epoch   1,  Average loss: 0.0004, Accuracy: 466/470 (99.1489%)
___Train Local_Simple,  epoch 167, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.0652, Accuracy: 9784/10000 (97.8400%)
___Train Local_Simple,  epoch 167, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 998/1002 (99.6008%)
___Train Local_Simple,  epoch 167, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.2329, Accuracy: 9298/10000 (92.9800%)
___Train Local_Simple,  epoch 167, local model 30, internal_epoch   1,  Average loss: 0.0005, Accuracy: 397/400 (99.2500%)
___Train Local_Simple,  epoch 167, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.1799, Accuracy: 9430/10000 (94.3000%)
___Train Local_Simple,  epoch 167, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch 167, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.0518, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 167, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 959/977 (98.1576%)
___Train Local_Simple,  epoch 167, local model 32, internal_epoch   2,  Average loss: 0.0008, Accuracy: 962/977 (98.4647%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.1830, Accuracy: 9431/10000 (94.3100%)
___Train Local_Simple,  epoch 167, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 167, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.0688, Accuracy: 9782/10000 (97.8200%)
poison local model 81 index 0
___Train Local_Simple,  epoch 167, local model 81, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1211/1227 (98.6960%)
___Train Local_Simple,  epoch 167, local model 81, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1218/1227 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.2304, Accuracy: 9364/10000 (93.6400%)
poison local model 52 index 1
___Train Local_Simple,  epoch 167, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 167, local model 52, internal_epoch   2,  Average loss: 0.0004, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.1318, Accuracy: 9626/10000 (96.2600%)
poison local model 2 index 2
___Train Local_Simple,  epoch 167, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 538/548 (98.1752%)
___Train Local_Simple,  epoch 167, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%)
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.1291, Accuracy: 9597/10000 (95.9700%)
time spent on training: 82.5745575428009
Starting performing KrMLRFL...
Num data points: [408, 470, 1002, 400, 686, 977, 492, 1227, 253, 548]
Num selected data points: [ 408  470 1002  400  686  492]
The chosen ones are users: [0, 1, 2, 3, 4, 6], which are global users: [43, 87, 29, 30, 75, 89]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [81, 52, 2]
base_p: [ 1.7835200e-03  2.2095814e-04  6.1150640e-06 ...  5.2462518e-03
 -6.0321763e-03 -3.1447336e-03]
[T_SCORE] attacker_local_idxs is:  [4, 5, 7, 8, 9]
layer1_inf_time: 4.17138671875
[PAIRWISE] pred_attackers_indx:  [4 5 7 8]
layer2_inf_t: 36.87255859375
assumed final_attacker_idxs:  [4 5 7 8 9]
final_attacker_idxs is: [4 5 7 8 9]
g_attacker_idxs: [75 32 81 52  2]
g_normal_idxs: [43 87 29 30 89]
filtered_attacker_idxs: [5, 7, 8, 9]
final_attacker_idxs are: [5, 7, 8, 9]
num_dps: [408, 470, 1002, 400, 686, 977, 492, 1227, 253, 548]
___Test Local_Simple poisoned: False, epoch: 167: Average loss: 0.0344, Accuracy: 9886/10000 (98.8600%)
epoch_acc: 98.86
___Test Local_Simple poisoned: True, epoch: 167: Average loss: 13.9556, Accuracy: 12/8968 (0.1338%)
Done in 90.9407868385315 sec.
Server Epoch:168 choose agents : [77, 20, 64, 28, 76, 0, 84, 27, 61, 87].
___Train Local_Simple,  epoch 168, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 582/589 (98.8115%)
___Train Local_Simple,  epoch 168, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 588/589 (99.8302%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.0544, Accuracy: 9841/10000 (98.4100%)
poison local model 20 index 0
___Train Local_Simple,  epoch 168, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 421/429 (98.1352%)
___Train Local_Simple,  epoch 168, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.1717, Accuracy: 9516/10000 (95.1600%)
___Train Local_Simple,  epoch 168, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Train Local_Simple,  epoch 168, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 812/813 (99.8770%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.1246, Accuracy: 9618/10000 (96.1800%)
___Train Local_Simple,  epoch 168, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 168, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.0427, Accuracy: 9860/10000 (98.6000%)
___Train Local_Simple,  epoch 168, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 168, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.0339, Accuracy: 9889/10000 (98.8900%)
___Train Local_Simple,  epoch 168, local model 0, internal_epoch   1,  Average loss: 0.0004, Accuracy: 428/435 (98.3908%)
___Train Local_Simple,  epoch 168, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.0724, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch 168, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1226/1246 (98.3949%)
___Train Local_Simple,  epoch 168, local model 84, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1230/1246 (98.7159%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.0642, Accuracy: 9784/10000 (97.8400%)
poison local model 27 index 1
___Train Local_Simple,  epoch 168, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 168, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 464/471 (98.5138%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.2547, Accuracy: 9342/10000 (93.4200%)
poison local model 61 index 2
___Train Local_Simple,  epoch 168, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 690/699 (98.7124%)
___Train Local_Simple,  epoch 168, local model 61, internal_epoch   2,  Average loss: 0.0006, Accuracy: 688/699 (98.4263%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.3874, Accuracy: 8788/10000 (87.8800%)
___Train Local_Simple,  epoch 168, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Train Local_Simple,  epoch 168, local model 87, internal_epoch   2,  Average loss: 0.0006, Accuracy: 466/470 (99.1489%)
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.0600, Accuracy: 9807/10000 (98.0700%)
time spent on training: 60.35098195075989
Starting performing KrMLRFL...
Num data points: [589, 429, 813, 501, 78, 435, 1246, 471, 699, 470]
Num selected data points: [813 501  78 435 470]
The chosen ones are users: [2, 3, 4, 5, 9], which are global users: [64, 28, 76, 0, 87]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 27, 61]
base_p: [ 0.00017375  0.00012143  0.00021542 ...  0.00620401 -0.00070225
 -0.00072403]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 7, 8]
layer1_inf_time: 4.50732421875
___Test Local_Simple poisoned: False, epoch: 168: Average loss: 0.0374, Accuracy: 9880/10000 (98.8000%)
[PAIRWISE] pred_attackers_indx:  [0 1 2 5 6 8]
layer2_inf_t: 430.261474609375
assumed final_attacker_idxs:  [0 1 2 5 6 7 8]
final_attacker_idxs is: [0 1 2 5 6 7 8]
g_attacker_idxs: [77 20 64  0 84 27 61]
g_normal_idxs: [28 76 87]
filtered_attacker_idxs: [0, 1, 6, 7, 8]
final_attacker_idxs are: [0, 1, 6, 7, 8]
num_dps: [589, 429, 813, 501, 78, 435, 1246, 471, 699, 470]
epoch_acc: 98.8
___Test Local_Simple poisoned: True, epoch: 168: Average loss: 14.3922, Accuracy: 17/8968 (0.1896%)
Done in 116.69531297683716 sec.
Server Epoch:169 choose agents : [60, 49, 45, 23, 85, 35, 3, 0, 89, 34].
___Train Local_Simple,  epoch 169, local model 60, internal_epoch   1,  Average loss: 0.0010, Accuracy: 334/338 (98.8166%)
___Train Local_Simple,  epoch 169, local model 60, internal_epoch   2,  Average loss: 0.0015, Accuracy: 330/338 (97.6331%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0856, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch 169, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 169, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 502/506 (99.2095%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0605, Accuracy: 9805/10000 (98.0500%)
poison local model 45 index 0
___Train Local_Simple,  epoch 169, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 169, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.1190, Accuracy: 9632/10000 (96.3200%)
___Train Local_Simple,  epoch 169, local model 23, internal_epoch   1,  Average loss: 0.0003, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch 169, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0639, Accuracy: 9799/10000 (97.9900%)
poison local model 85 index 1
___Train Local_Simple,  epoch 169, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 169, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0544, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 169, local model 35, internal_epoch   1,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 169, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0604, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 169, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 910/923 (98.5915%)
___Train Local_Simple,  epoch 169, local model 3, internal_epoch   2,  Average loss: 0.0007, Accuracy: 913/923 (98.9166%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0800, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch 169, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Train Local_Simple,  epoch 169, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0642, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 169, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Train Local_Simple,  epoch 169, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0438, Accuracy: 9861/10000 (98.6100%)
poison local model 34 index 2
___Train Local_Simple,  epoch 169, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 410/413 (99.2736%)
___Train Local_Simple,  epoch 169, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0871, Accuracy: 9727/10000 (97.2700%)
time spent on training: 54.9317626953125
Starting performing KrMLRFL...
Num data points: [338, 506, 628, 293, 431, 499, 923, 435, 492, 413]
Num selected data points: [506 293 499 435 492]
The chosen ones are users: [1, 3, 5, 7, 8], which are global users: [49, 23, 35, 0, 89]
___Test Local_Simple poisoned: False, epoch: 169: Average loss: 0.0367, Accuracy: 9879/10000 (98.7900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 85, 34]
base_p: [0.00032651 0.00010243 0.00043624 ... 0.00204735 0.00198846 0.0006109 ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 6, 9]
layer1_inf_time: 2.949462890625
[PAIRWISE] pred_attackers_indx:  [2 4 6]
layer2_inf_t: 29.675537109375
assumed final_attacker_idxs:  [0 2 4 6 9]
final_attacker_idxs is: [0 2 4 6 9]
g_attacker_idxs: [60 45 85  3 34]
g_normal_idxs: [49 23 35  0 89]
filtered_attacker_idxs: [0, 2, 4, 6, 9]
final_attacker_idxs are: [0, 2, 4, 6, 9]
num_dps: [338, 506, 628, 293, 431, 499, 923, 435, 492, 413]
epoch_acc: 98.79
___Test Local_Simple poisoned: True, epoch: 169: Average loss: 15.1574, Accuracy: 15/8968 (0.1673%)
Done in 60.85906457901001 sec.
Server Epoch:170 choose agents : [42, 55, 34, 70, 59, 91, 35, 26, 90, 62].
poison local model 42 index 0
___Train Local_Simple,  epoch 170, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch 170, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.0558, Accuracy: 9832/10000 (98.3200%)
___Train Local_Simple,  epoch 170, local model 55, internal_epoch   1,  Average loss: 0.0004, Accuracy: 350/354 (98.8701%)
___Train Local_Simple,  epoch 170, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.3385, Accuracy: 9045/10000 (90.4500%)
poison local model 34 index 1
___Train Local_Simple,  epoch 170, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 170, local model 34, internal_epoch   2,  Average loss: 0.0003, Accuracy: 411/413 (99.5157%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.0770, Accuracy: 9765/10000 (97.6500%)
poison local model 70 index 2
___Train Local_Simple,  epoch 170, local model 70, internal_epoch   1,  Average loss: 0.0006, Accuracy: 712/724 (98.3425%)
___Train Local_Simple,  epoch 170, local model 70, internal_epoch   2,  Average loss: 0.0010, Accuracy: 714/724 (98.6188%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.2671, Accuracy: 9230/10000 (92.3000%)
___Train Local_Simple,  epoch 170, local model 59, internal_epoch   1,  Average loss: 0.0007, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch 170, local model 59, internal_epoch   2,  Average loss: 0.0013, Accuracy: 749/760 (98.5526%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.2992, Accuracy: 9148/10000 (91.4800%)
poison local model 91 index 3
___Train Local_Simple,  epoch 170, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 170, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.0624, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch 170, local model 35, internal_epoch   1,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 170, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.0514, Accuracy: 9840/10000 (98.4000%)
poison local model 26 index 0
___Train Local_Simple,  epoch 170, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 170, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.0526, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 170, local model 90, internal_epoch   1,  Average loss: 0.0003, Accuracy: 676/683 (98.9751%)
___Train Local_Simple,  epoch 170, local model 90, internal_epoch   2,  Average loss: 0.0006, Accuracy: 675/683 (98.8287%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.3898, Accuracy: 8824/10000 (88.2400%)
___Train Local_Simple,  epoch 170, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 170, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.0715, Accuracy: 9779/10000 (97.7900%)
time spent on training: 54.73404312133789
Starting performing KrMLRFL...
Num data points: [236, 354, 413, 724, 760, 256, 499, 554, 683, 423]
Num selected data points: [354 256 499 683 423]
The chosen ones are users: [1, 5, 6, 8, 9], which are global users: [55, 91, 35, 90, 62]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 34, 70, 91, 26]
base_p: [ 0.00029725  0.00012432 -0.0003312  ...  0.0018962   0.00601312
  0.00043336]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 7]
layer1_inf_time: 3.49658203125
[PAIRWISE] pred_attackers_indx:  [1 3 4]
layer2_inf_t: 30.507080078125
assumed final_attacker_idxs:  [0 1 2 3 4 7]
final_attacker_idxs is: [0 1 2 3 4 7]
g_attacker_idxs: [42 55 34 70 59 26]
g_normal_idxs: [91 35 90 62]
filtered_attacker_idxs: [0, 2, 3, 4, 7]
final_attacker_idxs are: [0, 2, 3, 4, 7]
num_dps: [236, 354, 413, 724, 760, 256, 499, 554, 683, 423]
___Test Local_Simple poisoned: False, epoch: 170: Average loss: 0.0416, Accuracy: 9864/10000 (98.6400%)
epoch_acc: 98.64
___Test Local_Simple poisoned: True, epoch: 170: Average loss: 14.4950, Accuracy: 15/8968 (0.1673%)
Done in 61.93561553955078 sec.
Server Epoch:171 choose agents : [71, 45, 68, 3, 29, 9, 13, 74, 63, 85].
poison local model 71 index 0
___Train Local_Simple,  epoch 171, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1367/1384 (98.7717%)
___Train Local_Simple,  epoch 171, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1379/1384 (99.6387%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.1739, Accuracy: 9440/10000 (94.4000%)
poison local model 45 index 1
___Train Local_Simple,  epoch 171, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 617/628 (98.2484%)
___Train Local_Simple,  epoch 171, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 622/628 (99.0446%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.1648, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch 171, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 171, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.0615, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 171, local model 3, internal_epoch   1,  Average loss: 0.0007, Accuracy: 910/923 (98.5915%)
___Train Local_Simple,  epoch 171, local model 3, internal_epoch   2,  Average loss: 0.0003, Accuracy: 917/923 (99.3499%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.1434, Accuracy: 9625/10000 (96.2500%)
___Train Local_Simple,  epoch 171, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 171, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.0718, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch 171, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 171, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.0635, Accuracy: 9814/10000 (98.1400%)
poison local model 13 index 2
___Train Local_Simple,  epoch 171, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%)
___Train Local_Simple,  epoch 171, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.1111, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch 171, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%)
___Train Local_Simple,  epoch 171, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.1307, Accuracy: 9595/10000 (95.9500%)
poison local model 63 index 3
___Train Local_Simple,  epoch 171, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 873/889 (98.2002%)
___Train Local_Simple,  epoch 171, local model 63, internal_epoch   2,  Average loss: 0.0004, Accuracy: 884/889 (99.4376%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.0817, Accuracy: 9755/10000 (97.5500%)
poison local model 85 index 0
___Train Local_Simple,  epoch 171, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 171, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.0690, Accuracy: 9791/10000 (97.9100%)
time spent on training: 61.89435648918152
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 45, 13, 63, 85]
base_p: [ 0.00214905  0.00021835  0.0003795  ...  0.00126299 -0.0064336
 -0.00347791]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 6, 8]
layer1_inf_time: 4.971923828125
[PAIRWISE] pred_attackers_indx:  [0 1 3 6 8 9]
layer2_inf_t: 102.77734375
assumed final_attacker_idxs:  [0 1 3 6 8 9]
final_attacker_idxs is: [0 1 3 6 8 9]
g_attacker_idxs: [71 45  3 13 63 85]
g_normal_idxs: [68 29  9 74]
filtered_attacker_idxs: [0, 1, 3, 6, 8, 9]
final_attacker_idxs are: [0, 1, 3, 6, 8, 9]
num_dps: [1384, 628, 494, 923, 1002, 436, 734, 557, 889, 431]
epoch_acc: 98.72
Starting performing KrMLRFL...
Num data points: [1384, 628, 494, 923, 1002, 436, 734, 557, 889, 431]
Num selected data points: [ 494 1002  436  557]
The chosen ones are users: [2, 4, 5, 7], which are global users: [68, 29, 9, 74]
___Test Local_Simple poisoned: False, epoch: 171: Average loss: 0.0389, Accuracy: 9872/10000 (98.7200%)
___Test Local_Simple poisoned: True, epoch: 171: Average loss: 14.3041, Accuracy: 25/8968 (0.2788%)
Done in 68.89092826843262 sec.
Server Epoch:172 choose agents : [80, 20, 51, 54, 5, 49, 95, 21, 35, 43].
___Train Local_Simple,  epoch 172, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 172, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.0561, Accuracy: 9834/10000 (98.3400%)
poison local model 20 index 0
___Train Local_Simple,  epoch 172, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 420/429 (97.9021%)
___Train Local_Simple,  epoch 172, local model 20, internal_epoch   2,  Average loss: 0.0009, Accuracy: 422/429 (98.3683%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.1877, Accuracy: 9454/10000 (94.5400%)
poison local model 51 index 1
___Train Local_Simple,  epoch 172, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 172, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.1320, Accuracy: 9593/10000 (95.9300%)
___Train Local_Simple,  epoch 172, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 515/519 (99.2293%)
___Train Local_Simple,  epoch 172, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.1571, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch 172, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 429/434 (98.8479%)
___Train Local_Simple,  epoch 172, local model 5, internal_epoch   2,  Average loss: 0.0004, Accuracy: 428/434 (98.6175%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.4746, Accuracy: 8829/10000 (88.2900%)
___Train Local_Simple,  epoch 172, local model 49, internal_epoch   1,  Average loss: 0.0004, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 172, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.0996, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch 172, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 172, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.2685, Accuracy: 9199/10000 (91.9900%)
___Train Local_Simple,  epoch 172, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch 172, local model 21, internal_epoch   2,  Average loss: 0.0003, Accuracy: 309/312 (99.0385%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.1984, Accuracy: 9438/10000 (94.3800%)
___Train Local_Simple,  epoch 172, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 172, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.1020, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch 172, local model 43, internal_epoch   1,  Average loss: 0.0004, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 172, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 406/408 (99.5098%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 51]
base_p: [ 0.00030503  0.00012234  0.00105999 ...  0.0005845  -0.00043159
  0.00214446]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 5, 6]
layer1_inf_time: 4.981201171875
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.0638, Accuracy: 9790/10000 (97.9000%)
time spent on training: 40.4217267036438
Starting performing KrMLRFL...
[PAIRWISE] pred_attackers_indx:  [1 2 3 4 6 7]
layer2_inf_t: 571.323974609375
assumed final_attacker_idxs:  [1 2 3 4 5 6 7]
final_attacker_idxs is: [1 2 3 4 5 6 7]
g_attacker_idxs: [20 51 54  5 49 95 21]
g_normal_idxs: [80 35 43]
filtered_attacker_idxs: [1, 2, 5, 6]
final_attacker_idxs are: [1, 2, 5, 6]
num_dps: [431, 429, 568, 519, 434, 506, 602, 312, 499, 408]
epoch_acc: 99.0
Num data points: [431, 429, 568, 519, 434, 506, 602, 312, 499, 408]
Num selected data points: [431 519 434 312 499 408]
The chosen ones are users: [0, 3, 4, 7, 8, 9], which are global users: [80, 54, 5, 21, 35, 43]
___Test Local_Simple poisoned: False, epoch: 172: Average loss: 0.0328, Accuracy: 9900/10000 (99.0000%)
___Test Local_Simple poisoned: True, epoch: 172: Average loss: 13.8205, Accuracy: 13/8968 (0.1450%)
Done in 46.48915505409241 sec.
Server Epoch:173 choose agents : [3, 61, 72, 87, 80, 8, 43, 82, 79, 4].
___Train Local_Simple,  epoch 173, local model 3, internal_epoch   1,  Average loss: 0.0010, Accuracy: 908/923 (98.3749%)
___Train Local_Simple,  epoch 173, local model 3, internal_epoch   2,  Average loss: 0.0006, Accuracy: 912/923 (98.8082%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.2927, Accuracy: 9125/10000 (91.2500%)
poison local model 61 index 0
___Train Local_Simple,  epoch 173, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 694/699 (99.2847%)
___Train Local_Simple,  epoch 173, local model 61, internal_epoch   2,  Average loss: 0.0006, Accuracy: 690/699 (98.7124%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.3038, Accuracy: 8963/10000 (89.6300%)
___Train Local_Simple,  epoch 173, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 173, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0582, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 173, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 173, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0455, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 173, local model 80, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 173, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0527, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch 173, local model 8, internal_epoch   1,  Average loss: 0.0002, Accuracy: 630/633 (99.5261%)
___Train Local_Simple,  epoch 173, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0538, Accuracy: 9832/10000 (98.3200%)
___Train Local_Simple,  epoch 173, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 173, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0680, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 173, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch 173, local model 82, internal_epoch   2,  Average loss: 0.0018, Accuracy: 689/713 (96.6339%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.6281, Accuracy: 8359/10000 (83.5900%)
___Train Local_Simple,  epoch 173, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 173, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0407, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch 173, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch 173, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 655/658 (99.5441%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61]
base_p: [ 0.0003805   0.00013992 -0.00011731 ...  0.00855638 -0.00563116
 -0.00158063]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 7, 9]
layer1_inf_time: 3.24365234375
[PAIRWISE] pred_attackers_indx:  [0]
layer2_inf_t: 33.72705078125
assumed final_attacker_idxs:  [0 1 2 7 9]
final_attacker_idxs is: [0 1 2 7 9]
g_attacker_idxs: [ 3 61 72 82  4]
g_normal_idxs: [87 80  8 43 79]
filtered_attacker_idxs: [0, 1, 7, 9]
final_attacker_idxs are: [0, 1, 7, 9]
num_dps: [923, 699, 731, 470, 431, 633, 408, 713, 182, 658]
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0841, Accuracy: 9736/10000 (97.3600%)
time spent on training: 65.0133638381958
Starting performing KrMLRFL...
Num data points: [923, 699, 731, 470, 431, 633, 408, 713, 182, 658]
Num selected data points: [731 470 431 633 408 182]
The chosen ones are users: [2, 3, 4, 5, 6, 8], which are global users: [72, 87, 80, 8, 43, 79]
epoch_acc: 99.03999999999999
___Test Local_Simple poisoned: False, epoch: 173: Average loss: 0.0312, Accuracy: 9904/10000 (99.0400%)
___Test Local_Simple poisoned: True, epoch: 173: Average loss: 14.0276, Accuracy: 12/8968 (0.1338%)
Done in 70.28378486633301 sec.
Server Epoch:174 choose agents : [85, 87, 15, 55, 62, 97, 76, 23, 83, 92].
poison local model 85 index 0
___Train Local_Simple,  epoch 174, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 174, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0508, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 174, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch 174, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 469/470 (99.7872%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0494, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 174, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch 174, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0440, Accuracy: 9856/10000 (98.5600%)
___Train Local_Simple,  epoch 174, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 174, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.1998, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch 174, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 174, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 420/423 (99.2908%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0553, Accuracy: 9800/10000 (98.0000%)
___Train Local_Simple,  epoch 174, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 174, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.2363, Accuracy: 9498/10000 (94.9800%)
___Train Local_Simple,  epoch 174, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 174, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0314, Accuracy: 9903/10000 (99.0300%)
___Train Local_Simple,  epoch 174, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 174, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0484, Accuracy: 9844/10000 (98.4400%)
___Train Local_Simple,  epoch 174, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 428/433 (98.8453%)
___Train Local_Simple,  epoch 174, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0422, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch 174, local model 92, internal_epoch   1,  Average loss: 0.0009, Accuracy: 921/937 (98.2924%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85]
base_p: [0.00014877 0.00012311 0.00372151 ... 0.00243774 0.00624839 0.0028827 ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 9]
layer1_inf_time: 4.0224609375
[PAIRWISE] pred_attackers_indx:  [3 9]
layer2_inf_t: 32.5888671875
assumed final_attacker_idxs:  [0 2 3 5 9]
final_attacker_idxs is: [0 2 3 5 9]
g_attacker_idxs: [85 15 55 97 92]
g_normal_idxs: [87 62 76 23 83]
filtered_attacker_idxs: [0, 9]
final_attacker_idxs are: [0, 9]
num_dps: [431, 470, 401, 354, 423, 487, 78, 293, 433, 937]
___Train Local_Simple,  epoch 174, local model 92, internal_epoch   2,  Average loss: 0.0007, Accuracy: 922/937 (98.3991%)
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.2386, Accuracy: 9243/10000 (92.4300%)
time spent on training: 35.80789875984192
Starting performing KrMLRFL...
Num data points: [431, 470, 401, 354, 423, 487, 78, 293, 433, 937]
Num selected data points: [470 401 354 423 487  78 293 433]
The chosen ones are users: [1, 2, 3, 4, 5, 6, 7, 8], which are global users: [87, 15, 55, 62, 97, 76, 23, 83]
epoch_acc: 98.83
___Test Local_Simple poisoned: False, epoch: 174: Average loss: 0.0350, Accuracy: 9883/10000 (98.8300%)
___Test Local_Simple poisoned: True, epoch: 174: Average loss: 14.1183, Accuracy: 19/8968 (0.2119%)
Done in 43.01386785507202 sec.
Server Epoch:175 choose agents : [65, 63, 90, 58, 33, 49, 59, 93, 69, 64].
___Train Local_Simple,  epoch 175, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 175, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.0762, Accuracy: 9756/10000 (97.5600%)
poison local model 63 index 0
___Train Local_Simple,  epoch 175, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 874/889 (98.3127%)
___Train Local_Simple,  epoch 175, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 874/889 (98.3127%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.0596, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch 175, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Train Local_Simple,  epoch 175, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.0594, Accuracy: 9810/10000 (98.1000%)
___Train Local_Simple,  epoch 175, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch 175, local model 58, internal_epoch   2,  Average loss: 0.0003, Accuracy: 273/276 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.1664, Accuracy: 9435/10000 (94.3500%)
___Train Local_Simple,  epoch 175, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 175, local model 33, internal_epoch   2,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.0432, Accuracy: 9861/10000 (98.6100%)
___Train Local_Simple,  epoch 175, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 175, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.0651, Accuracy: 9789/10000 (97.8900%)
___Train Local_Simple,  epoch 175, local model 59, internal_epoch   1,  Average loss: 0.0007, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 175, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 750/760 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.1632, Accuracy: 9479/10000 (94.7900%)
poison local model 93 index 1
___Train Local_Simple,  epoch 175, local model 93, internal_epoch   1,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 175, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.2775, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch 175, local model 69, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 175, local model 69, internal_epoch   2,  Average loss: 0.0003, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.1331, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch 175, local model 64, internal_epoch   1,  Average loss: 0.0002, Accuracy: 811/813 (99.7540%)
___Train Local_Simple,  epoch 175, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 811/813 (99.7540%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 93]
base_p: [ 1.9562393e-03  1.5180558e-04 -4.2505283e-04 ... -9.6821785e-04
 -8.3058700e-03  7.3216856e-05]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 7, 9]
layer1_inf_time: 3.0888671875
[PAIRWISE] pred_attackers_indx:  [1 7 9]
layer2_inf_t: 26.833984375
assumed final_attacker_idxs:  [1 4 6 7 9]
final_attacker_idxs is: [1 4 6 7 9]
g_attacker_idxs: [63 33 59 93 64]
g_normal_idxs: [65 90 58 49 69]
filtered_attacker_idxs: [1, 6, 7]
final_attacker_idxs are: [1, 6, 7]
num_dps: [371, 889, 683, 276, 623, 506, 760, 623, 256, 813]
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.3237, Accuracy: 9102/10000 (91.0200%)
time spent on training: 44.10748505592346
Starting performing KrMLRFL...
Num data points: [371, 889, 683, 276, 623, 506, 760, 623, 256, 813]
Num selected data points: [371 683 276 623 506 256 813]
The chosen ones are users: [0, 2, 3, 4, 5, 8, 9], which are global users: [65, 90, 58, 33, 49, 69, 64]
___Test Local_Simple poisoned: False, epoch: 175: Average loss: 0.0349, Accuracy: 9879/10000 (98.7900%)
epoch_acc: 98.79
___Test Local_Simple poisoned: True, epoch: 175: Average loss: 15.0138, Accuracy: 8/8968 (0.0892%)
Done in 52.492027044296265 sec.
Server Epoch:176 choose agents : [55, 60, 92, 38, 28, 61, 84, 3, 46, 1].
___Train Local_Simple,  epoch 176, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch 176, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.1403, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch 176, local model 60, internal_epoch   1,  Average loss: 0.0007, Accuracy: 334/338 (98.8166%)
___Train Local_Simple,  epoch 176, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 335/338 (99.1124%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.1127, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch 176, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 930/937 (99.2529%)
___Train Local_Simple,  epoch 176, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 933/937 (99.5731%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.2736, Accuracy: 9126/10000 (91.2600%)
___Train Local_Simple,  epoch 176, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 891/895 (99.5531%)
___Train Local_Simple,  epoch 176, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.1994, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch 176, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 176, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.0378, Accuracy: 9884/10000 (98.8400%)
poison local model 61 index 0
___Train Local_Simple,  epoch 176, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 690/699 (98.7124%)
___Train Local_Simple,  epoch 176, local model 61, internal_epoch   2,  Average loss: 0.0010, Accuracy: 685/699 (97.9971%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.2098, Accuracy: 9262/10000 (92.6200%)
___Train Local_Simple,  epoch 176, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1232/1246 (98.8764%)
___Train Local_Simple,  epoch 176, local model 84, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1224/1246 (98.2343%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.1126, Accuracy: 9642/10000 (96.4200%)
___Train Local_Simple,  epoch 176, local model 3, internal_epoch   1,  Average loss: 0.0008, Accuracy: 912/923 (98.8082%)
___Train Local_Simple,  epoch 176, local model 3, internal_epoch   2,  Average loss: 0.0003, Accuracy: 920/923 (99.6750%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.1707, Accuracy: 9406/10000 (94.0600%)
___Train Local_Simple,  epoch 176, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 703/710 (99.0141%)
___Train Local_Simple,  epoch 176, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 695/710 (97.8873%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.9633, Accuracy: 8507/10000 (85.0700%)
poison local model 1 index 1
___Train Local_Simple,  epoch 176, local model 1, internal_epoch   1,  Average loss: 0.0009, Accuracy: 746/760 (98.1579%)
___Train Local_Simple,  epoch 176, local model 1, internal_epoch   2,  Average loss: 0.0006, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.3170, Accuracy: 8980/10000 (89.8000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 1]
base_p: [4.9082190e-04 4.8805028e-05 4.4407044e-04 ... 5.3762943e-03 9.8231509e-03
 4.9945042e-03]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 7, 8, 9]
layer1_inf_time: 4.7236328125
[PAIRWISE] pred_attackers_indx:  [5 7 8 9]
layer2_inf_t: 33.746826171875
assumed final_attacker_idxs:  [2 5 6 7 8 9]
final_attacker_idxs is: [2 5 6 7 8 9]
g_attacker_idxs: [92 61 84  3 46  1]
g_normal_idxs: [55 60 38 28]
filtered_attacker_idxs: [2, 5, 6, 7, 8, 9]
final_attacker_idxs are: [2, 5, 6, 7, 8, 9]
num_dps: [354, 338, 937, 895, 501, 699, 1246, 923, 710, 760]
time spent on training: 47.25941324234009
Starting performing KrMLRFL...
Num data points: [354, 338, 937, 895, 501, 699, 1246, 923, 710, 760]
Num selected data points: [354 338 895 501]
The chosen ones are users: [0, 1, 3, 4], which are global users: [55, 60, 38, 28]
epoch_acc: 98.19
___Test Local_Simple poisoned: False, epoch: 176: Average loss: 0.0564, Accuracy: 9819/10000 (98.1900%)
___Test Local_Simple poisoned: True, epoch: 176: Average loss: 16.4461, Accuracy: 1/8968 (0.0112%)
Done in 55.83879637718201 sec.
Server Epoch:177 choose agents : [49, 80, 68, 75, 82, 38, 73, 31, 30, 19].
___Train Local_Simple,  epoch 177, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 177, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.0740, Accuracy: 9766/10000 (97.6600%)
___Train Local_Simple,  epoch 177, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 177, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.0578, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 177, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 177, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.0800, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch 177, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch 177, local model 75, internal_epoch   2,  Average loss: 0.0004, Accuracy: 680/686 (99.1254%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.2641, Accuracy: 9289/10000 (92.8900%)
___Train Local_Simple,  epoch 177, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch 177, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.6246, Accuracy: 8775/10000 (87.7500%)
___Train Local_Simple,  epoch 177, local model 38, internal_epoch   1,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Train Local_Simple,  epoch 177, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.0659, Accuracy: 9808/10000 (98.0800%)
poison local model 73 index 0
___Train Local_Simple,  epoch 177, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%)
___Train Local_Simple,  epoch 177, local model 73, internal_epoch   2,  Average loss: 0.0007, Accuracy: 585/591 (98.9848%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.1397, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch 177, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%)
___Train Local_Simple,  epoch 177, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.0646, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 177, local model 30, internal_epoch   1,  Average loss: 0.0004, Accuracy: 397/400 (99.2500%)
___Train Local_Simple,  epoch 177, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 397/400 (99.2500%)
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.3440, Accuracy: 8930/10000 (89.3000%)
___Train Local_Simple,  epoch 177, local model 19, internal_epoch   1,  Average loss: 0.0008, Accuracy: 201/205 (98.0488%)
___Train Local_Simple,  epoch 177, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 204/205 (99.5122%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73]
base_p: [ 4.2315573e-04  1.7987192e-04 -4.7933869e-04 ... -1.8759072e-04
 -2.2373274e-03  6.1795115e-05]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 6, 7]
layer1_inf_time: 5.248291015625
[PAIRWISE] pred_attackers_indx:  [0 1 2 7 8 9]
layer2_inf_t: 44.026123046875
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 8 9]
g_attacker_idxs: [49 80 68 75 82 38 73 31 30 19]
g_normal_idxs: []
filtered_attacker_idxs: [0, 4, 6]
final_attacker_idxs are: [0, 4, 6]
num_dps: [506, 431, 494, 686, 713, 895, 591, 835, 400, 205]
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.0726, Accuracy: 9771/10000 (97.7100%)
time spent on training: 40.0928590297699
Starting performing KrMLRFL...
Num data points: [506, 431, 494, 686, 713, 895, 591, 835, 400, 205]
Num selected data points: [431 494 686 895 835 400 205]
The chosen ones are users: [1, 2, 3, 5, 7, 8, 9], which are global users: [80, 68, 75, 38, 31, 30, 19]
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: False, epoch: 177: Average loss: 0.0403, Accuracy: 9874/10000 (98.7400%)
___Test Local_Simple poisoned: True, epoch: 177: Average loss: 15.3896, Accuracy: 12/8968 (0.1338%)
Done in 47.57468318939209 sec.
Server Epoch:178 choose agents : [10, 83, 14, 3, 36, 37, 62, 52, 76, 60].
___Train Local_Simple,  epoch 178, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 887/892 (99.4395%)
___Train Local_Simple,  epoch 178, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 890/892 (99.7758%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.0774, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch 178, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch 178, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.0433, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 178, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 374/376 (99.4681%)
___Train Local_Simple,  epoch 178, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.1057, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch 178, local model 3, internal_epoch   1,  Average loss: 0.0006, Accuracy: 912/923 (98.8082%)
___Train Local_Simple,  epoch 178, local model 3, internal_epoch   2,  Average loss: 0.0008, Accuracy: 910/923 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.1842, Accuracy: 9432/10000 (94.3200%)
___Train Local_Simple,  epoch 178, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 995/1005 (99.0050%)
___Train Local_Simple,  epoch 178, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 995/1005 (99.0050%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.2072, Accuracy: 9433/10000 (94.3300%)
___Train Local_Simple,  epoch 178, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 856/860 (99.5349%)
___Train Local_Simple,  epoch 178, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.0887, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch 178, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 178, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.0475, Accuracy: 9850/10000 (98.5000%)
poison local model 52 index 0
___Train Local_Simple,  epoch 178, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 178, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.1358, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch 178, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 178, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.0391, Accuracy: 9878/10000 (98.7800%)
___Train Local_Simple,  epoch 178, local model 60, internal_epoch   1,  Average loss: 0.0003, Accuracy: 336/338 (99.4083%)
___Train Local_Simple,  epoch 178, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 336/338 (99.4083%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00025935  0.00015912 -0.00052657 ...  0.00199315  0.00092145
 -0.00152295]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 7, 9]
layer1_inf_time: 3.686767578125
[PAIRWISE] pred_attackers_indx:  [3 4 7]
layer2_inf_t: 30.19140625
assumed final_attacker_idxs:  [3 4 5 7 9]
final_attacker_idxs is: [3 4 5 7 9]
g_attacker_idxs: [ 3 36 37 52 60]
g_normal_idxs: [10 83 14 62 76]
filtered_attacker_idxs: [3, 4, 7, 9]
final_attacker_idxs are: [3, 4, 7, 9]
num_dps: [892, 433, 376, 923, 1005, 860, 423, 253, 78, 338]
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.0548, Accuracy: 9824/10000 (98.2400%)
time spent on training: 39.050673961639404
Starting performing KrMLRFL...
Num data points: [892, 433, 376, 923, 1005, 860, 423, 253, 78, 338]
Num selected data points: [892 433 376 860 423  78]
The chosen ones are users: [0, 1, 2, 5, 6, 8], which are global users: [10, 83, 14, 37, 62, 76]
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: False, epoch: 178: Average loss: 0.0377, Accuracy: 9874/10000 (98.7400%)
___Test Local_Simple poisoned: True, epoch: 178: Average loss: 14.0671, Accuracy: 30/8968 (0.3345%)
Done in 44.7218554019928 sec.
Server Epoch:179 choose agents : [93, 39, 47, 42, 62, 18, 6, 71, 2, 63].
poison local model 93 index 0
___Train Local_Simple,  epoch 179, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 179, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.3287, Accuracy: 9101/10000 (91.0100%)
___Train Local_Simple,  epoch 179, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 257/257 (100.0000%)
___Train Local_Simple,  epoch 179, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.0451, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch 179, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 771/776 (99.3557%)
___Train Local_Simple,  epoch 179, local model 47, internal_epoch   2,  Average loss: 0.0031, Accuracy: 732/776 (94.3299%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.1869, Accuracy: 9453/10000 (94.5300%)
poison local model 42 index 1
___Train Local_Simple,  epoch 179, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 179, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.0575, Accuracy: 9814/10000 (98.1400%)
___Train Local_Simple,  epoch 179, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 179, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.0383, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch 179, local model 18, internal_epoch   1,  Average loss: 0.0009, Accuracy: 454/459 (98.9107%)
___Train Local_Simple,  epoch 179, local model 18, internal_epoch   2,  Average loss: 0.0011, Accuracy: 452/459 (98.4749%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.2191, Accuracy: 9390/10000 (93.9000%)
___Train Local_Simple,  epoch 179, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 613/615 (99.6748%)
___Train Local_Simple,  epoch 179, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.0678, Accuracy: 9794/10000 (97.9400%)
poison local model 71 index 2
___Train Local_Simple,  epoch 179, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1373/1384 (99.2052%)
___Train Local_Simple,  epoch 179, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1374/1384 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.1348, Accuracy: 9569/10000 (95.6900%)
poison local model 2 index 3
___Train Local_Simple,  epoch 179, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 179, local model 2, internal_epoch   2,  Average loss: 0.0005, Accuracy: 540/548 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.2368, Accuracy: 9121/10000 (91.2100%)
poison local model 63 index 0
___Train Local_Simple,  epoch 179, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 872/889 (98.0877%)
___Train Local_Simple,  epoch 179, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 878/889 (98.7627%)
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.0738, Accuracy: 9771/10000 (97.7100%)
time spent on training: 60.89373278617859
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93, 42, 71, 2, 63]
base_p: [ 0.00182097  0.00025381 -0.00077292 ... -0.00142214 -0.00268468
 -0.00023222]
[T_SCORE] attacker_local_idxs is:  [0, 2, 7, 8, 9]
layer1_inf_time: 3.73828125
[PAIRWISE] pred_attackers_indx:  [0 2 7 9]
layer2_inf_t: 48.792724609375
assumed final_attacker_idxs:  [0 2 7 8 9]
final_attacker_idxs is: [0 2 7 8 9]
g_attacker_idxs: [93 47 71  2 63]
g_normal_idxs: [39 42 62 18  6]
filtered_attacker_idxs: [0, 2, 7, 8, 9]
final_attacker_idxs are: [0, 2, 7, 8, 9]
num_dps: [623, 257, 776, 236, 423, 459, 615, 1384, 548, 889]
epoch_acc: 98.7
Starting performing KrMLRFL...
Num data points: [623, 257, 776, 236, 423, 459, 615, 1384, 548, 889]
Num selected data points: [257 236 423 459 615]
The chosen ones are users: [1, 3, 4, 5, 6], which are global users: [39, 42, 62, 18, 6]
___Test Local_Simple poisoned: False, epoch: 179: Average loss: 0.0363, Accuracy: 9870/10000 (98.7000%)
___Test Local_Simple poisoned: True, epoch: 179: Average loss: 13.8446, Accuracy: 25/8968 (0.2788%)
Done in 68.49663138389587 sec.
Server Epoch:180 choose agents : [34, 20, 21, 61, 18, 87, 53, 58, 60, 0].
poison local model 34 index 0
___Train Local_Simple,  epoch 180, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 180, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.1087, Accuracy: 9669/10000 (96.6900%)
poison local model 20 index 1
___Train Local_Simple,  epoch 180, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 421/429 (98.1352%)
___Train Local_Simple,  epoch 180, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.1867, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch 180, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 309/312 (99.0385%)
___Train Local_Simple,  epoch 180, local model 21, internal_epoch   2,  Average loss: 0.0003, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.0833, Accuracy: 9714/10000 (97.1400%)
poison local model 61 index 2
___Train Local_Simple,  epoch 180, local model 61, internal_epoch   1,  Average loss: 0.0007, Accuracy: 694/699 (99.2847%)
___Train Local_Simple,  epoch 180, local model 61, internal_epoch   2,  Average loss: 0.0007, Accuracy: 691/699 (98.8555%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.1603, Accuracy: 9386/10000 (93.8600%)
___Train Local_Simple,  epoch 180, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 458/459 (99.7821%)
___Train Local_Simple,  epoch 180, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.0736, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch 180, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 180, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.0495, Accuracy: 9833/10000 (98.3300%)
___Train Local_Simple,  epoch 180, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 729/739 (98.6468%)
___Train Local_Simple,  epoch 180, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.2934, Accuracy: 9133/10000 (91.3300%)
___Train Local_Simple,  epoch 180, local model 58, internal_epoch   1,  Average loss: 0.0002, Accuracy: 274/276 (99.2754%)
___Train Local_Simple,  epoch 180, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.0484, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch 180, local model 60, internal_epoch   1,  Average loss: 0.0006, Accuracy: 334/338 (98.8166%)
___Train Local_Simple,  epoch 180, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 336/338 (99.4083%)
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.2197, Accuracy: 9431/10000 (94.3100%)
___Train Local_Simple,  epoch 180, local model 0, internal_epoch   1,  Average loss: 0.0003, Accuracy: 432/435 (99.3103%)
___Train Local_Simple,  epoch 180, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 20, 61]
base_p: [ 2.3139268e-04  5.0637871e-05 -3.1830743e-05 ... -3.5388768e-04
  2.0749122e-03 -1.2609139e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 6, 8]
layer1_inf_time: 2.67626953125
[PAIRWISE] pred_attackers_indx:  [0 1 9]
layer2_inf_t: 29.12890625
assumed final_attacker_idxs:  [0 1 3 6 8 9]
final_attacker_idxs is: [0 1 3 6 8 9]
g_attacker_idxs: [34 20 61 53 60  0]
g_normal_idxs: [21 18 87 58]
filtered_attacker_idxs: [0, 1, 3, 6, 8]
final_attacker_idxs are: [0, 1, 3, 6, 8]
num_dps: [413, 429, 312, 699, 459, 470, 739, 276, 338, 435]
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.0698, Accuracy: 9785/10000 (97.8500%)
time spent on training: 50.95175552368164
Starting performing KrMLRFL...
Num data points: [413, 429, 312, 699, 459, 470, 739, 276, 338, 435]
Num selected data points: [312 459 470 276 435]
The chosen ones are users: [2, 4, 5, 7, 9], which are global users: [21, 18, 87, 58, 0]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 180: Average loss: 0.0350, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 180: Average loss: 14.7893, Accuracy: 13/8968 (0.1450%)
Done in 59.83818197250366 sec.
Server Epoch:181 choose agents : [7, 89, 14, 51, 35, 10, 97, 77, 64, 56].
poison local model 7 index 0
___Train Local_Simple,  epoch 181, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 181, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.3342, Accuracy: 9201/10000 (92.0100%)
___Train Local_Simple,  epoch 181, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 181, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.0736, Accuracy: 9773/10000 (97.7300%)
___Train Local_Simple,  epoch 181, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 372/376 (98.9362%)
___Train Local_Simple,  epoch 181, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.1346, Accuracy: 9631/10000 (96.3100%)
poison local model 51 index 1
___Train Local_Simple,  epoch 181, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 563/568 (99.1197%)
___Train Local_Simple,  epoch 181, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 565/568 (99.4718%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.1320, Accuracy: 9600/10000 (96.0000%)
___Train Local_Simple,  epoch 181, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 181, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.1002, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch 181, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Train Local_Simple,  epoch 181, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.0797, Accuracy: 9754/10000 (97.5400%)
___Train Local_Simple,  epoch 181, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 181, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.1266, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch 181, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 582/589 (98.8115%)
___Train Local_Simple,  epoch 181, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 588/589 (99.8302%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.0471, Accuracy: 9850/10000 (98.5000%)
___Train Local_Simple,  epoch 181, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 811/813 (99.7540%)
___Train Local_Simple,  epoch 181, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.0791, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch 181, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 877/880 (99.6591%)
___Train Local_Simple,  epoch 181, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 51]
base_p: [ 5.0713122e-04  1.8664077e-04  1.3869405e-03 ...  6.1744452e-04
 -1.2838840e-03  1.1600554e-05]
[T_SCORE] attacker_local_idxs is:  [0, 3, 7, 8, 9]
layer1_inf_time: 3.496826171875
[PAIRWISE] pred_attackers_indx:  [0 4 7 8]
layer2_inf_t: 31.115478515625
assumed final_attacker_idxs:  [0 3 4 7 8 9]
final_attacker_idxs is: [0 3 4 7 8 9]
g_attacker_idxs: [ 7 51 35 77 64 56]
g_normal_idxs: [89 14 10 97]
filtered_attacker_idxs: [0, 3, 7]
final_attacker_idxs are: [0, 3, 7]
num_dps: [418, 492, 376, 568, 499, 892, 487, 589, 813, 880]
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.1264, Accuracy: 9611/10000 (96.1100%)
time spent on training: 53.329729318618774
Starting performing KrMLRFL...
Num data points: [418, 492, 376, 568, 499, 892, 487, 589, 813, 880]
Num selected data points: [492 376 499 892 487 813 880]
The chosen ones are users: [1, 2, 4, 5, 6, 8, 9], which are global users: [89, 14, 35, 10, 97, 64, 56]
epoch_acc: 98.88
___Test Local_Simple poisoned: False, epoch: 181: Average loss: 0.0339, Accuracy: 9888/10000 (98.8800%)
___Test Local_Simple poisoned: True, epoch: 181: Average loss: 15.5001, Accuracy: 6/8968 (0.0669%)
Done in 63.46831130981445 sec.
Server Epoch:182 choose agents : [32, 64, 42, 94, 17, 72, 79, 56, 22, 12].
___Train Local_Simple,  epoch 182, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 957/977 (97.9529%)
___Train Local_Simple,  epoch 182, local model 32, internal_epoch   2,  Average loss: 0.0008, Accuracy: 966/977 (98.8741%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.0986, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch 182, local model 64, internal_epoch   1,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Train Local_Simple,  epoch 182, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.0412, Accuracy: 9868/10000 (98.6800%)
poison local model 42 index 0
___Train Local_Simple,  epoch 182, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 182, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.0633, Accuracy: 9789/10000 (97.8900%)
___Train Local_Simple,  epoch 182, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 182, local model 94, internal_epoch   2,  Average loss: 0.0000, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.2543, Accuracy: 9195/10000 (91.9500%)
poison local model 17 index 1
___Train Local_Simple,  epoch 182, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 605/620 (97.5806%)
___Train Local_Simple,  epoch 182, local model 17, internal_epoch   2,  Average loss: 0.0017, Accuracy: 601/620 (96.9355%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.1511, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch 182, local model 72, internal_epoch   1,  Average loss: 0.0002, Accuracy: 728/731 (99.5896%)
___Train Local_Simple,  epoch 182, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.1617, Accuracy: 9450/10000 (94.5000%)
___Train Local_Simple,  epoch 182, local model 79, internal_epoch   1,  Average loss: 0.0003, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 182, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.0444, Accuracy: 9855/10000 (98.5500%)
___Train Local_Simple,  epoch 182, local model 56, internal_epoch   1,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 182, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.0358, Accuracy: 9885/10000 (98.8500%)
poison local model 22 index 2
___Train Local_Simple,  epoch 182, local model 22, internal_epoch   1,  Average loss: 0.0017, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 182, local model 22, internal_epoch   2,  Average loss: 0.0010, Accuracy: 569/583 (97.5986%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.1370, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch 182, local model 12, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1147/1160 (98.8793%)
___Train Local_Simple,  epoch 182, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1150/1160 (99.1379%)
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.1070, Accuracy: 9664/10000 (96.6400%)
time spent on training: 42.89863872528076
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 17, 22]
base_p: [ 0.00055199  0.00020171  0.00258633 ... -0.00091964 -0.00121331
  0.00133445]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 8, 9]
layer1_inf_time: 2.84912109375
[PAIRWISE] pred_attackers_indx:  [0 4 8]
layer2_inf_t: 31.2158203125
assumed final_attacker_idxs:  [0 1 4 8 9]
final_attacker_idxs is: [0 1 4 8 9]
g_attacker_idxs: [32 64 17 22 12]
g_normal_idxs: [42 94 72 79 56]
filtered_attacker_idxs: [0, 4, 8, 9]
final_attacker_idxs are: [0, 4, 8, 9]
num_dps: [977, 813, 236, 150, 620, 731, 182, 880, 583, 1160]
epoch_acc: 98.89
Starting performing KrMLRFL...
Num data points: [977, 813, 236, 150, 620, 731, 182, 880, 583, 1160]
Num selected data points: [813 236 150 731 182 880]
The chosen ones are users: [1, 2, 3, 5, 6, 7], which are global users: [64, 42, 94, 72, 79, 56]
___Test Local_Simple poisoned: False, epoch: 182: Average loss: 0.0331, Accuracy: 9889/10000 (98.8900%)
___Test Local_Simple poisoned: True, epoch: 182: Average loss: 15.0879, Accuracy: 11/8968 (0.1227%)
Done in 48.78380036354065 sec.
Server Epoch:183 choose agents : [53, 11, 1, 52, 77, 18, 29, 13, 31, 80].
___Train Local_Simple,  epoch 183, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 183, local model 53, internal_epoch   2,  Average loss: 0.0006, Accuracy: 729/739 (98.6468%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.2067, Accuracy: 9393/10000 (93.9300%)
poison local model 11 index 0
___Train Local_Simple,  epoch 183, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 637/645 (98.7597%)
___Train Local_Simple,  epoch 183, local model 11, internal_epoch   2,  Average loss: 0.0009, Accuracy: 633/645 (98.1395%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.1691, Accuracy: 9503/10000 (95.0300%)
poison local model 1 index 1
___Train Local_Simple,  epoch 183, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 753/760 (99.0789%)
___Train Local_Simple,  epoch 183, local model 1, internal_epoch   2,  Average loss: 0.0002, Accuracy: 757/760 (99.6053%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.1640, Accuracy: 9453/10000 (94.5300%)
poison local model 52 index 2
___Train Local_Simple,  epoch 183, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch 183, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.1534, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch 183, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch 183, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 584/589 (99.1511%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.0586, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 183, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 457/459 (99.5643%)
___Train Local_Simple,  epoch 183, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.0907, Accuracy: 9717/10000 (97.1700%)
___Train Local_Simple,  epoch 183, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 183, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.0807, Accuracy: 9741/10000 (97.4100%)
poison local model 13 index 3
___Train Local_Simple,  epoch 183, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 714/734 (97.2752%)
___Train Local_Simple,  epoch 183, local model 13, internal_epoch   2,  Average loss: 0.0021, Accuracy: 711/734 (96.8665%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.3715, Accuracy: 8866/10000 (88.6600%)
___Train Local_Simple,  epoch 183, local model 31, internal_epoch   1,  Average loss: 0.0003, Accuracy: 829/835 (99.2814%)
___Train Local_Simple,  epoch 183, local model 31, internal_epoch   2,  Average loss: 0.0002, Accuracy: 832/835 (99.6407%)
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.0808, Accuracy: 9768/10000 (97.6800%)
___Train Local_Simple,  epoch 183, local model 80, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 183, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 1, 52, 13]
base_p: [ 0.0003183   0.00065924 -0.0006646  ...  0.00075617  0.00163259
  0.0032156 ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 7]
layer1_inf_time: 4.28466796875
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.0477, Accuracy: 9861/10000 (98.6100%)
time spent on training: 89.63463068008423
Starting performing KrMLRFL...
Num data points: [739, 645, 760, 253, 589, 459, 1002, 734, 835, 431]
Num selected data points: [ 253  459 1002  835  431]
The chosen ones are users: [3, 5, 6, 8, 9], which are global users: [52, 18, 29, 31, 80]
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 310.5263671875
assumed final_attacker_idxs:  [0 1 2 4 7]
final_attacker_idxs is: [0 1 2 4 7]
g_attacker_idxs: [53 11  1 77 13]
g_normal_idxs: [52 18 29 31 80]
filtered_attacker_idxs: [0, 1, 2, 4, 7]
final_attacker_idxs are: [0, 1, 2, 4, 7]
num_dps: [739, 645, 760, 253, 589, 459, 1002, 734, 835, 431]
epoch_acc: 98.83999999999999
___Test Local_Simple poisoned: False, epoch: 183: Average loss: 0.0344, Accuracy: 9884/10000 (98.8400%)
___Test Local_Simple poisoned: True, epoch: 183: Average loss: 14.7997, Accuracy: 12/8968 (0.1338%)
Done in 97.41016697883606 sec.
Server Epoch:184 choose agents : [29, 0, 45, 85, 79, 70, 20, 59, 55, 54].
___Train Local_Simple,  epoch 184, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch 184, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.1142, Accuracy: 9657/10000 (96.5700%)
___Train Local_Simple,  epoch 184, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 435/435 (100.0000%)
___Train Local_Simple,  epoch 184, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.0710, Accuracy: 9778/10000 (97.7800%)
poison local model 45 index 0
___Train Local_Simple,  epoch 184, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 184, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.1649, Accuracy: 9542/10000 (95.4200%)
poison local model 85 index 1
___Train Local_Simple,  epoch 184, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 184, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.0544, Accuracy: 9821/10000 (98.2100%)
___Train Local_Simple,  epoch 184, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 184, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.0353, Accuracy: 9887/10000 (98.8700%)
poison local model 70 index 2
___Train Local_Simple,  epoch 184, local model 70, internal_epoch   1,  Average loss: 0.0005, Accuracy: 718/724 (99.1713%)
___Train Local_Simple,  epoch 184, local model 70, internal_epoch   2,  Average loss: 0.0005, Accuracy: 716/724 (98.8950%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.2856, Accuracy: 9327/10000 (93.2700%)
poison local model 20 index 3
___Train Local_Simple,  epoch 184, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 184, local model 20, internal_epoch   2,  Average loss: 0.0008, Accuracy: 423/429 (98.6014%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.5287, Accuracy: 8807/10000 (88.0700%)
___Train Local_Simple,  epoch 184, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 184, local model 59, internal_epoch   2,  Average loss: 0.0012, Accuracy: 745/760 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.4398, Accuracy: 8845/10000 (88.4500%)
___Train Local_Simple,  epoch 184, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 184, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.2682, Accuracy: 9223/10000 (92.2300%)
___Train Local_Simple,  epoch 184, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch 184, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 85, 70, 20]
base_p: [ 0.00031437  0.00010939  0.00198813 ...  0.00266837  0.00288582
 -0.00013526]
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.0724, Accuracy: 9775/10000 (97.7500%)
time spent on training: 54.20612812042236
Starting performing KrMLRFL...
Num data points: [1002, 435, 628, 431, 182, 724, 429, 760, 354, 519]
Num selected data points: [1002  435  431  182  354  519]
The chosen ones are users: [0, 1, 3, 4, 8, 9], which are global users: [29, 0, 85, 79, 55, 54]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 7, 8]
layer1_inf_time: 3.995849609375
[PAIRWISE] pred_attackers_indx:  [2 5 6 7 8]
layer2_inf_t: 266.69384765625
assumed final_attacker_idxs:  [2 5 6 7 8]
final_attacker_idxs is: [2 5 6 7 8]
g_attacker_idxs: [45 70 20 59 55]
g_normal_idxs: [29  0 85 79 54]
filtered_attacker_idxs: [2, 5, 6, 7]
final_attacker_idxs are: [2, 5, 6, 7]
num_dps: [1002, 435, 628, 431, 182, 724, 429, 760, 354, 519]
epoch_acc: 98.8
___Test Local_Simple poisoned: False, epoch: 184: Average loss: 0.0369, Accuracy: 9880/10000 (98.8000%)
___Test Local_Simple poisoned: True, epoch: 184: Average loss: 14.1479, Accuracy: 18/8968 (0.2007%)
Done in 59.65778064727783 sec.
Server Epoch:185 choose agents : [9, 2, 37, 72, 17, 46, 6, 41, 30, 98].
___Train Local_Simple,  epoch 185, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 185, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.0623, Accuracy: 9797/10000 (97.9700%)
poison local model 2 index 0
___Train Local_Simple,  epoch 185, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 540/548 (98.5401%)
___Train Local_Simple,  epoch 185, local model 2, internal_epoch   2,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.1584, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch 185, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch 185, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.0585, Accuracy: 9809/10000 (98.0900%)
___Train Local_Simple,  epoch 185, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 185, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.0704, Accuracy: 9795/10000 (97.9500%)
poison local model 17 index 1
___Train Local_Simple,  epoch 185, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 609/620 (98.2258%)
___Train Local_Simple,  epoch 185, local model 17, internal_epoch   2,  Average loss: 0.0009, Accuracy: 608/620 (98.0645%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.1656, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch 185, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch 185, local model 46, internal_epoch   2,  Average loss: 0.0029, Accuracy: 670/710 (94.3662%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.2695, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch 185, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 185, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.0509, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 185, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%)
___Train Local_Simple,  epoch 185, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.0894, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch 185, local model 30, internal_epoch   1,  Average loss: 0.0001, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch 185, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.1140, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch 185, local model 98, internal_epoch   1,  Average loss: 0.0008, Accuracy: 800/818 (97.7995%)
___Train Local_Simple,  epoch 185, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 813/818 (99.3888%)
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.2269, Accuracy: 9280/10000 (92.8000%)
time spent on training: 38.92489552497864
Starting performing KrMLRFL...
Num data points: [436, 548, 860, 731, 620, 710, 615, 606, 400, 818]
Num selected data points: [436 860 731 615 400]
The chosen ones are users: [0, 2, 3, 6, 8], which are global users: [9, 37, 72, 6, 30]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 17]
base_p: [ 0.00032919  0.00014373 -0.00132051 ...  0.0008899  -0.00389329
  0.00509232]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 7, 9]
layer1_inf_time: 4.500732421875
[PAIRWISE] pred_attackers_indx:  [1 4 5 9]
layer2_inf_t: 45.239013671875
assumed final_attacker_idxs:  [1 4 5 7 9]
final_attacker_idxs is: [1 4 5 7 9]
g_attacker_idxs: [ 2 17 46 41 98]
g_normal_idxs: [ 9 37 72  6 30]
filtered_attacker_idxs: [1, 4, 5, 7, 9]
final_attacker_idxs are: [1, 4, 5, 7, 9]
num_dps: [436, 548, 860, 731, 620, 710, 615, 606, 400, 818]
epoch_acc: 98.83999999999999
___Test Local_Simple poisoned: False, epoch: 185: Average loss: 0.0361, Accuracy: 9884/10000 (98.8400%)
___Test Local_Simple poisoned: True, epoch: 185: Average loss: 13.8586, Accuracy: 23/8968 (0.2565%)
Done in 48.29845380783081 sec.
Server Epoch:186 choose agents : [90, 23, 48, 15, 50, 46, 35, 55, 3, 63].
___Train Local_Simple,  epoch 186, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Train Local_Simple,  epoch 186, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.2770, Accuracy: 9170/10000 (91.7000%)
___Train Local_Simple,  epoch 186, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 186, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.0442, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 186, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch 186, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.0564, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 186, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 398/401 (99.2519%)
___Train Local_Simple,  epoch 186, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.0510, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 186, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch 186, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.1391, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch 186, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 700/710 (98.5915%)
___Train Local_Simple,  epoch 186, local model 46, internal_epoch   2,  Average loss: 0.0007, Accuracy: 701/710 (98.7324%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.1870, Accuracy: 9395/10000 (93.9500%)
___Train Local_Simple,  epoch 186, local model 35, internal_epoch   1,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 186, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.0509, Accuracy: 9844/10000 (98.4400%)
___Train Local_Simple,  epoch 186, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 186, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.1760, Accuracy: 9468/10000 (94.6800%)
___Train Local_Simple,  epoch 186, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 914/923 (99.0249%)
___Train Local_Simple,  epoch 186, local model 3, internal_epoch   2,  Average loss: 0.0013, Accuracy: 900/923 (97.5081%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.1151, Accuracy: 9622/10000 (96.2200%)
poison local model 63 index 0
___Train Local_Simple,  epoch 186, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 867/889 (97.5253%)
___Train Local_Simple,  epoch 186, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 880/889 (98.9876%)
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.0986, Accuracy: 9689/10000 (96.8900%)
time spent on training: 40.869011640548706
Starting performing KrMLRFL...
Num data points: [683, 293, 448, 401, 474, 710, 499, 354, 923, 889]
Num selected data points: [683 293 448 401 474 499 354]
The chosen ones are users: [0, 1, 2, 3, 4, 6, 7], which are global users: [90, 23, 48, 15, 50, 35, 55]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63]
base_p: [ 1.3051853e-03  7.7258795e-05 -2.8183032e-04 ...  2.9668957e-03
  2.0855665e-03 -6.9468468e-04]
[T_SCORE] attacker_local_idxs is:  [3, 5, 7, 8, 9]
layer1_inf_time: 3.292724609375
[PAIRWISE] pred_attackers_indx:  [8]
layer2_inf_t: 33.81201171875
assumed final_attacker_idxs:  [3 5 7 8 9]
final_attacker_idxs is: [3 5 7 8 9]
g_attacker_idxs: [15 46 55  3 63]
g_normal_idxs: [90 23 48 50 35]
filtered_attacker_idxs: [5, 8, 9]
final_attacker_idxs are: [5, 8, 9]
num_dps: [683, 293, 448, 401, 474, 710, 499, 354, 923, 889]
epoch_acc: 98.87
___Test Local_Simple poisoned: False, epoch: 186: Average loss: 0.0344, Accuracy: 9887/10000 (98.8700%)
___Test Local_Simple poisoned: True, epoch: 186: Average loss: 14.4541, Accuracy: 11/8968 (0.1227%)
Done in 48.599146604537964 sec.
Server Epoch:187 choose agents : [65, 94, 49, 19, 39, 76, 87, 82, 3, 75].
___Train Local_Simple,  epoch 187, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 366/371 (98.6523%)
___Train Local_Simple,  epoch 187, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0978, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch 187, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 187, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.1803, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch 187, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 187, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0786, Accuracy: 9754/10000 (97.5400%)
___Train Local_Simple,  epoch 187, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch 187, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0872, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch 187, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 187, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0468, Accuracy: 9839/10000 (98.3900%)
___Train Local_Simple,  epoch 187, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 187, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0322, Accuracy: 9893/10000 (98.9300%)
___Train Local_Simple,  epoch 187, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 187, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0507, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 187, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 710/713 (99.5792%)
___Train Local_Simple,  epoch 187, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.6430, Accuracy: 8798/10000 (87.9800%)
___Train Local_Simple,  epoch 187, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 914/923 (99.0249%)
___Train Local_Simple,  epoch 187, local model 3, internal_epoch   2,  Average loss: 0.0008, Accuracy: 904/923 (97.9415%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.3467, Accuracy: 8916/10000 (89.1600%)
___Train Local_Simple,  epoch 187, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch 187, local model 75, internal_epoch   2,  Average loss: 0.0004, Accuracy: 681/686 (99.2711%)
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0935, Accuracy: 9733/10000 (97.3300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [ 3.2052398e-04  1.2500957e-04  1.3526529e-04 ... -1.2612939e-03
 -2.2760630e-03 -5.7250261e-05]
[T_SCORE] attacker_local_idxs is:  [2, 3, 7, 8, 9]
layer1_inf_time: 4.17578125
[PAIRWISE] pred_attackers_indx:  [7 8]
layer2_inf_t: 244.986572265625
assumed final_attacker_idxs:  [2 3 7 8 9]
final_attacker_idxs is: [2 3 7 8 9]
g_attacker_idxs: [49 19 82  3 75]
g_normal_idxs: [65 94 39 76 87]
filtered_attacker_idxs: [2, 7, 8]
final_attacker_idxs are: [2, 7, 8]
num_dps: [371, 150, 506, 205, 257, 78, 470, 713, 923, 686]
time spent on training: 32.76734232902527
Starting performing KrMLRFL...
Num data points: [371, 150, 506, 205, 257, 78, 470, 713, 923, 686]
Num selected data points: [371 150 205 257  78 470 686]
The chosen ones are users: [0, 1, 3, 4, 5, 6, 9], which are global users: [65, 94, 19, 39, 76, 87, 75]
epoch_acc: 98.86
___Test Local_Simple poisoned: False, epoch: 187: Average loss: 0.0357, Accuracy: 9886/10000 (98.8600%)
___Test Local_Simple poisoned: True, epoch: 187: Average loss: 14.1407, Accuracy: 9/8968 (0.1004%)
Done in 38.67055106163025 sec.
Server Epoch:188 choose agents : [24, 74, 31, 55, 86, 39, 2, 89, 61, 26].
___Train Local_Simple,  epoch 188, local model 24, internal_epoch   1,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 188, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.1160, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch 188, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 551/557 (98.9228%)
___Train Local_Simple,  epoch 188, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.1212, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch 188, local model 31, internal_epoch   1,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 188, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.0425, Accuracy: 9864/10000 (98.6400%)
___Train Local_Simple,  epoch 188, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch 188, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.2094, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch 188, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 188, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.0634, Accuracy: 9809/10000 (98.0900%)
___Train Local_Simple,  epoch 188, local model 39, internal_epoch   1,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Train Local_Simple,  epoch 188, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.0381, Accuracy: 9879/10000 (98.7900%)
poison local model 2 index 0
___Train Local_Simple,  epoch 188, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 538/548 (98.1752%)
___Train Local_Simple,  epoch 188, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 546/548 (99.6350%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.1934, Accuracy: 9387/10000 (93.8700%)
___Train Local_Simple,  epoch 188, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Train Local_Simple,  epoch 188, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.0438, Accuracy: 9857/10000 (98.5700%)
poison local model 61 index 1
___Train Local_Simple,  epoch 188, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 690/699 (98.7124%)
___Train Local_Simple,  epoch 188, local model 61, internal_epoch   2,  Average loss: 0.0006, Accuracy: 694/699 (99.2847%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.2531, Accuracy: 9101/10000 (91.0100%)
poison local model 26 index 2
___Train Local_Simple,  epoch 188, local model 26, internal_epoch   1,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Train Local_Simple,  epoch 188, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.0457, Accuracy: 9857/10000 (98.5700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 61, 26]
base_p: [ 0.00029036  0.00013484 -0.00093917 ...  0.00181584  0.00167543
 -0.00098284]
[T_SCORE] attacker_local_idxs is:  [2, 3, 6, 8, 9]
layer1_inf_time: 3.714599609375
time spent on training: 91.20051312446594
Starting performing KrMLRFL...
Num data points: [379, 557, 835, 354, 250, 257, 548, 492, 699, 554]
Num selected data points: [379 557 835 354 250 257 492]
The chosen ones are users: [0, 1, 2, 3, 4, 5, 7], which are global users: [24, 74, 31, 55, 86, 39, 89]
[PAIRWISE] pred_attackers_indx:  [3 6 8]
layer2_inf_t: 365.335205078125
assumed final_attacker_idxs:  [2 3 6 8 9]
final_attacker_idxs is: [2 3 6 8 9]
g_attacker_idxs: [31 55  2 61 26]
g_normal_idxs: [24 74 86 39 89]
filtered_attacker_idxs: [6, 8, 9]
final_attacker_idxs are: [6, 8, 9]
num_dps: [379, 557, 835, 354, 250, 257, 548, 492, 699, 554]
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: False, epoch: 188: Average loss: 0.0353, Accuracy: 9885/10000 (98.8500%)
___Test Local_Simple poisoned: True, epoch: 188: Average loss: 14.1925, Accuracy: 19/8968 (0.2119%)
Done in 98.53104853630066 sec.
Server Epoch:189 choose agents : [70, 42, 21, 9, 52, 1, 63, 82, 3, 56].
poison local model 70 index 0
___Train Local_Simple,  epoch 189, local model 70, internal_epoch   1,  Average loss: 0.0015, Accuracy: 704/724 (97.2376%)
___Train Local_Simple,  epoch 189, local model 70, internal_epoch   2,  Average loss: 0.0004, Accuracy: 719/724 (99.3094%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.2694, Accuracy: 9302/10000 (93.0200%)
poison local model 42 index 1
___Train Local_Simple,  epoch 189, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 189, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.0644, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 189, local model 21, internal_epoch   1,  Average loss: 0.0002, Accuracy: 312/312 (100.0000%)
___Train Local_Simple,  epoch 189, local model 21, internal_epoch   2,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.0481, Accuracy: 9852/10000 (98.5200%)
___Train Local_Simple,  epoch 189, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 189, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.0431, Accuracy: 9865/10000 (98.6500%)
poison local model 52 index 2
___Train Local_Simple,  epoch 189, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 189, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.1277, Accuracy: 9632/10000 (96.3200%)
poison local model 1 index 3
___Train Local_Simple,  epoch 189, local model 1, internal_epoch   1,  Average loss: 0.0010, Accuracy: 743/760 (97.7632%)
___Train Local_Simple,  epoch 189, local model 1, internal_epoch   2,  Average loss: 0.0011, Accuracy: 743/760 (97.7632%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.6595, Accuracy: 8732/10000 (87.3200%)
poison local model 63 index 0
___Train Local_Simple,  epoch 189, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 868/889 (97.6378%)
___Train Local_Simple,  epoch 189, local model 63, internal_epoch   2,  Average loss: 0.0009, Accuracy: 874/889 (98.3127%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.1035, Accuracy: 9676/10000 (96.7600%)
___Train Local_Simple,  epoch 189, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 710/713 (99.5792%)
___Train Local_Simple,  epoch 189, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.4815, Accuracy: 8942/10000 (89.4200%)
___Train Local_Simple,  epoch 189, local model 3, internal_epoch   1,  Average loss: 0.0011, Accuracy: 903/923 (97.8332%)
___Train Local_Simple,  epoch 189, local model 3, internal_epoch   2,  Average loss: 0.0007, Accuracy: 907/923 (98.2665%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.2315, Accuracy: 9245/10000 (92.4500%)
___Train Local_Simple,  epoch 189, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 878/880 (99.7727%)
___Train Local_Simple,  epoch 189, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 877/880 (99.6591%)
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.0626, Accuracy: 9813/10000 (98.1300%)
time spent on training: 57.39753866195679
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 42, 52, 1, 63]
base_p: [ 0.00235987  0.00013128 -0.00178934 ...  0.0039266  -0.00261336
 -0.00032429]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 7, 8]
layer1_inf_time: 3.3525390625
[PAIRWISE] pred_attackers_indx:  [0 4 6 8]
layer2_inf_t: 29.299072265625
assumed final_attacker_idxs:  [0 4 5 6 7 8]
final_attacker_idxs is: [0 4 5 6 7 8]
g_attacker_idxs: [70 52  1 63 82  3]
g_normal_idxs: [42 21  9 56]
filtered_attacker_idxs: [0, 4, 5, 6, 7, 8]
final_attacker_idxs are: [0, 4, 5, 6, 7, 8]
num_dps: [724, 236, 312, 436, 253, 760, 889, 713, 923, 880]
epoch_acc: 98.83999999999999
Starting performing KrMLRFL...
Num data points: [724, 236, 312, 436, 253, 760, 889, 713, 923, 880]
Num selected data points: [236 312 436 880]
The chosen ones are users: [1, 2, 3, 9], which are global users: [42, 21, 9, 56]
___Test Local_Simple poisoned: False, epoch: 189: Average loss: 0.0353, Accuracy: 9884/10000 (98.8400%)
___Test Local_Simple poisoned: True, epoch: 189: Average loss: 15.2314, Accuracy: 11/8968 (0.1227%)
Done in 70.1826696395874 sec.
Server Epoch:190 choose agents : [48, 63, 16, 79, 22, 40, 84, 98, 29, 72].
___Train Local_Simple,  epoch 190, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch 190, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 444/448 (99.1071%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.0944, Accuracy: 9710/10000 (97.1000%)
poison local model 63 index 0
___Train Local_Simple,  epoch 190, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 868/889 (97.6378%)
___Train Local_Simple,  epoch 190, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 879/889 (98.8751%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.0832, Accuracy: 9749/10000 (97.4900%)
poison local model 16 index 1
___Train Local_Simple,  epoch 190, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 902/915 (98.5792%)
___Train Local_Simple,  epoch 190, local model 16, internal_epoch   2,  Average loss: 0.0008, Accuracy: 899/915 (98.2514%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.1190, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch 190, local model 79, internal_epoch   1,  Average loss: 0.0003, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch 190, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.0362, Accuracy: 9888/10000 (98.8800%)
poison local model 22 index 2
___Train Local_Simple,  epoch 190, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 190, local model 22, internal_epoch   2,  Average loss: 0.0007, Accuracy: 575/583 (98.6278%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.0961, Accuracy: 9682/10000 (96.8200%)
___Train Local_Simple,  epoch 190, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 766/772 (99.2228%)
___Train Local_Simple,  epoch 190, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.1086, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch 190, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1224/1246 (98.2343%)
___Train Local_Simple,  epoch 190, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1230/1246 (98.7159%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.1469, Accuracy: 9581/10000 (95.8100%)
___Train Local_Simple,  epoch 190, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 809/818 (98.8998%)
___Train Local_Simple,  epoch 190, local model 98, internal_epoch   2,  Average loss: 0.0007, Accuracy: 807/818 (98.6553%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.2278, Accuracy: 9301/10000 (93.0100%)
___Train Local_Simple,  epoch 190, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch 190, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.0614, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 190, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 190, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 16, 22]
base_p: [ 2.8148741e-03  4.7612935e-05 -2.4864357e-04 ...  1.0587424e-03
 -7.2622076e-03  2.0477772e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 5, 6, 7]
layer1_inf_time: 2.965087890625
[PAIRWISE] pred_attackers_indx:  [1 2 4 5]
layer2_inf_t: 27.962158203125
assumed final_attacker_idxs:  [1 2 4 5 6 7]
final_attacker_idxs is: [1 2 4 5 6 7]
g_attacker_idxs: [63 16 22 40 84 98]
g_normal_idxs: [48 79 29 72]
filtered_attacker_idxs: [1, 2, 4, 5, 6, 7]
final_attacker_idxs are: [1, 2, 4, 5, 6, 7]
num_dps: [448, 889, 915, 182, 583, 772, 1246, 818, 1002, 731]
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.0732, Accuracy: 9786/10000 (97.8600%)
time spent on training: 44.03348708152771
Starting performing KrMLRFL...
Num data points: [448, 889, 915, 182, 583, 772, 1246, 818, 1002, 731]
Num selected data points: [ 448  182 1002  731]
The chosen ones are users: [0, 3, 8, 9], which are global users: [48, 79, 29, 72]
___Test Local_Simple poisoned: False, epoch: 190: Average loss: 0.0412, Accuracy: 9875/10000 (98.7500%)
epoch_acc: 98.75
___Test Local_Simple poisoned: True, epoch: 190: Average loss: 14.5414, Accuracy: 19/8968 (0.2119%)
Done in 51.22470545768738 sec.
Server Epoch:191 choose agents : [80, 53, 88, 54, 84, 75, 72, 83, 15, 66].
___Train Local_Simple,  epoch 191, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 191, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.0625, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 191, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 728/739 (98.5115%)
___Train Local_Simple,  epoch 191, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.3175, Accuracy: 9110/10000 (91.1000%)
___Train Local_Simple,  epoch 191, local model 88, internal_epoch   1,  Average loss: 0.0005, Accuracy: 524/530 (98.8679%)
___Train Local_Simple,  epoch 191, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.1225, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch 191, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 516/519 (99.4220%)
___Train Local_Simple,  epoch 191, local model 54, internal_epoch   2,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.1853, Accuracy: 9452/10000 (94.5200%)
___Train Local_Simple,  epoch 191, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1225/1246 (98.3146%)
___Train Local_Simple,  epoch 191, local model 84, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1227/1246 (98.4751%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.0808, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch 191, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch 191, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.0615, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch 191, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 191, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.0396, Accuracy: 9882/10000 (98.8200%)
___Train Local_Simple,  epoch 191, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch 191, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.0605, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 191, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 396/401 (98.7531%)
___Train Local_Simple,  epoch 191, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.1413, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch 191, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch 191, local model 66, internal_epoch   2,  Average loss: 0.0004, Accuracy: 655/660 (99.2424%)
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.0916, Accuracy: 9688/10000 (96.8800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [ 3.4906715e-04  1.3018399e-04 -1.3136305e-05 ...  4.3912530e-03
  1.8702149e-03  1.3626814e-03]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 8, 9]
layer1_inf_time: 4.263916015625
[PAIRWISE] pred_attackers_indx:  [4 9]
layer2_inf_t: 447.137939453125
assumed final_attacker_idxs:  [1 4 5 8 9]
final_attacker_idxs is: [1 4 5 8 9]
g_attacker_idxs: [53 84 75 15 66]
g_normal_idxs: [80 88 54 72 83]
filtered_attacker_idxs: [1, 4, 9]
final_attacker_idxs are: [1, 4, 9]
num_dps: [431, 739, 530, 519, 1246, 686, 731, 433, 401, 660]
time spent on training: 32.393391132354736
Starting performing KrMLRFL...
Num data points: [431, 739, 530, 519, 1246, 686, 731, 433, 401, 660]
Num selected data points: [431 530 519 686 731 433 401]
The chosen ones are users: [0, 2, 3, 5, 6, 7, 8], which are global users: [80, 88, 54, 75, 72, 83, 15]
epoch_acc: 98.98
___Test Local_Simple poisoned: False, epoch: 191: Average loss: 0.0320, Accuracy: 9898/10000 (98.9800%)
___Test Local_Simple poisoned: True, epoch: 191: Average loss: 14.3061, Accuracy: 12/8968 (0.1338%)
Done in 39.17078161239624 sec.
Server Epoch:192 choose agents : [7, 67, 55, 44, 29, 15, 37, 46, 39, 0].
poison local model 7 index 0
___Train Local_Simple,  epoch 192, local model 7, internal_epoch   1,  Average loss: 0.0002, Accuracy: 416/418 (99.5215%)
___Train Local_Simple,  epoch 192, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.1480, Accuracy: 9597/10000 (95.9700%)
___Train Local_Simple,  epoch 192, local model 67, internal_epoch   1,  Average loss: 0.0005, Accuracy: 988/998 (98.9980%)
___Train Local_Simple,  epoch 192, local model 67, internal_epoch   2,  Average loss: 0.0005, Accuracy: 987/998 (98.8978%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.1555, Accuracy: 9528/10000 (95.2800%)
___Train Local_Simple,  epoch 192, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 192, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.1092, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch 192, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 512/517 (99.0329%)
___Train Local_Simple,  epoch 192, local model 44, internal_epoch   2,  Average loss: 0.0003, Accuracy: 515/517 (99.6132%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.0705, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch 192, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 192, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.0608, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 192, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Train Local_Simple,  epoch 192, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.0360, Accuracy: 9882/10000 (98.8200%)
___Train Local_Simple,  epoch 192, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch 192, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.0663, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch 192, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 700/710 (98.5915%)
___Train Local_Simple,  epoch 192, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 700/710 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.1518, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch 192, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 192, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.0363, Accuracy: 9880/10000 (98.8000%)
___Train Local_Simple,  epoch 192, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Train Local_Simple,  epoch 192, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7]
base_p: [ 3.29844654e-04  8.57617706e-05  1.18051656e-04 ... -1.75513327e-03
 -2.12953240e-03 -6.58892095e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 7]
layer1_inf_time: 3.202880859375
[PAIRWISE] pred_attackers_indx:  [1 2 7]
layer2_inf_t: 31.96240234375
assumed final_attacker_idxs:  [0 1 2 3 7]
final_attacker_idxs is: [0 1 2 3 7]
g_attacker_idxs: [ 7 67 55 44 46]
g_normal_idxs: [29 15 37 39  0]
filtered_attacker_idxs: [0, 1, 7]
final_attacker_idxs are: [0, 1, 7]
num_dps: [418, 998, 354, 517, 1002, 401, 860, 710, 257, 435]
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.0594, Accuracy: 9808/10000 (98.0800%)
time spent on training: 35.417189836502075
Starting performing KrMLRFL...
Num data points: [418, 998, 354, 517, 1002, 401, 860, 710, 257, 435]
Num selected data points: [ 354  517 1002  401  860  257  435]
The chosen ones are users: [2, 3, 4, 5, 6, 8, 9], which are global users: [55, 44, 29, 15, 37, 39, 0]
epoch_acc: 99.07000000000001
___Test Local_Simple poisoned: False, epoch: 192: Average loss: 0.0311, Accuracy: 9907/10000 (99.0700%)
___Test Local_Simple poisoned: True, epoch: 192: Average loss: 14.0381, Accuracy: 16/8968 (0.1784%)
Done in 45.95319867134094 sec.
Server Epoch:193 choose agents : [67, 24, 7, 85, 49, 55, 74, 48, 78, 15].
___Train Local_Simple,  epoch 193, local model 67, internal_epoch   1,  Average loss: 0.0005, Accuracy: 988/998 (98.9980%)
___Train Local_Simple,  epoch 193, local model 67, internal_epoch   2,  Average loss: 0.0003, Accuracy: 992/998 (99.3988%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.1406, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch 193, local model 24, internal_epoch   1,  Average loss: 0.0003, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 193, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0676, Accuracy: 9777/10000 (97.7700%)
poison local model 7 index 0
___Train Local_Simple,  epoch 193, local model 7, internal_epoch   1,  Average loss: 0.0003, Accuracy: 417/418 (99.7608%)
___Train Local_Simple,  epoch 193, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.1237, Accuracy: 9640/10000 (96.4000%)
poison local model 85 index 1
___Train Local_Simple,  epoch 193, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 193, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0417, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 193, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 193, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0737, Accuracy: 9771/10000 (97.7100%)
___Train Local_Simple,  epoch 193, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 193, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.1037, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch 193, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%)
___Train Local_Simple,  epoch 193, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0497, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 193, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch 193, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0564, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 193, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch 193, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0601, Accuracy: 9814/10000 (98.1400%)
___Train Local_Simple,  epoch 193, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Train Local_Simple,  epoch 193, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 85]
base_p: [0.00017279 0.00012614 0.00023694 ... 0.00095223 0.00040843 0.00017793]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 9]
layer1_inf_time: 5.307373046875
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0532, Accuracy: 9819/10000 (98.1900%)
time spent on training: 41.524287700653076
Starting performing KrMLRFL...
Num data points: [998, 379, 418, 431, 506, 354, 557, 448, 303, 401]
Num selected data points: [379 506 354 557 448 303 401]
The chosen ones are users: [1, 4, 5, 6, 7, 8, 9], which are global users: [24, 49, 55, 74, 48, 78, 15]
[PAIRWISE] pred_attackers_indx:  [0 5]
layer2_inf_t: 376.12744140625
assumed final_attacker_idxs:  [0 2 3 5 9]
final_attacker_idxs is: [0 2 3 5 9]
g_attacker_idxs: [67  7 85 55 15]
g_normal_idxs: [24 49 74 48 78]
filtered_attacker_idxs: [0, 2, 3]
final_attacker_idxs are: [0, 2, 3]
num_dps: [998, 379, 418, 431, 506, 354, 557, 448, 303, 401]
epoch_acc: 99.06
___Test Local_Simple poisoned: False, epoch: 193: Average loss: 0.0300, Accuracy: 9906/10000 (99.0600%)
___Test Local_Simple poisoned: True, epoch: 193: Average loss: 14.7922, Accuracy: 9/8968 (0.1004%)
Done in 47.19517493247986 sec.
Server Epoch:194 choose agents : [25, 87, 78, 76, 40, 43, 88, 6, 59, 73].
___Train Local_Simple,  epoch 194, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 646/647 (99.8454%)
___Train Local_Simple,  epoch 194, local model 25, internal_epoch   2,  Average loss: 0.0017, Accuracy: 627/647 (96.9088%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.4923, Accuracy: 8788/10000 (87.8800%)
___Train Local_Simple,  epoch 194, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 194, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0552, Accuracy: 9821/10000 (98.2100%)
___Train Local_Simple,  epoch 194, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 194, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0811, Accuracy: 9750/10000 (97.5000%)
___Train Local_Simple,  epoch 194, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 194, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0302, Accuracy: 9909/10000 (99.0900%)
___Train Local_Simple,  epoch 194, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 771/772 (99.8705%)
___Train Local_Simple,  epoch 194, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0833, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch 194, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 194, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0396, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 194, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 527/530 (99.4340%)
___Train Local_Simple,  epoch 194, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 526/530 (99.2453%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.1006, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch 194, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 194, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0472, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 194, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch 194, local model 59, internal_epoch   2,  Average loss: 0.0013, Accuracy: 745/760 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.2648, Accuracy: 9198/10000 (91.9800%)
poison local model 73 index 0
___Train Local_Simple,  epoch 194, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%)
___Train Local_Simple,  epoch 194, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%)
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0788, Accuracy: 9752/10000 (97.5200%)
time spent on training: 37.88962459564209
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73]
base_p: [ 0.00023603  0.00013731 -0.00015856 ...  0.0027571  -0.00173487
  0.00073398]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 8, 9]
layer1_inf_time: 3.9228515625
[PAIRWISE] pred_attackers_indx:  [8 9]
layer2_inf_t: 35.09765625
assumed final_attacker_idxs:  [0 4 6 8 9]
final_attacker_idxs is: [0 4 6 8 9]
g_attacker_idxs: [25 40 88 59 73]
g_normal_idxs: [87 78 76 43  6]
filtered_attacker_idxs: [0, 4, 8, 9]
final_attacker_idxs are: [0, 4, 8, 9]
num_dps: [647, 470, 303, 78, 772, 408, 530, 615, 760, 591]
Starting performing KrMLRFL...
Num data points: [647, 470, 303, 78, 772, 408, 530, 615, 760, 591]
Num selected data points: [470 303  78 408 530 615]
The chosen ones are users: [1, 2, 3, 5, 6, 7], which are global users: [87, 78, 76, 43, 88, 6]
___Test Local_Simple poisoned: False, epoch: 194: Average loss: 0.0333, Accuracy: 9887/10000 (98.8700%)
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 194: Average loss: 13.7568, Accuracy: 19/8968 (0.2119%)
Done in 43.83232378959656 sec.
Server Epoch:195 choose agents : [9, 41, 46, 42, 34, 40, 51, 83, 20, 73].
___Train Local_Simple,  epoch 195, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 195, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.0500, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 195, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 600/606 (99.0099%)
___Train Local_Simple,  epoch 195, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.0691, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch 195, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 703/710 (99.0141%)
___Train Local_Simple,  epoch 195, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 700/710 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.1658, Accuracy: 9463/10000 (94.6300%)
poison local model 42 index 0
___Train Local_Simple,  epoch 195, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 195, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.0492, Accuracy: 9840/10000 (98.4000%)
poison local model 34 index 1
___Train Local_Simple,  epoch 195, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%)
___Train Local_Simple,  epoch 195, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.0680, Accuracy: 9786/10000 (97.8600%)
___Train Local_Simple,  epoch 195, local model 40, internal_epoch   1,  Average loss: 0.0002, Accuracy: 768/772 (99.4819%)
___Train Local_Simple,  epoch 195, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.1087, Accuracy: 9707/10000 (97.0700%)
poison local model 51 index 2
___Train Local_Simple,  epoch 195, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 567/568 (99.8239%)
___Train Local_Simple,  epoch 195, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.2814, Accuracy: 9241/10000 (92.4100%)
___Train Local_Simple,  epoch 195, local model 83, internal_epoch   1,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Train Local_Simple,  epoch 195, local model 83, internal_epoch   2,  Average loss: 0.0000, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.0354, Accuracy: 9879/10000 (98.7900%)
poison local model 20 index 3
___Train Local_Simple,  epoch 195, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 425/429 (99.0676%)
___Train Local_Simple,  epoch 195, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.2832, Accuracy: 9211/10000 (92.1100%)
poison local model 73 index 0
___Train Local_Simple,  epoch 195, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 589/591 (99.6616%)
___Train Local_Simple,  epoch 195, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%)
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.0942, Accuracy: 9694/10000 (96.9400%)
time spent on training: 53.40891671180725
Starting performing KrMLRFL...
Num data points: [436, 606, 710, 236, 413, 772, 568, 433, 429, 591]
Num selected data points: [436 236 413 433]
The chosen ones are users: [0, 3, 4, 7], which are global users: [9, 42, 34, 83]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 34, 51, 20, 73]
base_p: [ 2.6836991e-04  1.5987083e-05 -3.8236380e-04 ... -6.8004429e-04
 -4.3400228e-03  6.2425435e-04]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 8, 9]
layer1_inf_time: 3.109619140625
[PAIRWISE] pred_attackers_indx:  [1 5 8]
layer2_inf_t: 29.483154296875
assumed final_attacker_idxs:  [1 2 5 6 8 9]
final_attacker_idxs is: [1 2 5 6 8 9]
g_attacker_idxs: [41 46 40 51 20 73]
g_normal_idxs: [ 9 42 34 83]
filtered_attacker_idxs: [1, 2, 5, 6, 8, 9]
final_attacker_idxs are: [1, 2, 5, 6, 8, 9]
num_dps: [436, 606, 710, 236, 413, 772, 568, 433, 429, 591]
epoch_acc: 98.78
___Test Local_Simple poisoned: False, epoch: 195: Average loss: 0.0369, Accuracy: 9878/10000 (98.7800%)
___Test Local_Simple poisoned: True, epoch: 195: Average loss: 14.4952, Accuracy: 16/8968 (0.1784%)
Done in 60.827069997787476 sec.
Server Epoch:196 choose agents : [94, 25, 3, 84, 66, 74, 92, 83, 31, 35].
___Train Local_Simple,  epoch 196, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 196, local model 94, internal_epoch   2,  Average loss: 0.0000, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.1350, Accuracy: 9515/10000 (95.1500%)
___Train Local_Simple,  epoch 196, local model 25, internal_epoch   1,  Average loss: 0.0012, Accuracy: 644/647 (99.5363%)
___Train Local_Simple,  epoch 196, local model 25, internal_epoch   2,  Average loss: 0.0047, Accuracy: 608/647 (93.9722%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.4646, Accuracy: 8352/10000 (83.5200%)
___Train Local_Simple,  epoch 196, local model 3, internal_epoch   1,  Average loss: 0.0011, Accuracy: 909/923 (98.4832%)
___Train Local_Simple,  epoch 196, local model 3, internal_epoch   2,  Average loss: 0.0012, Accuracy: 904/923 (97.9415%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.2389, Accuracy: 9355/10000 (93.5500%)
___Train Local_Simple,  epoch 196, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1228/1246 (98.5554%)
___Train Local_Simple,  epoch 196, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1229/1246 (98.6356%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.1019, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch 196, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 646/660 (97.8788%)
___Train Local_Simple,  epoch 196, local model 66, internal_epoch   2,  Average loss: 0.0013, Accuracy: 646/660 (97.8788%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.1782, Accuracy: 9430/10000 (94.3000%)
___Train Local_Simple,  epoch 196, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%)
___Train Local_Simple,  epoch 196, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.0463, Accuracy: 9850/10000 (98.5000%)
___Train Local_Simple,  epoch 196, local model 92, internal_epoch   1,  Average loss: 0.0009, Accuracy: 920/937 (98.1857%)
___Train Local_Simple,  epoch 196, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.2554, Accuracy: 9132/10000 (91.3200%)
___Train Local_Simple,  epoch 196, local model 83, internal_epoch   1,  Average loss: 0.0000, Accuracy: 433/433 (100.0000%)
___Train Local_Simple,  epoch 196, local model 83, internal_epoch   2,  Average loss: 0.0000, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.0351, Accuracy: 9889/10000 (98.8900%)
___Train Local_Simple,  epoch 196, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Train Local_Simple,  epoch 196, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.0417, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 196, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 495/499 (99.1984%)
___Train Local_Simple,  epoch 196, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [ 2.1615624e-04  2.9429793e-05  3.1010248e-05 ...  7.7548027e-03
 -2.8614998e-03  1.0309070e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 6]
layer1_inf_time: 3.86279296875
[PAIRWISE] pred_attackers_indx:  [1 2 3 4]
layer2_inf_t: 262.674072265625
assumed final_attacker_idxs:  [1 2 3 4 6]
final_attacker_idxs is: [1 2 3 4 6]
g_attacker_idxs: [25  3 84 66 92]
g_normal_idxs: [94 74 83 31 35]
filtered_attacker_idxs: [1, 2, 3, 4, 6]
final_attacker_idxs are: [1, 2, 3, 4, 6]
num_dps: [150, 647, 923, 1246, 660, 557, 937, 433, 835, 499]
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.0416, Accuracy: 9855/10000 (98.5500%)
time spent on training: 35.653132915496826
Starting performing KrMLRFL...
Num data points: [150, 647, 923, 1246, 660, 557, 937, 433, 835, 499]
Num selected data points: [150 557 433 835 499]
The chosen ones are users: [0, 5, 7, 8, 9], which are global users: [94, 74, 83, 31, 35]
epoch_acc: 98.86
___Test Local_Simple poisoned: False, epoch: 196: Average loss: 0.0332, Accuracy: 9886/10000 (98.8600%)
___Test Local_Simple poisoned: True, epoch: 196: Average loss: 14.4230, Accuracy: 19/8968 (0.2119%)
Done in 42.27751803398132 sec.
Server Epoch:197 choose agents : [32, 33, 68, 20, 36, 28, 77, 31, 66, 85].
___Train Local_Simple,  epoch 197, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 959/977 (98.1576%)
___Train Local_Simple,  epoch 197, local model 32, internal_epoch   2,  Average loss: 0.0008, Accuracy: 960/977 (98.2600%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.2740, Accuracy: 9247/10000 (92.4700%)
___Train Local_Simple,  epoch 197, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 197, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.0586, Accuracy: 9819/10000 (98.1900%)
___Train Local_Simple,  epoch 197, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Train Local_Simple,  epoch 197, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.0744, Accuracy: 9774/10000 (97.7400%)
poison local model 20 index 0
___Train Local_Simple,  epoch 197, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 197, local model 20, internal_epoch   2,  Average loss: 0.0005, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.2654, Accuracy: 9320/10000 (93.2000%)
___Train Local_Simple,  epoch 197, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 989/1005 (98.4080%)
___Train Local_Simple,  epoch 197, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 995/1005 (99.0050%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.2290, Accuracy: 9286/10000 (92.8600%)
___Train Local_Simple,  epoch 197, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 197, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.0542, Accuracy: 9833/10000 (98.3300%)
___Train Local_Simple,  epoch 197, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 585/589 (99.3209%)
___Train Local_Simple,  epoch 197, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 582/589 (98.8115%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.0669, Accuracy: 9791/10000 (97.9100%)
___Train Local_Simple,  epoch 197, local model 31, internal_epoch   1,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 197, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.0389, Accuracy: 9872/10000 (98.7200%)
___Train Local_Simple,  epoch 197, local model 66, internal_epoch   1,  Average loss: 0.0010, Accuracy: 650/660 (98.4848%)
___Train Local_Simple,  epoch 197, local model 66, internal_epoch   2,  Average loss: 0.0011, Accuracy: 650/660 (98.4848%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.1953, Accuracy: 9387/10000 (93.8700%)
poison local model 85 index 1
___Train Local_Simple,  epoch 197, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 428/431 (99.3039%)
___Train Local_Simple,  epoch 197, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.1099, Accuracy: 9705/10000 (97.0500%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 85]
base_p: [ 0.00138222  0.00016544 -0.00132136 ... -0.00268605 -0.00545608
 -0.00231785]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 8]
layer1_inf_time: 4.02392578125
[PAIRWISE] pred_attackers_indx:  [0 3 4 8]
layer2_inf_t: 77.83251953125
assumed final_attacker_idxs:  [0 3 4 6 8]
final_attacker_idxs is: [0 3 4 6 8]
g_attacker_idxs: [32 20 36 77 66]
g_normal_idxs: [33 68 28 31 85]
filtered_attacker_idxs: [0, 3, 4, 6, 8]
final_attacker_idxs are: [0, 3, 4, 6, 8]
num_dps: [977, 623, 494, 429, 1005, 501, 589, 835, 660, 431]
time spent on training: 47.4808874130249
Starting performing KrMLRFL...
Num data points: [977, 623, 494, 429, 1005, 501, 589, 835, 660, 431]
Num selected data points: [623 494 501 835 431]
The chosen ones are users: [1, 2, 5, 7, 9], which are global users: [33, 68, 28, 31, 85]
___Test Local_Simple poisoned: False, epoch: 197: Average loss: 0.0361, Accuracy: 9881/10000 (98.8100%)
epoch_acc: 98.81
___Test Local_Simple poisoned: True, epoch: 197: Average loss: 15.1700, Accuracy: 11/8968 (0.1227%)
Done in 99.94394040107727 sec.
Server Epoch:198 choose agents : [56, 5, 60, 17, 46, 89, 93, 14, 69, 53].
___Train Local_Simple,  epoch 198, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 879/880 (99.8864%)
___Train Local_Simple,  epoch 198, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 878/880 (99.7727%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.0543, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 198, local model 5, internal_epoch   1,  Average loss: 0.0008, Accuracy: 430/434 (99.0783%)
___Train Local_Simple,  epoch 198, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 432/434 (99.5392%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.4249, Accuracy: 8890/10000 (88.9000%)
___Train Local_Simple,  epoch 198, local model 60, internal_epoch   1,  Average loss: 0.0004, Accuracy: 336/338 (99.4083%)
___Train Local_Simple,  epoch 198, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 337/338 (99.7041%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.0635, Accuracy: 9801/10000 (98.0100%)
poison local model 17 index 0
___Train Local_Simple,  epoch 198, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 607/620 (97.9032%)
___Train Local_Simple,  epoch 198, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 608/620 (98.0645%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.2309, Accuracy: 9274/10000 (92.7400%)
___Train Local_Simple,  epoch 198, local model 46, internal_epoch   1,  Average loss: 0.0005, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch 198, local model 46, internal_epoch   2,  Average loss: 0.0015, Accuracy: 702/710 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.6030, Accuracy: 8454/10000 (84.5400%)
___Train Local_Simple,  epoch 198, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 198, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.0613, Accuracy: 9798/10000 (97.9800%)
poison local model 93 index 1
___Train Local_Simple,  epoch 198, local model 93, internal_epoch   1,  Average loss: 0.0002, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 198, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.3566, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch 198, local model 14, internal_epoch   1,  Average loss: 0.0002, Accuracy: 376/376 (100.0000%)
___Train Local_Simple,  epoch 198, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.0691, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 198, local model 69, internal_epoch   1,  Average loss: 0.0006, Accuracy: 252/256 (98.4375%)
___Train Local_Simple,  epoch 198, local model 69, internal_epoch   2,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.1336, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch 198, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 727/739 (98.3762%)
___Train Local_Simple,  epoch 198, local model 53, internal_epoch   2,  Average loss: 0.0010, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.3242, Accuracy: 9042/10000 (90.4200%)
time spent on training: 48.50121283531189
Starting performing KrMLRFL...
Num data points: [880, 434, 338, 620, 710, 492, 623, 376, 256, 739]
Num selected data points: [880 434 492 376 256]
The chosen ones are users: [0, 1, 5, 7, 8], which are global users: [56, 5, 89, 14, 69]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 93]
base_p: [-1.0922551e-05  1.5126728e-04  3.4939218e-04 ...  9.4130635e-05
 -7.3374808e-04 -1.7385781e-03]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 6, 9]
layer1_inf_time: 4.0634765625
[PAIRWISE] pred_attackers_indx:  [3 6]
layer2_inf_t: 48.6865234375
assumed final_attacker_idxs:  [2 3 4 6 9]
final_attacker_idxs is: [2 3 4 6 9]
g_attacker_idxs: [60 17 46 93 53]
g_normal_idxs: [56  5 89 14 69]
filtered_attacker_idxs: [2, 3, 4, 6, 9]
final_attacker_idxs are: [2, 3, 4, 6, 9]
num_dps: [880, 434, 338, 620, 710, 492, 623, 376, 256, 739]
epoch_acc: 98.99
___Test Local_Simple poisoned: False, epoch: 198: Average loss: 0.0330, Accuracy: 9899/10000 (98.9900%)
___Test Local_Simple poisoned: True, epoch: 198: Average loss: 14.8479, Accuracy: 13/8968 (0.1450%)
Done in 56.20830011367798 sec.
Server Epoch:199 choose agents : [63, 77, 70, 60, 31, 28, 45, 36, 33, 68].
poison local model 63 index 0
___Train Local_Simple,  epoch 199, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 858/889 (96.5129%)
___Train Local_Simple,  epoch 199, local model 63, internal_epoch   2,  Average loss: 0.0014, Accuracy: 868/889 (97.6378%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.1019, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch 199, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 581/589 (98.6418%)
___Train Local_Simple,  epoch 199, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 586/589 (99.4907%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.0536, Accuracy: 9833/10000 (98.3300%)
poison local model 70 index 1
___Train Local_Simple,  epoch 199, local model 70, internal_epoch   1,  Average loss: 0.0006, Accuracy: 717/724 (99.0331%)
___Train Local_Simple,  epoch 199, local model 70, internal_epoch   2,  Average loss: 0.0011, Accuracy: 708/724 (97.7901%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.3507, Accuracy: 9195/10000 (91.9500%)
___Train Local_Simple,  epoch 199, local model 60, internal_epoch   1,  Average loss: 0.0005, Accuracy: 333/338 (98.5207%)
___Train Local_Simple,  epoch 199, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.1509, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch 199, local model 31, internal_epoch   1,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 199, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.0455, Accuracy: 9863/10000 (98.6300%)
___Train Local_Simple,  epoch 199, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 199, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.0403, Accuracy: 9867/10000 (98.6700%)
poison local model 45 index 2
___Train Local_Simple,  epoch 199, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 199, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.1303, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch 199, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 990/1005 (98.5075%)
___Train Local_Simple,  epoch 199, local model 36, internal_epoch   2,  Average loss: 0.0006, Accuracy: 992/1005 (98.7065%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.2454, Accuracy: 9243/10000 (92.4300%)
___Train Local_Simple,  epoch 199, local model 33, internal_epoch   1,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%)
___Train Local_Simple,  epoch 199, local model 33, internal_epoch   2,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.0377, Accuracy: 9879/10000 (98.7900%)
___Train Local_Simple,  epoch 199, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 199, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.0445, Accuracy: 9869/10000 (98.6900%)
time spent on training: 50.38854742050171
Starting performing KrMLRFL...
Num data points: [889, 589, 724, 338, 835, 501, 628, 1005, 623, 494]
Num selected data points: [338 835 501 623 494]
The chosen ones are users: [3, 4, 5, 8, 9], which are global users: [60, 31, 28, 33, 68]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 70, 45]
base_p: [ 1.7461404e-03  7.0670620e-05 -1.9104127e-04 ...  9.0731680e-04
 -3.9894506e-03  5.7590008e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 7]
layer1_inf_time: 4.577392578125
[PAIRWISE] pred_attackers_indx:  [0 2 6 7]
layer2_inf_t: 246.393310546875
assumed final_attacker_idxs:  [0 1 2 6 7]
final_attacker_idxs is: [0 1 2 6 7]
g_attacker_idxs: [63 77 70 45 36]
g_normal_idxs: [60 31 28 33 68]
filtered_attacker_idxs: [0, 1, 2, 6, 7]
final_attacker_idxs are: [0, 1, 2, 6, 7]
num_dps: [889, 589, 724, 338, 835, 501, 628, 1005, 623, 494]
___Test Local_Simple poisoned: False, epoch: 199: Average loss: 0.0351, Accuracy: 9892/10000 (98.9200%)
epoch_acc: 98.92
___Test Local_Simple poisoned: True, epoch: 199: Average loss: 15.1325, Accuracy: 13/8968 (0.1450%)
Done in 55.69942593574524 sec.
Server Epoch:200 choose agents : [65, 31, 13, 55, 58, 48, 75, 40, 91, 39].
___Train Local_Simple,  epoch 200, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Train Local_Simple,  epoch 200, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0451, Accuracy: 9861/10000 (98.6100%)
___Train Local_Simple,  epoch 200, local model 31, internal_epoch   1,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 200, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0382, Accuracy: 9887/10000 (98.8700%)
poison local model 13 index 0
___Train Local_Simple,  epoch 200, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 721/734 (98.2289%)
___Train Local_Simple,  epoch 200, local model 13, internal_epoch   2,  Average loss: 0.0013, Accuracy: 724/734 (98.6376%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.1725, Accuracy: 9487/10000 (94.8700%)
___Train Local_Simple,  epoch 200, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch 200, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.3417, Accuracy: 8982/10000 (89.8200%)
___Train Local_Simple,  epoch 200, local model 58, internal_epoch   1,  Average loss: 0.0007, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch 200, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 275/276 (99.6377%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.1362, Accuracy: 9546/10000 (95.4600%)
___Train Local_Simple,  epoch 200, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch 200, local model 48, internal_epoch   2,  Average loss: 0.0003, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0888, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch 200, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch 200, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0937, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch 200, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 765/772 (99.0933%)
___Train Local_Simple,  epoch 200, local model 40, internal_epoch   2,  Average loss: 0.0004, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0658, Accuracy: 9795/10000 (97.9500%)
poison local model 91 index 1
___Train Local_Simple,  epoch 200, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 200, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0562, Accuracy: 9829/10000 (98.2900%)
___Train Local_Simple,  epoch 200, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 200, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 91]
base_p: [3.0225515e-04 1.1176430e-04 6.3340180e-05 ... 3.5493076e-04 2.7943701e-03
 8.5353106e-04]
[T_SCORE] attacker_local_idxs is:  [2, 3, 6, 7, 8]
layer1_inf_time: 5.548828125
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0346, Accuracy: 9896/10000 (98.9600%)
time spent on training: 45.87623620033264
Starting performing KrMLRFL...
Num data points: [371, 835, 734, 354, 276, 448, 686, 772, 256, 257]
Num selected data points: [371 835 354 276 448 686 257]
The chosen ones are users: [0, 1, 3, 4, 5, 6, 9], which are global users: [65, 31, 55, 58, 48, 75, 39]
[PAIRWISE] pred_attackers_indx:  [2 3]
layer2_inf_t: 414.805419921875
assumed final_attacker_idxs:  [2 3 6 7 8]
final_attacker_idxs is: [2 3 6 7 8]
g_attacker_idxs: [13 55 75 40 91]
g_normal_idxs: [65 31 58 48 39]
filtered_attacker_idxs: [2, 7, 8]
final_attacker_idxs are: [2, 7, 8]
num_dps: [371, 835, 734, 354, 276, 448, 686, 772, 256, 257]
epoch_acc: 98.92
___Test Local_Simple poisoned: False, epoch: 200: Average loss: 0.0333, Accuracy: 9892/10000 (98.9200%)
___Test Local_Simple poisoned: True, epoch: 200: Average loss: 15.2652, Accuracy: 10/8968 (0.1115%)
Done in 51.77540898323059 sec.
Server Epoch:201 choose agents : [2, 75, 64, 43, 30, 11, 76, 13, 8, 71].
poison local model 2 index 0
___Train Local_Simple,  epoch 201, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 201, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 545/548 (99.4526%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.4689, Accuracy: 8737/10000 (87.3700%)
___Train Local_Simple,  epoch 201, local model 75, internal_epoch   1,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Train Local_Simple,  epoch 201, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.0613, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 201, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 806/813 (99.1390%)
___Train Local_Simple,  epoch 201, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 811/813 (99.7540%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.1267, Accuracy: 9583/10000 (95.8300%)
___Train Local_Simple,  epoch 201, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 201, local model 43, internal_epoch   2,  Average loss: 0.0000, Accuracy: 408/408 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.0524, Accuracy: 9844/10000 (98.4400%)
___Train Local_Simple,  epoch 201, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch 201, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.2910, Accuracy: 9139/10000 (91.3900%)
poison local model 11 index 1
___Train Local_Simple,  epoch 201, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 636/645 (98.6047%)
___Train Local_Simple,  epoch 201, local model 11, internal_epoch   2,  Average loss: 0.0009, Accuracy: 635/645 (98.4496%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.1837, Accuracy: 9430/10000 (94.3000%)
___Train Local_Simple,  epoch 201, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 201, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.0323, Accuracy: 9896/10000 (98.9600%)
poison local model 13 index 2
___Train Local_Simple,  epoch 201, local model 13, internal_epoch   1,  Average loss: 0.0002, Accuracy: 732/734 (99.7275%)
___Train Local_Simple,  epoch 201, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 729/734 (99.3188%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.0854, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch 201, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 626/633 (98.8942%)
___Train Local_Simple,  epoch 201, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.0731, Accuracy: 9783/10000 (97.8300%)
poison local model 71 index 3
___Train Local_Simple,  epoch 201, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1365/1384 (98.6272%)
___Train Local_Simple,  epoch 201, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1370/1384 (98.9884%)
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.3080, Accuracy: 8992/10000 (89.9200%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 11, 13, 71]
base_p: [ 0.0003337   0.00015859 -0.0019227  ... -0.00155102 -0.00749781
 -0.00267947]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 7, 9]
layer1_inf_time: 3.9365234375
[PAIRWISE] pred_attackers_indx:  [0 5 7 9]
layer2_inf_t: 104.197998046875
assumed final_attacker_idxs:  [0 2 5 7 9]
final_attacker_idxs is: [0 2 5 7 9]
g_attacker_idxs: [ 2 64 11 13 71]
g_normal_idxs: [75 43 30 76  8]
filtered_attacker_idxs: [0, 5, 7, 9]
final_attacker_idxs are: [0, 5, 7, 9]
num_dps: [548, 686, 813, 408, 400, 645, 78, 734, 633, 1384]
time spent on training: 75.73743319511414
Starting performing KrMLRFL...
Num data points: [548, 686, 813, 408, 400, 645, 78, 734, 633, 1384]
Num selected data points: [686 813 408 400  78 633]
The chosen ones are users: [1, 2, 3, 4, 6, 8], which are global users: [75, 64, 43, 30, 76, 8]
epoch_acc: 98.88
___Test Local_Simple poisoned: False, epoch: 201: Average loss: 0.0386, Accuracy: 9888/10000 (98.8800%)
___Test Local_Simple poisoned: True, epoch: 201: Average loss: 14.4387, Accuracy: 7/8968 (0.0781%)
Done in 83.16190147399902 sec.
Server Epoch:202 choose agents : [10, 91, 47, 63, 93, 2, 78, 56, 14, 12].
___Train Local_Simple,  epoch 202, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%)
___Train Local_Simple,  epoch 202, local model 10, internal_epoch   2,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.1772, Accuracy: 9453/10000 (94.5300%)
poison local model 91 index 0
___Train Local_Simple,  epoch 202, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 202, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.0487, Accuracy: 9852/10000 (98.5200%)
___Train Local_Simple,  epoch 202, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 768/776 (98.9691%)
___Train Local_Simple,  epoch 202, local model 47, internal_epoch   2,  Average loss: 0.0005, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.0575, Accuracy: 9808/10000 (98.0800%)
poison local model 63 index 1
___Train Local_Simple,  epoch 202, local model 63, internal_epoch   1,  Average loss: 0.0016, Accuracy: 859/889 (96.6254%)
___Train Local_Simple,  epoch 202, local model 63, internal_epoch   2,  Average loss: 0.0009, Accuracy: 877/889 (98.6502%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.1538, Accuracy: 9504/10000 (95.0400%)
poison local model 93 index 2
___Train Local_Simple,  epoch 202, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%)
___Train Local_Simple,  epoch 202, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.2120, Accuracy: 9453/10000 (94.5300%)
poison local model 2 index 3
___Train Local_Simple,  epoch 202, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 540/548 (98.5401%)
___Train Local_Simple,  epoch 202, local model 2, internal_epoch   2,  Average loss: 0.0005, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.1709, Accuracy: 9405/10000 (94.0500%)
___Train Local_Simple,  epoch 202, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 202, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.0477, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 202, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 876/880 (99.5455%)
___Train Local_Simple,  epoch 202, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 878/880 (99.7727%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.2088, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch 202, local model 14, internal_epoch   1,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Train Local_Simple,  epoch 202, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.0631, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 202, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1138/1160 (98.1034%)
___Train Local_Simple,  epoch 202, local model 12, internal_epoch   2,  Average loss: 0.0015, Accuracy: 1131/1160 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.5260, Accuracy: 8810/10000 (88.1000%)
time spent on training: 55.464008808135986
Starting performing KrMLRFL...
Num data points: [892, 256, 776, 889, 623, 548, 303, 880, 376, 1160]
Num selected data points: [892 256 303 880 376]
The chosen ones are users: [0, 1, 6, 7, 8], which are global users: [10, 91, 78, 56, 14]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 63, 93, 2]
base_p: [ 0.0010037   0.00014969 -0.00098206 ...  0.00521912  0.00331932
 -0.0004282 ]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 9]
layer1_inf_time: 3.25341796875
[PAIRWISE] pred_attackers_indx:  [3 4 5]
layer2_inf_t: 32.318603515625
assumed final_attacker_idxs:  [2 3 4 5 9]
final_attacker_idxs is: [2 3 4 5 9]
g_attacker_idxs: [47 63 93  2 12]
g_normal_idxs: [10 91 78 56 14]
filtered_attacker_idxs: [2, 3, 4, 5, 9]
final_attacker_idxs are: [2, 3, 4, 5, 9]
num_dps: [892, 256, 776, 889, 623, 548, 303, 880, 376, 1160]
epoch_acc: 98.53
___Test Local_Simple poisoned: False, epoch: 202: Average loss: 0.0449, Accuracy: 9853/10000 (98.5300%)
___Test Local_Simple poisoned: True, epoch: 202: Average loss: 14.7107, Accuracy: 10/8968 (0.1115%)
Done in 62.415727853775024 sec.
Server Epoch:203 choose agents : [69, 53, 10, 54, 92, 45, 63, 57, 6, 32].
___Train Local_Simple,  epoch 203, local model 69, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 203, local model 69, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.0518, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 203, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 729/739 (98.6468%)
___Train Local_Simple,  epoch 203, local model 53, internal_epoch   2,  Average loss: 0.0005, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.2042, Accuracy: 9343/10000 (93.4300%)
___Train Local_Simple,  epoch 203, local model 10, internal_epoch   1,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 203, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.0638, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch 203, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 512/519 (98.6513%)
___Train Local_Simple,  epoch 203, local model 54, internal_epoch   2,  Average loss: 0.0006, Accuracy: 513/519 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.0779, Accuracy: 9760/10000 (97.6000%)
___Train Local_Simple,  epoch 203, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 926/937 (98.8260%)
___Train Local_Simple,  epoch 203, local model 92, internal_epoch   2,  Average loss: 0.0007, Accuracy: 922/937 (98.3991%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.4716, Accuracy: 8604/10000 (86.0400%)
poison local model 45 index 0
___Train Local_Simple,  epoch 203, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 618/628 (98.4076%)
___Train Local_Simple,  epoch 203, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.2919, Accuracy: 9208/10000 (92.0800%)
poison local model 63 index 1
___Train Local_Simple,  epoch 203, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 871/889 (97.9753%)
___Train Local_Simple,  epoch 203, local model 63, internal_epoch   2,  Average loss: 0.0007, Accuracy: 881/889 (99.1001%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.0791, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch 203, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 339/343 (98.8338%)
___Train Local_Simple,  epoch 203, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 341/343 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.0594, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch 203, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 203, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.0455, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 203, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 954/977 (97.6459%)
___Train Local_Simple,  epoch 203, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 963/977 (98.5670%)
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.2566, Accuracy: 9260/10000 (92.6000%)
time spent on training: 40.145376443862915
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 63]
base_p: [ 1.2072474e-03 -4.6756119e-05  3.4723142e-03 ... -4.6973377e-03
 -2.0190626e-03  4.5704842e-04]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 6, 9]
layer1_inf_time: 2.749267578125
[PAIRWISE] pred_attackers_indx:  [5 9]
layer2_inf_t: 92.099365234375
assumed final_attacker_idxs:  [1 4 5 6 9]
final_attacker_idxs is: [1 4 5 6 9]
g_attacker_idxs: [53 92 45 63 32]
g_normal_idxs: [69 10 54 57  6]
filtered_attacker_idxs: [1, 4, 5, 6, 9]
final_attacker_idxs are: [1, 4, 5, 6, 9]
num_dps: [256, 739, 892, 519, 937, 628, 889, 343, 615, 977]
Starting performing KrMLRFL...
Num data points: [256, 739, 892, 519, 937, 628, 889, 343, 615, 977]
Num selected data points: [256 892 519 343 615]
The chosen ones are users: [0, 2, 3, 7, 8], which are global users: [69, 10, 54, 57, 6]
___Test Local_Simple poisoned: False, epoch: 203: Average loss: 0.0342, Accuracy: 9901/10000 (99.0100%)
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: True, epoch: 203: Average loss: 13.3800, Accuracy: 24/8968 (0.2676%)
Done in 45.913217306137085 sec.
Server Epoch:204 choose agents : [88, 48, 47, 81, 5, 98, 72, 92, 12, 40].
___Train Local_Simple,  epoch 204, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 529/530 (99.8113%)
___Train Local_Simple,  epoch 204, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 527/530 (99.4340%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.0595, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch 204, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch 204, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 445/448 (99.3304%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.0569, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 204, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 767/776 (98.8402%)
___Train Local_Simple,  epoch 204, local model 47, internal_epoch   2,  Average loss: 0.0003, Accuracy: 771/776 (99.3557%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.0782, Accuracy: 9752/10000 (97.5200%)
poison local model 81 index 0
___Train Local_Simple,  epoch 204, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1207/1227 (98.3700%)
___Train Local_Simple,  epoch 204, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1214/1227 (98.9405%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.4706, Accuracy: 8888/10000 (88.8800%)
___Train Local_Simple,  epoch 204, local model 5, internal_epoch   1,  Average loss: 0.0004, Accuracy: 432/434 (99.5392%)
___Train Local_Simple,  epoch 204, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.0910, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch 204, local model 98, internal_epoch   1,  Average loss: 0.0008, Accuracy: 804/818 (98.2885%)
___Train Local_Simple,  epoch 204, local model 98, internal_epoch   2,  Average loss: 0.0009, Accuracy: 803/818 (98.1663%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.2008, Accuracy: 9371/10000 (93.7100%)
___Train Local_Simple,  epoch 204, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 204, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.0493, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 204, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 204, local model 92, internal_epoch   2,  Average loss: 0.0005, Accuracy: 928/937 (99.0395%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.3395, Accuracy: 8919/10000 (89.1900%)
___Train Local_Simple,  epoch 204, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1144/1160 (98.6207%)
___Train Local_Simple,  epoch 204, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1149/1160 (99.0517%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.3308, Accuracy: 9227/10000 (92.2700%)
___Train Local_Simple,  epoch 204, local model 40, internal_epoch   1,  Average loss: 0.0006, Accuracy: 764/772 (98.9637%)
___Train Local_Simple,  epoch 204, local model 40, internal_epoch   2,  Average loss: 0.0005, Accuracy: 765/772 (99.0933%)
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.1140, Accuracy: 9675/10000 (96.7500%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [81]
base_p: [0.00020742 0.00014893 0.00010669 ... 0.00127445 0.00187257 0.00213736]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 7, 8, 9]
layer1_inf_time: 2.9541015625
[PAIRWISE] pred_attackers_indx:  [3 8 9]
layer2_inf_t: 40.904052734375
assumed final_attacker_idxs:  [2 3 5 7 8 9]
final_attacker_idxs is: [2 3 5 7 8 9]
g_attacker_idxs: [47 81 98 92 12 40]
g_normal_idxs: [88 48  5 72]
filtered_attacker_idxs: [2, 3, 5, 7, 8, 9]
final_attacker_idxs are: [2, 3, 5, 7, 8, 9]
num_dps: [530, 448, 776, 1227, 434, 818, 731, 937, 1160, 772]
time spent on training: 38.17745351791382
Starting performing KrMLRFL...
Num data points: [530, 448, 776, 1227, 434, 818, 731, 937, 1160, 772]
Num selected data points: [530 448 434 731]
The chosen ones are users: [0, 1, 4, 6], which are global users: [88, 48, 5, 72]
___Test Local_Simple poisoned: False, epoch: 204: Average loss: 0.0353, Accuracy: 9894/10000 (98.9400%)
epoch_acc: 98.94
___Test Local_Simple poisoned: True, epoch: 204: Average loss: 13.9243, Accuracy: 19/8968 (0.2119%)
Done in 44.73233604431152 sec.
Server Epoch:205 choose agents : [67, 37, 62, 42, 75, 7, 3, 84, 33, 93].
___Train Local_Simple,  epoch 205, local model 67, internal_epoch   1,  Average loss: 0.0003, Accuracy: 990/998 (99.1984%)
___Train Local_Simple,  epoch 205, local model 67, internal_epoch   2,  Average loss: 0.0007, Accuracy: 985/998 (98.6974%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.1118, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch 205, local model 37, internal_epoch   1,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Train Local_Simple,  epoch 205, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.0768, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch 205, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 205, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.0505, Accuracy: 9839/10000 (98.3900%)
poison local model 42 index 0
___Train Local_Simple,  epoch 205, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 205, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.0543, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch 205, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 682/686 (99.4169%)
___Train Local_Simple,  epoch 205, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 682/686 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.1509, Accuracy: 9510/10000 (95.1000%)
poison local model 7 index 1
___Train Local_Simple,  epoch 205, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 412/418 (98.5646%)
___Train Local_Simple,  epoch 205, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.1416, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch 205, local model 3, internal_epoch   1,  Average loss: 0.0007, Accuracy: 908/923 (98.3749%)
___Train Local_Simple,  epoch 205, local model 3, internal_epoch   2,  Average loss: 0.0007, Accuracy: 906/923 (98.1582%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.1492, Accuracy: 9565/10000 (95.6500%)
___Train Local_Simple,  epoch 205, local model 84, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1227/1246 (98.4751%)
___Train Local_Simple,  epoch 205, local model 84, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1235/1246 (99.1172%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.0925, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch 205, local model 33, internal_epoch   1,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Train Local_Simple,  epoch 205, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.0412, Accuracy: 9869/10000 (98.6900%)
poison local model 93 index 2
___Train Local_Simple,  epoch 205, local model 93, internal_epoch   1,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 205, local model 93, internal_epoch   2,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.2712, Accuracy: 9312/10000 (93.1200%)
time spent on training: 47.41202688217163
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 7, 93]
base_p: [ 1.2680888e-04 -5.6982040e-05 -1.2403363e-03 ... -2.3079067e-03
 -3.7201345e-03  2.0972788e-03]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 7, 9]
layer1_inf_time: 2.656982421875
[PAIRWISE] pred_attackers_indx:  [6 7 9]
layer2_inf_t: 102.37646484375
assumed final_attacker_idxs:  [0 5 6 7 9]
final_attacker_idxs is: [0 5 6 7 9]
g_attacker_idxs: [67  7  3 84 93]
g_normal_idxs: [37 62 42 75 33]
filtered_attacker_idxs: [0, 5, 6, 7, 9]
final_attacker_idxs are: [0, 5, 6, 7, 9]
num_dps: [998, 860, 423, 236, 686, 418, 923, 1246, 623, 623]
Starting performing KrMLRFL...
Num data points: [998, 860, 423, 236, 686, 418, 923, 1246, 623, 623]
Num selected data points: [860 423 236 686 623]
The chosen ones are users: [1, 2, 3, 4, 8], which are global users: [37, 62, 42, 75, 33]
___Test Local_Simple poisoned: False, epoch: 205: Average loss: 0.0336, Accuracy: 9887/10000 (98.8700%)
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 205: Average loss: 14.4816, Accuracy: 15/8968 (0.1673%)
Done in 53.81933403015137 sec.
Server Epoch:206 choose agents : [99, 7, 17, 41, 14, 64, 2, 63, 92, 58].
___Train Local_Simple,  epoch 206, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch 206, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.0718, Accuracy: 9776/10000 (97.7600%)
poison local model 7 index 0
___Train Local_Simple,  epoch 206, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 416/418 (99.5215%)
___Train Local_Simple,  epoch 206, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.1411, Accuracy: 9587/10000 (95.8700%)
poison local model 17 index 1
___Train Local_Simple,  epoch 206, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 611/620 (98.5484%)
___Train Local_Simple,  epoch 206, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 615/620 (99.1935%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.1258, Accuracy: 9623/10000 (96.2300%)
___Train Local_Simple,  epoch 206, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%)
___Train Local_Simple,  epoch 206, local model 41, internal_epoch   2,  Average loss: 0.0008, Accuracy: 596/606 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.1810, Accuracy: 9406/10000 (94.0600%)
___Train Local_Simple,  epoch 206, local model 14, internal_epoch   1,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Train Local_Simple,  epoch 206, local model 14, internal_epoch   2,  Average loss: 0.0000, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.0377, Accuracy: 9885/10000 (98.8500%)
___Train Local_Simple,  epoch 206, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 813/813 (100.0000%)
___Train Local_Simple,  epoch 206, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.0611, Accuracy: 9795/10000 (97.9500%)
poison local model 2 index 2
___Train Local_Simple,  epoch 206, local model 2, internal_epoch   1,  Average loss: 0.0010, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 206, local model 2, internal_epoch   2,  Average loss: 0.0010, Accuracy: 540/548 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.2816, Accuracy: 9066/10000 (90.6600%)
poison local model 63 index 3
___Train Local_Simple,  epoch 206, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 877/889 (98.6502%)
___Train Local_Simple,  epoch 206, local model 63, internal_epoch   2,  Average loss: 0.0005, Accuracy: 882/889 (99.2126%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.0624, Accuracy: 9804/10000 (98.0400%)
___Train Local_Simple,  epoch 206, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch 206, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 930/937 (99.2529%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.2696, Accuracy: 9137/10000 (91.3700%)
___Train Local_Simple,  epoch 206, local model 58, internal_epoch   1,  Average loss: 0.0005, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch 206, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 272/276 (98.5507%)
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.0852, Accuracy: 9711/10000 (97.1100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 17, 2, 63]
base_p: [ 1.8312708e-03  3.2793730e-05  7.4336864e-04 ...  1.0521710e-04
 -1.1462346e-03  1.6925111e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 6, 7, 8]
layer1_inf_time: 3.106201171875
[PAIRWISE] pred_attackers_indx:  [1 2 5 6 7]
layer2_inf_t: 35.467529296875
assumed final_attacker_idxs:  [1 2 5 6 7 8]
final_attacker_idxs is: [1 2 5 6 7 8]
g_attacker_idxs: [ 7 17 64  2 63 92]
g_normal_idxs: [99 41 14 58]
filtered_attacker_idxs: [1, 2, 6, 7, 8]
final_attacker_idxs are: [1, 2, 6, 7, 8]
num_dps: [377, 418, 620, 606, 376, 813, 548, 889, 937, 276]
time spent on training: 47.76017427444458
Starting performing KrMLRFL...
Num data points: [377, 418, 620, 606, 376, 813, 548, 889, 937, 276]
Num selected data points: [377 606 376 813 276]
The chosen ones are users: [0, 3, 4, 5, 9], which are global users: [99, 41, 14, 64, 58]
___Test Local_Simple poisoned: False, epoch: 206: Average loss: 0.0354, Accuracy: 9887/10000 (98.8700%)
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 206: Average loss: 13.4763, Accuracy: 16/8968 (0.1784%)
Done in 55.14846062660217 sec.
Server Epoch:207 choose agents : [20, 55, 88, 61, 53, 93, 7, 12, 24, 71].
poison local model 20 index 0
___Train Local_Simple,  epoch 207, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 207, local model 20, internal_epoch   2,  Average loss: 0.0005, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.2576, Accuracy: 9273/10000 (92.7300%)
___Train Local_Simple,  epoch 207, local model 55, internal_epoch   1,  Average loss: 0.0004, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 207, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.2662, Accuracy: 9272/10000 (92.7200%)
___Train Local_Simple,  epoch 207, local model 88, internal_epoch   1,  Average loss: 0.0002, Accuracy: 526/530 (99.2453%)
___Train Local_Simple,  epoch 207, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.0675, Accuracy: 9790/10000 (97.9000%)
poison local model 61 index 1
___Train Local_Simple,  epoch 207, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 682/699 (97.5680%)
___Train Local_Simple,  epoch 207, local model 61, internal_epoch   2,  Average loss: 0.0006, Accuracy: 692/699 (98.9986%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.3810, Accuracy: 8581/10000 (85.8100%)
___Train Local_Simple,  epoch 207, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 728/739 (98.5115%)
___Train Local_Simple,  epoch 207, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 731/739 (98.9175%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.2351, Accuracy: 9257/10000 (92.5700%)
poison local model 93 index 2
___Train Local_Simple,  epoch 207, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 207, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.1788, Accuracy: 9536/10000 (95.3600%)
poison local model 7 index 3
___Train Local_Simple,  epoch 207, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 414/418 (99.0431%)
___Train Local_Simple,  epoch 207, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.1243, Accuracy: 9633/10000 (96.3300%)
___Train Local_Simple,  epoch 207, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1140/1160 (98.2759%)
___Train Local_Simple,  epoch 207, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1143/1160 (98.5345%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.1376, Accuracy: 9552/10000 (95.5200%)
___Train Local_Simple,  epoch 207, local model 24, internal_epoch   1,  Average loss: 0.0003, Accuracy: 378/379 (99.7361%)
___Train Local_Simple,  epoch 207, local model 24, internal_epoch   2,  Average loss: 0.0001, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.0799, Accuracy: 9772/10000 (97.7200%)
poison local model 71 index 0
___Train Local_Simple,  epoch 207, local model 71, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1376/1384 (99.4220%)
___Train Local_Simple,  epoch 207, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1379/1384 (99.6387%)
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.1209, Accuracy: 9614/10000 (96.1400%)
time spent on training: 60.23657727241516
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 61, 93, 7, 71]
base_p: [-0.00025276  0.00019819  0.00092612 ... -0.00287819  0.00364772
 -0.00093276]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 5, 6, 7, 9]
layer1_inf_time: 5.734375
[PAIRWISE] pred_attackers_indx:  [1 2 3 4]
layer2_inf_t: 204.54638671875
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 9]
g_attacker_idxs: [20 55 88 61 53 93  7 12 71]
g_normal_idxs: [24]
filtered_attacker_idxs: [0, 3, 4, 5, 6, 7, 9]
final_attacker_idxs are: [0, 3, 4, 5, 6, 7, 9]
num_dps: [429, 354, 530, 699, 739, 623, 418, 1160, 379, 1384]
Num data points: [429, 354, 530, 699, 739, 623, 418, 1160, 379, 1384]
Num selected data points: [354 530 379]
The chosen ones are users: [1, 2, 8], which are global users: [55, 88, 24]
___Test Local_Simple poisoned: False, epoch: 207: Average loss: 0.0528, Accuracy: 9832/10000 (98.3200%)
epoch_acc: 98.32
___Test Local_Simple poisoned: True, epoch: 207: Average loss: 14.2712, Accuracy: 19/8968 (0.2119%)
Done in 65.77287006378174 sec.
Server Epoch:208 choose agents : [78, 50, 12, 22, 26, 31, 19, 20, 81, 95].
___Train Local_Simple,  epoch 208, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch 208, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.0709, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch 208, local model 50, internal_epoch   1,  Average loss: 0.0006, Accuracy: 468/474 (98.7342%)
___Train Local_Simple,  epoch 208, local model 50, internal_epoch   2,  Average loss: 0.0006, Accuracy: 468/474 (98.7342%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.1386, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch 208, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1139/1160 (98.1897%)
___Train Local_Simple,  epoch 208, local model 12, internal_epoch   2,  Average loss: 0.0012, Accuracy: 1134/1160 (97.7586%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.1858, Accuracy: 9444/10000 (94.4400%)
poison local model 22 index 0
___Train Local_Simple,  epoch 208, local model 22, internal_epoch   1,  Average loss: 0.0010, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 208, local model 22, internal_epoch   2,  Average loss: 0.0003, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.1200, Accuracy: 9594/10000 (95.9400%)
poison local model 26 index 1
___Train Local_Simple,  epoch 208, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 547/554 (98.7365%)
___Train Local_Simple,  epoch 208, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.1043, Accuracy: 9681/10000 (96.8100%)
___Train Local_Simple,  epoch 208, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Train Local_Simple,  epoch 208, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.0591, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 208, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 208, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.0735, Accuracy: 9762/10000 (97.6200%)
poison local model 20 index 2
___Train Local_Simple,  epoch 208, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 208, local model 20, internal_epoch   2,  Average loss: 0.0010, Accuracy: 421/429 (98.1352%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.3724, Accuracy: 9027/10000 (90.2700%)
poison local model 81 index 3
___Train Local_Simple,  epoch 208, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1211/1227 (98.6960%)
___Train Local_Simple,  epoch 208, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.3858, Accuracy: 8904/10000 (89.0400%)
___Train Local_Simple,  epoch 208, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 596/602 (99.0033%)
___Train Local_Simple,  epoch 208, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 2.0560, Accuracy: 7519/10000 (75.1900%)
time spent on training: 56.50182366371155
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 26, 20, 81]
base_p: [-5.3427368e-04  4.7497451e-07 -1.1011898e-03 ... -1.4428049e-03
 -1.0526866e-02 -2.7614906e-03]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 8, 9]
layer1_inf_time: 5.4130859375
[PAIRWISE] pred_attackers_indx:  [3 4 8 9]
layer2_inf_t: 481.531982421875
assumed final_attacker_idxs:  [2 3 4 7 8 9]
final_attacker_idxs is: [2 3 4 7 8 9]
g_attacker_idxs: [12 22 26 20 81 95]
g_normal_idxs: [78 50 31 19]
filtered_attacker_idxs: [2, 3, 4, 7, 8, 9]
final_attacker_idxs are: [2, 3, 4, 7, 8, 9]
num_dps: [303, 474, 1160, 583, 554, 835, 205, 429, 1227, 602]
Starting performing KrMLRFL...
Num data points: [303, 474, 1160, 583, 554, 835, 205, 429, 1227, 602]
Num selected data points: [303 474 835 205]
The chosen ones are users: [0, 1, 5, 6], which are global users: [78, 50, 31, 19]
epoch_acc: 98.61
___Test Local_Simple poisoned: False, epoch: 208: Average loss: 0.0427, Accuracy: 9861/10000 (98.6100%)
___Test Local_Simple poisoned: True, epoch: 208: Average loss: 14.2372, Accuracy: 16/8968 (0.1784%)
Done in 61.8597252368927 sec.
Server Epoch:209 choose agents : [99, 68, 83, 98, 2, 41, 1, 10, 49, 5].
___Train Local_Simple,  epoch 209, local model 99, internal_epoch   1,  Average loss: 0.0004, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch 209, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.0496, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 209, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 209, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.0507, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 209, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Train Local_Simple,  epoch 209, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.0405, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 209, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 807/818 (98.6553%)
___Train Local_Simple,  epoch 209, local model 98, internal_epoch   2,  Average loss: 0.0004, Accuracy: 812/818 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.3415, Accuracy: 9019/10000 (90.1900%)
poison local model 2 index 0
___Train Local_Simple,  epoch 209, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 540/548 (98.5401%)
___Train Local_Simple,  epoch 209, local model 2, internal_epoch   2,  Average loss: 0.0004, Accuracy: 543/548 (99.0876%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.1948, Accuracy: 9333/10000 (93.3300%)
___Train Local_Simple,  epoch 209, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%)
___Train Local_Simple,  epoch 209, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.0919, Accuracy: 9698/10000 (96.9800%)
poison local model 1 index 1
___Train Local_Simple,  epoch 209, local model 1, internal_epoch   1,  Average loss: 0.0010, Accuracy: 742/760 (97.6316%)
___Train Local_Simple,  epoch 209, local model 1, internal_epoch   2,  Average loss: 0.0005, Accuracy: 750/760 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.2369, Accuracy: 9186/10000 (91.8600%)
___Train Local_Simple,  epoch 209, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 876/892 (98.2063%)
___Train Local_Simple,  epoch 209, local model 10, internal_epoch   2,  Average loss: 0.0023, Accuracy: 854/892 (95.7399%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.4063, Accuracy: 8673/10000 (86.7300%)
___Train Local_Simple,  epoch 209, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 209, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.0574, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 209, local model 5, internal_epoch   1,  Average loss: 0.0004, Accuracy: 431/434 (99.3088%)
___Train Local_Simple,  epoch 209, local model 5, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.1287, Accuracy: 9529/10000 (95.2900%)
time spent on training: 50.12013292312622
Starting performing KrMLRFL...
Num data points: [377, 494, 433, 818, 548, 606, 760, 892, 506, 434]
Num selected data points: [377 494 433 892 434]
The chosen ones are users: [0, 1, 2, 7, 9], which are global users: [99, 68, 83, 10, 5]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 1]
base_p: [ 3.5176426e-04  6.3655898e-05 -1.2490805e-03 ... -4.0575564e-03
  3.2771826e-03  3.6271811e-03]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 6, 8]
layer1_inf_time: 3.974853515625
[PAIRWISE] pred_attackers_indx:  [2 3 4 6 8]
layer2_inf_t: 174.775146484375
assumed final_attacker_idxs:  [2 3 4 5 6 8]
final_attacker_idxs is: [2 3 4 5 6 8]
g_attacker_idxs: [83 98  2 41  1 49]
g_normal_idxs: [99 68 10  5]
filtered_attacker_idxs: [3, 4, 5, 6, 8]
final_attacker_idxs are: [3, 4, 5, 6, 8]
num_dps: [377, 494, 433, 818, 548, 606, 760, 892, 506, 434]
___Test Local_Simple poisoned: False, epoch: 209: Average loss: 0.0555, Accuracy: 9808/10000 (98.0800%)
epoch_acc: 98.08
___Test Local_Simple poisoned: True, epoch: 209: Average loss: 12.4933, Accuracy: 4/8968 (0.0446%)
Done in 61.1294059753418 sec.
Server Epoch:210 choose agents : [40, 46, 10, 63, 25, 24, 17, 42, 49, 96].
___Train Local_Simple,  epoch 210, local model 40, internal_epoch   1,  Average loss: 0.0010, Accuracy: 755/772 (97.7979%)
___Train Local_Simple,  epoch 210, local model 40, internal_epoch   2,  Average loss: 0.0007, Accuracy: 758/772 (98.1865%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.1184, Accuracy: 9644/10000 (96.4400%)
___Train Local_Simple,  epoch 210, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 699/710 (98.4507%)
___Train Local_Simple,  epoch 210, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 701/710 (98.7324%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.2019, Accuracy: 9363/10000 (93.6300%)
___Train Local_Simple,  epoch 210, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 210, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.0869, Accuracy: 9713/10000 (97.1300%)
poison local model 63 index 0
___Train Local_Simple,  epoch 210, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 870/889 (97.8628%)
___Train Local_Simple,  epoch 210, local model 63, internal_epoch   2,  Average loss: 0.0003, Accuracy: 886/889 (99.6625%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.0826, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch 210, local model 25, internal_epoch   1,  Average loss: 0.0007, Accuracy: 641/647 (99.0726%)
___Train Local_Simple,  epoch 210, local model 25, internal_epoch   2,  Average loss: 0.0006, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.1862, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch 210, local model 24, internal_epoch   1,  Average loss: 0.0006, Accuracy: 375/379 (98.9446%)
___Train Local_Simple,  epoch 210, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.0759, Accuracy: 9746/10000 (97.4600%)
poison local model 17 index 1
___Train Local_Simple,  epoch 210, local model 17, internal_epoch   1,  Average loss: 0.0012, Accuracy: 606/620 (97.7419%)
___Train Local_Simple,  epoch 210, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 611/620 (98.5484%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.1872, Accuracy: 9485/10000 (94.8500%)
poison local model 42 index 2
___Train Local_Simple,  epoch 210, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 231/236 (97.8814%)
___Train Local_Simple,  epoch 210, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.0765, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch 210, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 502/506 (99.2095%)
___Train Local_Simple,  epoch 210, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.0800, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch 210, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 665/672 (98.9583%)
___Train Local_Simple,  epoch 210, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 671/672 (99.8512%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 17, 42]
base_p: [ 2.0521134e-03  2.0705350e-04 -9.3278475e-05 ... -1.9941777e-03
 -7.0285201e-03 -3.8558543e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 6, 9]
layer1_inf_time: 3.6123046875
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.1458, Accuracy: 9569/10000 (95.6900%)
time spent on training: 50.269667863845825
Starting performing KrMLRFL...
Num data points: [772, 710, 892, 889, 647, 379, 620, 236, 506, 672]
Num selected data points: [892 379 506]
The chosen ones are users: [2, 5, 8], which are global users: [10, 24, 49]
[PAIRWISE] pred_attackers_indx:  [0 3 4 6 7]
layer2_inf_t: 38.03857421875
assumed final_attacker_idxs:  [0 1 3 4 6 7 9]
final_attacker_idxs is: [0 1 3 4 6 7 9]
g_attacker_idxs: [40 46 63 25 17 42 96]
g_normal_idxs: [10 24 49]
filtered_attacker_idxs: [0, 1, 3, 4, 6, 7, 9]
final_attacker_idxs are: [0, 1, 3, 4, 6, 7, 9]
num_dps: [772, 710, 892, 889, 647, 379, 620, 236, 506, 672]
epoch_acc: 98.45
___Test Local_Simple poisoned: False, epoch: 210: Average loss: 0.0488, Accuracy: 9845/10000 (98.4500%)
___Test Local_Simple poisoned: True, epoch: 210: Average loss: 13.3386, Accuracy: 3/8968 (0.0335%)
Done in 55.16509032249451 sec.
Server Epoch:211 choose agents : [55, 24, 13, 20, 81, 18, 57, 17, 86, 27].
___Train Local_Simple,  epoch 211, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 211, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.0947, Accuracy: 9694/10000 (96.9400%)
___Train Local_Simple,  epoch 211, local model 24, internal_epoch   1,  Average loss: 0.0003, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 211, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.0571, Accuracy: 9818/10000 (98.1800%)
poison local model 13 index 0
___Train Local_Simple,  epoch 211, local model 13, internal_epoch   1,  Average loss: 0.0014, Accuracy: 715/734 (97.4114%)
___Train Local_Simple,  epoch 211, local model 13, internal_epoch   2,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.2336, Accuracy: 9243/10000 (92.4300%)
poison local model 20 index 1
___Train Local_Simple,  epoch 211, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 211, local model 20, internal_epoch   2,  Average loss: 0.0005, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.1955, Accuracy: 9443/10000 (94.4300%)
poison local model 81 index 2
___Train Local_Simple,  epoch 211, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1207/1227 (98.3700%)
___Train Local_Simple,  epoch 211, local model 81, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1220/1227 (99.4295%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.2764, Accuracy: 9184/10000 (91.8400%)
___Train Local_Simple,  epoch 211, local model 18, internal_epoch   1,  Average loss: 0.0006, Accuracy: 451/459 (98.2571%)
___Train Local_Simple,  epoch 211, local model 18, internal_epoch   2,  Average loss: 0.0004, Accuracy: 454/459 (98.9107%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.3191, Accuracy: 9270/10000 (92.7000%)
___Train Local_Simple,  epoch 211, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 334/343 (97.3761%)
___Train Local_Simple,  epoch 211, local model 57, internal_epoch   2,  Average loss: 0.0018, Accuracy: 332/343 (96.7930%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.1720, Accuracy: 9421/10000 (94.2100%)
poison local model 17 index 3
___Train Local_Simple,  epoch 211, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 607/620 (97.9032%)
___Train Local_Simple,  epoch 211, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 615/620 (99.1935%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.1398, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch 211, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 211, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.0751, Accuracy: 9766/10000 (97.6600%)
poison local model 27 index 0
___Train Local_Simple,  epoch 211, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 211, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.0990, Accuracy: 9677/10000 (96.7700%)
time spent on training: 52.428386211395264
Starting performing KrMLRFL...
Num data points: [354, 379, 734, 429, 1227, 459, 343, 620, 250, 471]
Num selected data points: [354 379 459 343 250]
The chosen ones are users: [0, 1, 5, 6, 8], which are global users: [55, 24, 18, 57, 86]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 20, 81, 17, 27]
base_p: [ 0.00026394  0.00017702 -0.00075188 ... -0.00479431 -0.00429409
 -0.00115637]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 9]
layer1_inf_time: 2.2900390625
[PAIRWISE] pred_attackers_indx:  [2 3 4 7]
layer2_inf_t: 25.76806640625
assumed final_attacker_idxs:  [2 3 4 7 9]
final_attacker_idxs is: [2 3 4 7 9]
g_attacker_idxs: [13 20 81 17 27]
g_normal_idxs: [55 24 18 57 86]
filtered_attacker_idxs: [2, 3, 4, 7, 9]
final_attacker_idxs are: [2, 3, 4, 7, 9]
num_dps: [354, 379, 734, 429, 1227, 459, 343, 620, 250, 471]
___Test Local_Simple poisoned: False, epoch: 211: Average loss: 0.0427, Accuracy: 9866/10000 (98.6600%)
epoch_acc: 98.66
___Test Local_Simple poisoned: True, epoch: 211: Average loss: 13.2950, Accuracy: 7/8968 (0.0781%)
Done in 60.14913487434387 sec.
Server Epoch:212 choose agents : [1, 7, 65, 23, 87, 40, 73, 60, 85, 22].
poison local model 1 index 0
___Train Local_Simple,  epoch 212, local model 1, internal_epoch   1,  Average loss: 0.0010, Accuracy: 745/760 (98.0263%)
___Train Local_Simple,  epoch 212, local model 1, internal_epoch   2,  Average loss: 0.0006, Accuracy: 755/760 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.3664, Accuracy: 8889/10000 (88.8900%)
poison local model 7 index 1
___Train Local_Simple,  epoch 212, local model 7, internal_epoch   1,  Average loss: 0.0008, Accuracy: 411/418 (98.3254%)
___Train Local_Simple,  epoch 212, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 415/418 (99.2823%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.1861, Accuracy: 9410/10000 (94.1000%)
___Train Local_Simple,  epoch 212, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 212, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0680, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch 212, local model 23, internal_epoch   1,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch 212, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0817, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 212, local model 87, internal_epoch   1,  Average loss: 0.0006, Accuracy: 464/470 (98.7234%)
___Train Local_Simple,  epoch 212, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0833, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch 212, local model 40, internal_epoch   1,  Average loss: 0.0007, Accuracy: 759/772 (98.3161%)
___Train Local_Simple,  epoch 212, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0581, Accuracy: 9814/10000 (98.1400%)
poison local model 73 index 2
___Train Local_Simple,  epoch 212, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 587/591 (99.3232%)
___Train Local_Simple,  epoch 212, local model 73, internal_epoch   2,  Average loss: 0.0001, Accuracy: 589/591 (99.6616%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0656, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch 212, local model 60, internal_epoch   1,  Average loss: 0.0005, Accuracy: 336/338 (99.4083%)
___Train Local_Simple,  epoch 212, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0715, Accuracy: 9769/10000 (97.6900%)
poison local model 85 index 3
___Train Local_Simple,  epoch 212, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 212, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0743, Accuracy: 9758/10000 (97.5800%)
poison local model 22 index 0
___Train Local_Simple,  epoch 212, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 212, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0686, Accuracy: 9797/10000 (97.9700%)
time spent on training: 57.43572735786438
Starting performing KrMLRFL...
Num data points: [760, 418, 371, 293, 470, 772, 591, 338, 431, 583]
Num selected data points: [371 293 470 338 431]
The chosen ones are users: [2, 3, 4, 7, 8], which are global users: [65, 23, 87, 60, 85]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 7, 73, 85, 22]
base_p: [ 2.5317818e-04  9.3948096e-05 -8.3886366e-04 ...  7.5937808e-04
 -1.9972622e-03 -2.6435405e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 6, 9]
layer1_inf_time: 3.779541015625
[PAIRWISE] pred_attackers_indx:  [0 1]
layer2_inf_t: 33.57177734375
assumed final_attacker_idxs:  [0 1 5 6 9]
final_attacker_idxs is: [0 1 5 6 9]
g_attacker_idxs: [ 1  7 40 73 22]
g_normal_idxs: [65 23 87 60 85]
filtered_attacker_idxs: [0, 1, 5, 6, 9]
final_attacker_idxs are: [0, 1, 5, 6, 9]
num_dps: [760, 418, 371, 293, 470, 772, 591, 338, 431, 583]
epoch_acc: 98.72
___Test Local_Simple poisoned: False, epoch: 212: Average loss: 0.0398, Accuracy: 9872/10000 (98.7200%)
___Test Local_Simple poisoned: True, epoch: 212: Average loss: 12.7005, Accuracy: 21/8968 (0.2342%)
Done in 62.13227152824402 sec.
Server Epoch:213 choose agents : [55, 98, 56, 99, 94, 92, 36, 42, 84, 71].
___Train Local_Simple,  epoch 213, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 354/354 (100.0000%)
___Train Local_Simple,  epoch 213, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.0941, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch 213, local model 98, internal_epoch   1,  Average loss: 0.0006, Accuracy: 809/818 (98.8998%)
___Train Local_Simple,  epoch 213, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 812/818 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.1875, Accuracy: 9418/10000 (94.1800%)
___Train Local_Simple,  epoch 213, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 213, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.0580, Accuracy: 9819/10000 (98.1900%)
___Train Local_Simple,  epoch 213, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch 213, local model 99, internal_epoch   2,  Average loss: 0.0003, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.0388, Accuracy: 9882/10000 (98.8200%)
___Train Local_Simple,  epoch 213, local model 94, internal_epoch   1,  Average loss: 0.0008, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 213, local model 94, internal_epoch   2,  Average loss: 0.0000, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.1632, Accuracy: 9415/10000 (94.1500%)
___Train Local_Simple,  epoch 213, local model 92, internal_epoch   1,  Average loss: 0.0009, Accuracy: 920/937 (98.1857%)
___Train Local_Simple,  epoch 213, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 932/937 (99.4664%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.1842, Accuracy: 9362/10000 (93.6200%)
___Train Local_Simple,  epoch 213, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 997/1005 (99.2040%)
___Train Local_Simple,  epoch 213, local model 36, internal_epoch   2,  Average loss: 0.0008, Accuracy: 993/1005 (98.8060%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.1377, Accuracy: 9566/10000 (95.6600%)
poison local model 42 index 0
___Train Local_Simple,  epoch 213, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 213, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.0525, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch 213, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1232/1246 (98.8764%)
___Train Local_Simple,  epoch 213, local model 84, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1234/1246 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.0634, Accuracy: 9794/10000 (97.9400%)
poison local model 71 index 1
___Train Local_Simple,  epoch 213, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1369/1384 (98.9162%)
___Train Local_Simple,  epoch 213, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1376/1384 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.1774, Accuracy: 9495/10000 (94.9500%)
time spent on training: 46.21609950065613
Starting performing KrMLRFL...
Num data points: [354, 818, 880, 377, 150, 937, 1005, 236, 1246, 1384]
Num selected data points: [354 880 377 150 236]
The chosen ones are users: [0, 2, 3, 4, 7], which are global users: [55, 56, 99, 94, 42]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 71]
base_p: [ 3.6903843e-04 -4.4267625e-05  1.2878333e-03 ...  1.3992190e-05
  2.3204088e-04  1.7284453e-03]
[T_SCORE] attacker_local_idxs is:  [1, 5, 6, 8, 9]
layer1_inf_time: 3.612060546875
[PAIRWISE] pred_attackers_indx:  [6 8 9]
layer2_inf_t: 28.79736328125
assumed final_attacker_idxs:  [1 5 6 8 9]
final_attacker_idxs is: [1 5 6 8 9]
g_attacker_idxs: [98 92 36 84 71]
g_normal_idxs: [55 56 99 94 42]
filtered_attacker_idxs: [1, 5, 6, 8, 9]
final_attacker_idxs are: [1, 5, 6, 8, 9]
num_dps: [354, 818, 880, 377, 150, 937, 1005, 236, 1246, 1384]
___Test Local_Simple poisoned: False, epoch: 213: Average loss: 0.0377, Accuracy: 9875/10000 (98.7500%)
epoch_acc: 98.75
___Test Local_Simple poisoned: True, epoch: 213: Average loss: 14.2517, Accuracy: 19/8968 (0.2119%)
Done in 54.57455372810364 sec.
Server Epoch:214 choose agents : [68, 66, 44, 70, 71, 19, 31, 8, 48, 15].
___Train Local_Simple,  epoch 214, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 214, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.0590, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 214, local model 66, internal_epoch   1,  Average loss: 0.0013, Accuracy: 643/660 (97.4242%)
___Train Local_Simple,  epoch 214, local model 66, internal_epoch   2,  Average loss: 0.0006, Accuracy: 650/660 (98.4848%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.4449, Accuracy: 8627/10000 (86.2700%)
___Train Local_Simple,  epoch 214, local model 44, internal_epoch   1,  Average loss: 0.0006, Accuracy: 510/517 (98.6460%)
___Train Local_Simple,  epoch 214, local model 44, internal_epoch   2,  Average loss: 0.0004, Accuracy: 514/517 (99.4197%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.0642, Accuracy: 9807/10000 (98.0700%)
poison local model 70 index 0
___Train Local_Simple,  epoch 214, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 709/724 (97.9282%)
___Train Local_Simple,  epoch 214, local model 70, internal_epoch   2,  Average loss: 0.0005, Accuracy: 714/724 (98.6188%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.2565, Accuracy: 9322/10000 (93.2200%)
poison local model 71 index 1
___Train Local_Simple,  epoch 214, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1370/1384 (98.9884%)
___Train Local_Simple,  epoch 214, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1373/1384 (99.2052%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.2327, Accuracy: 9264/10000 (92.6400%)
___Train Local_Simple,  epoch 214, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 214, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.1133, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch 214, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Train Local_Simple,  epoch 214, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.0518, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 214, local model 8, internal_epoch   1,  Average loss: 0.0004, Accuracy: 628/633 (99.2101%)
___Train Local_Simple,  epoch 214, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 629/633 (99.3681%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.0470, Accuracy: 9855/10000 (98.5500%)
___Train Local_Simple,  epoch 214, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch 214, local model 48, internal_epoch   2,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.0668, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch 214, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 396/401 (98.7531%)
___Train Local_Simple,  epoch 214, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 71]
base_p: [ 0.00029101  0.00018003 -0.00202854 ... -0.00110753 -0.00571393
 -0.00094218]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 9]
layer1_inf_time: 5.508056640625
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.0649, Accuracy: 9797/10000 (97.9700%)
time spent on training: 44.32844829559326
Starting performing KrMLRFL...
Num data points: [494, 660, 517, 724, 1384, 205, 835, 633, 448, 401]
Num selected data points: [494 517 205 835 633 448 401]
The chosen ones are users: [0, 2, 5, 6, 7, 8, 9], which are global users: [68, 44, 19, 31, 8, 48, 15]
___Test Local_Simple poisoned: False, epoch: 214: Average loss: 0.0323, Accuracy: 9898/10000 (98.9800%)
[PAIRWISE] pred_attackers_indx:  [1 3 4]
layer2_inf_t: 446.997802734375
assumed final_attacker_idxs:  [1 2 3 4 9]
final_attacker_idxs is: [1 2 3 4 9]
g_attacker_idxs: [66 44 70 71 15]
g_normal_idxs: [68 19 31  8 48]
filtered_attacker_idxs: [1, 3, 4]
final_attacker_idxs are: [1, 3, 4]
num_dps: [494, 660, 517, 724, 1384, 205, 835, 633, 448, 401]
epoch_acc: 98.98
___Test Local_Simple poisoned: True, epoch: 214: Average loss: 13.6016, Accuracy: 18/8968 (0.2007%)
Done in 68.91399097442627 sec.
Server Epoch:215 choose agents : [41, 25, 24, 38, 49, 99, 56, 17, 18, 30].
___Train Local_Simple,  epoch 215, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%)
___Train Local_Simple,  epoch 215, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.5054, Accuracy: 8795/10000 (87.9500%)
___Train Local_Simple,  epoch 215, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%)
___Train Local_Simple,  epoch 215, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.1050, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch 215, local model 24, internal_epoch   1,  Average loss: 0.0001, Accuracy: 378/379 (99.7361%)
___Train Local_Simple,  epoch 215, local model 24, internal_epoch   2,  Average loss: 0.0000, Accuracy: 379/379 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.0540, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 215, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 892/895 (99.6648%)
___Train Local_Simple,  epoch 215, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.1064, Accuracy: 9649/10000 (96.4900%)
___Train Local_Simple,  epoch 215, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Train Local_Simple,  epoch 215, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.0469, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 215, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch 215, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.0358, Accuracy: 9883/10000 (98.8300%)
___Train Local_Simple,  epoch 215, local model 56, internal_epoch   1,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 215, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.0352, Accuracy: 9883/10000 (98.8300%)
poison local model 17 index 0
___Train Local_Simple,  epoch 215, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 606/620 (97.7419%)
___Train Local_Simple,  epoch 215, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 614/620 (99.0323%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.1309, Accuracy: 9635/10000 (96.3500%)
___Train Local_Simple,  epoch 215, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 455/459 (99.1285%)
___Train Local_Simple,  epoch 215, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.1541, Accuracy: 9557/10000 (95.5700%)
___Train Local_Simple,  epoch 215, local model 30, internal_epoch   1,  Average loss: 0.0001, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch 215, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.0834, Accuracy: 9750/10000 (97.5000%)
time spent on training: 38.61398506164551
Starting performing KrMLRFL...
Num data points: [606, 647, 379, 895, 506, 377, 880, 620, 459, 400]
Num selected data points: [379 895 506 377 880 459 400]
The chosen ones are users: [2, 3, 4, 5, 6, 8, 9], which are global users: [24, 38, 49, 99, 56, 18, 30]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17]
base_p: [ 2.9867515e-04 -5.9897080e-05  1.8464029e-04 ... -1.2950599e-03
 -1.3001114e-03 -1.4893711e-05]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 7, 8]
layer1_inf_time: 5.43994140625
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 256.622314453125
assumed final_attacker_idxs:  [0 1 3 7 8]
final_attacker_idxs is: [0 1 3 7 8]
g_attacker_idxs: [41 25 38 17 18]
g_normal_idxs: [24 49 99 56 30]
filtered_attacker_idxs: [0, 1, 7]
final_attacker_idxs are: [0, 1, 7]
num_dps: [606, 647, 379, 895, 506, 377, 880, 620, 459, 400]
___Test Local_Simple poisoned: False, epoch: 215: Average loss: 0.0341, Accuracy: 9890/10000 (98.9000%)
epoch_acc: 98.9
___Test Local_Simple poisoned: True, epoch: 215: Average loss: 15.0819, Accuracy: 5/8968 (0.0558%)
Done in 49.4376015663147 sec.
Server Epoch:216 choose agents : [47, 64, 43, 41, 66, 93, 19, 29, 36, 68].
___Train Local_Simple,  epoch 216, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 767/776 (98.8402%)
___Train Local_Simple,  epoch 216, local model 47, internal_epoch   2,  Average loss: 0.0006, Accuracy: 767/776 (98.8402%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.1141, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch 216, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 811/813 (99.7540%)
___Train Local_Simple,  epoch 216, local model 64, internal_epoch   2,  Average loss: 0.0002, Accuracy: 809/813 (99.5080%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.0903, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch 216, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 216, local model 43, internal_epoch   2,  Average loss: 0.0008, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.0483, Accuracy: 9844/10000 (98.4400%)
___Train Local_Simple,  epoch 216, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%)
___Train Local_Simple,  epoch 216, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 601/606 (99.1749%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.1539, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch 216, local model 66, internal_epoch   1,  Average loss: 0.0005, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch 216, local model 66, internal_epoch   2,  Average loss: 0.0003, Accuracy: 655/660 (99.2424%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.2049, Accuracy: 9318/10000 (93.1800%)
poison local model 93 index 0
___Train Local_Simple,  epoch 216, local model 93, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 216, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.1619, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch 216, local model 19, internal_epoch   1,  Average loss: 0.0003, Accuracy: 204/205 (99.5122%)
___Train Local_Simple,  epoch 216, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.0416, Accuracy: 9867/10000 (98.6700%)
___Train Local_Simple,  epoch 216, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 996/1002 (99.4012%)
___Train Local_Simple,  epoch 216, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 991/1002 (98.9022%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.3933, Accuracy: 8851/10000 (88.5100%)
___Train Local_Simple,  epoch 216, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 993/1005 (98.8060%)
___Train Local_Simple,  epoch 216, local model 36, internal_epoch   2,  Average loss: 0.0011, Accuracy: 982/1005 (97.7114%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.2453, Accuracy: 9305/10000 (93.0500%)
___Train Local_Simple,  epoch 216, local model 68, internal_epoch   1,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 216, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.0395, Accuracy: 9876/10000 (98.7600%)
time spent on training: 37.831666707992554
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93]
base_p: [ 0.00037853  0.00011302 -0.00068676 ... -0.00066745 -0.00152832
 -0.00034926]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 8]
layer1_inf_time: 3.02099609375
[PAIRWISE] pred_attackers_indx:  [0 1 4 5 7]
layer2_inf_t: 31.62841796875
assumed final_attacker_idxs:  [0 1 4 5 7 8]
final_attacker_idxs is: [0 1 4 5 7 8]
g_attacker_idxs: [47 64 66 93 29 36]
g_normal_idxs: [43 41 19 68]
filtered_attacker_idxs: [0, 4, 5, 7, 8]
final_attacker_idxs are: [0, 4, 5, 7, 8]
num_dps: [776, 813, 408, 606, 660, 623, 205, 1002, 1005, 494]
Starting performing KrMLRFL...
Num data points: [776, 813, 408, 606, 660, 623, 205, 1002, 1005, 494]
Num selected data points: [813 408 606 205 494]
The chosen ones are users: [1, 2, 3, 6, 9], which are global users: [64, 43, 41, 19, 68]
___Test Local_Simple poisoned: False, epoch: 216: Average loss: 0.0387, Accuracy: 9865/10000 (98.6500%)
epoch_acc: 98.65
___Test Local_Simple poisoned: True, epoch: 216: Average loss: 13.9490, Accuracy: 15/8968 (0.1673%)
Done in 46.22053122520447 sec.
Server Epoch:217 choose agents : [31, 90, 83, 40, 20, 36, 6, 42, 47, 80].
___Train Local_Simple,  epoch 217, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Train Local_Simple,  epoch 217, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.0507, Accuracy: 9848/10000 (98.4800%)
___Train Local_Simple,  epoch 217, local model 90, internal_epoch   1,  Average loss: 0.0004, Accuracy: 676/683 (98.9751%)
___Train Local_Simple,  epoch 217, local model 90, internal_epoch   2,  Average loss: 0.0003, Accuracy: 677/683 (99.1215%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 1.0104, Accuracy: 7786/10000 (77.8600%)
___Train Local_Simple,  epoch 217, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 430/433 (99.3072%)
___Train Local_Simple,  epoch 217, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.0471, Accuracy: 9855/10000 (98.5500%)
___Train Local_Simple,  epoch 217, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 764/772 (98.9637%)
___Train Local_Simple,  epoch 217, local model 40, internal_epoch   2,  Average loss: 0.0004, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.1192, Accuracy: 9667/10000 (96.6700%)
poison local model 20 index 0
___Train Local_Simple,  epoch 217, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 425/429 (99.0676%)
___Train Local_Simple,  epoch 217, local model 20, internal_epoch   2,  Average loss: 0.0001, Accuracy: 428/429 (99.7669%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.2213, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch 217, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 988/1005 (98.3085%)
___Train Local_Simple,  epoch 217, local model 36, internal_epoch   2,  Average loss: 0.0007, Accuracy: 990/1005 (98.5075%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.1855, Accuracy: 9441/10000 (94.4100%)
___Train Local_Simple,  epoch 217, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 217, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.0408, Accuracy: 9872/10000 (98.7200%)
poison local model 42 index 1
___Train Local_Simple,  epoch 217, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 217, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.0426, Accuracy: 9855/10000 (98.5500%)
___Train Local_Simple,  epoch 217, local model 47, internal_epoch   1,  Average loss: 0.0009, Accuracy: 764/776 (98.4536%)
___Train Local_Simple,  epoch 217, local model 47, internal_epoch   2,  Average loss: 0.0003, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.0920, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch 217, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 217, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.0780, Accuracy: 9775/10000 (97.7500%)
time spent on training: 42.713605880737305
Starting performing KrMLRFL...
Num data points: [835, 683, 433, 772, 429, 1005, 615, 236, 776, 431]
Num selected data points: [835 683 433 615 431]
The chosen ones are users: [0, 1, 2, 6, 9], which are global users: [31, 90, 83, 6, 80]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 42]
base_p: [ 3.2390282e-04  1.0216981e-04 -3.6121346e-05 ...  1.0923594e-03
  3.6614984e-03  1.0825172e-03]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 7, 8]
layer1_inf_time: 8.807861328125
[PAIRWISE] pred_attackers_indx:  [3 4 5 8]
layer2_inf_t: 587.172607421875
assumed final_attacker_idxs:  [3 4 5 7 8]
final_attacker_idxs is: [3 4 5 7 8]
g_attacker_idxs: [40 20 36 42 47]
g_normal_idxs: [31 90 83  6 80]
filtered_attacker_idxs: [3, 4, 5, 7, 8]
final_attacker_idxs are: [3, 4, 5, 7, 8]
num_dps: [835, 683, 433, 772, 429, 1005, 615, 236, 776, 431]
___Test Local_Simple poisoned: False, epoch: 217: Average loss: 0.0373, Accuracy: 9879/10000 (98.7900%)
epoch_acc: 98.79
___Test Local_Simple poisoned: True, epoch: 217: Average loss: 13.7779, Accuracy: 15/8968 (0.1673%)
Done in 76.97484707832336 sec.
Server Epoch:218 choose agents : [68, 34, 0, 92, 8, 50, 65, 75, 82, 54].
___Train Local_Simple,  epoch 218, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 218, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.0434, Accuracy: 9863/10000 (98.6300%)
poison local model 34 index 0
___Train Local_Simple,  epoch 218, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 218, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.0814, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch 218, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 430/435 (98.8506%)
___Train Local_Simple,  epoch 218, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.1145, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch 218, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch 218, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.3642, Accuracy: 8896/10000 (88.9600%)
___Train Local_Simple,  epoch 218, local model 8, internal_epoch   1,  Average loss: 0.0002, Accuracy: 631/633 (99.6840%)
___Train Local_Simple,  epoch 218, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.0504, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 218, local model 50, internal_epoch   1,  Average loss: 0.0003, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch 218, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.1151, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch 218, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 218, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.0461, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 218, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch 218, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 682/686 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.0728, Accuracy: 9759/10000 (97.5900%)
___Train Local_Simple,  epoch 218, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch 218, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.4921, Accuracy: 8907/10000 (89.0700%)
___Train Local_Simple,  epoch 218, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch 218, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.0541, Accuracy: 9840/10000 (98.4000%)
time spent on training: 39.64908766746521
Starting performing KrMLRFL...
Num data points: [494, 413, 435, 937, 633, 474, 371, 686, 713, 519]
Num selected data points: [494 435 633 474 371 686 519]
The chosen ones are users: [0, 2, 4, 5, 6, 7, 9], which are global users: [68, 0, 8, 50, 65, 75, 54]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34]
base_p: [ 0.00029919  0.00012849  0.00081006 ... -0.00253613 -0.00429513
 -0.00040092]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 7, 8]
layer1_inf_time: 3.737548828125
[PAIRWISE] pred_attackers_indx:  [1 2 3 6 7]
layer2_inf_t: 33.68994140625
assumed final_attacker_idxs:  [1 2 3 6 7 8]
final_attacker_idxs is: [1 2 3 6 7 8]
g_attacker_idxs: [34  0 92 65 75 82]
g_normal_idxs: [68  8 50 54]
filtered_attacker_idxs: [1, 3, 8]
final_attacker_idxs are: [1, 3, 8]
num_dps: [494, 413, 435, 937, 633, 474, 371, 686, 713, 519]
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: False, epoch: 218: Average loss: 0.0327, Accuracy: 9901/10000 (99.0100%)
___Test Local_Simple poisoned: True, epoch: 218: Average loss: 14.4388, Accuracy: 11/8968 (0.1227%)
Done in 44.69756865501404 sec.
Server Epoch:219 choose agents : [16, 69, 40, 54, 97, 67, 87, 35, 95, 39].
poison local model 16 index 0
___Train Local_Simple,  epoch 219, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 904/915 (98.7978%)
___Train Local_Simple,  epoch 219, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 911/915 (99.5628%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.1262, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch 219, local model 69, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 219, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.0871, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch 219, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 764/772 (98.9637%)
___Train Local_Simple,  epoch 219, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.1091, Accuracy: 9662/10000 (96.6200%)
___Train Local_Simple,  epoch 219, local model 54, internal_epoch   1,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch 219, local model 54, internal_epoch   2,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.0560, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 219, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 219, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.1165, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch 219, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 988/998 (98.9980%)
___Train Local_Simple,  epoch 219, local model 67, internal_epoch   2,  Average loss: 0.0008, Accuracy: 985/998 (98.6974%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.1942, Accuracy: 9310/10000 (93.1000%)
___Train Local_Simple,  epoch 219, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Train Local_Simple,  epoch 219, local model 87, internal_epoch   2,  Average loss: 0.0003, Accuracy: 467/470 (99.3617%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.0853, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch 219, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 219, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.0578, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch 219, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 219, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.1772, Accuracy: 9288/10000 (92.8800%)
___Train Local_Simple,  epoch 219, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 219, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.0408, Accuracy: 9863/10000 (98.6300%)
time spent on training: 45.318084716796875
Starting performing KrMLRFL...
Num data points: [915, 256, 772, 519, 487, 998, 470, 499, 602, 257]
Num selected data points: [256 519 487 470 499 257]
The chosen ones are users: [1, 3, 4, 6, 7, 9], which are global users: [69, 54, 97, 87, 35, 39]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16]
base_p: [ 0.00029588  0.00010269  0.00063413 ... -0.00097056  0.0015715
  0.00058341]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 8]
layer1_inf_time: 5.236083984375
[PAIRWISE] pred_attackers_indx:  [4 5 8]
layer2_inf_t: 237.904296875
assumed final_attacker_idxs:  [0 2 3 4 5 8]
final_attacker_idxs is: [0 2 3 4 5 8]
g_attacker_idxs: [16 40 54 97 67 95]
g_normal_idxs: [69 87 35 39]
filtered_attacker_idxs: [0, 2, 5, 8]
final_attacker_idxs are: [0, 2, 5, 8]
num_dps: [915, 256, 772, 519, 487, 998, 470, 499, 602, 257]
___Test Local_Simple poisoned: False, epoch: 219: Average loss: 0.0320, Accuracy: 9892/10000 (98.9200%)
epoch_acc: 98.92
___Test Local_Simple poisoned: True, epoch: 219: Average loss: 14.0215, Accuracy: 13/8968 (0.1450%)
Done in 51.85375714302063 sec.
Server Epoch:220 choose agents : [64, 98, 97, 90, 59, 47, 71, 42, 26, 3].
___Train Local_Simple,  epoch 220, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Train Local_Simple,  epoch 220, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.1704, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch 220, local model 98, internal_epoch   1,  Average loss: 0.0008, Accuracy: 802/818 (98.0440%)
___Train Local_Simple,  epoch 220, local model 98, internal_epoch   2,  Average loss: 0.0004, Accuracy: 813/818 (99.3888%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.3283, Accuracy: 9117/10000 (91.1700%)
___Train Local_Simple,  epoch 220, local model 97, internal_epoch   1,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 220, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.0375, Accuracy: 9867/10000 (98.6700%)
___Train Local_Simple,  epoch 220, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 220, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.0732, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch 220, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 220, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.2605, Accuracy: 9192/10000 (91.9200%)
___Train Local_Simple,  epoch 220, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 768/776 (98.9691%)
___Train Local_Simple,  epoch 220, local model 47, internal_epoch   2,  Average loss: 0.0002, Accuracy: 772/776 (99.4845%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.1102, Accuracy: 9667/10000 (96.6700%)
poison local model 71 index 0
___Train Local_Simple,  epoch 220, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1373/1384 (99.2052%)
___Train Local_Simple,  epoch 220, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1373/1384 (99.2052%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.1677, Accuracy: 9464/10000 (94.6400%)
poison local model 42 index 1
___Train Local_Simple,  epoch 220, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 220, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.0381, Accuracy: 9866/10000 (98.6600%)
poison local model 26 index 2
___Train Local_Simple,  epoch 220, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 220, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.0550, Accuracy: 9805/10000 (98.0500%)
___Train Local_Simple,  epoch 220, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 908/923 (98.3749%)
___Train Local_Simple,  epoch 220, local model 3, internal_epoch   2,  Average loss: 0.0004, Accuracy: 918/923 (99.4583%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 42, 26]
base_p: [ 1.6668811e-04  6.1215833e-05 -3.3919048e-04 ...  1.6532838e-03
 -2.8703734e-03  3.8770586e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 6, 8, 9]
layer1_inf_time: 3.3046875
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.2072, Accuracy: 9174/10000 (91.7400%)
time spent on training: 90.5430178642273
Starting performing KrMLRFL...
Num data points: [813, 818, 487, 683, 760, 776, 1384, 236, 554, 923]
Num selected data points: [813 487 683 236]
The chosen ones are users: [0, 2, 3, 7], which are global users: [64, 97, 90, 42]
___Test Local_Simple poisoned: False, epoch: 220: Average loss: 0.0348, Accuracy: 9892/10000 (98.9200%)
[PAIRWISE] pred_attackers_indx:  [0 1 6 9]
layer2_inf_t: 271.5625
assumed final_attacker_idxs:  [0 1 4 5 6 8 9]
final_attacker_idxs is: [0 1 4 5 6 8 9]
g_attacker_idxs: [64 98 59 47 71 26  3]
g_normal_idxs: [97 90 42]
filtered_attacker_idxs: [1, 4, 5, 6, 8, 9]
final_attacker_idxs are: [1, 4, 5, 6, 8, 9]
num_dps: [813, 818, 487, 683, 760, 776, 1384, 236, 554, 923]
epoch_acc: 98.92
___Test Local_Simple poisoned: True, epoch: 220: Average loss: 15.0543, Accuracy: 5/8968 (0.0558%)
Done in 96.05001831054688 sec.
Server Epoch:221 choose agents : [52, 95, 8, 33, 84, 12, 65, 88, 51, 29].
poison local model 52 index 0
___Train Local_Simple,  epoch 221, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch 221, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.1333, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch 221, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 221, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.5188, Accuracy: 8596/10000 (85.9600%)
___Train Local_Simple,  epoch 221, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Train Local_Simple,  epoch 221, local model 8, internal_epoch   2,  Average loss: 0.0000, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.0493, Accuracy: 9848/10000 (98.4800%)
___Train Local_Simple,  epoch 221, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 622/623 (99.8395%)
___Train Local_Simple,  epoch 221, local model 33, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.0619, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch 221, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1217/1246 (97.6726%)
___Train Local_Simple,  epoch 221, local model 84, internal_epoch   2,  Average loss: 0.0014, Accuracy: 1210/1246 (97.1108%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.0746, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch 221, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1135/1160 (97.8448%)
___Train Local_Simple,  epoch 221, local model 12, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1148/1160 (98.9655%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.3243, Accuracy: 9174/10000 (91.7400%)
___Train Local_Simple,  epoch 221, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 221, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.0526, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 221, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 221, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.0824, Accuracy: 9734/10000 (97.3400%)
poison local model 51 index 1
___Train Local_Simple,  epoch 221, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 221, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.1146, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch 221, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch 221, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.0526, Accuracy: 9824/10000 (98.2400%)
time spent on training: 43.903337240219116
Starting performing KrMLRFL...
Num data points: [253, 602, 633, 623, 1246, 1160, 371, 530, 568, 1002]
Num selected data points: [ 633  623  371  530 1002]
The chosen ones are users: [2, 3, 6, 7, 9], which are global users: [8, 33, 65, 88, 29]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 51]
base_p: [ 0.00025931  0.00015454 -0.00024693 ... -0.00036986 -0.00086844
  0.00222252]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 8]
layer1_inf_time: 4.45556640625
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 42.322265625
assumed final_attacker_idxs:  [0 1 4 5 8]
final_attacker_idxs is: [0 1 4 5 8]
g_attacker_idxs: [52 95 84 12 51]
g_normal_idxs: [ 8 33 65 88 29]
filtered_attacker_idxs: [0, 1, 4, 5, 8]
final_attacker_idxs are: [0, 1, 4, 5, 8]
num_dps: [253, 602, 633, 623, 1246, 1160, 371, 530, 568, 1002]
___Test Local_Simple poisoned: False, epoch: 221: Average loss: 0.0323, Accuracy: 9902/10000 (99.0200%)
epoch_acc: 99.02
___Test Local_Simple poisoned: True, epoch: 221: Average loss: 14.2554, Accuracy: 14/8968 (0.1561%)
Done in 49.39342427253723 sec.
Server Epoch:222 choose agents : [38, 97, 20, 34, 32, 37, 40, 93, 9, 87].
___Train Local_Simple,  epoch 222, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 894/895 (99.8883%)
___Train Local_Simple,  epoch 222, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.1143, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch 222, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 222, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.0510, Accuracy: 9832/10000 (98.3200%)
poison local model 20 index 0
___Train Local_Simple,  epoch 222, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 222, local model 20, internal_epoch   2,  Average loss: 0.0005, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.2139, Accuracy: 9393/10000 (93.9300%)
poison local model 34 index 1
___Train Local_Simple,  epoch 222, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 222, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.0818, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch 222, local model 32, internal_epoch   1,  Average loss: 0.0007, Accuracy: 965/977 (98.7718%)
___Train Local_Simple,  epoch 222, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 956/977 (97.8506%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.1364, Accuracy: 9578/10000 (95.7800%)
___Train Local_Simple,  epoch 222, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%)
___Train Local_Simple,  epoch 222, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 859/860 (99.8837%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.0927, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch 222, local model 40, internal_epoch   1,  Average loss: 0.0002, Accuracy: 768/772 (99.4819%)
___Train Local_Simple,  epoch 222, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 770/772 (99.7409%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.0745, Accuracy: 9748/10000 (97.4800%)
poison local model 93 index 2
___Train Local_Simple,  epoch 222, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%)
___Train Local_Simple,  epoch 222, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.2216, Accuracy: 9367/10000 (93.6700%)
___Train Local_Simple,  epoch 222, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 433/436 (99.3119%)
___Train Local_Simple,  epoch 222, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.0639, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 222, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch 222, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.0459, Accuracy: 9844/10000 (98.4400%)
time spent on training: 53.68770146369934
Starting performing KrMLRFL...
Num data points: [895, 487, 429, 413, 977, 860, 772, 623, 436, 470]
Num selected data points: [895 487 860 436 470]
The chosen ones are users: [0, 1, 5, 8, 9], which are global users: [38, 97, 37, 9, 87]
___Test Local_Simple poisoned: False, epoch: 222: Average loss: 0.0327, Accuracy: 9896/10000 (98.9600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 34, 93]
base_p: [ 0.00083179  0.00015102 -0.00028025 ... -0.00382838  0.00165427
  0.00080782]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 6, 7]
layer1_inf_time: 4.051025390625
[PAIRWISE] pred_attackers_indx:  [2 3 5 6 8 9]
layer2_inf_t: 29.13623046875
assumed final_attacker_idxs:  [2 3 4 5 6 7 8 9]
final_attacker_idxs is: [2 3 4 5 6 7 8 9]
g_attacker_idxs: [20 34 32 37 40 93  9 87]
g_normal_idxs: [38 97]
filtered_attacker_idxs: [2, 3, 4, 6, 7]
final_attacker_idxs are: [2, 3, 4, 6, 7]
num_dps: [895, 487, 429, 413, 977, 860, 772, 623, 436, 470]
epoch_acc: 98.96000000000001
___Test Local_Simple poisoned: True, epoch: 222: Average loss: 15.3458, Accuracy: 6/8968 (0.0669%)
Done in 62.22988033294678 sec.
Server Epoch:223 choose agents : [56, 66, 9, 22, 86, 82, 72, 34, 50, 12].
___Train Local_Simple,  epoch 223, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 879/880 (99.8864%)
___Train Local_Simple,  epoch 223, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.0365, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 223, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 647/660 (98.0303%)
___Train Local_Simple,  epoch 223, local model 66, internal_epoch   2,  Average loss: 0.0006, Accuracy: 651/660 (98.6364%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.6697, Accuracy: 8579/10000 (85.7900%)
___Train Local_Simple,  epoch 223, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 223, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.0449, Accuracy: 9853/10000 (98.5300%)
poison local model 22 index 0
___Train Local_Simple,  epoch 223, local model 22, internal_epoch   1,  Average loss: 0.0011, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 223, local model 22, internal_epoch   2,  Average loss: 0.0005, Accuracy: 575/583 (98.6278%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.1596, Accuracy: 9502/10000 (95.0200%)
___Train Local_Simple,  epoch 223, local model 86, internal_epoch   1,  Average loss: 0.0003, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 223, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.0679, Accuracy: 9803/10000 (98.0300%)
___Train Local_Simple,  epoch 223, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch 223, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.7009, Accuracy: 8769/10000 (87.6900%)
___Train Local_Simple,  epoch 223, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 223, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.0694, Accuracy: 9765/10000 (97.6500%)
poison local model 34 index 1
___Train Local_Simple,  epoch 223, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%)
___Train Local_Simple,  epoch 223, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.0689, Accuracy: 9785/10000 (97.8500%)
___Train Local_Simple,  epoch 223, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%)
___Train Local_Simple,  epoch 223, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.2337, Accuracy: 9364/10000 (93.6400%)
___Train Local_Simple,  epoch 223, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1141/1160 (98.3621%)
___Train Local_Simple,  epoch 223, local model 12, internal_epoch   2,  Average loss: 0.0024, Accuracy: 1128/1160 (97.2414%)
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.3336, Accuracy: 8914/10000 (89.1400%)
time spent on training: 40.744757890701294
Starting performing KrMLRFL...
Num data points: [880, 660, 436, 583, 250, 713, 731, 413, 474, 1160]
Num selected data points: [880 436 250 731 474]
The chosen ones are users: [0, 2, 4, 6, 8], which are global users: [56, 9, 86, 72, 50]
___Test Local_Simple poisoned: False, epoch: 223: Average loss: 0.0329, Accuracy: 9891/10000 (98.9100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 34]
base_p: [-0.00015217  0.00021559 -0.0016061  ... -0.00209606 -0.00276259
 -0.00055413]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 7, 9]
layer1_inf_time: 3.28173828125
[PAIRWISE] pred_attackers_indx:  [1 5 6 8]
layer2_inf_t: 38.618408203125
assumed final_attacker_idxs:  [1 3 5 6 7 8 9]
final_attacker_idxs is: [1 3 5 6 7 8 9]
g_attacker_idxs: [66 22 82 72 34 50 12]
g_normal_idxs: [56  9 86]
filtered_attacker_idxs: [1, 3, 5, 7, 9]
final_attacker_idxs are: [1, 3, 5, 7, 9]
num_dps: [880, 660, 436, 583, 250, 713, 731, 413, 474, 1160]
epoch_acc: 98.91
___Test Local_Simple poisoned: True, epoch: 223: Average loss: 15.5219, Accuracy: 4/8968 (0.0446%)
Done in 46.111353397369385 sec.
Server Epoch:224 choose agents : [45, 52, 13, 91, 90, 80, 42, 34, 86, 78].
poison local model 45 index 0
___Train Local_Simple,  epoch 224, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 621/628 (98.8854%)
___Train Local_Simple,  epoch 224, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.1410, Accuracy: 9584/10000 (95.8400%)
poison local model 52 index 1
___Train Local_Simple,  epoch 224, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 224, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.1716, Accuracy: 9554/10000 (95.5400%)
poison local model 13 index 2
___Train Local_Simple,  epoch 224, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 730/734 (99.4550%)
___Train Local_Simple,  epoch 224, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.1514, Accuracy: 9532/10000 (95.3200%)
poison local model 91 index 3
___Train Local_Simple,  epoch 224, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 224, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.0435, Accuracy: 9874/10000 (98.7400%)
___Train Local_Simple,  epoch 224, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 680/683 (99.5608%)
___Train Local_Simple,  epoch 224, local model 90, internal_epoch   2,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.1112, Accuracy: 9672/10000 (96.7200%)
___Train Local_Simple,  epoch 224, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 224, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.0537, Accuracy: 9839/10000 (98.3900%)
poison local model 42 index 0
___Train Local_Simple,  epoch 224, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 224, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.0514, Accuracy: 9832/10000 (98.3200%)
poison local model 34 index 1
___Train Local_Simple,  epoch 224, local model 34, internal_epoch   1,  Average loss: 0.0003, Accuracy: 408/413 (98.7893%)
___Train Local_Simple,  epoch 224, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.1766, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch 224, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Train Local_Simple,  epoch 224, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.0512, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 224, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 224, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.0987, Accuracy: 9682/10000 (96.8200%)
time spent on training: 60.07736611366272
Starting performing KrMLRFL...
Num data points: [628, 253, 734, 256, 683, 431, 236, 413, 250, 303]
Num selected data points: [256 683 431 250 303]
The chosen ones are users: [3, 4, 5, 8, 9], which are global users: [91, 90, 80, 86, 78]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 52, 13, 91, 42, 34]
base_p: [ 1.8478185e-04  8.8140368e-06  3.0267425e-04 ... -1.4230758e-03
  3.7401915e-05  2.5885552e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 7]
layer1_inf_time: 3.4990234375
[PAIRWISE] pred_attackers_indx:  [2 4 6 7 9]
layer2_inf_t: 40.31298828125
assumed final_attacker_idxs:  [0 1 2 4 6 7 9]
final_attacker_idxs is: [0 1 2 4 6 7 9]
g_attacker_idxs: [45 52 13 90 42 34 78]
g_normal_idxs: [91 80 86]
filtered_attacker_idxs: [0, 1, 2, 6, 7]
final_attacker_idxs are: [0, 1, 2, 6, 7]
num_dps: [628, 253, 734, 256, 683, 431, 236, 413, 250, 303]
___Test Local_Simple poisoned: False, epoch: 224: Average loss: 0.0340, Accuracy: 9889/10000 (98.8900%)
epoch_acc: 98.89
___Test Local_Simple poisoned: True, epoch: 224: Average loss: 15.0682, Accuracy: 5/8968 (0.0558%)
Done in 66.71210789680481 sec.
Server Epoch:225 choose agents : [62, 4, 86, 53, 70, 58, 75, 7, 88, 63].
___Train Local_Simple,  epoch 225, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch 225, local model 62, internal_epoch   2,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.0557, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 225, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 650/658 (98.7842%)
___Train Local_Simple,  epoch 225, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.2785, Accuracy: 9224/10000 (92.2400%)
___Train Local_Simple,  epoch 225, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Train Local_Simple,  epoch 225, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.0381, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 225, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 225, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.1900, Accuracy: 9441/10000 (94.4100%)
poison local model 70 index 0
___Train Local_Simple,  epoch 225, local model 70, internal_epoch   1,  Average loss: 0.0009, Accuracy: 706/724 (97.5138%)
___Train Local_Simple,  epoch 225, local model 70, internal_epoch   2,  Average loss: 0.0014, Accuracy: 702/724 (96.9613%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.3124, Accuracy: 9037/10000 (90.3700%)
___Train Local_Simple,  epoch 225, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 275/276 (99.6377%)
___Train Local_Simple,  epoch 225, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 275/276 (99.6377%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.3586, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch 225, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Train Local_Simple,  epoch 225, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.0467, Accuracy: 9855/10000 (98.5500%)
poison local model 7 index 1
___Train Local_Simple,  epoch 225, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 412/418 (98.5646%)
___Train Local_Simple,  epoch 225, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.1323, Accuracy: 9618/10000 (96.1800%)
___Train Local_Simple,  epoch 225, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 225, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.0555, Accuracy: 9826/10000 (98.2600%)
poison local model 63 index 2
___Train Local_Simple,  epoch 225, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 873/889 (98.2002%)
___Train Local_Simple,  epoch 225, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 880/889 (98.9876%)
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.0693, Accuracy: 9790/10000 (97.9000%)
time spent on training: 49.61977529525757
Starting performing KrMLRFL...
Num data points: [423, 658, 250, 739, 724, 276, 686, 418, 530, 889]
Num selected data points: [423 250 276 686 530]
The chosen ones are users: [0, 2, 5, 6, 8], which are global users: [62, 86, 58, 75, 88]
___Test Local_Simple poisoned: False, epoch: 225: Average loss: 0.0319, Accuracy: 9892/10000 (98.9200%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 7, 63]
base_p: [ 0.00126018  0.00022777 -0.0005871  ...  0.00079349 -0.00318205
  0.00372285]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 7, 9]
layer1_inf_time: 3.062255859375
[PAIRWISE] pred_attackers_indx:  [4 7 9]
layer2_inf_t: 30.23046875
assumed final_attacker_idxs:  [1 3 4 7 9]
final_attacker_idxs is: [1 3 4 7 9]
g_attacker_idxs: [ 4 53 70  7 63]
g_normal_idxs: [62 86 58 75 88]
filtered_attacker_idxs: [1, 3, 4, 7, 9]
final_attacker_idxs are: [1, 3, 4, 7, 9]
num_dps: [423, 658, 250, 739, 724, 276, 686, 418, 530, 889]
epoch_acc: 98.92
___Test Local_Simple poisoned: True, epoch: 225: Average loss: 14.4348, Accuracy: 17/8968 (0.1896%)
Done in 54.96794056892395 sec.
Server Epoch:226 choose agents : [99, 44, 5, 26, 23, 49, 22, 20, 65, 14].
___Train Local_Simple,  epoch 226, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch 226, local model 99, internal_epoch   2,  Average loss: 0.0000, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.0344, Accuracy: 9889/10000 (98.8900%)
___Train Local_Simple,  epoch 226, local model 44, internal_epoch   1,  Average loss: 0.0007, Accuracy: 510/517 (98.6460%)
___Train Local_Simple,  epoch 226, local model 44, internal_epoch   2,  Average loss: 0.0037, Accuracy: 487/517 (94.1973%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.1471, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch 226, local model 5, internal_epoch   1,  Average loss: 0.0005, Accuracy: 431/434 (99.3088%)
___Train Local_Simple,  epoch 226, local model 5, internal_epoch   2,  Average loss: 0.0007, Accuracy: 432/434 (99.5392%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.2693, Accuracy: 9093/10000 (90.9300%)
poison local model 26 index 0
___Train Local_Simple,  epoch 226, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 226, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.0823, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch 226, local model 23, internal_epoch   1,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch 226, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.0471, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 226, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Train Local_Simple,  epoch 226, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.0565, Accuracy: 9811/10000 (98.1100%)
poison local model 22 index 1
___Train Local_Simple,  epoch 226, local model 22, internal_epoch   1,  Average loss: 0.0010, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 226, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.1000, Accuracy: 9687/10000 (96.8700%)
poison local model 20 index 2
___Train Local_Simple,  epoch 226, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 226, local model 20, internal_epoch   2,  Average loss: 0.0007, Accuracy: 425/429 (99.0676%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.3104, Accuracy: 9257/10000 (92.5700%)
___Train Local_Simple,  epoch 226, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 226, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.0397, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 226, local model 14, internal_epoch   1,  Average loss: 0.0002, Accuracy: 375/376 (99.7340%)
___Train Local_Simple,  epoch 226, local model 14, internal_epoch   2,  Average loss: 0.0000, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.0865, Accuracy: 9769/10000 (97.6900%)
time spent on training: 47.46765995025635
Starting performing KrMLRFL...
Num data points: [377, 517, 434, 554, 293, 506, 583, 429, 371, 376]
Num selected data points: [377 517 434 293 371 376]
The chosen ones are users: [0, 1, 2, 4, 8, 9], which are global users: [99, 44, 5, 23, 65, 14]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 22, 20]
base_p: [-8.8587403e-06  1.1113845e-04  3.5999343e-05 ... -1.1577010e-03
  1.1763200e-03  2.0732880e-03]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 6, 7]
layer1_inf_time: 4.324951171875
[PAIRWISE] pred_attackers_indx:  [1 3 6 7]
layer2_inf_t: 52.51025390625
assumed final_attacker_idxs:  [1 3 5 6 7]
final_attacker_idxs is: [1 3 5 6 7]
g_attacker_idxs: [44 26 49 22 20]
g_normal_idxs: [99  5 23 65 14]
filtered_attacker_idxs: [3, 5, 6, 7]
final_attacker_idxs are: [3, 5, 6, 7]
num_dps: [377, 517, 434, 554, 293, 506, 583, 429, 371, 376]
___Test Local_Simple poisoned: False, epoch: 226: Average loss: 0.0391, Accuracy: 9886/10000 (98.8600%)
epoch_acc: 98.86
___Test Local_Simple poisoned: True, epoch: 226: Average loss: 12.6017, Accuracy: 16/8968 (0.1784%)
Done in 54.07424521446228 sec.
Server Epoch:227 choose agents : [38, 36, 89, 77, 21, 33, 72, 49, 7, 92].
___Train Local_Simple,  epoch 227, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 893/895 (99.7765%)
___Train Local_Simple,  epoch 227, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.0771, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch 227, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 991/1005 (98.6070%)
___Train Local_Simple,  epoch 227, local model 36, internal_epoch   2,  Average loss: 0.0006, Accuracy: 992/1005 (98.7065%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.2971, Accuracy: 9150/10000 (91.5000%)
___Train Local_Simple,  epoch 227, local model 89, internal_epoch   1,  Average loss: 0.0003, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch 227, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.0848, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch 227, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 582/589 (98.8115%)
___Train Local_Simple,  epoch 227, local model 77, internal_epoch   2,  Average loss: 0.0007, Accuracy: 583/589 (98.9813%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.0766, Accuracy: 9773/10000 (97.7300%)
___Train Local_Simple,  epoch 227, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 309/312 (99.0385%)
___Train Local_Simple,  epoch 227, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.1326, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch 227, local model 33, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 227, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.0784, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch 227, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 227, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.0606, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 227, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 227, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.0615, Accuracy: 9805/10000 (98.0500%)
poison local model 7 index 0
___Train Local_Simple,  epoch 227, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 227, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.2168, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch 227, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 929/937 (99.1462%)
___Train Local_Simple,  epoch 227, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 929/937 (99.1462%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7]
base_p: [ 1.12030655e-04  8.43685120e-05  4.26099636e-04 ... -1.92341208e-03
 -4.28677350e-03 -1.35391206e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 8, 9]
layer1_inf_time: 3.110595703125
[PAIRWISE] pred_attackers_indx:  [1 2 3 5 7 8]
layer2_inf_t: 31.42529296875
assumed final_attacker_idxs:  [0 1 2 3 5 7 8 9]
final_attacker_idxs is: [0 1 2 3 5 7 8 9]
g_attacker_idxs: [38 36 89 77 33 49  7 92]
g_normal_idxs: [21 72]
filtered_attacker_idxs: [1, 3, 7, 8, 9]
final_attacker_idxs are: [1, 3, 7, 8, 9]
num_dps: [895, 1005, 492, 589, 312, 623, 731, 506, 418, 937]
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.1833, Accuracy: 9391/10000 (93.9100%)
time spent on training: 36.02584409713745
Starting performing KrMLRFL...
Num data points: [895, 1005, 492, 589, 312, 623, 731, 506, 418, 937]
Num selected data points: [895 492 312 623 731]
The chosen ones are users: [0, 2, 4, 5, 6], which are global users: [38, 89, 21, 33, 72]
epoch_acc: 98.7
___Test Local_Simple poisoned: False, epoch: 227: Average loss: 0.0362, Accuracy: 9870/10000 (98.7000%)
___Test Local_Simple poisoned: True, epoch: 227: Average loss: 14.7713, Accuracy: 4/8968 (0.0446%)
Done in 43.836469650268555 sec.
Server Epoch:228 choose agents : [42, 28, 87, 44, 0, 5, 7, 43, 67, 10].
poison local model 42 index 0
___Train Local_Simple,  epoch 228, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 228, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.0516, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch 228, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 228, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.0514, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 228, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Train Local_Simple,  epoch 228, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 467/470 (99.3617%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.0606, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch 228, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%)
___Train Local_Simple,  epoch 228, local model 44, internal_epoch   2,  Average loss: 0.0001, Accuracy: 516/517 (99.8066%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.0501, Accuracy: 9832/10000 (98.3200%)
___Train Local_Simple,  epoch 228, local model 0, internal_epoch   1,  Average loss: 0.0004, Accuracy: 428/435 (98.3908%)
___Train Local_Simple,  epoch 228, local model 0, internal_epoch   2,  Average loss: 0.0005, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.1155, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch 228, local model 5, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/434 (99.3088%)
___Train Local_Simple,  epoch 228, local model 5, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.1117, Accuracy: 9584/10000 (95.8400%)
poison local model 7 index 1
___Train Local_Simple,  epoch 228, local model 7, internal_epoch   1,  Average loss: 0.0007, Accuracy: 409/418 (97.8469%)
___Train Local_Simple,  epoch 228, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 418/418 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.1238, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch 228, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 228, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.0402, Accuracy: 9870/10000 (98.7000%)
___Train Local_Simple,  epoch 228, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 989/998 (99.0982%)
___Train Local_Simple,  epoch 228, local model 67, internal_epoch   2,  Average loss: 0.0004, Accuracy: 989/998 (99.0982%)
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.0901, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch 228, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Train Local_Simple,  epoch 228, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 7]
base_p: [ 4.6327710e-05  1.7264858e-04 -5.6517310e-05 ... -7.4771047e-04
 -1.6604364e-04 -8.3630532e-04]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 8]
layer1_inf_time: 5.89111328125
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.1011, Accuracy: 9667/10000 (96.6700%)
time spent on training: 44.639477252960205
Starting performing KrMLRFL...
[PAIRWISE] pred_attackers_indx:  [3 4 6 7 8]
layer2_inf_t: 452.916748046875
assumed final_attacker_idxs:  [0 3 4 6 7 8]
final_attacker_idxs is: [0 3 4 6 7 8]
g_attacker_idxs: [42 44  0  7 43 67]
g_normal_idxs: [28 87  5 10]
filtered_attacker_idxs: [0, 6, 8]
final_attacker_idxs are: [0, 6, 8]
num_dps: [236, 501, 470, 517, 435, 434, 418, 408, 998, 892]
epoch_acc: 98.92999999999999
Num data points: [236, 501, 470, 517, 435, 434, 418, 408, 998, 892]
Num selected data points: [501 470 517 435 434 408 892]
The chosen ones are users: [1, 2, 3, 4, 5, 7, 9], which are global users: [28, 87, 44, 0, 5, 43, 10]
___Test Local_Simple poisoned: False, epoch: 228: Average loss: 0.0335, Accuracy: 9893/10000 (98.9300%)
___Test Local_Simple poisoned: True, epoch: 228: Average loss: 14.1634, Accuracy: 7/8968 (0.0781%)
Done in 63.16251754760742 sec.
Server Epoch:229 choose agents : [18, 41, 12, 84, 93, 37, 49, 48, 86, 98].
___Train Local_Simple,  epoch 229, local model 18, internal_epoch   1,  Average loss: 0.0007, Accuracy: 454/459 (98.9107%)
___Train Local_Simple,  epoch 229, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.2971, Accuracy: 9303/10000 (93.0300%)
___Train Local_Simple,  epoch 229, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 603/606 (99.5050%)
___Train Local_Simple,  epoch 229, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.0675, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch 229, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1143/1160 (98.5345%)
___Train Local_Simple,  epoch 229, local model 12, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1139/1160 (98.1897%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.2228, Accuracy: 9434/10000 (94.3400%)
___Train Local_Simple,  epoch 229, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1230/1246 (98.7159%)
___Train Local_Simple,  epoch 229, local model 84, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1240/1246 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.0724, Accuracy: 9773/10000 (97.7300%)
poison local model 93 index 0
___Train Local_Simple,  epoch 229, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%)
___Train Local_Simple,  epoch 229, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.2399, Accuracy: 9317/10000 (93.1700%)
___Train Local_Simple,  epoch 229, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch 229, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.1143, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch 229, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 229, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.0635, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch 229, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 444/448 (99.1071%)
___Train Local_Simple,  epoch 229, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.0555, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 229, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 229, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.0623, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 229, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 807/818 (98.6553%)
___Train Local_Simple,  epoch 229, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 812/818 (99.2665%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93]
base_p: [ 3.8233772e-04  3.8301572e-05  3.3044536e-04 ... -4.6143681e-03
 -2.7996302e-03  2.4179891e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 9]
layer1_inf_time: 3.27099609375
[PAIRWISE] pred_attackers_indx:  [0 3 4 9]
layer2_inf_t: 146.32958984375
assumed final_attacker_idxs:  [0 2 3 4 9]
final_attacker_idxs is: [0 2 3 4 9]
g_attacker_idxs: [18 12 84 93 98]
g_normal_idxs: [41 37 49 48 86]
filtered_attacker_idxs: [2, 3, 4, 9]
final_attacker_idxs are: [2, 3, 4, 9]
num_dps: [459, 606, 1160, 1246, 623, 860, 506, 448, 250, 818]
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.1471, Accuracy: 9523/10000 (95.2300%)
time spent on training: 36.84202337265015
Starting performing KrMLRFL...
Num data points: [459, 606, 1160, 1246, 623, 860, 506, 448, 250, 818]
Num selected data points: [459 606 860 506 448 250]
The chosen ones are users: [0, 1, 5, 6, 7, 8], which are global users: [18, 41, 37, 49, 48, 86]
epoch_acc: 98.65
___Test Local_Simple poisoned: False, epoch: 229: Average loss: 0.0398, Accuracy: 9865/10000 (98.6500%)
___Test Local_Simple poisoned: True, epoch: 229: Average loss: 13.0425, Accuracy: 27/8968 (0.3011%)
Done in 45.88697361946106 sec.
Server Epoch:230 choose agents : [90, 82, 11, 36, 21, 81, 22, 6, 18, 14].
___Train Local_Simple,  epoch 230, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Train Local_Simple,  epoch 230, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.8696, Accuracy: 8561/10000 (85.6100%)
___Train Local_Simple,  epoch 230, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch 230, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.8021, Accuracy: 8776/10000 (87.7600%)
poison local model 11 index 0
___Train Local_Simple,  epoch 230, local model 11, internal_epoch   1,  Average loss: 0.0016, Accuracy: 636/645 (98.6047%)
___Train Local_Simple,  epoch 230, local model 11, internal_epoch   2,  Average loss: 0.0076, Accuracy: 573/645 (88.8372%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.3781, Accuracy: 8834/10000 (88.3400%)
___Train Local_Simple,  epoch 230, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 996/1005 (99.1045%)
___Train Local_Simple,  epoch 230, local model 36, internal_epoch   2,  Average loss: 0.0008, Accuracy: 994/1005 (98.9055%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.3094, Accuracy: 9109/10000 (91.0900%)
___Train Local_Simple,  epoch 230, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch 230, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.0995, Accuracy: 9692/10000 (96.9200%)
poison local model 81 index 1
___Train Local_Simple,  epoch 230, local model 81, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1215/1227 (99.0220%)
___Train Local_Simple,  epoch 230, local model 81, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1221/1227 (99.5110%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.1884, Accuracy: 9431/10000 (94.3100%)
poison local model 22 index 2
___Train Local_Simple,  epoch 230, local model 22, internal_epoch   1,  Average loss: 0.0010, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 230, local model 22, internal_epoch   2,  Average loss: 0.0026, Accuracy: 566/583 (97.0840%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.4077, Accuracy: 8652/10000 (86.5200%)
___Train Local_Simple,  epoch 230, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 612/615 (99.5122%)
___Train Local_Simple,  epoch 230, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.0832, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch 230, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 457/459 (99.5643%)
___Train Local_Simple,  epoch 230, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.0812, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch 230, local model 14, internal_epoch   1,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Train Local_Simple,  epoch 230, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 81, 22]
base_p: [ 9.2506409e-05  9.4508752e-05  1.1423500e-03 ... -1.7715842e-03
 -2.4343282e-04  1.2110993e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 5, 6]
layer1_inf_time: 3.517578125
[PAIRWISE] pred_attackers_indx:  [2 3 5 6]
layer2_inf_t: 30.79736328125
assumed final_attacker_idxs:  [1 2 3 5 6]
final_attacker_idxs is: [1 2 3 5 6]
g_attacker_idxs: [82 11 36 81 22]
g_normal_idxs: [90 21  6 18 14]
filtered_attacker_idxs: [1, 2, 3, 5, 6]
final_attacker_idxs are: [1, 2, 3, 5, 6]
num_dps: [683, 713, 645, 1005, 312, 1227, 583, 615, 459, 376]
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.0423, Accuracy: 9863/10000 (98.6300%)
time spent on training: 48.6893424987793
Starting performing KrMLRFL...
Num data points: [683, 713, 645, 1005, 312, 1227, 583, 615, 459, 376]
Num selected data points: [683 312 615 459 376]
The chosen ones are users: [0, 4, 7, 8, 9], which are global users: [90, 21, 6, 18, 14]
___Test Local_Simple poisoned: False, epoch: 230: Average loss: 0.0427, Accuracy: 9863/10000 (98.6300%)
epoch_acc: 98.63
___Test Local_Simple poisoned: True, epoch: 230: Average loss: 13.8321, Accuracy: 10/8968 (0.1115%)
Done in 55.19332504272461 sec.
Server Epoch:231 choose agents : [41, 73, 31, 23, 82, 30, 72, 69, 18, 78].
___Train Local_Simple,  epoch 231, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 602/606 (99.3399%)
___Train Local_Simple,  epoch 231, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.1643, Accuracy: 9472/10000 (94.7200%)
poison local model 73 index 0
___Train Local_Simple,  epoch 231, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/591 (98.6464%)
___Train Local_Simple,  epoch 231, local model 73, internal_epoch   2,  Average loss: 0.0006, Accuracy: 585/591 (98.9848%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.1054, Accuracy: 9694/10000 (96.9400%)
___Train Local_Simple,  epoch 231, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 832/835 (99.6407%)
___Train Local_Simple,  epoch 231, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.0640, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 231, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 231, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.0510, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 231, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch 231, local model 82, internal_epoch   2,  Average loss: 0.0017, Accuracy: 695/713 (97.4755%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.6210, Accuracy: 8338/10000 (83.3800%)
___Train Local_Simple,  epoch 231, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch 231, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.0905, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch 231, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 231, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 729/731 (99.7264%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.0473, Accuracy: 9850/10000 (98.5000%)
___Train Local_Simple,  epoch 231, local model 69, internal_epoch   1,  Average loss: 0.0003, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 231, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.1173, Accuracy: 9597/10000 (95.9700%)
___Train Local_Simple,  epoch 231, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 458/459 (99.7821%)
___Train Local_Simple,  epoch 231, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.0553, Accuracy: 9832/10000 (98.3200%)
___Train Local_Simple,  epoch 231, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 231, local model 78, internal_epoch   2,  Average loss: 0.0003, Accuracy: 302/303 (99.6700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73]
base_p: [-3.5256892e-04  6.1510131e-05  1.1048298e-03 ... -8.2433224e-05
 -3.4951419e-03 -1.2427568e-05]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 6, 8]
layer1_inf_time: 3.726318359375
[PAIRWISE] pred_attackers_indx:  [0 8 9]
layer2_inf_t: 28.771240234375
assumed final_attacker_idxs:  [0 1 4 6 8 9]
final_attacker_idxs is: [0 1 4 6 8 9]
g_attacker_idxs: [41 73 82 72 18 78]
g_normal_idxs: [31 23 30 69]
filtered_attacker_idxs: [0, 1, 4]
final_attacker_idxs are: [0, 1, 4]
num_dps: [606, 591, 835, 293, 713, 400, 731, 256, 459, 303]
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.1597, Accuracy: 9501/10000 (95.0100%)
time spent on training: 35.979989767074585
Starting performing KrMLRFL...
Num data points: [606, 591, 835, 293, 713, 400, 731, 256, 459, 303]
Num selected data points: [835 293 400 731 256 459 303]
The chosen ones are users: [2, 3, 5, 6, 7, 8, 9], which are global users: [31, 23, 30, 72, 69, 18, 78]
epoch_acc: 98.98
___Test Local_Simple poisoned: False, epoch: 231: Average loss: 0.0333, Accuracy: 9898/10000 (98.9800%)
___Test Local_Simple poisoned: True, epoch: 231: Average loss: 14.2876, Accuracy: 11/8968 (0.1227%)
Done in 57.664379596710205 sec.
Server Epoch:232 choose agents : [0, 38, 16, 55, 63, 32, 15, 46, 99, 90].
___Train Local_Simple,  epoch 232, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Train Local_Simple,  epoch 232, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.0566, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 232, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%)
___Train Local_Simple,  epoch 232, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 894/895 (99.8883%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.0484, Accuracy: 9846/10000 (98.4600%)
poison local model 16 index 0
___Train Local_Simple,  epoch 232, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 906/915 (99.0164%)
___Train Local_Simple,  epoch 232, local model 16, internal_epoch   2,  Average loss: 0.0003, Accuracy: 909/915 (99.3443%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.0648, Accuracy: 9790/10000 (97.9000%)
___Train Local_Simple,  epoch 232, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 232, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.2343, Accuracy: 9325/10000 (93.2500%)
poison local model 63 index 1
___Train Local_Simple,  epoch 232, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 872/889 (98.0877%)
___Train Local_Simple,  epoch 232, local model 63, internal_epoch   2,  Average loss: 0.0005, Accuracy: 882/889 (99.2126%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.1960, Accuracy: 9428/10000 (94.2800%)
___Train Local_Simple,  epoch 232, local model 32, internal_epoch   1,  Average loss: 0.0008, Accuracy: 964/977 (98.6694%)
___Train Local_Simple,  epoch 232, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 968/977 (99.0788%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.1176, Accuracy: 9612/10000 (96.1200%)
___Train Local_Simple,  epoch 232, local model 15, internal_epoch   1,  Average loss: 0.0003, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch 232, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.0639, Accuracy: 9791/10000 (97.9100%)
___Train Local_Simple,  epoch 232, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 694/710 (97.7465%)
___Train Local_Simple,  epoch 232, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 700/710 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.7594, Accuracy: 8160/10000 (81.6000%)
___Train Local_Simple,  epoch 232, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Train Local_Simple,  epoch 232, local model 99, internal_epoch   2,  Average loss: 0.0000, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.0357, Accuracy: 9886/10000 (98.8600%)
___Train Local_Simple,  epoch 232, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
type of model <class 'models.MnistNet.MnistNet'>
___Train Local_Simple,  epoch 232, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.0515, Accuracy: 9837/10000 (98.3700%)
time spent on training: 49.01627445220947
Starting performing KrMLRFL...
Num data points: [435, 895, 915, 354, 889, 977, 401, 710, 377, 683]
Num selected data points: [435 895 354 401 377 683]
The chosen ones are users: [0, 1, 3, 6, 8, 9], which are global users: [0, 38, 55, 15, 99, 90]
selected_attackers: [16, 63]
base_p: [ 1.3989732e-03  8.2198530e-05 -2.2055116e-04 ...  2.1331906e-03
  2.2743121e-03 -5.8463961e-04]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 7]
layer1_inf_time: 3.83447265625
[PAIRWISE] pred_attackers_indx:  [2 3 4 5 7]
layer2_inf_t: 31.74169921875
assumed final_attacker_idxs:  [2 3 4 5 7]
final_attacker_idxs is: [2 3 4 5 7]
g_attacker_idxs: [16 55 63 32 46]
g_normal_idxs: [ 0 38 15 99 90]
filtered_attacker_idxs: [2, 4, 5, 7]
final_attacker_idxs are: [2, 4, 5, 7]
num_dps: [435, 895, 915, 354, 889, 977, 401, 710, 377, 683]
epoch_acc: 99.02
___Test Local_Simple poisoned: False, epoch: 232: Average loss: 0.0321, Accuracy: 9902/10000 (99.0200%)
___Test Local_Simple poisoned: True, epoch: 232: Average loss: 15.0976, Accuracy: 3/8968 (0.0335%)
Done in 54.44896388053894 sec.
Server Epoch:233 choose agents : [45, 13, 4, 88, 65, 71, 64, 36, 48, 43].
poison local model 45 index 0
___Train Local_Simple,  epoch 233, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 616/628 (98.0892%)
___Train Local_Simple,  epoch 233, local model 45, internal_epoch   2,  Average loss: 0.0002, Accuracy: 625/628 (99.5223%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.2522, Accuracy: 9299/10000 (92.9900%)
poison local model 13 index 1
___Train Local_Simple,  epoch 233, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 730/734 (99.4550%)
___Train Local_Simple,  epoch 233, local model 13, internal_epoch   2,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.0648, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 233, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 651/658 (98.9362%)
___Train Local_Simple,  epoch 233, local model 4, internal_epoch   2,  Average loss: 0.0006, Accuracy: 651/658 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.9209, Accuracy: 8640/10000 (86.4000%)
___Train Local_Simple,  epoch 233, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 233, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.0773, Accuracy: 9764/10000 (97.6400%)
___Train Local_Simple,  epoch 233, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 233, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.0785, Accuracy: 9776/10000 (97.7600%)
poison local model 71 index 2
___Train Local_Simple,  epoch 233, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1367/1384 (98.7717%)
___Train Local_Simple,  epoch 233, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1375/1384 (99.3497%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.2524, Accuracy: 9166/10000 (91.6600%)
___Train Local_Simple,  epoch 233, local model 64, internal_epoch   1,  Average loss: 0.0002, Accuracy: 811/813 (99.7540%)
___Train Local_Simple,  epoch 233, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.1067, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch 233, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 991/1005 (98.6070%)
___Train Local_Simple,  epoch 233, local model 36, internal_epoch   2,  Average loss: 0.0006, Accuracy: 992/1005 (98.7065%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.1930, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch 233, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch 233, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.0821, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch 233, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 233, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.0446, Accuracy: 9850/10000 (98.5000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 13, 71]
base_p: [ 8.0592930e-05 -9.0714544e-05  3.8908469e-04 ... -2.1249503e-03
 -2.8039217e-03 -3.8950890e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6, 7]
layer1_inf_time: 4.8486328125
[PAIRWISE] pred_attackers_indx:  [0 1 2 5 6 7]
layer2_inf_t: 227.906005859375
assumed final_attacker_idxs:  [0 1 2 5 6 7]
final_attacker_idxs is: [0 1 2 5 6 7]
g_attacker_idxs: [45 13  4 71 64 36]
g_normal_idxs: [88 65 48 43]
filtered_attacker_idxs: [0, 1, 2, 5, 7]
final_attacker_idxs are: [0, 1, 2, 5, 7]
num_dps: [628, 734, 658, 530, 371, 1384, 813, 1005, 448, 408]
time spent on training: 45.15530848503113
Starting performing KrMLRFL...
Num data points: [628, 734, 658, 530, 371, 1384, 813, 1005, 448, 408]
Num selected data points: [530 371 813 448 408]
The chosen ones are users: [3, 4, 6, 8, 9], which are global users: [88, 65, 64, 48, 43]
___Test Local_Simple poisoned: False, epoch: 233: Average loss: 0.0363, Accuracy: 9892/10000 (98.9200%)
epoch_acc: 98.92
___Test Local_Simple poisoned: True, epoch: 233: Average loss: 14.8265, Accuracy: 12/8968 (0.1338%)
Done in 53.15092968940735 sec.
Server Epoch:234 choose agents : [19, 52, 83, 61, 46, 66, 76, 26, 87, 65].
___Train Local_Simple,  epoch 234, local model 19, internal_epoch   1,  Average loss: 0.0005, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 234, local model 19, internal_epoch   2,  Average loss: 0.0007, Accuracy: 204/205 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.2026, Accuracy: 9548/10000 (95.4800%)
poison local model 52 index 0
___Train Local_Simple,  epoch 234, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch 234, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.1923, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch 234, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 429/433 (99.0762%)
___Train Local_Simple,  epoch 234, local model 83, internal_epoch   2,  Average loss: 0.0003, Accuracy: 431/433 (99.5381%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.0666, Accuracy: 9792/10000 (97.9200%)
poison local model 61 index 1
___Train Local_Simple,  epoch 234, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 690/699 (98.7124%)
___Train Local_Simple,  epoch 234, local model 61, internal_epoch   2,  Average loss: 0.0005, Accuracy: 691/699 (98.8555%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.3302, Accuracy: 8927/10000 (89.2700%)
___Train Local_Simple,  epoch 234, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch 234, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 704/710 (99.1549%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.1823, Accuracy: 9432/10000 (94.3200%)
___Train Local_Simple,  epoch 234, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 651/660 (98.6364%)
___Train Local_Simple,  epoch 234, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 649/660 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.1008, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch 234, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 234, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.0351, Accuracy: 9894/10000 (98.9400%)
poison local model 26 index 2
___Train Local_Simple,  epoch 234, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 234, local model 26, internal_epoch   2,  Average loss: 0.0013, Accuracy: 542/554 (97.8339%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.1615, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch 234, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch 234, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 469/470 (99.7872%)
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.0472, Accuracy: 9833/10000 (98.3300%)
___Train Local_Simple,  epoch 234, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 234, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 61, 26]
base_p: [-1.9668788e-04  7.6968223e-05 -1.3704603e-03 ... -3.7588179e-04
  1.8055364e-03  1.2082532e-03]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 7]
layer1_inf_time: 3.087158203125
[PAIRWISE] pred_attackers_indx:  [3 4 5]
layer2_inf_t: 43.956787109375
assumed final_attacker_idxs:  [1 3 4 5 7]
final_attacker_idxs is: [1 3 4 5 7]
g_attacker_idxs: [52 61 46 66 26]
g_normal_idxs: [19 83 76 87 65]
filtered_attacker_idxs: [1, 3, 4, 5, 7]
final_attacker_idxs are: [1, 3, 4, 5, 7]
num_dps: [205, 253, 433, 699, 710, 660, 78, 554, 470, 371]
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.0435, Accuracy: 9869/10000 (98.6900%)
time spent on training: 52.376840353012085
Starting performing KrMLRFL...
Num data points: [205, 253, 433, 699, 710, 660, 78, 554, 470, 371]
Num selected data points: [205 433  78 470 371]
The chosen ones are users: [0, 2, 6, 8, 9], which are global users: [19, 83, 76, 87, 65]
epoch_acc: 98.81
___Test Local_Simple poisoned: False, epoch: 234: Average loss: 0.0371, Accuracy: 9881/10000 (98.8100%)
___Test Local_Simple poisoned: True, epoch: 234: Average loss: 13.7931, Accuracy: 24/8968 (0.2676%)
Done in 59.22692370414734 sec.
Server Epoch:235 choose agents : [2, 94, 97, 64, 75, 39, 55, 35, 21, 42].
poison local model 2 index 0
___Train Local_Simple,  epoch 235, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 541/548 (98.7226%)
___Train Local_Simple,  epoch 235, local model 2, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.2638, Accuracy: 9197/10000 (91.9700%)
___Train Local_Simple,  epoch 235, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch 235, local model 94, internal_epoch   2,  Average loss: 0.0002, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.9165, Accuracy: 8542/10000 (85.4200%)
___Train Local_Simple,  epoch 235, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 235, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 485/487 (99.5893%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.2441, Accuracy: 9406/10000 (94.0600%)
___Train Local_Simple,  epoch 235, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 813/813 (100.0000%)
___Train Local_Simple,  epoch 235, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.0555, Accuracy: 9832/10000 (98.3200%)
___Train Local_Simple,  epoch 235, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 684/686 (99.7085%)
___Train Local_Simple,  epoch 235, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 683/686 (99.5627%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.0480, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 235, local model 39, internal_epoch   1,  Average loss: 0.0003, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 235, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.0489, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 235, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 235, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.2115, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch 235, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 496/499 (99.3988%)
___Train Local_Simple,  epoch 235, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.3615, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch 235, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 311/312 (99.6795%)
___Train Local_Simple,  epoch 235, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.0621, Accuracy: 9800/10000 (98.0000%)
poison local model 42 index 1
___Train Local_Simple,  epoch 235, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 235, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.0469, Accuracy: 9844/10000 (98.4400%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 42]
base_p: [ 3.1211227e-04  9.3735754e-05 -1.1999942e-03 ... -2.7145296e-03
 -9.9012256e-04  2.3147464e-04]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 9]
layer1_inf_time: 3.86962890625
[PAIRWISE] pred_attackers_indx:  [1 3 4 5 7]
layer2_inf_t: 145.972900390625
assumed final_attacker_idxs:  [0 1 3 4 5 6 7 9]
final_attacker_idxs is: [0 1 3 4 5 6 7 9]
g_attacker_idxs: [ 2 94 64 75 39 55 35 42]
g_normal_idxs: [97 21]
filtered_attacker_idxs: [0, 9]
final_attacker_idxs are: [0, 9]
num_dps: [548, 150, 487, 813, 686, 257, 354, 499, 312, 236]
time spent on training: 39.82674479484558
Starting performing KrMLRFL...
Num data points: [548, 150, 487, 813, 686, 257, 354, 499, 312, 236]
Num selected data points: [150 487 813 686 257 354 499 312]
The chosen ones are users: [1, 2, 3, 4, 5, 6, 7, 8], which are global users: [94, 97, 64, 75, 39, 55, 35, 21]
epoch_acc: 98.79
___Test Local_Simple poisoned: False, epoch: 235: Average loss: 0.0400, Accuracy: 9879/10000 (98.7900%)
___Test Local_Simple poisoned: True, epoch: 235: Average loss: 14.8766, Accuracy: 8/8968 (0.0892%)
Done in 46.40919280052185 sec.
Server Epoch:236 choose agents : [36, 17, 66, 38, 92, 62, 91, 82, 18, 20].
___Train Local_Simple,  epoch 236, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 974/1005 (96.9154%)
___Train Local_Simple,  epoch 236, local model 36, internal_epoch   2,  Average loss: 0.0008, Accuracy: 988/1005 (98.3085%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.3823, Accuracy: 9004/10000 (90.0400%)
poison local model 17 index 0
___Train Local_Simple,  epoch 236, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 602/620 (97.0968%)
___Train Local_Simple,  epoch 236, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 610/620 (98.3871%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.1675, Accuracy: 9471/10000 (94.7100%)
___Train Local_Simple,  epoch 236, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 653/660 (98.9394%)
___Train Local_Simple,  epoch 236, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 652/660 (98.7879%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.5265, Accuracy: 8635/10000 (86.3500%)
___Train Local_Simple,  epoch 236, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 886/895 (98.9944%)
___Train Local_Simple,  epoch 236, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 891/895 (99.5531%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.1884, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch 236, local model 92, internal_epoch   1,  Average loss: 0.0007, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch 236, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 928/937 (99.0395%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.3903, Accuracy: 8793/10000 (87.9300%)
___Train Local_Simple,  epoch 236, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 236, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.0463, Accuracy: 9850/10000 (98.5000%)
poison local model 91 index 1
___Train Local_Simple,  epoch 236, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 236, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.0458, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 236, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch 236, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.6106, Accuracy: 8813/10000 (88.1300%)
___Train Local_Simple,  epoch 236, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 457/459 (99.5643%)
___Train Local_Simple,  epoch 236, local model 18, internal_epoch   2,  Average loss: 0.0003, Accuracy: 457/459 (99.5643%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.0744, Accuracy: 9774/10000 (97.7400%)
poison local model 20 index 2
___Train Local_Simple,  epoch 236, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 236, local model 20, internal_epoch   2,  Average loss: 0.0005, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.2800, Accuracy: 9234/10000 (92.3400%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 91, 20]
base_p: [ 2.5744736e-04  9.2037022e-05 -1.0850895e-03 ... -4.1690469e-04
 -3.7220120e-03 -6.2842667e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 7, 9]
layer1_inf_time: 3.265380859375
[PAIRWISE] pred_attackers_indx:  [0 1 9]
layer2_inf_t: 309.178955078125
assumed final_attacker_idxs:  [0 1 2 4 7 9]
final_attacker_idxs is: [0 1 2 4 7 9]
g_attacker_idxs: [36 17 66 92 82 20]
g_normal_idxs: [38 62 91 18]
filtered_attacker_idxs: [0, 1, 2, 4, 7, 9]
final_attacker_idxs are: [0, 1, 2, 4, 7, 9]
num_dps: [1005, 620, 660, 895, 937, 423, 256, 713, 459, 429]
time spent on training: 48.934394121170044
Starting performing KrMLRFL...
Num data points: [1005, 620, 660, 895, 937, 423, 256, 713, 459, 429]
Num selected data points: [895 423 256 459]
The chosen ones are users: [3, 5, 6, 8], which are global users: [38, 62, 91, 18]
epoch_acc: 98.33
___Test Local_Simple poisoned: False, epoch: 236: Average loss: 0.0507, Accuracy: 9833/10000 (98.3300%)
___Test Local_Simple poisoned: True, epoch: 236: Average loss: 15.6432, Accuracy: 1/8968 (0.0112%)
Done in 54.77644228935242 sec.
Server Epoch:237 choose agents : [87, 19, 49, 89, 78, 18, 33, 73, 37, 41].
___Train Local_Simple,  epoch 237, local model 87, internal_epoch   1,  Average loss: 0.0004, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch 237, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 469/470 (99.7872%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.1071, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch 237, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 237, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.0862, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch 237, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 237, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.0615, Accuracy: 9791/10000 (97.9100%)
___Train Local_Simple,  epoch 237, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 237, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.0605, Accuracy: 9809/10000 (98.0900%)
___Train Local_Simple,  epoch 237, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 237, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.0788, Accuracy: 9744/10000 (97.4400%)
___Train Local_Simple,  epoch 237, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 237, local model 18, internal_epoch   2,  Average loss: 0.0000, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.0546, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 237, local model 33, internal_epoch   1,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Train Local_Simple,  epoch 237, local model 33, internal_epoch   2,  Average loss: 0.0005, Accuracy: 615/623 (98.7159%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.0791, Accuracy: 9728/10000 (97.2800%)
poison local model 73 index 0
___Train Local_Simple,  epoch 237, local model 73, internal_epoch   1,  Average loss: 0.0013, Accuracy: 587/591 (99.3232%)
___Train Local_Simple,  epoch 237, local model 73, internal_epoch   2,  Average loss: 0.0013, Accuracy: 574/591 (97.1235%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.3664, Accuracy: 8800/10000 (88.0000%)
___Train Local_Simple,  epoch 237, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 847/860 (98.4884%)
___Train Local_Simple,  epoch 237, local model 37, internal_epoch   2,  Average loss: 0.0007, Accuracy: 851/860 (98.9535%)
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.1399, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch 237, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Train Local_Simple,  epoch 237, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73]
base_p: [ 1.4548376e-04 -2.6904047e-05 -1.2138579e-03 ...  4.1811168e-04
 -9.8784268e-04 -1.1767447e-04]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 2.777099609375
[PAIRWISE] pred_attackers_indx:  [0 1 3 8 9]
layer2_inf_t: 28.258544921875
assumed final_attacker_idxs:  [0 1 3 5 6 7 8 9]
final_attacker_idxs is: [0 1 3 5 6 7 8 9]
g_attacker_idxs: [87 19 89 18 33 73 37 41]
g_normal_idxs: [49 78]
filtered_attacker_idxs: [7, 9]
final_attacker_idxs are: [7, 9]
num_dps: [470, 205, 506, 492, 303, 459, 623, 591, 860, 606]
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.2885, Accuracy: 9218/10000 (92.1800%)
time spent on training: 38.48210883140564
Starting performing KrMLRFL...
Num data points: [470, 205, 506, 492, 303, 459, 623, 591, 860, 606]
Num selected data points: [470 205 506 492 303 459 623 860]
The chosen ones are users: [0, 1, 2, 3, 4, 5, 6, 8], which are global users: [87, 19, 49, 89, 78, 18, 33, 37]
epoch_acc: 98.69
___Test Local_Simple poisoned: False, epoch: 237: Average loss: 0.0399, Accuracy: 9869/10000 (98.6900%)
___Test Local_Simple poisoned: True, epoch: 237: Average loss: 13.3407, Accuracy: 12/8968 (0.1338%)
Done in 46.37330746650696 sec.
Server Epoch:238 choose agents : [70, 15, 36, 67, 23, 7, 96, 32, 29, 19].
poison local model 70 index 0
___Train Local_Simple,  epoch 238, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 711/724 (98.2044%)
___Train Local_Simple,  epoch 238, local model 70, internal_epoch   2,  Average loss: 0.0014, Accuracy: 701/724 (96.8232%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.1802, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch 238, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 400/401 (99.7506%)
___Train Local_Simple,  epoch 238, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.5271, Accuracy: 9012/10000 (90.1200%)
___Train Local_Simple,  epoch 238, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 996/1005 (99.1045%)
___Train Local_Simple,  epoch 238, local model 36, internal_epoch   2,  Average loss: 0.0003, Accuracy: 995/1005 (99.0050%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.2049, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch 238, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 987/998 (98.8978%)
___Train Local_Simple,  epoch 238, local model 67, internal_epoch   2,  Average loss: 0.0003, Accuracy: 990/998 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.1429, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch 238, local model 23, internal_epoch   1,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch 238, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.0805, Accuracy: 9752/10000 (97.5200%)
poison local model 7 index 1
___Train Local_Simple,  epoch 238, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 412/418 (98.5646%)
___Train Local_Simple,  epoch 238, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.1601, Accuracy: 9555/10000 (95.5500%)
___Train Local_Simple,  epoch 238, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 666/672 (99.1071%)
___Train Local_Simple,  epoch 238, local model 96, internal_epoch   2,  Average loss: 0.0002, Accuracy: 669/672 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.0802, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch 238, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 957/977 (97.9529%)
___Train Local_Simple,  epoch 238, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 968/977 (99.0788%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.1630, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch 238, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 997/1002 (99.5010%)
___Train Local_Simple,  epoch 238, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.1158, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch 238, local model 19, internal_epoch   1,  Average loss: 0.0003, Accuracy: 204/205 (99.5122%)
___Train Local_Simple,  epoch 238, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.0408, Accuracy: 9872/10000 (98.7200%)
time spent on training: 45.021071672439575
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 7]
base_p: [ 2.0254403e-05  3.8078055e-04  6.0202461e-04 ...  2.3692846e-04
  3.7092343e-03 -1.0647476e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 6, 7]
layer1_inf_time: 4.0185546875
[PAIRWISE] pred_attackers_indx:  [0 4 7 8]
layer2_inf_t: 588.64306640625
assumed final_attacker_idxs:  [0 2 3 4 5 6 7 8]
final_attacker_idxs is: [0 2 3 4 5 6 7 8]
g_attacker_idxs: [70 36 67 23  7 96 32 29]
g_normal_idxs: [15 19]
filtered_attacker_idxs: [0, 2, 3, 5, 6, 7, 8]
final_attacker_idxs are: [0, 2, 3, 5, 6, 7, 8]
num_dps: [724, 401, 1005, 998, 293, 418, 672, 977, 1002, 205]
Starting performing KrMLRFL...
Num data points: [724, 401, 1005, 998, 293, 418, 672, 977, 1002, 205]
Num selected data points: [401 293 205]
The chosen ones are users: [1, 4, 9], which are global users: [15, 23, 19]
___Test Local_Simple poisoned: False, epoch: 238: Average loss: 0.0728, Accuracy: 9758/10000 (97.5800%)
epoch_acc: 97.58
___Test Local_Simple poisoned: True, epoch: 238: Average loss: 12.2938, Accuracy: 161/8968 (1.7953%)
Done in 54.02342104911804 sec.
Server Epoch:239 choose agents : [27, 41, 10, 82, 91, 86, 85, 88, 40, 62].
poison local model 27 index 0
___Train Local_Simple,  epoch 239, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 465/471 (98.7261%)
___Train Local_Simple,  epoch 239, local model 27, internal_epoch   2,  Average loss: 0.0009, Accuracy: 464/471 (98.5138%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.2971, Accuracy: 9113/10000 (91.1300%)
___Train Local_Simple,  epoch 239, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%)
___Train Local_Simple,  epoch 239, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.2972, Accuracy: 9155/10000 (91.5500%)
___Train Local_Simple,  epoch 239, local model 10, internal_epoch   1,  Average loss: 0.0003, Accuracy: 888/892 (99.5516%)
___Train Local_Simple,  epoch 239, local model 10, internal_epoch   2,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.1593, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch 239, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch 239, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.5759, Accuracy: 8775/10000 (87.7500%)
poison local model 91 index 1
___Train Local_Simple,  epoch 239, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 239, local model 91, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.1060, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch 239, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 239, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.0679, Accuracy: 9785/10000 (97.8500%)
poison local model 85 index 2
___Train Local_Simple,  epoch 239, local model 85, internal_epoch   1,  Average loss: 0.0003, Accuracy: 428/431 (99.3039%)
___Train Local_Simple,  epoch 239, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.0630, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 239, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch 239, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.0875, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch 239, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 762/772 (98.7047%)
___Train Local_Simple,  epoch 239, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 768/772 (99.4819%)
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.1578, Accuracy: 9571/10000 (95.7100%)
___Train Local_Simple,  epoch 239, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch 239, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 91, 85]
base_p: [ 0.0001045   0.00013757 -0.00017423 ...  0.00049798  0.0012952
 -0.00067016]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 6, 8]
layer1_inf_time: 3.077880859375
[PAIRWISE] pred_attackers_indx:  [1 6 7 8 9]
layer2_inf_t: 34.260009765625
assumed final_attacker_idxs:  [0 1 3 6 7 8 9]
final_attacker_idxs is: [0 1 3 6 7 8 9]
g_attacker_idxs: [27 41 82 85 88 40 62]
g_normal_idxs: [10 91 86]
filtered_attacker_idxs: [0, 1, 3, 6, 8]
final_attacker_idxs are: [0, 1, 3, 6, 8]
num_dps: [471, 606, 892, 713, 256, 250, 431, 530, 772, 423]
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.0885, Accuracy: 9741/10000 (97.4100%)
time spent on training: 48.28749442100525
Starting performing KrMLRFL...
Num data points: [471, 606, 892, 713, 256, 250, 431, 530, 772, 423]
Num selected data points: [892 256 250 530 423]
The chosen ones are users: [2, 4, 5, 7, 9], which are global users: [10, 91, 86, 88, 62]
epoch_acc: 98.32
___Test Local_Simple poisoned: False, epoch: 239: Average loss: 0.0558, Accuracy: 9832/10000 (98.3200%)
___Test Local_Simple poisoned: True, epoch: 239: Average loss: 15.1267, Accuracy: 9/8968 (0.1004%)
Done in 57.05553221702576 sec.
Server Epoch:240 choose agents : [0, 74, 70, 81, 42, 29, 43, 94, 83, 82].
___Train Local_Simple,  epoch 240, local model 0, internal_epoch   1,  Average loss: 0.0004, Accuracy: 432/435 (99.3103%)
___Train Local_Simple,  epoch 240, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.1124, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch 240, local model 74, internal_epoch   1,  Average loss: 0.0007, Accuracy: 552/557 (99.1023%)
___Train Local_Simple,  epoch 240, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.0734, Accuracy: 9775/10000 (97.7500%)
poison local model 70 index 0
___Train Local_Simple,  epoch 240, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 710/724 (98.0663%)
___Train Local_Simple,  epoch 240, local model 70, internal_epoch   2,  Average loss: 0.0006, Accuracy: 716/724 (98.8950%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.1923, Accuracy: 9411/10000 (94.1100%)
poison local model 81 index 1
___Train Local_Simple,  epoch 240, local model 81, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1219/1227 (99.3480%)
___Train Local_Simple,  epoch 240, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1220/1227 (99.4295%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.3466, Accuracy: 9084/10000 (90.8400%)
poison local model 42 index 2
___Train Local_Simple,  epoch 240, local model 42, internal_epoch   1,  Average loss: 0.0010, Accuracy: 229/236 (97.0339%)
___Train Local_Simple,  epoch 240, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.1151, Accuracy: 9630/10000 (96.3000%)
___Train Local_Simple,  epoch 240, local model 29, internal_epoch   1,  Average loss: 0.0006, Accuracy: 989/1002 (98.7026%)
___Train Local_Simple,  epoch 240, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 995/1002 (99.3014%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.7232, Accuracy: 8268/10000 (82.6800%)
___Train Local_Simple,  epoch 240, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 240, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.0691, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch 240, local model 94, internal_epoch   1,  Average loss: 0.0012, Accuracy: 146/150 (97.3333%)
___Train Local_Simple,  epoch 240, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.3591, Accuracy: 8855/10000 (88.5500%)
___Train Local_Simple,  epoch 240, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Train Local_Simple,  epoch 240, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.0393, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 240, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 702/713 (98.4572%)
___Train Local_Simple,  epoch 240, local model 82, internal_epoch   2,  Average loss: 0.0004, Accuracy: 706/713 (99.0182%)
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.5845, Accuracy: 8432/10000 (84.3200%)
time spent on training: 55.71700167655945
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 81, 42]
base_p: [-9.4033778e-05  1.3100170e-04 -4.6762247e-03 ... -3.2379776e-03
 -3.3726245e-03  1.4504492e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 9]
layer1_inf_time: 4.25439453125
[PAIRWISE] pred_attackers_indx:  [0 2 3]
layer2_inf_t: 322.011474609375
assumed final_attacker_idxs:  [0 2 3 4 9]
final_attacker_idxs is: [0 2 3 4 9]
g_attacker_idxs: [ 0 70 81 42 82]
g_normal_idxs: [74 29 43 94 83]
filtered_attacker_idxs: [2, 3, 4, 9]
final_attacker_idxs are: [2, 3, 4, 9]
num_dps: [435, 557, 724, 1227, 236, 1002, 408, 150, 433, 713]
Num data points: [435, 557, 724, 1227, 236, 1002, 408, 150, 433, 713]
Num selected data points: [ 435  557 1002  408  150  433]
The chosen ones are users: [0, 1, 5, 6, 7, 8], which are global users: [0, 74, 29, 43, 94, 83]
___Test Local_Simple poisoned: False, epoch: 240: Average loss: 0.0500, Accuracy: 9840/10000 (98.4000%)
epoch_acc: 98.4
___Test Local_Simple poisoned: True, epoch: 240: Average loss: 11.6814, Accuracy: 41/8968 (0.4572%)
Done in 63.852386474609375 sec.
Server Epoch:241 choose agents : [80, 13, 88, 2, 95, 39, 62, 15, 92, 3].
___Train Local_Simple,  epoch 241, local model 80, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 241, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.0612, Accuracy: 9832/10000 (98.3200%)
poison local model 13 index 0
___Train Local_Simple,  epoch 241, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%)
___Train Local_Simple,  epoch 241, local model 13, internal_epoch   2,  Average loss: 0.0001, Accuracy: 731/734 (99.5913%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.1732, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch 241, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch 241, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.1364, Accuracy: 9602/10000 (96.0200%)
poison local model 2 index 1
___Train Local_Simple,  epoch 241, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 241, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.0901, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch 241, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch 241, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.2393, Accuracy: 9095/10000 (90.9500%)
___Train Local_Simple,  epoch 241, local model 39, internal_epoch   1,  Average loss: 0.0004, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 241, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.0406, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 241, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch 241, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.0441, Accuracy: 9855/10000 (98.5500%)
___Train Local_Simple,  epoch 241, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch 241, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.0623, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch 241, local model 92, internal_epoch   1,  Average loss: 0.0009, Accuracy: 922/937 (98.3991%)
___Train Local_Simple,  epoch 241, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 935/937 (99.7866%)
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.2793, Accuracy: 9051/10000 (90.5100%)
___Train Local_Simple,  epoch 241, local model 3, internal_epoch   1,  Average loss: 0.0007, Accuracy: 907/923 (98.2665%)
___Train Local_Simple,  epoch 241, local model 3, internal_epoch   2,  Average loss: 0.0003, Accuracy: 919/923 (99.5666%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 2]
base_p: [ 0.00049245  0.00024421  0.00170555 ...  0.00301221 -0.00133755
 -0.0013013 ]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 8, 9]
layer1_inf_time: 3.560546875
[PAIRWISE] pred_attackers_indx:  [1 3 4 9]
layer2_inf_t: 28.5810546875
assumed final_attacker_idxs:  [1 3 4 8 9]
final_attacker_idxs is: [1 3 4 8 9]
g_attacker_idxs: [13  2 95 92  3]
g_normal_idxs: [80 88 39 62 15]
filtered_attacker_idxs: [1, 3, 4, 8, 9]
final_attacker_idxs are: [1, 3, 4, 8, 9]
num_dps: [431, 734, 530, 548, 602, 257, 423, 401, 937, 923]
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.1004, Accuracy: 9686/10000 (96.8600%)
time spent on training: 45.618146657943726
Starting performing KrMLRFL...
Num data points: [431, 734, 530, 548, 602, 257, 423, 401, 937, 923]
Num selected data points: [431 530 257 423 401]
The chosen ones are users: [0, 2, 5, 6, 7], which are global users: [80, 88, 39, 62, 15]
epoch_acc: 98.86
___Test Local_Simple poisoned: False, epoch: 241: Average loss: 0.0335, Accuracy: 9886/10000 (98.8600%)
___Test Local_Simple poisoned: True, epoch: 241: Average loss: 13.3622, Accuracy: 19/8968 (0.2119%)
Done in 53.00800156593323 sec.
Server Epoch:242 choose agents : [63, 48, 47, 40, 23, 76, 50, 27, 34, 88].
poison local model 63 index 0
___Train Local_Simple,  epoch 242, local model 63, internal_epoch   1,  Average loss: 0.0008, Accuracy: 874/889 (98.3127%)
___Train Local_Simple,  epoch 242, local model 63, internal_epoch   2,  Average loss: 0.0005, Accuracy: 883/889 (99.3251%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0954, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch 242, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch 242, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0553, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch 242, local model 47, internal_epoch   1,  Average loss: 0.0003, Accuracy: 771/776 (99.3557%)
___Train Local_Simple,  epoch 242, local model 47, internal_epoch   2,  Average loss: 0.0002, Accuracy: 772/776 (99.4845%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0845, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch 242, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 765/772 (99.0933%)
___Train Local_Simple,  epoch 242, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 769/772 (99.6114%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0973, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch 242, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 242, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0397, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 242, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 242, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0336, Accuracy: 9888/10000 (98.8800%)
___Train Local_Simple,  epoch 242, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 471/474 (99.3671%)
___Train Local_Simple,  epoch 242, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0705, Accuracy: 9766/10000 (97.6600%)
poison local model 27 index 1
___Train Local_Simple,  epoch 242, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 464/471 (98.5138%)
___Train Local_Simple,  epoch 242, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 469/471 (99.5754%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.3603, Accuracy: 9201/10000 (92.0100%)
poison local model 34 index 2
___Train Local_Simple,  epoch 242, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%)
___Train Local_Simple,  epoch 242, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0874, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch 242, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 242, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 27, 34]
base_p: [ 2.2448599e-04  5.5272132e-05  4.7744252e-05 ...  1.2588799e-03
 -4.1886419e-04 -1.1728704e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 7, 8]
layer1_inf_time: 2.8662109375
[PAIRWISE] pred_attackers_indx:  [0 2 3 6 7 8]
layer2_inf_t: 43.4501953125
assumed final_attacker_idxs:  [0 2 3 6 7 8]
final_attacker_idxs is: [0 2 3 6 7 8]
g_attacker_idxs: [63 47 40 50 27 34]
g_normal_idxs: [48 23 76 88]
filtered_attacker_idxs: [0, 2, 3, 7, 8]
final_attacker_idxs are: [0, 2, 3, 7, 8]
num_dps: [889, 448, 776, 772, 293, 78, 474, 471, 413, 530]
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0467, Accuracy: 9843/10000 (98.4300%)
time spent on training: 46.438554763793945
Starting performing KrMLRFL...
Num data points: [889, 448, 776, 772, 293, 78, 474, 471, 413, 530]
Num selected data points: [448 293  78 474 530]
The chosen ones are users: [1, 4, 5, 6, 9], which are global users: [48, 23, 76, 50, 88]
___Test Local_Simple poisoned: False, epoch: 242: Average loss: 0.0368, Accuracy: 9881/10000 (98.8100%)
epoch_acc: 98.81
___Test Local_Simple poisoned: True, epoch: 242: Average loss: 13.7689, Accuracy: 19/8968 (0.2119%)
Done in 53.73970699310303 sec.
Server Epoch:243 choose agents : [47, 95, 76, 87, 89, 37, 94, 27, 43, 17].
___Train Local_Simple,  epoch 243, local model 47, internal_epoch   1,  Average loss: 0.0004, Accuracy: 769/776 (99.0979%)
___Train Local_Simple,  epoch 243, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 771/776 (99.3557%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.1498, Accuracy: 9536/10000 (95.3600%)
___Train Local_Simple,  epoch 243, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 243, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 1.0453, Accuracy: 7999/10000 (79.9900%)
___Train Local_Simple,  epoch 243, local model 76, internal_epoch   1,  Average loss: 0.0002, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 243, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.0322, Accuracy: 9896/10000 (98.9600%)
___Train Local_Simple,  epoch 243, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch 243, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.0601, Accuracy: 9804/10000 (98.0400%)
___Train Local_Simple,  epoch 243, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Train Local_Simple,  epoch 243, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.0583, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 243, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 859/860 (99.8837%)
___Train Local_Simple,  epoch 243, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.1741, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch 243, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 243, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.0850, Accuracy: 9699/10000 (96.9900%)
poison local model 27 index 0
___Train Local_Simple,  epoch 243, local model 27, internal_epoch   1,  Average loss: 0.0006, Accuracy: 465/471 (98.7261%)
___Train Local_Simple,  epoch 243, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.4080, Accuracy: 9219/10000 (92.1900%)
___Train Local_Simple,  epoch 243, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 408/408 (100.0000%)
___Train Local_Simple,  epoch 243, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.0450, Accuracy: 9857/10000 (98.5700%)
poison local model 17 index 1
___Train Local_Simple,  epoch 243, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 605/620 (97.5806%)
___Train Local_Simple,  epoch 243, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 614/620 (99.0323%)
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.1904, Accuracy: 9420/10000 (94.2000%)
time spent on training: 43.389883279800415
Starting performing KrMLRFL...
Num data points: [776, 602, 78, 470, 492, 860, 150, 471, 408, 620]
Num selected data points: [ 78 470 492 860 150 408]
The chosen ones are users: [2, 3, 4, 5, 6, 8], which are global users: [76, 87, 89, 37, 94, 43]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 17]
base_p: [-1.6599894e-04  4.9078837e-05  3.1004101e-04 ... -1.1917949e-04
 -1.5836135e-03 -1.7332137e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 7, 9]
layer1_inf_time: 3.719970703125
[PAIRWISE] pred_attackers_indx:  [0 7 9]
layer2_inf_t: 30.201171875
assumed final_attacker_idxs:  [0 1 5 7 9]
final_attacker_idxs is: [0 1 5 7 9]
g_attacker_idxs: [47 95 37 27 17]
g_normal_idxs: [76 87 89 94 43]
filtered_attacker_idxs: [0, 1, 7, 9]
final_attacker_idxs are: [0, 1, 7, 9]
num_dps: [776, 602, 78, 470, 492, 860, 150, 471, 408, 620]
epoch_acc: 98.63
___Test Local_Simple poisoned: False, epoch: 243: Average loss: 0.0439, Accuracy: 9863/10000 (98.6300%)
___Test Local_Simple poisoned: True, epoch: 243: Average loss: 12.9790, Accuracy: 44/8968 (0.4906%)
Done in 48.73874092102051 sec.
Server Epoch:244 choose agents : [49, 64, 35, 34, 94, 85, 84, 70, 23, 79].
___Train Local_Simple,  epoch 244, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 503/506 (99.4071%)
___Train Local_Simple,  epoch 244, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0806, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 244, local model 64, internal_epoch   1,  Average loss: 0.0006, Accuracy: 803/813 (98.7700%)
___Train Local_Simple,  epoch 244, local model 64, internal_epoch   2,  Average loss: 0.0007, Accuracy: 801/813 (98.5240%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0634, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch 244, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 244, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0661, Accuracy: 9778/10000 (97.7800%)
poison local model 34 index 0
___Train Local_Simple,  epoch 244, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 244, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0718, Accuracy: 9785/10000 (97.8500%)
___Train Local_Simple,  epoch 244, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 244, local model 94, internal_epoch   2,  Average loss: 0.0000, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.1467, Accuracy: 9441/10000 (94.4100%)
poison local model 85 index 1
___Train Local_Simple,  epoch 244, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 244, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0734, Accuracy: 9770/10000 (97.7000%)
___Train Local_Simple,  epoch 244, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1223/1246 (98.1541%)
___Train Local_Simple,  epoch 244, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1233/1246 (98.9567%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0613, Accuracy: 9801/10000 (98.0100%)
poison local model 70 index 2
___Train Local_Simple,  epoch 244, local model 70, internal_epoch   1,  Average loss: 0.0014, Accuracy: 709/724 (97.9282%)
___Train Local_Simple,  epoch 244, local model 70, internal_epoch   2,  Average loss: 0.0009, Accuracy: 710/724 (98.0663%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.3530, Accuracy: 9042/10000 (90.4200%)
___Train Local_Simple,  epoch 244, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 244, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0462, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 244, local model 79, internal_epoch   1,  Average loss: 0.0006, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch 244, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 85, 70]
base_p: [-0.00030456 -0.00026798 -0.00050361 ... -0.002994   -0.00175656
 -0.00147318]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 6, 7]
layer1_inf_time: 4.09716796875
[PAIRWISE] pred_attackers_indx:  [6 7]
layer2_inf_t: 34.46923828125
assumed final_attacker_idxs:  [1 3 5 6 7]
final_attacker_idxs is: [1 3 5 6 7]
g_attacker_idxs: [64 34 85 84 70]
g_normal_idxs: [49 35 94 23 79]
filtered_attacker_idxs: [3, 5, 6, 7]
final_attacker_idxs are: [3, 5, 6, 7]
num_dps: [506, 813, 499, 413, 150, 431, 1246, 724, 293, 182]
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0407, Accuracy: 9880/10000 (98.8000%)
time spent on training: 50.18581819534302
Starting performing KrMLRFL...
Num data points: [506, 813, 499, 413, 150, 431, 1246, 724, 293, 182]
Num selected data points: [506 813 499 150 293 182]
The chosen ones are users: [0, 1, 2, 4, 8, 9], which are global users: [49, 64, 35, 94, 23, 79]
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: False, epoch: 244: Average loss: 0.0359, Accuracy: 9885/10000 (98.8500%)
___Test Local_Simple poisoned: True, epoch: 244: Average loss: 13.3213, Accuracy: 5/8968 (0.0558%)
Done in 57.75882434844971 sec.
Server Epoch:245 choose agents : [25, 9, 61, 71, 84, 36, 92, 31, 50, 18].
___Train Local_Simple,  epoch 245, local model 25, internal_epoch   1,  Average loss: 0.0008, Accuracy: 634/647 (97.9907%)
___Train Local_Simple,  epoch 245, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 638/647 (98.6090%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.1399, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch 245, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 245, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.0712, Accuracy: 9773/10000 (97.7300%)
poison local model 61 index 0
___Train Local_Simple,  epoch 245, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 685/699 (97.9971%)
___Train Local_Simple,  epoch 245, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 693/699 (99.1416%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.3843, Accuracy: 8797/10000 (87.9700%)
poison local model 71 index 1
___Train Local_Simple,  epoch 245, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1375/1384 (99.3497%)
___Train Local_Simple,  epoch 245, local model 71, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1377/1384 (99.4942%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.2066, Accuracy: 9331/10000 (93.3100%)
___Train Local_Simple,  epoch 245, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1225/1246 (98.3146%)
___Train Local_Simple,  epoch 245, local model 84, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1237/1246 (99.2777%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.0913, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch 245, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 992/1005 (98.7065%)
___Train Local_Simple,  epoch 245, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 994/1005 (98.9055%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.1389, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch 245, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 926/937 (98.8260%)
___Train Local_Simple,  epoch 245, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.2940, Accuracy: 9057/10000 (90.5700%)
___Train Local_Simple,  epoch 245, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 245, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.0571, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 245, local model 50, internal_epoch   1,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Train Local_Simple,  epoch 245, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.0523, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 245, local model 18, internal_epoch   1,  Average loss: 0.0003, Accuracy: 456/459 (99.3464%)
___Train Local_Simple,  epoch 245, local model 18, internal_epoch   2,  Average loss: 0.0003, Accuracy: 456/459 (99.3464%)
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.0788, Accuracy: 9737/10000 (97.3700%)
time spent on training: 44.779428243637085
Starting performing KrMLRFL...
Num data points: [647, 436, 699, 1384, 1246, 1005, 937, 835, 474, 459]
Num selected data points: [647 436 835 474 459]
The chosen ones are users: [0, 1, 7, 8, 9], which are global users: [25, 9, 31, 50, 18]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 71]
base_p: [0.00024795 0.00016866 0.00088554 ... 0.00244261 0.00551318 0.00065627]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 6]
layer1_inf_time: 5.04833984375
[PAIRWISE] pred_attackers_indx:  [2 3 4 6]
layer2_inf_t: 88.73046875
assumed final_attacker_idxs:  [2 3 4 5 6]
final_attacker_idxs is: [2 3 4 5 6]
g_attacker_idxs: [61 71 84 36 92]
g_normal_idxs: [25  9 31 50 18]
filtered_attacker_idxs: [2, 3, 4, 5, 6]
final_attacker_idxs are: [2, 3, 4, 5, 6]
num_dps: [647, 436, 699, 1384, 1246, 1005, 937, 835, 474, 459]
epoch_acc: 98.83999999999999
___Test Local_Simple poisoned: False, epoch: 245: Average loss: 0.0352, Accuracy: 9884/10000 (98.8400%)
___Test Local_Simple poisoned: True, epoch: 245: Average loss: 13.4678, Accuracy: 19/8968 (0.2119%)
Done in 55.429677963256836 sec.
Server Epoch:246 choose agents : [30, 27, 92, 67, 2, 64, 15, 97, 38, 9].
___Train Local_Simple,  epoch 246, local model 30, internal_epoch   1,  Average loss: 0.0003, Accuracy: 397/400 (99.2500%)
___Train Local_Simple,  epoch 246, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.2700, Accuracy: 9176/10000 (91.7600%)
poison local model 27 index 0
___Train Local_Simple,  epoch 246, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 462/471 (98.0892%)
___Train Local_Simple,  epoch 246, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 466/471 (98.9384%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.2455, Accuracy: 9361/10000 (93.6100%)
___Train Local_Simple,  epoch 246, local model 92, internal_epoch   1,  Average loss: 0.0008, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 246, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 928/937 (99.0395%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.3848, Accuracy: 8799/10000 (87.9900%)
___Train Local_Simple,  epoch 246, local model 67, internal_epoch   1,  Average loss: 0.0007, Accuracy: 978/998 (97.9960%)
___Train Local_Simple,  epoch 246, local model 67, internal_epoch   2,  Average loss: 0.0005, Accuracy: 987/998 (98.8978%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.2099, Accuracy: 9319/10000 (93.1900%)
poison local model 2 index 1
___Train Local_Simple,  epoch 246, local model 2, internal_epoch   1,  Average loss: 0.0012, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 246, local model 2, internal_epoch   2,  Average loss: 0.0004, Accuracy: 546/548 (99.6350%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.1202, Accuracy: 9581/10000 (95.8100%)
___Train Local_Simple,  epoch 246, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 813/813 (100.0000%)
___Train Local_Simple,  epoch 246, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.1149, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch 246, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 246, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.0332, Accuracy: 9890/10000 (98.9000%)
___Train Local_Simple,  epoch 246, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 246, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.0537, Accuracy: 9809/10000 (98.0900%)
___Train Local_Simple,  epoch 246, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 894/895 (99.8883%)
___Train Local_Simple,  epoch 246, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.0667, Accuracy: 9784/10000 (97.8400%)
___Train Local_Simple,  epoch 246, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 246, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 2]
base_p: [ 9.0789050e-05  1.1022389e-04  6.8843644e-04 ... -2.0618737e-04
 -6.3084662e-03 -2.3288354e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 5]
layer1_inf_time: 3.644287109375
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.0429, Accuracy: 9864/10000 (98.6400%)
time spent on training: 45.06691002845764
Starting performing KrMLRFL...
Num data points: [400, 471, 937, 998, 548, 813, 401, 487, 895, 436]
Num selected data points: [400 813 401 487 895 436]
The chosen ones are users: [0, 5, 6, 7, 8, 9], which are global users: [30, 64, 15, 97, 38, 9]
[PAIRWISE] pred_attackers_indx:  [0 2 3]
layer2_inf_t: 73.59912109375
assumed final_attacker_idxs:  [0 1 2 3 4 5]
final_attacker_idxs is: [0 1 2 3 4 5]
g_attacker_idxs: [30 27 92 67  2 64]
g_normal_idxs: [15 97 38  9]
filtered_attacker_idxs: [1, 2, 3, 4]
final_attacker_idxs are: [1, 2, 3, 4]
num_dps: [400, 471, 937, 998, 548, 813, 401, 487, 895, 436]
epoch_acc: 99.0
___Test Local_Simple poisoned: False, epoch: 246: Average loss: 0.0306, Accuracy: 9900/10000 (99.0000%)
___Test Local_Simple poisoned: True, epoch: 246: Average loss: 14.8536, Accuracy: 9/8968 (0.1004%)
Done in 52.861613273620605 sec.
Server Epoch:247 choose agents : [31, 81, 18, 34, 65, 1, 35, 62, 23, 47].
___Train Local_Simple,  epoch 247, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 247, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 834/835 (99.8802%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0458, Accuracy: 9863/10000 (98.6300%)
poison local model 81 index 0
___Train Local_Simple,  epoch 247, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1211/1227 (98.6960%)
___Train Local_Simple,  epoch 247, local model 81, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1218/1227 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.3488, Accuracy: 9030/10000 (90.3000%)
___Train Local_Simple,  epoch 247, local model 18, internal_epoch   1,  Average loss: 0.0003, Accuracy: 455/459 (99.1285%)
___Train Local_Simple,  epoch 247, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.2596, Accuracy: 9333/10000 (93.3300%)
poison local model 34 index 1
___Train Local_Simple,  epoch 247, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 410/413 (99.2736%)
___Train Local_Simple,  epoch 247, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0909, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch 247, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 247, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0963, Accuracy: 9726/10000 (97.2600%)
poison local model 1 index 2
___Train Local_Simple,  epoch 247, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch 247, local model 1, internal_epoch   2,  Average loss: 0.0003, Accuracy: 752/760 (98.9474%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.4263, Accuracy: 8789/10000 (87.8900%)
___Train Local_Simple,  epoch 247, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 247, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0467, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 247, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 247, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0686, Accuracy: 9790/10000 (97.9000%)
___Train Local_Simple,  epoch 247, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 247, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0339, Accuracy: 9888/10000 (98.8800%)
___Train Local_Simple,  epoch 247, local model 47, internal_epoch   1,  Average loss: 0.0004, Accuracy: 767/776 (98.8402%)
___Train Local_Simple,  epoch 247, local model 47, internal_epoch   2,  Average loss: 0.0005, Accuracy: 769/776 (99.0979%)
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0561, Accuracy: 9820/10000 (98.2000%)
time spent on training: 51.18972039222717
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [81, 34, 1]
base_p: [ 3.2835081e-04  2.6414543e-04 -9.1790687e-04 ...  7.9473853e-04
  2.8488711e-03  9.6127391e-05]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 5, 9]
layer1_inf_time: 3.762939453125
[PAIRWISE] pred_attackers_indx:  [1]
layer2_inf_t: 38.31396484375
assumed final_attacker_idxs:  [1 2 3 5 9]
final_attacker_idxs is: [1 2 3 5 9]
g_attacker_idxs: [81 18 34  1 47]
g_normal_idxs: [31 65 35 62 23]
filtered_attacker_idxs: [1, 3, 5, 9]
final_attacker_idxs are: [1, 3, 5, 9]
num_dps: [835, 1227, 459, 413, 371, 760, 499, 423, 293, 776]
Starting performing KrMLRFL...
Num data points: [835, 1227, 459, 413, 371, 760, 499, 423, 293, 776]
Num selected data points: [835 459 371 499 423 293]
The chosen ones are users: [0, 2, 4, 6, 7, 8], which are global users: [31, 18, 65, 35, 62, 23]
___Test Local_Simple poisoned: False, epoch: 247: Average loss: 0.0355, Accuracy: 9885/10000 (98.8500%)
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: True, epoch: 247: Average loss: 14.7024, Accuracy: 14/8968 (0.1561%)
Done in 56.62149167060852 sec.
Server Epoch:248 choose agents : [55, 12, 74, 4, 80, 97, 87, 35, 26, 6].
___Train Local_Simple,  epoch 248, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 248, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.2378, Accuracy: 9308/10000 (93.0800%)
___Train Local_Simple,  epoch 248, local model 12, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1147/1160 (98.8793%)
___Train Local_Simple,  epoch 248, local model 12, internal_epoch   2,  Average loss: 0.0020, Accuracy: 1115/1160 (96.1207%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.4821, Accuracy: 8934/10000 (89.3400%)
___Train Local_Simple,  epoch 248, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 551/557 (98.9228%)
___Train Local_Simple,  epoch 248, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.1195, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch 248, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch 248, local model 4, internal_epoch   2,  Average loss: 0.0006, Accuracy: 652/658 (99.0881%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.3042, Accuracy: 9173/10000 (91.7300%)
___Train Local_Simple,  epoch 248, local model 80, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 248, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.0671, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 248, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 248, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.1077, Accuracy: 9672/10000 (96.7200%)
___Train Local_Simple,  epoch 248, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 248, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.0421, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 248, local model 35, internal_epoch   1,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 248, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.0620, Accuracy: 9795/10000 (97.9500%)
poison local model 26 index 0
___Train Local_Simple,  epoch 248, local model 26, internal_epoch   1,  Average loss: 0.0002, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 248, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.0867, Accuracy: 9745/10000 (97.4500%)
___Train Local_Simple,  epoch 248, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 613/615 (99.6748%)
___Train Local_Simple,  epoch 248, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.0703, Accuracy: 9776/10000 (97.7600%)
time spent on training: 37.71828484535217
Starting performing KrMLRFL...
Num data points: [354, 1160, 557, 658, 431, 487, 470, 499, 554, 615]
Num selected data points: [354 557 431 487 470 499 615]
The chosen ones are users: [0, 2, 4, 5, 6, 7, 9], which are global users: [55, 74, 80, 97, 87, 35, 6]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26]
base_p: [ 1.08644366e-04  7.40308315e-05 -7.70958140e-04 ... -7.55667686e-04
  1.72212720e-04  7.71552324e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 8]
layer1_inf_time: 3.606689453125
[PAIRWISE] pred_attackers_indx:  [1]
layer2_inf_t: 205.15869140625
assumed final_attacker_idxs:  [0 1 2 3 8]
final_attacker_idxs is: [0 1 2 3 8]
g_attacker_idxs: [55 12 74  4 26]
g_normal_idxs: [80 97 87 35  6]
filtered_attacker_idxs: [1, 3, 8]
final_attacker_idxs are: [1, 3, 8]
num_dps: [354, 1160, 557, 658, 431, 487, 470, 499, 554, 615]
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: False, epoch: 248: Average loss: 0.0350, Accuracy: 9885/10000 (98.8500%)
___Test Local_Simple poisoned: True, epoch: 248: Average loss: 14.2043, Accuracy: 21/8968 (0.2342%)
Done in 45.44089889526367 sec.
Server Epoch:249 choose agents : [37, 8, 71, 89, 47, 42, 23, 55, 99, 93].
___Train Local_Simple,  epoch 249, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%)
___Train Local_Simple,  epoch 249, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 855/860 (99.4186%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.0573, Accuracy: 9820/10000 (98.2000%)
___Train Local_Simple,  epoch 249, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 626/633 (98.8942%)
___Train Local_Simple,  epoch 249, local model 8, internal_epoch   2,  Average loss: 0.0004, Accuracy: 626/633 (98.8942%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.1885, Accuracy: 9418/10000 (94.1800%)
poison local model 71 index 0
___Train Local_Simple,  epoch 249, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1370/1384 (98.9884%)
___Train Local_Simple,  epoch 249, local model 71, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1383/1384 (99.9277%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.2208, Accuracy: 9231/10000 (92.3100%)
___Train Local_Simple,  epoch 249, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 490/492 (99.5935%)
___Train Local_Simple,  epoch 249, local model 89, internal_epoch   2,  Average loss: 0.0002, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.0676, Accuracy: 9791/10000 (97.9100%)
___Train Local_Simple,  epoch 249, local model 47, internal_epoch   1,  Average loss: 0.0004, Accuracy: 769/776 (99.0979%)
___Train Local_Simple,  epoch 249, local model 47, internal_epoch   2,  Average loss: 0.0007, Accuracy: 771/776 (99.3557%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.1040, Accuracy: 9687/10000 (96.8700%)
poison local model 42 index 1
___Train Local_Simple,  epoch 249, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 249, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.0744, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch 249, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 249, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.0816, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch 249, local model 55, internal_epoch   1,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Train Local_Simple,  epoch 249, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.0751, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch 249, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Train Local_Simple,  epoch 249, local model 99, internal_epoch   2,  Average loss: 0.0000, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.0406, Accuracy: 9877/10000 (98.7700%)
poison local model 93 index 2
___Train Local_Simple,  epoch 249, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 249, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.4011, Accuracy: 9052/10000 (90.5200%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 42, 93]
base_p: [-2.5862455e-04  1.3076887e-04 -9.0179034e-05 ... -1.0027289e-03
 -3.6500394e-04 -2.1222234e-04]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 9]
layer1_inf_time: 2.815673828125
[PAIRWISE] pred_attackers_indx:  [2 4 9]
layer2_inf_t: 30.36181640625
assumed final_attacker_idxs:  [2 4 5 7 9]
final_attacker_idxs is: [2 4 5 7 9]
g_attacker_idxs: [71 47 42 55 93]
g_normal_idxs: [37  8 89 23 99]
filtered_attacker_idxs: [2, 4, 5, 9]
final_attacker_idxs are: [2, 4, 5, 9]
num_dps: [860, 633, 1384, 492, 776, 236, 293, 354, 377, 623]
time spent on training: 45.72150635719299
Starting performing KrMLRFL...
Num data points: [860, 633, 1384, 492, 776, 236, 293, 354, 377, 623]
Num selected data points: [860 633 492 293 354 377]
The chosen ones are users: [0, 1, 3, 6, 7, 8], which are global users: [37, 8, 89, 23, 55, 99]
epoch_acc: 98.78
___Test Local_Simple poisoned: False, epoch: 249: Average loss: 0.0375, Accuracy: 9878/10000 (98.7800%)
___Test Local_Simple poisoned: True, epoch: 249: Average loss: 13.2453, Accuracy: 24/8968 (0.2676%)
Done in 53.53604531288147 sec.
Server Epoch:250 choose agents : [43, 81, 88, 67, 65, 73, 39, 0, 15, 10].
___Train Local_Simple,  epoch 250, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 250, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0445, Accuracy: 9858/10000 (98.5800%)
poison local model 81 index 0
___Train Local_Simple,  epoch 250, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1214/1227 (98.9405%)
___Train Local_Simple,  epoch 250, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1217/1227 (99.1850%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.4852, Accuracy: 8771/10000 (87.7100%)
___Train Local_Simple,  epoch 250, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 250, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0509, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 250, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 990/998 (99.1984%)
___Train Local_Simple,  epoch 250, local model 67, internal_epoch   2,  Average loss: 0.0003, Accuracy: 994/998 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0828, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch 250, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 250, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0372, Accuracy: 9875/10000 (98.7500%)
poison local model 73 index 1
___Train Local_Simple,  epoch 250, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 587/591 (99.3232%)
___Train Local_Simple,  epoch 250, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 585/591 (98.9848%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.1076, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch 250, local model 39, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch 250, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0378, Accuracy: 9881/10000 (98.8100%)
___Train Local_Simple,  epoch 250, local model 0, internal_epoch   1,  Average loss: 0.0003, Accuracy: 432/435 (99.3103%)
___Train Local_Simple,  epoch 250, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0791, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch 250, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 250, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0362, Accuracy: 9878/10000 (98.7800%)
___Train Local_Simple,  epoch 250, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 250, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0583, Accuracy: 9823/10000 (98.2300%)
time spent on training: 47.6709041595459
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [81, 73]
base_p: [-0.00017675  0.00018412 -0.00022804 ... -0.00036527 -0.00357654
 -0.0015026 ]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 7, 8]
layer1_inf_time: 3.892822265625
[PAIRWISE] pred_attackers_indx:  [1 5]
layer2_inf_t: 276.187744140625
assumed final_attacker_idxs:  [1 3 5 7 8]
final_attacker_idxs is: [1 3 5 7 8]
g_attacker_idxs: [81 67 73  0 15]
g_normal_idxs: [43 88 65 39 10]
filtered_attacker_idxs: [1, 3, 5]
final_attacker_idxs are: [1, 3, 5]
num_dps: [408, 1227, 530, 998, 371, 591, 257, 435, 401, 892]
Num data points: [408, 1227, 530, 998, 371, 591, 257, 435, 401, 892]
Num selected data points: [408 530 371 257 435 401 892]
The chosen ones are users: [0, 2, 4, 6, 7, 8, 9], which are global users: [43, 88, 65, 39, 0, 15, 10]
epoch_acc: 98.99
___Test Local_Simple poisoned: False, epoch: 250: Average loss: 0.0314, Accuracy: 9899/10000 (98.9900%)
___Test Local_Simple poisoned: True, epoch: 250: Average loss: 14.3150, Accuracy: 8/8968 (0.0892%)
Done in 55.45106887817383 sec.
Server Epoch:251 choose agents : [99, 71, 35, 13, 9, 55, 58, 93, 23, 11].
___Train Local_Simple,  epoch 251, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch 251, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.0342, Accuracy: 9892/10000 (98.9200%)
poison local model 71 index 0
___Train Local_Simple,  epoch 251, local model 71, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1376/1384 (99.4220%)
___Train Local_Simple,  epoch 251, local model 71, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1368/1384 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.2623, Accuracy: 9221/10000 (92.2100%)
___Train Local_Simple,  epoch 251, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 251, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.0740, Accuracy: 9768/10000 (97.6800%)
poison local model 13 index 1
___Train Local_Simple,  epoch 251, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%)
___Train Local_Simple,  epoch 251, local model 13, internal_epoch   2,  Average loss: 0.0001, Accuracy: 732/734 (99.7275%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.1574, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch 251, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 251, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.0644, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch 251, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 251, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.1122, Accuracy: 9662/10000 (96.6200%)
___Train Local_Simple,  epoch 251, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 272/276 (98.5507%)
___Train Local_Simple,  epoch 251, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.1234, Accuracy: 9594/10000 (95.9400%)
poison local model 93 index 2
___Train Local_Simple,  epoch 251, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 251, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.2469, Accuracy: 9364/10000 (93.6400%)
___Train Local_Simple,  epoch 251, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 251, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.0366, Accuracy: 9891/10000 (98.9100%)
poison local model 11 index 3
___Train Local_Simple,  epoch 251, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 639/645 (99.0698%)
___Train Local_Simple,  epoch 251, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 640/645 (99.2248%)
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.2313, Accuracy: 9266/10000 (92.6600%)
time spent on training: 54.58996105194092
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 13, 93, 11]
base_p: [ 0.00045204  0.00012813 -0.00015947 ... -0.00266832  0.00077379
  0.00029927]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 7, 9]
layer1_inf_time: 3.548828125
[PAIRWISE] pred_attackers_indx:  [1 3 5 7 9]
layer2_inf_t: 32.86474609375
assumed final_attacker_idxs:  [1 3 5 7 9]
final_attacker_idxs is: [1 3 5 7 9]
g_attacker_idxs: [71 13 55 93 11]
g_normal_idxs: [99 35  9 58 23]
filtered_attacker_idxs: [1, 3, 7, 9]
final_attacker_idxs are: [1, 3, 7, 9]
num_dps: [377, 1384, 499, 734, 436, 354, 276, 623, 293, 645]
Starting performing KrMLRFL...
Num data points: [377, 1384, 499, 734, 436, 354, 276, 623, 293, 645]
Num selected data points: [377 499 436 354 276 293]
The chosen ones are users: [0, 2, 4, 5, 6, 8], which are global users: [99, 35, 9, 55, 58, 23]
___Test Local_Simple poisoned: False, epoch: 251: Average loss: 0.0334, Accuracy: 9888/10000 (98.8800%)
epoch_acc: 98.88
___Test Local_Simple poisoned: True, epoch: 251: Average loss: 14.7453, Accuracy: 10/8968 (0.1115%)
Done in 62.12641143798828 sec.
Server Epoch:252 choose agents : [36, 67, 51, 25, 10, 59, 41, 44, 60, 61].
___Train Local_Simple,  epoch 252, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 992/1005 (98.7065%)
___Train Local_Simple,  epoch 252, local model 36, internal_epoch   2,  Average loss: 0.0004, Accuracy: 995/1005 (99.0050%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.2971, Accuracy: 9083/10000 (90.8300%)
___Train Local_Simple,  epoch 252, local model 67, internal_epoch   1,  Average loss: 0.0007, Accuracy: 984/998 (98.5972%)
___Train Local_Simple,  epoch 252, local model 67, internal_epoch   2,  Average loss: 0.0008, Accuracy: 981/998 (98.2966%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.0921, Accuracy: 9713/10000 (97.1300%)
poison local model 51 index 0
___Train Local_Simple,  epoch 252, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 252, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 568/568 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.1334, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch 252, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%)
___Train Local_Simple,  epoch 252, local model 25, internal_epoch   2,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.0909, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch 252, local model 10, internal_epoch   1,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 252, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.0476, Accuracy: 9844/10000 (98.4400%)
___Train Local_Simple,  epoch 252, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch 252, local model 59, internal_epoch   2,  Average loss: 0.0004, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.1471, Accuracy: 9529/10000 (95.2900%)
___Train Local_Simple,  epoch 252, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 597/606 (98.5149%)
___Train Local_Simple,  epoch 252, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.2415, Accuracy: 9220/10000 (92.2000%)
___Train Local_Simple,  epoch 252, local model 44, internal_epoch   1,  Average loss: 0.0007, Accuracy: 515/517 (99.6132%)
___Train Local_Simple,  epoch 252, local model 44, internal_epoch   2,  Average loss: 0.0073, Accuracy: 480/517 (92.8433%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.2609, Accuracy: 9285/10000 (92.8500%)
___Train Local_Simple,  epoch 252, local model 60, internal_epoch   1,  Average loss: 0.0005, Accuracy: 335/338 (99.1124%)
___Train Local_Simple,  epoch 252, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 337/338 (99.7041%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.0822, Accuracy: 9748/10000 (97.4800%)
poison local model 61 index 1
___Train Local_Simple,  epoch 252, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 688/699 (98.4263%)
___Train Local_Simple,  epoch 252, local model 61, internal_epoch   2,  Average loss: 0.0003, Accuracy: 695/699 (99.4278%)
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.2944, Accuracy: 9058/10000 (90.5800%)
time spent on training: 44.16541862487793
Starting performing KrMLRFL...
Num data points: [1005, 998, 568, 647, 892, 760, 606, 517, 338, 699]
Num selected data points: [647 892 606 517 338]
The chosen ones are users: [3, 4, 6, 7, 8], which are global users: [25, 10, 41, 44, 60]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 61]
base_p: [ 0.00025686  0.00012886 -0.0002756  ... -0.00129902 -0.00518819
  0.00080851]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 7, 9]
layer1_inf_time: 4.2783203125
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 41.65380859375
assumed final_attacker_idxs:  [0 1 2 5 7 9]
final_attacker_idxs is: [0 1 2 5 7 9]
g_attacker_idxs: [36 67 51 59 44 61]
g_normal_idxs: [25 10 41 60]
filtered_attacker_idxs: [0, 1, 2, 5, 9]
final_attacker_idxs are: [0, 1, 2, 5, 9]
num_dps: [1005, 998, 568, 647, 892, 760, 606, 517, 338, 699]
epoch_acc: 97.87
___Test Local_Simple poisoned: False, epoch: 252: Average loss: 0.0703, Accuracy: 9787/10000 (97.8700%)
___Test Local_Simple poisoned: True, epoch: 252: Average loss: 11.2927, Accuracy: 40/8968 (0.4460%)
Done in 54.354329347610474 sec.
Server Epoch:253 choose agents : [62, 76, 91, 4, 51, 15, 61, 63, 9, 40].
___Train Local_Simple,  epoch 253, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch 253, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.0436, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 253, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 253, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.0677, Accuracy: 9795/10000 (97.9500%)
poison local model 91 index 0
___Train Local_Simple,  epoch 253, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Train Local_Simple,  epoch 253, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.0678, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch 253, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 646/658 (98.1763%)
___Train Local_Simple,  epoch 253, local model 4, internal_epoch   2,  Average loss: 0.0009, Accuracy: 649/658 (98.6322%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.3327, Accuracy: 9034/10000 (90.3400%)
poison local model 51 index 1
___Train Local_Simple,  epoch 253, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 566/568 (99.6479%)
___Train Local_Simple,  epoch 253, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.0933, Accuracy: 9716/10000 (97.1600%)
___Train Local_Simple,  epoch 253, local model 15, internal_epoch   1,  Average loss: 0.0010, Accuracy: 391/401 (97.5062%)
___Train Local_Simple,  epoch 253, local model 15, internal_epoch   2,  Average loss: 0.0006, Accuracy: 394/401 (98.2544%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.3534, Accuracy: 9142/10000 (91.4200%)
poison local model 61 index 2
___Train Local_Simple,  epoch 253, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 688/699 (98.4263%)
___Train Local_Simple,  epoch 253, local model 61, internal_epoch   2,  Average loss: 0.0009, Accuracy: 691/699 (98.8555%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.3076, Accuracy: 8949/10000 (89.4900%)
poison local model 63 index 3
___Train Local_Simple,  epoch 253, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 868/889 (97.6378%)
___Train Local_Simple,  epoch 253, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 877/889 (98.6502%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.1083, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch 253, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 253, local model 9, internal_epoch   2,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.1015, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch 253, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 766/772 (99.2228%)
___Train Local_Simple,  epoch 253, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 51, 61, 63]
base_p: [ 1.2548417e-03  7.2496012e-05 -2.4441257e-04 ...  6.7372620e-04
  1.1371151e-03  3.5088509e-04]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 9]
layer1_inf_time: 4.056640625
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.1093, Accuracy: 9674/10000 (96.7400%)
time spent on training: 52.81806755065918
Starting performing KrMLRFL...
Num data points: [423, 78, 256, 658, 568, 401, 699, 889, 436, 772]
Num selected data points: [423  78 256 401 436]
The chosen ones are users: [0, 1, 2, 5, 8], which are global users: [62, 76, 91, 15, 9]
[PAIRWISE] pred_attackers_indx:  [3 5 6]
layer2_inf_t: 134.015380859375
assumed final_attacker_idxs:  [3 4 5 6 7 9]
final_attacker_idxs is: [3 4 5 6 7 9]
g_attacker_idxs: [ 4 51 15 61 63 40]
g_normal_idxs: [62 76 91  9]
filtered_attacker_idxs: [3, 4, 6, 7, 9]
final_attacker_idxs are: [3, 4, 6, 7, 9]
num_dps: [423, 78, 256, 658, 568, 401, 699, 889, 436, 772]
epoch_acc: 98.88
___Test Local_Simple poisoned: False, epoch: 253: Average loss: 0.0349, Accuracy: 9888/10000 (98.8800%)
___Test Local_Simple poisoned: True, epoch: 253: Average loss: 13.3269, Accuracy: 8/8968 (0.0892%)
Done in 59.55095291137695 sec.
Server Epoch:254 choose agents : [1, 29, 49, 15, 39, 20, 26, 87, 37, 82].
poison local model 1 index 0
___Train Local_Simple,  epoch 254, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 254, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 752/760 (98.9474%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.1181, Accuracy: 9627/10000 (96.2700%)
___Train Local_Simple,  epoch 254, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%)
___Train Local_Simple,  epoch 254, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.2158, Accuracy: 9378/10000 (93.7800%)
___Train Local_Simple,  epoch 254, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 254, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.0538, Accuracy: 9819/10000 (98.1900%)
___Train Local_Simple,  epoch 254, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 254, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.0415, Accuracy: 9868/10000 (98.6800%)
___Train Local_Simple,  epoch 254, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch 254, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.0776, Accuracy: 9766/10000 (97.6600%)
poison local model 20 index 1
___Train Local_Simple,  epoch 254, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 254, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.2691, Accuracy: 9299/10000 (92.9900%)
poison local model 26 index 2
___Train Local_Simple,  epoch 254, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 548/554 (98.9170%)
___Train Local_Simple,  epoch 254, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.0908, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch 254, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 254, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.0519, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 254, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 859/860 (99.8837%)
___Train Local_Simple,  epoch 254, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 859/860 (99.8837%)
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.0802, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch 254, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch 254, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
type of model <class 'models.MnistNet.MnistNet'>
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.5274, Accuracy: 8801/10000 (88.0100%)
time spent on training: 53.26994299888611
Starting performing KrMLRFL...
Num data points: [760, 1002, 506, 401, 257, 429, 554, 470, 860, 713]
Num selected data points: [1002  401  257  470  860]
The chosen ones are users: [1, 3, 4, 7, 8], which are global users: [29, 15, 39, 87, 37]
selected_attackers: [1, 20, 26]
base_p: [ 2.63672322e-04  7.69328326e-05 -1.02686696e-04 ... -2.54712999e-03
  9.81174409e-04  1.00222230e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 5, 6, 9]
layer1_inf_time: 4.671630859375
[PAIRWISE] pred_attackers_indx:  [2 4 5 6 7 8]
layer2_inf_t: 634.481689453125
assumed final_attacker_idxs:  [0 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 2 3 4 5 6 7 8 9]
g_attacker_idxs: [ 1 49 15 39 20 26 87 37 82]
g_normal_idxs: [29]
filtered_attacker_idxs: [0, 2, 5, 6, 9]
final_attacker_idxs are: [0, 2, 5, 6, 9]
num_dps: [760, 1002, 506, 401, 257, 429, 554, 470, 860, 713]
___Test Local_Simple poisoned: False, epoch: 254: Average loss: 0.0410, Accuracy: 9858/10000 (98.5800%)
epoch_acc: 98.58
___Test Local_Simple poisoned: True, epoch: 254: Average loss: 12.7996, Accuracy: 33/8968 (0.3680%)
Done in 59.33547878265381 sec.
Server Epoch:255 choose agents : [82, 22, 75, 99, 30, 7, 98, 58, 28, 60].
___Train Local_Simple,  epoch 255, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 704/713 (98.7377%)
___Train Local_Simple,  epoch 255, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.4244, Accuracy: 8856/10000 (88.5600%)
poison local model 22 index 0
___Train Local_Simple,  epoch 255, local model 22, internal_epoch   1,  Average loss: 0.0011, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 255, local model 22, internal_epoch   2,  Average loss: 0.0003, Accuracy: 580/583 (99.4854%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0928, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch 255, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch 255, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0636, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 255, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch 255, local model 99, internal_epoch   2,  Average loss: 0.0003, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0455, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 255, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch 255, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0983, Accuracy: 9701/10000 (97.0100%)
poison local model 7 index 1
___Train Local_Simple,  epoch 255, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 412/418 (98.5646%)
___Train Local_Simple,  epoch 255, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.1345, Accuracy: 9593/10000 (95.9300%)
___Train Local_Simple,  epoch 255, local model 98, internal_epoch   1,  Average loss: 0.0009, Accuracy: 804/818 (98.2885%)
___Train Local_Simple,  epoch 255, local model 98, internal_epoch   2,  Average loss: 0.0008, Accuracy: 806/818 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.2698, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch 255, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 274/276 (99.2754%)
___Train Local_Simple,  epoch 255, local model 58, internal_epoch   2,  Average loss: 0.0003, Accuracy: 275/276 (99.6377%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0599, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 255, local model 28, internal_epoch   1,  Average loss: 0.0003, Accuracy: 496/501 (99.0020%)
___Train Local_Simple,  epoch 255, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0969, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch 255, local model 60, internal_epoch   1,  Average loss: 0.0004, Accuracy: 335/338 (99.1124%)
___Train Local_Simple,  epoch 255, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0445, Accuracy: 9855/10000 (98.5500%)
time spent on training: 44.17928910255432
Starting performing KrMLRFL...
Num data points: [713, 583, 686, 377, 400, 418, 818, 276, 501, 338]
Num selected data points: [686 377 400 276 501 338]
The chosen ones are users: [2, 3, 4, 7, 8, 9], which are global users: [75, 99, 30, 58, 28, 60]
___Test Local_Simple poisoned: False, epoch: 255: Average loss: 0.0332, Accuracy: 9888/10000 (98.8800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 7]
base_p: [-0.0003257   0.00013403  0.00032171 ... -0.00092331  0.0005156
  0.00187542]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6]
layer1_inf_time: 2.955810546875
[PAIRWISE] pred_attackers_indx:  [0 6]
layer2_inf_t: 33.718505859375
assumed final_attacker_idxs:  [0 1 2 5 6]
final_attacker_idxs is: [0 1 2 5 6]
g_attacker_idxs: [82 22 75  7 98]
g_normal_idxs: [99 30 58 28 60]
filtered_attacker_idxs: [0, 1, 5, 6]
final_attacker_idxs are: [0, 1, 5, 6]
num_dps: [713, 583, 686, 377, 400, 418, 818, 276, 501, 338]
epoch_acc: 98.88
___Test Local_Simple poisoned: True, epoch: 255: Average loss: 14.5493, Accuracy: 7/8968 (0.0781%)
Done in 51.40311074256897 sec.
Server Epoch:256 choose agents : [82, 18, 22, 3, 79, 55, 2, 7, 58, 45].
___Train Local_Simple,  epoch 256, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch 256, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.3385, Accuracy: 9062/10000 (90.6200%)
___Train Local_Simple,  epoch 256, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 458/459 (99.7821%)
___Train Local_Simple,  epoch 256, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.0641, Accuracy: 9806/10000 (98.0600%)
poison local model 22 index 0
___Train Local_Simple,  epoch 256, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 256, local model 22, internal_epoch   2,  Average loss: 0.0006, Accuracy: 580/583 (99.4854%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.1202, Accuracy: 9610/10000 (96.1000%)
___Train Local_Simple,  epoch 256, local model 3, internal_epoch   1,  Average loss: 0.0007, Accuracy: 911/923 (98.6999%)
___Train Local_Simple,  epoch 256, local model 3, internal_epoch   2,  Average loss: 0.0009, Accuracy: 902/923 (97.7248%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.1229, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch 256, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch 256, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.0363, Accuracy: 9889/10000 (98.8900%)
___Train Local_Simple,  epoch 256, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 256, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.1170, Accuracy: 9644/10000 (96.4400%)
poison local model 2 index 1
___Train Local_Simple,  epoch 256, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 541/548 (98.7226%)
___Train Local_Simple,  epoch 256, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 545/548 (99.4526%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.1069, Accuracy: 9690/10000 (96.9000%)
poison local model 7 index 2
___Train Local_Simple,  epoch 256, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 415/418 (99.2823%)
___Train Local_Simple,  epoch 256, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.1205, Accuracy: 9625/10000 (96.2500%)
___Train Local_Simple,  epoch 256, local model 58, internal_epoch   1,  Average loss: 0.0004, Accuracy: 274/276 (99.2754%)
___Train Local_Simple,  epoch 256, local model 58, internal_epoch   2,  Average loss: 0.0000, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.1467, Accuracy: 9562/10000 (95.6200%)
poison local model 45 index 3
___Train Local_Simple,  epoch 256, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 256, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 621/628 (98.8854%)
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.1367, Accuracy: 9497/10000 (94.9700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 2, 7, 45]
base_p: [-1.4606863e-05 -4.0996820e-06 -4.9217232e-04 ... -1.3380796e-03
 -3.2830238e-04  3.0861050e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 6, 7, 9]
layer1_inf_time: 3.3369140625
[PAIRWISE] pred_attackers_indx:  [2 3 7 9]
layer2_inf_t: 33.38037109375
assumed final_attacker_idxs:  [0 2 3 6 7 9]
final_attacker_idxs is: [0 2 3 6 7 9]
g_attacker_idxs: [82 22  3  2  7 45]
g_normal_idxs: [18 79 55 58]
filtered_attacker_idxs: [0, 2, 3, 6, 7, 9]
final_attacker_idxs are: [0, 2, 3, 6, 7, 9]
num_dps: [713, 459, 583, 923, 182, 354, 548, 418, 276, 628]
time spent on training: 54.20986723899841
Starting performing KrMLRFL...
Num data points: [713, 459, 583, 923, 182, 354, 548, 418, 276, 628]
Num selected data points: [459 182 354 276]
The chosen ones are users: [1, 4, 5, 8], which are global users: [18, 79, 55, 58]
___Test Local_Simple poisoned: False, epoch: 256: Average loss: 0.0419, Accuracy: 9862/10000 (98.6200%)
epoch_acc: 98.61999999999999
___Test Local_Simple poisoned: True, epoch: 256: Average loss: 14.0218, Accuracy: 11/8968 (0.1227%)
Done in 63.57254076004028 sec.
Server Epoch:257 choose agents : [47, 56, 37, 75, 83, 70, 74, 97, 64, 63].
___Train Local_Simple,  epoch 257, local model 47, internal_epoch   1,  Average loss: 0.0004, Accuracy: 770/776 (99.2268%)
___Train Local_Simple,  epoch 257, local model 47, internal_epoch   2,  Average loss: 0.0007, Accuracy: 767/776 (98.8402%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0781, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 257, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 878/880 (99.7727%)
___Train Local_Simple,  epoch 257, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 879/880 (99.8864%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0471, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 257, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 856/860 (99.5349%)
___Train Local_Simple,  epoch 257, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 858/860 (99.7674%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0841, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch 257, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 680/686 (99.1254%)
___Train Local_Simple,  epoch 257, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 681/686 (99.2711%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0633, Accuracy: 9805/10000 (98.0500%)
___Train Local_Simple,  epoch 257, local model 83, internal_epoch   1,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Train Local_Simple,  epoch 257, local model 83, internal_epoch   2,  Average loss: 0.0000, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0452, Accuracy: 9855/10000 (98.5500%)
poison local model 70 index 0
___Train Local_Simple,  epoch 257, local model 70, internal_epoch   1,  Average loss: 0.0012, Accuracy: 706/724 (97.5138%)
___Train Local_Simple,  epoch 257, local model 70, internal_epoch   2,  Average loss: 0.0008, Accuracy: 715/724 (98.7569%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.1879, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch 257, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 548/557 (98.3842%)
___Train Local_Simple,  epoch 257, local model 74, internal_epoch   2,  Average loss: 0.0005, Accuracy: 552/557 (99.1023%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0584, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 257, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 257, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0627, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch 257, local model 64, internal_epoch   1,  Average loss: 0.0002, Accuracy: 810/813 (99.6310%)
___Train Local_Simple,  epoch 257, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.1189, Accuracy: 9608/10000 (96.0800%)
poison local model 63 index 1
___Train Local_Simple,  epoch 257, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 873/889 (98.2002%)
___Train Local_Simple,  epoch 257, local model 63, internal_epoch   2,  Average loss: 0.0004, Accuracy: 884/889 (99.4376%)
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0771, Accuracy: 9773/10000 (97.7300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 63]
base_p: [ 3.5721436e-04  1.6694330e-04 -2.6886351e-05 ... -2.1625012e-03
 -2.4553388e-04  1.0966286e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 5, 8, 9]
layer1_inf_time: 3.450927734375
[PAIRWISE] pred_attackers_indx:  [0 5 8 9]
layer2_inf_t: 29.462890625
assumed final_attacker_idxs:  [0 3 5 8 9]
final_attacker_idxs is: [0 3 5 8 9]
g_attacker_idxs: [47 75 70 64 63]
g_normal_idxs: [56 37 83 74 97]
filtered_attacker_idxs: [0, 5, 9]
final_attacker_idxs are: [0, 5, 9]
num_dps: [776, 880, 860, 686, 433, 724, 557, 487, 813, 889]
time spent on training: 99.1243462562561
Starting performing KrMLRFL...
Num data points: [776, 880, 860, 686, 433, 724, 557, 487, 813, 889]
Num selected data points: [880 860 686 433 557 487 813]
The chosen ones are users: [1, 2, 3, 4, 6, 7, 8], which are global users: [56, 37, 75, 83, 74, 97, 64]
epoch_acc: 98.97
___Test Local_Simple poisoned: False, epoch: 257: Average loss: 0.0319, Accuracy: 9897/10000 (98.9700%)
___Test Local_Simple poisoned: True, epoch: 257: Average loss: 13.3346, Accuracy: 16/8968 (0.1784%)
Done in 106.31587052345276 sec.
Server Epoch:258 choose agents : [25, 26, 75, 1, 82, 31, 68, 53, 0, 16].
___Train Local_Simple,  epoch 258, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%)
___Train Local_Simple,  epoch 258, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0642, Accuracy: 9780/10000 (97.8000%)
poison local model 26 index 0
___Train Local_Simple,  epoch 258, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 258, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0587, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 258, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Train Local_Simple,  epoch 258, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0406, Accuracy: 9872/10000 (98.7200%)
poison local model 1 index 1
___Train Local_Simple,  epoch 258, local model 1, internal_epoch   1,  Average loss: 0.0009, Accuracy: 746/760 (98.1579%)
___Train Local_Simple,  epoch 258, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.2397, Accuracy: 9178/10000 (91.7800%)
___Train Local_Simple,  epoch 258, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch 258, local model 82, internal_epoch   2,  Average loss: 0.0003, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.3850, Accuracy: 8963/10000 (89.6300%)
___Train Local_Simple,  epoch 258, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Train Local_Simple,  epoch 258, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0545, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 258, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Train Local_Simple,  epoch 258, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0915, Accuracy: 9704/10000 (97.0400%)
___Train Local_Simple,  epoch 258, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 258, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.1840, Accuracy: 9464/10000 (94.6400%)
___Train Local_Simple,  epoch 258, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Train Local_Simple,  epoch 258, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0548, Accuracy: 9830/10000 (98.3000%)
poison local model 16 index 2
___Train Local_Simple,  epoch 258, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 905/915 (98.9071%)
___Train Local_Simple,  epoch 258, local model 16, internal_epoch   2,  Average loss: 0.0003, Accuracy: 909/915 (99.3443%)
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0930, Accuracy: 9734/10000 (97.3400%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 1, 16]
base_p: [0.00020873 0.0002049  0.00011896 ... 0.00034964 0.00264049 0.00078655]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 7, 9]
layer1_inf_time: 3.27197265625
[PAIRWISE] pred_attackers_indx:  [0 3 4 7]
layer2_inf_t: 43.526123046875
assumed final_attacker_idxs:  [0 1 3 4 7 9]
final_attacker_idxs is: [0 1 3 4 7 9]
g_attacker_idxs: [25 26  1 82 53 16]
g_normal_idxs: [75 31 68  0]
filtered_attacker_idxs: [0, 1, 3, 4, 7, 9]
final_attacker_idxs are: [0, 1, 3, 4, 7, 9]
num_dps: [647, 554, 686, 760, 713, 835, 494, 739, 435, 915]
time spent on training: 70.90468621253967
Starting performing KrMLRFL...
Num data points: [647, 554, 686, 760, 713, 835, 494, 739, 435, 915]
Num selected data points: [686 835 494 435]
The chosen ones are users: [2, 5, 6, 8], which are global users: [75, 31, 68, 0]
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: False, epoch: 258: Average loss: 0.0365, Accuracy: 9885/10000 (98.8500%)
___Test Local_Simple poisoned: True, epoch: 258: Average loss: 14.7058, Accuracy: 11/8968 (0.1227%)
Done in 75.89274311065674 sec.
Server Epoch:259 choose agents : [10, 12, 60, 41, 68, 56, 13, 4, 37, 18].
___Train Local_Simple,  epoch 259, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 259, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.0679, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch 259, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1143/1160 (98.5345%)
___Train Local_Simple,  epoch 259, local model 12, internal_epoch   2,  Average loss: 0.0037, Accuracy: 1075/1160 (92.6724%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.5321, Accuracy: 8506/10000 (85.0600%)
___Train Local_Simple,  epoch 259, local model 60, internal_epoch   1,  Average loss: 0.0003, Accuracy: 335/338 (99.1124%)
___Train Local_Simple,  epoch 259, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.0670, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 259, local model 41, internal_epoch   1,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
___Train Local_Simple,  epoch 259, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.0864, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch 259, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 259, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.0433, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 259, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 259, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.0456, Accuracy: 9850/10000 (98.5000%)
poison local model 13 index 0
___Train Local_Simple,  epoch 259, local model 13, internal_epoch   1,  Average loss: 0.0004, Accuracy: 726/734 (98.9101%)
___Train Local_Simple,  epoch 259, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.1083, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch 259, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch 259, local model 4, internal_epoch   2,  Average loss: 0.0001, Accuracy: 658/658 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.2166, Accuracy: 9396/10000 (93.9600%)
___Train Local_Simple,  epoch 259, local model 37, internal_epoch   1,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Train Local_Simple,  epoch 259, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.0644, Accuracy: 9800/10000 (98.0000%)
___Train Local_Simple,  epoch 259, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 259, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.1227, Accuracy: 9645/10000 (96.4500%)
time spent on training: 37.3411123752594
Starting performing KrMLRFL...
Num data points: [892, 1160, 338, 606, 494, 880, 734, 658, 860, 459]
Num selected data points: [892 494 880 860 459]
The chosen ones are users: [0, 4, 5, 8, 9], which are global users: [10, 68, 56, 37, 18]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13]
base_p: [-4.0387362e-04  8.6370856e-06  1.1838786e-04 ... -2.1628737e-03
 -1.3142526e-03 -1.1295900e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 6, 7]
layer1_inf_time: 4.72216796875
[PAIRWISE] pred_attackers_indx:  [1 6 9]
layer2_inf_t: 177.9169921875
assumed final_attacker_idxs:  [1 2 3 6 7 9]
final_attacker_idxs is: [1 2 3 6 7 9]
g_attacker_idxs: [12 60 41 13  4 18]
g_normal_idxs: [10 68 56 37]
filtered_attacker_idxs: [1, 2, 3, 6, 7]
final_attacker_idxs are: [1, 2, 3, 6, 7]
num_dps: [892, 1160, 338, 606, 494, 880, 734, 658, 860, 459]
___Test Local_Simple poisoned: False, epoch: 259: Average loss: 0.0338, Accuracy: 9894/10000 (98.9400%)
epoch_acc: 98.94
___Test Local_Simple poisoned: True, epoch: 259: Average loss: 15.1296, Accuracy: 10/8968 (0.1115%)
Done in 44.3296959400177 sec.
Server Epoch:260 choose agents : [7, 37, 15, 72, 85, 35, 21, 89, 99, 79].
poison local model 7 index 0
___Train Local_Simple,  epoch 260, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 260, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.3057, Accuracy: 9214/10000 (92.1400%)
___Train Local_Simple,  epoch 260, local model 37, internal_epoch   1,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Train Local_Simple,  epoch 260, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0647, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 260, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 260, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0401, Accuracy: 9863/10000 (98.6300%)
___Train Local_Simple,  epoch 260, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 729/731 (99.7264%)
___Train Local_Simple,  epoch 260, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 729/731 (99.7264%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0729, Accuracy: 9769/10000 (97.6900%)
poison local model 85 index 1
___Train Local_Simple,  epoch 260, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 260, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0823, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 260, local model 35, internal_epoch   1,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 260, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0654, Accuracy: 9792/10000 (97.9200%)
___Train Local_Simple,  epoch 260, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch 260, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0644, Accuracy: 9805/10000 (98.0500%)
___Train Local_Simple,  epoch 260, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Train Local_Simple,  epoch 260, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0494, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 260, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Train Local_Simple,  epoch 260, local model 99, internal_epoch   2,  Average loss: 0.0000, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0368, Accuracy: 9884/10000 (98.8400%)
___Train Local_Simple,  epoch 260, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch 260, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 85]
base_p: [ 2.5490671e-04  1.0936707e-04  3.5529956e-05 ... -3.1896532e-03
 -2.7258694e-03  5.9910119e-05]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 4]
layer1_inf_time: 3.207275390625
[PAIRWISE] pred_attackers_indx:  [0 4]
layer2_inf_t: 30.330078125
assumed final_attacker_idxs:  [0 1 2 3 4]
final_attacker_idxs is: [0 1 2 3 4]
g_attacker_idxs: [ 7 37 15 72 85]
g_normal_idxs: [35 21 89 99 79]
filtered_attacker_idxs: [0, 4]
final_attacker_idxs are: [0, 4]
num_dps: [418, 860, 401, 731, 431, 499, 312, 492, 377, 182]
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0367, Accuracy: 9895/10000 (98.9500%)
time spent on training: 40.37500548362732
Starting performing KrMLRFL...
Num data points: [418, 860, 401, 731, 431, 499, 312, 492, 377, 182]
Num selected data points: [860 401 731 499 312 492 377 182]
The chosen ones are users: [1, 2, 3, 5, 6, 7, 8, 9], which are global users: [37, 15, 72, 35, 21, 89, 99, 79]
___Test Local_Simple poisoned: False, epoch: 260: Average loss: 0.0330, Accuracy: 9897/10000 (98.9700%)
epoch_acc: 98.97
___Test Local_Simple poisoned: True, epoch: 260: Average loss: 14.4601, Accuracy: 24/8968 (0.2676%)
Done in 48.470399379730225 sec.
Server Epoch:261 choose agents : [62, 47, 95, 8, 51, 44, 2, 74, 39, 70].
___Train Local_Simple,  epoch 261, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 261, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.0427, Accuracy: 9864/10000 (98.6400%)
___Train Local_Simple,  epoch 261, local model 47, internal_epoch   1,  Average loss: 0.0007, Accuracy: 770/776 (99.2268%)
___Train Local_Simple,  epoch 261, local model 47, internal_epoch   2,  Average loss: 0.0002, Accuracy: 773/776 (99.6134%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.1209, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch 261, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 261, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.1824, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch 261, local model 8, internal_epoch   1,  Average loss: 0.0004, Accuracy: 628/633 (99.2101%)
___Train Local_Simple,  epoch 261, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.0473, Accuracy: 9867/10000 (98.6700%)
poison local model 51 index 0
___Train Local_Simple,  epoch 261, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 261, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.1065, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch 261, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 513/517 (99.2263%)
___Train Local_Simple,  epoch 261, local model 44, internal_epoch   2,  Average loss: 0.0004, Accuracy: 514/517 (99.4197%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.0735, Accuracy: 9769/10000 (97.6900%)
poison local model 2 index 1
___Train Local_Simple,  epoch 261, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 261, local model 2, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.2052, Accuracy: 9372/10000 (93.7200%)
___Train Local_Simple,  epoch 261, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%)
___Train Local_Simple,  epoch 261, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.0569, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch 261, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 261, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.0407, Accuracy: 9877/10000 (98.7700%)
poison local model 70 index 2
___Train Local_Simple,  epoch 261, local model 70, internal_epoch   1,  Average loss: 0.0011, Accuracy: 710/724 (98.0663%)
___Train Local_Simple,  epoch 261, local model 70, internal_epoch   2,  Average loss: 0.0014, Accuracy: 707/724 (97.6519%)
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.2628, Accuracy: 9276/10000 (92.7600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 2, 70]
base_p: [-9.4391406e-05  1.0185316e-04 -7.1548298e-04 ... -1.0860413e-03
  1.7417520e-03  4.9577653e-04]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 5, 6, 9]
layer1_inf_time: 4.6845703125
[PAIRWISE] pred_attackers_indx:  [1 2 4 6 9]
layer2_inf_t: 119.277099609375
assumed final_attacker_idxs:  [1 2 4 5 6 9]
final_attacker_idxs is: [1 2 4 5 6 9]
g_attacker_idxs: [47 95 51 44  2 70]
g_normal_idxs: [62  8 74 39]
filtered_attacker_idxs: [1, 2, 4, 6, 9]
final_attacker_idxs are: [1, 2, 4, 6, 9]
num_dps: [423, 776, 602, 633, 568, 517, 548, 557, 257, 724]
time spent on training: 49.805405139923096
Starting performing KrMLRFL...
Num data points: [423, 776, 602, 633, 568, 517, 548, 557, 257, 724]
Num selected data points: [423 633 517 557 257]
The chosen ones are users: [0, 3, 5, 7, 8], which are global users: [62, 8, 44, 74, 39]
___Test Local_Simple poisoned: False, epoch: 261: Average loss: 0.0330, Accuracy: 9898/10000 (98.9800%)
epoch_acc: 98.98
___Test Local_Simple poisoned: True, epoch: 261: Average loss: 14.3586, Accuracy: 13/8968 (0.1450%)
Done in 60.022489070892334 sec.
Server Epoch:262 choose agents : [81, 76, 22, 13, 37, 3, 73, 78, 15, 17].
poison local model 81 index 0
___Train Local_Simple,  epoch 262, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1213/1227 (98.8590%)
___Train Local_Simple,  epoch 262, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1215/1227 (99.0220%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.1317, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch 262, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 262, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.0331, Accuracy: 9897/10000 (98.9700%)
poison local model 22 index 1
___Train Local_Simple,  epoch 262, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 262, local model 22, internal_epoch   2,  Average loss: 0.0003, Accuracy: 580/583 (99.4854%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.0988, Accuracy: 9686/10000 (96.8600%)
poison local model 13 index 2
___Train Local_Simple,  epoch 262, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 724/734 (98.6376%)
___Train Local_Simple,  epoch 262, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 730/734 (99.4550%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.1259, Accuracy: 9591/10000 (95.9100%)
___Train Local_Simple,  epoch 262, local model 37, internal_epoch   1,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Train Local_Simple,  epoch 262, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.0747, Accuracy: 9773/10000 (97.7300%)
___Train Local_Simple,  epoch 262, local model 3, internal_epoch   1,  Average loss: 0.0006, Accuracy: 912/923 (98.8082%)
___Train Local_Simple,  epoch 262, local model 3, internal_epoch   2,  Average loss: 0.0003, Accuracy: 918/923 (99.4583%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.2045, Accuracy: 9280/10000 (92.8000%)
poison local model 73 index 3
___Train Local_Simple,  epoch 262, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 585/591 (98.9848%)
___Train Local_Simple,  epoch 262, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.0796, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch 262, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 262, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.0560, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 262, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 262, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.0350, Accuracy: 9883/10000 (98.8300%)
poison local model 17 index 0
___Train Local_Simple,  epoch 262, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 609/620 (98.2258%)
___Train Local_Simple,  epoch 262, local model 17, internal_epoch   2,  Average loss: 0.0003, Accuracy: 617/620 (99.5161%)
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.2166, Accuracy: 9362/10000 (93.6200%)
time spent on training: 67.15378284454346
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [81, 22, 13, 73, 17]
base_p: [ 0.00010049  0.00015829 -0.00034466 ...  0.00335076 -0.0040646
 -0.00036565]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 6, 9]
layer1_inf_time: 2.83447265625
[PAIRWISE] pred_attackers_indx:  [0 3 5 9]
layer2_inf_t: 510.529052734375
assumed final_attacker_idxs:  [0 2 3 5 6 9]
final_attacker_idxs is: [0 2 3 5 6 9]
g_attacker_idxs: [81 22 13  3 73 17]
g_normal_idxs: [76 37 78 15]
filtered_attacker_idxs: [0, 2, 3, 5, 6, 9]
final_attacker_idxs are: [0, 2, 3, 5, 6, 9]
num_dps: [1227, 78, 583, 734, 860, 923, 591, 303, 401, 620]
Num data points: [1227, 78, 583, 734, 860, 923, 591, 303, 401, 620]
Num selected data points: [ 78 860 303 401]
The chosen ones are users: [1, 4, 7, 8], which are global users: [76, 37, 78, 15]
___Test Local_Simple poisoned: False, epoch: 262: Average loss: 0.0394, Accuracy: 9871/10000 (98.7100%)
epoch_acc: 98.71
___Test Local_Simple poisoned: True, epoch: 262: Average loss: 13.8660, Accuracy: 30/8968 (0.3345%)
Done in 74.94997215270996 sec.
Server Epoch:263 choose agents : [10, 76, 90, 74, 56, 14, 91, 11, 53, 89].
___Train Local_Simple,  epoch 263, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 263, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.1659, Accuracy: 9501/10000 (95.0100%)
___Train Local_Simple,  epoch 263, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 263, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.0393, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 263, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Train Local_Simple,  epoch 263, local model 90, internal_epoch   2,  Average loss: 0.0004, Accuracy: 676/683 (98.9751%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.6625, Accuracy: 8691/10000 (86.9100%)
___Train Local_Simple,  epoch 263, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%)
___Train Local_Simple,  epoch 263, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.0574, Accuracy: 9829/10000 (98.2900%)
___Train Local_Simple,  epoch 263, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 879/880 (99.8864%)
___Train Local_Simple,  epoch 263, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.0356, Accuracy: 9884/10000 (98.8400%)
___Train Local_Simple,  epoch 263, local model 14, internal_epoch   1,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%)
___Train Local_Simple,  epoch 263, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.0626, Accuracy: 9818/10000 (98.1800%)
poison local model 91 index 0
___Train Local_Simple,  epoch 263, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 263, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.0519, Accuracy: 9837/10000 (98.3700%)
poison local model 11 index 1
___Train Local_Simple,  epoch 263, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 638/645 (98.9147%)
___Train Local_Simple,  epoch 263, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 640/645 (99.2248%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.3234, Accuracy: 9104/10000 (91.0400%)
___Train Local_Simple,  epoch 263, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 263, local model 53, internal_epoch   2,  Average loss: 0.0010, Accuracy: 731/739 (98.9175%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.1704, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch 263, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 263, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.0490, Accuracy: 9838/10000 (98.3800%)
time spent on training: 44.67757606506348
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 11]
base_p: [ 2.0547211e-04  7.0353970e-05  1.9107759e-04 ...  3.1559169e-04
  1.9344613e-03 -5.0380826e-05]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 8]
layer1_inf_time: 2.904052734375
[PAIRWISE] pred_attackers_indx:  [7 8]
layer2_inf_t: 30.3193359375
assumed final_attacker_idxs:  [3 4 6 7 8]
final_attacker_idxs is: [3 4 6 7 8]
g_attacker_idxs: [74 56 91 11 53]
g_normal_idxs: [10 76 90 14 89]
filtered_attacker_idxs: [6, 7, 8]
final_attacker_idxs are: [6, 7, 8]
num_dps: [892, 78, 683, 557, 880, 376, 256, 645, 739, 492]
Starting performing KrMLRFL...
Num data points: [892, 78, 683, 557, 880, 376, 256, 645, 739, 492]
Num selected data points: [892  78 683 557 880 376 492]
The chosen ones are users: [0, 1, 2, 3, 4, 5, 9], which are global users: [10, 76, 90, 74, 56, 14, 89]
___Test Local_Simple poisoned: False, epoch: 263: Average loss: 0.0383, Accuracy: 9877/10000 (98.7700%)
epoch_acc: 98.77
___Test Local_Simple poisoned: True, epoch: 263: Average loss: 14.4895, Accuracy: 16/8968 (0.1784%)
Done in 55.389760971069336 sec.
Server Epoch:264 choose agents : [66, 4, 54, 50, 12, 2, 96, 42, 61, 15].
___Train Local_Simple,  epoch 264, local model 66, internal_epoch   1,  Average loss: 0.0008, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch 264, local model 66, internal_epoch   2,  Average loss: 0.0016, Accuracy: 641/660 (97.1212%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.5031, Accuracy: 8455/10000 (84.5500%)
___Train Local_Simple,  epoch 264, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 651/658 (98.9362%)
___Train Local_Simple,  epoch 264, local model 4, internal_epoch   2,  Average loss: 0.0015, Accuracy: 645/658 (98.0243%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.6051, Accuracy: 8300/10000 (83.0000%)
___Train Local_Simple,  epoch 264, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 516/519 (99.4220%)
___Train Local_Simple,  epoch 264, local model 54, internal_epoch   2,  Average loss: 0.0004, Accuracy: 514/519 (99.0366%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.0873, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch 264, local model 50, internal_epoch   1,  Average loss: 0.0002, Accuracy: 471/474 (99.3671%)
___Train Local_Simple,  epoch 264, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.0779, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch 264, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1143/1160 (98.5345%)
___Train Local_Simple,  epoch 264, local model 12, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1141/1160 (98.3621%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.5410, Accuracy: 8853/10000 (88.5300%)
poison local model 2 index 0
___Train Local_Simple,  epoch 264, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 541/548 (98.7226%)
___Train Local_Simple,  epoch 264, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 545/548 (99.4526%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.2284, Accuracy: 9257/10000 (92.5700%)
___Train Local_Simple,  epoch 264, local model 96, internal_epoch   1,  Average loss: 0.0010, Accuracy: 662/672 (98.5119%)
___Train Local_Simple,  epoch 264, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 669/672 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.2361, Accuracy: 9267/10000 (92.6700%)
poison local model 42 index 1
___Train Local_Simple,  epoch 264, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch 264, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.0557, Accuracy: 9819/10000 (98.1900%)
poison local model 61 index 2
___Train Local_Simple,  epoch 264, local model 61, internal_epoch   1,  Average loss: 0.0015, Accuracy: 680/699 (97.2818%)
___Train Local_Simple,  epoch 264, local model 61, internal_epoch   2,  Average loss: 0.0014, Accuracy: 677/699 (96.8526%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.4913, Accuracy: 8589/10000 (85.8900%)
___Train Local_Simple,  epoch 264, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 264, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.0406, Accuracy: 9865/10000 (98.6500%)
time spent on training: 48.5894193649292
Starting performing KrMLRFL...
Num data points: [660, 658, 519, 474, 1160, 548, 672, 236, 699, 401]
Num selected data points: [519 474 236 401]
The chosen ones are users: [2, 3, 7, 9], which are global users: [54, 50, 42, 15]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 42, 61]
base_p: [-9.7360462e-05  4.7095679e-04 -1.0564700e-03 ... -4.4354349e-03
 -1.2258962e-03  1.0959506e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 6, 8]
layer1_inf_time: 4.149658203125
[PAIRWISE] pred_attackers_indx:  [1 8]
layer2_inf_t: 231.2998046875
assumed final_attacker_idxs:  [0 1 4 5 6 8]
final_attacker_idxs is: [0 1 4 5 6 8]
g_attacker_idxs: [66  4 12  2 96 61]
g_normal_idxs: [54 50 42 15]
filtered_attacker_idxs: [0, 1, 4, 5, 6, 8]
final_attacker_idxs are: [0, 1, 4, 5, 6, 8]
num_dps: [660, 658, 519, 474, 1160, 548, 672, 236, 699, 401]
___Test Local_Simple poisoned: False, epoch: 264: Average loss: 0.0341, Accuracy: 9885/10000 (98.8500%)
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: True, epoch: 264: Average loss: 13.3600, Accuracy: 24/8968 (0.2676%)
Done in 57.56258988380432 sec.
Server Epoch:265 choose agents : [54, 87, 51, 59, 88, 42, 64, 85, 82, 6].
___Train Local_Simple,  epoch 265, local model 54, internal_epoch   1,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch 265, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.0574, Accuracy: 9824/10000 (98.2400%)
___Train Local_Simple,  epoch 265, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 265, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.0395, Accuracy: 9867/10000 (98.6700%)
poison local model 51 index 0
___Train Local_Simple,  epoch 265, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 265, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.1106, Accuracy: 9663/10000 (96.6300%)
___Train Local_Simple,  epoch 265, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 750/760 (98.6842%)
___Train Local_Simple,  epoch 265, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.8047, Accuracy: 8634/10000 (86.3400%)
___Train Local_Simple,  epoch 265, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 526/530 (99.2453%)
___Train Local_Simple,  epoch 265, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.1521, Accuracy: 9552/10000 (95.5200%)
poison local model 42 index 1
___Train Local_Simple,  epoch 265, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%)
___Train Local_Simple,  epoch 265, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.0454, Accuracy: 9851/10000 (98.5100%)
___Train Local_Simple,  epoch 265, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Train Local_Simple,  epoch 265, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.0823, Accuracy: 9735/10000 (97.3500%)
poison local model 85 index 2
___Train Local_Simple,  epoch 265, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 265, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.0494, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 265, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch 265, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.5825, Accuracy: 8767/10000 (87.6700%)
___Train Local_Simple,  epoch 265, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 612/615 (99.5122%)
___Train Local_Simple,  epoch 265, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 42, 85]
base_p: [ 0.0002439   0.00030188  0.00062826 ...  0.00099283 -0.00097544
  0.00092459]
[T_SCORE] attacker_local_idxs is:  [2, 3, 6, 7, 8]
layer1_inf_time: 3.372314453125
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.0729, Accuracy: 9761/10000 (97.6100%)
time spent on training: 54.33334493637085
Starting performing KrMLRFL...
Num data points: [519, 470, 568, 760, 530, 236, 813, 431, 713, 615]
Num selected data points: [519 470 530 236 813 615]
The chosen ones are users: [0, 1, 4, 5, 6, 9], which are global users: [54, 87, 88, 42, 64, 6]
[PAIRWISE] pred_attackers_indx:  [3]
layer2_inf_t: 197.687255859375
assumed final_attacker_idxs:  [2 3 6 7 8]
final_attacker_idxs is: [2 3 6 7 8]
g_attacker_idxs: [51 59 64 85 82]
g_normal_idxs: [54 87 88 42  6]
filtered_attacker_idxs: [2, 3, 7, 8]
final_attacker_idxs are: [2, 3, 7, 8]
num_dps: [519, 470, 568, 760, 530, 236, 813, 431, 713, 615]
epoch_acc: 98.89
___Test Local_Simple poisoned: False, epoch: 265: Average loss: 0.0365, Accuracy: 9889/10000 (98.8900%)
___Test Local_Simple poisoned: True, epoch: 265: Average loss: 13.4860, Accuracy: 27/8968 (0.3011%)
Done in 62.90227222442627 sec.
Server Epoch:266 choose agents : [0, 9, 36, 69, 46, 32, 22, 64, 48, 8].
___Train Local_Simple,  epoch 266, local model 0, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/435 (99.0805%)
___Train Local_Simple,  epoch 266, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.0653, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch 266, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 266, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.0476, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 266, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 993/1005 (98.8060%)
___Train Local_Simple,  epoch 266, local model 36, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1000/1005 (99.5025%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.1748, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch 266, local model 69, internal_epoch   1,  Average loss: 0.0006, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 266, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.0956, Accuracy: 9695/10000 (96.9500%)
___Train Local_Simple,  epoch 266, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 699/710 (98.4507%)
___Train Local_Simple,  epoch 266, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 704/710 (99.1549%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.2599, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch 266, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 956/977 (97.8506%)
___Train Local_Simple,  epoch 266, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 969/977 (99.1812%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.1815, Accuracy: 9454/10000 (94.5400%)
poison local model 22 index 0
___Train Local_Simple,  epoch 266, local model 22, internal_epoch   1,  Average loss: 0.0011, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 266, local model 22, internal_epoch   2,  Average loss: 0.0006, Accuracy: 577/583 (98.9708%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.1004, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch 266, local model 64, internal_epoch   1,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Train Local_Simple,  epoch 266, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.0448, Accuracy: 9860/10000 (98.6000%)
___Train Local_Simple,  epoch 266, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch 266, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.0691, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch 266, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Train Local_Simple,  epoch 266, local model 8, internal_epoch   2,  Average loss: 0.0000, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.0415, Accuracy: 9867/10000 (98.6700%)
time spent on training: 60.44496417045593
Starting performing KrMLRFL...
Num data points: [435, 436, 1005, 256, 710, 977, 583, 813, 448, 633]
Num selected data points: [435 436 256 813 448 633]
The chosen ones are users: [0, 1, 3, 7, 8, 9], which are global users: [0, 9, 69, 64, 48, 8]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22]
base_p: [-1.5687570e-04  3.0227005e-05 -6.1627198e-04 ...  1.5618652e-03
  5.9863925e-04 -2.1474063e-03]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 6, 7]
layer1_inf_time: 2.807861328125
[PAIRWISE] pred_attackers_indx:  [2 4 5 6]
layer2_inf_t: 28.793701171875
assumed final_attacker_idxs:  [2 4 5 6 7]
final_attacker_idxs is: [2 4 5 6 7]
g_attacker_idxs: [36 46 32 22 64]
g_normal_idxs: [ 0  9 69 48  8]
filtered_attacker_idxs: [2, 4, 5, 6]
final_attacker_idxs are: [2, 4, 5, 6]
num_dps: [435, 436, 1005, 256, 710, 977, 583, 813, 448, 633]
___Test Local_Simple poisoned: False, epoch: 266: Average loss: 0.0320, Accuracy: 9902/10000 (99.0200%)
epoch_acc: 99.02
___Test Local_Simple poisoned: True, epoch: 266: Average loss: 14.9715, Accuracy: 8/8968 (0.0892%)
Done in 67.69479537010193 sec.
Server Epoch:267 choose agents : [15, 41, 26, 28, 47, 80, 66, 0, 5, 35].
___Train Local_Simple,  epoch 267, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 267, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0361, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 267, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Train Local_Simple,  epoch 267, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0720, Accuracy: 9758/10000 (97.5800%)
poison local model 26 index 0
___Train Local_Simple,  epoch 267, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 267, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0875, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch 267, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 267, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0437, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 267, local model 47, internal_epoch   1,  Average loss: 0.0004, Accuracy: 767/776 (98.8402%)
___Train Local_Simple,  epoch 267, local model 47, internal_epoch   2,  Average loss: 0.0003, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.1675, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch 267, local model 80, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 267, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0449, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 267, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 653/660 (98.9394%)
___Train Local_Simple,  epoch 267, local model 66, internal_epoch   2,  Average loss: 0.0018, Accuracy: 645/660 (97.7273%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.1657, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch 267, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Train Local_Simple,  epoch 267, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0709, Accuracy: 9796/10000 (97.9600%)
___Train Local_Simple,  epoch 267, local model 5, internal_epoch   1,  Average loss: 0.0005, Accuracy: 432/434 (99.5392%)
___Train Local_Simple,  epoch 267, local model 5, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.2635, Accuracy: 9148/10000 (91.4800%)
___Train Local_Simple,  epoch 267, local model 35, internal_epoch   1,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 267, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0551, Accuracy: 9820/10000 (98.2000%)
time spent on training: 39.656311988830566
Starting performing KrMLRFL...
Num data points: [401, 606, 554, 501, 776, 431, 660, 435, 434, 499]
Num selected data points: [401 501 431 435 434 499]
The chosen ones are users: [0, 3, 5, 7, 8, 9], which are global users: [15, 28, 80, 0, 5, 35]
___Test Local_Simple poisoned: False, epoch: 267: Average loss: 0.0302, Accuracy: 9908/10000 (99.0800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26]
base_p: [ 1.9209832e-04 -6.1072409e-05 -3.8448256e-04 ...  5.2258372e-04
  1.3142079e-04  5.5227429e-04]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 6, 7]
layer1_inf_time: 2.52490234375
[PAIRWISE] pred_attackers_indx:  [0 1 3 7 8]
layer2_inf_t: 27.86669921875
assumed final_attacker_idxs:  [0 1 2 3 4 6 7 8]
final_attacker_idxs is: [0 1 2 3 4 6 7 8]
g_attacker_idxs: [15 41 26 28 47 66  0  5]
g_normal_idxs: [80 35]
filtered_attacker_idxs: [1, 2, 4, 6]
final_attacker_idxs are: [1, 2, 4, 6]
num_dps: [401, 606, 554, 501, 776, 431, 660, 435, 434, 499]
epoch_acc: 99.08
___Test Local_Simple poisoned: True, epoch: 267: Average loss: 15.2562, Accuracy: 8/8968 (0.0892%)
Done in 62.21151089668274 sec.
Server Epoch:268 choose agents : [0, 18, 63, 74, 60, 28, 7, 3, 21, 34].
___Train Local_Simple,  epoch 268, local model 0, internal_epoch   1,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
___Train Local_Simple,  epoch 268, local model 0, internal_epoch   2,  Average loss: 0.0000, Accuracy: 435/435 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0429, Accuracy: 9864/10000 (98.6400%)
___Train Local_Simple,  epoch 268, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 457/459 (99.5643%)
___Train Local_Simple,  epoch 268, local model 18, internal_epoch   2,  Average loss: 0.0000, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0770, Accuracy: 9762/10000 (97.6200%)
poison local model 63 index 0
___Train Local_Simple,  epoch 268, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 873/889 (98.2002%)
___Train Local_Simple,  epoch 268, local model 63, internal_epoch   2,  Average loss: 0.0010, Accuracy: 875/889 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.1174, Accuracy: 9649/10000 (96.4900%)
___Train Local_Simple,  epoch 268, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%)
___Train Local_Simple,  epoch 268, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0550, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 268, local model 60, internal_epoch   1,  Average loss: 0.0002, Accuracy: 336/338 (99.4083%)
___Train Local_Simple,  epoch 268, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 337/338 (99.7041%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0658, Accuracy: 9800/10000 (98.0000%)
___Train Local_Simple,  epoch 268, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 268, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0370, Accuracy: 9884/10000 (98.8400%)
poison local model 7 index 1
___Train Local_Simple,  epoch 268, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 415/418 (99.2823%)
___Train Local_Simple,  epoch 268, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.2237, Accuracy: 9370/10000 (93.7000%)
___Train Local_Simple,  epoch 268, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 915/923 (99.1333%)
___Train Local_Simple,  epoch 268, local model 3, internal_epoch   2,  Average loss: 0.0007, Accuracy: 911/923 (98.6999%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.2833, Accuracy: 8804/10000 (88.0400%)
___Train Local_Simple,  epoch 268, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch 268, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0916, Accuracy: 9724/10000 (97.2400%)
poison local model 34 index 2
___Train Local_Simple,  epoch 268, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 268, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0796, Accuracy: 9761/10000 (97.6100%)
time spent on training: 56.95082092285156
Starting performing KrMLRFL...
Num data points: [435, 459, 889, 557, 338, 501, 418, 923, 312, 413]
Num selected data points: [435 459 557 501 312]
The chosen ones are users: [0, 1, 3, 5, 8], which are global users: [0, 18, 74, 28, 21]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 7, 34]
base_p: [ 4.5526773e-04 -8.1665814e-05 -4.7568791e-04 ... -7.8846514e-04
  9.7337365e-04  1.9873753e-03]
[T_SCORE] attacker_local_idxs is:  [2, 4, 6, 7, 9]
layer1_inf_time: 4.52880859375
[PAIRWISE] pred_attackers_indx:  [6 7]
layer2_inf_t: 50.429443359375
assumed final_attacker_idxs:  [2 4 6 7 9]
final_attacker_idxs is: [2 4 6 7 9]
g_attacker_idxs: [63 60  7  3 34]
g_normal_idxs: [ 0 18 74 28 21]
filtered_attacker_idxs: [2, 4, 6, 7, 9]
final_attacker_idxs are: [2, 4, 6, 7, 9]
num_dps: [435, 459, 889, 557, 338, 501, 418, 923, 312, 413]
___Test Local_Simple poisoned: False, epoch: 268: Average loss: 0.0338, Accuracy: 9887/10000 (98.8700%)
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 268: Average loss: 14.9688, Accuracy: 12/8968 (0.1338%)
Done in 65.75540661811829 sec.
Server Epoch:269 choose agents : [93, 39, 32, 42, 60, 65, 18, 36, 81, 7].
poison local model 93 index 0
___Train Local_Simple,  epoch 269, local model 93, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 269, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.3246, Accuracy: 9282/10000 (92.8200%)
___Train Local_Simple,  epoch 269, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 257/257 (100.0000%)
___Train Local_Simple,  epoch 269, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.0432, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch 269, local model 32, internal_epoch   1,  Average loss: 0.0008, Accuracy: 964/977 (98.6694%)
___Train Local_Simple,  epoch 269, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 964/977 (98.6694%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.1588, Accuracy: 9516/10000 (95.1600%)
poison local model 42 index 1
___Train Local_Simple,  epoch 269, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 269, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.0426, Accuracy: 9868/10000 (98.6800%)
___Train Local_Simple,  epoch 269, local model 60, internal_epoch   1,  Average loss: 0.0003, Accuracy: 336/338 (99.4083%)
___Train Local_Simple,  epoch 269, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.0542, Accuracy: 9830/10000 (98.3000%)
___Train Local_Simple,  epoch 269, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Train Local_Simple,  epoch 269, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.0475, Accuracy: 9852/10000 (98.5200%)
___Train Local_Simple,  epoch 269, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 269, local model 18, internal_epoch   2,  Average loss: 0.0000, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.0487, Accuracy: 9852/10000 (98.5200%)
___Train Local_Simple,  epoch 269, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 996/1005 (99.1045%)
___Train Local_Simple,  epoch 269, local model 36, internal_epoch   2,  Average loss: 0.0008, Accuracy: 991/1005 (98.6070%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.2549, Accuracy: 9231/10000 (92.3100%)
poison local model 81 index 2
___Train Local_Simple,  epoch 269, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1217/1227 (99.1850%)
___Train Local_Simple,  epoch 269, local model 81, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1208/1227 (98.4515%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.2030, Accuracy: 9406/10000 (94.0600%)
poison local model 7 index 3
___Train Local_Simple,  epoch 269, local model 7, internal_epoch   1,  Average loss: 0.0003, Accuracy: 416/418 (99.5215%)
___Train Local_Simple,  epoch 269, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.1958, Accuracy: 9462/10000 (94.6200%)
time spent on training: 106.58361482620239
Starting performing KrMLRFL...
Num data points: [623, 257, 977, 236, 338, 371, 459, 1005, 1227, 418]
Num selected data points: [257 236 338 371 459]
The chosen ones are users: [1, 3, 4, 5, 6], which are global users: [39, 42, 60, 65, 18]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93, 42, 81, 7]
base_p: [ 0.00049534  0.00014549  0.00072409 ... -0.00397019 -0.00072764
 -0.00046843]
[T_SCORE] attacker_local_idxs is:  [0, 2, 7, 8, 9]
layer1_inf_time: 4.921142578125
[PAIRWISE] pred_attackers_indx:  [7 8 9]
layer2_inf_t: 123.943115234375
assumed final_attacker_idxs:  [0 2 7 8 9]
final_attacker_idxs is: [0 2 7 8 9]
g_attacker_idxs: [93 32 36 81  7]
g_normal_idxs: [39 42 60 65 18]
filtered_attacker_idxs: [0, 2, 7, 8, 9]
final_attacker_idxs are: [0, 2, 7, 8, 9]
num_dps: [623, 257, 977, 236, 338, 371, 459, 1005, 1227, 418]
___Test Local_Simple poisoned: False, epoch: 269: Average loss: 0.0333, Accuracy: 9899/10000 (98.9900%)
epoch_acc: 98.99
___Test Local_Simple poisoned: True, epoch: 269: Average loss: 15.6816, Accuracy: 5/8968 (0.0558%)
Done in 115.74263858795166 sec.
Server Epoch:270 choose agents : [2, 66, 12, 58, 79, 93, 48, 71, 17, 19].
poison local model 2 index 0
___Train Local_Simple,  epoch 270, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 270, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 546/548 (99.6350%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.3293, Accuracy: 9005/10000 (90.0500%)
___Train Local_Simple,  epoch 270, local model 66, internal_epoch   1,  Average loss: 0.0008, Accuracy: 648/660 (98.1818%)
___Train Local_Simple,  epoch 270, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 650/660 (98.4848%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.2981, Accuracy: 9057/10000 (90.5700%)
___Train Local_Simple,  epoch 270, local model 12, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1151/1160 (99.2241%)
___Train Local_Simple,  epoch 270, local model 12, internal_epoch   2,  Average loss: 0.0035, Accuracy: 1089/1160 (93.8793%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.3433, Accuracy: 9104/10000 (91.0400%)
___Train Local_Simple,  epoch 270, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 274/276 (99.2754%)
___Train Local_Simple,  epoch 270, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.0785, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch 270, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch 270, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.0415, Accuracy: 9883/10000 (98.8300%)
poison local model 93 index 1
___Train Local_Simple,  epoch 270, local model 93, internal_epoch   1,  Average loss: 0.0002, Accuracy: 622/623 (99.8395%)
___Train Local_Simple,  epoch 270, local model 93, internal_epoch   2,  Average loss: 0.0005, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.2878, Accuracy: 9224/10000 (92.2400%)
___Train Local_Simple,  epoch 270, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch 270, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.0682, Accuracy: 9770/10000 (97.7000%)
poison local model 71 index 2
___Train Local_Simple,  epoch 270, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1371/1384 (99.0607%)
___Train Local_Simple,  epoch 270, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1370/1384 (98.9884%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.2387, Accuracy: 9239/10000 (92.3900%)
poison local model 17 index 3
___Train Local_Simple,  epoch 270, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 611/620 (98.5484%)
___Train Local_Simple,  epoch 270, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 617/620 (99.5161%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.1959, Accuracy: 9452/10000 (94.5200%)
___Train Local_Simple,  epoch 270, local model 19, internal_epoch   1,  Average loss: 0.0001, Accuracy: 204/205 (99.5122%)
___Train Local_Simple,  epoch 270, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.0475, Accuracy: 9854/10000 (98.5400%)
time spent on training: 100.24896597862244
Starting performing KrMLRFL...
Num data points: [548, 660, 1160, 276, 182, 623, 448, 1384, 620, 205]
Num selected data points: [276 182 448 205]
The chosen ones are users: [3, 4, 6, 9], which are global users: [58, 79, 48, 19]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 93, 71, 17]
base_p: [-0.00014243 -0.00025223 -0.00209556 ...  0.00189784 -0.00297692
 -0.00042593]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 7, 8]
layer1_inf_time: 3.5
[PAIRWISE] pred_attackers_indx:  [0 1 2 5 7 8]
layer2_inf_t: 86.5859375
assumed final_attacker_idxs:  [0 1 2 5 7 8]
final_attacker_idxs is: [0 1 2 5 7 8]
g_attacker_idxs: [ 2 66 12 93 71 17]
g_normal_idxs: [58 79 48 19]
filtered_attacker_idxs: [0, 1, 2, 5, 7, 8]
final_attacker_idxs are: [0, 1, 2, 5, 7, 8]
num_dps: [548, 660, 1160, 276, 182, 623, 448, 1384, 620, 205]
epoch_acc: 98.82
___Test Local_Simple poisoned: False, epoch: 270: Average loss: 0.0385, Accuracy: 9882/10000 (98.8200%)
___Test Local_Simple poisoned: True, epoch: 270: Average loss: 15.0169, Accuracy: 23/8968 (0.2565%)
Done in 131.44913244247437 sec.
Server Epoch:271 choose agents : [48, 97, 13, 17, 24, 3, 60, 22, 26, 72].
___Train Local_Simple,  epoch 271, local model 48, internal_epoch   1,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%)
___Train Local_Simple,  epoch 271, local model 48, internal_epoch   2,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.0409, Accuracy: 9864/10000 (98.6400%)
___Train Local_Simple,  epoch 271, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 483/487 (99.1786%)
___Train Local_Simple,  epoch 271, local model 97, internal_epoch   2,  Average loss: 0.0002, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.0695, Accuracy: 9768/10000 (97.6800%)
poison local model 13 index 0
___Train Local_Simple,  epoch 271, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 724/734 (98.6376%)
___Train Local_Simple,  epoch 271, local model 13, internal_epoch   2,  Average loss: 0.0005, Accuracy: 724/734 (98.6376%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.3034, Accuracy: 9167/10000 (91.6700%)
poison local model 17 index 1
___Train Local_Simple,  epoch 271, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 605/620 (97.5806%)
___Train Local_Simple,  epoch 271, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 613/620 (98.8710%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.2914, Accuracy: 9162/10000 (91.6200%)
___Train Local_Simple,  epoch 271, local model 24, internal_epoch   1,  Average loss: 0.0004, Accuracy: 374/379 (98.6807%)
___Train Local_Simple,  epoch 271, local model 24, internal_epoch   2,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.0765, Accuracy: 9778/10000 (97.7800%)
___Train Local_Simple,  epoch 271, local model 3, internal_epoch   1,  Average loss: 0.0007, Accuracy: 906/923 (98.1582%)
___Train Local_Simple,  epoch 271, local model 3, internal_epoch   2,  Average loss: 0.0006, Accuracy: 910/923 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.2134, Accuracy: 9313/10000 (93.1300%)
___Train Local_Simple,  epoch 271, local model 60, internal_epoch   1,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Train Local_Simple,  epoch 271, local model 60, internal_epoch   2,  Average loss: 0.0000, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.0702, Accuracy: 9800/10000 (98.0000%)
poison local model 22 index 2
___Train Local_Simple,  epoch 271, local model 22, internal_epoch   1,  Average loss: 0.0012, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 271, local model 22, internal_epoch   2,  Average loss: 0.0005, Accuracy: 578/583 (99.1424%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.1132, Accuracy: 9650/10000 (96.5000%)
poison local model 26 index 3
___Train Local_Simple,  epoch 271, local model 26, internal_epoch   1,  Average loss: 0.0002, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 271, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.0776, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch 271, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 271, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.0765, Accuracy: 9762/10000 (97.6200%)
time spent on training: 106.53715085983276
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 17, 22, 26]
base_p: [-0.00012485  0.00012935  0.00027522 ...  0.00248599  0.00084516
 -0.0009212 ]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 7, 8]
layer1_inf_time: 3.127685546875
[PAIRWISE] pred_attackers_indx:  [2 3 5 7]
layer2_inf_t: 72.64208984375
assumed final_attacker_idxs:  [2 3 5 7 8]
final_attacker_idxs is: [2 3 5 7 8]
g_attacker_idxs: [13 17  3 22 26]
g_normal_idxs: [48 97 24 60 72]
filtered_attacker_idxs: [2, 3, 5, 7, 8]
final_attacker_idxs are: [2, 3, 5, 7, 8]
num_dps: [448, 487, 734, 620, 379, 923, 338, 583, 554, 731]
Starting performing KrMLRFL...
Num data points: [448, 487, 734, 620, 379, 923, 338, 583, 554, 731]
Num selected data points: [448 487 379 338 731]
The chosen ones are users: [0, 1, 4, 6, 9], which are global users: [48, 97, 24, 60, 72]
___Test Local_Simple poisoned: False, epoch: 271: Average loss: 0.0338, Accuracy: 9896/10000 (98.9600%)
epoch_acc: 98.96000000000001
___Test Local_Simple poisoned: True, epoch: 271: Average loss: 15.0367, Accuracy: 11/8968 (0.1227%)
Done in 115.47388887405396 sec.
Server Epoch:272 choose agents : [17, 76, 11, 40, 88, 20, 18, 1, 99, 19].
poison local model 17 index 0
___Train Local_Simple,  epoch 272, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 609/620 (98.2258%)
___Train Local_Simple,  epoch 272, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 613/620 (98.8710%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.2066, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch 272, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 272, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.0336, Accuracy: 9897/10000 (98.9700%)
poison local model 11 index 1
___Train Local_Simple,  epoch 272, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 638/645 (98.9147%)
___Train Local_Simple,  epoch 272, local model 11, internal_epoch   2,  Average loss: 0.0008, Accuracy: 634/645 (98.2946%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.1916, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch 272, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 768/772 (99.4819%)
___Train Local_Simple,  epoch 272, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 770/772 (99.7409%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.0992, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch 272, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch 272, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.0873, Accuracy: 9733/10000 (97.3300%)
poison local model 20 index 2
___Train Local_Simple,  epoch 272, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 420/429 (97.9021%)
___Train Local_Simple,  epoch 272, local model 20, internal_epoch   2,  Average loss: 0.0008, Accuracy: 422/429 (98.3683%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.3032, Accuracy: 9246/10000 (92.4600%)
___Train Local_Simple,  epoch 272, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 272, local model 18, internal_epoch   2,  Average loss: 0.0000, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.0505, Accuracy: 9832/10000 (98.3200%)
poison local model 1 index 3
___Train Local_Simple,  epoch 272, local model 1, internal_epoch   1,  Average loss: 0.0011, Accuracy: 743/760 (97.7632%)
___Train Local_Simple,  epoch 272, local model 1, internal_epoch   2,  Average loss: 0.0005, Accuracy: 750/760 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.1831, Accuracy: 9335/10000 (93.3500%)
___Train Local_Simple,  epoch 272, local model 99, internal_epoch   1,  Average loss: 0.0004, Accuracy: 372/377 (98.6737%)
___Train Local_Simple,  epoch 272, local model 99, internal_epoch   2,  Average loss: 0.0008, Accuracy: 373/377 (98.9390%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.0458, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 272, local model 19, internal_epoch   1,  Average loss: 0.0003, Accuracy: 204/205 (99.5122%)
___Train Local_Simple,  epoch 272, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.1692, Accuracy: 9595/10000 (95.9500%)
time spent on training: 57.72602081298828
Starting performing KrMLRFL...
Num data points: [620, 78, 645, 772, 530, 429, 459, 760, 377, 205]
Num selected data points: [ 78 530 459 377 205]
The chosen ones are users: [1, 4, 6, 8, 9], which are global users: [76, 88, 18, 99, 19]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 11, 20, 1]
base_p: [ 8.0615282e-06  2.2979081e-04 -2.8128363e-04 ...  8.2880259e-05
 -7.0220232e-04  8.1926584e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 7]
layer1_inf_time: 4.91455078125
[PAIRWISE] pred_attackers_indx:  [0 2]
layer2_inf_t: 273.6669921875
assumed final_attacker_idxs:  [0 2 3 5 7]
final_attacker_idxs is: [0 2 3 5 7]
g_attacker_idxs: [17 11 40 20  1]
g_normal_idxs: [76 88 18 99 19]
filtered_attacker_idxs: [0, 2, 3, 5, 7]
final_attacker_idxs are: [0, 2, 3, 5, 7]
num_dps: [620, 78, 645, 772, 530, 429, 459, 760, 377, 205]
___Test Local_Simple poisoned: False, epoch: 272: Average loss: 0.0389, Accuracy: 9864/10000 (98.6400%)
epoch_acc: 98.64
___Test Local_Simple poisoned: True, epoch: 272: Average loss: 14.5804, Accuracy: 10/8968 (0.1115%)
Done in 63.06814980506897 sec.
Server Epoch:273 choose agents : [62, 14, 90, 70, 88, 81, 3, 60, 78, 53].
___Train Local_Simple,  epoch 273, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 273, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.0523, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 273, local model 14, internal_epoch   1,  Average loss: 0.0002, Accuracy: 376/376 (100.0000%)
___Train Local_Simple,  epoch 273, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.0466, Accuracy: 9855/10000 (98.5500%)
___Train Local_Simple,  epoch 273, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%)
___Train Local_Simple,  epoch 273, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 681/683 (99.7072%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.3773, Accuracy: 9052/10000 (90.5200%)
poison local model 70 index 0
___Train Local_Simple,  epoch 273, local model 70, internal_epoch   1,  Average loss: 0.0006, Accuracy: 713/724 (98.4807%)
___Train Local_Simple,  epoch 273, local model 70, internal_epoch   2,  Average loss: 0.0015, Accuracy: 702/724 (96.9613%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.3185, Accuracy: 9166/10000 (91.6600%)
___Train Local_Simple,  epoch 273, local model 88, internal_epoch   1,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 273, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.0445, Accuracy: 9864/10000 (98.6400%)
poison local model 81 index 1
___Train Local_Simple,  epoch 273, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1214/1227 (98.9405%)
___Train Local_Simple,  epoch 273, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1210/1227 (98.6145%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.2754, Accuracy: 9226/10000 (92.2600%)
___Train Local_Simple,  epoch 273, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 915/923 (99.1333%)
___Train Local_Simple,  epoch 273, local model 3, internal_epoch   2,  Average loss: 0.0004, Accuracy: 918/923 (99.4583%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.1178, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch 273, local model 60, internal_epoch   1,  Average loss: 0.0002, Accuracy: 337/338 (99.7041%)
___Train Local_Simple,  epoch 273, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.0495, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 273, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 273, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.0528, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 273, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 733/739 (99.1881%)
___Train Local_Simple,  epoch 273, local model 53, internal_epoch   2,  Average loss: 0.0001, Accuracy: 737/739 (99.7294%)
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.2308, Accuracy: 9335/10000 (93.3500%)
time spent on training: 44.28966021537781
Starting performing KrMLRFL...
Num data points: [423, 376, 683, 724, 530, 1227, 923, 338, 303, 739]
Num selected data points: [423 376 683 530 303]
The chosen ones are users: [0, 1, 2, 4, 8], which are global users: [62, 14, 90, 88, 78]
___Test Local_Simple poisoned: False, epoch: 273: Average loss: 0.0374, Accuracy: 9874/10000 (98.7400%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 81]
base_p: [ 3.1094998e-05  1.1321157e-05 -1.9594748e-04 ...  2.5956929e-03
  7.6504052e-04 -1.9418895e-03]
[T_SCORE] attacker_local_idxs is:  [3, 5, 6, 7, 9]
layer1_inf_time: 4.107666015625
[PAIRWISE] pred_attackers_indx:  [5 6]
layer2_inf_t: 44.847412109375
assumed final_attacker_idxs:  [3 5 6 7 9]
final_attacker_idxs is: [3 5 6 7 9]
g_attacker_idxs: [70 81  3 60 53]
g_normal_idxs: [62 14 90 88 78]
filtered_attacker_idxs: [3, 5, 6, 7, 9]
final_attacker_idxs are: [3, 5, 6, 7, 9]
num_dps: [423, 376, 683, 724, 530, 1227, 923, 338, 303, 739]
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: True, epoch: 273: Average loss: 14.5080, Accuracy: 15/8968 (0.1673%)
Done in 54.04079842567444 sec.
Server Epoch:274 choose agents : [2, 28, 39, 56, 25, 79, 95, 4, 69, 36].
poison local model 2 index 0
___Train Local_Simple,  epoch 274, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 274, local model 2, internal_epoch   2,  Average loss: 0.0005, Accuracy: 545/548 (99.4526%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.1960, Accuracy: 9341/10000 (93.4100%)
___Train Local_Simple,  epoch 274, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 274, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.0403, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 274, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 274, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.0426, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch 274, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 879/880 (99.8864%)
___Train Local_Simple,  epoch 274, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 879/880 (99.8864%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.0367, Accuracy: 9881/10000 (98.8100%)
___Train Local_Simple,  epoch 274, local model 25, internal_epoch   1,  Average loss: 0.0001, Accuracy: 645/647 (99.6909%)
___Train Local_Simple,  epoch 274, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.0896, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch 274, local model 79, internal_epoch   1,  Average loss: 0.0003, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch 274, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.0423, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 274, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch 274, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 1.3352, Accuracy: 7873/10000 (78.7300%)
___Train Local_Simple,  epoch 274, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 647/658 (98.3283%)
___Train Local_Simple,  epoch 274, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 652/658 (99.0881%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.1355, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch 274, local model 69, internal_epoch   1,  Average loss: 0.0004, Accuracy: 252/256 (98.4375%)
___Train Local_Simple,  epoch 274, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.1019, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch 274, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 996/1005 (99.1045%)
___Train Local_Simple,  epoch 274, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 994/1005 (98.9055%)
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.1706, Accuracy: 9495/10000 (94.9500%)
time spent on training: 37.41544270515442
Starting performing KrMLRFL...
Num data points: [548, 501, 257, 880, 647, 182, 602, 658, 256, 1005]
Num selected data points: [501 257 880 182 256]
The chosen ones are users: [1, 2, 3, 5, 8], which are global users: [28, 39, 56, 79, 69]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2]
base_p: [ 2.5567040e-04  9.9766999e-05 -5.4980349e-04 ... -1.8428117e-03
 -3.3744201e-03 -1.8410385e-03]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 7, 9]
layer1_inf_time: 3.355224609375
[PAIRWISE] pred_attackers_indx:  [0 6 7 9]
layer2_inf_t: 28.885986328125
assumed final_attacker_idxs:  [0 4 6 7 9]
final_attacker_idxs is: [0 4 6 7 9]
g_attacker_idxs: [ 2 25 95  4 36]
g_normal_idxs: [28 39 56 79 69]
filtered_attacker_idxs: [0, 4, 6, 7, 9]
final_attacker_idxs are: [0, 4, 6, 7, 9]
num_dps: [548, 501, 257, 880, 647, 182, 602, 658, 256, 1005]
___Test Local_Simple poisoned: False, epoch: 274: Average loss: 0.0308, Accuracy: 9907/10000 (99.0700%)
epoch_acc: 99.07000000000001
___Test Local_Simple poisoned: True, epoch: 274: Average loss: 15.3709, Accuracy: 7/8968 (0.0781%)
Done in 44.20149803161621 sec.
Server Epoch:275 choose agents : [82, 50, 53, 19, 36, 20, 79, 46, 39, 6].
___Train Local_Simple,  epoch 275, local model 82, internal_epoch   1,  Average loss: 0.0006, Accuracy: 708/713 (99.2987%)
___Train Local_Simple,  epoch 275, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 706/713 (99.0182%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.6345, Accuracy: 8787/10000 (87.8700%)
___Train Local_Simple,  epoch 275, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 469/474 (98.9451%)
___Train Local_Simple,  epoch 275, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.1744, Accuracy: 9445/10000 (94.4500%)
___Train Local_Simple,  epoch 275, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 727/739 (98.3762%)
___Train Local_Simple,  epoch 275, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 733/739 (99.1881%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.5319, Accuracy: 8733/10000 (87.3300%)
___Train Local_Simple,  epoch 275, local model 19, internal_epoch   1,  Average loss: 0.0002, Accuracy: 205/205 (100.0000%)
___Train Local_Simple,  epoch 275, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.0814, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch 275, local model 36, internal_epoch   1,  Average loss: 0.0004, Accuracy: 994/1005 (98.9055%)
___Train Local_Simple,  epoch 275, local model 36, internal_epoch   2,  Average loss: 0.0004, Accuracy: 999/1005 (99.4030%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.2254, Accuracy: 9360/10000 (93.6000%)
poison local model 20 index 0
___Train Local_Simple,  epoch 275, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 421/429 (98.1352%)
___Train Local_Simple,  epoch 275, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.2911, Accuracy: 9264/10000 (92.6400%)
___Train Local_Simple,  epoch 275, local model 79, internal_epoch   1,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 275, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.0322, Accuracy: 9906/10000 (99.0600%)
___Train Local_Simple,  epoch 275, local model 46, internal_epoch   1,  Average loss: 0.0008, Accuracy: 699/710 (98.4507%)
___Train Local_Simple,  epoch 275, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 705/710 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.2192, Accuracy: 9259/10000 (92.5900%)
___Train Local_Simple,  epoch 275, local model 39, internal_epoch   1,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Train Local_Simple,  epoch 275, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.0337, Accuracy: 9895/10000 (98.9500%)
___Train Local_Simple,  epoch 275, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 275, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.0459, Accuracy: 9859/10000 (98.5900%)
time spent on training: 37.43850541114807
Starting performing KrMLRFL...
Num data points: [713, 474, 739, 205, 1005, 429, 182, 710, 257, 615]
Num selected data points: [474 205 182 257 615]
The chosen ones are users: [1, 3, 6, 8, 9], which are global users: [50, 19, 79, 39, 6]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20]
base_p: [ 6.8586320e-05  1.9092113e-06 -1.0978617e-04 ... -7.4905157e-04
 -1.1049360e-03  3.2062829e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 7]
layer1_inf_time: 3.3359375
[PAIRWISE] pred_attackers_indx:  [0 1 2 7]
layer2_inf_t: 31.43310546875
assumed final_attacker_idxs:  [0 1 2 4 5 7]
final_attacker_idxs is: [0 1 2 4 5 7]
g_attacker_idxs: [82 50 53 36 20 46]
g_normal_idxs: [19 79 39  6]
filtered_attacker_idxs: [0, 2, 4, 5, 7]
final_attacker_idxs are: [0, 2, 4, 5, 7]
num_dps: [713, 474, 739, 205, 1005, 429, 182, 710, 257, 615]
___Test Local_Simple poisoned: False, epoch: 275: Average loss: 0.0315, Accuracy: 9894/10000 (98.9400%)
epoch_acc: 98.94
___Test Local_Simple poisoned: True, epoch: 275: Average loss: 14.2812, Accuracy: 18/8968 (0.2007%)
Done in 44.75384879112244 sec.
Server Epoch:276 choose agents : [25, 26, 23, 96, 8, 61, 52, 49, 84, 32].
___Train Local_Simple,  epoch 276, local model 25, internal_epoch   1,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%)
___Train Local_Simple,  epoch 276, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.1832, Accuracy: 9419/10000 (94.1900%)
poison local model 26 index 0
___Train Local_Simple,  epoch 276, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 276, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.0953, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch 276, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 276, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.0364, Accuracy: 9889/10000 (98.8900%)
___Train Local_Simple,  epoch 276, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 664/672 (98.8095%)
___Train Local_Simple,  epoch 276, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 669/672 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.1277, Accuracy: 9549/10000 (95.4900%)
___Train Local_Simple,  epoch 276, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Train Local_Simple,  epoch 276, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.0446, Accuracy: 9855/10000 (98.5500%)
poison local model 61 index 1
___Train Local_Simple,  epoch 276, local model 61, internal_epoch   1,  Average loss: 0.0007, Accuracy: 691/699 (98.8555%)
___Train Local_Simple,  epoch 276, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 694/699 (99.2847%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.2996, Accuracy: 9067/10000 (90.6700%)
poison local model 52 index 2
___Train Local_Simple,  epoch 276, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 246/253 (97.2332%)
___Train Local_Simple,  epoch 276, local model 52, internal_epoch   2,  Average loss: 0.0008, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.1393, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch 276, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Train Local_Simple,  epoch 276, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.0408, Accuracy: 9867/10000 (98.6700%)
___Train Local_Simple,  epoch 276, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1231/1246 (98.7961%)
___Train Local_Simple,  epoch 276, local model 84, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1218/1246 (97.7528%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.1118, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch 276, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 960/977 (98.2600%)
___Train Local_Simple,  epoch 276, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 958/977 (98.0553%)
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.2126, Accuracy: 9419/10000 (94.1900%)
time spent on training: 76.88060593605042
Starting performing KrMLRFL...
Num data points: [647, 554, 293, 672, 633, 699, 253, 506, 1246, 977]
Num selected data points: [293 633 253 506]
The chosen ones are users: [2, 4, 6, 7], which are global users: [23, 8, 52, 49]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 61, 52]
base_p: [ 1.1142343e-04 -4.5452267e-05  1.1044750e-03 ...  5.7506561e-04
 -6.0296804e-04 -1.5709475e-03]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 8, 9]
layer1_inf_time: 6.035400390625
[PAIRWISE] pred_attackers_indx:  [0 1 2 3 4 5]
layer2_inf_t: 103.97802734375
assumed final_attacker_idxs:  [0 1 2 3 4 5 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 8 9]
g_attacker_idxs: [25 26 23 96  8 61 84 32]
g_normal_idxs: [52 49]
filtered_attacker_idxs: [0, 1, 3, 5, 8, 9]
final_attacker_idxs are: [0, 1, 3, 5, 8, 9]
num_dps: [647, 554, 293, 672, 633, 699, 253, 506, 1246, 977]
___Test Local_Simple poisoned: False, epoch: 276: Average loss: 0.0293, Accuracy: 9915/10000 (99.1500%)
epoch_acc: 99.15
___Test Local_Simple poisoned: True, epoch: 276: Average loss: 15.1183, Accuracy: 6/8968 (0.0669%)
Done in 83.26267910003662 sec.
Server Epoch:277 choose agents : [74, 86, 23, 16, 59, 21, 31, 25, 5, 17].
___Train Local_Simple,  epoch 277, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%)
___Train Local_Simple,  epoch 277, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 554/557 (99.4614%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.1261, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 277, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Train Local_Simple,  epoch 277, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.0380, Accuracy: 9887/10000 (98.8700%)
___Train Local_Simple,  epoch 277, local model 23, internal_epoch   1,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 277, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.0391, Accuracy: 9882/10000 (98.8200%)
poison local model 16 index 0
___Train Local_Simple,  epoch 277, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 903/915 (98.6885%)
___Train Local_Simple,  epoch 277, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 908/915 (99.2350%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.0881, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch 277, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 750/760 (98.6842%)
___Train Local_Simple,  epoch 277, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 750/760 (98.6842%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.1691, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch 277, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 309/312 (99.0385%)
___Train Local_Simple,  epoch 277, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.1228, Accuracy: 9611/10000 (96.1100%)
___Train Local_Simple,  epoch 277, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 277, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.0559, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 277, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%)
___Train Local_Simple,  epoch 277, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 644/647 (99.5363%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.0753, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch 277, local model 5, internal_epoch   1,  Average loss: 0.0004, Accuracy: 431/434 (99.3088%)
___Train Local_Simple,  epoch 277, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.2882, Accuracy: 9050/10000 (90.5000%)
poison local model 17 index 1
___Train Local_Simple,  epoch 277, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 609/620 (98.2258%)
___Train Local_Simple,  epoch 277, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 611/620 (98.5484%)
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.1032, Accuracy: 9681/10000 (96.8100%)
time spent on training: 44.67285466194153
Starting performing KrMLRFL...
Num data points: [557, 250, 293, 915, 760, 312, 835, 647, 434, 620]
Num selected data points: [557 250 293 312 835 434]
The chosen ones are users: [0, 1, 2, 5, 6, 8], which are global users: [74, 86, 23, 21, 31, 5]
___Test Local_Simple poisoned: False, epoch: 277: Average loss: 0.0372, Accuracy: 9881/10000 (98.8100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 17]
base_p: [1.04261190e-03 1.03333965e-04 4.02716920e-04 ... 3.05324793e-05
 3.15387547e-03 1.50373578e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 7, 9]
layer1_inf_time: 3.842529296875
[PAIRWISE] pred_attackers_indx:  [3 4 9]
layer2_inf_t: 38.485595703125
assumed final_attacker_idxs:  [0 3 4 7 9]
final_attacker_idxs is: [0 3 4 7 9]
g_attacker_idxs: [74 16 59 25 17]
g_normal_idxs: [86 23 21 31  5]
filtered_attacker_idxs: [3, 4, 7, 9]
final_attacker_idxs are: [3, 4, 7, 9]
num_dps: [557, 250, 293, 915, 760, 312, 835, 647, 434, 620]
epoch_acc: 98.81
___Test Local_Simple poisoned: True, epoch: 277: Average loss: 14.6281, Accuracy: 16/8968 (0.1784%)
Done in 53.12368059158325 sec.
Server Epoch:278 choose agents : [27, 4, 5, 18, 59, 70, 84, 13, 24, 72].
poison local model 27 index 0
___Train Local_Simple,  epoch 278, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 465/471 (98.7261%)
___Train Local_Simple,  epoch 278, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 467/471 (99.1507%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.2266, Accuracy: 9402/10000 (94.0200%)
___Train Local_Simple,  epoch 278, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 648/658 (98.4802%)
___Train Local_Simple,  epoch 278, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 654/658 (99.3921%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.3573, Accuracy: 8969/10000 (89.6900%)
___Train Local_Simple,  epoch 278, local model 5, internal_epoch   1,  Average loss: 0.0001, Accuracy: 433/434 (99.7696%)
___Train Local_Simple,  epoch 278, local model 5, internal_epoch   2,  Average loss: 0.0000, Accuracy: 434/434 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.0415, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch 278, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 278, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.0538, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 278, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 746/760 (98.1579%)
___Train Local_Simple,  epoch 278, local model 59, internal_epoch   2,  Average loss: 0.0006, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.1967, Accuracy: 9394/10000 (93.9400%)
poison local model 70 index 1
___Train Local_Simple,  epoch 278, local model 70, internal_epoch   1,  Average loss: 0.0012, Accuracy: 709/724 (97.9282%)
___Train Local_Simple,  epoch 278, local model 70, internal_epoch   2,  Average loss: 0.0004, Accuracy: 720/724 (99.4475%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.3807, Accuracy: 9026/10000 (90.2600%)
___Train Local_Simple,  epoch 278, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1224/1246 (98.2343%)
___Train Local_Simple,  epoch 278, local model 84, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1232/1246 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.1055, Accuracy: 9662/10000 (96.6200%)
poison local model 13 index 2
___Train Local_Simple,  epoch 278, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 730/734 (99.4550%)
___Train Local_Simple,  epoch 278, local model 13, internal_epoch   2,  Average loss: 0.0001, Accuracy: 733/734 (99.8638%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.2491, Accuracy: 9279/10000 (92.7900%)
___Train Local_Simple,  epoch 278, local model 24, internal_epoch   1,  Average loss: 0.0002, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 278, local model 24, internal_epoch   2,  Average loss: 0.0004, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.0541, Accuracy: 9832/10000 (98.3200%)
___Train Local_Simple,  epoch 278, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 278, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.0465, Accuracy: 9855/10000 (98.5500%)
time spent on training: 45.922404289245605
Starting performing KrMLRFL...
Num data points: [471, 658, 434, 459, 760, 724, 1246, 734, 379, 731]
Num selected data points: [434 459 379 731]
The chosen ones are users: [2, 3, 8, 9], which are global users: [5, 18, 24, 72]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 70, 13]
base_p: [ 0.00031829 -0.00010236 -0.00012558 ... -0.00164399 -0.00204572
 -0.00032873]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 6, 7]
layer1_inf_time: 8.537109375
[PAIRWISE] pred_attackers_indx:  [0 3 4 5 6 7]
layer2_inf_t: 120.457275390625
assumed final_attacker_idxs:  [0 1 3 4 5 6 7]
final_attacker_idxs is: [0 1 3 4 5 6 7]
g_attacker_idxs: [27  4 18 59 70 84 13]
g_normal_idxs: [ 5 24 72]
filtered_attacker_idxs: [0, 1, 4, 5, 6, 7]
final_attacker_idxs are: [0, 1, 4, 5, 6, 7]
num_dps: [471, 658, 434, 459, 760, 724, 1246, 734, 379, 731]
___Test Local_Simple poisoned: False, epoch: 278: Average loss: 0.0304, Accuracy: 9906/10000 (99.0600%)
epoch_acc: 99.06
___Test Local_Simple poisoned: True, epoch: 278: Average loss: 14.9675, Accuracy: 7/8968 (0.0781%)
Done in 53.34062385559082 sec.
Server Epoch:279 choose agents : [86, 32, 98, 72, 77, 80, 37, 79, 71, 10].
___Train Local_Simple,  epoch 279, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Train Local_Simple,  epoch 279, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.0463, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 279, local model 32, internal_epoch   1,  Average loss: 0.0008, Accuracy: 961/977 (98.3623%)
___Train Local_Simple,  epoch 279, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 962/977 (98.4647%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.1276, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch 279, local model 98, internal_epoch   1,  Average loss: 0.0008, Accuracy: 807/818 (98.6553%)
___Train Local_Simple,  epoch 279, local model 98, internal_epoch   2,  Average loss: 0.0008, Accuracy: 807/818 (98.6553%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.1584, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch 279, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 279, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.0372, Accuracy: 9887/10000 (98.8700%)
___Train Local_Simple,  epoch 279, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch 279, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 580/589 (98.4720%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.0615, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 279, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 279, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.0890, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch 279, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 859/860 (99.8837%)
___Train Local_Simple,  epoch 279, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.1009, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch 279, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 279, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.0332, Accuracy: 9895/10000 (98.9500%)
poison local model 71 index 0
___Train Local_Simple,  epoch 279, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1371/1384 (99.0607%)
___Train Local_Simple,  epoch 279, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1376/1384 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.2941, Accuracy: 9077/10000 (90.7700%)
___Train Local_Simple,  epoch 279, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%)
___Train Local_Simple,  epoch 279, local model 10, internal_epoch   2,  Average loss: 0.0007, Accuracy: 879/892 (98.5426%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71]
base_p: [ 1.8035620e-04  4.9807131e-05  4.5355409e-06 ...  3.2877922e-04
 -9.0107322e-05 -6.9324672e-04]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 6, 8]
layer1_inf_time: 6.226806640625
[PAIRWISE] pred_attackers_indx:  [1 2 8]
layer2_inf_t: 105.921142578125
assumed final_attacker_idxs:  [1 2 4 6 8]
final_attacker_idxs is: [1 2 4 6 8]
g_attacker_idxs: [32 98 77 37 71]
g_normal_idxs: [86 72 80 79 10]
filtered_attacker_idxs: [1, 2, 4, 8]
final_attacker_idxs are: [1, 2, 4, 8]
num_dps: [250, 977, 818, 731, 589, 431, 860, 182, 1384, 892]
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.1381, Accuracy: 9542/10000 (95.4200%)
time spent on training: 40.95258092880249
Starting performing KrMLRFL...
Num data points: [250, 977, 818, 731, 589, 431, 860, 182, 1384, 892]
Num selected data points: [250 731 431 860 182 892]
The chosen ones are users: [0, 3, 5, 6, 7, 9], which are global users: [86, 72, 80, 37, 79, 10]
epoch_acc: 98.88
___Test Local_Simple poisoned: False, epoch: 279: Average loss: 0.0343, Accuracy: 9888/10000 (98.8800%)
___Test Local_Simple poisoned: True, epoch: 279: Average loss: 13.6372, Accuracy: 22/8968 (0.2453%)
Done in 48.15198731422424 sec.
Server Epoch:280 choose agents : [82, 50, 14, 20, 31, 13, 59, 1, 37, 5].
___Train Local_Simple,  epoch 280, local model 82, internal_epoch   1,  Average loss: 0.0008, Accuracy: 702/713 (98.4572%)
___Train Local_Simple,  epoch 280, local model 82, internal_epoch   2,  Average loss: 0.0004, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.6871, Accuracy: 8670/10000 (86.7000%)
___Train Local_Simple,  epoch 280, local model 50, internal_epoch   1,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%)
___Train Local_Simple,  epoch 280, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.0670, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch 280, local model 14, internal_epoch   1,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Train Local_Simple,  epoch 280, local model 14, internal_epoch   2,  Average loss: 0.0000, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.0445, Accuracy: 9851/10000 (98.5100%)
poison local model 20 index 0
___Train Local_Simple,  epoch 280, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 280, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 423/429 (98.6014%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.1696, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch 280, local model 31, internal_epoch   1,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 280, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.0425, Accuracy: 9870/10000 (98.7000%)
poison local model 13 index 1
___Train Local_Simple,  epoch 280, local model 13, internal_epoch   1,  Average loss: 0.0008, Accuracy: 724/734 (98.6376%)
___Train Local_Simple,  epoch 280, local model 13, internal_epoch   2,  Average loss: 0.0011, Accuracy: 717/734 (97.6839%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.2309, Accuracy: 9308/10000 (93.0800%)
___Train Local_Simple,  epoch 280, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 280, local model 59, internal_epoch   2,  Average loss: 0.0004, Accuracy: 755/760 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.1711, Accuracy: 9429/10000 (94.2900%)
poison local model 1 index 2
___Train Local_Simple,  epoch 280, local model 1, internal_epoch   1,  Average loss: 0.0014, Accuracy: 736/760 (96.8421%)
___Train Local_Simple,  epoch 280, local model 1, internal_epoch   2,  Average loss: 0.0010, Accuracy: 745/760 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.2322, Accuracy: 9269/10000 (92.6900%)
___Train Local_Simple,  epoch 280, local model 37, internal_epoch   1,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Train Local_Simple,  epoch 280, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.0719, Accuracy: 9774/10000 (97.7400%)
___Train Local_Simple,  epoch 280, local model 5, internal_epoch   1,  Average loss: 0.0002, Accuracy: 432/434 (99.5392%)
___Train Local_Simple,  epoch 280, local model 5, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/434 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 13, 1]
base_p: [-1.4929846e-04 -6.0051680e-06 -5.2762218e-04 ... -8.9795887e-04
  9.2577189e-04  9.0204924e-04]
[T_SCORE] attacker_local_idxs is:  [0, 3, 5, 6, 7]
layer1_inf_time: 4.725341796875
[PAIRWISE] pred_attackers_indx:  [3 5 6 7]
layer2_inf_t: 30.17236328125
assumed final_attacker_idxs:  [0 3 5 6 7]
final_attacker_idxs is: [0 3 5 6 7]
g_attacker_idxs: [82 20 13 59  1]
g_normal_idxs: [50 14 31 37  5]
filtered_attacker_idxs: [0, 3, 5, 6, 7]
final_attacker_idxs are: [0, 3, 5, 6, 7]
num_dps: [713, 474, 376, 429, 835, 734, 760, 760, 860, 434]
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.2011, Accuracy: 9285/10000 (92.8500%)
time spent on training: 106.337473154068
Starting performing KrMLRFL...
Num data points: [713, 474, 376, 429, 835, 734, 760, 760, 860, 434]
Num selected data points: [474 376 835 860 434]
The chosen ones are users: [1, 2, 4, 8, 9], which are global users: [50, 14, 31, 37, 5]
epoch_acc: 98.82
___Test Local_Simple poisoned: False, epoch: 280: Average loss: 0.0374, Accuracy: 9882/10000 (98.8200%)
___Test Local_Simple poisoned: True, epoch: 280: Average loss: 13.7202, Accuracy: 28/8968 (0.3122%)
Done in 113.79229712486267 sec.
Server Epoch:281 choose agents : [5, 61, 35, 44, 90, 32, 79, 28, 78, 76].
___Train Local_Simple,  epoch 281, local model 5, internal_epoch   1,  Average loss: 0.0001, Accuracy: 433/434 (99.7696%)
___Train Local_Simple,  epoch 281, local model 5, internal_epoch   2,  Average loss: 0.0000, Accuracy: 434/434 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0469, Accuracy: 9855/10000 (98.5500%)
poison local model 61 index 0
___Train Local_Simple,  epoch 281, local model 61, internal_epoch   1,  Average loss: 0.0014, Accuracy: 686/699 (98.1402%)
___Train Local_Simple,  epoch 281, local model 61, internal_epoch   2,  Average loss: 0.0010, Accuracy: 685/699 (97.9971%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.3051, Accuracy: 8903/10000 (89.0300%)
___Train Local_Simple,  epoch 281, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 281, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0803, Accuracy: 9748/10000 (97.4800%)
___Train Local_Simple,  epoch 281, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 516/517 (99.8066%)
___Train Local_Simple,  epoch 281, local model 44, internal_epoch   2,  Average loss: 0.0001, Accuracy: 516/517 (99.8066%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0639, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch 281, local model 90, internal_epoch   1,  Average loss: 0.0003, Accuracy: 679/683 (99.4143%)
___Train Local_Simple,  epoch 281, local model 90, internal_epoch   2,  Average loss: 0.0004, Accuracy: 674/683 (98.6823%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.1086, Accuracy: 9630/10000 (96.3000%)
___Train Local_Simple,  epoch 281, local model 32, internal_epoch   1,  Average loss: 0.0013, Accuracy: 951/977 (97.3388%)
___Train Local_Simple,  epoch 281, local model 32, internal_epoch   2,  Average loss: 0.0007, Accuracy: 965/977 (98.7718%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.1561, Accuracy: 9539/10000 (95.3900%)
___Train Local_Simple,  epoch 281, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 281, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0340, Accuracy: 9896/10000 (98.9600%)
___Train Local_Simple,  epoch 281, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 281, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0352, Accuracy: 9894/10000 (98.9400%)
___Train Local_Simple,  epoch 281, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 281, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0736, Accuracy: 9773/10000 (97.7300%)
___Train Local_Simple,  epoch 281, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 281, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61]
base_p: [-7.3326379e-04  5.6896359e-05  5.4790359e-04 ...  1.8987060e-03
  2.9093251e-03 -2.3977235e-03]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 7]
layer1_inf_time: 4.297119140625
[PAIRWISE] pred_attackers_indx:  [0 1 5]
layer2_inf_t: 214.877197265625
assumed final_attacker_idxs:  [0 1 3 4 5 7]
final_attacker_idxs is: [0 1 3 4 5 7]
g_attacker_idxs: [ 5 61 44 90 32 28]
g_normal_idxs: [35 79 78 76]
filtered_attacker_idxs: [1, 5]
final_attacker_idxs are: [1, 5]
num_dps: [434, 699, 499, 517, 683, 977, 182, 501, 303, 78]
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0351, Accuracy: 9895/10000 (98.9500%)
time spent on training: 37.197163343429565
Starting performing KrMLRFL...
Num data points: [434, 699, 499, 517, 683, 977, 182, 501, 303, 78]
Num selected data points: [434 499 517 683 182 501 303  78]
The chosen ones are users: [0, 2, 3, 4, 6, 7, 8, 9], which are global users: [5, 35, 44, 90, 79, 28, 78, 76]
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: False, epoch: 281: Average loss: 0.0307, Accuracy: 9901/10000 (99.0100%)
___Test Local_Simple poisoned: True, epoch: 281: Average loss: 14.0451, Accuracy: 9/8968 (0.1004%)
Done in 42.92026400566101 sec.
Server Epoch:282 choose agents : [49, 23, 43, 99, 16, 71, 28, 48, 54, 30].
___Train Local_Simple,  epoch 282, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 282, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0646, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch 282, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 282, local model 23, internal_epoch   2,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0377, Accuracy: 9883/10000 (98.8300%)
___Train Local_Simple,  epoch 282, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 282, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0384, Accuracy: 9878/10000 (98.7800%)
___Train Local_Simple,  epoch 282, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 374/377 (99.2042%)
___Train Local_Simple,  epoch 282, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0491, Accuracy: 9847/10000 (98.4700%)
poison local model 16 index 0
___Train Local_Simple,  epoch 282, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 904/915 (98.7978%)
___Train Local_Simple,  epoch 282, local model 16, internal_epoch   2,  Average loss: 0.0010, Accuracy: 899/915 (98.2514%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.1113, Accuracy: 9669/10000 (96.6900%)
poison local model 71 index 1
___Train Local_Simple,  epoch 282, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1367/1384 (98.7717%)
___Train Local_Simple,  epoch 282, local model 71, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1371/1384 (99.0607%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.2241, Accuracy: 9271/10000 (92.7100%)
___Train Local_Simple,  epoch 282, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 282, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0350, Accuracy: 9888/10000 (98.8800%)
___Train Local_Simple,  epoch 282, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch 282, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0591, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 282, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch 282, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 514/519 (99.0366%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0994, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch 282, local model 30, internal_epoch   1,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Train Local_Simple,  epoch 282, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0728, Accuracy: 9788/10000 (97.8800%)
time spent on training: 40.96347212791443
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 71]
base_p: [ 8.3313137e-04  8.6644664e-05  1.3948586e-03 ... -6.0728192e-04
  3.6619604e-05 -9.6428394e-04]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 6, 8]
layer1_inf_time: 4.15625
[PAIRWISE] pred_attackers_indx:  [4 5]
layer2_inf_t: 165.618408203125
assumed final_attacker_idxs:  [0 4 5 6 8]
final_attacker_idxs is: [0 4 5 6 8]
g_attacker_idxs: [49 16 71 28 54]
g_normal_idxs: [23 43 99 48 30]
filtered_attacker_idxs: [0, 4, 5]
final_attacker_idxs are: [0, 4, 5]
num_dps: [506, 293, 408, 377, 915, 1384, 501, 448, 519, 400]
epoch_acc: 99.03
Starting performing KrMLRFL...
Num data points: [506, 293, 408, 377, 915, 1384, 501, 448, 519, 400]
Num selected data points: [293 408 377 501 448 519 400]
The chosen ones are users: [1, 2, 3, 6, 7, 8, 9], which are global users: [23, 43, 99, 28, 48, 54, 30]
___Test Local_Simple poisoned: False, epoch: 282: Average loss: 0.0323, Accuracy: 9903/10000 (99.0300%)
___Test Local_Simple poisoned: True, epoch: 282: Average loss: 14.1973, Accuracy: 5/8968 (0.0558%)
Done in 47.26388382911682 sec.
Server Epoch:283 choose agents : [73, 58, 95, 27, 76, 61, 67, 87, 91, 23].
poison local model 73 index 0
___Train Local_Simple,  epoch 283, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%)
___Train Local_Simple,  epoch 283, local model 73, internal_epoch   2,  Average loss: 0.0007, Accuracy: 588/591 (99.4924%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.1265, Accuracy: 9600/10000 (96.0000%)
___Train Local_Simple,  epoch 283, local model 58, internal_epoch   1,  Average loss: 0.0002, Accuracy: 275/276 (99.6377%)
___Train Local_Simple,  epoch 283, local model 58, internal_epoch   2,  Average loss: 0.0000, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.0693, Accuracy: 9785/10000 (97.8500%)
___Train Local_Simple,  epoch 283, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch 283, local model 95, internal_epoch   2,  Average loss: 0.0004, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.3745, Accuracy: 8993/10000 (89.9300%)
poison local model 27 index 1
___Train Local_Simple,  epoch 283, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 462/471 (98.0892%)
___Train Local_Simple,  epoch 283, local model 27, internal_epoch   2,  Average loss: 0.0007, Accuracy: 463/471 (98.3015%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.2481, Accuracy: 9380/10000 (93.8000%)
___Train Local_Simple,  epoch 283, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 283, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.0312, Accuracy: 9908/10000 (99.0800%)
poison local model 61 index 2
___Train Local_Simple,  epoch 283, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 687/699 (98.2833%)
___Train Local_Simple,  epoch 283, local model 61, internal_epoch   2,  Average loss: 0.0005, Accuracy: 692/699 (98.9986%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.3130, Accuracy: 8888/10000 (88.8800%)
___Train Local_Simple,  epoch 283, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 988/998 (98.9980%)
___Train Local_Simple,  epoch 283, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 993/998 (99.4990%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.2072, Accuracy: 9374/10000 (93.7400%)
___Train Local_Simple,  epoch 283, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch 283, local model 87, internal_epoch   2,  Average loss: 0.0003, Accuracy: 469/470 (99.7872%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.0760, Accuracy: 9756/10000 (97.5600%)
poison local model 91 index 3
___Train Local_Simple,  epoch 283, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 283, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.0432, Accuracy: 9864/10000 (98.6400%)
___Train Local_Simple,  epoch 283, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 283, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.0381, Accuracy: 9886/10000 (98.8600%)
time spent on training: 53.87092113494873
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73, 27, 61, 91]
base_p: [-0.00024085  0.00013744 -0.00075901 ... -0.00191717 -0.00083064
 -0.00064118]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 6]
layer1_inf_time: 3.97265625
[PAIRWISE] pred_attackers_indx:  [0 2 5]
layer2_inf_t: 100.703369140625
assumed final_attacker_idxs:  [0 2 3 5 6]
final_attacker_idxs is: [0 2 3 5 6]
g_attacker_idxs: [73 95 27 61 67]
g_normal_idxs: [58 76 87 91 23]
filtered_attacker_idxs: [0, 2, 3, 5, 6]
final_attacker_idxs are: [0, 2, 3, 5, 6]
num_dps: [591, 276, 602, 471, 78, 699, 998, 470, 256, 293]
Starting performing KrMLRFL...
Num data points: [591, 276, 602, 471, 78, 699, 998, 470, 256, 293]
Num selected data points: [276  78 470 256 293]
The chosen ones are users: [1, 4, 7, 8, 9], which are global users: [58, 76, 87, 91, 23]
___Test Local_Simple poisoned: False, epoch: 283: Average loss: 0.0348, Accuracy: 9882/10000 (98.8200%)
epoch_acc: 98.82
___Test Local_Simple poisoned: True, epoch: 283: Average loss: 13.4792, Accuracy: 29/8968 (0.3234%)
Done in 59.86474967002869 sec.
Server Epoch:284 choose agents : [41, 84, 59, 70, 65, 50, 72, 75, 6, 91].
___Train Local_Simple,  epoch 284, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 600/606 (99.0099%)
___Train Local_Simple,  epoch 284, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0554, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 284, local model 84, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1210/1246 (97.1108%)
___Train Local_Simple,  epoch 284, local model 84, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1218/1246 (97.7528%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.1391, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch 284, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 284, local model 59, internal_epoch   2,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0976, Accuracy: 9673/10000 (96.7300%)
poison local model 70 index 0
___Train Local_Simple,  epoch 284, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 708/724 (97.7901%)
___Train Local_Simple,  epoch 284, local model 70, internal_epoch   2,  Average loss: 0.0008, Accuracy: 712/724 (98.3425%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.2923, Accuracy: 9193/10000 (91.9300%)
___Train Local_Simple,  epoch 284, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 284, local model 65, internal_epoch   2,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0378, Accuracy: 9882/10000 (98.8200%)
___Train Local_Simple,  epoch 284, local model 50, internal_epoch   1,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Train Local_Simple,  epoch 284, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0870, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch 284, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 284, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 729/731 (99.7264%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0438, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 284, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Train Local_Simple,  epoch 284, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0570, Accuracy: 9824/10000 (98.2400%)
___Train Local_Simple,  epoch 284, local model 6, internal_epoch   1,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 284, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0441, Accuracy: 9859/10000 (98.5900%)
poison local model 91 index 1
___Train Local_Simple,  epoch 284, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Train Local_Simple,  epoch 284, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0370, Accuracy: 9884/10000 (98.8400%)
time spent on training: 54.05215239524841
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 91]
base_p: [-0.0010106  -0.00026078 -0.00041764 ... -0.00100082  0.00240528
  0.00131308]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 7]
layer1_inf_time: 3.337646484375
[PAIRWISE] pred_attackers_indx:  [1 2 3 7]
layer2_inf_t: 38.003662109375
assumed final_attacker_idxs:  [0 1 2 3 7]
final_attacker_idxs is: [0 1 2 3 7]
g_attacker_idxs: [41 84 59 70 75]
g_normal_idxs: [65 50 72  6 91]
filtered_attacker_idxs: [0, 1, 2, 3]
final_attacker_idxs are: [0, 1, 2, 3]
num_dps: [606, 1246, 760, 724, 371, 474, 731, 686, 615, 256]
epoch_acc: 99.09
Starting performing KrMLRFL...
Num data points: [606, 1246, 760, 724, 371, 474, 731, 686, 615, 256]
Num selected data points: [371 474 731 686 615 256]
The chosen ones are users: [4, 5, 6, 7, 8, 9], which are global users: [65, 50, 72, 75, 6, 91]
___Test Local_Simple poisoned: False, epoch: 284: Average loss: 0.0296, Accuracy: 9909/10000 (99.0900%)
___Test Local_Simple poisoned: True, epoch: 284: Average loss: 14.7591, Accuracy: 7/8968 (0.0781%)
Done in 60.185139179229736 sec.
Server Epoch:285 choose agents : [7, 52, 90, 78, 84, 40, 11, 49, 92, 50].
poison local model 7 index 0
___Train Local_Simple,  epoch 285, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 415/418 (99.2823%)
___Train Local_Simple,  epoch 285, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.2483, Accuracy: 9352/10000 (93.5200%)
poison local model 52 index 1
___Train Local_Simple,  epoch 285, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 285, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.1243, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch 285, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Train Local_Simple,  epoch 285, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.1133, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 285, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch 285, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.0702, Accuracy: 9774/10000 (97.7400%)
___Train Local_Simple,  epoch 285, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1227/1246 (98.4751%)
___Train Local_Simple,  epoch 285, local model 84, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1220/1246 (97.9133%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.0787, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch 285, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 768/772 (99.4819%)
___Train Local_Simple,  epoch 285, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 770/772 (99.7409%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.0819, Accuracy: 9751/10000 (97.5100%)
poison local model 11 index 2
___Train Local_Simple,  epoch 285, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 631/645 (97.8295%)
___Train Local_Simple,  epoch 285, local model 11, internal_epoch   2,  Average loss: 0.0014, Accuracy: 630/645 (97.6744%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.2383, Accuracy: 9269/10000 (92.6900%)
___Train Local_Simple,  epoch 285, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Train Local_Simple,  epoch 285, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.0413, Accuracy: 9870/10000 (98.7000%)
___Train Local_Simple,  epoch 285, local model 92, internal_epoch   1,  Average loss: 0.0009, Accuracy: 924/937 (98.6126%)
___Train Local_Simple,  epoch 285, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 929/937 (99.1462%)
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.2065, Accuracy: 9345/10000 (93.4500%)
___Train Local_Simple,  epoch 285, local model 50, internal_epoch   1,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Train Local_Simple,  epoch 285, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 52, 11]
base_p: [-1.7929785e-03 -9.1239810e-05  1.5795613e-03 ... -1.3097078e-03
 -3.2757595e-03 -2.1460652e-03]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 6, 8]
layer1_inf_time: 3.439208984375
[PAIRWISE] pred_attackers_indx:  [4 6 8]
layer2_inf_t: 180.068115234375
assumed final_attacker_idxs:  [0 4 5 6 8]
final_attacker_idxs is: [0 4 5 6 8]
g_attacker_idxs: [ 7 84 40 11 92]
g_normal_idxs: [52 90 78 49 50]
filtered_attacker_idxs: [0, 4, 5, 6, 8]
final_attacker_idxs are: [0, 4, 5, 6, 8]
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.0370, Accuracy: 9880/10000 (98.8000%)
time spent on training: 49.18420767784119
Starting performing KrMLRFL...
Num data points: [418, 253, 683, 303, 1246, 772, 645, 506, 937, 474]
Num selected data points: [253 683 303 506 474]
The chosen ones are users: [1, 2, 3, 7, 9], which are global users: [52, 90, 78, 49, 50]
num_dps: [418, 253, 683, 303, 1246, 772, 645, 506, 937, 474]
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: False, epoch: 285: Average loss: 0.0329, Accuracy: 9893/10000 (98.9300%)
___Test Local_Simple poisoned: True, epoch: 285: Average loss: 15.4194, Accuracy: 4/8968 (0.0446%)
Done in 56.98740887641907 sec.
Server Epoch:286 choose agents : [7, 50, 68, 27, 78, 79, 56, 77, 10, 31].
poison local model 7 index 0
___Train Local_Simple,  epoch 286, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 414/418 (99.0431%)
___Train Local_Simple,  epoch 286, local model 7, internal_epoch   2,  Average loss: 0.0005, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.2103, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch 286, local model 50, internal_epoch   1,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%)
___Train Local_Simple,  epoch 286, local model 50, internal_epoch   2,  Average loss: 0.0000, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0368, Accuracy: 9879/10000 (98.7900%)
___Train Local_Simple,  epoch 286, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 286, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0563, Accuracy: 9822/10000 (98.2200%)
poison local model 27 index 1
___Train Local_Simple,  epoch 286, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 461/471 (97.8769%)
___Train Local_Simple,  epoch 286, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 467/471 (99.1507%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.2041, Accuracy: 9404/10000 (94.0400%)
___Train Local_Simple,  epoch 286, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 286, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0452, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 286, local model 79, internal_epoch   1,  Average loss: 0.0003, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 286, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0435, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch 286, local model 56, internal_epoch   1,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 286, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0356, Accuracy: 9879/10000 (98.7900%)
___Train Local_Simple,  epoch 286, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch 286, local model 77, internal_epoch   2,  Average loss: 0.0012, Accuracy: 580/589 (98.4720%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0683, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 286, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 286, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0617, Accuracy: 9810/10000 (98.1000%)
___Train Local_Simple,  epoch 286, local model 31, internal_epoch   1,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 286, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0509, Accuracy: 9850/10000 (98.5000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 27]
base_p: [ 0.0001842   0.00010068 -0.00011913 ... -0.00107583  0.00051109
 -0.00119342]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 7, 8]
layer1_inf_time: 3.643310546875
[PAIRWISE] pred_attackers_indx:  [2 4 5 6 7 8 9]
layer2_inf_t: 364.96044921875
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 8 9]
g_attacker_idxs: [ 7 50 68 27 78 79 56 77 10 31]
g_normal_idxs: []
filtered_attacker_idxs: [0, 3, 7]
final_attacker_idxs are: [0, 3, 7]
num_dps: [418, 474, 494, 471, 303, 182, 880, 589, 892, 835]
time spent on training: 43.1508846282959
Starting performing KrMLRFL...
Num data points: [418, 474, 494, 471, 303, 182, 880, 589, 892, 835]
Num selected data points: [474 494 303 182 880 892 835]
The chosen ones are users: [1, 2, 4, 5, 6, 8, 9], which are global users: [50, 68, 78, 79, 56, 10, 31]
epoch_acc: 98.99
___Test Local_Simple poisoned: False, epoch: 286: Average loss: 0.0319, Accuracy: 9899/10000 (98.9900%)
___Test Local_Simple poisoned: True, epoch: 286: Average loss: 15.4065, Accuracy: 9/8968 (0.1004%)
Done in 53.30282187461853 sec.
Server Epoch:287 choose agents : [45, 63, 78, 29, 33, 82, 96, 27, 65, 28].
poison local model 45 index 0
___Train Local_Simple,  epoch 287, local model 45, internal_epoch   1,  Average loss: 0.0007, Accuracy: 622/628 (99.0446%)
___Train Local_Simple,  epoch 287, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 617/628 (98.2484%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.1733, Accuracy: 9443/10000 (94.4300%)
poison local model 63 index 1
___Train Local_Simple,  epoch 287, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 875/889 (98.4252%)
___Train Local_Simple,  epoch 287, local model 63, internal_epoch   2,  Average loss: 0.0013, Accuracy: 863/889 (97.0754%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.1232, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch 287, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 287, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.1262, Accuracy: 9618/10000 (96.1800%)
___Train Local_Simple,  epoch 287, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Train Local_Simple,  epoch 287, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.1119, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch 287, local model 33, internal_epoch   1,  Average loss: 0.0003, Accuracy: 618/623 (99.1974%)
___Train Local_Simple,  epoch 287, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 615/623 (98.7159%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.0803, Accuracy: 9749/10000 (97.4900%)
___Train Local_Simple,  epoch 287, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 708/713 (99.2987%)
___Train Local_Simple,  epoch 287, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.7354, Accuracy: 8791/10000 (87.9100%)
___Train Local_Simple,  epoch 287, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 664/672 (98.8095%)
___Train Local_Simple,  epoch 287, local model 96, internal_epoch   2,  Average loss: 0.0002, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.1939, Accuracy: 9351/10000 (93.5100%)
poison local model 27 index 2
___Train Local_Simple,  epoch 287, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 459/471 (97.4522%)
___Train Local_Simple,  epoch 287, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 465/471 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.4050, Accuracy: 9160/10000 (91.6000%)
___Train Local_Simple,  epoch 287, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Train Local_Simple,  epoch 287, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.0433, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 287, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 287, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 63, 27]
base_p: [ 0.00181855  0.00023724 -0.00023807 ... -0.00232816 -0.00048068
  0.00108202]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 6, 7]
layer1_inf_time: 3.165283203125
[PAIRWISE] pred_attackers_indx:  [0 1 6]
layer2_inf_t: 52.9560546875
assumed final_attacker_idxs:  [0 1 5 6 7]
final_attacker_idxs is: [0 1 5 6 7]
g_attacker_idxs: [45 63 82 96 27]
g_normal_idxs: [78 29 33 65 28]
filtered_attacker_idxs: [0, 1, 5, 6, 7]
final_attacker_idxs are: [0, 1, 5, 6, 7]
num_dps: [628, 889, 303, 1002, 623, 713, 672, 471, 371, 501]
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.0358, Accuracy: 9899/10000 (98.9900%)
time spent on training: 48.87495017051697
Starting performing KrMLRFL...
Num data points: [628, 889, 303, 1002, 623, 713, 672, 471, 371, 501]
Num selected data points: [ 303 1002  623  371  501]
The chosen ones are users: [2, 3, 4, 8, 9], which are global users: [78, 29, 33, 65, 28]
epoch_acc: 98.96000000000001
___Test Local_Simple poisoned: False, epoch: 287: Average loss: 0.0325, Accuracy: 9896/10000 (98.9600%)
___Test Local_Simple poisoned: True, epoch: 287: Average loss: 14.4350, Accuracy: 11/8968 (0.1227%)
Done in 57.53174114227295 sec.
Server Epoch:288 choose agents : [75, 72, 26, 81, 90, 93, 60, 48, 1, 88].
___Train Local_Simple,  epoch 288, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 686/686 (100.0000%)
___Train Local_Simple,  epoch 288, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.0562, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch 288, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 288, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.0390, Accuracy: 9877/10000 (98.7700%)
poison local model 26 index 0
___Train Local_Simple,  epoch 288, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 288, local model 26, internal_epoch   2,  Average loss: 0.0008, Accuracy: 544/554 (98.1949%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.1577, Accuracy: 9533/10000 (95.3300%)
poison local model 81 index 1
___Train Local_Simple,  epoch 288, local model 81, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1209/1227 (98.5330%)
___Train Local_Simple,  epoch 288, local model 81, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1211/1227 (98.6960%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.2734, Accuracy: 9229/10000 (92.2900%)
___Train Local_Simple,  epoch 288, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Train Local_Simple,  epoch 288, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.0652, Accuracy: 9806/10000 (98.0600%)
poison local model 93 index 2
___Train Local_Simple,  epoch 288, local model 93, internal_epoch   1,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 288, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.2641, Accuracy: 9304/10000 (93.0400%)
___Train Local_Simple,  epoch 288, local model 60, internal_epoch   1,  Average loss: 0.0002, Accuracy: 338/338 (100.0000%)
___Train Local_Simple,  epoch 288, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.0488, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 288, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch 288, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.0612, Accuracy: 9798/10000 (97.9800%)
poison local model 1 index 3
___Train Local_Simple,  epoch 288, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 288, local model 1, internal_epoch   2,  Average loss: 0.0009, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.1947, Accuracy: 9391/10000 (93.9100%)
___Train Local_Simple,  epoch 288, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 288, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 81, 93, 1]
base_p: [ 3.2968819e-06 -3.3801422e-05  1.4035217e-04 ...  2.2612959e-03
 -1.6246736e-04  1.2245476e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 8]
layer1_inf_time: 3.7734375
[PAIRWISE] pred_attackers_indx:  [3 5]
layer2_inf_t: 55.5009765625
assumed final_attacker_idxs:  [0 2 3 5 8]
final_attacker_idxs is: [0 2 3 5 8]
g_attacker_idxs: [75 26 81 93  1]
g_normal_idxs: [72 90 60 48 88]
filtered_attacker_idxs: [2, 3, 5, 8]
final_attacker_idxs are: [2, 3, 5, 8]
num_dps: [686, 731, 554, 1227, 683, 623, 338, 448, 760, 530]
epoch_acc: 98.97
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.0532, Accuracy: 9840/10000 (98.4000%)
time spent on training: 60.43394899368286
Starting performing KrMLRFL...
Num data points: [686, 731, 554, 1227, 683, 623, 338, 448, 760, 530]
Num selected data points: [686 731 683 338 448 530]
The chosen ones are users: [0, 1, 4, 6, 7, 9], which are global users: [75, 72, 90, 60, 48, 88]
___Test Local_Simple poisoned: False, epoch: 288: Average loss: 0.0313, Accuracy: 9897/10000 (98.9700%)
___Test Local_Simple poisoned: True, epoch: 288: Average loss: 14.7992, Accuracy: 8/8968 (0.0892%)
Done in 66.77421355247498 sec.
Server Epoch:289 choose agents : [74, 58, 96, 21, 75, 48, 51, 63, 79, 26].
___Train Local_Simple,  epoch 289, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%)
___Train Local_Simple,  epoch 289, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0507, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 289, local model 58, internal_epoch   1,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Train Local_Simple,  epoch 289, local model 58, internal_epoch   2,  Average loss: 0.0000, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0382, Accuracy: 9879/10000 (98.7900%)
___Train Local_Simple,  epoch 289, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 665/672 (98.9583%)
___Train Local_Simple,  epoch 289, local model 96, internal_epoch   2,  Average loss: 0.0006, Accuracy: 662/672 (98.5119%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.2012, Accuracy: 9337/10000 (93.3700%)
___Train Local_Simple,  epoch 289, local model 21, internal_epoch   1,  Average loss: 0.0002, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch 289, local model 21, internal_epoch   2,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0617, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 289, local model 75, internal_epoch   1,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Train Local_Simple,  epoch 289, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0493, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 289, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Train Local_Simple,  epoch 289, local model 48, internal_epoch   2,  Average loss: 0.0000, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0436, Accuracy: 9864/10000 (98.6400%)
poison local model 51 index 0
___Train Local_Simple,  epoch 289, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 289, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.1655, Accuracy: 9505/10000 (95.0500%)
poison local model 63 index 1
___Train Local_Simple,  epoch 289, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 868/889 (97.6378%)
___Train Local_Simple,  epoch 289, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 873/889 (98.2002%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0794, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch 289, local model 79, internal_epoch   1,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 289, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0355, Accuracy: 9890/10000 (98.9000%)
poison local model 26 index 2
___Train Local_Simple,  epoch 289, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 289, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.1009, Accuracy: 9688/10000 (96.8800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 63, 26]
base_p: [5.50549477e-04 2.11639330e-04 1.12058595e-04 ... 1.59126520e-03
 6.08876348e-04 9.55536962e-05]
[T_SCORE] attacker_local_idxs is:  [2, 4, 6, 7, 9]
layer1_inf_time: 3.286865234375
[PAIRWISE] pred_attackers_indx:  [6 7]
layer2_inf_t: 37.654541015625
assumed final_attacker_idxs:  [2 4 6 7 9]
final_attacker_idxs is: [2 4 6 7 9]
g_attacker_idxs: [96 75 51 63 26]
g_normal_idxs: [74 58 21 48 79]
filtered_attacker_idxs: [2, 6, 7, 9]
final_attacker_idxs are: [2, 6, 7, 9]
num_dps: [557, 276, 672, 312, 686, 448, 568, 889, 182, 554]
time spent on training: 47.63209939002991
Starting performing KrMLRFL...
Num data points: [557, 276, 672, 312, 686, 448, 568, 889, 182, 554]
Num selected data points: [557 276 312 686 448 182]
The chosen ones are users: [0, 1, 3, 4, 5, 8], which are global users: [74, 58, 21, 75, 48, 79]
epoch_acc: 98.97
___Test Local_Simple poisoned: False, epoch: 289: Average loss: 0.0322, Accuracy: 9897/10000 (98.9700%)
___Test Local_Simple poisoned: True, epoch: 289: Average loss: 15.0552, Accuracy: 8/8968 (0.0892%)
Done in 54.41425657272339 sec.
Server Epoch:290 choose agents : [15, 87, 72, 95, 56, 93, 33, 0, 6, 82].
___Train Local_Simple,  epoch 290, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 290, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.0550, Accuracy: 9831/10000 (98.3100%)
___Train Local_Simple,  epoch 290, local model 87, internal_epoch   1,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 290, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.0455, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 290, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 290, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.0492, Accuracy: 9864/10000 (98.6400%)
___Train Local_Simple,  epoch 290, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch 290, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 1.1102, Accuracy: 7891/10000 (78.9100%)
___Train Local_Simple,  epoch 290, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 290, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.0372, Accuracy: 9876/10000 (98.7600%)
poison local model 93 index 0
___Train Local_Simple,  epoch 290, local model 93, internal_epoch   1,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Train Local_Simple,  epoch 290, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.2110, Accuracy: 9436/10000 (94.3600%)
___Train Local_Simple,  epoch 290, local model 33, internal_epoch   1,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%)
___Train Local_Simple,  epoch 290, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.0421, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 290, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Train Local_Simple,  epoch 290, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.1131, Accuracy: 9675/10000 (96.7500%)
___Train Local_Simple,  epoch 290, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Train Local_Simple,  epoch 290, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 612/615 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.0765, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch 290, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch 290, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93]
base_p: [ 2.0875782e-04  1.3812073e-04  6.0480088e-06 ... -9.9562109e-04
 -4.7348738e-03 -7.8168511e-04]
[T_SCORE] attacker_local_idxs is:  [0, 3, 5, 7, 9]
layer1_inf_time: 3.073486328125
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 1.0680, Accuracy: 8666/10000 (86.6600%)
time spent on training: 45.424339056015015
Starting performing KrMLRFL...
Num data points: [401, 470, 731, 602, 880, 623, 623, 435, 615, 713]
Num selected data points: [401 470 731 880 623 435 615]
The chosen ones are users: [0, 1, 2, 4, 6, 7, 8], which are global users: [15, 87, 72, 56, 33, 0, 6]
[PAIRWISE] pred_attackers_indx:  [3 5 7]
layer2_inf_t: 889.35546875
assumed final_attacker_idxs:  [0 3 5 7 9]
final_attacker_idxs is: [0 3 5 7 9]
g_attacker_idxs: [15 95 93  0 82]
g_normal_idxs: [87 72 56 33  6]
filtered_attacker_idxs: [3, 5, 9]
final_attacker_idxs are: [3, 5, 9]
num_dps: [401, 470, 731, 602, 880, 623, 623, 435, 615, 713]
epoch_acc: 99.03
___Test Local_Simple poisoned: False, epoch: 290: Average loss: 0.0301, Accuracy: 9903/10000 (99.0300%)
___Test Local_Simple poisoned: True, epoch: 290: Average loss: 15.2983, Accuracy: 8/8968 (0.0892%)
Done in 107.21128726005554 sec.
Server Epoch:291 choose agents : [9, 39, 19, 15, 33, 11, 71, 63, 79, 58].
___Train Local_Simple,  epoch 291, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 433/436 (99.3119%)
___Train Local_Simple,  epoch 291, local model 9, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/436 (99.3119%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0846, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch 291, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 291, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0341, Accuracy: 9889/10000 (98.8900%)
___Train Local_Simple,  epoch 291, local model 19, internal_epoch   1,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Train Local_Simple,  epoch 291, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0435, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch 291, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 291, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0314, Accuracy: 9890/10000 (98.9000%)
___Train Local_Simple,  epoch 291, local model 33, internal_epoch   1,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%)
___Train Local_Simple,  epoch 291, local model 33, internal_epoch   2,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0356, Accuracy: 9887/10000 (98.8700%)
poison local model 11 index 0
___Train Local_Simple,  epoch 291, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 637/645 (98.7597%)
___Train Local_Simple,  epoch 291, local model 11, internal_epoch   2,  Average loss: 0.0010, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.2289, Accuracy: 9272/10000 (92.7200%)
poison local model 71 index 1
___Train Local_Simple,  epoch 291, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1368/1384 (98.8439%)
___Train Local_Simple,  epoch 291, local model 71, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1380/1384 (99.7110%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.3136, Accuracy: 9124/10000 (91.2400%)
poison local model 63 index 2
___Train Local_Simple,  epoch 291, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 872/889 (98.0877%)
___Train Local_Simple,  epoch 291, local model 63, internal_epoch   2,  Average loss: 0.0004, Accuracy: 884/889 (99.4376%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0620, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch 291, local model 79, internal_epoch   1,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 291, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0336, Accuracy: 9893/10000 (98.9300%)
___Train Local_Simple,  epoch 291, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 274/276 (99.2754%)
___Train Local_Simple,  epoch 291, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.4276, Accuracy: 9177/10000 (91.7700%)
time spent on training: 49.65304183959961
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 71, 63]
base_p: [ 0.00049235  0.00015596 -0.00013106 ... -0.0011315   0.00210669
 -0.00019074]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 6, 7]
layer1_inf_time: 4.212890625
[PAIRWISE] pred_attackers_indx:  [5 6 7]
layer2_inf_t: 37.038818359375
assumed final_attacker_idxs:  [3 4 5 6 7]
final_attacker_idxs is: [3 4 5 6 7]
g_attacker_idxs: [15 33 11 71 63]
g_normal_idxs: [ 9 39 19 79 58]
filtered_attacker_idxs: [5, 6, 7]
final_attacker_idxs are: [5, 6, 7]
num_dps: [436, 257, 205, 401, 623, 645, 1384, 889, 182, 276]
Starting performing KrMLRFL...
Num data points: [436, 257, 205, 401, 623, 645, 1384, 889, 182, 276]
Num selected data points: [436 257 205 401 623 182 276]
The chosen ones are users: [0, 1, 2, 3, 4, 8, 9], which are global users: [9, 39, 19, 15, 33, 79, 58]
___Test Local_Simple poisoned: False, epoch: 291: Average loss: 0.0296, Accuracy: 9908/10000 (99.0800%)
epoch_acc: 99.08
___Test Local_Simple poisoned: True, epoch: 291: Average loss: 15.5296, Accuracy: 8/8968 (0.0892%)
Done in 56.69553756713867 sec.
Server Epoch:292 choose agents : [3, 95, 85, 74, 75, 34, 90, 81, 5, 82].
___Train Local_Simple,  epoch 292, local model 3, internal_epoch   1,  Average loss: 0.0006, Accuracy: 913/923 (98.9166%)
___Train Local_Simple,  epoch 292, local model 3, internal_epoch   2,  Average loss: 0.0004, Accuracy: 916/923 (99.2416%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.2640, Accuracy: 9218/10000 (92.1800%)
___Train Local_Simple,  epoch 292, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 292, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.3630, Accuracy: 8672/10000 (86.7200%)
poison local model 85 index 0
___Train Local_Simple,  epoch 292, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 292, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.1177, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch 292, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 557/557 (100.0000%)
___Train Local_Simple,  epoch 292, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 555/557 (99.6409%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.0437, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 292, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 686/686 (100.0000%)
___Train Local_Simple,  epoch 292, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.0433, Accuracy: 9859/10000 (98.5900%)
poison local model 34 index 1
___Train Local_Simple,  epoch 292, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 410/413 (99.2736%)
___Train Local_Simple,  epoch 292, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.1488, Accuracy: 9586/10000 (95.8600%)
___Train Local_Simple,  epoch 292, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Train Local_Simple,  epoch 292, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.1218, Accuracy: 9683/10000 (96.8300%)
poison local model 81 index 2
___Train Local_Simple,  epoch 292, local model 81, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1215/1227 (99.0220%)
___Train Local_Simple,  epoch 292, local model 81, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1203/1227 (98.0440%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.4102, Accuracy: 8836/10000 (88.3600%)
___Train Local_Simple,  epoch 292, local model 5, internal_epoch   1,  Average loss: 0.0002, Accuracy: 432/434 (99.5392%)
___Train Local_Simple,  epoch 292, local model 5, internal_epoch   2,  Average loss: 0.0000, Accuracy: 434/434 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.1323, Accuracy: 9550/10000 (95.5000%)
___Train Local_Simple,  epoch 292, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 705/713 (98.8780%)
___Train Local_Simple,  epoch 292, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 34, 81]
base_p: [ 0.00056049  0.00020887 -0.00049837 ...  0.00204456  0.00078297
  0.00155575]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 7, 9]
layer1_inf_time: 4.33154296875
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 1.0662, Accuracy: 8697/10000 (86.9700%)
time spent on training: 50.30107545852661
Starting performing KrMLRFL...
[PAIRWISE] pred_attackers_indx:  [0 1 2 7]
layer2_inf_t: 535.466796875
assumed final_attacker_idxs:  [0 1 2 5 7 9]
final_attacker_idxs is: [0 1 2 5 7 9]
g_attacker_idxs: [ 3 95 85 34 81 82]
g_normal_idxs: [74 75 90  5]
filtered_attacker_idxs: [0, 1, 2, 5, 7, 9]
final_attacker_idxs are: [0, 1, 2, 5, 7, 9]
num_dps: [923, 602, 431, 557, 686, 413, 683, 1227, 434, 713]
epoch_acc: 98.71
Num data points: [923, 602, 431, 557, 686, 413, 683, 1227, 434, 713]
Num selected data points: [557 686 683 434]
The chosen ones are users: [3, 4, 6, 8], which are global users: [74, 75, 90, 5]
___Test Local_Simple poisoned: False, epoch: 292: Average loss: 0.0429, Accuracy: 9871/10000 (98.7100%)
___Test Local_Simple poisoned: True, epoch: 292: Average loss: 15.1609, Accuracy: 13/8968 (0.1450%)
Done in 68.41460013389587 sec.
Server Epoch:293 choose agents : [90, 45, 61, 58, 39, 53, 71, 92, 97, 19].
___Train Local_Simple,  epoch 293, local model 90, internal_epoch   1,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 293, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.0482, Accuracy: 9850/10000 (98.5000%)
poison local model 45 index 0
___Train Local_Simple,  epoch 293, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 293, local model 45, internal_epoch   2,  Average loss: 0.0007, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.1486, Accuracy: 9568/10000 (95.6800%)
poison local model 61 index 1
___Train Local_Simple,  epoch 293, local model 61, internal_epoch   1,  Average loss: 0.0012, Accuracy: 686/699 (98.1402%)
___Train Local_Simple,  epoch 293, local model 61, internal_epoch   2,  Average loss: 0.0012, Accuracy: 687/699 (98.2833%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.4187, Accuracy: 8758/10000 (87.5800%)
___Train Local_Simple,  epoch 293, local model 58, internal_epoch   1,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Train Local_Simple,  epoch 293, local model 58, internal_epoch   2,  Average loss: 0.0000, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.0425, Accuracy: 9860/10000 (98.6000%)
___Train Local_Simple,  epoch 293, local model 39, internal_epoch   1,  Average loss: 0.0003, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 293, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.0468, Accuracy: 9857/10000 (98.5700%)
___Train Local_Simple,  epoch 293, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 293, local model 53, internal_epoch   2,  Average loss: 0.0010, Accuracy: 727/739 (98.3762%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.1626, Accuracy: 9489/10000 (94.8900%)
poison local model 71 index 2
___Train Local_Simple,  epoch 293, local model 71, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1364/1384 (98.5549%)
___Train Local_Simple,  epoch 293, local model 71, internal_epoch   2,  Average loss: 0.0013, Accuracy: 1351/1384 (97.6156%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.7117, Accuracy: 8105/10000 (81.0500%)
___Train Local_Simple,  epoch 293, local model 92, internal_epoch   1,  Average loss: 0.0008, Accuracy: 922/937 (98.3991%)
___Train Local_Simple,  epoch 293, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 930/937 (99.2529%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.4512, Accuracy: 8904/10000 (89.0400%)
___Train Local_Simple,  epoch 293, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 293, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.0493, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 293, local model 19, internal_epoch   1,  Average loss: 0.0002, Accuracy: 204/205 (99.5122%)
___Train Local_Simple,  epoch 293, local model 19, internal_epoch   2,  Average loss: 0.0000, Accuracy: 205/205 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 61, 71]
base_p: [-0.00119507  0.0001669   0.00111968 ... -0.00116417 -0.00687202
 -0.00162504]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 6, 7]
layer1_inf_time: 2.804931640625
[PAIRWISE] pred_attackers_indx:  [1 2 5 6 7]
layer2_inf_t: 35.248046875
assumed final_attacker_idxs:  [1 2 5 6 7]
final_attacker_idxs is: [1 2 5 6 7]
g_attacker_idxs: [45 61 53 71 92]
g_normal_idxs: [90 58 39 97 19]
filtered_attacker_idxs: [1, 2, 5, 6, 7]
final_attacker_idxs are: [1, 2, 5, 6, 7]
num_dps: [683, 628, 699, 276, 257, 739, 1384, 937, 487, 205]
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.0808, Accuracy: 9747/10000 (97.4700%)
time spent on training: 73.40262746810913
Starting performing KrMLRFL...
Num data points: [683, 628, 699, 276, 257, 739, 1384, 937, 487, 205]
Num selected data points: [683 276 257 487 205]
The chosen ones are users: [0, 3, 4, 8, 9], which are global users: [90, 58, 39, 97, 19]
___Test Local_Simple poisoned: False, epoch: 293: Average loss: 0.0348, Accuracy: 9885/10000 (98.8500%)
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: True, epoch: 293: Average loss: 15.6421, Accuracy: 6/8968 (0.0669%)
Done in 81.31432938575745 sec.
Server Epoch:294 choose agents : [0, 82, 66, 97, 75, 1, 86, 49, 80, 10].
___Train Local_Simple,  epoch 294, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 432/435 (99.3103%)
___Train Local_Simple,  epoch 294, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.1002, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch 294, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch 294, local model 82, internal_epoch   2,  Average loss: 0.0004, Accuracy: 708/713 (99.2987%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.7657, Accuracy: 8643/10000 (86.4300%)
___Train Local_Simple,  epoch 294, local model 66, internal_epoch   1,  Average loss: 0.0007, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch 294, local model 66, internal_epoch   2,  Average loss: 0.0009, Accuracy: 655/660 (99.2424%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.1006, Accuracy: 9676/10000 (96.7600%)
___Train Local_Simple,  epoch 294, local model 97, internal_epoch   1,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 294, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.0381, Accuracy: 9877/10000 (98.7700%)
___Train Local_Simple,  epoch 294, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Train Local_Simple,  epoch 294, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.0465, Accuracy: 9860/10000 (98.6000%)
poison local model 1 index 0
___Train Local_Simple,  epoch 294, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 294, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.1812, Accuracy: 9469/10000 (94.6900%)
___Train Local_Simple,  epoch 294, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 294, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.1366, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch 294, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 294, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.0519, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 294, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 294, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.0562, Accuracy: 9839/10000 (98.3900%)
___Train Local_Simple,  epoch 294, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Train Local_Simple,  epoch 294, local model 10, internal_epoch   2,  Average loss: 0.0003, Accuracy: 888/892 (99.5516%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1]
base_p: [ 0.00027408  0.00010373 -0.00012464 ... -0.00145952 -0.00491539
 -0.00037982]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 5]
layer1_inf_time: 2.7568359375
[PAIRWISE] pred_attackers_indx:  [1 2 5]
layer2_inf_t: 34.672607421875
assumed final_attacker_idxs:  [0 1 2 4 5]
final_attacker_idxs is: [0 1 2 4 5]
g_attacker_idxs: [ 0 82 66 75  1]
g_normal_idxs: [97 86 49 80 10]
filtered_attacker_idxs: [1, 2, 5]
final_attacker_idxs are: [1, 2, 5]
num_dps: [435, 713, 660, 487, 686, 760, 250, 506, 431, 892]
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.0868, Accuracy: 9725/10000 (97.2500%)
time spent on training: 38.204476833343506
Starting performing KrMLRFL...
Num data points: [435, 713, 660, 487, 686, 760, 250, 506, 431, 892]
Num selected data points: [435 487 686 250 506 431 892]
The chosen ones are users: [0, 3, 4, 6, 7, 8, 9], which are global users: [0, 97, 75, 86, 49, 80, 10]
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: False, epoch: 294: Average loss: 0.0308, Accuracy: 9901/10000 (99.0100%)
___Test Local_Simple poisoned: True, epoch: 294: Average loss: 15.2606, Accuracy: 5/8968 (0.0558%)
Done in 45.07291841506958 sec.
Server Epoch:295 choose agents : [85, 20, 1, 26, 79, 87, 40, 42, 59, 61].
poison local model 85 index 0
___Train Local_Simple,  epoch 295, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 295, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.1135, Accuracy: 9635/10000 (96.3500%)
poison local model 20 index 1
___Train Local_Simple,  epoch 295, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 295, local model 20, internal_epoch   2,  Average loss: 0.0015, Accuracy: 417/429 (97.2028%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.1746, Accuracy: 9454/10000 (94.5400%)
poison local model 1 index 2
___Train Local_Simple,  epoch 295, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 295, local model 1, internal_epoch   2,  Average loss: 0.0017, Accuracy: 732/760 (96.3158%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.1889, Accuracy: 9327/10000 (93.2700%)
poison local model 26 index 3
___Train Local_Simple,  epoch 295, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 295, local model 26, internal_epoch   2,  Average loss: 0.0011, Accuracy: 543/554 (98.0144%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.2379, Accuracy: 9279/10000 (92.7900%)
___Train Local_Simple,  epoch 295, local model 79, internal_epoch   1,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 295, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.0329, Accuracy: 9899/10000 (98.9900%)
___Train Local_Simple,  epoch 295, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 295, local model 87, internal_epoch   2,  Average loss: 0.0000, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.0575, Accuracy: 9811/10000 (98.1100%)
___Train Local_Simple,  epoch 295, local model 40, internal_epoch   1,  Average loss: 0.0009, Accuracy: 762/772 (98.7047%)
___Train Local_Simple,  epoch 295, local model 40, internal_epoch   2,  Average loss: 0.0031, Accuracy: 729/772 (94.4301%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 1.0933, Accuracy: 6750/10000 (67.5000%)
poison local model 42 index 0
___Train Local_Simple,  epoch 295, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch 295, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.0489, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 295, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch 295, local model 59, internal_epoch   2,  Average loss: 0.0006, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.2139, Accuracy: 9354/10000 (93.5400%)
poison local model 61 index 1
___Train Local_Simple,  epoch 295, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 689/699 (98.5694%)
___Train Local_Simple,  epoch 295, local model 61, internal_epoch   2,  Average loss: 0.0003, Accuracy: 694/699 (99.2847%)
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.6113, Accuracy: 8768/10000 (87.6800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 20, 1, 26, 42, 61]
base_p: [-0.00058056 -0.0002473  -0.00058853 ...  0.0013271   0.00148258
  0.00209908]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 6, 8, 9]
layer1_inf_time: 2.836181640625
[PAIRWISE] pred_attackers_indx:  [1 6 8]
layer2_inf_t: 29.31640625
assumed final_attacker_idxs:  [1 2 3 6 8 9]
final_attacker_idxs is: [1 2 3 6 8 9]
g_attacker_idxs: [20  1 26 40 59 61]
g_normal_idxs: [85 79 87 42]
filtered_attacker_idxs: [1, 2, 3, 6, 8, 9]
final_attacker_idxs are: [1, 2, 3, 6, 8, 9]
num_dps: [431, 429, 760, 554, 182, 470, 772, 236, 760, 699]
time spent on training: 65.68451476097107
Starting performing KrMLRFL...
Num data points: [431, 429, 760, 554, 182, 470, 772, 236, 760, 699]
Num selected data points: [431 182 470 236]
The chosen ones are users: [0, 4, 5, 7], which are global users: [85, 79, 87, 42]
epoch_acc: 98.72999999999999
___Test Local_Simple poisoned: False, epoch: 295: Average loss: 0.0372, Accuracy: 9873/10000 (98.7300%)
___Test Local_Simple poisoned: True, epoch: 295: Average loss: 13.2472, Accuracy: 42/8968 (0.4683%)
Done in 73.6314389705658 sec.
Server Epoch:296 choose agents : [1, 71, 4, 27, 0, 51, 99, 35, 10, 29].
poison local model 1 index 0
___Train Local_Simple,  epoch 296, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 747/760 (98.2895%)
___Train Local_Simple,  epoch 296, local model 1, internal_epoch   2,  Average loss: 0.0005, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.5300, Accuracy: 8663/10000 (86.6300%)
poison local model 71 index 1
___Train Local_Simple,  epoch 296, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1371/1384 (99.0607%)
___Train Local_Simple,  epoch 296, local model 71, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1378/1384 (99.5665%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.2031, Accuracy: 9353/10000 (93.5300%)
___Train Local_Simple,  epoch 296, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 650/658 (98.7842%)
___Train Local_Simple,  epoch 296, local model 4, internal_epoch   2,  Average loss: 0.0014, Accuracy: 637/658 (96.8085%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.4395, Accuracy: 8572/10000 (85.7200%)
poison local model 27 index 2
___Train Local_Simple,  epoch 296, local model 27, internal_epoch   1,  Average loss: 0.0018, Accuracy: 452/471 (95.9660%)
___Train Local_Simple,  epoch 296, local model 27, internal_epoch   2,  Average loss: 0.0011, Accuracy: 461/471 (97.8769%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.4819, Accuracy: 8811/10000 (88.1100%)
___Train Local_Simple,  epoch 296, local model 0, internal_epoch   1,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Train Local_Simple,  epoch 296, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.0521, Accuracy: 9840/10000 (98.4000%)
poison local model 51 index 3
___Train Local_Simple,  epoch 296, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 296, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.1111, Accuracy: 9673/10000 (96.7300%)
___Train Local_Simple,  epoch 296, local model 99, internal_epoch   1,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Train Local_Simple,  epoch 296, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.0389, Accuracy: 9870/10000 (98.7000%)
___Train Local_Simple,  epoch 296, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 296, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.1023, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch 296, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Train Local_Simple,  epoch 296, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.1249, Accuracy: 9638/10000 (96.3800%)
___Train Local_Simple,  epoch 296, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 997/1002 (99.5010%)
___Train Local_Simple,  epoch 296, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 998/1002 (99.6008%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 71, 27, 51]
base_p: [0.00018803 0.00012601 0.00030635 ... 0.00338967 0.00012408 0.0010188 ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 5]
layer1_inf_time: 4.80126953125
[PAIRWISE] pred_attackers_indx:  [0 1 3]
layer2_inf_t: 41.45947265625
assumed final_attacker_idxs:  [0 1 2 3 5]
final_attacker_idxs is: [0 1 2 3 5]
g_attacker_idxs: [ 1 71  4 27 51]
g_normal_idxs: [ 0 99 35 10 29]
filtered_attacker_idxs: [0, 1, 2, 3, 5]
final_attacker_idxs are: [0, 1, 2, 3, 5]
num_dps: [760, 1384, 658, 471, 435, 568, 377, 499, 892, 1002]
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.0801, Accuracy: 9745/10000 (97.4500%)
time spent on training: 51.85086393356323
Starting performing KrMLRFL...
Num data points: [760, 1384, 658, 471, 435, 568, 377, 499, 892, 1002]
Num selected data points: [ 435  377  499  892 1002]
The chosen ones are users: [4, 6, 7, 8, 9], which are global users: [0, 99, 35, 10, 29]
epoch_acc: 98.69
___Test Local_Simple poisoned: False, epoch: 296: Average loss: 0.0419, Accuracy: 9869/10000 (98.6900%)
___Test Local_Simple poisoned: True, epoch: 296: Average loss: 14.3458, Accuracy: 36/8968 (0.4014%)
Done in 56.72871541976929 sec.
Server Epoch:297 choose agents : [29, 46, 64, 20, 17, 56, 21, 60, 97, 18].
___Train Local_Simple,  epoch 297, local model 29, internal_epoch   1,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 297, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.0485, Accuracy: 9850/10000 (98.5000%)
___Train Local_Simple,  epoch 297, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 700/710 (98.5915%)
___Train Local_Simple,  epoch 297, local model 46, internal_epoch   2,  Average loss: 0.0008, Accuracy: 700/710 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.2933, Accuracy: 9022/10000 (90.2200%)
___Train Local_Simple,  epoch 297, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Train Local_Simple,  epoch 297, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.1438, Accuracy: 9574/10000 (95.7400%)
poison local model 20 index 0
___Train Local_Simple,  epoch 297, local model 20, internal_epoch   1,  Average loss: 0.0010, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 297, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.3482, Accuracy: 9123/10000 (91.2300%)
poison local model 17 index 1
___Train Local_Simple,  epoch 297, local model 17, internal_epoch   1,  Average loss: 0.0017, Accuracy: 604/620 (97.4194%)
___Train Local_Simple,  epoch 297, local model 17, internal_epoch   2,  Average loss: 0.0011, Accuracy: 604/620 (97.4194%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.5683, Accuracy: 8083/10000 (80.8300%)
___Train Local_Simple,  epoch 297, local model 56, internal_epoch   1,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 297, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.0429, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch 297, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch 297, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.0724, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 297, local model 60, internal_epoch   1,  Average loss: 0.0003, Accuracy: 336/338 (99.4083%)
___Train Local_Simple,  epoch 297, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 337/338 (99.7041%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.0832, Accuracy: 9759/10000 (97.5900%)
___Train Local_Simple,  epoch 297, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 297, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.0994, Accuracy: 9704/10000 (97.0400%)
___Train Local_Simple,  epoch 297, local model 18, internal_epoch   1,  Average loss: 0.0017, Accuracy: 455/459 (99.1285%)
___Train Local_Simple,  epoch 297, local model 18, internal_epoch   2,  Average loss: 0.0020, Accuracy: 439/459 (95.6427%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 17]
base_p: [-1.2741983e-04  2.0578504e-04  3.8836244e-04 ... -8.2863867e-04
  1.8371418e-03 -9.6544623e-05]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 4]
layer1_inf_time: 3.53076171875
[PAIRWISE] pred_attackers_indx:  [3 4]
layer2_inf_t: 28.45166015625
assumed final_attacker_idxs:  [0 1 2 3 4]
final_attacker_idxs is: [0 1 2 3 4]
g_attacker_idxs: [29 46 64 20 17]
g_normal_idxs: [56 21 60 97 18]
filtered_attacker_idxs: [0, 1, 3, 4]
final_attacker_idxs are: [0, 1, 3, 4]
num_dps: [1002, 710, 813, 429, 620, 880, 312, 338, 487, 459]
epoch_acc: 98.83
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.4028, Accuracy: 8884/10000 (88.8400%)
time spent on training: 52.65968179702759
Starting performing KrMLRFL...
Num data points: [1002, 710, 813, 429, 620, 880, 312, 338, 487, 459]
Num selected data points: [813 880 312 338 487 459]
The chosen ones are users: [2, 5, 6, 7, 8, 9], which are global users: [64, 56, 21, 60, 97, 18]
___Test Local_Simple poisoned: False, epoch: 297: Average loss: 0.0351, Accuracy: 9883/10000 (98.8300%)
___Test Local_Simple poisoned: True, epoch: 297: Average loss: 14.5466, Accuracy: 20/8968 (0.2230%)
Done in 60.593517541885376 sec.
Server Epoch:298 choose agents : [25, 52, 47, 13, 60, 95, 94, 78, 1, 89].
___Train Local_Simple,  epoch 298, local model 25, internal_epoch   1,  Average loss: 0.0009, Accuracy: 643/647 (99.3818%)
___Train Local_Simple,  epoch 298, local model 25, internal_epoch   2,  Average loss: 0.0073, Accuracy: 577/647 (89.1808%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.7950, Accuracy: 7804/10000 (78.0400%)
poison local model 52 index 0
___Train Local_Simple,  epoch 298, local model 52, internal_epoch   1,  Average loss: 0.0010, Accuracy: 247/253 (97.6285%)
___Train Local_Simple,  epoch 298, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.1530, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch 298, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 769/776 (99.0979%)
___Train Local_Simple,  epoch 298, local model 47, internal_epoch   2,  Average loss: 0.0007, Accuracy: 767/776 (98.8402%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.1031, Accuracy: 9693/10000 (96.9300%)
poison local model 13 index 1
___Train Local_Simple,  epoch 298, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 723/734 (98.5014%)
___Train Local_Simple,  epoch 298, local model 13, internal_epoch   2,  Average loss: 0.0009, Accuracy: 724/734 (98.6376%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.1201, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch 298, local model 60, internal_epoch   1,  Average loss: 0.0002, Accuracy: 336/338 (99.4083%)
___Train Local_Simple,  epoch 298, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.0664, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch 298, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 597/602 (99.1694%)
___Train Local_Simple,  epoch 298, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.9336, Accuracy: 7872/10000 (78.7200%)
___Train Local_Simple,  epoch 298, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 298, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.3080, Accuracy: 9082/10000 (90.8200%)
___Train Local_Simple,  epoch 298, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch 298, local model 78, internal_epoch   2,  Average loss: 0.0004, Accuracy: 301/303 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.0972, Accuracy: 9681/10000 (96.8100%)
poison local model 1 index 2
___Train Local_Simple,  epoch 298, local model 1, internal_epoch   1,  Average loss: 0.0009, Accuracy: 742/760 (97.6316%)
___Train Local_Simple,  epoch 298, local model 1, internal_epoch   2,  Average loss: 0.0011, Accuracy: 741/760 (97.5000%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.5844, Accuracy: 8596/10000 (85.9600%)
___Train Local_Simple,  epoch 298, local model 89, internal_epoch   1,  Average loss: 0.0003, Accuracy: 490/492 (99.5935%)
___Train Local_Simple,  epoch 298, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.1487, Accuracy: 9555/10000 (95.5500%)
time spent on training: 51.26133632659912
Starting performing KrMLRFL...
Num data points: [647, 253, 776, 734, 338, 602, 150, 303, 760, 492]
Num selected data points: [338 150 303 492]
The chosen ones are users: [4, 6, 7, 9], which are global users: [60, 94, 78, 89]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 13, 1]
base_p: [-0.00045801  0.00023505 -0.00051575 ... -0.0014842  -0.00074207
  0.00750009]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 8]
layer1_inf_time: 4.87158203125
[PAIRWISE] pred_attackers_indx:  [1 2 3 7 8]
layer2_inf_t: 107.62451171875
assumed final_attacker_idxs:  [0 1 2 3 5 7 8]
final_attacker_idxs is: [0 1 2 3 5 7 8]
g_attacker_idxs: [25 52 47 13 95 78  1]
g_normal_idxs: [60 94 89]
filtered_attacker_idxs: [0, 1, 2, 3, 5, 8]
final_attacker_idxs are: [0, 1, 2, 3, 5, 8]
num_dps: [647, 253, 776, 734, 338, 602, 150, 303, 760, 492]
___Test Local_Simple poisoned: False, epoch: 298: Average loss: 0.0444, Accuracy: 9851/10000 (98.5100%)
epoch_acc: 98.50999999999999
___Test Local_Simple poisoned: True, epoch: 298: Average loss: 13.8810, Accuracy: 18/8968 (0.2007%)
Done in 58.10885000228882 sec.
Server Epoch:299 choose agents : [91, 8, 77, 86, 31, 3, 59, 79, 15, 4].
poison local model 91 index 0
___Train Local_Simple,  epoch 299, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Train Local_Simple,  epoch 299, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0475, Accuracy: 9856/10000 (98.5600%)
___Train Local_Simple,  epoch 299, local model 8, internal_epoch   1,  Average loss: 0.0002, Accuracy: 630/633 (99.5261%)
___Train Local_Simple,  epoch 299, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 631/633 (99.6840%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0669, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 299, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 581/589 (98.6418%)
___Train Local_Simple,  epoch 299, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 583/589 (98.9813%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0515, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 299, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 299, local model 86, internal_epoch   2,  Average loss: 0.0004, Accuracy: 248/250 (99.2000%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0852, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch 299, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Train Local_Simple,  epoch 299, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0502, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 299, local model 3, internal_epoch   1,  Average loss: 0.0007, Accuracy: 910/923 (98.5915%)
___Train Local_Simple,  epoch 299, local model 3, internal_epoch   2,  Average loss: 0.0006, Accuracy: 910/923 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.4715, Accuracy: 8786/10000 (87.8600%)
___Train Local_Simple,  epoch 299, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 299, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.2313, Accuracy: 9296/10000 (92.9600%)
___Train Local_Simple,  epoch 299, local model 79, internal_epoch   1,  Average loss: 0.0005, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch 299, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0537, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch 299, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 299, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0504, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 299, local model 4, internal_epoch   1,  Average loss: 0.0020, Accuracy: 641/658 (97.4164%)
___Train Local_Simple,  epoch 299, local model 4, internal_epoch   2,  Average loss: 0.0016, Accuracy: 641/658 (97.4164%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91]
base_p: [-2.6990473e-04  9.5954165e-05 -1.9034855e-03 ...  2.3058057e-03
 -3.0106083e-03  2.6085973e-04]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 8, 9]
layer1_inf_time: 4.359375
[PAIRWISE] pred_attackers_indx:  [5 9]
layer2_inf_t: 65.061767578125
assumed final_attacker_idxs:  [2 5 6 8 9]
final_attacker_idxs is: [2 5 6 8 9]
g_attacker_idxs: [77  3 59 15  4]
g_normal_idxs: [91  8 86 31 79]
filtered_attacker_idxs: [2, 5, 6, 9]
final_attacker_idxs are: [2, 5, 6, 9]
num_dps: [256, 633, 589, 250, 835, 923, 760, 182, 401, 658]
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.4165, Accuracy: 8694/10000 (86.9400%)
time spent on training: 57.95027709007263
Starting performing KrMLRFL...
Num data points: [256, 633, 589, 250, 835, 923, 760, 182, 401, 658]
Num selected data points: [256 633 250 835 182 401]
The chosen ones are users: [0, 1, 3, 4, 7, 8], which are global users: [91, 8, 86, 31, 79, 15]
epoch_acc: 99.0
___Test Local_Simple poisoned: False, epoch: 299: Average loss: 0.0321, Accuracy: 9900/10000 (99.0000%)
___Test Local_Simple poisoned: True, epoch: 299: Average loss: 14.2406, Accuracy: 16/8968 (0.1784%)
Done in 63.37969493865967 sec.
Server Epoch:300 choose agents : [57, 6, 53, 34, 44, 78, 91, 86, 58, 84].
___Train Local_Simple,  epoch 300, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 339/343 (98.8338%)
___Train Local_Simple,  epoch 300, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 340/343 (99.1254%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.1989, Accuracy: 9281/10000 (92.8100%)
___Train Local_Simple,  epoch 300, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 613/615 (99.6748%)
___Train Local_Simple,  epoch 300, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.0446, Accuracy: 9851/10000 (98.5100%)
___Train Local_Simple,  epoch 300, local model 53, internal_epoch   1,  Average loss: 0.0004, Accuracy: 734/739 (99.3234%)
___Train Local_Simple,  epoch 300, local model 53, internal_epoch   2,  Average loss: 0.0007, Accuracy: 731/739 (98.9175%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.3430, Accuracy: 9060/10000 (90.6000%)
poison local model 34 index 0
___Train Local_Simple,  epoch 300, local model 34, internal_epoch   1,  Average loss: 0.0003, Accuracy: 410/413 (99.2736%)
___Train Local_Simple,  epoch 300, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.2770, Accuracy: 9219/10000 (92.1900%)
___Train Local_Simple,  epoch 300, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 513/517 (99.2263%)
___Train Local_Simple,  epoch 300, local model 44, internal_epoch   2,  Average loss: 0.0001, Accuracy: 517/517 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.0747, Accuracy: 9769/10000 (97.6900%)
___Train Local_Simple,  epoch 300, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 300, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.0815, Accuracy: 9750/10000 (97.5000%)
poison local model 91 index 1
___Train Local_Simple,  epoch 300, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 300, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.0408, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 300, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Train Local_Simple,  epoch 300, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.0463, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 300, local model 58, internal_epoch   1,  Average loss: 0.0002, Accuracy: 276/276 (100.0000%)
___Train Local_Simple,  epoch 300, local model 58, internal_epoch   2,  Average loss: 0.0000, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.0588, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 300, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1224/1246 (98.2343%)
___Train Local_Simple,  epoch 300, local model 84, internal_epoch   2,  Average loss: 0.0009, Accuracy: 1225/1246 (98.3146%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 91]
base_p: [-0.00046051 -0.00015865 -0.00052443 ... -0.00019689  0.00205002
  0.00180302]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 9]
layer1_inf_time: 5.145263671875
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.1053, Accuracy: 9682/10000 (96.8200%)
time spent on training: 49.385610818862915
Starting performing KrMLRFL...
[PAIRWISE] pred_attackers_indx:  [2 3 9]
layer2_inf_t: 1036.76611328125
assumed final_attacker_idxs:  [0 2 3 4 9]
final_attacker_idxs is: [0 2 3 4 9]
g_attacker_idxs: [57 53 34 44 84]
g_normal_idxs: [ 6 78 91 86 58]
filtered_attacker_idxs: [2, 3, 9]
final_attacker_idxs are: [2, 3, 9]
num_dps: [343, 615, 739, 413, 517, 303, 256, 250, 276, 1246]
epoch_acc: 99.02
Num data points: [343, 615, 739, 413, 517, 303, 256, 250, 276, 1246]
Num selected data points: [343 615 517 303 256 250 276]
The chosen ones are users: [0, 1, 4, 5, 6, 7, 8], which are global users: [57, 6, 44, 78, 91, 86, 58]
___Test Local_Simple poisoned: False, epoch: 300: Average loss: 0.0302, Accuracy: 9902/10000 (99.0200%)
___Test Local_Simple poisoned: True, epoch: 300: Average loss: 13.6924, Accuracy: 17/8968 (0.1896%)
Done in 90.11137223243713 sec.
Server Epoch:301 choose agents : [78, 98, 15, 20, 24, 80, 44, 39, 69, 27].
___Train Local_Simple,  epoch 301, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 301, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.0417, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch 301, local model 98, internal_epoch   1,  Average loss: 0.0006, Accuracy: 802/818 (98.0440%)
___Train Local_Simple,  epoch 301, local model 98, internal_epoch   2,  Average loss: 0.0004, Accuracy: 813/818 (99.3888%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.2738, Accuracy: 9178/10000 (91.7800%)
___Train Local_Simple,  epoch 301, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 301, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.0453, Accuracy: 9850/10000 (98.5000%)
poison local model 20 index 0
___Train Local_Simple,  epoch 301, local model 20, internal_epoch   1,  Average loss: 0.0014, Accuracy: 416/429 (96.9697%)
___Train Local_Simple,  epoch 301, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 425/429 (99.0676%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.4448, Accuracy: 8919/10000 (89.1900%)
___Train Local_Simple,  epoch 301, local model 24, internal_epoch   1,  Average loss: 0.0002, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 301, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.0483, Accuracy: 9848/10000 (98.4800%)
___Train Local_Simple,  epoch 301, local model 80, internal_epoch   1,  Average loss: 0.0001, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 301, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.0644, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch 301, local model 44, internal_epoch   1,  Average loss: 0.0001, Accuracy: 517/517 (100.0000%)
___Train Local_Simple,  epoch 301, local model 44, internal_epoch   2,  Average loss: 0.0000, Accuracy: 517/517 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.0420, Accuracy: 9863/10000 (98.6300%)
___Train Local_Simple,  epoch 301, local model 39, internal_epoch   1,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Train Local_Simple,  epoch 301, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.0380, Accuracy: 9878/10000 (98.7800%)
___Train Local_Simple,  epoch 301, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 252/256 (98.4375%)
___Train Local_Simple,  epoch 301, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.1036, Accuracy: 9649/10000 (96.4900%)
poison local model 27 index 1
___Train Local_Simple,  epoch 301, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 301, local model 27, internal_epoch   2,  Average loss: 0.0010, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.7270, Accuracy: 8832/10000 (88.3200%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 27]
base_p: [ 1.0326877e-04  1.6322359e-05 -4.4620596e-05 ... -1.9787699e-03
 -2.2844225e-03 -1.3451129e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 6, 9]
layer1_inf_time: 4.4892578125
[PAIRWISE] pred_attackers_indx:  [3]
layer2_inf_t: 42.600341796875
assumed final_attacker_idxs:  [1 2 3 6 9]
final_attacker_idxs is: [1 2 3 6 9]
g_attacker_idxs: [98 15 20 44 27]
g_normal_idxs: [78 24 80 39 69]
filtered_attacker_idxs: [1, 3, 9]
final_attacker_idxs are: [1, 3, 9]
num_dps: [303, 818, 401, 429, 379, 431, 517, 257, 256, 471]
time spent on training: 47.172144412994385
Starting performing KrMLRFL...
Num data points: [303, 818, 401, 429, 379, 431, 517, 257, 256, 471]
Num selected data points: [303 401 379 431 517 257 256]
The chosen ones are users: [0, 2, 4, 5, 6, 7, 8], which are global users: [78, 15, 24, 80, 44, 39, 69]
epoch_acc: 99.03999999999999
___Test Local_Simple poisoned: False, epoch: 301: Average loss: 0.0291, Accuracy: 9904/10000 (99.0400%)
___Test Local_Simple poisoned: True, epoch: 301: Average loss: 15.0452, Accuracy: 5/8968 (0.0558%)
Done in 56.047563552856445 sec.
Server Epoch:302 choose agents : [7, 58, 41, 82, 27, 63, 71, 48, 18, 3].
poison local model 7 index 0
___Train Local_Simple,  epoch 302, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 415/418 (99.2823%)
___Train Local_Simple,  epoch 302, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.2862, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch 302, local model 58, internal_epoch   1,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Train Local_Simple,  epoch 302, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.0412, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch 302, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%)
___Train Local_Simple,  epoch 302, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 600/606 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.1922, Accuracy: 9432/10000 (94.3200%)
___Train Local_Simple,  epoch 302, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch 302, local model 82, internal_epoch   2,  Average loss: 0.0003, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 1.0338, Accuracy: 8659/10000 (86.5900%)
poison local model 27 index 1
___Train Local_Simple,  epoch 302, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 302, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 469/471 (99.5754%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.4507, Accuracy: 9239/10000 (92.3900%)
poison local model 63 index 2
___Train Local_Simple,  epoch 302, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 870/889 (97.8628%)
___Train Local_Simple,  epoch 302, local model 63, internal_epoch   2,  Average loss: 0.0010, Accuracy: 875/889 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.0983, Accuracy: 9667/10000 (96.6700%)
poison local model 71 index 3
___Train Local_Simple,  epoch 302, local model 71, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1375/1384 (99.3497%)
___Train Local_Simple,  epoch 302, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1376/1384 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.1496, Accuracy: 9558/10000 (95.5800%)
___Train Local_Simple,  epoch 302, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch 302, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.0515, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 302, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 302, local model 18, internal_epoch   2,  Average loss: 0.0000, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.0863, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch 302, local model 3, internal_epoch   1,  Average loss: 0.0008, Accuracy: 907/923 (98.2665%)
___Train Local_Simple,  epoch 302, local model 3, internal_epoch   2,  Average loss: 0.0009, Accuracy: 904/923 (97.9415%)
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.1374, Accuracy: 9543/10000 (95.4300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 27, 63, 71]
base_p: [ 2.4233758e-04 -1.2131408e-05 -5.8196485e-05 ... -1.4351606e-03
 -1.8832535e-03  3.9171353e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 5, 6, 9]
layer1_inf_time: 3.521484375
[PAIRWISE] pred_attackers_indx:  [0 3 4 6 9]
layer2_inf_t: 87.669921875
assumed final_attacker_idxs:  [0 3 4 5 6 9]
final_attacker_idxs is: [0 3 4 5 6 9]
g_attacker_idxs: [ 7 82 27 63 71  3]
g_normal_idxs: [58 41 48 18]
filtered_attacker_idxs: [0, 3, 4, 5, 6, 9]
final_attacker_idxs are: [0, 3, 4, 5, 6, 9]
num_dps: [418, 276, 606, 713, 471, 889, 1384, 448, 459, 923]
time spent on training: 74.28990530967712
Starting performing KrMLRFL...
Num data points: [418, 276, 606, 713, 471, 889, 1384, 448, 459, 923]
Num selected data points: [276 606 448 459]
The chosen ones are users: [1, 2, 7, 8], which are global users: [58, 41, 48, 18]
___Test Local_Simple poisoned: False, epoch: 302: Average loss: 0.0407, Accuracy: 9864/10000 (98.6400%)
epoch_acc: 98.64
___Test Local_Simple poisoned: True, epoch: 302: Average loss: 13.0587, Accuracy: 32/8968 (0.3568%)
Done in 101.19226121902466 sec.
Server Epoch:303 choose agents : [60, 50, 4, 7, 44, 53, 17, 11, 38, 3].
___Train Local_Simple,  epoch 303, local model 60, internal_epoch   1,  Average loss: 0.0004, Accuracy: 337/338 (99.7041%)
___Train Local_Simple,  epoch 303, local model 60, internal_epoch   2,  Average loss: 0.0004, Accuracy: 334/338 (98.8166%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.0560, Accuracy: 9833/10000 (98.3300%)
___Train Local_Simple,  epoch 303, local model 50, internal_epoch   1,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%)
___Train Local_Simple,  epoch 303, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.2204, Accuracy: 9399/10000 (93.9900%)
___Train Local_Simple,  epoch 303, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 647/658 (98.3283%)
___Train Local_Simple,  epoch 303, local model 4, internal_epoch   2,  Average loss: 0.0008, Accuracy: 650/658 (98.7842%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 2.3489, Accuracy: 7460/10000 (74.6000%)
poison local model 7 index 0
___Train Local_Simple,  epoch 303, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 414/418 (99.0431%)
___Train Local_Simple,  epoch 303, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.1669, Accuracy: 9494/10000 (94.9400%)
___Train Local_Simple,  epoch 303, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%)
___Train Local_Simple,  epoch 303, local model 44, internal_epoch   2,  Average loss: 0.0001, Accuracy: 516/517 (99.8066%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.0787, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch 303, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 303, local model 53, internal_epoch   2,  Average loss: 0.0008, Accuracy: 730/739 (98.7821%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.3247, Accuracy: 9002/10000 (90.0200%)
poison local model 17 index 1
___Train Local_Simple,  epoch 303, local model 17, internal_epoch   1,  Average loss: 0.0016, Accuracy: 604/620 (97.4194%)
___Train Local_Simple,  epoch 303, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 613/620 (98.8710%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.1837, Accuracy: 9448/10000 (94.4800%)
poison local model 11 index 2
___Train Local_Simple,  epoch 303, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 632/645 (97.9845%)
___Train Local_Simple,  epoch 303, local model 11, internal_epoch   2,  Average loss: 0.0016, Accuracy: 623/645 (96.5891%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.3264, Accuracy: 8954/10000 (89.5400%)
___Train Local_Simple,  epoch 303, local model 38, internal_epoch   1,  Average loss: 0.0003, Accuracy: 891/895 (99.5531%)
___Train Local_Simple,  epoch 303, local model 38, internal_epoch   2,  Average loss: 0.0005, Accuracy: 884/895 (98.7709%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.5094, Accuracy: 8691/10000 (86.9100%)
___Train Local_Simple,  epoch 303, local model 3, internal_epoch   1,  Average loss: 0.0006, Accuracy: 909/923 (98.4832%)
___Train Local_Simple,  epoch 303, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 914/923 (99.0249%)
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.1844, Accuracy: 9383/10000 (93.8300%)
time spent on training: 78.12794780731201
Starting performing KrMLRFL...
Num data points: [338, 474, 658, 418, 517, 739, 620, 645, 895, 923]
Num selected data points: [338 474 517 895]
The chosen ones are users: [0, 1, 4, 8], which are global users: [60, 50, 44, 38]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 17, 11]
base_p: [ 0.00029841 -0.00018993 -0.00132622 ...  0.00102378 -0.00120546
  0.00332198]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 6, 7, 9]
layer1_inf_time: 3.747802734375
[PAIRWISE] pred_attackers_indx:  [3 6 7 9]
layer2_inf_t: 33.048583984375
assumed final_attacker_idxs:  [2 3 5 6 7 9]
final_attacker_idxs is: [2 3 5 6 7 9]
g_attacker_idxs: [ 4  7 53 17 11  3]
g_normal_idxs: [60 50 44 38]
filtered_attacker_idxs: [2, 3, 5, 6, 7, 9]
final_attacker_idxs are: [2, 3, 5, 6, 7, 9]
num_dps: [338, 474, 658, 418, 517, 739, 620, 645, 895, 923]
epoch_acc: 97.63
___Test Local_Simple poisoned: False, epoch: 303: Average loss: 0.0682, Accuracy: 9763/10000 (97.6300%)
___Test Local_Simple poisoned: True, epoch: 303: Average loss: 15.5344, Accuracy: 0/8968 (0.0000%)
Done in 86.33807420730591 sec.
Server Epoch:304 choose agents : [13, 80, 26, 2, 43, 63, 79, 40, 7, 45].
poison local model 13 index 0
___Train Local_Simple,  epoch 304, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 727/734 (99.0463%)
___Train Local_Simple,  epoch 304, local model 13, internal_epoch   2,  Average loss: 0.0009, Accuracy: 721/734 (98.2289%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.1839, Accuracy: 9455/10000 (94.5500%)
___Train Local_Simple,  epoch 304, local model 80, internal_epoch   1,  Average loss: 0.0003, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 304, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.0635, Accuracy: 9800/10000 (98.0000%)
poison local model 26 index 1
___Train Local_Simple,  epoch 304, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 547/554 (98.7365%)
___Train Local_Simple,  epoch 304, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.1224, Accuracy: 9620/10000 (96.2000%)
poison local model 2 index 2
___Train Local_Simple,  epoch 304, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 540/548 (98.5401%)
___Train Local_Simple,  epoch 304, local model 2, internal_epoch   2,  Average loss: 0.0012, Accuracy: 535/548 (97.6277%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.2190, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch 304, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 404/408 (99.0196%)
___Train Local_Simple,  epoch 304, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.0879, Accuracy: 9711/10000 (97.1100%)
poison local model 63 index 3
___Train Local_Simple,  epoch 304, local model 63, internal_epoch   1,  Average loss: 0.0013, Accuracy: 867/889 (97.5253%)
___Train Local_Simple,  epoch 304, local model 63, internal_epoch   2,  Average loss: 0.0009, Accuracy: 875/889 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.0986, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch 304, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch 304, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.0665, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch 304, local model 40, internal_epoch   1,  Average loss: 0.0024, Accuracy: 752/772 (97.4093%)
___Train Local_Simple,  epoch 304, local model 40, internal_epoch   2,  Average loss: 0.0056, Accuracy: 698/772 (90.4145%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.5175, Accuracy: 8500/10000 (85.0000%)
poison local model 7 index 0
___Train Local_Simple,  epoch 304, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 411/418 (98.3254%)
___Train Local_Simple,  epoch 304, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 415/418 (99.2823%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.2390, Accuracy: 9295/10000 (92.9500%)
poison local model 45 index 1
___Train Local_Simple,  epoch 304, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 618/628 (98.4076%)
___Train Local_Simple,  epoch 304, local model 45, internal_epoch   2,  Average loss: 0.0007, Accuracy: 617/628 (98.2484%)
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.2243, Accuracy: 9313/10000 (93.1300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 26, 2, 63, 7, 45]
base_p: [ 1.3815463e-03 -5.9423968e-05  3.4882966e-04 ...  1.0728836e-04
 -2.5202334e-04 -5.4488331e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 7, 8, 9]
layer1_inf_time: 3.671630859375
[PAIRWISE] pred_attackers_indx:  [0 3 5 7]
layer2_inf_t: 37.9208984375
assumed final_attacker_idxs:  [0 2 3 5 7 8 9]
final_attacker_idxs is: [0 2 3 5 7 8 9]
g_attacker_idxs: [13 26  2 63 40  7 45]
g_normal_idxs: [80 43 79]
filtered_attacker_idxs: [0, 2, 3, 5, 7, 8, 9]
final_attacker_idxs are: [0, 2, 3, 5, 7, 8, 9]
num_dps: [734, 431, 554, 548, 408, 889, 182, 772, 418, 628]
time spent on training: 109.4626305103302
Starting performing KrMLRFL...
Num data points: [734, 431, 554, 548, 408, 889, 182, 772, 418, 628]
Num selected data points: [431 408 182]
The chosen ones are users: [1, 4, 6], which are global users: [80, 43, 79]
epoch_acc: 98.57000000000001
___Test Local_Simple poisoned: False, epoch: 304: Average loss: 0.0468, Accuracy: 9857/10000 (98.5700%)
___Test Local_Simple poisoned: True, epoch: 304: Average loss: 14.6223, Accuracy: 3/8968 (0.0335%)
Done in 135.2275161743164 sec.
Server Epoch:305 choose agents : [63, 0, 4, 83, 33, 21, 41, 38, 55, 26].
poison local model 63 index 0
___Train Local_Simple,  epoch 305, local model 63, internal_epoch   1,  Average loss: 0.0018, Accuracy: 859/889 (96.6254%)
___Train Local_Simple,  epoch 305, local model 63, internal_epoch   2,  Average loss: 0.0011, Accuracy: 868/889 (97.6378%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.1067, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch 305, local model 0, internal_epoch   1,  Average loss: 0.0006, Accuracy: 427/435 (98.1609%)
___Train Local_Simple,  epoch 305, local model 0, internal_epoch   2,  Average loss: 0.0008, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.0746, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch 305, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 642/658 (97.5684%)
___Train Local_Simple,  epoch 305, local model 4, internal_epoch   2,  Average loss: 0.0012, Accuracy: 645/658 (98.0243%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.7222, Accuracy: 8051/10000 (80.5100%)
___Train Local_Simple,  epoch 305, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 427/433 (98.6143%)
___Train Local_Simple,  epoch 305, local model 83, internal_epoch   2,  Average loss: 0.0005, Accuracy: 431/433 (99.5381%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.0437, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch 305, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 305, local model 33, internal_epoch   2,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.0772, Accuracy: 9747/10000 (97.4700%)
___Train Local_Simple,  epoch 305, local model 21, internal_epoch   1,  Average loss: 0.0007, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch 305, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.1485, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch 305, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%)
___Train Local_Simple,  epoch 305, local model 41, internal_epoch   2,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.1426, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch 305, local model 38, internal_epoch   1,  Average loss: 0.0003, Accuracy: 889/895 (99.3296%)
___Train Local_Simple,  epoch 305, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 892/895 (99.6648%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.2046, Accuracy: 9389/10000 (93.8900%)
___Train Local_Simple,  epoch 305, local model 55, internal_epoch   1,  Average loss: 0.0006, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch 305, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 352/354 (99.4350%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.4366, Accuracy: 8839/10000 (88.3900%)
poison local model 26 index 1
___Train Local_Simple,  epoch 305, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 548/554 (98.9170%)
___Train Local_Simple,  epoch 305, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.1731, Accuracy: 9521/10000 (95.2100%)
time spent on training: 51.49280786514282
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 26]
base_p: [ 1.8709898e-03 -1.1874363e-05 -2.9402412e-04 ...  1.1733621e-03
  3.0298382e-03  1.6938373e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 6, 7, 9]
layer1_inf_time: 4.2587890625
[PAIRWISE] pred_attackers_indx:  [0 2 5 7 8]
layer2_inf_t: 57.82373046875
assumed final_attacker_idxs:  [0 2 5 6 7 8 9]
final_attacker_idxs is: [0 2 5 6 7 8 9]
g_attacker_idxs: [63  4 21 41 38 55 26]
g_normal_idxs: [ 0 83 33]
filtered_attacker_idxs: [0, 2, 6, 9]
final_attacker_idxs are: [0, 2, 6, 9]
num_dps: [889, 435, 658, 433, 623, 312, 606, 895, 354, 554]
Starting performing KrMLRFL...
Num data points: [889, 435, 658, 433, 623, 312, 606, 895, 354, 554]
Num selected data points: [435 433 623 312 895 354]
The chosen ones are users: [1, 3, 4, 5, 7, 8], which are global users: [0, 83, 33, 21, 38, 55]
___Test Local_Simple poisoned: False, epoch: 305: Average loss: 0.0462, Accuracy: 9850/10000 (98.5000%)
epoch_acc: 98.5
___Test Local_Simple poisoned: True, epoch: 305: Average loss: 15.1677, Accuracy: 4/8968 (0.0446%)
Done in 68.66314768791199 sec.
Server Epoch:306 choose agents : [97, 47, 89, 22, 36, 85, 54, 55, 15, 10].
___Train Local_Simple,  epoch 306, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 306, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.1192, Accuracy: 9629/10000 (96.2900%)
___Train Local_Simple,  epoch 306, local model 47, internal_epoch   1,  Average loss: 0.0004, Accuracy: 770/776 (99.2268%)
___Train Local_Simple,  epoch 306, local model 47, internal_epoch   2,  Average loss: 0.0001, Accuracy: 775/776 (99.8711%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.0620, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch 306, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 490/492 (99.5935%)
___Train Local_Simple,  epoch 306, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.1507, Accuracy: 9542/10000 (95.4200%)
poison local model 22 index 0
___Train Local_Simple,  epoch 306, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch 306, local model 22, internal_epoch   2,  Average loss: 0.0003, Accuracy: 580/583 (99.4854%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.1391, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch 306, local model 36, internal_epoch   1,  Average loss: 0.0005, Accuracy: 991/1005 (98.6070%)
___Train Local_Simple,  epoch 306, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 992/1005 (98.7065%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.1592, Accuracy: 9503/10000 (95.0300%)
poison local model 85 index 1
___Train Local_Simple,  epoch 306, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 306, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.0606, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 306, local model 54, internal_epoch   1,  Average loss: 0.0004, Accuracy: 514/519 (99.0366%)
___Train Local_Simple,  epoch 306, local model 54, internal_epoch   2,  Average loss: 0.0007, Accuracy: 515/519 (99.2293%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.1841, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch 306, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch 306, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.1432, Accuracy: 9580/10000 (95.8000%)
___Train Local_Simple,  epoch 306, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 400/401 (99.7506%)
___Train Local_Simple,  epoch 306, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.0375, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 306, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 888/892 (99.5516%)
___Train Local_Simple,  epoch 306, local model 10, internal_epoch   2,  Average loss: 0.0009, Accuracy: 883/892 (98.9910%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 85]
base_p: [ 2.6901066e-04  3.3679418e-04 -5.2324496e-05 ... -5.8287382e-04
 -9.4980001e-04 -8.4275752e-04]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 7]
layer1_inf_time: 3.369384765625
[PAIRWISE] pred_attackers_indx:  [3 4 5]
layer2_inf_t: 34.952392578125
assumed final_attacker_idxs:  [1 3 4 5 7]
final_attacker_idxs is: [1 3 4 5 7]
g_attacker_idxs: [47 22 36 85 55]
g_normal_idxs: [97 89 54 15 10]
filtered_attacker_idxs: [1, 3, 4, 5]
final_attacker_idxs are: [1, 3, 4, 5]
num_dps: [487, 776, 492, 583, 1005, 431, 519, 354, 401, 892]
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.1294, Accuracy: 9566/10000 (95.6600%)
time spent on training: 79.31038689613342
Starting performing KrMLRFL...
Num data points: [487, 776, 492, 583, 1005, 431, 519, 354, 401, 892]
Num selected data points: [487 492 519 354 401 892]
The chosen ones are users: [0, 2, 6, 7, 8, 9], which are global users: [97, 89, 54, 55, 15, 10]
___Test Local_Simple poisoned: False, epoch: 306: Average loss: 0.0390, Accuracy: 9876/10000 (98.7600%)
epoch_acc: 98.76
___Test Local_Simple poisoned: True, epoch: 306: Average loss: 12.8348, Accuracy: 15/8968 (0.1673%)
Done in 109.93840956687927 sec.
Server Epoch:307 choose agents : [85, 68, 2, 43, 3, 6, 50, 40, 28, 57].
poison local model 85 index 0
___Train Local_Simple,  epoch 307, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 307, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.1135, Accuracy: 9650/10000 (96.5000%)
___Train Local_Simple,  epoch 307, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Train Local_Simple,  epoch 307, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.0757, Accuracy: 9753/10000 (97.5300%)
poison local model 2 index 1
___Train Local_Simple,  epoch 307, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 541/548 (98.7226%)
___Train Local_Simple,  epoch 307, local model 2, internal_epoch   2,  Average loss: 0.0005, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.1045, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch 307, local model 43, internal_epoch   1,  Average loss: 0.0004, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 307, local model 43, internal_epoch   2,  Average loss: 0.0004, Accuracy: 405/408 (99.2647%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.0517, Accuracy: 9830/10000 (98.3000%)
___Train Local_Simple,  epoch 307, local model 3, internal_epoch   1,  Average loss: 0.0008, Accuracy: 904/923 (97.9415%)
___Train Local_Simple,  epoch 307, local model 3, internal_epoch   2,  Average loss: 0.0010, Accuracy: 904/923 (97.9415%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.1346, Accuracy: 9589/10000 (95.8900%)
___Train Local_Simple,  epoch 307, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 307, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.0567, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 307, local model 50, internal_epoch   1,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%)
___Train Local_Simple,  epoch 307, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.1875, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch 307, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 765/772 (99.0933%)
___Train Local_Simple,  epoch 307, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 768/772 (99.4819%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.1124, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 307, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 499/501 (99.6008%)
___Train Local_Simple,  epoch 307, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.0477, Accuracy: 9850/10000 (98.5000%)
___Train Local_Simple,  epoch 307, local model 57, internal_epoch   1,  Average loss: 0.0011, Accuracy: 338/343 (98.5423%)
___Train Local_Simple,  epoch 307, local model 57, internal_epoch   2,  Average loss: 0.0006, Accuracy: 338/343 (98.5423%)
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.0843, Accuracy: 9736/10000 (97.3600%)
time spent on training: 94.89554238319397
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 2]
base_p: [ 5.2835792e-05  5.0244853e-05 -1.1176700e-03 ...  2.5337338e-03
 -2.3312494e-03 -1.3004318e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 7, 9]
layer1_inf_time: 4.048583984375
[PAIRWISE] pred_attackers_indx:  [2 4 6 7]
layer2_inf_t: 567.697509765625
assumed final_attacker_idxs:  [0 2 4 6 7 9]
final_attacker_idxs is: [0 2 4 6 7 9]
g_attacker_idxs: [85  2  3 50 40 57]
g_normal_idxs: [68 43  6 28]
filtered_attacker_idxs: [0, 2, 4, 7]
final_attacker_idxs are: [0, 2, 4, 7]
num_dps: [431, 494, 548, 408, 923, 615, 474, 772, 501, 343]
Starting performing KrMLRFL...
Num data points: [431, 494, 548, 408, 923, 615, 474, 772, 501, 343]
Num selected data points: [494 408 615 474 501 343]
The chosen ones are users: [1, 3, 5, 6, 8, 9], which are global users: [68, 43, 6, 50, 28, 57]
___Test Local_Simple poisoned: False, epoch: 307: Average loss: 0.0312, Accuracy: 9896/10000 (98.9600%)
epoch_acc: 98.96000000000001
___Test Local_Simple poisoned: True, epoch: 307: Average loss: 13.3266, Accuracy: 11/8968 (0.1227%)
Done in 128.73294401168823 sec.
Server Epoch:308 choose agents : [57, 45, 71, 48, 23, 15, 39, 56, 14, 59].
___Train Local_Simple,  epoch 308, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 340/343 (99.1254%)
___Train Local_Simple,  epoch 308, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 339/343 (98.8338%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.0922, Accuracy: 9717/10000 (97.1700%)
poison local model 45 index 0
___Train Local_Simple,  epoch 308, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 621/628 (98.8854%)
___Train Local_Simple,  epoch 308, local model 45, internal_epoch   2,  Average loss: 0.0002, Accuracy: 625/628 (99.5223%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.1915, Accuracy: 9421/10000 (94.2100%)
poison local model 71 index 1
___Train Local_Simple,  epoch 308, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1372/1384 (99.1329%)
___Train Local_Simple,  epoch 308, local model 71, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1377/1384 (99.4942%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.2329, Accuracy: 9190/10000 (91.9000%)
___Train Local_Simple,  epoch 308, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Train Local_Simple,  epoch 308, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.0533, Accuracy: 9824/10000 (98.2400%)
___Train Local_Simple,  epoch 308, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 308, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.0343, Accuracy: 9889/10000 (98.8900%)
___Train Local_Simple,  epoch 308, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 308, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.0327, Accuracy: 9881/10000 (98.8100%)
___Train Local_Simple,  epoch 308, local model 39, internal_epoch   1,  Average loss: 0.0003, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 308, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.0657, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch 308, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 308, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.0446, Accuracy: 9857/10000 (98.5700%)
___Train Local_Simple,  epoch 308, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 372/376 (98.9362%)
___Train Local_Simple,  epoch 308, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.1111, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch 308, local model 59, internal_epoch   1,  Average loss: 0.0011, Accuracy: 747/760 (98.2895%)
___Train Local_Simple,  epoch 308, local model 59, internal_epoch   2,  Average loss: 0.0007, Accuracy: 749/760 (98.5526%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 71]
base_p: [ 7.7925622e-05 -4.0549785e-06  1.1861129e-03 ... -1.5572608e-03
 -1.4325455e-03 -1.0892749e-05]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 9]
layer1_inf_time: 5.067138671875
[PAIRWISE] pred_attackers_indx:  [1 2 9]
layer2_inf_t: 368.58203125
assumed final_attacker_idxs:  [0 1 2 5 9]
final_attacker_idxs is: [0 1 2 5 9]
g_attacker_idxs: [57 45 71 15 59]
g_normal_idxs: [48 23 39 56 14]
filtered_attacker_idxs: [1, 2, 9]
final_attacker_idxs are: [1, 2, 9]
num_dps: [343, 628, 1384, 448, 293, 401, 257, 880, 376, 760]
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.1730, Accuracy: 9413/10000 (94.1300%)
time spent on training: 62.68041229248047
Starting performing KrMLRFL...
Num data points: [343, 628, 1384, 448, 293, 401, 257, 880, 376, 760]
Num selected data points: [343 448 293 401 257 880 376]
The chosen ones are users: [0, 3, 4, 5, 6, 7, 8], which are global users: [57, 48, 23, 15, 39, 56, 14]
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: False, epoch: 308: Average loss: 0.0292, Accuracy: 9901/10000 (99.0100%)
___Test Local_Simple poisoned: True, epoch: 308: Average loss: 13.3123, Accuracy: 18/8968 (0.2007%)
Done in 70.3710458278656 sec.
Server Epoch:309 choose agents : [88, 15, 60, 75, 18, 83, 69, 8, 90, 53].
___Train Local_Simple,  epoch 309, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch 309, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.0627, Accuracy: 9796/10000 (97.9600%)
___Train Local_Simple,  epoch 309, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 309, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.0313, Accuracy: 9892/10000 (98.9200%)
___Train Local_Simple,  epoch 309, local model 60, internal_epoch   1,  Average loss: 0.0002, Accuracy: 338/338 (100.0000%)
___Train Local_Simple,  epoch 309, local model 60, internal_epoch   2,  Average loss: 0.0000, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.0553, Accuracy: 9820/10000 (98.2000%)
___Train Local_Simple,  epoch 309, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Train Local_Simple,  epoch 309, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.0708, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 309, local model 18, internal_epoch   1,  Average loss: 0.0002, Accuracy: 457/459 (99.5643%)
___Train Local_Simple,  epoch 309, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 457/459 (99.5643%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.1055, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch 309, local model 83, internal_epoch   1,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Train Local_Simple,  epoch 309, local model 83, internal_epoch   2,  Average loss: 0.0000, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.0346, Accuracy: 9892/10000 (98.9200%)
___Train Local_Simple,  epoch 309, local model 69, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 309, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.1544, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch 309, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Train Local_Simple,  epoch 309, local model 8, internal_epoch   2,  Average loss: 0.0000, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.0447, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 309, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%)
___Train Local_Simple,  epoch 309, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.6137, Accuracy: 8794/10000 (87.9400%)
___Train Local_Simple,  epoch 309, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 729/739 (98.6468%)
___Train Local_Simple,  epoch 309, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.3596, Accuracy: 8973/10000 (89.7300%)
time spent on training: 31.659037113189697
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [-0.00033803  0.00023871  0.00024574 ... -0.00129537  0.00243287
  0.00062755]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 9]
layer1_inf_time: 3.486572265625
[PAIRWISE] pred_attackers_indx:  [0 2 7 9]
layer2_inf_t: 427.303466796875
assumed final_attacker_idxs:  [0 1 2 3 4 7 9]
final_attacker_idxs is: [0 1 2 3 4 7 9]
g_attacker_idxs: [88 15 60 75 18  8 53]
g_normal_idxs: [83 69 90]
filtered_attacker_idxs: [2, 9]
final_attacker_idxs are: [2, 9]
num_dps: [530, 401, 338, 686, 459, 433, 256, 633, 683, 739]
Num data points: [530, 401, 338, 686, 459, 433, 256, 633, 683, 739]
Num selected data points: [530 401 686 459 433 256 633 683]
The chosen ones are users: [0, 1, 3, 4, 5, 6, 7, 8], which are global users: [88, 15, 75, 18, 83, 69, 8, 90]
___Test Local_Simple poisoned: False, epoch: 309: Average loss: 0.0311, Accuracy: 9894/10000 (98.9400%)
epoch_acc: 98.94
___Test Local_Simple poisoned: True, epoch: 309: Average loss: 14.4097, Accuracy: 4/8968 (0.0446%)
Done in 39.70088863372803 sec.
Server Epoch:310 choose agents : [78, 18, 28, 90, 62, 25, 26, 41, 74, 13].
___Train Local_Simple,  epoch 310, local model 78, internal_epoch   1,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 310, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0660, Accuracy: 9792/10000 (97.9200%)
___Train Local_Simple,  epoch 310, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 310, local model 18, internal_epoch   2,  Average loss: 0.0000, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0454, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 310, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 310, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0373, Accuracy: 9881/10000 (98.8100%)
___Train Local_Simple,  epoch 310, local model 90, internal_epoch   1,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 310, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0436, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 310, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 310, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0564, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 310, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 644/647 (99.5363%)
___Train Local_Simple,  epoch 310, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0997, Accuracy: 9668/10000 (96.6800%)
poison local model 26 index 0
___Train Local_Simple,  epoch 310, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 310, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.1103, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch 310, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Train Local_Simple,  epoch 310, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0643, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch 310, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 552/557 (99.1023%)
___Train Local_Simple,  epoch 310, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0529, Accuracy: 9837/10000 (98.3700%)
poison local model 13 index 1
___Train Local_Simple,  epoch 310, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 726/734 (98.9101%)
___Train Local_Simple,  epoch 310, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%)
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0920, Accuracy: 9709/10000 (97.0900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 13]
base_p: [ 4.0989369e-04 -4.6093017e-05  6.5170974e-04 ... -1.4229119e-03
  1.3799220e-04 -3.9856136e-04]
[T_SCORE] attacker_local_idxs is:  [1, 5, 6, 7, 9]
layer1_inf_time: 5.349609375
[PAIRWISE] pred_attackers_indx:  [5 9]
layer2_inf_t: 158.156982421875
assumed final_attacker_idxs:  [1 5 6 7 9]
final_attacker_idxs is: [1 5 6 7 9]
g_attacker_idxs: [18 25 26 41 13]
g_normal_idxs: [78 28 90 62 74]
filtered_attacker_idxs: [5, 6, 7, 9]
final_attacker_idxs are: [5, 6, 7, 9]
num_dps: [303, 459, 501, 683, 423, 647, 554, 606, 557, 734]
time spent on training: 48.93380165100098
Starting performing KrMLRFL...
Num data points: [303, 459, 501, 683, 423, 647, 554, 606, 557, 734]
Num selected data points: [303 459 501 683 423 557]
The chosen ones are users: [0, 1, 2, 3, 4, 8], which are global users: [78, 18, 28, 90, 62, 74]
epoch_acc: 98.96000000000001
___Test Local_Simple poisoned: False, epoch: 310: Average loss: 0.0291, Accuracy: 9896/10000 (98.9600%)
___Test Local_Simple poisoned: True, epoch: 310: Average loss: 14.0981, Accuracy: 9/8968 (0.1004%)
Done in 104.31046843528748 sec.
Server Epoch:311 choose agents : [88, 90, 18, 96, 97, 55, 41, 95, 45, 43].
___Train Local_Simple,  epoch 311, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 529/530 (99.8113%)
___Train Local_Simple,  epoch 311, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.0815, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch 311, local model 90, internal_epoch   1,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 311, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.0480, Accuracy: 9844/10000 (98.4400%)
___Train Local_Simple,  epoch 311, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 459/459 (100.0000%)
___Train Local_Simple,  epoch 311, local model 18, internal_epoch   2,  Average loss: 0.0000, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.0527, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 311, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 664/672 (98.8095%)
___Train Local_Simple,  epoch 311, local model 96, internal_epoch   2,  Average loss: 0.0009, Accuracy: 659/672 (98.0655%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.4063, Accuracy: 8602/10000 (86.0200%)
___Train Local_Simple,  epoch 311, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 311, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.0503, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch 311, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 311, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.3585, Accuracy: 8934/10000 (89.3400%)
___Train Local_Simple,  epoch 311, local model 41, internal_epoch   1,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Train Local_Simple,  epoch 311, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.0586, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 311, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 311, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.3561, Accuracy: 8955/10000 (89.5500%)
poison local model 45 index 0
___Train Local_Simple,  epoch 311, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 311, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.2573, Accuracy: 9106/10000 (91.0600%)
___Train Local_Simple,  epoch 311, local model 43, internal_epoch   1,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 311, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.0348, Accuracy: 9890/10000 (98.9000%)
time spent on training: 67.20682764053345
Starting performing KrMLRFL...
Num data points: [530, 683, 459, 672, 487, 354, 606, 602, 628, 408]
Num selected data points: [530 683 459 487 354 408]
The chosen ones are users: [0, 1, 2, 4, 5, 9], which are global users: [88, 90, 18, 97, 55, 43]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45]
base_p: [ 0.0014195   0.00013164  0.00110336 ... -0.00141595  0.00226822
 -0.0004165 ]
[T_SCORE] attacker_local_idxs is:  [3, 5, 6, 7, 8]
layer1_inf_time: 3.943603515625
[PAIRWISE] pred_attackers_indx:  [3 7 8]
layer2_inf_t: 431.47412109375
assumed final_attacker_idxs:  [3 5 6 7 8]
final_attacker_idxs is: [3 5 6 7 8]
g_attacker_idxs: [96 55 41 95 45]
g_normal_idxs: [88 90 18 97 43]
filtered_attacker_idxs: [3, 6, 7, 8]
final_attacker_idxs are: [3, 6, 7, 8]
num_dps: [530, 683, 459, 672, 487, 354, 606, 602, 628, 408]
epoch_acc: 98.89
___Test Local_Simple poisoned: False, epoch: 311: Average loss: 0.0340, Accuracy: 9889/10000 (98.8900%)
___Test Local_Simple poisoned: True, epoch: 311: Average loss: 14.4504, Accuracy: 9/8968 (0.1004%)
Done in 83.38558554649353 sec.
Server Epoch:312 choose agents : [7, 81, 73, 23, 87, 40, 86, 33, 56, 19].
poison local model 7 index 0
___Train Local_Simple,  epoch 312, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 312, local model 7, internal_epoch   2,  Average loss: 0.0006, Accuracy: 413/418 (98.8038%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.3591, Accuracy: 9101/10000 (91.0100%)
poison local model 81 index 1
___Train Local_Simple,  epoch 312, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1215/1227 (99.0220%)
___Train Local_Simple,  epoch 312, local model 81, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1209/1227 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.3405, Accuracy: 9031/10000 (90.3100%)
poison local model 73 index 2
___Train Local_Simple,  epoch 312, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 586/591 (99.1540%)
___Train Local_Simple,  epoch 312, local model 73, internal_epoch   2,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.1006, Accuracy: 9677/10000 (96.7700%)
___Train Local_Simple,  epoch 312, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 312, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.0374, Accuracy: 9878/10000 (98.7800%)
___Train Local_Simple,  epoch 312, local model 87, internal_epoch   1,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Train Local_Simple,  epoch 312, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 469/470 (99.7872%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.0474, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 312, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 768/772 (99.4819%)
___Train Local_Simple,  epoch 312, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.1421, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch 312, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 312, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.0693, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch 312, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 312, local model 33, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.1291, Accuracy: 9594/10000 (95.9400%)
___Train Local_Simple,  epoch 312, local model 56, internal_epoch   1,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 312, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.0337, Accuracy: 9882/10000 (98.8200%)
___Train Local_Simple,  epoch 312, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 204/205 (99.5122%)
___Train Local_Simple,  epoch 312, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.1646, Accuracy: 9497/10000 (94.9700%)
time spent on training: 58.70253109931946
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 81, 73]
base_p: [-0.00037507 -0.00264845 -0.00047949 ... -0.00181735 -0.00479415
  0.00010937]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 7]
layer1_inf_time: 3.1708984375
Starting performing KrMLRFL...
Num data points: [418, 1227, 591, 293, 470, 772, 250, 623, 880, 205]
Num selected data points: [293 470 250 623 880 205]
The chosen ones are users: [3, 4, 6, 7, 8, 9], which are global users: [23, 87, 86, 33, 56, 19]
___Test Local_Simple poisoned: False, epoch: 312: Average loss: 0.0310, Accuracy: 9892/10000 (98.9200%)
[PAIRWISE] pred_attackers_indx:  [0 1 2 5]
layer2_inf_t: 799.86083984375
assumed final_attacker_idxs:  [0 1 2 5 7]
final_attacker_idxs is: [0 1 2 5 7]
g_attacker_idxs: [ 7 81 73 40 33]
g_normal_idxs: [23 87 86 56 19]
filtered_attacker_idxs: [0, 1, 2, 5]
final_attacker_idxs are: [0, 1, 2, 5]
num_dps: [418, 1227, 591, 293, 470, 772, 250, 623, 880, 205]
epoch_acc: 98.92
___Test Local_Simple poisoned: True, epoch: 312: Average loss: 14.5022, Accuracy: 10/8968 (0.1115%)
Done in 109.47332262992859 sec.
Server Epoch:313 choose agents : [62, 69, 37, 32, 11, 88, 89, 34, 31, 3].
___Train Local_Simple,  epoch 313, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 313, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.0433, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch 313, local model 69, internal_epoch   1,  Average loss: 0.0010, Accuracy: 248/256 (96.8750%)
___Train Local_Simple,  epoch 313, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.1847, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch 313, local model 37, internal_epoch   1,  Average loss: 0.0001, Accuracy: 856/860 (99.5349%)
___Train Local_Simple,  epoch 313, local model 37, internal_epoch   2,  Average loss: 0.0000, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.1148, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch 313, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 960/977 (98.2600%)
___Train Local_Simple,  epoch 313, local model 32, internal_epoch   2,  Average loss: 0.0018, Accuracy: 945/977 (96.7247%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.2270, Accuracy: 9293/10000 (92.9300%)
poison local model 11 index 0
___Train Local_Simple,  epoch 313, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 638/645 (98.9147%)
___Train Local_Simple,  epoch 313, local model 11, internal_epoch   2,  Average loss: 0.0003, Accuracy: 640/645 (99.2248%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.3261, Accuracy: 9204/10000 (92.0400%)
___Train Local_Simple,  epoch 313, local model 88, internal_epoch   1,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Train Local_Simple,  epoch 313, local model 88, internal_epoch   2,  Average loss: 0.0000, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.0400, Accuracy: 9868/10000 (98.6800%)
___Train Local_Simple,  epoch 313, local model 89, internal_epoch   1,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Train Local_Simple,  epoch 313, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.0735, Accuracy: 9757/10000 (97.5700%)
poison local model 34 index 1
___Train Local_Simple,  epoch 313, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 313, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.0888, Accuracy: 9740/10000 (97.4000%)
___Train Local_Simple,  epoch 313, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 835/835 (100.0000%)
___Train Local_Simple,  epoch 313, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.0487, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 313, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 914/923 (99.0249%)
___Train Local_Simple,  epoch 313, local model 3, internal_epoch   2,  Average loss: 0.0002, Accuracy: 920/923 (99.6750%)
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.1354, Accuracy: 9560/10000 (95.6000%)
time spent on training: 128.1370873451233
Starting performing KrMLRFL...
Num data points: [423, 256, 860, 977, 645, 530, 492, 413, 835, 923]
Num selected data points: [423 256 860 530 492 835]
The chosen ones are users: [0, 1, 2, 5, 6, 8], which are global users: [62, 69, 37, 88, 89, 31]
___Test Local_Simple poisoned: False, epoch: 313: Average loss: 0.0399, Accuracy: 9875/10000 (98.7500%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 34]
base_p: [-0.00051773 -0.00014151  0.00136898 ...  0.01114073 -0.00046173
  0.00103924]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 9]
layer1_inf_time: 3.3798828125
[PAIRWISE] pred_attackers_indx:  [3 4 9]
layer2_inf_t: 32.9697265625
assumed final_attacker_idxs:  [2 3 4 7 9]
final_attacker_idxs is: [2 3 4 7 9]
g_attacker_idxs: [37 32 11 34  3]
g_normal_idxs: [62 69 88 89 31]
filtered_attacker_idxs: [3, 4, 7, 9]
final_attacker_idxs are: [3, 4, 7, 9]
num_dps: [423, 256, 860, 977, 645, 530, 492, 413, 835, 923]
epoch_acc: 98.75
___Test Local_Simple poisoned: True, epoch: 313: Average loss: 13.8413, Accuracy: 24/8968 (0.2676%)
Done in 136.33387851715088 sec.
Server Epoch:314 choose agents : [66, 38, 71, 1, 28, 15, 32, 9, 86, 60].
___Train Local_Simple,  epoch 314, local model 66, internal_epoch   1,  Average loss: 0.0013, Accuracy: 641/660 (97.1212%)
___Train Local_Simple,  epoch 314, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 652/660 (98.7879%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.6464, Accuracy: 8625/10000 (86.2500%)
___Train Local_Simple,  epoch 314, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%)
___Train Local_Simple,  epoch 314, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.0648, Accuracy: 9786/10000 (97.8600%)
poison local model 71 index 0
___Train Local_Simple,  epoch 314, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1367/1384 (98.7717%)
___Train Local_Simple,  epoch 314, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1374/1384 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.2751, Accuracy: 9143/10000 (91.4300%)
poison local model 1 index 1
___Train Local_Simple,  epoch 314, local model 1, internal_epoch   1,  Average loss: 0.0008, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 314, local model 1, internal_epoch   2,  Average loss: 0.0010, Accuracy: 738/760 (97.1053%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.1256, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch 314, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 314, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.0438, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 314, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch 314, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.3079, Accuracy: 9304/10000 (93.0400%)
___Train Local_Simple,  epoch 314, local model 32, internal_epoch   1,  Average loss: 0.0013, Accuracy: 954/977 (97.6459%)
___Train Local_Simple,  epoch 314, local model 32, internal_epoch   2,  Average loss: 0.0013, Accuracy: 951/977 (97.3388%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.2046, Accuracy: 9414/10000 (94.1400%)
___Train Local_Simple,  epoch 314, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 314, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.0572, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 314, local model 86, internal_epoch   1,  Average loss: 0.0005, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 314, local model 86, internal_epoch   2,  Average loss: 0.0003, Accuracy: 249/250 (99.6000%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.0652, Accuracy: 9792/10000 (97.9200%)
___Train Local_Simple,  epoch 314, local model 60, internal_epoch   1,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Train Local_Simple,  epoch 314, local model 60, internal_epoch   2,  Average loss: 0.0000, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.0449, Accuracy: 9851/10000 (98.5100%)
time spent on training: 43.98336863517761
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 1]
base_p: [-9.9677220e-04 -5.3077936e-05 -3.9540231e-04 ... -2.9304624e-03
 -7.3514134e-04 -3.9964169e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 6]
layer1_inf_time: 4.34228515625
[PAIRWISE] pred_attackers_indx:  [0 2 3 5]
layer2_inf_t: 993.773193359375
assumed final_attacker_idxs:  [0 1 2 3 5 6]
final_attacker_idxs is: [0 1 2 3 5 6]
g_attacker_idxs: [66 38 71  1 15 32]
g_normal_idxs: [28  9 86 60]
filtered_attacker_idxs: [0, 2, 3, 6]
final_attacker_idxs are: [0, 2, 3, 6]
num_dps: [660, 895, 1384, 760, 501, 401, 977, 436, 250, 338]
Num data points: [660, 895, 1384, 760, 501, 401, 977, 436, 250, 338]
Num selected data points: [895 501 401 436 250 338]
The chosen ones are users: [1, 4, 5, 7, 8, 9], which are global users: [38, 28, 15, 9, 86, 60]
___Test Local_Simple poisoned: False, epoch: 314: Average loss: 0.0312, Accuracy: 9901/10000 (99.0100%)
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: True, epoch: 314: Average loss: 15.1766, Accuracy: 4/8968 (0.0446%)
Done in 70.28316974639893 sec.
Server Epoch:315 choose agents : [98, 15, 51, 66, 85, 65, 25, 38, 60, 14].
___Train Local_Simple,  epoch 315, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 806/818 (98.5330%)
___Train Local_Simple,  epoch 315, local model 98, internal_epoch   2,  Average loss: 0.0005, Accuracy: 810/818 (99.0220%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.1465, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch 315, local model 15, internal_epoch   1,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 315, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0304, Accuracy: 9899/10000 (98.9900%)
poison local model 51 index 0
___Train Local_Simple,  epoch 315, local model 51, internal_epoch   1,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%)
___Train Local_Simple,  epoch 315, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0915, Accuracy: 9723/10000 (97.2300%)
___Train Local_Simple,  epoch 315, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 649/660 (98.3333%)
___Train Local_Simple,  epoch 315, local model 66, internal_epoch   2,  Average loss: 0.0009, Accuracy: 651/660 (98.6364%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.1316, Accuracy: 9563/10000 (95.6300%)
poison local model 85 index 1
___Train Local_Simple,  epoch 315, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 315, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0466, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 315, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 315, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0600, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 315, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 642/647 (99.2272%)
___Train Local_Simple,  epoch 315, local model 25, internal_epoch   2,  Average loss: 0.0005, Accuracy: 643/647 (99.3818%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.1298, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch 315, local model 38, internal_epoch   1,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Train Local_Simple,  epoch 315, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0636, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch 315, local model 60, internal_epoch   1,  Average loss: 0.0002, Accuracy: 337/338 (99.7041%)
___Train Local_Simple,  epoch 315, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0599, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 315, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 372/376 (98.9362%)
___Train Local_Simple,  epoch 315, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0518, Accuracy: 9835/10000 (98.3500%)
time spent on training: 105.387521982193
Starting performing KrMLRFL...
Num data points: [818, 401, 568, 660, 431, 371, 647, 895, 338, 376]
Num selected data points: [401 431 371 895 376]
The chosen ones are users: [1, 4, 5, 7, 9], which are global users: [15, 85, 65, 38, 14]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 85]
base_p: [ 1.16784126e-04  5.80735505e-05  9.78067517e-04 ... -1.08936429e-03
 -5.83186746e-04  2.04173476e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 6, 7]
layer1_inf_time: 4.938232421875
[PAIRWISE] pred_attackers_indx:  [2 6 8 9]
layer2_inf_t: 124.08056640625
assumed final_attacker_idxs:  [0 2 3 6 7 8 9]
final_attacker_idxs is: [0 2 3 6 7 8 9]
g_attacker_idxs: [98 51 66 25 38 60 14]
g_normal_idxs: [15 85 65]
filtered_attacker_idxs: [0, 2, 3, 6, 8]
final_attacker_idxs are: [0, 2, 3, 6, 8]
num_dps: [818, 401, 568, 660, 431, 371, 647, 895, 338, 376]
epoch_acc: 99.0
___Test Local_Simple poisoned: False, epoch: 315: Average loss: 0.0316, Accuracy: 9900/10000 (99.0000%)
___Test Local_Simple poisoned: True, epoch: 315: Average loss: 15.3922, Accuracy: 6/8968 (0.0669%)
Done in 110.83251619338989 sec.
Server Epoch:316 choose agents : [16, 73, 21, 71, 85, 49, 93, 92, 70, 68].
poison local model 16 index 0
___Train Local_Simple,  epoch 316, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 902/915 (98.5792%)
___Train Local_Simple,  epoch 316, local model 16, internal_epoch   2,  Average loss: 0.0005, Accuracy: 902/915 (98.5792%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.0935, Accuracy: 9714/10000 (97.1400%)
poison local model 73 index 1
___Train Local_Simple,  epoch 316, local model 73, internal_epoch   1,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%)
___Train Local_Simple,  epoch 316, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 590/591 (99.8308%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.0753, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch 316, local model 21, internal_epoch   1,  Average loss: 0.0002, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch 316, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 310/312 (99.3590%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.0622, Accuracy: 9798/10000 (97.9800%)
poison local model 71 index 2
___Train Local_Simple,  epoch 316, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1370/1384 (98.9884%)
___Train Local_Simple,  epoch 316, local model 71, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1374/1384 (99.2775%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.1227, Accuracy: 9627/10000 (96.2700%)
poison local model 85 index 3
___Train Local_Simple,  epoch 316, local model 85, internal_epoch   1,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 316, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.0332, Accuracy: 9896/10000 (98.9600%)
___Train Local_Simple,  epoch 316, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 316, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.0637, Accuracy: 9797/10000 (97.9700%)
poison local model 93 index 0
___Train Local_Simple,  epoch 316, local model 93, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 316, local model 93, internal_epoch   2,  Average loss: 0.0001, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.2274, Accuracy: 9380/10000 (93.8000%)
___Train Local_Simple,  epoch 316, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 927/937 (98.9328%)
___Train Local_Simple,  epoch 316, local model 92, internal_epoch   2,  Average loss: 0.0012, Accuracy: 914/937 (97.5454%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.3029, Accuracy: 8987/10000 (89.8700%)
poison local model 70 index 1
___Train Local_Simple,  epoch 316, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 711/724 (98.2044%)
___Train Local_Simple,  epoch 316, local model 70, internal_epoch   2,  Average loss: 0.0026, Accuracy: 688/724 (95.0276%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.6727, Accuracy: 8544/10000 (85.4400%)
___Train Local_Simple,  epoch 316, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 316, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.1008, Accuracy: 9731/10000 (97.3100%)
time spent on training: 200.16205286979675
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 73, 71, 85, 93, 70]
base_p: [ 0.00096999  0.00020229  0.00463605 ... -0.00132248 -0.00497241
  0.00078776]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 6, 7, 8]
layer1_inf_time: 4.55078125
Starting performing KrMLRFL...
Num data points: [915, 591, 312, 1384, 431, 506, 623, 937, 724, 494]
Num selected data points: [312 431 506 494]
The chosen ones are users: [2, 4, 5, 9], which are global users: [21, 85, 49, 68]
[PAIRWISE] pred_attackers_indx:  [3 6 7 8]
layer2_inf_t: 332.10302734375
assumed final_attacker_idxs:  [0 1 3 6 7 8]
final_attacker_idxs is: [0 1 3 6 7 8]
g_attacker_idxs: [16 73 71 93 92 70]
g_normal_idxs: [21 85 49 68]
filtered_attacker_idxs: [0, 1, 3, 6, 7, 8]
final_attacker_idxs are: [0, 1, 3, 6, 7, 8]
num_dps: [915, 591, 312, 1384, 431, 506, 623, 937, 724, 494]
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: False, epoch: 316: Average loss: 0.0327, Accuracy: 9893/10000 (98.9300%)
___Test Local_Simple poisoned: True, epoch: 316: Average loss: 15.1559, Accuracy: 7/8968 (0.0781%)
Done in 205.6993796825409 sec.
Server Epoch:317 choose agents : [41, 48, 49, 84, 17, 36, 7, 67, 66, 27].
___Train Local_Simple,  epoch 317, local model 41, internal_epoch   1,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%)
___Train Local_Simple,  epoch 317, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.0679, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 317, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Train Local_Simple,  epoch 317, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.0472, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch 317, local model 49, internal_epoch   1,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Train Local_Simple,  epoch 317, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.0352, Accuracy: 9886/10000 (98.8600%)
___Train Local_Simple,  epoch 317, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1229/1246 (98.6356%)
___Train Local_Simple,  epoch 317, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1232/1246 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.1014, Accuracy: 9685/10000 (96.8500%)
poison local model 17 index 0
___Train Local_Simple,  epoch 317, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 607/620 (97.9032%)
___Train Local_Simple,  epoch 317, local model 17, internal_epoch   2,  Average loss: 0.0008, Accuracy: 610/620 (98.3871%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.3252, Accuracy: 8977/10000 (89.7700%)
___Train Local_Simple,  epoch 317, local model 36, internal_epoch   1,  Average loss: 0.0007, Accuracy: 988/1005 (98.3085%)
___Train Local_Simple,  epoch 317, local model 36, internal_epoch   2,  Average loss: 0.0003, Accuracy: 998/1005 (99.3035%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.2923, Accuracy: 9132/10000 (91.3200%)
poison local model 7 index 1
___Train Local_Simple,  epoch 317, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 317, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.1849, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch 317, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 987/998 (98.8978%)
___Train Local_Simple,  epoch 317, local model 67, internal_epoch   2,  Average loss: 0.0004, Accuracy: 990/998 (99.1984%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.2208, Accuracy: 9327/10000 (93.2700%)
___Train Local_Simple,  epoch 317, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 654/660 (99.0909%)
___Train Local_Simple,  epoch 317, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 654/660 (99.0909%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.1565, Accuracy: 9469/10000 (94.6900%)
poison local model 27 index 2
___Train Local_Simple,  epoch 317, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 461/471 (97.8769%)
___Train Local_Simple,  epoch 317, local model 27, internal_epoch   2,  Average loss: 0.0014, Accuracy: 460/471 (97.6645%)
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.5066, Accuracy: 8867/10000 (88.6700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 7, 27]
base_p: [-1.7377734e-04 -8.0088153e-05  7.2142482e-04 ... -2.5845468e-03
 -3.3017918e-03 -1.8481910e-03]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 6, 7, 8, 9]
layer1_inf_time: 2.4970703125
time spent on training: 104.9006245136261
Starting performing KrMLRFL...
Num data points: [606, 448, 506, 1246, 620, 1005, 418, 998, 660, 471]
Num selected data points: [606 448 506]
The chosen ones are users: [0, 1, 2], which are global users: [41, 48, 49]
___Test Local_Simple poisoned: False, epoch: 317: Average loss: 0.0402, Accuracy: 9879/10000 (98.7900%)
[PAIRWISE] pred_attackers_indx:  [3 4 8 9]
layer2_inf_t: 26.3623046875
assumed final_attacker_idxs:  [3 4 5 6 7 8 9]
final_attacker_idxs is: [3 4 5 6 7 8 9]
g_attacker_idxs: [84 17 36  7 67 66 27]
g_normal_idxs: [41 48 49]
filtered_attacker_idxs: [3, 4, 5, 6, 7, 8, 9]
final_attacker_idxs are: [3, 4, 5, 6, 7, 8, 9]
num_dps: [606, 448, 506, 1246, 620, 1005, 418, 998, 660, 471]
epoch_acc: 98.79
___Test Local_Simple poisoned: True, epoch: 317: Average loss: 14.5480, Accuracy: 18/8968 (0.2007%)
Done in 110.43903374671936 sec.
Server Epoch:318 choose agents : [67, 95, 50, 47, 34, 57, 90, 80, 93, 29].
___Train Local_Simple,  epoch 318, local model 67, internal_epoch   1,  Average loss: 0.0006, Accuracy: 984/998 (98.5972%)
___Train Local_Simple,  epoch 318, local model 67, internal_epoch   2,  Average loss: 0.0007, Accuracy: 984/998 (98.5972%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.1619, Accuracy: 9500/10000 (95.0000%)
___Train Local_Simple,  epoch 318, local model 95, internal_epoch   1,  Average loss: 0.0001, Accuracy: 600/602 (99.6678%)
___Train Local_Simple,  epoch 318, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.3238, Accuracy: 8804/10000 (88.0400%)
___Train Local_Simple,  epoch 318, local model 50, internal_epoch   1,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%)
___Train Local_Simple,  epoch 318, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.1361, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch 318, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 771/776 (99.3557%)
___Train Local_Simple,  epoch 318, local model 47, internal_epoch   2,  Average loss: 0.0005, Accuracy: 766/776 (98.7113%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.0902, Accuracy: 9724/10000 (97.2400%)
poison local model 34 index 0
___Train Local_Simple,  epoch 318, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 318, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.1381, Accuracy: 9610/10000 (96.1000%)
___Train Local_Simple,  epoch 318, local model 57, internal_epoch   1,  Average loss: 0.0004, Accuracy: 341/343 (99.4169%)
___Train Local_Simple,  epoch 318, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 341/343 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.0800, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch 318, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%)
___Train Local_Simple,  epoch 318, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 1.1045, Accuracy: 8737/10000 (87.3700%)
___Train Local_Simple,  epoch 318, local model 80, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 318, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.0752, Accuracy: 9766/10000 (97.6600%)
poison local model 93 index 1
___Train Local_Simple,  epoch 318, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 318, local model 93, internal_epoch   2,  Average loss: 0.0005, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.1924, Accuracy: 9473/10000 (94.7300%)
___Train Local_Simple,  epoch 318, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Train Local_Simple,  epoch 318, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%)
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.1343, Accuracy: 9610/10000 (96.1000%)
time spent on training: 42.77308750152588
Starting performing KrMLRFL...
Num data points: [998, 602, 474, 776, 413, 343, 683, 431, 623, 1002]
Num selected data points: [474 343 683 431]
The chosen ones are users: [2, 5, 6, 7], which are global users: [50, 57, 90, 80]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 93]
base_p: [ 6.4607710e-05  5.3886324e-06 -7.4989069e-04 ... -2.2708476e-03
  2.4994463e-04  9.8168850e-05]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 8]
layer1_inf_time: 2.9052734375
[PAIRWISE] pred_attackers_indx:  [0 1 2 4 5 6 9]
layer2_inf_t: 183.0361328125
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 8 9]
g_attacker_idxs: [67 95 50 47 34 57 90 93 29]
g_normal_idxs: [80]
filtered_attacker_idxs: [0, 1, 3, 4, 8, 9]
final_attacker_idxs are: [0, 1, 3, 4, 8, 9]
num_dps: [998, 602, 474, 776, 413, 343, 683, 431, 623, 1002]
___Test Local_Simple poisoned: False, epoch: 318: Average loss: 0.0695, Accuracy: 9760/10000 (97.6000%)
epoch_acc: 97.6
___Test Local_Simple poisoned: True, epoch: 318: Average loss: 13.9667, Accuracy: 8/8968 (0.0892%)
Done in 54.95858955383301 sec.
Server Epoch:319 choose agents : [33, 76, 20, 12, 1, 74, 8, 81, 6, 19].
___Train Local_Simple,  epoch 319, local model 33, internal_epoch   1,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Train Local_Simple,  epoch 319, local model 33, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.0608, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 319, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 319, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.0444, Accuracy: 9849/10000 (98.4900%)
poison local model 20 index 0
___Train Local_Simple,  epoch 319, local model 20, internal_epoch   1,  Average loss: 0.0013, Accuracy: 420/429 (97.9021%)
___Train Local_Simple,  epoch 319, local model 20, internal_epoch   2,  Average loss: 0.0007, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.1718, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch 319, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1133/1160 (97.6724%)
___Train Local_Simple,  epoch 319, local model 12, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1137/1160 (98.0172%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.2004, Accuracy: 9413/10000 (94.1300%)
poison local model 1 index 1
___Train Local_Simple,  epoch 319, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 319, local model 1, internal_epoch   2,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.1235, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch 319, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%)
___Train Local_Simple,  epoch 319, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.1188, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch 319, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Train Local_Simple,  epoch 319, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.0605, Accuracy: 9811/10000 (98.1100%)
poison local model 81 index 2
___Train Local_Simple,  epoch 319, local model 81, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1207/1227 (98.3700%)
___Train Local_Simple,  epoch 319, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1215/1227 (99.0220%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.4137, Accuracy: 8850/10000 (88.5000%)
___Train Local_Simple,  epoch 319, local model 6, internal_epoch   1,  Average loss: 0.0003, Accuracy: 611/615 (99.3496%)
___Train Local_Simple,  epoch 319, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 613/615 (99.6748%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.1009, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch 319, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch 319, local model 19, internal_epoch   2,  Average loss: 0.0002, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.1583, Accuracy: 9546/10000 (95.4600%)
time spent on training: 49.012470960617065
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 1, 81]
base_p: [-1.2582801e-03  7.7771023e-05 -8.7396335e-04 ... -4.9922913e-03
 -1.3240948e-03 -8.8270754e-04]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 7]
layer1_inf_time: 4.263916015625
Starting performing KrMLRFL...
Num data points: [623, 78, 429, 1160, 760, 557, 633, 1227, 615, 205]
Num selected data points: [623  78 557 633 615 205]
The chosen ones are users: [0, 1, 5, 6, 8, 9], which are global users: [33, 76, 74, 8, 6, 19]
___Test Local_Simple poisoned: False, epoch: 319: Average loss: 0.0346, Accuracy: 9887/10000 (98.8700%)
[PAIRWISE] pred_attackers_indx:  [2 3 7]
layer2_inf_t: 481.771240234375
assumed final_attacker_idxs:  [2 3 4 5 7]
final_attacker_idxs is: [2 3 4 5 7]
g_attacker_idxs: [20 12  1 74 81]
g_normal_idxs: [33 76  8  6 19]
filtered_attacker_idxs: [2, 3, 4, 7]
final_attacker_idxs are: [2, 3, 4, 7]
num_dps: [623, 78, 429, 1160, 760, 557, 633, 1227, 615, 205]
epoch_acc: 98.87
___Test Local_Simple poisoned: True, epoch: 319: Average loss: 13.1714, Accuracy: 22/8968 (0.2453%)
Done in 63.281917095184326 sec.
Server Epoch:320 choose agents : [32, 55, 56, 6, 66, 28, 35, 47, 69, 90].
___Train Local_Simple,  epoch 320, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 955/977 (97.7482%)
___Train Local_Simple,  epoch 320, local model 32, internal_epoch   2,  Average loss: 0.0008, Accuracy: 963/977 (98.5670%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.2220, Accuracy: 9293/10000 (92.9300%)
___Train Local_Simple,  epoch 320, local model 55, internal_epoch   1,  Average loss: 0.0005, Accuracy: 347/354 (98.0226%)
___Train Local_Simple,  epoch 320, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 352/354 (99.4350%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.2739, Accuracy: 9199/10000 (91.9900%)
___Train Local_Simple,  epoch 320, local model 56, internal_epoch   1,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Train Local_Simple,  epoch 320, local model 56, internal_epoch   2,  Average loss: 0.0000, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.0532, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 320, local model 6, internal_epoch   1,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 320, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.0456, Accuracy: 9856/10000 (98.5600%)
___Train Local_Simple,  epoch 320, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch 320, local model 66, internal_epoch   2,  Average loss: 0.0004, Accuracy: 654/660 (99.0909%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.1386, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch 320, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 320, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.0466, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 320, local model 35, internal_epoch   1,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch 320, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.0634, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch 320, local model 47, internal_epoch   1,  Average loss: 0.0006, Accuracy: 762/776 (98.1959%)
___Train Local_Simple,  epoch 320, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.1363, Accuracy: 9621/10000 (96.2100%)
___Train Local_Simple,  epoch 320, local model 69, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 320, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.1188, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch 320, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 320, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.2005, Accuracy: 9440/10000 (94.4000%)
time spent on training: 29.334442615509033
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [-5.6546181e-05  8.3323568e-05  1.8418478e-03 ...  1.8633306e-03
  3.1956732e-03  5.6130439e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 7, 9]
layer1_inf_time: 4.633544921875
Num data points: [977, 354, 880, 615, 660, 501, 499, 776, 256, 683]
Num selected data points: [354 880 615 501 499 256 683]
The chosen ones are users: [1, 2, 3, 5, 6, 8, 9], which are global users: [55, 56, 6, 28, 35, 69, 90]
___Test Local_Simple poisoned: False, epoch: 320: Average loss: 0.0358, Accuracy: 9886/10000 (98.8600%)
[PAIRWISE] pred_attackers_indx:  [0 1 7]
layer2_inf_t: 990.547607421875
assumed final_attacker_idxs:  [0 1 4 7 9]
final_attacker_idxs is: [0 1 4 7 9]
g_attacker_idxs: [32 55 66 47 90]
g_normal_idxs: [56  6 28 35 69]
filtered_attacker_idxs: [0, 4, 7]
final_attacker_idxs are: [0, 4, 7]
num_dps: [977, 354, 880, 615, 660, 501, 499, 776, 256, 683]
epoch_acc: 98.86
___Test Local_Simple poisoned: True, epoch: 320: Average loss: 14.4546, Accuracy: 11/8968 (0.1227%)
Done in 50.808932065963745 sec.
Server Epoch:321 choose agents : [90, 6, 47, 93, 7, 91, 16, 4, 81, 53].
___Train Local_Simple,  epoch 321, local model 90, internal_epoch   1,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 321, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.0424, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch 321, local model 6, internal_epoch   1,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Train Local_Simple,  epoch 321, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.0418, Accuracy: 9861/10000 (98.6100%)
___Train Local_Simple,  epoch 321, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 768/776 (98.9691%)
___Train Local_Simple,  epoch 321, local model 47, internal_epoch   2,  Average loss: 0.0006, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.1802, Accuracy: 9498/10000 (94.9800%)
poison local model 93 index 0
___Train Local_Simple,  epoch 321, local model 93, internal_epoch   1,  Average loss: 0.0007, Accuracy: 616/623 (98.8764%)
___Train Local_Simple,  epoch 321, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.4304, Accuracy: 8891/10000 (88.9100%)
poison local model 7 index 1
___Train Local_Simple,  epoch 321, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 321, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 415/418 (99.2823%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.2479, Accuracy: 9316/10000 (93.1600%)
poison local model 91 index 2
___Train Local_Simple,  epoch 321, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 321, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.0378, Accuracy: 9890/10000 (98.9000%)
poison local model 16 index 3
___Train Local_Simple,  epoch 321, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 902/915 (98.5792%)
___Train Local_Simple,  epoch 321, local model 16, internal_epoch   2,  Average loss: 0.0003, Accuracy: 909/915 (99.3443%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.0676, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch 321, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 651/658 (98.9362%)
___Train Local_Simple,  epoch 321, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.1821, Accuracy: 9497/10000 (94.9700%)
poison local model 81 index 0
___Train Local_Simple,  epoch 321, local model 81, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1221/1227 (99.5110%)
___Train Local_Simple,  epoch 321, local model 81, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1206/1227 (98.2885%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.3407, Accuracy: 9191/10000 (91.9100%)
___Train Local_Simple,  epoch 321, local model 53, internal_epoch   1,  Average loss: 0.0004, Accuracy: 734/739 (99.3234%)
___Train Local_Simple,  epoch 321, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.2466, Accuracy: 9338/10000 (93.3800%)
time spent on training: 70.1781415939331
Starting performing KrMLRFL...
Num data points: [683, 615, 776, 623, 418, 256, 915, 658, 1227, 739]
Num selected data points: [683 615 256]
The chosen ones are users: [0, 1, 5], which are global users: [90, 6, 91]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93, 7, 91, 16, 81]
base_p: [ 6.9573149e-04  1.6440079e-04 -7.1358867e-05 ... -3.8856119e-03
 -3.0106455e-03  6.3423812e-04]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 6, 7, 8, 9]
layer1_inf_time: 4.14501953125
[PAIRWISE] pred_attackers_indx:  [2 3 6 7 8 9]
layer2_inf_t: 38.845458984375
assumed final_attacker_idxs:  [2 3 4 6 7 8 9]
final_attacker_idxs is: [2 3 4 6 7 8 9]
g_attacker_idxs: [47 93  7 16  4 81 53]
g_normal_idxs: [90  6 91]
filtered_attacker_idxs: [2, 3, 4, 6, 7, 8, 9]
final_attacker_idxs are: [2, 3, 4, 6, 7, 8, 9]
num_dps: [683, 615, 776, 623, 418, 256, 915, 658, 1227, 739]
epoch_acc: 98.8
___Test Local_Simple poisoned: False, epoch: 321: Average loss: 0.0356, Accuracy: 9880/10000 (98.8000%)
___Test Local_Simple poisoned: True, epoch: 321: Average loss: 14.2075, Accuracy: 12/8968 (0.1338%)
Done in 74.08078908920288 sec.
Server Epoch:322 choose agents : [77, 64, 26, 15, 73, 65, 76, 28, 90, 57].
___Train Local_Simple,  epoch 322, local model 77, internal_epoch   1,  Average loss: 0.0009, Accuracy: 582/589 (98.8115%)
___Train Local_Simple,  epoch 322, local model 77, internal_epoch   2,  Average loss: 0.0005, Accuracy: 585/589 (99.3209%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0713, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch 322, local model 64, internal_epoch   1,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Train Local_Simple,  epoch 322, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0874, Accuracy: 9707/10000 (97.0700%)
poison local model 26 index 0
___Train Local_Simple,  epoch 322, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 322, local model 26, internal_epoch   2,  Average loss: 0.0005, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.1428, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch 322, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 322, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0328, Accuracy: 9889/10000 (98.8900%)
poison local model 73 index 1
___Train Local_Simple,  epoch 322, local model 73, internal_epoch   1,  Average loss: 0.0008, Accuracy: 585/591 (98.9848%)
___Train Local_Simple,  epoch 322, local model 73, internal_epoch   2,  Average loss: 0.0008, Accuracy: 583/591 (98.6464%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.1002, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch 322, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 322, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0459, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 322, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 322, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0334, Accuracy: 9886/10000 (98.8600%)
___Train Local_Simple,  epoch 322, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 322, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0381, Accuracy: 9886/10000 (98.8600%)
___Train Local_Simple,  epoch 322, local model 90, internal_epoch   1,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 322, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0420, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 322, local model 57, internal_epoch   1,  Average loss: 0.0005, Accuracy: 340/343 (99.1254%)
___Train Local_Simple,  epoch 322, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 341/343 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0951, Accuracy: 9724/10000 (97.2400%)
time spent on training: 50.13386273384094
Starting performing KrMLRFL...
Num data points: [589, 813, 554, 401, 591, 371, 78, 501, 683, 343]
Num selected data points: [813 401 371  78 501 683 343]
The chosen ones are users: [1, 3, 5, 6, 7, 8, 9], which are global users: [64, 15, 65, 76, 28, 90, 57]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 73]
base_p: [-0.00073088  0.00017675  0.00017485 ... -0.00022171 -0.00154012
 -0.00041155]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 9]
layer1_inf_time: 4.523193359375
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 805.302978515625
assumed final_attacker_idxs:  [0 1 2 4 9]
final_attacker_idxs is: [0 1 2 4 9]
g_attacker_idxs: [77 64 26 73 57]
g_normal_idxs: [15 65 76 28 90]
filtered_attacker_idxs: [0, 2, 4]
final_attacker_idxs are: [0, 2, 4]
num_dps: [589, 813, 554, 401, 591, 371, 78, 501, 683, 343]
___Test Local_Simple poisoned: False, epoch: 322: Average loss: 0.0277, Accuracy: 9916/10000 (99.1600%)
epoch_acc: 99.16
___Test Local_Simple poisoned: True, epoch: 322: Average loss: 14.1807, Accuracy: 13/8968 (0.1450%)
Done in 66.18293857574463 sec.
Server Epoch:323 choose agents : [71, 65, 10, 69, 85, 97, 64, 44, 33, 29].
poison local model 71 index 0
___Train Local_Simple,  epoch 323, local model 71, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1378/1384 (99.5665%)
___Train Local_Simple,  epoch 323, local model 71, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1380/1384 (99.7110%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0905, Accuracy: 9715/10000 (97.1500%)
___Train Local_Simple,  epoch 323, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Train Local_Simple,  epoch 323, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0486, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 323, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 323, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0979, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch 323, local model 69, internal_epoch   1,  Average loss: 0.0003, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 323, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0857, Accuracy: 9720/10000 (97.2000%)
poison local model 85 index 1
___Train Local_Simple,  epoch 323, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 323, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0415, Accuracy: 9872/10000 (98.7200%)
___Train Local_Simple,  epoch 323, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 323, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0471, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 323, local model 64, internal_epoch   1,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Train Local_Simple,  epoch 323, local model 64, internal_epoch   2,  Average loss: 0.0000, Accuracy: 813/813 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0426, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 323, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 515/517 (99.6132%)
___Train Local_Simple,  epoch 323, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 515/517 (99.6132%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0491, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 323, local model 33, internal_epoch   1,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%)
___Train Local_Simple,  epoch 323, local model 33, internal_epoch   2,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0324, Accuracy: 9891/10000 (98.9100%)
___Train Local_Simple,  epoch 323, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 323, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0585, Accuracy: 9804/10000 (98.0400%)
time spent on training: 89.87139415740967
Starting performing KrMLRFL...
Num data points: [1384, 371, 892, 256, 431, 487, 813, 517, 623, 1002]
Num selected data points: [371 892 256 487 813 517 623]
The chosen ones are users: [1, 2, 3, 5, 6, 7, 8], which are global users: [65, 10, 69, 97, 64, 44, 33]
___Test Local_Simple poisoned: False, epoch: 323: Average loss: 0.0289, Accuracy: 9909/10000 (99.0900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 85]
base_p: [2.0994619e-04 1.1387095e-04 4.9615279e-05 ... 1.1157840e-03 1.0520443e-03
 1.6758591e-04]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 7, 9]
layer1_inf_time: 3.76123046875
[PAIRWISE] pred_attackers_indx:  [1 2 3 5 8 9]
layer2_inf_t: 36.391845703125
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 8 9]
g_attacker_idxs: [71 65 10 69 85 97 64 44 33 29]
g_normal_idxs: []
filtered_attacker_idxs: [0, 4, 9]
final_attacker_idxs are: [0, 4, 9]
num_dps: [1384, 371, 892, 256, 431, 487, 813, 517, 623, 1002]
epoch_acc: 99.09
___Test Local_Simple poisoned: True, epoch: 323: Average loss: 15.0422, Accuracy: 5/8968 (0.0558%)
Done in 117.4010922908783 sec.
Server Epoch:324 choose agents : [26, 12, 32, 61, 42, 9, 97, 59, 63, 18].
poison local model 26 index 0
___Train Local_Simple,  epoch 324, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch 324, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.0597, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch 324, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1134/1160 (97.7586%)
___Train Local_Simple,  epoch 324, local model 12, internal_epoch   2,  Average loss: 0.0016, Accuracy: 1122/1160 (96.7241%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.7201, Accuracy: 8608/10000 (86.0800%)
___Train Local_Simple,  epoch 324, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 963/977 (98.5670%)
___Train Local_Simple,  epoch 324, local model 32, internal_epoch   2,  Average loss: 0.0007, Accuracy: 965/977 (98.7718%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.1982, Accuracy: 9441/10000 (94.4100%)
poison local model 61 index 1
___Train Local_Simple,  epoch 324, local model 61, internal_epoch   1,  Average loss: 0.0012, Accuracy: 685/699 (97.9971%)
___Train Local_Simple,  epoch 324, local model 61, internal_epoch   2,  Average loss: 0.0009, Accuracy: 689/699 (98.5694%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.2893, Accuracy: 8950/10000 (89.5000%)
poison local model 42 index 2
___Train Local_Simple,  epoch 324, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 324, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.0453, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 324, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 324, local model 9, internal_epoch   2,  Average loss: 0.0002, Accuracy: 434/436 (99.5413%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.0426, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 324, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 324, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.0362, Accuracy: 9879/10000 (98.7900%)
___Train Local_Simple,  epoch 324, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 324, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.2457, Accuracy: 9259/10000 (92.5900%)
poison local model 63 index 3
___Train Local_Simple,  epoch 324, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 869/889 (97.7503%)
___Train Local_Simple,  epoch 324, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 877/889 (98.6502%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.0846, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch 324, local model 18, internal_epoch   1,  Average loss: 0.0001, Accuracy: 457/459 (99.5643%)
___Train Local_Simple,  epoch 324, local model 18, internal_epoch   2,  Average loss: 0.0001, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.1206, Accuracy: 9651/10000 (96.5100%)
time spent on training: 86.51161026954651
Starting performing KrMLRFL...
Num data points: [554, 1160, 977, 699, 236, 436, 487, 760, 889, 459]
Num selected data points: [236 436 487 459]
The chosen ones are users: [4, 5, 6, 9], which are global users: [42, 9, 97, 18]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 61, 42, 63]
base_p: [ 6.91376626e-05 -7.76089728e-05  1.07137486e-04 ... -2.14135647e-03
 -4.90248203e-04  1.83415413e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 7, 8]
layer1_inf_time: 3.35107421875
[PAIRWISE] pred_attackers_indx:  [1 2 3 8]
layer2_inf_t: 483.33349609375
assumed final_attacker_idxs:  [0 1 2 3 7 8]
final_attacker_idxs is: [0 1 2 3 7 8]
g_attacker_idxs: [26 12 32 61 59 63]
g_normal_idxs: [42  9 97 18]
filtered_attacker_idxs: [0, 1, 2, 3, 7, 8]
final_attacker_idxs are: [0, 1, 2, 3, 7, 8]
num_dps: [554, 1160, 977, 699, 236, 436, 487, 760, 889, 459]
___Test Local_Simple poisoned: False, epoch: 324: Average loss: 0.0348, Accuracy: 9881/10000 (98.8100%)
epoch_acc: 98.81
___Test Local_Simple poisoned: True, epoch: 324: Average loss: 15.1343, Accuracy: 4/8968 (0.0446%)
Done in 99.39505648612976 sec.
Server Epoch:325 choose agents : [67, 90, 9, 43, 75, 33, 22, 15, 23, 54].
___Train Local_Simple,  epoch 325, local model 67, internal_epoch   1,  Average loss: 0.0006, Accuracy: 987/998 (98.8978%)
___Train Local_Simple,  epoch 325, local model 67, internal_epoch   2,  Average loss: 0.0005, Accuracy: 989/998 (99.0982%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.2210, Accuracy: 9304/10000 (93.0400%)
___Train Local_Simple,  epoch 325, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 325, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0711, Accuracy: 9774/10000 (97.7400%)
___Train Local_Simple,  epoch 325, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 325, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0533, Accuracy: 9831/10000 (98.3100%)
___Train Local_Simple,  epoch 325, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 407/408 (99.7549%)
___Train Local_Simple,  epoch 325, local model 43, internal_epoch   2,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0429, Accuracy: 9867/10000 (98.6700%)
___Train Local_Simple,  epoch 325, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 686/686 (100.0000%)
___Train Local_Simple,  epoch 325, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0479, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 325, local model 33, internal_epoch   1,  Average loss: 0.0001, Accuracy: 623/623 (100.0000%)
___Train Local_Simple,  epoch 325, local model 33, internal_epoch   2,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0466, Accuracy: 9857/10000 (98.5700%)
poison local model 22 index 0
___Train Local_Simple,  epoch 325, local model 22, internal_epoch   1,  Average loss: 0.0010, Accuracy: 575/583 (98.6278%)
___Train Local_Simple,  epoch 325, local model 22, internal_epoch   2,  Average loss: 0.0006, Accuracy: 576/583 (98.7993%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.2592, Accuracy: 9177/10000 (91.7700%)
___Train Local_Simple,  epoch 325, local model 15, internal_epoch   1,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 325, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0326, Accuracy: 9895/10000 (98.9500%)
___Train Local_Simple,  epoch 325, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch 325, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0715, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch 325, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch 325, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 517/519 (99.6146%)
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.1130, Accuracy: 9617/10000 (96.1700%)
time spent on training: 36.3425190448761
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22]
base_p: [ 5.6184828e-05  2.5114045e-04 -1.7461088e-04 ... -2.5887787e-04
 -3.5106018e-03 -1.4673620e-03]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 7, 9]
layer1_inf_time: 2.9716796875
[PAIRWISE] pred_attackers_indx:  [6]
layer2_inf_t: 28.794677734375
assumed final_attacker_idxs:  [0 4 6 7 9]
final_attacker_idxs is: [0 4 6 7 9]
g_attacker_idxs: [67 75 22 15 54]
g_normal_idxs: [90  9 43 33 23]
filtered_attacker_idxs: [0, 6]
final_attacker_idxs are: [0, 6]
num_dps: [998, 683, 436, 408, 686, 623, 583, 401, 293, 519]
Starting performing KrMLRFL...
Num data points: [998, 683, 436, 408, 686, 623, 583, 401, 293, 519]
Num selected data points: [683 436 408 686 623 401 293 519]
The chosen ones are users: [1, 2, 3, 4, 5, 7, 8, 9], which are global users: [90, 9, 43, 75, 33, 15, 23, 54]
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: False, epoch: 325: Average loss: 0.0306, Accuracy: 9901/10000 (99.0100%)
___Test Local_Simple poisoned: True, epoch: 325: Average loss: 15.4145, Accuracy: 5/8968 (0.0558%)
Done in 71.12019348144531 sec.
Server Epoch:326 choose agents : [15, 74, 90, 52, 33, 99, 39, 80, 49, 94].
___Train Local_Simple,  epoch 326, local model 15, internal_epoch   1,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Train Local_Simple,  epoch 326, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0307, Accuracy: 9898/10000 (98.9800%)
___Train Local_Simple,  epoch 326, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%)
___Train Local_Simple,  epoch 326, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0697, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch 326, local model 90, internal_epoch   1,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 326, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0444, Accuracy: 9860/10000 (98.6000%)
poison local model 52 index 0
___Train Local_Simple,  epoch 326, local model 52, internal_epoch   1,  Average loss: 0.0003, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch 326, local model 52, internal_epoch   2,  Average loss: 0.0003, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.1108, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch 326, local model 33, internal_epoch   1,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Train Local_Simple,  epoch 326, local model 33, internal_epoch   2,  Average loss: 0.0000, Accuracy: 623/623 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0370, Accuracy: 9880/10000 (98.8000%)
___Train Local_Simple,  epoch 326, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch 326, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 374/377 (99.2042%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0501, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 326, local model 39, internal_epoch   1,  Average loss: 0.0001, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch 326, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0433, Accuracy: 9868/10000 (98.6800%)
___Train Local_Simple,  epoch 326, local model 80, internal_epoch   1,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 326, local model 80, internal_epoch   2,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0399, Accuracy: 9876/10000 (98.7600%)
___Train Local_Simple,  epoch 326, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Train Local_Simple,  epoch 326, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0390, Accuracy: 9877/10000 (98.7700%)
___Train Local_Simple,  epoch 326, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 326, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.1544, Accuracy: 9455/10000 (94.5500%)
time spent on training: 45.7904372215271
Starting performing KrMLRFL...
Num data points: [401, 557, 683, 253, 623, 377, 257, 431, 506, 150]
Num selected data points: [401 557 683 623 377 257 431 150]
The chosen ones are users: [0, 1, 2, 4, 5, 6, 7, 9], which are global users: [15, 74, 90, 33, 99, 39, 80, 94]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00023805  0.0001292   0.00010292 ... -0.00214072 -0.000717
  0.000557  ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 7]
layer1_inf_time: 3.177734375
[PAIRWISE] pred_attackers_indx:  [3 7 8]
layer2_inf_t: 29.67578125
assumed final_attacker_idxs:  [0 1 3 4 7 8]
final_attacker_idxs is: [0 1 3 4 7 8]
g_attacker_idxs: [15 74 52 33 80 49]
g_normal_idxs: [90 99 39 94]
filtered_attacker_idxs: [3, 8]
final_attacker_idxs are: [3, 8]
num_dps: [401, 557, 683, 253, 623, 377, 257, 431, 506, 150]
epoch_acc: 99.03999999999999
___Test Local_Simple poisoned: False, epoch: 326: Average loss: 0.0292, Accuracy: 9904/10000 (99.0400%)
___Test Local_Simple poisoned: True, epoch: 326: Average loss: 15.0838, Accuracy: 8/8968 (0.0892%)
Done in 58.71756362915039 sec.
Server Epoch:327 choose agents : [76, 42, 13, 44, 84, 34, 38, 74, 63, 53].
___Train Local_Simple,  epoch 327, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 327, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.0289, Accuracy: 9905/10000 (99.0500%)
poison local model 42 index 0
___Train Local_Simple,  epoch 327, local model 42, internal_epoch   1,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%)
___Train Local_Simple,  epoch 327, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.0475, Accuracy: 9842/10000 (98.4200%)
poison local model 13 index 1
___Train Local_Simple,  epoch 327, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 728/734 (99.1826%)
___Train Local_Simple,  epoch 327, local model 13, internal_epoch   2,  Average loss: 0.0013, Accuracy: 718/734 (97.8202%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.2604, Accuracy: 9208/10000 (92.0800%)
___Train Local_Simple,  epoch 327, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 517/517 (100.0000%)
___Train Local_Simple,  epoch 327, local model 44, internal_epoch   2,  Average loss: 0.0024, Accuracy: 496/517 (95.9381%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.1115, Accuracy: 9685/10000 (96.8500%)
___Train Local_Simple,  epoch 327, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1231/1246 (98.7961%)
___Train Local_Simple,  epoch 327, local model 84, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1224/1246 (98.2343%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.1245, Accuracy: 9606/10000 (96.0600%)
poison local model 34 index 2
___Train Local_Simple,  epoch 327, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 327, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.2378, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch 327, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%)
___Train Local_Simple,  epoch 327, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.0716, Accuracy: 9782/10000 (97.8200%)
___Train Local_Simple,  epoch 327, local model 74, internal_epoch   1,  Average loss: 0.0001, Accuracy: 555/557 (99.6409%)
___Train Local_Simple,  epoch 327, local model 74, internal_epoch   2,  Average loss: 0.0000, Accuracy: 557/557 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.0620, Accuracy: 9803/10000 (98.0300%)
poison local model 63 index 3
___Train Local_Simple,  epoch 327, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 872/889 (98.0877%)
___Train Local_Simple,  epoch 327, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 875/889 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.0553, Accuracy: 9821/10000 (98.2100%)
___Train Local_Simple,  epoch 327, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 733/739 (99.1881%)
___Train Local_Simple,  epoch 327, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.3459, Accuracy: 9083/10000 (90.8300%)
time spent on training: 84.83513402938843
Starting performing KrMLRFL...
Num data points: [78, 236, 734, 517, 1246, 413, 895, 557, 889, 739]
Num selected data points: [ 78 236 517 413 895 557]
The chosen ones are users: [0, 1, 3, 5, 6, 7], which are global users: [76, 42, 44, 34, 38, 74]
___Test Local_Simple poisoned: False, epoch: 327: Average loss: 0.0385, Accuracy: 9869/10000 (98.6900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 13, 34, 63]
base_p: [ 1.4078245e-03 -5.9323385e-05  7.8187604e-04 ... -2.6420504e-03
  2.5402606e-03  1.1772960e-03]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 8, 9]
layer1_inf_time: 3.30419921875
[PAIRWISE] pred_attackers_indx:  [2 4]
layer2_inf_t: 31.02783203125
assumed final_attacker_idxs:  [2 3 4 8 9]
final_attacker_idxs is: [2 3 4 8 9]
g_attacker_idxs: [13 44 84 63 53]
g_normal_idxs: [76 42 34 38 74]
filtered_attacker_idxs: [2, 4, 8, 9]
final_attacker_idxs are: [2, 4, 8, 9]
num_dps: [78, 236, 734, 517, 1246, 413, 895, 557, 889, 739]
epoch_acc: 98.69
___Test Local_Simple poisoned: True, epoch: 327: Average loss: 14.0567, Accuracy: 10/8968 (0.1115%)
Done in 109.26894855499268 sec.
Server Epoch:328 choose agents : [66, 64, 38, 88, 34, 30, 32, 1, 29, 63].
___Train Local_Simple,  epoch 328, local model 66, internal_epoch   1,  Average loss: 0.0013, Accuracy: 644/660 (97.5758%)
___Train Local_Simple,  epoch 328, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 655/660 (99.2424%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.5053, Accuracy: 8392/10000 (83.9200%)
___Train Local_Simple,  epoch 328, local model 64, internal_epoch   1,  Average loss: 0.0006, Accuracy: 801/813 (98.5240%)
___Train Local_Simple,  epoch 328, local model 64, internal_epoch   2,  Average loss: 0.0005, Accuracy: 804/813 (98.8930%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.1785, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch 328, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%)
___Train Local_Simple,  epoch 328, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.0495, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 328, local model 88, internal_epoch   1,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Train Local_Simple,  epoch 328, local model 88, internal_epoch   2,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.1870, Accuracy: 9512/10000 (95.1200%)
poison local model 34 index 0
___Train Local_Simple,  epoch 328, local model 34, internal_epoch   1,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%)
___Train Local_Simple,  epoch 328, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.0666, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch 328, local model 30, internal_epoch   1,  Average loss: 0.0003, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch 328, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 399/400 (99.7500%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.3772, Accuracy: 8935/10000 (89.3500%)
___Train Local_Simple,  epoch 328, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 962/977 (98.4647%)
___Train Local_Simple,  epoch 328, local model 32, internal_epoch   2,  Average loss: 0.0014, Accuracy: 956/977 (97.8506%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.2291, Accuracy: 9235/10000 (92.3500%)
poison local model 1 index 1
___Train Local_Simple,  epoch 328, local model 1, internal_epoch   1,  Average loss: 0.0011, Accuracy: 739/760 (97.2368%)
___Train Local_Simple,  epoch 328, local model 1, internal_epoch   2,  Average loss: 0.0015, Accuracy: 737/760 (96.9737%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.2879, Accuracy: 9040/10000 (90.4000%)
___Train Local_Simple,  epoch 328, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 999/1002 (99.7006%)
___Train Local_Simple,  epoch 328, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 995/1002 (99.3014%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.1017, Accuracy: 9676/10000 (96.7600%)
poison local model 63 index 2
___Train Local_Simple,  epoch 328, local model 63, internal_epoch   1,  Average loss: 0.0012, Accuracy: 871/889 (97.9753%)
___Train Local_Simple,  epoch 328, local model 63, internal_epoch   2,  Average loss: 0.0013, Accuracy: 873/889 (98.2002%)
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.0878, Accuracy: 9727/10000 (97.2700%)
time spent on training: 88.187579870224
Starting performing KrMLRFL...
Num data points: [660, 813, 895, 530, 413, 400, 977, 760, 1002, 889]
Num selected data points: [813 895 530 413 400]
The chosen ones are users: [1, 2, 3, 4, 5], which are global users: [64, 38, 88, 34, 30]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 1, 63]
base_p: [ 0.00117027  0.00059128 -0.001685   ...  0.00104818 -0.00296041
  0.00019618]
[T_SCORE] attacker_local_idxs is:  [0, 1, 6, 7, 9]
layer1_inf_time: 3.120849609375
[PAIRWISE] pred_attackers_indx:  [0 1 7 8]
layer2_inf_t: 168.52294921875
assumed final_attacker_idxs:  [0 1 6 7 8 9]
final_attacker_idxs is: [0 1 6 7 8 9]
g_attacker_idxs: [66 64 32  1 29 63]
g_normal_idxs: [38 88 34 30]
filtered_attacker_idxs: [0, 6, 7, 8, 9]
final_attacker_idxs are: [0, 6, 7, 8, 9]
num_dps: [660, 813, 895, 530, 413, 400, 977, 760, 1002, 889]
___Test Local_Simple poisoned: False, epoch: 328: Average loss: 0.0386, Accuracy: 9875/10000 (98.7500%)
epoch_acc: 98.75
___Test Local_Simple poisoned: True, epoch: 328: Average loss: 13.1945, Accuracy: 21/8968 (0.2342%)
Done in 98.14809727668762 sec.
Server Epoch:329 choose agents : [83, 86, 20, 62, 76, 92, 95, 42, 30, 72].
___Train Local_Simple,  epoch 329, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch 329, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.0464, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 329, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Train Local_Simple,  epoch 329, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.0510, Accuracy: 9843/10000 (98.4300%)
poison local model 20 index 0
___Train Local_Simple,  epoch 329, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 419/429 (97.6690%)
___Train Local_Simple,  epoch 329, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.4056, Accuracy: 8977/10000 (89.7700%)
___Train Local_Simple,  epoch 329, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 329, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.0435, Accuracy: 9853/10000 (98.5300%)
___Train Local_Simple,  epoch 329, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 329, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.0389, Accuracy: 9874/10000 (98.7400%)
___Train Local_Simple,  epoch 329, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 329, local model 92, internal_epoch   2,  Average loss: 0.0009, Accuracy: 923/937 (98.5059%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.2126, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch 329, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 601/602 (99.8339%)
___Train Local_Simple,  epoch 329, local model 95, internal_epoch   2,  Average loss: 0.0003, Accuracy: 598/602 (99.3355%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.0888, Accuracy: 9720/10000 (97.2000%)
poison local model 42 index 1
___Train Local_Simple,  epoch 329, local model 42, internal_epoch   1,  Average loss: 0.0003, Accuracy: 236/236 (100.0000%)
___Train Local_Simple,  epoch 329, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 329: Average loss: 0.0644, Accuracy: 9805/10000 (98.0500%)
Traceback (most recent call last):
  File "dba.py", line 181, in <module>
    epochs_submit_update_dict, num_samples_dict, net_list = train.train(helper=helper, start_epoch=epoch,
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/train.py", line 23, in train
    epochs_submit_update_dict, num_samples_dict, net_list = image_train.ImageTrain(helper, start_epoch, local_model,
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/image_train.py", line 305, in ImageTrain
    test.Mytest_poison_agent_trigger(helper=helper, model=model, agent_name_key=agent_name_key)
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/test.py", line 222, in Mytest_poison_agent_trigger
    data, targets, poison_num = helper.get_poison_batch(batch, adversarial_index=adv_index, evaluation=True)
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/image_helper.py", line 310, in get_poison_batch
    new_images[index] = self.add_pixel_pattern(images[index],adversarial_index)
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/image_helper.py", line 330, in add_pixel_pattern
    image = copy.deepcopy(ori_image)
  File "/home/ubuntu/miniconda3/envs/dungnt/lib/python3.8/copy.py", line 153, in deepcopy
    y = copier(memo)
  File "/home/ubuntu/miniconda3/envs/dungnt/lib/python3.8/site-packages/torch/_tensor.py", line 150, in __deepcopy__
    if self.is_conj():
KeyboardInterrupt