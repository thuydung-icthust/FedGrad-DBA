current path: saved_models/model_mnist_Oct.05_02.36.36
Loading data
build_classes_dict done
train loaders done
get poison test loader
Starting performing KrMLRFL...
load data done
Loaded parameters from saved model: LR is 0.1 and current epoch is 11
create model done
Poisoned following participants: [41, 73, 51, 74]
We use following environment for graphs:  mnist_DBA
Server Epoch:11 choose agents : [23, 72, 61, 11, 71, 42, 45, 37, 21, 35].
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 289/293 (98.6348%)
___Train Local_Simple,  epoch  11, local model 23, internal_epoch   2,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1097, Accuracy: 9646/10000 (96.4600%)
___Train Local_Simple,  epoch  11, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 719/731 (98.3584%)
___Train Local_Simple,  epoch  11, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2988, Accuracy: 8998/10000 (89.9800%)
poison local model 61 index 0
___PoisonTrain Local_Simple ,  epoch  11, local model 61, internal_epoch   1,  Average loss: 0.0211, Accuracy: 427/699 (61.0873%), train_poison_data_count: 220
___PoisonTrain Local_Simple ,  epoch  11, local model 61, internal_epoch   2,  Average loss: 0.0117, Accuracy: 456/699 (65.2361%), train_poison_data_count: 220
Global model norm: 16.539532092117113.
Norm before scaling: 16.71508246864471. Distance: 4.268344333748208
Total norm for 5 adversaries is: 16.71508246864471. distance: 4.268344333748208
class_loss: 3.5104146003723145, distance_loss: 0.0
class_loss: 1.8648605346679688, distance_loss: 0.3162311911582947
class_loss: 1.1312787532806396, distance_loss: 0.7744445204734802
class_loss: 1.1551026105880737, distance_loss: 1.1992974281311035
class_loss: 1.1223413944244385, distance_loss: 1.5319246053695679
class_loss: 1.1552973985671997, distance_loss: 1.8200098276138306
class_loss: 0.9727140665054321, distance_loss: 2.0811071395874023
class_loss: 0.9655166864395142, distance_loss: 2.3258538246154785
class_loss: 0.9581470489501953, distance_loss: 2.5514469146728516
class_loss: 0.8991203904151917, distance_loss: 2.761491060256958
class_loss: 0.9833215475082397, distance_loss: 2.9537038803100586
class_loss: 0.7647413611412048, distance_loss: 3.1338162422180176
class_loss: 0.822985827922821, distance_loss: 3.299034357070923
class_loss: 0.8584277033805847, distance_loss: 3.4473769664764404
class_loss: 0.6633390784263611, distance_loss: 3.5703072547912598
class_loss: 0.7161194086074829, distance_loss: 3.684647560119629
class_loss: 0.6452230215072632, distance_loss: 3.7905874252319336
class_loss: 0.8104362487792969, distance_loss: 3.8859505653381348
class_loss: 0.8298175930976868, distance_loss: 3.972400665283203
class_loss: 0.6129509806632996, distance_loss: 4.05469274520874
class_loss: 0.732403039932251, distance_loss: 4.1317219734191895
class_loss: 0.6955286860466003, distance_loss: 4.202526092529297
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.9907, Accuracy: 4928/8968 (54.9509%)
poison local model 11 index 1
___PoisonTrain Local_Simple ,  epoch  11, local model 11, internal_epoch   1,  Average loss: 0.0322, Accuracy: 278/645 (43.1008%), train_poison_data_count: 205
class_loss: 4.539518356323242, distance_loss: 0.0
class_loss: 2.417982816696167, distance_loss: 0.3524917960166931
class_loss: 1.4732260704040527, distance_loss: 0.8848463296890259
class_loss: 1.7820674180984497, distance_loss: 1.4030033349990845
class_loss: 1.670753002166748, distance_loss: 1.8188773393630981
class_loss: 1.6887736320495605, distance_loss: 2.178250312805176
class_loss: 1.69856858253479, distance_loss: 2.496901273727417
class_loss: 1.6251591444015503, distance_loss: 2.78171706199646
class_loss: 1.5262686014175415, distance_loss: 3.03717303276062
class_loss: 1.4118624925613403, distance_loss: 3.267648220062256
class_loss: 0.958504855632782, distance_loss: 3.4760050773620605
class_loss: 1.465071201324463, distance_loss: 3.691863536834717
class_loss: 1.4100285768508911, distance_loss: 3.872204542160034
class_loss: 1.0932819843292236, distance_loss: 4.016375541687012
class_loss: 0.9721929430961609, distance_loss: 4.147824287414551
class_loss: 1.0221666097640991, distance_loss: 4.27739143371582
class_loss: 1.0412579774856567, distance_loss: 4.401827812194824
class_loss: 1.0627566576004028, distance_loss: 4.519493103027344
class_loss: 1.1959545612335205, distance_loss: 4.631038665771484
class_loss: 1.1005101203918457, distance_loss: 4.736700057983398
class_loss: 0.9711343050003052, distance_loss: 4.836575508117676
class_loss: 1.1528148651123047, distance_loss: 4.929904937744141
___PoisonTrain Local_Simple ,  epoch  11, local model 11, internal_epoch   2,  Average loss: 0.0194, Accuracy: 327/645 (50.6977%), train_poison_data_count: 205
Global model norm: 16.539532092117113.
Norm before scaling: 16.817764082086036. Distance: 5.0399965825144974
Total norm for 5 adversaries is: 16.817764082086036. distance: 5.0399965825144974
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.5739, Accuracy: 6676/8968 (74.4425%)
poison local model 71 index 2
___PoisonTrain Local_Simple ,  epoch  11, local model 71, internal_epoch   1,  Average loss: 0.0197, Accuracy: 772/1384 (55.7803%), train_poison_data_count: 440
class_loss: 3.6337695121765137, distance_loss: 0.0
class_loss: 1.7928739786148071, distance_loss: 0.41091495752334595
class_loss: 1.7432215213775635, distance_loss: 0.9174676537513733
class_loss: 1.9602717161178589, distance_loss: 1.3058749437332153
class_loss: 1.6159952878952026, distance_loss: 1.6268266439437866
class_loss: 1.4152852296829224, distance_loss: 1.9485597610473633
class_loss: 1.252673864364624, distance_loss: 2.2607614994049072
class_loss: 1.1137242317199707, distance_loss: 2.5523931980133057
class_loss: 1.0592970848083496, distance_loss: 2.824854850769043
class_loss: 0.9669270515441895, distance_loss: 3.0798180103302
class_loss: 1.0418484210968018, distance_loss: 3.315126419067383
class_loss: 0.8774325251579285, distance_loss: 3.5317788124084473
class_loss: 0.9572365880012512, distance_loss: 3.7297279834747314
class_loss: 0.7480521202087402, distance_loss: 3.912001371383667
class_loss: 1.210070252418518, distance_loss: 4.08030366897583
class_loss: 0.8688193559646606, distance_loss: 4.226978778839111
class_loss: 0.8538863062858582, distance_loss: 4.355586051940918
class_loss: 0.7134546041488647, distance_loss: 4.472978591918945
class_loss: 0.7847453355789185, distance_loss: 4.581131458282471
class_loss: 0.9073823094367981, distance_loss: 4.6792426109313965
class_loss: 0.839368462562561, distance_loss: 4.768661975860596
class_loss: 0.9180275797843933, distance_loss: 4.852058410644531
class_loss: 0.7988826632499695, distance_loss: 4.930307865142822
class_loss: 0.8729786276817322, distance_loss: 5.001896858215332
class_loss: 0.7474080324172974, distance_loss: 5.067049503326416
class_loss: 0.8452223539352417, distance_loss: 5.126030445098877
class_loss: 0.8826742172241211, distance_loss: 5.176769256591797
class_loss: 0.8133283853530884, distance_loss: 5.22146463394165
class_loss: 0.5880076885223389, distance_loss: 5.261599063873291
class_loss: 0.6266595125198364, distance_loss: 5.301309108734131
class_loss: 0.623068630695343, distance_loss: 5.338122844696045
class_loss: 0.6974945664405823, distance_loss: 5.374566555023193
class_loss: 0.9617851972579956, distance_loss: 5.406966686248779
class_loss: 0.7908095717430115, distance_loss: 5.437491416931152
class_loss: 0.7230830788612366, distance_loss: 5.467466831207275
class_loss: 0.665288507938385, distance_loss: 5.499298572540283
class_loss: 0.561799943447113, distance_loss: 5.528448104858398
class_loss: 0.7040366530418396, distance_loss: 5.558940410614014
class_loss: 0.5062766075134277, distance_loss: 5.590837001800537
class_loss: 0.5690450668334961, distance_loss: 5.629382133483887
class_loss: 0.3366400897502899, distance_loss: 5.671900749206543
class_loss: 0.39128342270851135, distance_loss: 5.716859340667725
class_loss: 0.3530416488647461, distance_loss: 5.763173580169678
class_loss: 0.17584840953350067, distance_loss: 5.810439109802246
___PoisonTrain Local_Simple ,  epoch  11, local model 71, internal_epoch   2,  Average loss: 0.0103, Accuracy: 960/1384 (69.3642%), train_poison_data_count: 440
Global model norm: 16.539532092117113.
Norm before scaling: 17.159150092145172. Distance: 5.8626045787080905
Total norm for 5 adversaries is: 17.159150092145172. distance: 5.8626045787080905
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 0.0653, Accuracy: 8772/8968 (97.8145%)
poison local model 42 index 3
class_loss: 2.349877119064331, distance_loss: 0.0
class_loss: 1.8577362298965454, distance_loss: 0.2074550986289978
class_loss: 1.2086020708084106, distance_loss: 0.5615610480308533
___PoisonTrain Local_Simple ,  epoch  11, local model 42, internal_epoch   1,  Average loss: 0.0268, Accuracy: 170/236 (72.0339%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  11, local model 42, internal_epoch   2,  Average loss: 0.0194, Accuracy: 137/236 (58.0508%), train_poison_data_count: 80
Global model norm: 16.539532092117113.
Norm before scaling: 16.36239395048951. Distance: 2.296692717708487
Total norm for 5 adversaries is: 16.36239395048951. distance: 2.296692717708487
class_loss: 0.9028346538543701, distance_loss: 0.9584099054336548
class_loss: 1.4102065563201904, distance_loss: 1.3310359716415405
class_loss: 1.1734087467193604, distance_loss: 1.6091365814208984
class_loss: 1.0183321237564087, distance_loss: 1.8585214614868164
class_loss: 0.9719399809837341, distance_loss: 2.087225914001465
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.2262, Accuracy: 5729/8968 (63.8827%)
poison local model 45 index 0
___PoisonTrain Local_Simple ,  epoch  11, local model 45, internal_epoch   1,  Average loss: 0.0274, Accuracy: 339/628 (53.9809%), train_poison_data_count: 200
class_loss: 3.578488826751709, distance_loss: 0.0
class_loss: 1.7760286331176758, distance_loss: 0.3494974374771118
class_loss: 1.6465920209884644, distance_loss: 0.8455685973167419
class_loss: 1.9029271602630615, distance_loss: 1.2382405996322632
class_loss: 1.5572677850723267, distance_loss: 1.5457653999328613
class_loss: 1.4604359865188599, distance_loss: 1.8432897329330444
class_loss: 1.5495833158493042, distance_loss: 2.120497226715088
class_loss: 1.363229513168335, distance_loss: 2.3677480220794678
class_loss: 1.2645347118377686, distance_loss: 2.5944325923919678
class_loss: 1.1343724727630615, distance_loss: 2.8076863288879395
___PoisonTrain Local_Simple ,  epoch  11, local model 45, internal_epoch   2,  Average loss: 0.0151, Accuracy: 347/628 (55.2548%), train_poison_data_count: 200
Global model norm: 16.539532092117113.
Norm before scaling: 16.732985323951088. Distance: 4.363370206330781
Total norm for 5 adversaries is: 16.732985323951088. distance: 4.363370206330781
class_loss: 1.103041648864746, distance_loss: 3.0158886909484863
class_loss: 0.9508664011955261, distance_loss: 3.212510347366333
class_loss: 0.9224571585655212, distance_loss: 3.397196054458618
class_loss: 1.120324969291687, distance_loss: 3.567485809326172
class_loss: 0.8362325429916382, distance_loss: 3.720590829849243
class_loss: 1.0340280532836914, distance_loss: 3.8556265830993652
class_loss: 0.909041166305542, distance_loss: 3.9695332050323486
class_loss: 0.8226180076599121, distance_loss: 4.075804710388184
class_loss: 0.8261398673057556, distance_loss: 4.176437854766846
class_loss: 0.9350726008415222, distance_loss: 4.271108627319336
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 1.3247, Accuracy: 2673/8968 (29.8060%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 842/860 (97.9070%)
___Train Local_Simple,  epoch  11, local model 37, internal_epoch   2,  Average loss: 0.0005, Accuracy: 853/860 (99.1860%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2156, Accuracy: 9342/10000 (93.4200%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   1,  Average loss: 0.0014, Accuracy: 304/312 (97.4359%)
___Train Local_Simple,  epoch  11, local model 21, internal_epoch   2,  Average loss: 0.0007, Accuracy: 307/312 (98.3974%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.2631, Accuracy: 9177/10000 (91.7700%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   1,  Average loss: 0.0006, Accuracy: 492/499 (98.5972%)
___Train Local_Simple,  epoch  11, local model 35, internal_epoch   2,  Average loss: 0.0003, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.3008, Accuracy: 9117/10000 (91.1700%)
time spent on training: 66.63765835762024
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 11, 71, 42, 45]
base_p: [-0.00671703  0.00034668 -0.00212855 ... -0.00301877 -0.01063142
 -0.0004416 ]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 6]
layer1_inf_time: 3.8701171875
[PAIRWISE] pred_attackers_indx:  [2 3 4 5 6]
layer2_inf_t: 370.481689453125
assumed final_attacker_idxs:  [2 3 4 5 6]
final_attacker_idxs is: [2, 3, 4, 5, 6]
g_attacker_idxs: [61 11 71 42 45]
g_normal_idxs: [23 72 37 21 35]
filtered_attacker_idxs: [2, 3, 4, 5, 6]
final_attacker_idxs are: [2, 3, 4, 5, 6]
num_dps: [293, 731, 699, 645, 1384, 236, 628, 860, 312, 499]
Num data points: [293, 731, 699, 645, 1384, 236, 628, 860, 312, 499]
Num selected data points: [293 731 860 312 499]
The chosen ones are users: [0, 1, 7, 8, 9], which are global users: [23, 72, 37, 21, 35]
___Test Local_Simple poisoned: False, epoch: 11: Average loss: 0.1028, Accuracy: 9696/10000 (96.9600%)
epoch_acc: 96.96000000000001
___Test Local_Simple poisoned: True, epoch: 11: Average loss: 11.2643, Accuracy: 83/8968 (0.9255%)
Done in 184.07244038581848 sec.
Server Epoch:12 choose agents : [11, 59, 62, 28, 65, 22, 78, 58, 41, 81].
poison local model 11 index 0
class_loss: 4.106310844421387, distance_loss: 0.0
class_loss: 2.5717718601226807, distance_loss: 0.3223724663257599
class_loss: 1.3433724641799927, distance_loss: 0.8298153877258301
class_loss: 1.812082290649414, distance_loss: 1.2800774574279785
class_loss: 1.364220380783081, distance_loss: 1.6279250383377075
class_loss: 1.277443289756775, distance_loss: 1.9438574314117432
class_loss: 1.4734201431274414, distance_loss: 2.22186017036438
class_loss: 1.4375028610229492, distance_loss: 2.471771717071533
class_loss: 1.3096801042556763, distance_loss: 2.695636034011841
class_loss: 1.265734314918518, distance_loss: 2.8992135524749756
class_loss: 1.03224778175354, distance_loss: 3.085672378540039
___PoisonTrain Local_Simple ,  epoch  12, local model 11, internal_epoch   1,  Average loss: 0.0294, Accuracy: 333/645 (51.6279%), train_poison_data_count: 205
class_loss: 1.4358649253845215, distance_loss: 3.2867588996887207
class_loss: 1.3527376651763916, distance_loss: 3.4649055004119873
class_loss: 1.1773340702056885, distance_loss: 3.6142771244049072
class_loss: 1.3006995916366577, distance_loss: 3.740807294845581
class_loss: 0.9377228021621704, distance_loss: 3.864147186279297
class_loss: 0.9782127737998962, distance_loss: 3.9875035285949707
class_loss: 0.9458617568016052, distance_loss: 4.106528282165527
class_loss: 1.0260545015335083, distance_loss: 4.218362808227539
class_loss: 0.8881100416183472, distance_loss: 4.324559688568115
class_loss: 0.9633525013923645, distance_loss: 4.423313140869141
class_loss: 1.9295345544815063, distance_loss: 4.508269786834717
___PoisonTrain Local_Simple ,  epoch  12, local model 11, internal_epoch   2,  Average loss: 0.0201, Accuracy: 329/645 (51.0078%), train_poison_data_count: 205
Global model norm: 16.48387236348617.
Norm before scaling: 16.66237208667144. Distance: 4.628503864037404
Total norm for 3 adversaries is: 16.66237208667144. distance: 4.628503864037404
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.8213, Accuracy: 6226/8968 (69.4246%)
___Train Local_Simple,  epoch  12, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 735/760 (96.7105%)
___Train Local_Simple,  epoch  12, local model 59, internal_epoch   2,  Average loss: 0.0011, Accuracy: 745/760 (98.0263%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2241, Accuracy: 9272/10000 (92.7200%)
___Train Local_Simple,  epoch  12, local model 62, internal_epoch   1,  Average loss: 0.0014, Accuracy: 412/423 (97.3995%)
___Train Local_Simple,  epoch  12, local model 62, internal_epoch   2,  Average loss: 0.0014, Accuracy: 409/423 (96.6903%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1414, Accuracy: 9520/10000 (95.2000%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   1,  Average loss: 0.0015, Accuracy: 486/501 (97.0060%)
___Train Local_Simple,  epoch  12, local model 28, internal_epoch   2,  Average loss: 0.0009, Accuracy: 492/501 (98.2036%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1615, Accuracy: 9456/10000 (94.5600%)
___Train Local_Simple,  epoch  12, local model 65, internal_epoch   1,  Average loss: 0.0011, Accuracy: 361/371 (97.3046%)
___Train Local_Simple,  epoch  12, local model 65, internal_epoch   2,  Average loss: 0.0005, Accuracy: 367/371 (98.9218%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.5269, Accuracy: 8687/10000 (86.8700%)
poison local model 22 index 1
class_loss: 2.9006412029266357, distance_loss: 0.0
class_loss: 1.6442612409591675, distance_loss: 0.3053530752658844
class_loss: 1.8657267093658447, distance_loss: 0.7398929595947266
class_loss: 1.7550816535949707, distance_loss: 1.0232797861099243
class_loss: 1.3176469802856445, distance_loss: 1.2815446853637695
class_loss: 1.2803401947021484, distance_loss: 1.5904330015182495
class_loss: 1.2313841581344604, distance_loss: 1.8934717178344727
class_loss: 1.3138452768325806, distance_loss: 2.161871910095215
class_loss: 1.07938551902771, distance_loss: 2.4044268131256104
class_loss: 1.5286808013916016, distance_loss: 2.6167938709259033
___PoisonTrain Local_Simple ,  epoch  12, local model 22, internal_epoch   1,  Average loss: 0.0273, Accuracy: 329/583 (56.4322%), train_poison_data_count: 187
___PoisonTrain Local_Simple ,  epoch  12, local model 22, internal_epoch   2,  Average loss: 0.0179, Accuracy: 310/583 (53.1732%), train_poison_data_count: 187
Global model norm: 16.48387236348617.
Norm before scaling: 16.53409452429377. Distance: 4.164067080497012
Total norm for 3 adversaries is: 16.53409452429377. distance: 4.164067080497012
class_loss: 1.0751475095748901, distance_loss: 2.8402578830718994
class_loss: 1.1264594793319702, distance_loss: 3.0442423820495605
class_loss: 0.9522579908370972, distance_loss: 3.2284998893737793
class_loss: 0.9861048460006714, distance_loss: 3.3937838077545166
class_loss: 0.9560892581939697, distance_loss: 3.5346248149871826
class_loss: 1.4454762935638428, distance_loss: 3.6582489013671875
class_loss: 0.8562662601470947, distance_loss: 3.7694549560546875
class_loss: 0.9680628776550293, distance_loss: 3.874249219894409
class_loss: 0.9359859228134155, distance_loss: 3.971158266067505
class_loss: 1.1203888654708862, distance_loss: 4.0612568855285645
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 1.0087, Accuracy: 6297/8968 (70.2163%)
___Train Local_Simple,  epoch  12, local model 78, internal_epoch   1,  Average loss: 0.0014, Accuracy: 291/303 (96.0396%)
___Train Local_Simple,  epoch  12, local model 78, internal_epoch   2,  Average loss: 0.0009, Accuracy: 297/303 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.2977, Accuracy: 9210/10000 (92.1000%)
___Train Local_Simple,  epoch  12, local model 58, internal_epoch   1,  Average loss: 0.0029, Accuracy: 264/276 (95.6522%)
___Train Local_Simple,  epoch  12, local model 58, internal_epoch   2,  Average loss: 0.0008, Accuracy: 273/276 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.9836, Accuracy: 8280/10000 (82.8000%)
___Train Local_Simple,  epoch  12, local model 41, internal_epoch   1,  Average loss: 0.0011, Accuracy: 593/606 (97.8548%)
___Train Local_Simple,  epoch  12, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%)
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.6026, Accuracy: 8486/10000 (84.8600%)
poison local model 81 index 2
class_loss: 4.48484992980957, distance_loss: 0.0
class_loss: 2.4960036277770996, distance_loss: 0.41819483041763306
class_loss: 1.9100908041000366, distance_loss: 0.9775445461273193
class_loss: 1.8231672048568726, distance_loss: 1.4826228618621826
class_loss: 1.7029978036880493, distance_loss: 1.9186687469482422
class_loss: 1.5105407238006592, distance_loss: 2.3259897232055664
class_loss: 1.5092898607254028, distance_loss: 2.6939034461975098
class_loss: 1.489426851272583, distance_loss: 3.0237419605255127
class_loss: 1.3037670850753784, distance_loss: 3.3209986686706543
class_loss: 1.1826307773590088, distance_loss: 3.5949625968933105
class_loss: 1.3414398431777954, distance_loss: 3.848747968673706
class_loss: 1.0455502271652222, distance_loss: 4.0746049880981445
class_loss: 1.2727659940719604, distance_loss: 4.275722026824951
class_loss: 1.128096103668213, distance_loss: 4.4532551765441895
class_loss: 1.0525332689285278, distance_loss: 4.612661838531494
class_loss: 1.1955246925354004, distance_loss: 4.760619640350342
class_loss: 0.9680444598197937, distance_loss: 4.899281978607178
class_loss: 0.9901529550552368, distance_loss: 5.027607440948486
class_loss: 0.9413477182388306, distance_loss: 5.146171569824219
class_loss: 1.2450493574142456, distance_loss: 5.258636474609375
___PoisonTrain Local_Simple ,  epoch  12, local model 81, internal_epoch   1,  Average loss: 0.0249, Accuracy: 596/1227 (48.5738%), train_poison_data_count: 391
class_loss: 0.9148254990577698, distance_loss: 5.36664342880249
class_loss: 1.079355001449585, distance_loss: 5.470208168029785
class_loss: 1.0601224899291992, distance_loss: 5.564080715179443
class_loss: 1.0076169967651367, distance_loss: 5.648247241973877
class_loss: 0.973809003829956, distance_loss: 5.724546432495117
class_loss: 0.9956964254379272, distance_loss: 5.794996738433838
class_loss: 0.8686578273773193, distance_loss: 5.858104228973389
class_loss: 0.7803543210029602, distance_loss: 5.91453742980957
class_loss: 0.7403213381767273, distance_loss: 5.966798305511475
class_loss: 0.8375012874603271, distance_loss: 6.016346454620361
class_loss: 0.9443140625953674, distance_loss: 6.0640058517456055
class_loss: 0.9102931022644043, distance_loss: 6.107886791229248
class_loss: 0.9767175912857056, distance_loss: 6.151413440704346
class_loss: 0.8126892447471619, distance_loss: 6.1967244148254395
class_loss: 0.8753102421760559, distance_loss: 6.238224506378174
class_loss: 0.8059744834899902, distance_loss: 6.275460720062256
class_loss: 0.7682395577430725, distance_loss: 6.306067943572998
class_loss: 0.7336371541023254, distance_loss: 6.33375883102417
class_loss: 0.7083820700645447, distance_loss: 6.360116004943848
class_loss: 0.9178605675697327, distance_loss: 6.383277416229248
___PoisonTrain Local_Simple ,  epoch  12, local model 81, internal_epoch   2,  Average loss: 0.0144, Accuracy: 746/1227 (60.7987%), train_poison_data_count: 391
Global model norm: 16.48387236348617.
Norm before scaling: 17.159773445679033. Distance: 6.412664412088048
Total norm for 3 adversaries is: 17.159773445679033. distance: 6.412664412088048
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 0.3766, Accuracy: 7825/8968 (87.2547%)
time spent on training: 60.22220706939697
Starting performing KrMLRFL...
Num data points: [645, 760, 423, 501, 371, 583, 303, 276, 606, 1227]
Num selected data points: [423 501 371 303 606]
The chosen ones are users: [2, 3, 4, 6, 8], which are global users: [62, 28, 65, 78, 41]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 22, 81]
base_p: [-0.00897798  0.00032926  0.00091346 ... -0.00253809 -0.0002739
  0.00015695]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 7, 9]
layer1_inf_time: 2.45068359375
[PAIRWISE] pred_attackers_indx:  [0 5 9]
layer2_inf_t: 30.40478515625
assumed final_attacker_idxs:  [0 1 5 7 9]
final_attacker_idxs is: [0, 1, 5, 7, 9]
g_attacker_idxs: [11 59 22 58 81]
g_normal_idxs: [62 28 65 78 41]
filtered_attacker_idxs: [0, 1, 5, 7, 9]
final_attacker_idxs are: [0, 1, 5, 7, 9]
num_dps: [645, 760, 423, 501, 371, 583, 303, 276, 606, 1227]
epoch_acc: 96.61999999999999
___Test Local_Simple poisoned: False, epoch: 12: Average loss: 0.1037, Accuracy: 9662/10000 (96.6200%)
___Test Local_Simple poisoned: True, epoch: 12: Average loss: 12.0868, Accuracy: 33/8968 (0.3680%)
Done in 162.82209300994873 sec.
Server Epoch:13 choose agents : [54, 55, 61, 73, 18, 42, 87, 41, 50, 28].
___Train Local_Simple,  epoch  13, local model 54, internal_epoch   1,  Average loss: 0.0014, Accuracy: 505/519 (97.3025%)
___Train Local_Simple,  epoch  13, local model 54, internal_epoch   2,  Average loss: 0.0022, Accuracy: 494/519 (95.1830%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.3088, Accuracy: 8926/10000 (89.2600%)
___Train Local_Simple,  epoch  13, local model 55, internal_epoch   1,  Average loss: 0.0019, Accuracy: 346/354 (97.7401%)
___Train Local_Simple,  epoch  13, local model 55, internal_epoch   2,  Average loss: 0.0006, Accuracy: 350/354 (98.8701%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.6360, Accuracy: 8038/10000 (80.3800%)
poison local model 61 index 0
class_loss: 3.5994455814361572, distance_loss: 0.0
class_loss: 1.8528090715408325, distance_loss: 0.30850422382354736
class_loss: 1.0900068283081055, distance_loss: 0.7543891072273254
class_loss: 1.2598512172698975, distance_loss: 1.210137128829956
class_loss: 1.2100356817245483, distance_loss: 1.5619124174118042
class_loss: 1.2944024801254272, distance_loss: 1.8684916496276855
class_loss: 1.1011765003204346, distance_loss: 2.1433470249176025
class_loss: 1.0543148517608643, distance_loss: 2.39411997795105
class_loss: 1.0336300134658813, distance_loss: 2.6250534057617188
class_loss: 0.931186854839325, distance_loss: 2.838589668273926
class_loss: 0.7976922392845154, distance_loss: 3.0337910652160645
___PoisonTrain Local_Simple ,  epoch  13, local model 61, internal_epoch   1,  Average loss: 0.0218, Accuracy: 417/699 (59.6567%), train_poison_data_count: 220
___PoisonTrain Local_Simple ,  epoch  13, local model 61, internal_epoch   2,  Average loss: 0.0125, Accuracy: 442/699 (63.2332%), train_poison_data_count: 220
Global model norm: 16.470782681126792.
Norm before scaling: 16.63607350459809. Distance: 4.363296331176376
Total norm for 3 adversaries is: 16.63607350459809. distance: 4.363296331176376
class_loss: 0.7586846351623535, distance_loss: 3.2126400470733643
class_loss: 0.7217974662780762, distance_loss: 3.3723747730255127
class_loss: 0.8403118848800659, distance_loss: 3.5167176723480225
class_loss: 1.013327717781067, distance_loss: 3.64986252784729
class_loss: 0.8000738620758057, distance_loss: 3.7692172527313232
class_loss: 0.8100942969322205, distance_loss: 3.878018617630005
class_loss: 0.699608325958252, distance_loss: 3.977276563644409
class_loss: 0.7331421971321106, distance_loss: 4.066714763641357
class_loss: 0.7406701445579529, distance_loss: 4.151501655578613
class_loss: 0.7533800005912781, distance_loss: 4.227167129516602
class_loss: 0.8428196310997009, distance_loss: 4.297585964202881
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.3704, Accuracy: 2331/8968 (25.9924%)
poison local model 73 index 1
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   1,  Average loss: 0.0320, Accuracy: 306/591 (51.7766%), train_poison_data_count: 195
class_loss: 4.481111526489258, distance_loss: 0.0
class_loss: 1.9714502096176147, distance_loss: 0.45138344168663025
class_loss: 2.4500937461853027, distance_loss: 0.9591122269630432
class_loss: 1.6578353643417358, distance_loss: 1.3543872833251953
class_loss: 1.7413790225982666, distance_loss: 1.746403455734253
class_loss: 1.4165644645690918, distance_loss: 2.1116340160369873
class_loss: 1.1389516592025757, distance_loss: 2.4524924755096436
class_loss: 1.1883591413497925, distance_loss: 2.783090591430664
class_loss: 1.5328154563903809, distance_loss: 3.096104621887207
class_loss: 1.3568497896194458, distance_loss: 3.3794925212860107
class_loss: 2.0686702728271484, distance_loss: 3.6958608627319336
class_loss: 1.6664644479751587, distance_loss: 3.9851138591766357
class_loss: 1.8863474130630493, distance_loss: 4.261733055114746
class_loss: 1.843375325202942, distance_loss: 4.521627426147461
class_loss: 1.7739495038986206, distance_loss: 4.764139175415039
class_loss: 1.7267918586730957, distance_loss: 4.990472316741943
class_loss: 1.6218297481536865, distance_loss: 5.199958324432373
class_loss: 1.6080570220947266, distance_loss: 5.394955635070801
class_loss: 1.527013897895813, distance_loss: 5.57480525970459
class_loss: 0.905906617641449, distance_loss: 5.741417407989502
___PoisonTrain Local_Simple ,  epoch  13, local model 73, internal_epoch   2,  Average loss: 0.0281, Accuracy: 194/591 (32.8257%), train_poison_data_count: 195
Global model norm: 16.470782681126792.
Norm before scaling: 16.736114667977375. Distance: 5.897285884578037
Total norm for 3 adversaries is: 16.736114667977375. distance: 5.897285884578037
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 0.8383, Accuracy: 8541/8968 (95.2386%)
___Train Local_Simple,  epoch  13, local model 18, internal_epoch   1,  Average loss: 0.0031, Accuracy: 441/459 (96.0784%)
___Train Local_Simple,  epoch  13, local model 18, internal_epoch   2,  Average loss: 0.0029, Accuracy: 441/459 (96.0784%)
class_loss: 2.487433671951294, distance_loss: 0.0
class_loss: 1.6405938863754272, distance_loss: 0.2258308231830597
class_loss: 1.0101938247680664, distance_loss: 0.5607394576072693
class_loss: 1.1719285249710083, distance_loss: 0.9313163161277771
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 1.1869, Accuracy: 7480/10000 (74.8000%)
poison local model 42 index 2
___PoisonTrain Local_Simple ,  epoch  13, local model 42, internal_epoch   1,  Average loss: 0.0267, Accuracy: 174/236 (73.7288%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  13, local model 42, internal_epoch   2,  Average loss: 0.0184, Accuracy: 135/236 (57.2034%), train_poison_data_count: 80
Global model norm: 16.470782681126792.
Norm before scaling: 16.290325190867698. Distance: 2.1840200809841117
Total norm for 3 adversaries is: 16.290325190867698. distance: 2.1840200809841117
class_loss: 1.2484757900238037, distance_loss: 1.282117247581482
class_loss: 1.0200830698013306, distance_loss: 1.55640709400177
class_loss: 1.132934808731079, distance_loss: 1.7890931367874146
class_loss: 0.9370408654212952, distance_loss: 1.9985828399658203
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 1.1411, Accuracy: 6018/8968 (67.1053%)
___Train Local_Simple,  epoch  13, local model 87, internal_epoch   1,  Average loss: 0.0011, Accuracy: 458/470 (97.4468%)
___Train Local_Simple,  epoch  13, local model 87, internal_epoch   2,  Average loss: 0.0009, Accuracy: 463/470 (98.5106%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2412, Accuracy: 9249/10000 (92.4900%)
___Train Local_Simple,  epoch  13, local model 41, internal_epoch   1,  Average loss: 0.0009, Accuracy: 593/606 (97.8548%)
___Train Local_Simple,  epoch  13, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 599/606 (98.8449%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.2880, Accuracy: 9101/10000 (91.0100%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   1,  Average loss: 0.0020, Accuracy: 457/474 (96.4135%)
___Train Local_Simple,  epoch  13, local model 50, internal_epoch   2,  Average loss: 0.0009, Accuracy: 466/474 (98.3122%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1807, Accuracy: 9415/10000 (94.1500%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   1,  Average loss: 0.0008, Accuracy: 495/501 (98.8024%)
___Train Local_Simple,  epoch  13, local model 28, internal_epoch   2,  Average loss: 0.0003, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1330, Accuracy: 9562/10000 (95.6200%)
time spent on training: 54.22724461555481
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 73, 42]
base_p: [-0.00386658  0.00081144  0.00493868 ... -0.0004003  -0.00230061
  0.00335724]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 5]
layer1_inf_time: 3.13427734375
[PAIRWISE] pred_attackers_indx:  [2 3 5]
layer2_inf_t: 29.266845703125
assumed final_attacker_idxs:  [1 2 3 4 5]
final_attacker_idxs is: [1, 2, 3, 4, 5]
g_attacker_idxs: [55 61 73 18 42]
g_normal_idxs: [54 87 41 50 28]
filtered_attacker_idxs: [1, 2, 3, 4, 5]
final_attacker_idxs are: [1, 2, 3, 4, 5]
num_dps: [519, 354, 699, 591, 459, 236, 470, 606, 474, 501]
Starting performing KrMLRFL...
Num data points: [519, 354, 699, 591, 459, 236, 470, 606, 474, 501]
Num selected data points: [519 470 606 474 501]
The chosen ones are users: [0, 6, 7, 8, 9], which are global users: [54, 87, 41, 50, 28]
___Test Local_Simple poisoned: False, epoch: 13: Average loss: 0.1016, Accuracy: 9673/10000 (96.7300%)
epoch_acc: 96.73
___Test Local_Simple poisoned: True, epoch: 13: Average loss: 11.3515, Accuracy: 43/8968 (0.4795%)
Done in 164.6867949962616 sec.
Server Epoch:14 choose agents : [37, 92, 95, 76, 13, 99, 94, 74, 45, 44].
___Train Local_Simple,  epoch  14, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 840/860 (97.6744%)
___Train Local_Simple,  epoch  14, local model 37, internal_epoch   2,  Average loss: 0.0010, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.2356, Accuracy: 9274/10000 (92.7400%)
___Train Local_Simple,  epoch  14, local model 92, internal_epoch   1,  Average loss: 0.0013, Accuracy: 910/937 (97.1185%)
___Train Local_Simple,  epoch  14, local model 92, internal_epoch   2,  Average loss: 0.0009, Accuracy: 923/937 (98.5059%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3967, Accuracy: 8814/10000 (88.1400%)
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 596/602 (99.0033%)
___Train Local_Simple,  epoch  14, local model 95, internal_epoch   2,  Average loss: 0.0003, Accuracy: 599/602 (99.5017%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 2.9994, Accuracy: 7229/10000 (72.2900%)
___Train Local_Simple,  epoch  14, local model 76, internal_epoch   1,  Average loss: 0.0024, Accuracy: 76/78 (97.4359%)
___Train Local_Simple,  epoch  14, local model 76, internal_epoch   2,  Average loss: 0.0003, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1431, Accuracy: 9560/10000 (95.6000%)
poison local model 13 index 0
class_loss: 3.641723394393921, distance_loss: 0.0
class_loss: 2.3005566596984863, distance_loss: 0.37763136625289917
class_loss: 1.757686734199524, distance_loss: 0.8428230285644531
class_loss: 1.9541946649551392, distance_loss: 1.249712347984314
class_loss: 1.3928335905075073, distance_loss: 1.6526540517807007
class_loss: 1.3630321025848389, distance_loss: 2.019660472869873
class_loss: 1.3245744705200195, distance_loss: 2.3527169227600098
class_loss: 1.0573011636734009, distance_loss: 2.65909743309021
class_loss: 1.4530022144317627, distance_loss: 2.94252610206604
class_loss: 1.2128123044967651, distance_loss: 3.1919820308685303
class_loss: 1.2368390560150146, distance_loss: 3.4122424125671387
class_loss: 1.072822093963623, distance_loss: 3.6078059673309326
___PoisonTrain Local_Simple ,  epoch  14, local model 13, internal_epoch   1,  Average loss: 0.0269, Accuracy: 373/734 (50.8174%), train_poison_data_count: 240
class_loss: 1.1783300638198853, distance_loss: 3.7961478233337402
class_loss: 1.1555057764053345, distance_loss: 3.966114044189453
class_loss: 1.2812833786010742, distance_loss: 4.115233898162842
class_loss: 1.0937455892562866, distance_loss: 4.247872829437256
class_loss: 1.184412956237793, distance_loss: 4.3682146072387695
class_loss: 1.046405553817749, distance_loss: 4.477615833282471
class_loss: 0.899676501750946, distance_loss: 4.5773773193359375
class_loss: 0.8373786807060242, distance_loss: 4.6691575050354
class_loss: 0.8465582132339478, distance_loss: 4.7535881996154785
class_loss: 0.7449045181274414, distance_loss: 4.833235740661621
class_loss: 0.7414785623550415, distance_loss: 4.910703182220459
class_loss: 0.8467358350753784, distance_loss: 4.9823150634765625
___PoisonTrain Local_Simple ,  epoch  14, local model 13, internal_epoch   2,  Average loss: 0.0162, Accuracy: 360/734 (49.0463%), train_poison_data_count: 240
Global model norm: 16.445080535774977.
Norm before scaling: 16.731085730947893. Distance: 5.053067120071362
Total norm for 2 adversaries is: 16.731085730947893. distance: 5.053067120071362
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 1.1783, Accuracy: 4211/8968 (46.9558%)
___Train Local_Simple,  epoch  14, local model 99, internal_epoch   1,  Average loss: 0.0012, Accuracy: 366/377 (97.0822%)
___Train Local_Simple,  epoch  14, local model 99, internal_epoch   2,  Average loss: 0.0013, Accuracy: 367/377 (97.3475%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1638, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  14, local model 94, internal_epoch   1,  Average loss: 0.0021, Accuracy: 144/150 (96.0000%)
___Train Local_Simple,  epoch  14, local model 94, internal_epoch   2,  Average loss: 0.0011, Accuracy: 147/150 (98.0000%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.9036, Accuracy: 7792/10000 (77.9200%)
___Train Local_Simple,  epoch  14, local model 74, internal_epoch   1,  Average loss: 0.0015, Accuracy: 543/557 (97.4865%)
___Train Local_Simple,  epoch  14, local model 74, internal_epoch   2,  Average loss: 0.0007, Accuracy: 549/557 (98.5637%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.3200, Accuracy: 9074/10000 (90.7400%)
poison local model 45 index 1
class_loss: 3.6419882774353027, distance_loss: 0.0
class_loss: 2.3225481510162354, distance_loss: 0.29516491293907166
class_loss: 1.1000328063964844, distance_loss: 0.7875613570213318
class_loss: 1.5261577367782593, distance_loss: 1.2853516340255737
class_loss: 1.5904617309570312, distance_loss: 1.655777096748352
class_loss: 1.4697017669677734, distance_loss: 1.9690028429031372
class_loss: 1.4915944337844849, distance_loss: 2.2524912357330322
class_loss: 1.3880395889282227, distance_loss: 2.5068461894989014
class_loss: 1.3728160858154297, distance_loss: 2.7317726612091064
class_loss: 1.4787920713424683, distance_loss: 2.9407565593719482
___PoisonTrain Local_Simple ,  epoch  14, local model 45, internal_epoch   1,  Average loss: 0.0277, Accuracy: 323/628 (51.4331%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  14, local model 45, internal_epoch   2,  Average loss: 0.0149, Accuracy: 359/628 (57.1656%), train_poison_data_count: 200
Global model norm: 16.445080535774977.
Norm before scaling: 16.589029276421943. Distance: 4.485862564954499
Total norm for 2 adversaries is: 16.589029276421943. distance: 4.485862564954499
class_loss: 1.0099941492080688, distance_loss: 3.1412458419799805
class_loss: 1.028062105178833, distance_loss: 3.332707166671753
class_loss: 0.9395625591278076, distance_loss: 3.5201473236083984
class_loss: 1.0549911260604858, distance_loss: 3.690847396850586
class_loss: 0.9809614419937134, distance_loss: 3.841193914413452
class_loss: 1.0059577226638794, distance_loss: 3.973102569580078
class_loss: 0.8766828775405884, distance_loss: 4.089922904968262
class_loss: 0.8311805129051208, distance_loss: 4.195906639099121
class_loss: 0.785062313079834, distance_loss: 4.298628807067871
class_loss: 0.8337854146957397, distance_loss: 4.3940935134887695
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 0.9717, Accuracy: 5537/8968 (61.7417%)
___Train Local_Simple,  epoch  14, local model 44, internal_epoch   1,  Average loss: 0.0019, Accuracy: 502/517 (97.0986%)
___Train Local_Simple,  epoch  14, local model 44, internal_epoch   2,  Average loss: 0.0011, Accuracy: 509/517 (98.4526%)
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1117, Accuracy: 9640/10000 (96.4000%)
time spent on training: 41.54688549041748
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 45]
base_p: [-0.00379483  0.0003715  -0.00039165 ... -0.00369158 -0.01225675
 -0.00606524]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 8]
layer1_inf_time: 2.8232421875
[PAIRWISE] pred_attackers_indx:  [4 8]
layer2_inf_t: 32.028076171875
assumed final_attacker_idxs:  [0 1 2 4 8]
final_attacker_idxs is: [0, 1, 2, 4, 8]
g_attacker_idxs: [37 92 95 13 45]
g_normal_idxs: [76 99 94 74 44]
filtered_attacker_idxs: [0, 1, 2, 4, 8]
final_attacker_idxs are: [0, 1, 2, 4, 8]
num_dps: [860, 937, 602, 78, 734, 377, 150, 557, 628, 517]
epoch_acc: 96.97
Starting performing KrMLRFL...
Num data points: [860, 937, 602, 78, 734, 377, 150, 557, 628, 517]
Num selected data points: [ 78 377 150 557 517]
The chosen ones are users: [3, 5, 6, 7, 9], which are global users: [76, 99, 94, 74, 44]
___Test Local_Simple poisoned: False, epoch: 14: Average loss: 0.1031, Accuracy: 9697/10000 (96.9700%)
___Test Local_Simple poisoned: True, epoch: 14: Average loss: 11.1831, Accuracy: 50/8968 (0.5575%)
Done in 159.1376712322235 sec.
Server Epoch:15 choose agents : [60, 49, 65, 14, 36, 24, 7, 4, 76, 39].
___Train Local_Simple,  epoch  15, local model 60, internal_epoch   1,  Average loss: 0.0026, Accuracy: 328/338 (97.0414%)
___Train Local_Simple,  epoch  15, local model 60, internal_epoch   2,  Average loss: 0.0010, Accuracy: 330/338 (97.6331%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3488, Accuracy: 8876/10000 (88.7600%)
___Train Local_Simple,  epoch  15, local model 49, internal_epoch   1,  Average loss: 0.0013, Accuracy: 493/506 (97.4308%)
___Train Local_Simple,  epoch  15, local model 49, internal_epoch   2,  Average loss: 0.0008, Accuracy: 496/506 (98.0237%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1907, Accuracy: 9427/10000 (94.2700%)
___Train Local_Simple,  epoch  15, local model 65, internal_epoch   1,  Average loss: 0.0012, Accuracy: 361/371 (97.3046%)
___Train Local_Simple,  epoch  15, local model 65, internal_epoch   2,  Average loss: 0.0008, Accuracy: 365/371 (98.3827%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.3057, Accuracy: 9056/10000 (90.5600%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   1,  Average loss: 0.0012, Accuracy: 369/376 (98.1383%)
___Train Local_Simple,  epoch  15, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1504, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   1,  Average loss: 0.0012, Accuracy: 981/1005 (97.6119%)
___Train Local_Simple,  epoch  15, local model 36, internal_epoch   2,  Average loss: 0.0008, Accuracy: 991/1005 (98.6070%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2379, Accuracy: 9183/10000 (91.8300%)
___Train Local_Simple,  epoch  15, local model 24, internal_epoch   1,  Average loss: 0.0013, Accuracy: 369/379 (97.3615%)
___Train Local_Simple,  epoch  15, local model 24, internal_epoch   2,  Average loss: 0.0006, Accuracy: 373/379 (98.4169%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1396, Accuracy: 9533/10000 (95.3300%)
poison local model 7 index 0
class_loss: 2.6659622192382812, distance_loss: 0.0
class_loss: 1.759092926979065, distance_loss: 0.23880715668201447
class_loss: 1.4067739248275757, distance_loss: 0.5890594124794006
class_loss: 1.0181828737258911, distance_loss: 0.9699987769126892
class_loss: 0.7283251881599426, distance_loss: 1.3121604919433594
class_loss: 0.9983819127082825, distance_loss: 1.6100653409957886
class_loss: 0.8467884659767151, distance_loss: 1.8605972528457642
___PoisonTrain Local_Simple ,  epoch  15, local model 7, internal_epoch   1,  Average loss: 0.0225, Accuracy: 278/418 (66.5072%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  15, local model 7, internal_epoch   2,  Average loss: 0.0164, Accuracy: 270/418 (64.5933%), train_poison_data_count: 140
Global model norm: 16.433277588621433.
Norm before scaling: 16.346839043941053. Distance: 3.1076472864209213
Total norm for 1 adversaries is: 16.346839043941053. distance: 3.1076472864209213
class_loss: 1.1589592695236206, distance_loss: 2.087977886199951
class_loss: 1.171499490737915, distance_loss: 2.2838757038116455
class_loss: 1.0648249387741089, distance_loss: 2.4551074504852295
class_loss: 1.0061501264572144, distance_loss: 2.6080687046051025
class_loss: 0.8829296231269836, distance_loss: 2.747769832611084
class_loss: 0.9547451734542847, distance_loss: 2.8774657249450684
class_loss: 0.6215028166770935, distance_loss: 2.992910623550415
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 0.1955, Accuracy: 8673/8968 (96.7105%)
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   1,  Average loss: 0.0014, Accuracy: 636/658 (96.6565%)
___Train Local_Simple,  epoch  15, local model 4, internal_epoch   2,  Average loss: 0.0005, Accuracy: 651/658 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.2032, Accuracy: 9338/10000 (93.3800%)
___Train Local_Simple,  epoch  15, local model 76, internal_epoch   1,  Average loss: 0.0008, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch  15, local model 76, internal_epoch   2,  Average loss: 0.0003, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1239, Accuracy: 9620/10000 (96.2000%)
___Train Local_Simple,  epoch  15, local model 39, internal_epoch   1,  Average loss: 0.0011, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  15, local model 39, internal_epoch   2,  Average loss: 0.0007, Accuracy: 255/257 (99.2218%)
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.1418, Accuracy: 9545/10000 (95.4500%)
time spent on training: 34.37440490722656
Starting performing KrMLRFL...
Num data points: [338, 506, 371, 376, 1005, 379, 418, 658, 78, 257]
Num selected data points: [371 376 379  78 257]
The chosen ones are users: [2, 3, 5, 8, 9], which are global users: [65, 14, 24, 76, 39]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7]
base_p: [ 0.00159173  0.0005279  -0.00029239 ... -0.00182505 -0.00259904
 -0.00221046]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 6, 7]
layer1_inf_time: 3.194580078125
[PAIRWISE] pred_attackers_indx:  [6]
layer2_inf_t: 27.390380859375
assumed final_attacker_idxs:  [0 1 4 6 7]
final_attacker_idxs is: [0, 1, 4, 6, 7]
g_attacker_idxs: [60 49 36  7  4]
g_normal_idxs: [65 14 24 76 39]
filtered_attacker_idxs: [0, 1, 4, 6, 7]
final_attacker_idxs are: [0, 1, 4, 6, 7]
num_dps: [338, 506, 371, 376, 1005, 379, 418, 658, 78, 257]
epoch_acc: 97.50999999999999
___Test Local_Simple poisoned: False, epoch: 15: Average loss: 0.0749, Accuracy: 9751/10000 (97.5100%)
___Test Local_Simple poisoned: True, epoch: 15: Average loss: 11.3711, Accuracy: 16/8968 (0.1784%)
Done in 128.68080878257751 sec.
Server Epoch:16 choose agents : [26, 29, 4, 41, 99, 67, 91, 76, 8, 25].
poison local model 26 index 0
class_loss: 2.143437623977661, distance_loss: 0.0
class_loss: 1.6183505058288574, distance_loss: 0.21828921139240265
class_loss: 0.8461308479309082, distance_loss: 0.6009891033172607
class_loss: 1.239031434059143, distance_loss: 0.9456296563148499
class_loss: 1.3114556074142456, distance_loss: 1.1980382204055786
class_loss: 0.8977404832839966, distance_loss: 1.428977608680725
class_loss: 1.0151910781860352, distance_loss: 1.671230673789978
class_loss: 0.8948934674263, distance_loss: 1.888834834098816
class_loss: 0.9869192242622375, distance_loss: 2.076435089111328
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   1,  Average loss: 0.0198, Accuracy: 395/554 (71.2996%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  16, local model 26, internal_epoch   2,  Average loss: 0.0121, Accuracy: 372/554 (67.1480%), train_poison_data_count: 180
Global model norm: 16.423716520796038.
Norm before scaling: 16.448777656013018. Distance: 3.163302106498837
Total norm for 2 adversaries is: 16.448777656013018. distance: 3.163302106498837
class_loss: 0.9093241095542908, distance_loss: 2.241711378097534
class_loss: 0.8489259481430054, distance_loss: 2.391507863998413
class_loss: 0.6917849779129028, distance_loss: 2.5243303775787354
class_loss: 0.7935647964477539, distance_loss: 2.63808012008667
class_loss: 0.9483450651168823, distance_loss: 2.731916904449463
class_loss: 0.7861891388893127, distance_loss: 2.8149662017822266
class_loss: 0.5985969305038452, distance_loss: 2.900996208190918
class_loss: 0.4331428110599518, distance_loss: 2.9873878955841064
class_loss: 0.6996233463287354, distance_loss: 3.0713231563568115
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.2262, Accuracy: 4117/8968 (45.9077%)
___Train Local_Simple,  epoch  16, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 985/1002 (98.3034%)
___Train Local_Simple,  epoch  16, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 989/1002 (98.7026%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2942, Accuracy: 9064/10000 (90.6400%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 649/658 (98.6322%)
___Train Local_Simple,  epoch  16, local model 4, internal_epoch   2,  Average loss: 0.0023, Accuracy: 631/658 (95.8967%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1981, Accuracy: 9376/10000 (93.7600%)
___Train Local_Simple,  epoch  16, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%)
___Train Local_Simple,  epoch  16, local model 41, internal_epoch   2,  Average loss: 0.0005, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2903, Accuracy: 9132/10000 (91.3200%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   1,  Average loss: 0.0007, Accuracy: 374/377 (99.2042%)
___Train Local_Simple,  epoch  16, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1379, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  16, local model 67, internal_epoch   1,  Average loss: 0.0010, Accuracy: 978/998 (97.9960%)
___Train Local_Simple,  epoch  16, local model 67, internal_epoch   2,  Average loss: 0.0003, Accuracy: 996/998 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.5188, Accuracy: 8531/10000 (85.3100%)
poison local model 91 index 1
class_loss: 3.045309066772461, distance_loss: 0.0
class_loss: 2.0599732398986816, distance_loss: 0.3124336302280426
class_loss: 1.3336052894592285, distance_loss: 0.7529932856559753
class_loss: 1.5876940488815308, distance_loss: 1.1333266496658325
___PoisonTrain Local_Simple ,  epoch  16, local model 91, internal_epoch   1,  Average loss: 0.0314, Accuracy: 147/256 (57.4219%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  16, local model 91, internal_epoch   2,  Average loss: 0.0209, Accuracy: 106/256 (41.4062%), train_poison_data_count: 80
Global model norm: 16.423716520796038.
Norm before scaling: 16.26872325049424. Distance: 2.406964778013263
Total norm for 2 adversaries is: 16.26872325049424. distance: 2.406964778013263
class_loss: 1.5266674757003784, distance_loss: 1.4477546215057373
class_loss: 1.4071626663208008, distance_loss: 1.7183483839035034
class_loss: 1.2972042560577393, distance_loss: 1.963716983795166
class_loss: 1.1121069192886353, distance_loss: 2.1946351528167725
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 1.4017, Accuracy: 3705/8968 (41.3136%)
___Train Local_Simple,  epoch  16, local model 76, internal_epoch   1,  Average loss: 0.0023, Accuracy: 76/78 (97.4359%)
___Train Local_Simple,  epoch  16, local model 76, internal_epoch   2,  Average loss: 0.0002, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.3486, Accuracy: 9036/10000 (90.3600%)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   1,  Average loss: 0.0016, Accuracy: 613/633 (96.8404%)
___Train Local_Simple,  epoch  16, local model 8, internal_epoch   2,  Average loss: 0.0010, Accuracy: 622/633 (98.2622%)
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.1803, Accuracy: 9461/10000 (94.6100%)
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   1,  Average loss: 0.0015, Accuracy: 626/647 (96.7543%)
___Train Local_Simple,  epoch  16, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 640/647 (98.9181%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 91]
base_p: [ 8.1330538e-05  4.0548295e-04  6.9104228e-04 ... -1.4642999e-03
 -1.8875599e-03 -3.2933578e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 6, 9]
layer1_inf_time: 4.05615234375
[PAIRWISE] pred_attackers_indx:  [0 6]
layer2_inf_t: 36.097900390625
assumed final_attacker_idxs:  [0 1 5 6 9]
final_attacker_idxs is: [0, 1, 5, 6, 9]
g_attacker_idxs: [26 29 67 91 25]
g_normal_idxs: [ 4 41 99 76  8]
filtered_attacker_idxs: [0, 1, 5, 6, 9]
final_attacker_idxs are: [0, 1, 5, 6, 9]
num_dps: [554, 1002, 658, 606, 377, 998, 256, 78, 633, 647]
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.2608, Accuracy: 9175/10000 (91.7500%)
time spent on training: 40.77441692352295
Starting performing KrMLRFL...
Num data points: [554, 1002, 658, 606, 377, 998, 256, 78, 633, 647]
Num selected data points: [658 606 377  78 633]
The chosen ones are users: [2, 3, 4, 7, 8], which are global users: [4, 41, 99, 76, 8]
epoch_acc: 97.35000000000001
___Test Local_Simple poisoned: False, epoch: 16: Average loss: 0.0821, Accuracy: 9735/10000 (97.3500%)
___Test Local_Simple poisoned: True, epoch: 16: Average loss: 11.9043, Accuracy: 31/8968 (0.3457%)
Done in 133.7113802433014 sec.
Server Epoch:17 choose agents : [66, 68, 59, 62, 31, 10, 23, 7, 99, 45].
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   1,  Average loss: 0.0009, Accuracy: 647/660 (98.0303%)
___Train Local_Simple,  epoch  17, local model 66, internal_epoch   2,  Average loss: 0.0011, Accuracy: 644/660 (97.5758%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 1.0334, Accuracy: 7641/10000 (76.4100%)
___Train Local_Simple,  epoch  17, local model 68, internal_epoch   1,  Average loss: 0.0009, Accuracy: 485/494 (98.1781%)
___Train Local_Simple,  epoch  17, local model 68, internal_epoch   2,  Average loss: 0.0006, Accuracy: 490/494 (99.1903%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3700, Accuracy: 8934/10000 (89.3400%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   1,  Average loss: 0.0019, Accuracy: 732/760 (96.3158%)
___Train Local_Simple,  epoch  17, local model 59, internal_epoch   2,  Average loss: 0.0014, Accuracy: 739/760 (97.2368%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.3527, Accuracy: 8884/10000 (88.8400%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   1,  Average loss: 0.0007, Accuracy: 416/423 (98.3452%)
___Train Local_Simple,  epoch  17, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.0962, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  17, local model 31, internal_epoch   1,  Average loss: 0.0013, Accuracy: 806/835 (96.5269%)
___Train Local_Simple,  epoch  17, local model 31, internal_epoch   2,  Average loss: 0.0011, Accuracy: 816/835 (97.7246%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1770, Accuracy: 9493/10000 (94.9300%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   1,  Average loss: 0.0016, Accuracy: 866/892 (97.0852%)
___Train Local_Simple,  epoch  17, local model 10, internal_epoch   2,  Average loss: 0.0009, Accuracy: 879/892 (98.5426%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.4261, Accuracy: 8623/10000 (86.2300%)
___Train Local_Simple,  epoch  17, local model 23, internal_epoch   1,  Average loss: 0.0008, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch  17, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.1224, Accuracy: 9612/10000 (96.1200%)
poison local model 7 index 0
class_loss: 3.08994197845459, distance_loss: 0.0
class_loss: 1.536421537399292, distance_loss: 0.27613577246665955
class_loss: 1.5087828636169434, distance_loss: 0.654274046421051
class_loss: 1.3845411539077759, distance_loss: 1.0476773977279663
class_loss: 1.3367916345596313, distance_loss: 1.391517162322998
class_loss: 1.188921570777893, distance_loss: 1.691942572593689
class_loss: 1.0476435422897339, distance_loss: 1.9558182954788208
___PoisonTrain Local_Simple ,  epoch  17, local model 7, internal_epoch   1,  Average loss: 0.0265, Accuracy: 245/418 (58.6124%), train_poison_data_count: 140
class_loss: 1.1430892944335938, distance_loss: 2.1868624687194824
class_loss: 1.2917746305465698, distance_loss: 2.377671718597412
class_loss: 1.25174081325531, distance_loss: 2.5378077030181885
class_loss: 1.1533087491989136, distance_loss: 2.677551746368408
class_loss: 1.121856689453125, distance_loss: 2.7991416454315186
class_loss: 1.096510410308838, distance_loss: 2.905466079711914
class_loss: 0.8843122124671936, distance_loss: 2.999005079269409
___PoisonTrain Local_Simple ,  epoch  17, local model 7, internal_epoch   2,  Average loss: 0.0190, Accuracy: 206/418 (49.2823%), train_poison_data_count: 140
Global model norm: 16.420871460773633.
Norm before scaling: 16.33184485886823. Distance: 3.0863551376313607
Total norm for 2 adversaries is: 16.33184485886823. distance: 3.0863551376313607
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 0.5803, Accuracy: 7995/8968 (89.1503%)
___Train Local_Simple,  epoch  17, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch  17, local model 99, internal_epoch   2,  Average loss: 0.0003, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.0861, Accuracy: 9717/10000 (97.1700%)
poison local model 45 index 1
___PoisonTrain Local_Simple ,  epoch  17, local model 45, internal_epoch   1,  Average loss: 0.0274, Accuracy: 307/628 (48.8854%), train_poison_data_count: 200
class_loss: 3.7852158546447754, distance_loss: 0.0
class_loss: 2.4649744033813477, distance_loss: 0.302109956741333
class_loss: 1.137715458869934, distance_loss: 0.7802349925041199
class_loss: 1.3958147764205933, distance_loss: 1.2768324613571167
class_loss: 1.4601616859436035, distance_loss: 1.6570792198181152
class_loss: 1.4211112260818481, distance_loss: 1.9627102613449097
class_loss: 1.3577780723571777, distance_loss: 2.229748010635376
class_loss: 1.4330328702926636, distance_loss: 2.463855028152466
class_loss: 1.4153574705123901, distance_loss: 2.671504497528076
class_loss: 1.3464614152908325, distance_loss: 2.859717607498169
class_loss: 0.8550726771354675, distance_loss: 3.0390894412994385
class_loss: 1.0240330696105957, distance_loss: 3.206991195678711
class_loss: 0.9636640548706055, distance_loss: 3.3658370971679688
class_loss: 0.8977751135826111, distance_loss: 3.5152502059936523
class_loss: 0.981092095375061, distance_loss: 3.6517882347106934
class_loss: 1.0203285217285156, distance_loss: 3.7772674560546875
class_loss: 0.8087308406829834, distance_loss: 3.889761209487915
class_loss: 0.8657244443893433, distance_loss: 3.9897074699401855
class_loss: 0.9130755066871643, distance_loss: 4.0826497077941895
class_loss: 0.8558851480484009, distance_loss: 4.171847820281982
___PoisonTrain Local_Simple ,  epoch  17, local model 45, internal_epoch   2,  Average loss: 0.0146, Accuracy: 366/628 (58.2803%), train_poison_data_count: 200
Global model norm: 16.420871460773633.
Norm before scaling: 16.513135825310595. Distance: 4.2576758686506695
Total norm for 2 adversaries is: 16.513135825310595. distance: 4.2576758686506695
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 1.0871, Accuracy: 4894/8968 (54.5718%)
time spent on training: 44.33421039581299
Starting performing KrMLRFL...
Num data points: [660, 494, 760, 423, 835, 892, 293, 418, 377, 628]
Num selected data points: [494 423 892 293 377]
The chosen ones are users: [1, 3, 5, 6, 8], which are global users: [68, 62, 10, 23, 99]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 45]
base_p: [-0.00311228  0.00045504 -0.00278877 ... -0.00184572  0.0007773
  0.00035746]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 7, 9]
layer1_inf_time: 2.9912109375
[PAIRWISE] pred_attackers_indx:  [7 9]
layer2_inf_t: 27.377685546875
assumed final_attacker_idxs:  [0 2 4 7 9]
final_attacker_idxs is: [0, 2, 4, 7, 9]
g_attacker_idxs: [66 59 31  7 45]
g_normal_idxs: [68 62 10 23 99]
filtered_attacker_idxs: [0, 2, 4, 7, 9]
final_attacker_idxs are: [0, 2, 4, 7, 9]
num_dps: [660, 494, 760, 423, 835, 892, 293, 418, 377, 628]
epoch_acc: 97.19
___Test Local_Simple poisoned: False, epoch: 17: Average loss: 0.0879, Accuracy: 9719/10000 (97.1900%)
___Test Local_Simple poisoned: True, epoch: 17: Average loss: 12.9220, Accuracy: 23/8968 (0.2565%)
Done in 133.35240864753723 sec.
Server Epoch:18 choose agents : [63, 55, 79, 9, 62, 56, 96, 12, 92, 86].
poison local model 63 index 0
___PoisonTrain Local_Simple ,  epoch  18, local model 63, internal_epoch   1,  Average loss: 0.0209, Accuracy: 560/889 (62.9921%), train_poison_data_count: 280
class_loss: 4.037589073181152, distance_loss: 0.0
class_loss: 2.168274402618408, distance_loss: 0.3217642903327942
class_loss: 1.0162385702133179, distance_loss: 0.8049874305725098
class_loss: 1.3644239902496338, distance_loss: 1.2925461530685425
class_loss: 1.4532774686813354, distance_loss: 1.6343551874160767
class_loss: 1.1161646842956543, distance_loss: 1.911615252494812
class_loss: 1.2289698123931885, distance_loss: 2.1615538597106934
class_loss: 1.2542917728424072, distance_loss: 2.3841655254364014
class_loss: 1.0043001174926758, distance_loss: 2.583193063735962
class_loss: 0.9414811730384827, distance_loss: 2.766536235809326
class_loss: 0.8807330131530762, distance_loss: 2.940274477005005
class_loss: 0.8785325288772583, distance_loss: 3.1032562255859375
class_loss: 0.7518218159675598, distance_loss: 3.258877992630005
class_loss: 0.514451801776886, distance_loss: 3.404109239578247
class_loss: 0.7156161665916443, distance_loss: 3.540463924407959
class_loss: 0.668425977230072, distance_loss: 3.6654858589172363
class_loss: 0.8851774334907532, distance_loss: 3.7760062217712402
class_loss: 0.5735325217247009, distance_loss: 3.8733880519866943
class_loss: 0.4352129399776459, distance_loss: 3.9716763496398926
class_loss: 0.23943114280700684, distance_loss: 4.068938255310059
class_loss: 0.23446975648403168, distance_loss: 4.164425373077393
class_loss: 0.35826361179351807, distance_loss: 4.2545552253723145
class_loss: 0.31225505471229553, distance_loss: 4.337920188903809
class_loss: 0.3248167335987091, distance_loss: 4.413949966430664
class_loss: 0.14849185943603516, distance_loss: 4.489964008331299
class_loss: 0.17394258081912994, distance_loss: 4.562222480773926
class_loss: 0.16155706346035004, distance_loss: 4.630103588104248
class_loss: 0.17559051513671875, distance_loss: 4.692239284515381
___PoisonTrain Local_Simple ,  epoch  18, local model 63, internal_epoch   2,  Average loss: 0.0061, Accuracy: 779/889 (87.6265%), train_poison_data_count: 280
Global model norm: 16.408127682728896.
Norm before scaling: 16.83734949125381. Distance: 4.750949162465953
Total norm for 1 adversaries is: 16.83734949125381. distance: 4.750949162465953
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 0.0414, Accuracy: 8837/8968 (98.5393%)
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   1,  Average loss: 0.0013, Accuracy: 345/354 (97.4576%)
___Train Local_Simple,  epoch  18, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.6862, Accuracy: 8035/10000 (80.3500%)
___Train Local_Simple,  epoch  18, local model 79, internal_epoch   1,  Average loss: 0.0013, Accuracy: 175/182 (96.1538%)
___Train Local_Simple,  epoch  18, local model 79, internal_epoch   2,  Average loss: 0.0005, Accuracy: 179/182 (98.3516%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1253, Accuracy: 9604/10000 (96.0400%)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 424/436 (97.2477%)
___Train Local_Simple,  epoch  18, local model 9, internal_epoch   2,  Average loss: 0.0005, Accuracy: 431/436 (98.8532%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2064, Accuracy: 9322/10000 (93.2200%)
___Train Local_Simple,  epoch  18, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 419/423 (99.0544%)
___Train Local_Simple,  epoch  18, local model 62, internal_epoch   2,  Average loss: 0.0004, Accuracy: 419/423 (99.0544%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0865, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch  18, local model 56, internal_epoch   1,  Average loss: 0.0010, Accuracy: 863/880 (98.0682%)
___Train Local_Simple,  epoch  18, local model 56, internal_epoch   2,  Average loss: 0.0004, Accuracy: 874/880 (99.3182%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.1815, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  18, local model 96, internal_epoch   1,  Average loss: 0.0016, Accuracy: 655/672 (97.4702%)
___Train Local_Simple,  epoch  18, local model 96, internal_epoch   2,  Average loss: 0.0008, Accuracy: 661/672 (98.3631%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.4293, Accuracy: 8661/10000 (86.6100%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   1,  Average loss: 0.0022, Accuracy: 1129/1160 (97.3276%)
___Train Local_Simple,  epoch  18, local model 12, internal_epoch   2,  Average loss: 0.0023, Accuracy: 1113/1160 (95.9483%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.7551, Accuracy: 7584/10000 (75.8400%)
___Train Local_Simple,  epoch  18, local model 92, internal_epoch   1,  Average loss: 0.0014, Accuracy: 913/937 (97.4386%)
___Train Local_Simple,  epoch  18, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 930/937 (99.2529%)
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.3024, Accuracy: 9040/10000 (90.4000%)
___Train Local_Simple,  epoch  18, local model 86, internal_epoch   1,  Average loss: 0.0013, Accuracy: 243/250 (97.2000%)
___Train Local_Simple,  epoch  18, local model 86, internal_epoch   2,  Average loss: 0.0005, Accuracy: 247/250 (98.8000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63]
base_p: [ 0.00026554  0.00083925  0.00413605 ... -0.00249384 -0.01215854
 -0.00647043]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 7, 8]
layer1_inf_time: 2.8544921875
[PAIRWISE] pred_attackers_indx:  [0]
layer2_inf_t: 101.939208984375
assumed final_attacker_idxs:  [0 5 6 7 8]
final_attacker_idxs is: [0, 5, 6, 7, 8]
g_attacker_idxs: [63 56 96 12 92]
g_normal_idxs: [55 79  9 62 86]
filtered_attacker_idxs: [0, 5, 6, 7, 8]
final_attacker_idxs are: [0, 5, 6, 7, 8]
num_dps: [889, 354, 182, 436, 423, 880, 672, 1160, 937, 250]
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.2311, Accuracy: 9263/10000 (92.6300%)
time spent on training: 35.973384380340576
Starting performing KrMLRFL...
Num data points: [889, 354, 182, 436, 423, 880, 672, 1160, 937, 250]
Num selected data points: [354 182 436 423 250]
The chosen ones are users: [1, 2, 3, 4, 9], which are global users: [55, 79, 9, 62, 86]
___Test Local_Simple poisoned: False, epoch: 18: Average loss: 0.0771, Accuracy: 9750/10000 (97.5000%)
epoch_acc: 97.5
___Test Local_Simple poisoned: True, epoch: 18: Average loss: 12.1894, Accuracy: 33/8968 (0.3680%)
Done in 139.68795037269592 sec.
Server Epoch:19 choose agents : [28, 63, 33, 71, 13, 32, 76, 97, 23, 25].
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   1,  Average loss: 0.0010, Accuracy: 490/501 (97.8044%)
___Train Local_Simple,  epoch  19, local model 28, internal_epoch   2,  Average loss: 0.0003, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1292, Accuracy: 9584/10000 (95.8400%)
poison local model 63 index 0
___PoisonTrain Local_Simple ,  epoch  19, local model 63, internal_epoch   1,  Average loss: 0.0227, Accuracy: 489/889 (55.0056%), train_poison_data_count: 280
class_loss: 3.7725977897644043, distance_loss: 0.0
class_loss: 2.2076704502105713, distance_loss: 0.3235657215118408
class_loss: 1.2991081476211548, distance_loss: 0.7644001841545105
class_loss: 1.4210513830184937, distance_loss: 1.1978169679641724
class_loss: 1.6476225852966309, distance_loss: 1.533656120300293
class_loss: 1.1621050834655762, distance_loss: 1.8212279081344604
class_loss: 1.335326075553894, distance_loss: 2.081749200820923
class_loss: 1.3513959646224976, distance_loss: 2.3091881275177
class_loss: 1.1640042066574097, distance_loss: 2.512204647064209
class_loss: 1.0720019340515137, distance_loss: 2.6937646865844727
class_loss: 0.9690847992897034, distance_loss: 2.8635687828063965
class_loss: 0.8916369080543518, distance_loss: 3.0248005390167236
class_loss: 0.9304604530334473, distance_loss: 3.1761245727539062
class_loss: 0.9639418721199036, distance_loss: 3.3099982738494873
class_loss: 1.050161361694336, distance_loss: 3.436951160430908
class_loss: 0.8994120359420776, distance_loss: 3.55400013923645
class_loss: 0.8387522101402283, distance_loss: 3.667752265930176
class_loss: 1.23000967502594, distance_loss: 3.772451162338257
class_loss: 1.0384633541107178, distance_loss: 3.8578882217407227
class_loss: 0.8361058831214905, distance_loss: 3.933222532272339
class_loss: 0.9262691140174866, distance_loss: 4.0027289390563965
class_loss: 0.7208255529403687, distance_loss: 4.063802719116211
class_loss: 0.9104541540145874, distance_loss: 4.121215343475342
class_loss: 0.8344696164131165, distance_loss: 4.176187515258789
class_loss: 0.8217881917953491, distance_loss: 4.227881908416748
class_loss: 0.8191190958023071, distance_loss: 4.277798652648926
class_loss: 0.9284518957138062, distance_loss: 4.324071884155273
class_loss: 0.8637248873710632, distance_loss: 4.36744499206543
___PoisonTrain Local_Simple ,  epoch  19, local model 63, internal_epoch   2,  Average loss: 0.0143, Accuracy: 536/889 (60.2925%), train_poison_data_count: 280
Global model norm: 16.38805352504817.
Norm before scaling: 16.531082008243782. Distance: 4.4110931401456535
Total norm for 3 adversaries is: 16.531082008243782. distance: 4.4110931401456535
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 1.0975, Accuracy: 3478/8968 (38.7823%)
___Train Local_Simple,  epoch  19, local model 33, internal_epoch   1,  Average loss: 0.0022, Accuracy: 600/623 (96.3082%)
___Train Local_Simple,  epoch  19, local model 33, internal_epoch   2,  Average loss: 0.0022, Accuracy: 590/623 (94.7030%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2475, Accuracy: 9180/10000 (91.8000%)
poison local model 71 index 1
___PoisonTrain Local_Simple ,  epoch  19, local model 71, internal_epoch   1,  Average loss: 0.0203, Accuracy: 768/1384 (55.4913%), train_poison_data_count: 440
class_loss: 3.7488057613372803, distance_loss: 0.0
class_loss: 2.220142126083374, distance_loss: 0.3595699965953827
class_loss: 1.7499651908874512, distance_loss: 0.9170644879341125
class_loss: 1.8598265647888184, distance_loss: 1.3131228685379028
class_loss: 1.5651780366897583, distance_loss: 1.6503878831863403
class_loss: 1.3576916456222534, distance_loss: 1.9734368324279785
class_loss: 1.4226930141448975, distance_loss: 2.2703473567962646
class_loss: 1.3481634855270386, distance_loss: 2.540477752685547
class_loss: 1.2639044523239136, distance_loss: 2.7874653339385986
class_loss: 1.1386399269104004, distance_loss: 3.0190107822418213
class_loss: 0.9364149570465088, distance_loss: 3.235934019088745
class_loss: 0.9037401676177979, distance_loss: 3.4448435306549072
class_loss: 1.0687843561172485, distance_loss: 3.6409571170806885
class_loss: 1.0635182857513428, distance_loss: 3.816105365753174
class_loss: 0.7445108890533447, distance_loss: 3.9709737300872803
class_loss: 0.7659137845039368, distance_loss: 4.114662170410156
class_loss: 0.8855388164520264, distance_loss: 4.245286464691162
class_loss: 1.0288488864898682, distance_loss: 4.365218639373779
class_loss: 0.8351913690567017, distance_loss: 4.469920635223389
class_loss: 0.7467984557151794, distance_loss: 4.5693488121032715
class_loss: 0.7376212477684021, distance_loss: 4.6617045402526855
class_loss: 0.7361888289451599, distance_loss: 4.747139930725098
___PoisonTrain Local_Simple ,  epoch  19, local model 71, internal_epoch   2,  Average loss: 0.0070, Accuracy: 1135/1384 (82.0087%), train_poison_data_count: 440
Global model norm: 16.38805352504817.
Norm before scaling: 17.07669538847095. Distance: 5.962976349490251
Total norm for 3 adversaries is: 17.07669538847095. distance: 5.962976349490251
class_loss: 0.7765607237815857, distance_loss: 4.8265910148620605
class_loss: 0.7765762209892273, distance_loss: 4.899462699890137
class_loss: 0.7787221074104309, distance_loss: 4.964798927307129
class_loss: 0.6085030436515808, distance_loss: 5.022751808166504
class_loss: 0.669681966304779, distance_loss: 5.075870037078857
class_loss: 0.6675193905830383, distance_loss: 5.125710487365723
class_loss: 0.7045087814331055, distance_loss: 5.176830291748047
class_loss: 0.7162091732025146, distance_loss: 5.22484016418457
class_loss: 0.5642758011817932, distance_loss: 5.272716522216797
class_loss: 0.5161339640617371, distance_loss: 5.318902015686035
class_loss: 0.4266273081302643, distance_loss: 5.365807056427002
class_loss: 0.4848525822162628, distance_loss: 5.411571502685547
class_loss: 0.31304264068603516, distance_loss: 5.45977258682251
class_loss: 0.2397070974111557, distance_loss: 5.509639263153076
class_loss: 0.18621142208576202, distance_loss: 5.563451290130615
class_loss: 0.3881731927394867, distance_loss: 5.618010997772217
class_loss: 0.23492127656936646, distance_loss: 5.671823501586914
class_loss: 0.13074469566345215, distance_loss: 5.723969459533691
class_loss: 0.0977201983332634, distance_loss: 5.774778366088867
class_loss: 0.25234463810920715, distance_loss: 5.825667858123779
class_loss: 0.04947027564048767, distance_loss: 5.8730645179748535
class_loss: 0.06818576157093048, distance_loss: 5.918671131134033
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.0783, Accuracy: 8712/8968 (97.1454%)
poison local model 13 index 2
___PoisonTrain Local_Simple ,  epoch  19, local model 13, internal_epoch   1,  Average loss: 0.0238, Accuracy: 406/734 (55.3134%), train_poison_data_count: 240
class_loss: 3.1467223167419434, distance_loss: 0.0
class_loss: 1.7574727535247803, distance_loss: 0.342928946018219
class_loss: 2.2163257598876953, distance_loss: 0.7615848779678345
class_loss: 1.3080902099609375, distance_loss: 1.1206740140914917
class_loss: 1.193416714668274, distance_loss: 1.485321283340454
class_loss: 1.1188275814056396, distance_loss: 1.8191670179367065
class_loss: 1.2193889617919922, distance_loss: 2.123342275619507
class_loss: 1.335726261138916, distance_loss: 2.405810594558716
class_loss: 1.3054118156433105, distance_loss: 2.6568801403045654
class_loss: 1.0695714950561523, distance_loss: 2.8858485221862793
class_loss: 1.0219918489456177, distance_loss: 3.094484806060791
class_loss: 0.7993980646133423, distance_loss: 3.2811672687530518
class_loss: 1.1147063970565796, distance_loss: 3.457695722579956
class_loss: 1.111268162727356, distance_loss: 3.6070399284362793
class_loss: 1.029836654663086, distance_loss: 3.7334673404693604
class_loss: 0.8813385963439941, distance_loss: 3.8460617065429688
class_loss: 0.9577240347862244, distance_loss: 3.9543545246124268
class_loss: 1.025004267692566, distance_loss: 4.0531511306762695
class_loss: 0.8683713674545288, distance_loss: 4.143333911895752
class_loss: 0.7864046692848206, distance_loss: 4.230257511138916
class_loss: 0.826193630695343, distance_loss: 4.313662528991699
___PoisonTrain Local_Simple ,  epoch  19, local model 13, internal_epoch   2,  Average loss: 0.0155, Accuracy: 399/734 (54.3597%), train_poison_data_count: 240
Global model norm: 16.38805352504817.
Norm before scaling: 16.589338330392636. Distance: 4.592421358999916
Total norm for 3 adversaries is: 16.589338330392636. distance: 4.592421358999916
class_loss: 0.9426559805870056, distance_loss: 4.391068458557129
class_loss: 0.8001173734664917, distance_loss: 4.461775779724121
class_loss: 1.0553114414215088, distance_loss: 4.525336265563965
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 0.6628, Accuracy: 6565/8968 (73.2047%)
___Train Local_Simple,  epoch  19, local model 32, internal_epoch   1,  Average loss: 0.0019, Accuracy: 942/977 (96.4176%)
___Train Local_Simple,  epoch  19, local model 32, internal_epoch   2,  Average loss: 0.0016, Accuracy: 943/977 (96.5200%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1466, Accuracy: 9547/10000 (95.4700%)
___Train Local_Simple,  epoch  19, local model 76, internal_epoch   1,  Average loss: 0.0020, Accuracy: 75/78 (96.1538%)
___Train Local_Simple,  epoch  19, local model 76, internal_epoch   2,  Average loss: 0.0011, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2193, Accuracy: 9322/10000 (93.2200%)
___Train Local_Simple,  epoch  19, local model 97, internal_epoch   1,  Average loss: 0.0009, Accuracy: 476/487 (97.7413%)
___Train Local_Simple,  epoch  19, local model 97, internal_epoch   2,  Average loss: 0.0006, Accuracy: 480/487 (98.5626%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.6341, Accuracy: 8722/10000 (87.2200%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   1,  Average loss: 0.0006, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch  19, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.1538, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 634/647 (97.9907%)
___Train Local_Simple,  epoch  19, local model 25, internal_epoch   2,  Average loss: 0.0020, Accuracy: 641/647 (99.0726%)
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.2837, Accuracy: 9120/10000 (91.2000%)
time spent on training: 53.79054522514343
Starting performing KrMLRFL...
Num data points: [501, 889, 623, 1384, 734, 977, 78, 487, 293, 647]
Num selected data points: [501 623  78 487 293]
The chosen ones are users: [0, 2, 6, 7, 8], which are global users: [28, 33, 76, 97, 23]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 71, 13]
base_p: [-0.00382121  0.00040185  0.00157598 ... -0.00427499 -0.01207029
 -0.00102029]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 9]
layer1_inf_time: 3.187255859375
[PAIRWISE] pred_attackers_indx:  [1 3 4]
layer2_inf_t: 123.19091796875
assumed final_attacker_idxs:  [1 3 4 5 9]
final_attacker_idxs is: [1, 3, 4, 5, 9]
g_attacker_idxs: [63 71 13 32 25]
g_normal_idxs: [28 33 76 97 23]
filtered_attacker_idxs: [1, 3, 4, 5, 9]
final_attacker_idxs are: [1, 3, 4, 5, 9]
num_dps: [501, 889, 623, 1384, 734, 977, 78, 487, 293, 647]
___Test Local_Simple poisoned: False, epoch: 19: Average loss: 0.0890, Accuracy: 9700/10000 (97.0000%)
epoch_acc: 97.0
___Test Local_Simple poisoned: True, epoch: 19: Average loss: 13.2340, Accuracy: 12/8968 (0.1338%)
Done in 158.31524062156677 sec.
Server Epoch:20 choose agents : [12, 56, 19, 11, 13, 78, 49, 34, 14, 99].
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   1,  Average loss: 0.0016, Accuracy: 1127/1160 (97.1552%)
___Train Local_Simple,  epoch  20, local model 12, internal_epoch   2,  Average loss: 0.0010, Accuracy: 1137/1160 (98.0172%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2034, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  20, local model 56, internal_epoch   1,  Average loss: 0.0011, Accuracy: 860/880 (97.7273%)
___Train Local_Simple,  epoch  20, local model 56, internal_epoch   2,  Average loss: 0.0003, Accuracy: 876/880 (99.5455%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2092, Accuracy: 9384/10000 (93.8400%)
___Train Local_Simple,  epoch  20, local model 19, internal_epoch   1,  Average loss: 0.0014, Accuracy: 198/205 (96.5854%)
___Train Local_Simple,  epoch  20, local model 19, internal_epoch   2,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2540, Accuracy: 9282/10000 (92.8200%)
poison local model 11 index 0
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   1,  Average loss: 0.0325, Accuracy: 300/645 (46.5116%), train_poison_data_count: 205
class_loss: 4.608864784240723, distance_loss: 0.0
class_loss: 3.3383774757385254, distance_loss: 0.34022679924964905
class_loss: 1.5734477043151855, distance_loss: 0.8468714952468872
class_loss: 1.2191362380981445, distance_loss: 1.3920079469680786
class_loss: 1.3867024183273315, distance_loss: 1.866073489189148
class_loss: 1.6298273801803589, distance_loss: 2.2647452354431152
class_loss: 1.7369440793991089, distance_loss: 2.6034436225891113
class_loss: 1.6350481510162354, distance_loss: 2.895533800125122
class_loss: 1.57025146484375, distance_loss: 3.148423910140991
class_loss: 1.5779881477355957, distance_loss: 3.368011951446533
class_loss: 0.6926010847091675, distance_loss: 3.561318874359131
class_loss: 1.5501995086669922, distance_loss: 3.747825860977173
class_loss: 1.5562349557876587, distance_loss: 3.9091343879699707
class_loss: 1.5153130292892456, distance_loss: 4.041885852813721
class_loss: 1.154515266418457, distance_loss: 4.154993057250977
class_loss: 1.1260250806808472, distance_loss: 4.257807731628418
class_loss: 1.1715582609176636, distance_loss: 4.357360363006592
class_loss: 1.0392138957977295, distance_loss: 4.452786445617676
class_loss: 0.9398479461669922, distance_loss: 4.544806480407715
class_loss: 1.08163583278656, distance_loss: 4.634712219238281
class_loss: 0.980388879776001, distance_loss: 4.721932888031006
class_loss: 1.3932985067367554, distance_loss: 4.806701183319092
___PoisonTrain Local_Simple ,  epoch  20, local model 11, internal_epoch   2,  Average loss: 0.0209, Accuracy: 300/645 (46.5116%), train_poison_data_count: 205
Global model norm: 16.398863664662485.
Norm before scaling: 16.565469036652626. Distance: 4.903468418676619
Total norm for 3 adversaries is: 16.565469036652626. distance: 4.903468418676619
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.9144, Accuracy: 4760/8968 (53.0776%)
poison local model 13 index 1
___PoisonTrain Local_Simple ,  epoch  20, local model 13, internal_epoch   1,  Average loss: 0.0286, Accuracy: 365/734 (49.7275%), train_poison_data_count: 240
class_loss: 4.329314231872559, distance_loss: 0.0
class_loss: 2.225536584854126, distance_loss: 0.37632906436920166
class_loss: 1.828641414642334, distance_loss: 0.9171201586723328
class_loss: 1.6847801208496094, distance_loss: 1.4009754657745361
class_loss: 1.6212143898010254, distance_loss: 1.8399022817611694
class_loss: 1.5320857763290405, distance_loss: 2.23603892326355
class_loss: 1.5731873512268066, distance_loss: 2.591073513031006
class_loss: 1.290710687637329, distance_loss: 2.9133529663085938
class_loss: 1.2017977237701416, distance_loss: 3.2134501934051514
class_loss: 1.2914713621139526, distance_loss: 3.489724636077881
class_loss: 1.1180377006530762, distance_loss: 3.7316839694976807
class_loss: 1.281058669090271, distance_loss: 3.9467718601226807
class_loss: 1.2287825345993042, distance_loss: 4.149688720703125
class_loss: 1.4215503931045532, distance_loss: 4.334021091461182
class_loss: 1.2661311626434326, distance_loss: 4.496963977813721
class_loss: 1.2244802713394165, distance_loss: 4.644528388977051
class_loss: 1.2372243404388428, distance_loss: 4.779276371002197
class_loss: 1.1066097021102905, distance_loss: 4.902300834655762
class_loss: 0.9052800536155701, distance_loss: 5.015598297119141
class_loss: 0.8416670560836792, distance_loss: 5.122342586517334
class_loss: 0.9487143754959106, distance_loss: 5.22108793258667
class_loss: 0.9905483722686768, distance_loss: 5.310507297515869
class_loss: 0.8852202296257019, distance_loss: 5.389652252197266
class_loss: 0.9324723482131958, distance_loss: 5.463111877441406
___PoisonTrain Local_Simple ,  epoch  20, local model 13, internal_epoch   2,  Average loss: 0.0177, Accuracy: 370/734 (50.4087%), train_poison_data_count: 240
Global model norm: 16.398863664662485.
Norm before scaling: 16.667664358159183. Distance: 5.537879548509414
Total norm for 3 adversaries is: 16.667664358159183. distance: 5.537879548509414
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.4624, Accuracy: 7660/8968 (85.4148%)
___Train Local_Simple,  epoch  20, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 297/303 (98.0198%)
___Train Local_Simple,  epoch  20, local model 78, internal_epoch   2,  Average loss: 0.0002, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.2092, Accuracy: 9364/10000 (93.6400%)
___Train Local_Simple,  epoch  20, local model 49, internal_epoch   1,  Average loss: 0.0010, Accuracy: 499/506 (98.6166%)
___Train Local_Simple,  epoch  20, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1367, Accuracy: 9569/10000 (95.6900%)
poison local model 34 index 2
class_loss: 4.5542826652526855, distance_loss: 0.0
class_loss: 2.3708722591400146, distance_loss: 0.34731999039649963
class_loss: 1.4091126918792725, distance_loss: 0.8633936047554016
class_loss: 1.231925368309021, distance_loss: 1.3544355630874634
class_loss: 1.6698505878448486, distance_loss: 1.773541808128357
class_loss: 1.4284794330596924, distance_loss: 2.13965106010437
class_loss: 1.201770544052124, distance_loss: 2.4690463542938232
___PoisonTrain Local_Simple ,  epoch  20, local model 34, internal_epoch   1,  Average loss: 0.0336, Accuracy: 231/413 (55.9322%), train_poison_data_count: 140
class_loss: 1.26554274559021, distance_loss: 2.7783937454223633
class_loss: 1.127776026725769, distance_loss: 3.0586416721343994
class_loss: 1.0513865947723389, distance_loss: 3.310706377029419
class_loss: 1.201417088508606, distance_loss: 3.5343029499053955
class_loss: 1.0219718217849731, distance_loss: 3.7348341941833496
class_loss: 0.9194598197937012, distance_loss: 3.920689105987549
class_loss: 1.2984594106674194, distance_loss: 4.089235305786133
___PoisonTrain Local_Simple ,  epoch  20, local model 34, internal_epoch   2,  Average loss: 0.0191, Accuracy: 209/413 (50.6053%), train_poison_data_count: 140
Global model norm: 16.398863664662485.
Norm before scaling: 16.393692180547582. Distance: 4.24888102442476
Total norm for 3 adversaries is: 16.393692180547582. distance: 4.24888102442476
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 0.7934, Accuracy: 7002/8968 (78.0776%)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   1,  Average loss: 0.0010, Accuracy: 368/376 (97.8723%)
___Train Local_Simple,  epoch  20, local model 14, internal_epoch   2,  Average loss: 0.0006, Accuracy: 372/376 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.1280, Accuracy: 9606/10000 (96.0600%)
___Train Local_Simple,  epoch  20, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 374/377 (99.2042%)
___Train Local_Simple,  epoch  20, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0917, Accuracy: 9711/10000 (97.1100%)
time spent on training: 57.81031036376953
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 13, 34]
base_p: [-0.00362668  0.00033206  0.00133544 ...  0.00017287 -0.0217177
  0.00052322]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 7]
layer1_inf_time: 2.64892578125
[PAIRWISE] pred_attackers_indx:  [3 4 7]
layer2_inf_t: 50.921875
assumed final_attacker_idxs:  [0 3 4 6 7]
final_attacker_idxs is: [0, 3, 4, 6, 7]
g_attacker_idxs: [12 11 13 49 34]
g_normal_idxs: [56 19 78 14 99]
filtered_attacker_idxs: [0, 3, 4, 6, 7]
final_attacker_idxs are: [0, 3, 4, 6, 7]
num_dps: [1160, 880, 205, 645, 734, 303, 506, 413, 376, 377]
Num data points: [1160, 880, 205, 645, 734, 303, 506, 413, 376, 377]
Num selected data points: [880 205 303 376 377]
The chosen ones are users: [1, 2, 5, 8, 9], which are global users: [56, 19, 78, 14, 99]
___Test Local_Simple poisoned: False, epoch: 20: Average loss: 0.0621, Accuracy: 9816/10000 (98.1600%)
epoch_acc: 98.16
___Test Local_Simple poisoned: True, epoch: 20: Average loss: 13.2402, Accuracy: 14/8968 (0.1561%)
Done in 170.044846534729 sec.
Server Epoch:21 choose agents : [53, 56, 51, 14, 36, 6, 46, 99, 88, 37].
___Train Local_Simple,  epoch  21, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 726/739 (98.2409%)
___Train Local_Simple,  epoch  21, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.5123, Accuracy: 8534/10000 (85.3400%)
___Train Local_Simple,  epoch  21, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 874/880 (99.3182%)
___Train Local_Simple,  epoch  21, local model 56, internal_epoch   2,  Average loss: 0.0003, Accuracy: 874/880 (99.3182%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0899, Accuracy: 9737/10000 (97.3700%)
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   1,  Average loss: 0.0225, Accuracy: 358/568 (63.0282%), train_poison_data_count: 180
class_loss: 4.127777576446533, distance_loss: 0.0
class_loss: 2.0489628314971924, distance_loss: 0.38327890634536743
class_loss: 1.1619834899902344, distance_loss: 0.8697760105133057
class_loss: 1.0969864130020142, distance_loss: 1.2790467739105225
class_loss: 1.3888291120529175, distance_loss: 1.631921410560608
class_loss: 0.8867613077163696, distance_loss: 1.957986831665039
class_loss: 0.7879154086112976, distance_loss: 2.2731611728668213
class_loss: 0.5723539590835571, distance_loss: 2.567978620529175
class_loss: 0.7353455424308777, distance_loss: 2.842745780944824
class_loss: 0.848390519618988, distance_loss: 3.0939719676971436
class_loss: 0.8495043516159058, distance_loss: 3.319791316986084
class_loss: 0.6356993317604065, distance_loss: 3.5210444927215576
class_loss: 0.6726953983306885, distance_loss: 3.7002828121185303
class_loss: 0.7006900310516357, distance_loss: 3.855827808380127
class_loss: 0.5290077924728394, distance_loss: 3.991835117340088
class_loss: 0.4126841425895691, distance_loss: 4.120133876800537
class_loss: 0.34872883558273315, distance_loss: 4.243809223175049
class_loss: 0.22650495171546936, distance_loss: 4.364330768585205
___PoisonTrain Local_Simple ,  epoch  21, local model 51, internal_epoch   2,  Average loss: 0.0092, Accuracy: 452/568 (79.5775%), train_poison_data_count: 180
Global model norm: 16.39693466940496.
Norm before scaling: 16.558127002297656. Distance: 4.480002155303437
Total norm for 1 adversaries is: 16.558127002297656. distance: 4.480002155303437
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 0.0836, Accuracy: 8815/8968 (98.2939%)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   1,  Average loss: 0.0007, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch  21, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0783, Accuracy: 9782/10000 (97.8200%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   1,  Average loss: 0.0013, Accuracy: 985/1005 (98.0100%)
___Train Local_Simple,  epoch  21, local model 36, internal_epoch   2,  Average loss: 0.0009, Accuracy: 989/1005 (98.4080%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.2685, Accuracy: 9121/10000 (91.2100%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   1,  Average loss: 0.0020, Accuracy: 592/615 (96.2602%)
___Train Local_Simple,  epoch  21, local model 6, internal_epoch   2,  Average loss: 0.0010, Accuracy: 603/615 (98.0488%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1330, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  21, local model 46, internal_epoch   1,  Average loss: 0.0019, Accuracy: 692/710 (97.4648%)
___Train Local_Simple,  epoch  21, local model 46, internal_epoch   2,  Average loss: 0.0029, Accuracy: 677/710 (95.3521%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.4067, Accuracy: 8692/10000 (86.9200%)
___Train Local_Simple,  epoch  21, local model 99, internal_epoch   1,  Average loss: 0.0004, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch  21, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.1209, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch  21, local model 88, internal_epoch   1,  Average loss: 0.0007, Accuracy: 522/530 (98.4906%)
___Train Local_Simple,  epoch  21, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 529/530 (99.8113%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3419, Accuracy: 9138/10000 (91.3800%)
___Train Local_Simple,  epoch  21, local model 37, internal_epoch   1,  Average loss: 0.0012, Accuracy: 836/860 (97.2093%)
___Train Local_Simple,  epoch  21, local model 37, internal_epoch   2,  Average loss: 0.0007, Accuracy: 849/860 (98.7209%)
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.3010, Accuracy: 9144/10000 (91.4400%)
time spent on training: 37.4082989692688
Starting performing KrMLRFL...
Num data points: [739, 880, 568, 376, 1005, 615, 710, 377, 530, 860]
Num selected data points: [880 376 377 530 860]
The chosen ones are users: [1, 3, 7, 8, 9], which are global users: [56, 14, 99, 88, 37]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51]
base_p: [-0.00162519  0.00060728  0.00300664 ...  0.00014105 -0.0012662
  0.00476209]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 6]
layer1_inf_time: 2.4716796875
[PAIRWISE] pred_attackers_indx:  [2]
layer2_inf_t: 25.97314453125
assumed final_attacker_idxs:  [0 2 4 5 6]
final_attacker_idxs is: [0, 2, 4, 5, 6]
g_attacker_idxs: [53 51 36  6 46]
g_normal_idxs: [56 14 99 88 37]
filtered_attacker_idxs: [0, 2, 4, 5, 6]
final_attacker_idxs are: [0, 2, 4, 5, 6]
num_dps: [739, 880, 568, 376, 1005, 615, 710, 377, 530, 860]
epoch_acc: 97.49
___Test Local_Simple poisoned: False, epoch: 21: Average loss: 0.0798, Accuracy: 9749/10000 (97.4900%)
___Test Local_Simple poisoned: True, epoch: 21: Average loss: 11.8082, Accuracy: 79/8968 (0.8809%)
Done in 125.34006977081299 sec.
Server Epoch:22 choose agents : [42, 17, 2, 64, 6, 38, 37, 44, 77, 4].
poison local model 42 index 0
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   1,  Average loss: 0.0252, Accuracy: 174/236 (73.7288%), train_poison_data_count: 80
class_loss: 1.8867894411087036, distance_loss: 0.0
class_loss: 1.9907505512237549, distance_loss: 0.1698295921087265
class_loss: 1.330125093460083, distance_loss: 0.48102831840515137
class_loss: 0.7466349005699158, distance_loss: 0.8262318968772888
class_loss: 1.47376549243927, distance_loss: 1.1413778066635132
___PoisonTrain Local_Simple ,  epoch  22, local model 42, internal_epoch   2,  Average loss: 0.0178, Accuracy: 137/236 (58.0508%), train_poison_data_count: 80
Global model norm: 16.352073869213616.
Norm before scaling: 16.142647010023925. Distance: 2.0323518552198405
Total norm for 3 adversaries is: 16.142647010023925. distance: 2.0323518552198405
class_loss: 0.7331423163414001, distance_loss: 1.369994878768921
class_loss: 0.8167752623558044, distance_loss: 1.5989407300949097
class_loss: 1.165401816368103, distance_loss: 1.8236478567123413
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 1.6952, Accuracy: 1589/8968 (17.7186%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  22, local model 17, internal_epoch   1,  Average loss: 0.0266, Accuracy: 344/620 (55.4839%), train_poison_data_count: 200
class_loss: 3.861480474472046, distance_loss: 0.0
class_loss: 1.908624291419983, distance_loss: 0.33451253175735474
class_loss: 2.2319679260253906, distance_loss: 0.8164612054824829
class_loss: 1.3547563552856445, distance_loss: 1.1519826650619507
class_loss: 1.2274186611175537, distance_loss: 1.4772894382476807
class_loss: 1.151874303817749, distance_loss: 1.8188056945800781
class_loss: 1.1360872983932495, distance_loss: 2.140294313430786
class_loss: 1.2539935111999512, distance_loss: 2.431501865386963
class_loss: 1.0799731016159058, distance_loss: 2.6936936378479004
class_loss: 1.2782747745513916, distance_loss: 2.92879319190979
class_loss: 1.1513001918792725, distance_loss: 3.145068645477295
class_loss: 1.1282601356506348, distance_loss: 3.338547468185425
class_loss: 1.1719990968704224, distance_loss: 3.508446455001831
class_loss: 1.1069585084915161, distance_loss: 3.6581954956054688
class_loss: 1.041306972503662, distance_loss: 3.789747714996338
class_loss: 1.1374410390853882, distance_loss: 3.902608871459961
class_loss: 1.0283300876617432, distance_loss: 3.999187707901001
class_loss: 0.8600292205810547, distance_loss: 4.087751388549805
class_loss: 0.8104328513145447, distance_loss: 4.170443058013916
class_loss: 0.9136579632759094, distance_loss: 4.244418621063232
___PoisonTrain Local_Simple ,  epoch  22, local model 17, internal_epoch   2,  Average loss: 0.0167, Accuracy: 335/620 (54.0323%), train_poison_data_count: 200
Global model norm: 16.352073869213616.
Norm before scaling: 16.400231410929276. Distance: 4.317251490347557
Total norm for 3 adversaries is: 16.400231410929276. distance: 4.317251490347557
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.8227, Accuracy: 6003/8968 (66.9380%)
poison local model 2 index 2
class_loss: 2.0359671115875244, distance_loss: 0.0
class_loss: 1.1647541522979736, distance_loss: 0.1855769157409668
class_loss: 0.9221359491348267, distance_loss: 0.4418620467185974
class_loss: 1.088303804397583, distance_loss: 0.756605327129364
class_loss: 0.5739290714263916, distance_loss: 1.1270042657852173
class_loss: 0.9080502390861511, distance_loss: 1.453240156173706
class_loss: 0.7970244884490967, distance_loss: 1.7024717330932617
class_loss: 0.4737488627433777, distance_loss: 1.9264570474624634
class_loss: 0.7692991495132446, distance_loss: 2.14111590385437
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   1,  Average loss: 0.0159, Accuracy: 431/548 (78.6496%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  22, local model 2, internal_epoch   2,  Average loss: 0.0106, Accuracy: 409/548 (74.6350%), train_poison_data_count: 180
Global model norm: 16.352073869213616.
Norm before scaling: 16.27646489033082. Distance: 3.4233091649802954
Total norm for 3 adversaries is: 16.27646489033082. distance: 3.4233091649802954
class_loss: 0.8096200227737427, distance_loss: 2.3497838973999023
class_loss: 0.8401109576225281, distance_loss: 2.5363824367523193
class_loss: 0.727608859539032, distance_loss: 2.7013111114501953
class_loss: 0.5708999633789062, distance_loss: 2.8464410305023193
class_loss: 0.7025637030601501, distance_loss: 2.9736216068267822
class_loss: 0.697398841381073, distance_loss: 3.084829092025757
class_loss: 0.47060737013816833, distance_loss: 3.18162202835083
class_loss: 0.49712681770324707, distance_loss: 3.26865553855896
class_loss: 0.48323705792427063, distance_loss: 3.3454222679138184
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 0.6136, Accuracy: 6787/8968 (75.6802%)
___Train Local_Simple,  epoch  22, local model 64, internal_epoch   1,  Average loss: 0.0019, Accuracy: 785/813 (96.5560%)
___Train Local_Simple,  epoch  22, local model 64, internal_epoch   2,  Average loss: 0.0006, Accuracy: 802/813 (98.6470%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3354, Accuracy: 8785/10000 (87.8500%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 603/615 (98.0488%)
___Train Local_Simple,  epoch  22, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 610/615 (99.1870%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1348, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   1,  Average loss: 0.0015, Accuracy: 871/895 (97.3184%)
___Train Local_Simple,  epoch  22, local model 38, internal_epoch   2,  Average loss: 0.0007, Accuracy: 887/895 (99.1061%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.4253, Accuracy: 8810/10000 (88.1000%)
___Train Local_Simple,  epoch  22, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch  22, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 855/860 (99.4186%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.2850, Accuracy: 9276/10000 (92.7600%)
___Train Local_Simple,  epoch  22, local model 44, internal_epoch   1,  Average loss: 0.0013, Accuracy: 508/517 (98.2592%)
___Train Local_Simple,  epoch  22, local model 44, internal_epoch   2,  Average loss: 0.0008, Accuracy: 511/517 (98.8395%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1097, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch  22, local model 77, internal_epoch   1,  Average loss: 0.0016, Accuracy: 572/589 (97.1138%)
___Train Local_Simple,  epoch  22, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 578/589 (98.1324%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.1044, Accuracy: 9679/10000 (96.7900%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 647/658 (98.3283%)
___Train Local_Simple,  epoch  22, local model 4, internal_epoch   2,  Average loss: 0.0022, Accuracy: 625/658 (94.9848%)
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.3430, Accuracy: 8854/10000 (88.5400%)
time spent on training: 48.592937707901
Starting performing KrMLRFL...
Num data points: [236, 620, 548, 813, 615, 895, 860, 517, 589, 658]
Num selected data points: [813 895 860 517 589]
The chosen ones are users: [3, 5, 6, 7, 8], which are global users: [64, 38, 37, 44, 77]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 17, 2]
base_p: [-0.00333905  0.00045817 -0.00196834 ... -0.00184175 -0.00558451
 -0.00245939]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 9]
layer1_inf_time: 2.37939453125
[PAIRWISE] pred_attackers_indx:  [0 1 2]
layer2_inf_t: 26.352294921875
assumed final_attacker_idxs:  [0 1 2 4 9]
final_attacker_idxs is: [0, 1, 2, 4, 9]
g_attacker_idxs: [42 17  2  6  4]
g_normal_idxs: [64 38 37 44 77]
filtered_attacker_idxs: [0, 1, 2, 4, 9]
final_attacker_idxs are: [0, 1, 2, 4, 9]
num_dps: [236, 620, 548, 813, 615, 895, 860, 517, 589, 658]
epoch_acc: 98.16
___Test Local_Simple poisoned: False, epoch: 22: Average loss: 0.0605, Accuracy: 9816/10000 (98.1600%)
___Test Local_Simple poisoned: True, epoch: 22: Average loss: 12.7835, Accuracy: 12/8968 (0.1338%)
Done in 142.30691719055176 sec.
Server Epoch:23 choose agents : [24, 38, 52, 10, 11, 76, 97, 7, 70, 14].
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   1,  Average loss: 0.0012, Accuracy: 367/379 (96.8338%)
___Train Local_Simple,  epoch  23, local model 24, internal_epoch   2,  Average loss: 0.0005, Accuracy: 374/379 (98.6807%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1239, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch  23, local model 38, internal_epoch   1,  Average loss: 0.0009, Accuracy: 877/895 (97.9888%)
___Train Local_Simple,  epoch  23, local model 38, internal_epoch   2,  Average loss: 0.0009, Accuracy: 878/895 (98.1006%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.2245, Accuracy: 9341/10000 (93.4100%)
poison local model 52 index 0
class_loss: 3.9314463138580322, distance_loss: 0.0
class_loss: 2.9778177738189697, distance_loss: 0.3350178301334381
class_loss: 1.7013204097747803, distance_loss: 0.9000853300094604
class_loss: 1.770589828491211, distance_loss: 1.4123220443725586
___PoisonTrain Local_Simple ,  epoch  23, local model 52, internal_epoch   1,  Average loss: 0.0410, Accuracy: 140/253 (55.3360%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  23, local model 52, internal_epoch   2,  Average loss: 0.0235, Accuracy: 87/253 (34.3874%), train_poison_data_count: 80
Global model norm: 16.30008900623945.
Norm before scaling: 16.117241464100157. Distance: 3.0279323079594223
Total norm for 4 adversaries is: 16.117241464100157. distance: 3.0279323079594223
class_loss: 1.6469087600708008, distance_loss: 1.809981107711792
class_loss: 1.5178416967391968, distance_loss: 2.1525158882141113
class_loss: 1.4196289777755737, distance_loss: 2.4680418968200684
class_loss: 1.3708901405334473, distance_loss: 2.758575916290283
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 1.5154, Accuracy: 4992/8968 (55.6646%)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   1,  Average loss: 0.0011, Accuracy: 870/892 (97.5336%)
___Train Local_Simple,  epoch  23, local model 10, internal_epoch   2,  Average loss: 0.0006, Accuracy: 885/892 (99.2152%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.1592, Accuracy: 9487/10000 (94.8700%)
poison local model 11 index 1
___PoisonTrain Local_Simple ,  epoch  23, local model 11, internal_epoch   1,  Average loss: 0.0328, Accuracy: 309/645 (47.9070%), train_poison_data_count: 205
class_loss: 4.38254976272583, distance_loss: 0.0
class_loss: 2.8476574420928955, distance_loss: 0.33401477336883545
class_loss: 1.7620588541030884, distance_loss: 0.827606201171875
class_loss: 1.454445719718933, distance_loss: 1.388236403465271
class_loss: 1.5887446403503418, distance_loss: 1.8615918159484863
class_loss: 1.6181046962738037, distance_loss: 2.269859552383423
class_loss: 1.6358087062835693, distance_loss: 2.6286559104919434
class_loss: 1.6498122215270996, distance_loss: 2.946612596511841
class_loss: 1.5772606134414673, distance_loss: 3.2305867671966553
class_loss: 1.5529494285583496, distance_loss: 3.485896110534668
class_loss: 1.097804307937622, distance_loss: 3.7141449451446533
class_loss: 1.6166313886642456, distance_loss: 3.943922281265259
class_loss: 1.5221755504608154, distance_loss: 4.145507335662842
class_loss: 1.3722790479660034, distance_loss: 4.311045169830322
class_loss: 1.2150423526763916, distance_loss: 4.455319404602051
class_loss: 1.166303277015686, distance_loss: 4.590859889984131
class_loss: 1.1317455768585205, distance_loss: 4.720336437225342
class_loss: 1.1590880155563354, distance_loss: 4.845774173736572
class_loss: 1.046707034111023, distance_loss: 4.964807987213135
class_loss: 1.151841640472412, distance_loss: 5.077816963195801
class_loss: 1.1785552501678467, distance_loss: 5.183762550354004
class_loss: 2.140367031097412, distance_loss: 5.2827959060668945
___PoisonTrain Local_Simple ,  epoch  23, local model 11, internal_epoch   2,  Average loss: 0.0228, Accuracy: 301/645 (46.6667%), train_poison_data_count: 205
Global model norm: 16.30008900623945.
Norm before scaling: 16.534267099735345. Distance: 5.413469730750957
Total norm for 4 adversaries is: 16.534267099735345. distance: 5.413469730750957
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5433, Accuracy: 7357/8968 (82.0361%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   1,  Average loss: 0.0008, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch  23, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0725, Accuracy: 9782/10000 (97.8200%)
___Train Local_Simple,  epoch  23, local model 97, internal_epoch   1,  Average loss: 0.0005, Accuracy: 483/487 (99.1786%)
___Train Local_Simple,  epoch  23, local model 97, internal_epoch   2,  Average loss: 0.0003, Accuracy: 483/487 (99.1786%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.3188, Accuracy: 9103/10000 (91.0300%)
poison local model 7 index 2
___PoisonTrain Local_Simple ,  epoch  23, local model 7, internal_epoch   1,  Average loss: 0.0256, Accuracy: 263/418 (62.9187%), train_poison_data_count: 140
class_loss: 2.5683414936065674, distance_loss: 0.0
class_loss: 2.3055057525634766, distance_loss: 0.22984911501407623
class_loss: 1.4684257507324219, distance_loss: 0.6198354363441467
class_loss: 1.052531123161316, distance_loss: 1.0401784181594849
class_loss: 1.2087388038635254, distance_loss: 1.426727294921875
class_loss: 1.1233320236206055, distance_loss: 1.7684803009033203
class_loss: 0.9577879309654236, distance_loss: 2.0596280097961426
class_loss: 1.1919959783554077, distance_loss: 2.315049648284912
class_loss: 1.0351166725158691, distance_loss: 2.533633232116699
class_loss: 1.227380394935608, distance_loss: 2.72135066986084
class_loss: 1.1131929159164429, distance_loss: 2.8848931789398193
class_loss: 1.0696210861206055, distance_loss: 3.0308499336242676
class_loss: 0.9711350202560425, distance_loss: 3.1630165576934814
class_loss: 1.0548402070999146, distance_loss: 3.284226655960083
___PoisonTrain Local_Simple ,  epoch  23, local model 7, internal_epoch   2,  Average loss: 0.0183, Accuracy: 236/418 (56.4593%), train_poison_data_count: 140
Global model norm: 16.30008900623945.
Norm before scaling: 16.205989455700667. Distance: 3.398631123255787
Total norm for 4 adversaries is: 16.205989455700667. distance: 3.398631123255787
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.5578, Accuracy: 7411/8968 (82.6383%)
poison local model 70 index 3
___PoisonTrain Local_Simple ,  epoch  23, local model 70, internal_epoch   1,  Average loss: 0.0236, Accuracy: 403/724 (55.6630%), train_poison_data_count: 240
class_loss: 3.6377503871917725, distance_loss: 0.0
class_loss: 1.8366849422454834, distance_loss: 0.2760732173919678
class_loss: 1.0227365493774414, distance_loss: 0.7013620734214783
class_loss: 1.3485734462738037, distance_loss: 1.1328119039535522
class_loss: 1.3173116445541382, distance_loss: 1.4897170066833496
class_loss: 1.177412748336792, distance_loss: 1.7753396034240723
class_loss: 1.2699625492095947, distance_loss: 2.023165702819824
class_loss: 1.234176754951477, distance_loss: 2.2406487464904785
class_loss: 1.3467686176300049, distance_loss: 2.4291372299194336
class_loss: 1.1432452201843262, distance_loss: 2.5975074768066406
class_loss: 1.1004961729049683, distance_loss: 2.749016523361206
class_loss: 0.6184074878692627, distance_loss: 2.884915351867676
___PoisonTrain Local_Simple ,  epoch  23, local model 70, internal_epoch   2,  Average loss: 0.0079, Accuracy: 580/724 (80.1105%), train_poison_data_count: 240
Global model norm: 16.30008900623945.
Norm before scaling: 16.677360969184676. Distance: 4.38739829094963
Total norm for 4 adversaries is: 16.677360969184676. distance: 4.38739829094963
class_loss: 0.7973248362541199, distance_loss: 3.0363903045654297
class_loss: 0.8207289576530457, distance_loss: 3.177764415740967
class_loss: 0.7191233038902283, distance_loss: 3.303791046142578
class_loss: 0.650816798210144, distance_loss: 3.415709972381592
class_loss: 0.5405474901199341, distance_loss: 3.5219528675079346
class_loss: 0.4447818398475647, distance_loss: 3.6244447231292725
class_loss: 0.3108052611351013, distance_loss: 3.7306113243103027
class_loss: 0.31828853487968445, distance_loss: 3.841233015060425
class_loss: 0.4598442018032074, distance_loss: 3.953068256378174
class_loss: 0.2113703340291977, distance_loss: 4.061333179473877
class_loss: 0.3346850275993347, distance_loss: 4.1658148765563965
class_loss: 0.09001217782497406, distance_loss: 4.273223400115967
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 0.0469, Accuracy: 8798/8968 (98.1044%)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   1,  Average loss: 0.0006, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch  23, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0916, Accuracy: 9724/10000 (97.2400%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 11, 7, 70]
base_p: [-0.00400005  0.00017407 -0.00193187 ... -0.00096433  0.00201862
  0.0003207 ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 7, 8]
layer1_inf_time: 3.1611328125
[PAIRWISE] pred_attackers_indx:  [2 4 7 8]
layer2_inf_t: 29.861328125
assumed final_attacker_idxs:  [0 2 4 7 8]
final_attacker_idxs is: [0, 2, 4, 7, 8]
g_attacker_idxs: [24 52 11  7 70]
g_normal_idxs: [38 10 76 97 14]
filtered_attacker_idxs: [0, 2, 4, 7, 8]
final_attacker_idxs are: [0, 2, 4, 7, 8]
num_dps: [379, 895, 253, 892, 645, 78, 487, 418, 724, 376]
time spent on training: 55.14464735984802
Starting performing KrMLRFL...
Num data points: [379, 895, 253, 892, 645, 78, 487, 418, 724, 376]
Num selected data points: [895 892  78 487 376]
The chosen ones are users: [1, 3, 5, 6, 9], which are global users: [38, 10, 76, 97, 14]
___Test Local_Simple poisoned: False, epoch: 23: Average loss: 0.0772, Accuracy: 9739/10000 (97.3900%)
epoch_acc: 97.39
___Test Local_Simple poisoned: True, epoch: 23: Average loss: 12.9657, Accuracy: 14/8968 (0.1561%)
Done in 148.51923727989197 sec.
Server Epoch:24 choose agents : [95, 97, 12, 89, 25, 34, 55, 67, 56, 2].
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch  24, local model 95, internal_epoch   2,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 1.7064, Accuracy: 7878/10000 (78.7800%)
___Train Local_Simple,  epoch  24, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch  24, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1427, Accuracy: 9552/10000 (95.5200%)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1134/1160 (97.7586%)
___Train Local_Simple,  epoch  24, local model 12, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1152/1160 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2404, Accuracy: 9371/10000 (93.7100%)
___Train Local_Simple,  epoch  24, local model 89, internal_epoch   1,  Average loss: 0.0013, Accuracy: 483/492 (98.1707%)
___Train Local_Simple,  epoch  24, local model 89, internal_epoch   2,  Average loss: 0.0003, Accuracy: 490/492 (99.5935%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2512, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   1,  Average loss: 0.0010, Accuracy: 633/647 (97.8362%)
___Train Local_Simple,  epoch  24, local model 25, internal_epoch   2,  Average loss: 0.0004, Accuracy: 644/647 (99.5363%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2131, Accuracy: 9335/10000 (93.3500%)
poison local model 34 index 0
___PoisonTrain Local_Simple ,  epoch  24, local model 34, internal_epoch   1,  Average loss: 0.0315, Accuracy: 224/413 (54.2373%), train_poison_data_count: 140
class_loss: 3.7460289001464844, distance_loss: 0.0
class_loss: 2.8635010719299316, distance_loss: 0.319749116897583
class_loss: 1.7941639423370361, distance_loss: 0.8110196590423584
class_loss: 1.316129446029663, distance_loss: 1.237906575202942
class_loss: 1.2305967807769775, distance_loss: 1.6136116981506348
class_loss: 1.1296310424804688, distance_loss: 1.9588768482208252
class_loss: 0.9227495789527893, distance_loss: 2.2823827266693115
class_loss: 0.9529738426208496, distance_loss: 2.5913257598876953
class_loss: 1.0096508264541626, distance_loss: 2.8657548427581787
class_loss: 0.9297817945480347, distance_loss: 3.1030445098876953
___PoisonTrain Local_Simple ,  epoch  24, local model 34, internal_epoch   2,  Average loss: 0.0172, Accuracy: 234/413 (56.6586%), train_poison_data_count: 140
Global model norm: 16.283563782627272.
Norm before scaling: 16.222616275083183. Distance: 3.990013769981697
Total norm for 2 adversaries is: 16.222616275083183. distance: 3.990013769981697
class_loss: 1.1580982208251953, distance_loss: 3.317283868789673
class_loss: 1.0322068929672241, distance_loss: 3.50730562210083
class_loss: 1.0472235679626465, distance_loss: 3.6830270290374756
class_loss: 0.9835995435714722, distance_loss: 3.8408243656158447
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.8050, Accuracy: 7681/8968 (85.6490%)
___Train Local_Simple,  epoch  24, local model 55, internal_epoch   1,  Average loss: 0.0010, Accuracy: 345/354 (97.4576%)
___Train Local_Simple,  epoch  24, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.5754, Accuracy: 8352/10000 (83.5200%)
___Train Local_Simple,  epoch  24, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 971/998 (97.2946%)
___Train Local_Simple,  epoch  24, local model 67, internal_epoch   2,  Average loss: 0.0009, Accuracy: 978/998 (97.9960%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.2768, Accuracy: 9094/10000 (90.9400%)
___Train Local_Simple,  epoch  24, local model 56, internal_epoch   1,  Average loss: 0.0006, Accuracy: 873/880 (99.2045%)
___Train Local_Simple,  epoch  24, local model 56, internal_epoch   2,  Average loss: 0.0003, Accuracy: 876/880 (99.5455%)
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.1004, Accuracy: 9687/10000 (96.8700%)
poison local model 2 index 1
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   1,  Average loss: 0.0186, Accuracy: 415/548 (75.7299%), train_poison_data_count: 180
class_loss: 1.9205790758132935, distance_loss: 0.0
class_loss: 2.0991859436035156, distance_loss: 0.1738460510969162
class_loss: 1.3110215663909912, distance_loss: 0.49787941575050354
class_loss: 1.132310152053833, distance_loss: 0.8697580695152283
class_loss: 0.669064998626709, distance_loss: 1.2575269937515259
class_loss: 0.8456148505210876, distance_loss: 1.6135777235031128
class_loss: 0.7086187601089478, distance_loss: 1.9140360355377197
class_loss: 0.6688024401664734, distance_loss: 2.1794044971466064
class_loss: 0.8193679451942444, distance_loss: 2.4034690856933594
class_loss: 0.7290734648704529, distance_loss: 2.6028947830200195
class_loss: 0.6483985185623169, distance_loss: 2.7832438945770264
class_loss: 0.5795854926109314, distance_loss: 2.9432055950164795
class_loss: 0.8701332807540894, distance_loss: 3.0897302627563477
class_loss: 0.7079755663871765, distance_loss: 3.2224130630493164
class_loss: 0.5838775038719177, distance_loss: 3.341064453125
class_loss: 0.7406275272369385, distance_loss: 3.450618028640747
class_loss: 0.6694251298904419, distance_loss: 3.545832872390747
class_loss: 0.687639594078064, distance_loss: 3.6332380771636963
___PoisonTrain Local_Simple ,  epoch  24, local model 2, internal_epoch   2,  Average loss: 0.0113, Accuracy: 400/548 (72.9927%), train_poison_data_count: 180
Global model norm: 16.283563782627272.
Norm before scaling: 16.236985849370452. Distance: 3.7173483635376434
Total norm for 2 adversaries is: 16.236985849370452. distance: 3.7173483635376434
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 0.6792, Accuracy: 6756/8968 (75.3345%)
time spent on training: 44.39177632331848
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 2]
base_p: [-0.0009528   0.00054003 -0.00040048 ... -0.00110941 -0.00752913
 -0.00194677]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 9]
layer1_inf_time: 3.807373046875
[PAIRWISE] pred_attackers_indx:  [5 9]
layer2_inf_t: 35.048583984375
assumed final_attacker_idxs:  [2 4 5 7 9]
final_attacker_idxs is: [2, 4, 5, 7, 9]
g_attacker_idxs: [12 25 34 67  2]
g_normal_idxs: [95 97 89 55 56]
filtered_attacker_idxs: [2, 4, 5, 7, 9]
final_attacker_idxs are: [2, 4, 5, 7, 9]
num_dps: [602, 487, 1160, 492, 647, 413, 354, 998, 880, 548]
Starting performing KrMLRFL...
Num data points: [602, 487, 1160, 492, 647, 413, 354, 998, 880, 548]
Num selected data points: [602 487 492 354 880]
The chosen ones are users: [0, 1, 3, 6, 8], which are global users: [95, 97, 89, 55, 56]
___Test Local_Simple poisoned: False, epoch: 24: Average loss: 0.0683, Accuracy: 9789/10000 (97.8900%)
epoch_acc: 97.89
___Test Local_Simple poisoned: True, epoch: 24: Average loss: 12.0479, Accuracy: 53/8968 (0.5910%)
Done in 141.16368174552917 sec.
Server Epoch:25 choose agents : [4, 1, 20, 48, 55, 98, 27, 42, 0, 44].
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   1,  Average loss: 0.0011, Accuracy: 640/658 (97.2644%)
___Train Local_Simple,  epoch  25, local model 4, internal_epoch   2,  Average loss: 0.0005, Accuracy: 652/658 (99.0881%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3353, Accuracy: 9005/10000 (90.0500%)
poison local model 1 index 0
class_loss: 2.48292875289917, distance_loss: 0.0
class_loss: 2.3096375465393066, distance_loss: 0.24431689083576202
class_loss: 1.372309923171997, distance_loss: 0.6600436568260193
class_loss: 1.289920449256897, distance_loss: 1.0643023252487183
class_loss: 1.101871371269226, distance_loss: 1.3973033428192139
class_loss: 0.999652624130249, distance_loss: 1.683434247970581
class_loss: 1.2204480171203613, distance_loss: 1.9483157396316528
class_loss: 1.0921357870101929, distance_loss: 2.190782070159912
class_loss: 1.2175440788269043, distance_loss: 2.4016871452331543
class_loss: 1.1157474517822266, distance_loss: 2.5874876976013184
class_loss: 1.0726251602172852, distance_loss: 2.7556848526000977
class_loss: 0.7965684533119202, distance_loss: 2.9040045738220215
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   1,  Average loss: 0.0211, Accuracy: 438/760 (57.6316%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  25, local model 1, internal_epoch   2,  Average loss: 0.0127, Accuracy: 471/760 (61.9737%), train_poison_data_count: 240
Global model norm: 16.253604430477008.
Norm before scaling: 16.362496530927345. Distance: 4.076860370624359
Total norm for 4 adversaries is: 16.362496530927345. distance: 4.076860370624359
class_loss: 0.8865182399749756, distance_loss: 3.041123390197754
class_loss: 0.8684977293014526, distance_loss: 3.168699264526367
class_loss: 0.9415124654769897, distance_loss: 3.2848963737487793
class_loss: 0.9003561735153198, distance_loss: 3.385641574859619
class_loss: 0.738103449344635, distance_loss: 3.4768922328948975
class_loss: 0.9317137002944946, distance_loss: 3.5662648677825928
class_loss: 0.7884872555732727, distance_loss: 3.6561968326568604
class_loss: 0.8354725241661072, distance_loss: 3.7437219619750977
class_loss: 0.7019656300544739, distance_loss: 3.8246383666992188
class_loss: 0.6962720155715942, distance_loss: 3.9008164405822754
class_loss: 0.6166263222694397, distance_loss: 3.9682273864746094
class_loss: 0.7450548410415649, distance_loss: 4.0255537033081055
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.0253, Accuracy: 4724/8968 (52.6762%)
poison local model 20 index 1
class_loss: 4.426616668701172, distance_loss: 0.0
class_loss: 2.3454084396362305, distance_loss: 0.3648376166820526
class_loss: 1.4364858865737915, distance_loss: 0.8608049154281616
class_loss: 1.4954206943511963, distance_loss: 1.3226369619369507
class_loss: 1.4312562942504883, distance_loss: 1.7034424543380737
class_loss: 1.1726619005203247, distance_loss: 2.038151264190674
class_loss: 1.0818158388137817, distance_loss: 2.3487062454223633
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   1,  Average loss: 0.0312, Accuracy: 219/429 (51.0490%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  25, local model 20, internal_epoch   2,  Average loss: 0.0171, Accuracy: 225/429 (52.4476%), train_poison_data_count: 140
Global model norm: 16.253604430477008.
Norm before scaling: 16.23265676061108. Distance: 4.055436552092975
Total norm for 4 adversaries is: 16.23265676061108. distance: 4.055436552092975
class_loss: 1.254785418510437, distance_loss: 2.642439603805542
class_loss: 1.1505234241485596, distance_loss: 2.9109740257263184
class_loss: 1.0920430421829224, distance_loss: 3.1533679962158203
class_loss: 0.8766217231750488, distance_loss: 3.3727171421051025
class_loss: 1.1490428447723389, distance_loss: 3.573727607727051
class_loss: 0.9256477355957031, distance_loss: 3.7526814937591553
class_loss: 0.8739308714866638, distance_loss: 3.9101595878601074
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.7320, Accuracy: 7078/8968 (78.9251%)
___Train Local_Simple,  epoch  25, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 443/448 (98.8839%)
___Train Local_Simple,  epoch  25, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 444/448 (99.1071%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.1158, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  25, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 349/354 (98.5876%)
___Train Local_Simple,  epoch  25, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.4907, Accuracy: 8523/10000 (85.2300%)
___Train Local_Simple,  epoch  25, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 797/818 (97.4328%)
___Train Local_Simple,  epoch  25, local model 98, internal_epoch   2,  Average loss: 0.0007, Accuracy: 805/818 (98.4108%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3580, Accuracy: 9011/10000 (90.1100%)
poison local model 27 index 2
___PoisonTrain Local_Simple ,  epoch  25, local model 27, internal_epoch   1,  Average loss: 0.0354, Accuracy: 240/471 (50.9554%), train_poison_data_count: 160
class_loss: 4.0381855964660645, distance_loss: 0.0
class_loss: 2.350680112838745, distance_loss: 0.35185617208480835
class_loss: 1.8410738706588745, distance_loss: 0.9053588509559631
class_loss: 2.176905393600464, distance_loss: 1.3627440929412842
class_loss: 1.5729418992996216, distance_loss: 1.7305092811584473
class_loss: 1.4531360864639282, distance_loss: 2.095797061920166
class_loss: 1.3901863098144531, distance_loss: 2.439150094985962
class_loss: 1.8650407791137695, distance_loss: 2.74760103225708
class_loss: 1.4303869009017944, distance_loss: 3.042426109313965
class_loss: 1.3091899156570435, distance_loss: 3.3071534633636475
class_loss: 1.2302985191345215, distance_loss: 3.547264337539673
class_loss: 1.1803594827651978, distance_loss: 3.7646729946136475
class_loss: 1.0231059789657593, distance_loss: 3.9631776809692383
class_loss: 1.1316980123519897, distance_loss: 4.143237590789795
class_loss: 1.0155830383300781, distance_loss: 4.303783893585205
class_loss: 1.0905675888061523, distance_loss: 4.4493937492370605
___PoisonTrain Local_Simple ,  epoch  25, local model 27, internal_epoch   2,  Average loss: 0.0200, Accuracy: 242/471 (51.3800%), train_poison_data_count: 160
Global model norm: 16.253604430477008.
Norm before scaling: 16.30709433601197. Distance: 4.600517840884532
Total norm for 4 adversaries is: 16.30709433601197. distance: 4.600517840884532
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 0.3709, Accuracy: 8137/8968 (90.7337%)
poison local model 42 index 3
___PoisonTrain Local_Simple ,  epoch  25, local model 42, internal_epoch   1,  Average loss: 0.0254, Accuracy: 174/236 (73.7288%), train_poison_data_count: 80
class_loss: 1.8421986103057861, distance_loss: 0.0
class_loss: 2.266164541244507, distance_loss: 0.17730243504047394
class_loss: 1.009021282196045, distance_loss: 0.5127564072608948
class_loss: 0.8856077790260315, distance_loss: 0.9079449772834778
class_loss: 1.36689293384552, distance_loss: 1.2130632400512695
class_loss: 0.804081916809082, distance_loss: 1.4271798133850098
class_loss: 0.8723194003105164, distance_loss: 1.6535236835479736
class_loss: 0.9145820140838623, distance_loss: 1.8677371740341187
___PoisonTrain Local_Simple ,  epoch  25, local model 42, internal_epoch   2,  Average loss: 0.0168, Accuracy: 149/236 (63.1356%), train_poison_data_count: 80
Global model norm: 16.253604430477008.
Norm before scaling: 16.05772667401896. Distance: 2.070721395167643
Total norm for 4 adversaries is: 16.05772667401896. distance: 2.070721395167643
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 1.5012, Accuracy: 3765/8968 (41.9826%)
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   1,  Average loss: 0.0017, Accuracy: 422/435 (97.0115%)
___Train Local_Simple,  epoch  25, local model 0, internal_epoch   2,  Average loss: 0.0007, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.3117, Accuracy: 8986/10000 (89.8600%)
___Train Local_Simple,  epoch  25, local model 44, internal_epoch   1,  Average loss: 0.0014, Accuracy: 504/517 (97.4855%)
___Train Local_Simple,  epoch  25, local model 44, internal_epoch   2,  Average loss: 0.0017, Accuracy: 500/517 (96.7118%)
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0986, Accuracy: 9686/10000 (96.8600%)
time spent on training: 55.28458023071289
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 20, 27, 42]
base_p: [-0.00401677  0.00023558 -0.00160388 ... -0.00428834 -0.00172053
 -0.00094077]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 7]
layer1_inf_time: 2.2783203125
[PAIRWISE] pred_attackers_indx:  [1 2 6 7]
layer2_inf_t: 504.76708984375
assumed final_attacker_idxs:  [0 1 2 6 7]
final_attacker_idxs is: [0, 1, 2, 6, 7]
g_attacker_idxs: [ 4  1 20 27 42]
g_normal_idxs: [48 55 98  0 44]
filtered_attacker_idxs: [0, 1, 2, 6, 7]
final_attacker_idxs are: [0, 1, 2, 6, 7]
num_dps: [658, 760, 429, 448, 354, 818, 471, 236, 435, 517]
Num data points: [658, 760, 429, 448, 354, 818, 471, 236, 435, 517]
Num selected data points: [448 354 818 435 517]
The chosen ones are users: [3, 4, 5, 8, 9], which are global users: [48, 55, 98, 0, 44]
___Test Local_Simple poisoned: False, epoch: 25: Average loss: 0.0604, Accuracy: 9814/10000 (98.1400%)
epoch_acc: 98.14
___Test Local_Simple poisoned: True, epoch: 25: Average loss: 12.4498, Accuracy: 12/8968 (0.1338%)
Done in 136.54910898208618 sec.
Server Epoch:26 choose agents : [25, 8, 12, 99, 53, 26, 60, 63, 52, 90].
___Train Local_Simple,  epoch  26, local model 25, internal_epoch   1,  Average loss: 0.0016, Accuracy: 629/647 (97.2179%)
___Train Local_Simple,  epoch  26, local model 25, internal_epoch   2,  Average loss: 0.0006, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.2758, Accuracy: 9144/10000 (91.4400%)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   1,  Average loss: 0.0013, Accuracy: 617/633 (97.4724%)
___Train Local_Simple,  epoch  26, local model 8, internal_epoch   2,  Average loss: 0.0005, Accuracy: 629/633 (99.3681%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0906, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1132/1160 (97.5862%)
___Train Local_Simple,  epoch  26, local model 12, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1146/1160 (98.7931%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.4403, Accuracy: 8792/10000 (87.9200%)
___Train Local_Simple,  epoch  26, local model 99, internal_epoch   1,  Average loss: 0.0008, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch  26, local model 99, internal_epoch   2,  Average loss: 0.0002, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0988, Accuracy: 9696/10000 (96.9600%)
___Train Local_Simple,  epoch  26, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 729/739 (98.6468%)
___Train Local_Simple,  epoch  26, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.3307, Accuracy: 8923/10000 (89.2300%)
poison local model 26 index 0
class_loss: 2.7439162731170654, distance_loss: 0.0
class_loss: 2.185211181640625, distance_loss: 0.22742295265197754
class_loss: 1.1652685403823853, distance_loss: 0.5995992422103882
class_loss: 0.958834171295166, distance_loss: 1.0217427015304565
class_loss: 1.221693754196167, distance_loss: 1.4088122844696045
class_loss: 0.8160426616668701, distance_loss: 1.7381927967071533
class_loss: 0.9816668629646301, distance_loss: 2.029663562774658
class_loss: 1.0905182361602783, distance_loss: 2.2849373817443848
class_loss: 0.9529784321784973, distance_loss: 2.5047214031219482
___PoisonTrain Local_Simple ,  epoch  26, local model 26, internal_epoch   1,  Average loss: 0.0219, Accuracy: 389/554 (70.2166%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  26, local model 26, internal_epoch   2,  Average loss: 0.0137, Accuracy: 348/554 (62.8159%), train_poison_data_count: 180
Global model norm: 16.237153124903468.
Norm before scaling: 16.20615516808448. Distance: 3.716104415880173
Total norm for 3 adversaries is: 16.20615516808448. distance: 3.716104415880173
class_loss: 1.1566661596298218, distance_loss: 2.6978979110717773
class_loss: 1.0271755456924438, distance_loss: 2.8674707412719727
class_loss: 0.9293617606163025, distance_loss: 3.0157899856567383
class_loss: 0.9431572556495667, distance_loss: 3.147143602371216
class_loss: 0.8289955854415894, distance_loss: 3.2638437747955322
class_loss: 0.6277019381523132, distance_loss: 3.369016647338867
class_loss: 0.8350216150283813, distance_loss: 3.4659371376037598
class_loss: 0.658186674118042, distance_loss: 3.552516460418701
class_loss: 0.574483335018158, distance_loss: 3.6359610557556152
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.1728, Accuracy: 4738/8968 (52.8323%)
___Train Local_Simple,  epoch  26, local model 60, internal_epoch   1,  Average loss: 0.0017, Accuracy: 327/338 (96.7456%)
___Train Local_Simple,  epoch  26, local model 60, internal_epoch   2,  Average loss: 0.0006, Accuracy: 335/338 (99.1124%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.1734, Accuracy: 9451/10000 (94.5100%)
poison local model 63 index 1
class_loss: 3.9802842140197754, distance_loss: 0.0
class_loss: 2.5234436988830566, distance_loss: 0.3203814625740051
class_loss: 1.4439996480941772, distance_loss: 0.8134127855300903
class_loss: 1.2721214294433594, distance_loss: 1.3253228664398193
class_loss: 1.688146710395813, distance_loss: 1.7402275800704956
class_loss: 1.48318350315094, distance_loss: 2.080265522003174
class_loss: 1.433355450630188, distance_loss: 2.3735640048980713
class_loss: 1.382358193397522, distance_loss: 2.6356725692749023
class_loss: 1.3627614974975586, distance_loss: 2.8704073429107666
class_loss: 1.270631194114685, distance_loss: 3.079892635345459
class_loss: 1.4899698495864868, distance_loss: 3.268354892730713
class_loss: 1.1677932739257812, distance_loss: 3.440235137939453
class_loss: 1.0459790229797363, distance_loss: 3.596525192260742
class_loss: 0.8709186315536499, distance_loss: 3.740856885910034
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   1,  Average loss: 0.0252, Accuracy: 433/889 (48.7064%), train_poison_data_count: 280
___PoisonTrain Local_Simple ,  epoch  26, local model 63, internal_epoch   2,  Average loss: 0.0131, Accuracy: 565/889 (63.5546%), train_poison_data_count: 280
Global model norm: 16.237153124903468.
Norm before scaling: 16.533379286015137. Distance: 5.044066412359183
Total norm for 3 adversaries is: 16.533379286015137. distance: 5.044066412359183
class_loss: 0.9661514759063721, distance_loss: 3.8797149658203125
class_loss: 0.9359204173088074, distance_loss: 4.011754512786865
class_loss: 0.8180804252624512, distance_loss: 4.13655948638916
class_loss: 0.8128623962402344, distance_loss: 4.253047943115234
class_loss: 0.896729052066803, distance_loss: 4.361655235290527
class_loss: 0.7688493132591248, distance_loss: 4.463222026824951
class_loss: 1.0181268453598022, distance_loss: 4.552542686462402
class_loss: 0.7601891756057739, distance_loss: 4.624114036560059
class_loss: 0.7405648231506348, distance_loss: 4.689600944519043
class_loss: 0.6539292931556702, distance_loss: 4.75096321105957
class_loss: 1.0087246894836426, distance_loss: 4.81289529800415
class_loss: 0.8660078644752502, distance_loss: 4.874250411987305
class_loss: 0.7058675289154053, distance_loss: 4.933116912841797
class_loss: 0.7091967463493347, distance_loss: 4.989126205444336
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 0.6383, Accuracy: 6376/8968 (71.0972%)
poison local model 52 index 2
___PoisonTrain Local_Simple ,  epoch  26, local model 52, internal_epoch   1,  Average loss: 0.0412, Accuracy: 141/253 (55.7312%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  26, local model 52, internal_epoch   2,  Average loss: 0.0250, Accuracy: 88/253 (34.7826%), train_poison_data_count: 80
Global model norm: 16.237153124903468.
Norm before scaling: 16.048257532337235. Distance: 3.041464359052674
Total norm for 3 adversaries is: 16.048257532337235. distance: 3.041464359052674
class_loss: 5.32498025894165, distance_loss: 0.0
class_loss: 2.2053468227386475, distance_loss: 0.403640478849411
class_loss: 1.229893684387207, distance_loss: 0.969704270362854
class_loss: 1.6539180278778076, distance_loss: 1.4684646129608154
class_loss: 1.702976942062378, distance_loss: 1.8708723783493042
class_loss: 1.6590570211410522, distance_loss: 2.2129154205322266
class_loss: 1.6290026903152466, distance_loss: 2.5160651206970215
class_loss: 1.345123291015625, distance_loss: 2.790483236312866
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 1.1511, Accuracy: 6947/8968 (77.4643%)
___Train Local_Simple,  epoch  26, local model 90, internal_epoch   1,  Average loss: 0.0013, Accuracy: 668/683 (97.8038%)
___Train Local_Simple,  epoch  26, local model 90, internal_epoch   2,  Average loss: 0.0005, Accuracy: 676/683 (98.9751%)
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.7878, Accuracy: 7865/10000 (78.6500%)
time spent on training: 52.14584040641785
Starting performing KrMLRFL...
Num data points: [647, 633, 1160, 377, 739, 554, 338, 889, 253, 683]
Num selected data points: [647 633 377 739 683]
The chosen ones are users: [0, 1, 3, 4, 9], which are global users: [25, 8, 99, 53, 90]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 63, 52]
base_p: [-0.00501988  0.00040528  0.00013083 ... -0.00360209 -0.00658491
 -0.00012769]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 7, 8]
layer1_inf_time: 2.878173828125
[PAIRWISE] pred_attackers_indx:  [5 7 8]
layer2_inf_t: 68.2734375
assumed final_attacker_idxs:  [2 5 6 7 8]
final_attacker_idxs is: [2, 5, 6, 7, 8]
g_attacker_idxs: [12 26 60 63 52]
g_normal_idxs: [25  8 99 53 90]
filtered_attacker_idxs: [2, 5, 6, 7, 8]
final_attacker_idxs are: [2, 5, 6, 7, 8]
num_dps: [647, 633, 1160, 377, 739, 554, 338, 889, 253, 683]
epoch_acc: 96.94
___Test Local_Simple poisoned: False, epoch: 26: Average loss: 0.0904, Accuracy: 9694/10000 (96.9400%)
___Test Local_Simple poisoned: True, epoch: 26: Average loss: 10.6482, Accuracy: 79/8968 (0.8809%)
Done in 146.76870727539062 sec.
Server Epoch:27 choose agents : [66, 33, 56, 97, 10, 13, 77, 37, 90, 59].
___Train Local_Simple,  epoch  27, local model 66, internal_epoch   1,  Average loss: 0.0015, Accuracy: 643/660 (97.4242%)
___Train Local_Simple,  epoch  27, local model 66, internal_epoch   2,  Average loss: 0.0010, Accuracy: 649/660 (98.3333%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5011, Accuracy: 8420/10000 (84.2000%)
___Train Local_Simple,  epoch  27, local model 33, internal_epoch   1,  Average loss: 0.0018, Accuracy: 602/623 (96.6292%)
___Train Local_Simple,  epoch  27, local model 33, internal_epoch   2,  Average loss: 0.0009, Accuracy: 613/623 (98.3949%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1766, Accuracy: 9440/10000 (94.4000%)
___Train Local_Simple,  epoch  27, local model 56, internal_epoch   1,  Average loss: 0.0004, Accuracy: 873/880 (99.2045%)
___Train Local_Simple,  epoch  27, local model 56, internal_epoch   2,  Average loss: 0.0002, Accuracy: 878/880 (99.7727%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1261, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch  27, local model 97, internal_epoch   1,  Average loss: 0.0006, Accuracy: 479/487 (98.3573%)
___Train Local_Simple,  epoch  27, local model 97, internal_epoch   2,  Average loss: 0.0003, Accuracy: 484/487 (99.3840%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2919, Accuracy: 9142/10000 (91.4200%)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   1,  Average loss: 0.0008, Accuracy: 879/892 (98.5426%)
___Train Local_Simple,  epoch  27, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 888/892 (99.5516%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1651, Accuracy: 9469/10000 (94.6900%)
poison local model 13 index 0
___PoisonTrain Local_Simple ,  epoch  27, local model 13, internal_epoch   1,  Average loss: 0.0222, Accuracy: 399/734 (54.3597%), train_poison_data_count: 240
class_loss: 3.314384937286377, distance_loss: 0.0
class_loss: 1.8446249961853027, distance_loss: 0.28897151350975037
class_loss: 1.6455833911895752, distance_loss: 0.7008160948753357
class_loss: 1.2465494871139526, distance_loss: 1.043968677520752
class_loss: 0.9908667802810669, distance_loss: 1.395340085029602
class_loss: 1.1392806768417358, distance_loss: 1.7268903255462646
class_loss: 1.1768298149108887, distance_loss: 2.0218021869659424
class_loss: 1.2564153671264648, distance_loss: 2.2820348739624023
class_loss: 0.9914753437042236, distance_loss: 2.5107784271240234
class_loss: 1.0277764797210693, distance_loss: 2.711233377456665
class_loss: 1.0322304964065552, distance_loss: 2.8892064094543457
class_loss: 0.6233336329460144, distance_loss: 3.048630475997925
class_loss: 0.8949326276779175, distance_loss: 3.203554391860962
class_loss: 0.6020983457565308, distance_loss: 3.3381974697113037
class_loss: 0.5726282596588135, distance_loss: 3.4614768028259277
class_loss: 0.35970020294189453, distance_loss: 3.5809824466705322
class_loss: 0.47005602717399597, distance_loss: 3.7028543949127197
class_loss: 0.31874027848243713, distance_loss: 3.818192720413208
class_loss: 0.33916783332824707, distance_loss: 3.9304592609405518
class_loss: 0.21005305647850037, distance_loss: 4.036154747009277
class_loss: 0.2102593183517456, distance_loss: 4.140635967254639
class_loss: 0.07227755337953568, distance_loss: 4.247518062591553
class_loss: 0.14111356437206268, distance_loss: 4.3492021560668945
class_loss: 0.06743364781141281, distance_loss: 4.443980693817139
___PoisonTrain Local_Simple ,  epoch  27, local model 13, internal_epoch   2,  Average loss: 0.0058, Accuracy: 635/734 (86.5123%), train_poison_data_count: 240
Global model norm: 16.20084964737575.
Norm before scaling: 16.498364916617493. Distance: 4.533833576165131
Total norm for 1 adversaries is: 16.498364916617493. distance: 4.533833576165131
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 0.0490, Accuracy: 8819/8968 (98.3385%)
___Train Local_Simple,  epoch  27, local model 77, internal_epoch   1,  Average loss: 0.0015, Accuracy: 573/589 (97.2835%)
___Train Local_Simple,  epoch  27, local model 77, internal_epoch   2,  Average loss: 0.0008, Accuracy: 585/589 (99.3209%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1002, Accuracy: 9684/10000 (96.8400%)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   1,  Average loss: 0.0005, Accuracy: 852/860 (99.0698%)
___Train Local_Simple,  epoch  27, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 853/860 (99.1860%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.1196, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch  27, local model 90, internal_epoch   1,  Average loss: 0.0008, Accuracy: 671/683 (98.2430%)
___Train Local_Simple,  epoch  27, local model 90, internal_epoch   2,  Average loss: 0.0004, Accuracy: 677/683 (99.1215%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.5618, Accuracy: 8308/10000 (83.0800%)
___Train Local_Simple,  epoch  27, local model 59, internal_epoch   1,  Average loss: 0.0016, Accuracy: 740/760 (97.3684%)
___Train Local_Simple,  epoch  27, local model 59, internal_epoch   2,  Average loss: 0.0007, Accuracy: 748/760 (98.4211%)
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.2599, Accuracy: 9163/10000 (91.6300%)
time spent on training: 35.49877572059631
Starting performing KrMLRFL...
Num data points: [660, 623, 880, 487, 892, 734, 589, 860, 683, 760]
Num selected data points: [880 487 892 860 683]
The chosen ones are users: [2, 3, 4, 7, 8], which are global users: [56, 97, 10, 37, 90]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13]
base_p: [ 0.00122277  0.0005281  -0.00074788 ... -0.0040407  -0.0023076
 -0.00164822]
[T_SCORE] attacker_local_idxs is:  [0, 1, 5, 6, 9]
layer1_inf_time: 3.237060546875
[PAIRWISE] pred_attackers_indx:  [5]
layer2_inf_t: 29.426513671875
assumed final_attacker_idxs:  [0 1 5 6 9]
final_attacker_idxs is: [0, 1, 5, 6, 9]
g_attacker_idxs: [66 33 13 77 59]
g_normal_idxs: [56 97 10 37 90]
filtered_attacker_idxs: [0, 1, 5, 6, 9]
final_attacker_idxs are: [0, 1, 5, 6, 9]
num_dps: [660, 623, 880, 487, 892, 734, 589, 860, 683, 760]
epoch_acc: 97.87
___Test Local_Simple poisoned: False, epoch: 27: Average loss: 0.0673, Accuracy: 9787/10000 (97.8700%)
___Test Local_Simple poisoned: True, epoch: 27: Average loss: 13.3978, Accuracy: 11/8968 (0.1227%)
Done in 138.08935260772705 sec.
Server Epoch:28 choose agents : [55, 58, 88, 23, 39, 75, 82, 61, 95, 93].
___Train Local_Simple,  epoch  28, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch  28, local model 55, internal_epoch   2,  Average loss: 0.0008, Accuracy: 351/354 (99.1525%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.3356, Accuracy: 8944/10000 (89.4400%)
___Train Local_Simple,  epoch  28, local model 58, internal_epoch   1,  Average loss: 0.0019, Accuracy: 268/276 (97.1014%)
___Train Local_Simple,  epoch  28, local model 58, internal_epoch   2,  Average loss: 0.0005, Accuracy: 274/276 (99.2754%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.7988, Accuracy: 8352/10000 (83.5200%)
___Train Local_Simple,  epoch  28, local model 88, internal_epoch   1,  Average loss: 0.0012, Accuracy: 527/530 (99.4340%)
___Train Local_Simple,  epoch  28, local model 88, internal_epoch   2,  Average loss: 0.0006, Accuracy: 524/530 (98.8679%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2865, Accuracy: 9163/10000 (91.6300%)
___Train Local_Simple,  epoch  28, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch  28, local model 23, internal_epoch   2,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1140, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  28, local model 39, internal_epoch   1,  Average loss: 0.0010, Accuracy: 252/257 (98.0545%)
___Train Local_Simple,  epoch  28, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1101, Accuracy: 9646/10000 (96.4600%)
___Train Local_Simple,  epoch  28, local model 75, internal_epoch   1,  Average loss: 0.0011, Accuracy: 669/686 (97.5219%)
___Train Local_Simple,  epoch  28, local model 75, internal_epoch   2,  Average loss: 0.0017, Accuracy: 670/686 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.1765, Accuracy: 9512/10000 (95.1200%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   1,  Average loss: 0.0013, Accuracy: 698/713 (97.8962%)
___Train Local_Simple,  epoch  28, local model 82, internal_epoch   2,  Average loss: 0.0004, Accuracy: 706/713 (99.0182%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.2460, Accuracy: 9181/10000 (91.8100%)
poison local model 61 index 0
___PoisonTrain Local_Simple ,  epoch  28, local model 61, internal_epoch   1,  Average loss: 0.0258, Accuracy: 374/699 (53.5050%), train_poison_data_count: 220
class_loss: 4.146778106689453, distance_loss: 0.0
class_loss: 2.6922128200531006, distance_loss: 0.35122406482696533
class_loss: 1.304157018661499, distance_loss: 0.9119138121604919
class_loss: 1.6834720373153687, distance_loss: 1.4275203943252563
class_loss: 1.4670640230178833, distance_loss: 1.895349144935608
class_loss: 1.3470104932785034, distance_loss: 2.311511993408203
class_loss: 1.1571688652038574, distance_loss: 2.6903622150421143
class_loss: 1.1736879348754883, distance_loss: 3.035459518432617
class_loss: 1.0871822834014893, distance_loss: 3.3510701656341553
class_loss: 0.860118567943573, distance_loss: 3.638545036315918
class_loss: 1.1019128561019897, distance_loss: 3.8993358612060547
class_loss: 0.8380637168884277, distance_loss: 4.132663249969482
class_loss: 1.0643783807754517, distance_loss: 4.3405303955078125
class_loss: 0.7398852705955505, distance_loss: 4.52376651763916
___PoisonTrain Local_Simple ,  epoch  28, local model 61, internal_epoch   2,  Average loss: 0.0128, Accuracy: 450/699 (64.3777%), train_poison_data_count: 220
Global model norm: 16.15786965255582.
Norm before scaling: 16.45393739091232. Distance: 5.564921848402995
Total norm for 2 adversaries is: 16.45393739091232. distance: 5.564921848402995
class_loss: 0.8300666809082031, distance_loss: 4.690512657165527
class_loss: 0.8368247151374817, distance_loss: 4.8390092849731445
class_loss: 0.8123791813850403, distance_loss: 4.972925662994385
class_loss: 0.8421847820281982, distance_loss: 5.09467077255249
class_loss: 0.7529587149620056, distance_loss: 5.205207824707031
class_loss: 0.8319344520568848, distance_loss: 5.307278633117676
class_loss: 0.7281163334846497, distance_loss: 5.399727821350098
class_loss: 0.6428232192993164, distance_loss: 5.4848456382751465
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.0981, Accuracy: 4308/8968 (48.0375%)
___Train Local_Simple,  epoch  28, local model 95, internal_epoch   1,  Average loss: 0.0005, Accuracy: 597/602 (99.1694%)
___Train Local_Simple,  epoch  28, local model 95, internal_epoch   2,  Average loss: 0.0006, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.9556, Accuracy: 7616/10000 (76.1600%)
poison local model 93 index 1
class_loss: 4.432936191558838, distance_loss: 0.0
class_loss: 1.933640718460083, distance_loss: 0.42013126611709595
class_loss: 2.0523462295532227, distance_loss: 0.9770984053611755
class_loss: 1.6879676580429077, distance_loss: 1.3695697784423828
class_loss: 1.4139299392700195, distance_loss: 1.7236268520355225
class_loss: 1.5555419921875, distance_loss: 2.0518500804901123
class_loss: 1.2604507207870483, distance_loss: 2.3522589206695557
class_loss: 1.2281129360198975, distance_loss: 2.6263325214385986
class_loss: 1.19210684299469, distance_loss: 2.8810698986053467
class_loss: 1.2910020351409912, distance_loss: 3.1218647956848145
___PoisonTrain Local_Simple ,  epoch  28, local model 93, internal_epoch   1,  Average loss: 0.0290, Accuracy: 310/623 (49.7592%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  28, local model 93, internal_epoch   2,  Average loss: 0.0151, Accuracy: 344/623 (55.2167%), train_poison_data_count: 200
Global model norm: 16.15786965255582.
Norm before scaling: 16.343466178223945. Distance: 4.809940995391772
Total norm for 2 adversaries is: 16.343466178223945. distance: 4.809940995391772
class_loss: 1.1990166902542114, distance_loss: 3.348248243331909
class_loss: 1.120145320892334, distance_loss: 3.5594069957733154
class_loss: 0.9431613087654114, distance_loss: 3.7498886585235596
class_loss: 1.1059362888336182, distance_loss: 3.9225621223449707
class_loss: 0.9107311367988586, distance_loss: 4.080417633056641
class_loss: 0.8253309726715088, distance_loss: 4.221839904785156
class_loss: 0.8940593600273132, distance_loss: 4.35506010055542
class_loss: 0.7535549998283386, distance_loss: 4.48413610458374
class_loss: 0.7890810370445251, distance_loss: 4.604260444641113
class_loss: 0.8835881948471069, distance_loss: 4.711756706237793
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 1.0154, Accuracy: 4408/8968 (49.1525%)
time spent on training: 43.76629185676575
Starting performing KrMLRFL...
Num data points: [354, 276, 530, 293, 257, 686, 713, 699, 602, 623]
Num selected data points: [354 276 293 257 713]
The chosen ones are users: [0, 1, 3, 4, 6], which are global users: [55, 58, 23, 39, 82]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 93]
base_p: [-0.00476811  0.00030573 -0.00015942 ... -0.00272612 -0.01449717
 -0.00253789]
[T_SCORE] attacker_local_idxs is:  [2, 5, 7, 8, 9]
layer1_inf_time: 2.760986328125
[PAIRWISE] pred_attackers_indx:  [7 9]
layer2_inf_t: 27.696044921875
assumed final_attacker_idxs:  [2 5 7 8 9]
final_attacker_idxs is: [2, 5, 7, 8, 9]
g_attacker_idxs: [88 75 61 95 93]
g_normal_idxs: [55 58 23 39 82]
filtered_attacker_idxs: [2, 5, 7, 8, 9]
final_attacker_idxs are: [2, 5, 7, 8, 9]
num_dps: [354, 276, 530, 293, 257, 686, 713, 699, 602, 623]
epoch_acc: 98.07000000000001
___Test Local_Simple poisoned: False, epoch: 28: Average loss: 0.0621, Accuracy: 9807/10000 (98.0700%)
___Test Local_Simple poisoned: True, epoch: 28: Average loss: 11.9356, Accuracy: 32/8968 (0.3568%)
Done in 142.7685685157776 sec.
Server Epoch:29 choose agents : [37, 43, 50, 84, 25, 28, 8, 16, 6, 3].
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 854/860 (99.3023%)
___Train Local_Simple,  epoch  29, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 854/860 (99.3023%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2020, Accuracy: 9445/10000 (94.4500%)
___Train Local_Simple,  epoch  29, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 400/408 (98.0392%)
___Train Local_Simple,  epoch  29, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0627, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch  29, local model 50, internal_epoch   1,  Average loss: 0.0016, Accuracy: 461/474 (97.2574%)
___Train Local_Simple,  epoch  29, local model 50, internal_epoch   2,  Average loss: 0.0006, Accuracy: 469/474 (98.9451%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.2795, Accuracy: 9094/10000 (90.9400%)
___Train Local_Simple,  epoch  29, local model 84, internal_epoch   1,  Average loss: 0.0014, Accuracy: 1222/1246 (98.0738%)
___Train Local_Simple,  epoch  29, local model 84, internal_epoch   2,  Average loss: 0.0022, Accuracy: 1196/1246 (95.9872%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1743, Accuracy: 9452/10000 (94.5200%)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   1,  Average loss: 0.0006, Accuracy: 638/647 (98.6090%)
___Train Local_Simple,  epoch  29, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1484, Accuracy: 9536/10000 (95.3600%)
___Train Local_Simple,  epoch  29, local model 28, internal_epoch   1,  Average loss: 0.0010, Accuracy: 487/501 (97.2056%)
___Train Local_Simple,  epoch  29, local model 28, internal_epoch   2,  Average loss: 0.0005, Accuracy: 493/501 (98.4032%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1193, Accuracy: 9604/10000 (96.0400%)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   1,  Average loss: 0.0007, Accuracy: 622/633 (98.2622%)
___Train Local_Simple,  epoch  29, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 631/633 (99.6840%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0846, Accuracy: 9715/10000 (97.1500%)
poison local model 16 index 0
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   1,  Average loss: 0.0172, Accuracy: 620/915 (67.7596%), train_poison_data_count: 299
class_loss: 2.7659223079681396, distance_loss: 0.0
class_loss: 1.990113377571106, distance_loss: 0.27493706345558167
class_loss: 1.0110160112380981, distance_loss: 0.6642503142356873
class_loss: 1.2194106578826904, distance_loss: 0.975365161895752
class_loss: 1.2651159763336182, distance_loss: 1.2557547092437744
class_loss: 1.103357195854187, distance_loss: 1.542607307434082
class_loss: 0.7536463737487793, distance_loss: 1.8220239877700806
class_loss: 0.840143084526062, distance_loss: 2.082087993621826
class_loss: 0.9412194490432739, distance_loss: 2.3141400814056396
class_loss: 0.7423915863037109, distance_loss: 2.5139665603637695
class_loss: 0.7245628833770752, distance_loss: 2.6962738037109375
class_loss: 0.828761637210846, distance_loss: 2.8581840991973877
class_loss: 0.5671122074127197, distance_loss: 3.0086669921875
class_loss: 0.7269245386123657, distance_loss: 3.1482367515563965
class_loss: 0.22995443642139435, distance_loss: 3.273984909057617
___PoisonTrain Local_Simple ,  epoch  29, local model 16, internal_epoch   2,  Average loss: 0.0039, Accuracy: 845/915 (92.3497%), train_poison_data_count: 299
Global model norm: 16.110251135546914.
Norm before scaling: 16.51706437377247. Distance: 4.583994153097262
Total norm for 1 adversaries is: 16.51706437377247. distance: 4.583994153097262
class_loss: 0.6198443174362183, distance_loss: 3.417301893234253
class_loss: 0.4241059422492981, distance_loss: 3.5438194274902344
class_loss: 0.49259960651397705, distance_loss: 3.6590306758880615
class_loss: 0.2518369257450104, distance_loss: 3.7609615325927734
class_loss: 0.24872763454914093, distance_loss: 3.853616952896118
class_loss: 0.26986929774284363, distance_loss: 3.940410614013672
class_loss: 0.21859556436538696, distance_loss: 4.02071475982666
class_loss: 0.1282072365283966, distance_loss: 4.095841884613037
class_loss: 0.11944784224033356, distance_loss: 4.167304039001465
class_loss: 0.15664760768413544, distance_loss: 4.2352519035339355
class_loss: 0.19910632073879242, distance_loss: 4.300612926483154
class_loss: 0.14214786887168884, distance_loss: 4.364408016204834
class_loss: 0.2164386361837387, distance_loss: 4.425369739532471
class_loss: 0.09473563730716705, distance_loss: 4.480231285095215
class_loss: 0.000687938358169049, distance_loss: 4.533513069152832
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 0.1041, Accuracy: 8676/8968 (96.7440%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   1,  Average loss: 0.0010, Accuracy: 605/615 (98.3740%)
___Train Local_Simple,  epoch  29, local model 6, internal_epoch   2,  Average loss: 0.0005, Accuracy: 609/615 (99.0244%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1711, Accuracy: 9458/10000 (94.5800%)
___Train Local_Simple,  epoch  29, local model 3, internal_epoch   1,  Average loss: 0.0009, Accuracy: 905/923 (98.0498%)
___Train Local_Simple,  epoch  29, local model 3, internal_epoch   2,  Average loss: 0.0010, Accuracy: 907/923 (98.2665%)
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.1259, Accuracy: 9630/10000 (96.3000%)
time spent on training: 35.94646644592285
Starting performing KrMLRFL...
Num data points: [860, 408, 474, 1246, 647, 501, 633, 915, 615, 923]
Num selected data points: [408 474 647 501 633]
The chosen ones are users: [1, 2, 4, 5, 6], which are global users: [43, 50, 25, 28, 8]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16]
base_p: [-2.0582080e-03  6.4650923e-04 -5.9190206e-05 ... -4.7548860e-04
 -3.6031902e-03 -4.6266243e-04]
[T_SCORE] attacker_local_idxs is:  [0, 3, 7, 8, 9]
layer1_inf_time: 2.895751953125
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 27.797607421875
assumed final_attacker_idxs:  [0 3 7 8 9]
final_attacker_idxs is: [0, 3, 7, 8, 9]
g_attacker_idxs: [37 84 16  6  3]
g_normal_idxs: [43 50 25 28  8]
filtered_attacker_idxs: [0, 3, 7, 8, 9]
final_attacker_idxs are: [0, 3, 7, 8, 9]
num_dps: [860, 408, 474, 1246, 647, 501, 633, 915, 615, 923]
___Test Local_Simple poisoned: False, epoch: 29: Average loss: 0.0489, Accuracy: 9841/10000 (98.4100%)
epoch_acc: 98.41
___Test Local_Simple poisoned: True, epoch: 29: Average loss: 12.2509, Accuracy: 19/8968 (0.2119%)
Done in 122.37667965888977 sec.
Server Epoch:30 choose agents : [23, 43, 27, 82, 37, 35, 29, 47, 11, 42].
___Train Local_Simple,  epoch  30, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  30, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0828, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch  30, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 403/408 (98.7745%)
___Train Local_Simple,  epoch  30, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 405/408 (99.2647%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0755, Accuracy: 9771/10000 (97.7100%)
poison local model 27 index 0
___PoisonTrain Local_Simple ,  epoch  30, local model 27, internal_epoch   1,  Average loss: 0.0319, Accuracy: 246/471 (52.2293%), train_poison_data_count: 160
class_loss: 3.9847869873046875, distance_loss: 0.0
class_loss: 2.4690122604370117, distance_loss: 0.3001619577407837
class_loss: 1.3418798446655273, distance_loss: 0.779847264289856
class_loss: 1.3363078832626343, distance_loss: 1.224438190460205
class_loss: 1.4741153717041016, distance_loss: 1.5780386924743652
class_loss: 1.2279400825500488, distance_loss: 1.8860048055648804
class_loss: 1.5405486822128296, distance_loss: 2.166161060333252
class_loss: 1.666488766670227, distance_loss: 2.417572498321533
class_loss: 1.304887056350708, distance_loss: 2.6629221439361572
class_loss: 1.2832934856414795, distance_loss: 2.8816394805908203
class_loss: 1.1369800567626953, distance_loss: 3.079422950744629
class_loss: 0.9685778617858887, distance_loss: 3.254085063934326
class_loss: 0.9816311001777649, distance_loss: 3.4094619750976562
class_loss: 1.134798288345337, distance_loss: 3.5491952896118164
class_loss: 0.9789479970932007, distance_loss: 3.676309823989868
class_loss: 1.2307318449020386, distance_loss: 3.7940409183502197
___PoisonTrain Local_Simple ,  epoch  30, local model 27, internal_epoch   2,  Average loss: 0.0192, Accuracy: 226/471 (47.9830%), train_poison_data_count: 160
Global model norm: 16.0930161392149.
Norm before scaling: 16.0827736765416. Distance: 3.9273535165841738
Total norm for 3 adversaries is: 16.0827736765416. distance: 3.9273535165841738
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.5865, Accuracy: 6826/8968 (76.1151%)
___Train Local_Simple,  epoch  30, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 709/713 (99.4390%)
___Train Local_Simple,  epoch  30, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.3685, Accuracy: 9028/10000 (90.2800%)
___Train Local_Simple,  epoch  30, local model 37, internal_epoch   1,  Average loss: 0.0003, Accuracy: 856/860 (99.5349%)
___Train Local_Simple,  epoch  30, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 853/860 (99.1860%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1518, Accuracy: 9550/10000 (95.5000%)
___Train Local_Simple,  epoch  30, local model 35, internal_epoch   1,  Average loss: 0.0004, Accuracy: 496/499 (99.3988%)
___Train Local_Simple,  epoch  30, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.1166, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch  30, local model 29, internal_epoch   1,  Average loss: 0.0007, Accuracy: 990/1002 (98.8024%)
___Train Local_Simple,  epoch  30, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 994/1002 (99.2016%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.2622, Accuracy: 9117/10000 (91.1700%)
___Train Local_Simple,  epoch  30, local model 47, internal_epoch   1,  Average loss: 0.0010, Accuracy: 765/776 (98.5825%)
___Train Local_Simple,  epoch  30, local model 47, internal_epoch   2,  Average loss: 0.0004, Accuracy: 767/776 (98.8402%)
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0840, Accuracy: 9735/10000 (97.3500%)
poison local model 11 index 1
___PoisonTrain Local_Simple ,  epoch  30, local model 11, internal_epoch   1,  Average loss: 0.0301, Accuracy: 315/645 (48.8372%), train_poison_data_count: 205
class_loss: 3.8430888652801514, distance_loss: 0.0
class_loss: 2.7882494926452637, distance_loss: 0.2999761402606964
class_loss: 1.3824530839920044, distance_loss: 0.8019552826881409
class_loss: 1.3666491508483887, distance_loss: 1.3380029201507568
class_loss: 1.8258461952209473, distance_loss: 1.7539918422698975
class_loss: 1.4908671379089355, distance_loss: 2.1048531532287598
class_loss: 1.4447886943817139, distance_loss: 2.414245128631592
class_loss: 1.525862693786621, distance_loss: 2.6871674060821533
class_loss: 1.4182955026626587, distance_loss: 2.9305014610290527
class_loss: 1.3141919374465942, distance_loss: 3.149718999862671
class_loss: 1.0365339517593384, distance_loss: 3.3503880500793457
class_loss: 1.2206999063491821, distance_loss: 3.556049108505249
class_loss: 1.2208093404769897, distance_loss: 3.745565176010132
class_loss: 1.270595908164978, distance_loss: 3.9082415103912354
class_loss: 1.1291762590408325, distance_loss: 4.041306495666504
class_loss: 0.9216185212135315, distance_loss: 4.164909839630127
class_loss: 0.943635880947113, distance_loss: 4.285511016845703
class_loss: 1.1957789659500122, distance_loss: 4.403771877288818
class_loss: 1.2322888374328613, distance_loss: 4.516833782196045
class_loss: 1.0233359336853027, distance_loss: 4.620344638824463
class_loss: 1.0236843824386597, distance_loss: 4.722623348236084
class_loss: 1.2804561853408813, distance_loss: 4.820970058441162
___PoisonTrain Local_Simple ,  epoch  30, local model 11, internal_epoch   2,  Average loss: 0.0193, Accuracy: 346/645 (53.6434%), train_poison_data_count: 205
Global model norm: 16.0930161392149.
Norm before scaling: 16.297332845018786. Distance: 4.942139775410281
Total norm for 3 adversaries is: 16.297332845018786. distance: 4.942139775410281
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 0.4631, Accuracy: 8184/8968 (91.2578%)
poison local model 42 index 2
___PoisonTrain Local_Simple ,  epoch  30, local model 42, internal_epoch   1,  Average loss: 0.0312, Accuracy: 169/236 (71.6102%), train_poison_data_count: 80
class_loss: 2.9864439964294434, distance_loss: 0.0
class_loss: 1.7833691835403442, distance_loss: 0.2345752865076065
class_loss: 1.3126415014266968, distance_loss: 0.6309650540351868
class_loss: 1.286218285560608, distance_loss: 1.070504903793335
class_loss: 1.3956910371780396, distance_loss: 1.461381196975708
class_loss: 1.1558468341827393, distance_loss: 1.7980070114135742
class_loss: 1.0496978759765625, distance_loss: 2.095808744430542
class_loss: 1.2704533338546753, distance_loss: 2.3587217330932617
___PoisonTrain Local_Simple ,  epoch  30, local model 42, internal_epoch   2,  Average loss: 0.0206, Accuracy: 124/236 (52.5424%), train_poison_data_count: 80
Global model norm: 16.0930161392149.
Norm before scaling: 15.878383005677877. Distance: 2.5904971027899237
Total norm for 3 adversaries is: 15.878383005677877. distance: 2.5904971027899237
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 1.1539, Accuracy: 7220/8968 (80.5085%)
time spent on training: 47.81099605560303
Starting performing KrMLRFL...
Num data points: [293, 408, 471, 713, 860, 499, 1002, 776, 645, 236]
Num selected data points: [293 408 713 499 776]
The chosen ones are users: [0, 1, 3, 5, 7], which are global users: [23, 43, 82, 35, 47]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 11, 42]
base_p: [-0.00260906  0.00038597 -0.00013208 ... -0.00097371 -0.0109302
 -0.00083834]
[T_SCORE] attacker_local_idxs is:  [2, 4, 6, 8, 9]
layer1_inf_time: 2.325927734375
[PAIRWISE] pred_attackers_indx:  [2 8 9]
layer2_inf_t: 25.22705078125
assumed final_attacker_idxs:  [2 4 6 8 9]
final_attacker_idxs is: [2, 4, 6, 8, 9]
g_attacker_idxs: [27 37 29 11 42]
g_normal_idxs: [23 43 82 35 47]
filtered_attacker_idxs: [2, 4, 6, 8, 9]
final_attacker_idxs are: [2, 4, 6, 8, 9]
num_dps: [293, 408, 471, 713, 860, 499, 1002, 776, 645, 236]
___Test Local_Simple poisoned: False, epoch: 30: Average loss: 0.0526, Accuracy: 9832/10000 (98.3200%)
epoch_acc: 98.32
___Test Local_Simple poisoned: True, epoch: 30: Average loss: 13.8089, Accuracy: 14/8968 (0.1561%)
Done in 135.93157482147217 sec.
Server Epoch:31 choose agents : [33, 12, 93, 15, 41, 97, 20, 86, 54, 52].
___Train Local_Simple,  epoch  31, local model 33, internal_epoch   1,  Average loss: 0.0011, Accuracy: 610/623 (97.9133%)
___Train Local_Simple,  epoch  31, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 615/623 (98.7159%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1961, Accuracy: 9358/10000 (93.5800%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1128/1160 (97.2414%)
___Train Local_Simple,  epoch  31, local model 12, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1145/1160 (98.7069%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2227, Accuracy: 9403/10000 (94.0300%)
poison local model 93 index 0
___PoisonTrain Local_Simple ,  epoch  31, local model 93, internal_epoch   1,  Average loss: 0.0317, Accuracy: 292/623 (46.8700%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  31, local model 93, internal_epoch   2,  Average loss: 0.0191, Accuracy: 286/623 (45.9069%), train_poison_data_count: 200
Global model norm: 16.050667646075212.
Norm before scaling: 16.307409668841398. Distance: 5.541270172543663
Total norm for 3 adversaries is: 16.307409668841398. distance: 5.541270172543663
class_loss: 3.9287002086639404, distance_loss: 0.0
class_loss: 2.743485450744629, distance_loss: 0.38291430473327637
class_loss: 1.5820825099945068, distance_loss: 0.9739400148391724
class_loss: 1.819445252418518, distance_loss: 1.4539768695831299
class_loss: 1.7923775911331177, distance_loss: 1.877071738243103
class_loss: 1.7391281127929688, distance_loss: 2.2793171405792236
class_loss: 1.7036458253860474, distance_loss: 2.6566765308380127
class_loss: 1.5827045440673828, distance_loss: 3.004446506500244
class_loss: 1.438583254814148, distance_loss: 3.321122169494629
class_loss: 1.430161714553833, distance_loss: 3.611470937728882
class_loss: 1.3218079805374146, distance_loss: 3.881519317626953
class_loss: 1.5134481191635132, distance_loss: 4.127299785614014
class_loss: 1.3782132863998413, distance_loss: 4.34650993347168
class_loss: 1.3436100482940674, distance_loss: 4.543874263763428
class_loss: 1.073089361190796, distance_loss: 4.722373962402344
class_loss: 1.0507887601852417, distance_loss: 4.8862104415893555
class_loss: 0.933379590511322, distance_loss: 5.036283016204834
class_loss: 1.182021975517273, distance_loss: 5.176113128662109
class_loss: 1.128961205482483, distance_loss: 5.304798126220703
class_loss: 0.9518555402755737, distance_loss: 5.4254279136657715
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.0039, Accuracy: 4350/8968 (48.5058%)
___Train Local_Simple,  epoch  31, local model 15, internal_epoch   1,  Average loss: 0.0008, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch  31, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0918, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch  31, local model 41, internal_epoch   1,  Average loss: 0.0009, Accuracy: 593/606 (97.8548%)
___Train Local_Simple,  epoch  31, local model 41, internal_epoch   2,  Average loss: 0.0009, Accuracy: 594/606 (98.0198%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2783, Accuracy: 9119/10000 (91.1900%)
___Train Local_Simple,  epoch  31, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 484/487 (99.3840%)
___Train Local_Simple,  epoch  31, local model 97, internal_epoch   2,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.2514, Accuracy: 9314/10000 (93.1400%)
poison local model 20 index 1
___PoisonTrain Local_Simple ,  epoch  31, local model 20, internal_epoch   1,  Average loss: 0.0360, Accuracy: 227/429 (52.9138%), train_poison_data_count: 140
class_loss: 5.684736251831055, distance_loss: 0.0
class_loss: 2.804996967315674, distance_loss: 0.45901840925216675
class_loss: 1.3418457508087158, distance_loss: 1.0273672342300415
class_loss: 1.4397177696228027, distance_loss: 1.5529545545578003
class_loss: 1.4066946506500244, distance_loss: 2.0260348320007324
class_loss: 1.459216833114624, distance_loss: 2.434183359146118
class_loss: 1.2933142185211182, distance_loss: 2.794213056564331
___PoisonTrain Local_Simple ,  epoch  31, local model 20, internal_epoch   2,  Average loss: 0.0169, Accuracy: 232/429 (54.0793%), train_poison_data_count: 140
Global model norm: 16.050667646075212.
Norm before scaling: 16.08347669679196. Distance: 4.673713245884983
Total norm for 3 adversaries is: 16.08347669679196. distance: 4.673713245884983
class_loss: 1.2338123321533203, distance_loss: 3.118804931640625
class_loss: 1.0911219120025635, distance_loss: 3.41340708732605
class_loss: 1.201429843902588, distance_loss: 3.6834592819213867
class_loss: 1.103771686553955, distance_loss: 3.9256861209869385
class_loss: 0.9294066429138184, distance_loss: 4.140939235687256
class_loss: 0.9666402339935303, distance_loss: 4.335133075714111
class_loss: 0.7221750020980835, distance_loss: 4.5112833976745605
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 0.6105, Accuracy: 6904/8968 (76.9848%)
___Train Local_Simple,  epoch  31, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch  31, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1380, Accuracy: 9592/10000 (95.9200%)
___Train Local_Simple,  epoch  31, local model 54, internal_epoch   1,  Average loss: 0.0012, Accuracy: 508/519 (97.8805%)
___Train Local_Simple,  epoch  31, local model 54, internal_epoch   2,  Average loss: 0.0009, Accuracy: 513/519 (98.8439%)
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.1783, Accuracy: 9386/10000 (93.8600%)
poison local model 52 index 2
___PoisonTrain Local_Simple ,  epoch  31, local model 52, internal_epoch   1,  Average loss: 0.0424, Accuracy: 140/253 (55.3360%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  31, local model 52, internal_epoch   2,  Average loss: 0.0234, Accuracy: 111/253 (43.8735%), train_poison_data_count: 80
Global model norm: 16.050667646075212.
Norm before scaling: 15.8265410192741. Distance: 3.130813227055795
Total norm for 3 adversaries is: 15.8265410192741. distance: 3.130813227055795
class_loss: 5.025891304016113, distance_loss: 0.0
class_loss: 2.47466778755188, distance_loss: 0.38220083713531494
class_loss: 1.396327257156372, distance_loss: 0.962352991104126
class_loss: 1.823315978050232, distance_loss: 1.4446656703948975
class_loss: 1.7258769273757935, distance_loss: 1.8361831903457642
class_loss: 1.454495906829834, distance_loss: 2.210055351257324
class_loss: 1.46662437915802, distance_loss: 2.5475893020629883
class_loss: 1.2828476428985596, distance_loss: 2.851439952850342
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 1.5496, Accuracy: 4975/8968 (55.4750%)
time spent on training: 45.60493493080139
Starting performing KrMLRFL...
Num data points: [623, 1160, 623, 401, 606, 487, 429, 250, 519, 253]
Num selected data points: [401 606 487 250 519]
The chosen ones are users: [3, 4, 5, 7, 8], which are global users: [15, 41, 97, 86, 54]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93, 20, 52]
base_p: [-3.7332624e-03  2.4832785e-04  5.6015328e-05 ... -2.7209520e-03
 -5.6601614e-03 -2.9114820e-03]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 9]
layer1_inf_time: 3.014404296875
[PAIRWISE] pred_attackers_indx:  [2 6 9]
layer2_inf_t: 163.74560546875
assumed final_attacker_idxs:  [0 1 2 6 9]
final_attacker_idxs is: [0, 1, 2, 6, 9]
g_attacker_idxs: [33 12 93 20 52]
g_normal_idxs: [15 41 97 86 54]
filtered_attacker_idxs: [0, 1, 2, 6, 9]
final_attacker_idxs are: [0, 1, 2, 6, 9]
num_dps: [623, 1160, 623, 401, 606, 487, 429, 250, 519, 253]
___Test Local_Simple poisoned: False, epoch: 31: Average loss: 0.0545, Accuracy: 9812/10000 (98.1200%)
epoch_acc: 98.11999999999999
___Test Local_Simple poisoned: True, epoch: 31: Average loss: 12.7849, Accuracy: 26/8968 (0.2899%)
Done in 138.0385410785675 sec.
Server Epoch:32 choose agents : [24, 38, 42, 32, 60, 8, 35, 92, 27, 96].
___Train Local_Simple,  epoch  32, local model 24, internal_epoch   1,  Average loss: 0.0010, Accuracy: 371/379 (97.8892%)
___Train Local_Simple,  epoch  32, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1016, Accuracy: 9654/10000 (96.5400%)
___Train Local_Simple,  epoch  32, local model 38, internal_epoch   1,  Average loss: 0.0006, Accuracy: 882/895 (98.5475%)
___Train Local_Simple,  epoch  32, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 891/895 (99.5531%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1730, Accuracy: 9489/10000 (94.8900%)
poison local model 42 index 0
___PoisonTrain Local_Simple ,  epoch  32, local model 42, internal_epoch   1,  Average loss: 0.0343, Accuracy: 165/236 (69.9153%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  32, local model 42, internal_epoch   2,  Average loss: 0.0187, Accuracy: 131/236 (55.5085%), train_poison_data_count: 80
Global model norm: 16.023125149320318.
Norm before scaling: 15.783537504385503. Distance: 2.611559016677416
Total norm for 2 adversaries is: 15.783537504385503. distance: 2.611559016677416
class_loss: 3.065857172012329, distance_loss: 0.0
class_loss: 2.597597122192383, distance_loss: 0.26342520117759705
class_loss: 1.2160508632659912, distance_loss: 0.687443196773529
class_loss: 1.2057782411575317, distance_loss: 1.1257323026657104
class_loss: 1.1016452312469482, distance_loss: 1.4848136901855469
class_loss: 0.9531357288360596, distance_loss: 1.808963656425476
class_loss: 1.1052531003952026, distance_loss: 2.1054909229278564
class_loss: 1.2527728080749512, distance_loss: 2.3719818592071533
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 1.1113, Accuracy: 6716/8968 (74.8885%)
___Train Local_Simple,  epoch  32, local model 32, internal_epoch   1,  Average loss: 0.0016, Accuracy: 952/977 (97.4411%)
___Train Local_Simple,  epoch  32, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 956/977 (97.8506%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1884, Accuracy: 9466/10000 (94.6600%)
___Train Local_Simple,  epoch  32, local model 60, internal_epoch   1,  Average loss: 0.0012, Accuracy: 332/338 (98.2249%)
___Train Local_Simple,  epoch  32, local model 60, internal_epoch   2,  Average loss: 0.0007, Accuracy: 334/338 (98.8166%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1182, Accuracy: 9593/10000 (95.9300%)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 628/633 (99.2101%)
___Train Local_Simple,  epoch  32, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 631/633 (99.6840%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0631, Accuracy: 9791/10000 (97.9100%)
___Train Local_Simple,  epoch  32, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 495/499 (99.1984%)
___Train Local_Simple,  epoch  32, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1869, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch  32, local model 92, internal_epoch   1,  Average loss: 0.0011, Accuracy: 919/937 (98.0790%)
___Train Local_Simple,  epoch  32, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 930/937 (99.2529%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.4415, Accuracy: 8679/10000 (86.7900%)
poison local model 27 index 1
class_loss: 4.0365447998046875, distance_loss: 0.0
___PoisonTrain Local_Simple ,  epoch  32, local model 27, internal_epoch   1,  Average loss: 0.0344, Accuracy: 255/471 (54.1401%), train_poison_data_count: 160
___PoisonTrain Local_Simple ,  epoch  32, local model 27, internal_epoch   2,  Average loss: 0.0196, Accuracy: 211/471 (44.7983%), train_poison_data_count: 160
Global model norm: 16.023125149320318.
Norm before scaling: 16.075868023682073. Distance: 4.529745970418049
Total norm for 2 adversaries is: 16.075868023682073. distance: 4.529745970418049
class_loss: 2.693880319595337, distance_loss: 0.3326038718223572
class_loss: 1.2239450216293335, distance_loss: 0.8523656725883484
class_loss: 2.207166910171509, distance_loss: 1.3694745302200317
class_loss: 1.5767794847488403, distance_loss: 1.7667447328567505
class_loss: 1.4925318956375122, distance_loss: 2.1232259273529053
class_loss: 1.3947266340255737, distance_loss: 2.445899486541748
class_loss: 1.5997062921524048, distance_loss: 2.7342405319213867
class_loss: 1.3235864639282227, distance_loss: 3.0123484134674072
class_loss: 1.352240800857544, distance_loss: 3.269500494003296
class_loss: 1.3257415294647217, distance_loss: 3.5040905475616455
class_loss: 1.0675638914108276, distance_loss: 3.712968111038208
class_loss: 1.1477618217468262, distance_loss: 3.9031119346618652
class_loss: 1.0509581565856934, distance_loss: 4.074763298034668
class_loss: 0.8609673976898193, distance_loss: 4.232116222381592
class_loss: 1.0937784910202026, distance_loss: 4.3774213790893555
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 0.9045, Accuracy: 5872/8968 (65.4773%)
___Train Local_Simple,  epoch  32, local model 96, internal_epoch   1,  Average loss: 0.0012, Accuracy: 659/672 (98.0655%)
___Train Local_Simple,  epoch  32, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 668/672 (99.4048%)
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.1614, Accuracy: 9494/10000 (94.9400%)
time spent on training: 43.29785108566284
Starting performing KrMLRFL...
Num data points: [379, 895, 236, 977, 338, 633, 499, 937, 471, 672]
Num selected data points: [379 895 977 633 499]
The chosen ones are users: [0, 1, 3, 5, 6], which are global users: [24, 38, 32, 8, 35]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 27]
base_p: [-0.00058635  0.00045701  0.00058339 ... -0.00229206 -0.00944381
  0.00072934]
[T_SCORE] attacker_local_idxs is:  [2, 4, 7, 8, 9]
layer1_inf_time: 3.62255859375
[PAIRWISE] pred_attackers_indx:  [2 8]
layer2_inf_t: 34.006591796875
assumed final_attacker_idxs:  [2 4 7 8 9]
final_attacker_idxs is: [2, 4, 7, 8, 9]
g_attacker_idxs: [42 60 92 27 96]
g_normal_idxs: [24 38 32  8 35]
filtered_attacker_idxs: [2, 4, 7, 8, 9]
final_attacker_idxs are: [2, 4, 7, 8, 9]
num_dps: [379, 895, 236, 977, 338, 633, 499, 937, 471, 672]
___Test Local_Simple poisoned: False, epoch: 32: Average loss: 0.0582, Accuracy: 9801/10000 (98.0100%)
epoch_acc: 98.00999999999999
___Test Local_Simple poisoned: True, epoch: 32: Average loss: 14.3648, Accuracy: 9/8968 (0.1004%)
Done in 123.46645498275757 sec.
Server Epoch:33 choose agents : [56, 82, 85, 17, 76, 61, 26, 86, 89, 75].
___Train Local_Simple,  epoch  33, local model 56, internal_epoch   1,  Average loss: 0.0003, Accuracy: 878/880 (99.7727%)
___Train Local_Simple,  epoch  33, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 880/880 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0706, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch  33, local model 82, internal_epoch   1,  Average loss: 0.0005, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch  33, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.5525, Accuracy: 8743/10000 (87.4300%)
poison local model 85 index 0
___PoisonTrain Local_Simple ,  epoch  33, local model 85, internal_epoch   1,  Average loss: 0.0345, Accuracy: 246/431 (57.0766%), train_poison_data_count: 140
class_loss: 5.285430431365967, distance_loss: 0.0
class_loss: 2.809006929397583, distance_loss: 0.3784671127796173
class_loss: 1.3641375303268433, distance_loss: 0.964938759803772
class_loss: 1.218684196472168, distance_loss: 1.5286762714385986
class_loss: 1.4465534687042236, distance_loss: 2.0245308876037598
class_loss: 1.4686782360076904, distance_loss: 2.4561352729797363
class_loss: 1.2865194082260132, distance_loss: 2.836836814880371
___PoisonTrain Local_Simple ,  epoch  33, local model 85, internal_epoch   2,  Average loss: 0.0209, Accuracy: 184/431 (42.6914%), train_poison_data_count: 140
Global model norm: 15.987208498399246.
Norm before scaling: 15.985558668294956. Distance: 4.667929523893764
Total norm for 4 adversaries is: 15.985558668294956. distance: 4.667929523893764
class_loss: 1.3681273460388184, distance_loss: 3.1709988117218018
class_loss: 1.3743559122085571, distance_loss: 3.4655840396881104
class_loss: 1.391027569770813, distance_loss: 3.724813222885132
class_loss: 1.3489196300506592, distance_loss: 3.9543681144714355
class_loss: 1.3552744388580322, distance_loss: 4.159882068634033
class_loss: 1.1524945497512817, distance_loss: 4.344826698303223
class_loss: 1.0267218351364136, distance_loss: 4.5130720138549805
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.7744, Accuracy: 7854/8968 (87.5781%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  33, local model 17, internal_epoch   1,  Average loss: 0.0360, Accuracy: 278/620 (44.8387%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  33, local model 17, internal_epoch   2,  Average loss: 0.0196, Accuracy: 290/620 (46.7742%), train_poison_data_count: 200
Global model norm: 15.987208498399246.
Norm before scaling: 16.18272959993732. Distance: 5.7491112727121045
Total norm for 4 adversaries is: 16.18272959993732. distance: 5.7491112727121045
class_loss: 5.766387462615967, distance_loss: 0.0
class_loss: 3.548769950866699, distance_loss: 0.3862221837043762
class_loss: 1.2437340021133423, distance_loss: 1.0125411748886108
class_loss: 1.759827971458435, distance_loss: 1.6233346462249756
class_loss: 1.499758005142212, distance_loss: 2.1472647190093994
class_loss: 1.7907339334487915, distance_loss: 2.595959186553955
class_loss: 1.754678726196289, distance_loss: 2.9917211532592773
class_loss: 1.8164829015731812, distance_loss: 3.341637134552002
class_loss: 1.701043725013733, distance_loss: 3.653193235397339
class_loss: 1.4503207206726074, distance_loss: 3.9309945106506348
class_loss: 1.5221389532089233, distance_loss: 4.182977676391602
class_loss: 1.4129085540771484, distance_loss: 4.410237789154053
class_loss: 1.4156922101974487, distance_loss: 4.613152027130127
class_loss: 1.195493221282959, distance_loss: 4.7973127365112305
class_loss: 1.1657556295394897, distance_loss: 4.968019485473633
class_loss: 1.087181568145752, distance_loss: 5.12703275680542
class_loss: 0.9865280389785767, distance_loss: 5.276353359222412
class_loss: 1.1998732089996338, distance_loss: 5.4140729904174805
class_loss: 1.1710606813430786, distance_loss: 5.537090301513672
class_loss: 0.983174741268158, distance_loss: 5.645333766937256
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.8791, Accuracy: 5856/8968 (65.2988%)
___Train Local_Simple,  epoch  33, local model 76, internal_epoch   1,  Average loss: 0.0013, Accuracy: 75/78 (96.1538%)
___Train Local_Simple,  epoch  33, local model 76, internal_epoch   2,  Average loss: 0.0002, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0660, Accuracy: 9798/10000 (97.9800%)
poison local model 61 index 2
___PoisonTrain Local_Simple ,  epoch  33, local model 61, internal_epoch   1,  Average loss: 0.0245, Accuracy: 400/699 (57.2246%), train_poison_data_count: 220
class_loss: 4.43884801864624, distance_loss: 0.0
class_loss: 2.204009532928467, distance_loss: 0.3469538390636444
class_loss: 1.209285020828247, distance_loss: 0.8483003377914429
class_loss: 1.6091320514678955, distance_loss: 1.3245526552200317
class_loss: 1.4307961463928223, distance_loss: 1.7238385677337646
class_loss: 1.130413293838501, distance_loss: 2.077554941177368
class_loss: 1.1810184717178345, distance_loss: 2.398547410964966
class_loss: 1.1597180366516113, distance_loss: 2.688441276550293
class_loss: 1.0403165817260742, distance_loss: 2.955770969390869
class_loss: 0.950995683670044, distance_loss: 3.1981332302093506
class_loss: 0.740718424320221, distance_loss: 3.4241890907287598
class_loss: 0.861520528793335, distance_loss: 3.6297924518585205
class_loss: 0.80571448802948, distance_loss: 3.8117430210113525
class_loss: 0.787328839302063, distance_loss: 3.9746906757354736
class_loss: 0.7363014221191406, distance_loss: 4.120762348175049
class_loss: 0.6089800000190735, distance_loss: 4.251025676727295
class_loss: 0.7506981492042542, distance_loss: 4.3697381019592285
class_loss: 0.6960182785987854, distance_loss: 4.47641658782959
class_loss: 0.719617486000061, distance_loss: 4.5741424560546875
class_loss: 0.9013469815254211, distance_loss: 4.665553569793701
class_loss: 0.7299960851669312, distance_loss: 4.749720096588135
class_loss: 0.6492924094200134, distance_loss: 4.828338623046875
___PoisonTrain Local_Simple ,  epoch  33, local model 61, internal_epoch   2,  Average loss: 0.0118, Accuracy: 449/699 (64.2346%), train_poison_data_count: 220
Global model norm: 15.987208498399246.
Norm before scaling: 16.190648071060576. Distance: 4.902891528161118
Total norm for 4 adversaries is: 16.190648071060576. distance: 4.902891528161118
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 1.0298, Accuracy: 4128/8968 (46.0303%)
poison local model 26 index 3
___PoisonTrain Local_Simple ,  epoch  33, local model 26, internal_epoch   1,  Average loss: 0.0225, Accuracy: 396/554 (71.4801%), train_poison_data_count: 180
class_loss: 4.37925910949707, distance_loss: 0.0
class_loss: 1.173060655593872, distance_loss: 0.31957733631134033
class_loss: 1.1299872398376465, distance_loss: 0.7050774693489075
class_loss: 0.529239296913147, distance_loss: 1.1662110090255737
class_loss: 0.874793529510498, distance_loss: 1.5781137943267822
class_loss: 1.243165373802185, distance_loss: 1.9253085851669312
class_loss: 1.034131407737732, distance_loss: 2.2200303077697754
class_loss: 1.0290805101394653, distance_loss: 2.4828858375549316
class_loss: 1.094270944595337, distance_loss: 2.7147927284240723
___PoisonTrain Local_Simple ,  epoch  33, local model 26, internal_epoch   2,  Average loss: 0.0146, Accuracy: 355/554 (64.0794%), train_poison_data_count: 180
Global model norm: 15.987208498399246.
Norm before scaling: 15.942973076027247. Distance: 4.001264133970639
Total norm for 4 adversaries is: 15.942973076027247. distance: 4.001264133970639
class_loss: 1.0148953199386597, distance_loss: 2.921868085861206
class_loss: 0.9804196357727051, distance_loss: 3.1044418811798096
class_loss: 1.0295131206512451, distance_loss: 3.2637264728546143
class_loss: 0.8546555042266846, distance_loss: 3.402445077896118
class_loss: 0.8386522531509399, distance_loss: 3.5249130725860596
class_loss: 0.8029325604438782, distance_loss: 3.634539842605591
class_loss: 0.8854312300682068, distance_loss: 3.7362327575683594
class_loss: 0.7936753630638123, distance_loss: 3.8300347328186035
class_loss: 0.8705834150314331, distance_loss: 3.9166040420532227
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 0.6300, Accuracy: 7143/8968 (79.6499%)
___Train Local_Simple,  epoch  33, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch  33, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0859, Accuracy: 9716/10000 (97.1600%)
___Train Local_Simple,  epoch  33, local model 89, internal_epoch   1,  Average loss: 0.0005, Accuracy: 487/492 (98.9837%)
___Train Local_Simple,  epoch  33, local model 89, internal_epoch   2,  Average loss: 0.0002, Accuracy: 489/492 (99.3902%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.2505, Accuracy: 9269/10000 (92.6900%)
___Train Local_Simple,  epoch  33, local model 75, internal_epoch   1,  Average loss: 0.0009, Accuracy: 671/686 (97.8134%)
___Train Local_Simple,  epoch  33, local model 75, internal_epoch   2,  Average loss: 0.0004, Accuracy: 682/686 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.1094, Accuracy: 9659/10000 (96.5900%)
time spent on training: 52.6858606338501
Starting performing KrMLRFL...
Num data points: [880, 713, 431, 620, 78, 699, 554, 250, 492, 686]
Num selected data points: [880 713  78 250 686]
The chosen ones are users: [0, 1, 4, 7, 9], which are global users: [56, 82, 76, 86, 75]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 17, 61, 26]
base_p: [-0.00447118  0.00028658 -0.00103907 ... -0.00252023 -0.00878769
  0.00110317]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 6, 8]
layer1_inf_time: 2.741455078125
[PAIRWISE] pred_attackers_indx:  [2 3 5 6]
layer2_inf_t: 27.942626953125
assumed final_attacker_idxs:  [2 3 5 6 8]
final_attacker_idxs is: [2, 3, 5, 6, 8]
g_attacker_idxs: [85 17 61 26 89]
g_normal_idxs: [56 82 76 86 75]
filtered_attacker_idxs: [2, 3, 5, 6, 8]
final_attacker_idxs are: [2, 3, 5, 6, 8]
num_dps: [880, 713, 431, 620, 78, 699, 554, 250, 492, 686]
___Test Local_Simple poisoned: False, epoch: 33: Average loss: 0.0567, Accuracy: 9814/10000 (98.1400%)
epoch_acc: 98.14
___Test Local_Simple poisoned: True, epoch: 33: Average loss: 15.2858, Accuracy: 9/8968 (0.1004%)
Done in 140.57133293151855 sec.
Server Epoch:34 choose agents : [36, 65, 96, 83, 63, 30, 94, 25, 52, 50].
___Train Local_Simple,  epoch  34, local model 36, internal_epoch   1,  Average loss: 0.0015, Accuracy: 981/1005 (97.6119%)
___Train Local_Simple,  epoch  34, local model 36, internal_epoch   2,  Average loss: 0.0010, Accuracy: 989/1005 (98.4080%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2588, Accuracy: 9206/10000 (92.0600%)
___Train Local_Simple,  epoch  34, local model 65, internal_epoch   1,  Average loss: 0.0007, Accuracy: 366/371 (98.6523%)
___Train Local_Simple,  epoch  34, local model 65, internal_epoch   2,  Average loss: 0.0006, Accuracy: 367/371 (98.9218%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1289, Accuracy: 9598/10000 (95.9800%)
___Train Local_Simple,  epoch  34, local model 96, internal_epoch   1,  Average loss: 0.0012, Accuracy: 657/672 (97.7679%)
___Train Local_Simple,  epoch  34, local model 96, internal_epoch   2,  Average loss: 0.0005, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1444, Accuracy: 9534/10000 (95.3400%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   1,  Average loss: 0.0009, Accuracy: 426/433 (98.3834%)
___Train Local_Simple,  epoch  34, local model 83, internal_epoch   2,  Average loss: 0.0004, Accuracy: 428/433 (98.8453%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0993, Accuracy: 9687/10000 (96.8700%)
poison local model 63 index 0
class_loss: 4.852461814880371, distance_loss: 0.0
class_loss: 2.518449306488037, distance_loss: 0.38864442706108093
___PoisonTrain Local_Simple ,  epoch  34, local model 63, internal_epoch   1,  Average loss: 0.0243, Accuracy: 468/889 (52.6434%), train_poison_data_count: 280
___PoisonTrain Local_Simple ,  epoch  34, local model 63, internal_epoch   2,  Average loss: 0.0137, Accuracy: 512/889 (57.5928%), train_poison_data_count: 280
Global model norm: 15.94426796018346.
Norm before scaling: 16.139702296956255. Distance: 4.946548668995506
Total norm for 2 adversaries is: 16.139702296956255. distance: 4.946548668995506
class_loss: 1.1693694591522217, distance_loss: 0.8918532729148865
class_loss: 1.4006294012069702, distance_loss: 1.3563764095306396
class_loss: 1.0685441493988037, distance_loss: 1.7444003820419312
class_loss: 1.21293306350708, distance_loss: 2.0841269493103027
class_loss: 1.2800469398498535, distance_loss: 2.391240358352661
class_loss: 1.2668030261993408, distance_loss: 2.6643965244293213
class_loss: 1.1429450511932373, distance_loss: 2.9071834087371826
class_loss: 1.288906216621399, distance_loss: 3.126620292663574
class_loss: 1.2149667739868164, distance_loss: 3.323387384414673
class_loss: 1.1798110008239746, distance_loss: 3.500542402267456
class_loss: 1.0246555805206299, distance_loss: 3.661194324493408
class_loss: 0.9512810111045837, distance_loss: 3.8047549724578857
class_loss: 0.9542108774185181, distance_loss: 3.934267044067383
class_loss: 0.9324445724487305, distance_loss: 4.053047180175781
class_loss: 0.8787713646888733, distance_loss: 4.162429332733154
class_loss: 0.8456560969352722, distance_loss: 4.261904716491699
class_loss: 0.8286218047142029, distance_loss: 4.3530473709106445
class_loss: 0.962658703327179, distance_loss: 4.433767795562744
class_loss: 1.083712100982666, distance_loss: 4.506622314453125
class_loss: 0.8070850968360901, distance_loss: 4.5725884437561035
class_loss: 0.9675890803337097, distance_loss: 4.634903430938721
class_loss: 0.7394338846206665, distance_loss: 4.693763256072998
class_loss: 0.7829268574714661, distance_loss: 4.753011703491211
class_loss: 0.8080640435218811, distance_loss: 4.808835983276367
class_loss: 0.7523554563522339, distance_loss: 4.8601484298706055
class_loss: 0.8273871541023254, distance_loss: 4.906681060791016
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.0364, Accuracy: 3730/8968 (41.5923%)
___Train Local_Simple,  epoch  34, local model 30, internal_epoch   1,  Average loss: 0.0013, Accuracy: 391/400 (97.7500%)
___Train Local_Simple,  epoch  34, local model 30, internal_epoch   2,  Average loss: 0.0008, Accuracy: 394/400 (98.5000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1557, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch  34, local model 94, internal_epoch   1,  Average loss: 0.0024, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  34, local model 94, internal_epoch   2,  Average loss: 0.0005, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.7850, Accuracy: 8434/10000 (84.3400%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   1,  Average loss: 0.0005, Accuracy: 642/647 (99.2272%)
___Train Local_Simple,  epoch  34, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 644/647 (99.5363%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.1801, Accuracy: 9483/10000 (94.8300%)
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  34, local model 52, internal_epoch   1,  Average loss: 0.0456, Accuracy: 138/253 (54.5455%), train_poison_data_count: 80
class_loss: 4.940741062164307, distance_loss: 0.0
class_loss: 2.9036123752593994, distance_loss: 0.41386863589286804
class_loss: 1.8629437685012817, distance_loss: 0.9930204749107361
class_loss: 1.8359967470169067, distance_loss: 1.5058047771453857
___PoisonTrain Local_Simple ,  epoch  34, local model 52, internal_epoch   2,  Average loss: 0.0215, Accuracy: 108/253 (42.6877%), train_poison_data_count: 80
Global model norm: 15.94426796018346.
Norm before scaling: 15.729147534221946. Distance: 3.3264926972956266
Total norm for 2 adversaries is: 15.729147534221946. distance: 3.3264926972956266
class_loss: 1.493463397026062, distance_loss: 1.9372503757476807
class_loss: 1.317165493965149, distance_loss: 2.3297152519226074
class_loss: 1.2618237733840942, distance_loss: 2.6893396377563477
class_loss: 1.3631408214569092, distance_loss: 3.0212981700897217
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 1.3917, Accuracy: 4564/8968 (50.8921%)
___Train Local_Simple,  epoch  34, local model 50, internal_epoch   1,  Average loss: 0.0009, Accuracy: 466/474 (98.3122%)
___Train Local_Simple,  epoch  34, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 471/474 (99.3671%)
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.2937, Accuracy: 9160/10000 (91.6000%)
time spent on training: 40.559422731399536
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 52]
base_p: [-0.00387978  0.00032824  0.00124578 ... -0.00202058 -0.01036295
 -0.00212343]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 8]
layer1_inf_time: 4.06494140625
[PAIRWISE] pred_attackers_indx:  [4 8]
layer2_inf_t: 86.52734375
assumed final_attacker_idxs:  [0 1 2 4 8]
final_attacker_idxs is: [0, 1, 2, 4, 8]
g_attacker_idxs: [36 65 96 63 52]
g_normal_idxs: [83 30 94 25 50]
filtered_attacker_idxs: [0, 1, 2, 4, 8]
final_attacker_idxs are: [0, 1, 2, 4, 8]
num_dps: [1005, 371, 672, 433, 889, 400, 150, 647, 253, 474]
Num data points: [1005, 371, 672, 433, 889, 400, 150, 647, 253, 474]
Num selected data points: [433 400 150 647 474]
The chosen ones are users: [3, 5, 6, 7, 9], which are global users: [83, 30, 94, 25, 50]
___Test Local_Simple poisoned: False, epoch: 34: Average loss: 0.0569, Accuracy: 9812/10000 (98.1200%)
epoch_acc: 98.11999999999999
___Test Local_Simple poisoned: True, epoch: 34: Average loss: 12.9660, Accuracy: 52/8968 (0.5798%)
Done in 127.07444763183594 sec.
Server Epoch:35 choose agents : [45, 6, 35, 17, 20, 73, 43, 8, 74, 3].
poison local model 45 index 0
___PoisonTrain Local_Simple ,  epoch  35, local model 45, internal_epoch   1,  Average loss: 0.0250, Accuracy: 344/628 (54.7771%), train_poison_data_count: 200
class_loss: 3.444253921508789, distance_loss: 0.0
class_loss: 2.3078677654266357, distance_loss: 0.295227587223053
class_loss: 1.5277963876724243, distance_loss: 0.7880064249038696
class_loss: 1.6775975227355957, distance_loss: 1.1657928228378296
class_loss: 1.2192968130111694, distance_loss: 1.4411354064941406
class_loss: 1.181357741355896, distance_loss: 1.7201746702194214
class_loss: 1.1743139028549194, distance_loss: 1.9938387870788574
class_loss: 1.1145498752593994, distance_loss: 2.249225378036499
class_loss: 1.0285156965255737, distance_loss: 2.4860939979553223
class_loss: 1.0343574285507202, distance_loss: 2.71012282371521
___PoisonTrain Local_Simple ,  epoch  35, local model 45, internal_epoch   2,  Average loss: 0.0138, Accuracy: 388/628 (61.7834%), train_poison_data_count: 200
Global model norm: 15.920793940237402.
Norm before scaling: 15.999267561360426. Distance: 4.339751674386095
Total norm for 4 adversaries is: 15.999267561360426. distance: 4.339751674386095
class_loss: 0.9320099353790283, distance_loss: 2.9249746799468994
class_loss: 1.0295419692993164, distance_loss: 3.1290993690490723
class_loss: 0.9353140592575073, distance_loss: 3.3173065185546875
class_loss: 0.8765869140625, distance_loss: 3.4830739498138428
class_loss: 0.8850906491279602, distance_loss: 3.635093927383423
class_loss: 0.7648945450782776, distance_loss: 3.7758712768554688
class_loss: 0.9040773510932922, distance_loss: 3.907139539718628
class_loss: 0.8053457736968994, distance_loss: 4.0280866622924805
class_loss: 0.716053307056427, distance_loss: 4.140455722808838
class_loss: 0.8381127715110779, distance_loss: 4.24493408203125
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.9729, Accuracy: 5266/8968 (58.7199%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   1,  Average loss: 0.0007, Accuracy: 606/615 (98.5366%)
___Train Local_Simple,  epoch  35, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 612/615 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1459, Accuracy: 9560/10000 (95.6000%)
___Train Local_Simple,  epoch  35, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 495/499 (99.1984%)
___Train Local_Simple,  epoch  35, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1554, Accuracy: 9533/10000 (95.3300%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  35, local model 17, internal_epoch   1,  Average loss: 0.0304, Accuracy: 308/620 (49.6774%), train_poison_data_count: 200
class_loss: 5.018032073974609, distance_loss: 0.0
class_loss: 2.793771505355835, distance_loss: 0.3630446493625641
class_loss: 1.840888500213623, distance_loss: 0.9134951233863831
class_loss: 1.2966060638427734, distance_loss: 1.3729345798492432
class_loss: 1.5273176431655884, distance_loss: 1.768568754196167
class_loss: 1.3700296878814697, distance_loss: 2.118793487548828
class_loss: 1.4201536178588867, distance_loss: 2.428042411804199
class_loss: 1.358951449394226, distance_loss: 2.698824882507324
class_loss: 1.1290210485458374, distance_loss: 2.942683458328247
class_loss: 1.0786933898925781, distance_loss: 3.1642396450042725
___PoisonTrain Local_Simple ,  epoch  35, local model 17, internal_epoch   2,  Average loss: 0.0175, Accuracy: 298/620 (48.0645%), train_poison_data_count: 200
Global model norm: 15.920793940237402.
Norm before scaling: 16.021096626304175. Distance: 4.633303019655442
Total norm for 4 adversaries is: 16.021096626304175. distance: 4.633303019655442
class_loss: 1.2829042673110962, distance_loss: 3.3715388774871826
class_loss: 1.171035885810852, distance_loss: 3.5633811950683594
class_loss: 1.4411734342575073, distance_loss: 3.737295150756836
class_loss: 0.9013543128967285, distance_loss: 3.888392448425293
class_loss: 1.1883337497711182, distance_loss: 4.025603771209717
class_loss: 1.1058769226074219, distance_loss: 4.1550984382629395
class_loss: 0.9971553683280945, distance_loss: 4.272523403167725
class_loss: 0.9047808051109314, distance_loss: 4.3782057762146
class_loss: 0.9881388545036316, distance_loss: 4.473055362701416
class_loss: 0.8922513723373413, distance_loss: 4.557183265686035
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 1.1531, Accuracy: 4439/8968 (49.4982%)
poison local model 20 index 2
___PoisonTrain Local_Simple ,  epoch  35, local model 20, internal_epoch   1,  Average loss: 0.0370, Accuracy: 210/429 (48.9510%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  35, local model 20, internal_epoch   2,  Average loss: 0.0207, Accuracy: 206/429 (48.0186%), train_poison_data_count: 140
Global model norm: 15.920793940237402.
Norm before scaling: 15.986970364504554. Distance: 5.0400671615364265
Total norm for 4 adversaries is: 15.986970364504554. distance: 5.0400671615364265
class_loss: 5.206036567687988, distance_loss: 0.0
class_loss: 2.903042793273926, distance_loss: 0.42045825719833374
class_loss: 1.5942679643630981, distance_loss: 1.0577852725982666
class_loss: 1.4341480731964111, distance_loss: 1.6253740787506104
class_loss: 1.6567820310592651, distance_loss: 2.134798526763916
class_loss: 1.747983455657959, distance_loss: 2.5761587619781494
class_loss: 1.3364293575286865, distance_loss: 2.9666497707366943
class_loss: 1.475042700767517, distance_loss: 3.322211742401123
class_loss: 1.3855539560317993, distance_loss: 3.643047571182251
class_loss: 1.3139952421188354, distance_loss: 3.9369313716888428
class_loss: 1.1435649394989014, distance_loss: 4.205838203430176
class_loss: 1.2025960683822632, distance_loss: 4.449520111083984
class_loss: 1.2393049001693726, distance_loss: 4.668270111083984
class_loss: 1.1215671300888062, distance_loss: 4.862449645996094
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.7664, Accuracy: 6738/8968 (75.1338%)
poison local model 73 index 3
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   1,  Average loss: 0.0235, Accuracy: 363/591 (61.4213%), train_poison_data_count: 195
class_loss: 3.8220479488372803, distance_loss: 0.0
class_loss: 1.5596611499786377, distance_loss: 0.41317903995513916
class_loss: 2.175161600112915, distance_loss: 0.7722741961479187
class_loss: 0.7825217247009277, distance_loss: 1.0305179357528687
class_loss: 1.0103942155838013, distance_loss: 1.3478296995162964
class_loss: 1.0449482202529907, distance_loss: 1.6629091501235962
class_loss: 0.8953410983085632, distance_loss: 1.9578412771224976
class_loss: 0.8986549377441406, distance_loss: 2.224229097366333
class_loss: 0.9128604531288147, distance_loss: 2.467371702194214
class_loss: 0.8164581060409546, distance_loss: 2.6892898082733154
___PoisonTrain Local_Simple ,  epoch  35, local model 73, internal_epoch   2,  Average loss: 0.0120, Accuracy: 411/591 (69.5431%), train_poison_data_count: 195
Global model norm: 15.920793940237402.
Norm before scaling: 16.147416967026995. Distance: 4.407460580737161
Total norm for 4 adversaries is: 16.147416967026995. distance: 4.407460580737161
class_loss: 1.4939461946487427, distance_loss: 2.9333479404449463
class_loss: 1.4464985132217407, distance_loss: 3.1210238933563232
class_loss: 0.8317515254020691, distance_loss: 3.270533561706543
class_loss: 0.7086427807807922, distance_loss: 3.412431240081787
class_loss: 0.5726357102394104, distance_loss: 3.5547096729278564
class_loss: 0.6543569564819336, distance_loss: 3.700653553009033
class_loss: 0.540859043598175, distance_loss: 3.8484063148498535
class_loss: 0.42392054200172424, distance_loss: 3.9949452877044678
class_loss: 0.3900532126426697, distance_loss: 4.138608455657959
class_loss: 0.031500738114118576, distance_loss: 4.274282455444336
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 0.0128, Accuracy: 8964/8968 (99.9554%)
___Train Local_Simple,  epoch  35, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 403/408 (98.7745%)
___Train Local_Simple,  epoch  35, local model 43, internal_epoch   2,  Average loss: 0.0010, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0819, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 625/633 (98.7362%)
___Train Local_Simple,  epoch  35, local model 8, internal_epoch   2,  Average loss: 0.0004, Accuracy: 629/633 (99.3681%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0803, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch  35, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 547/557 (98.2047%)
___Train Local_Simple,  epoch  35, local model 74, internal_epoch   2,  Average loss: 0.0008, Accuracy: 547/557 (98.2047%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.1039, Accuracy: 9667/10000 (96.6700%)
___Train Local_Simple,  epoch  35, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 902/923 (97.7248%)
___Train Local_Simple,  epoch  35, local model 3, internal_epoch   2,  Average loss: 0.0008, Accuracy: 906/923 (98.1582%)
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.3282, Accuracy: 8890/10000 (88.9000%)
time spent on training: 52.06023693084717
Starting performing KrMLRFL...
Num data points: [628, 615, 499, 620, 429, 591, 408, 633, 557, 923]
Num selected data points: [615 499 408 633 557]
The chosen ones are users: [1, 2, 6, 7, 8], which are global users: [6, 35, 43, 8, 74]
___Test Local_Simple poisoned: False, epoch: 35: Average loss: 0.0468, Accuracy: 9843/10000 (98.4300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 17, 20, 73]
base_p: [ 0.00923339  0.00019429 -0.00024296 ... -0.00392445 -0.00782872
 -0.00371163]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 5, 9]
layer1_inf_time: 3.57470703125
[PAIRWISE] pred_attackers_indx:  [0 3 4 5]
layer2_inf_t: 30.462890625
assumed final_attacker_idxs:  [0 3 4 5 9]
final_attacker_idxs is: [0, 3, 4, 5, 9]
g_attacker_idxs: [45 17 20 73  3]
g_normal_idxs: [ 6 35 43  8 74]
filtered_attacker_idxs: [0, 3, 4, 5, 9]
final_attacker_idxs are: [0, 3, 4, 5, 9]
num_dps: [628, 615, 499, 620, 429, 591, 408, 633, 557, 923]
epoch_acc: 98.42999999999999
___Test Local_Simple poisoned: True, epoch: 35: Average loss: 12.5288, Accuracy: 40/8968 (0.4460%)
Done in 143.4745750427246 sec.
Server Epoch:36 choose agents : [39, 14, 32, 4, 30, 63, 23, 3, 94, 84].
___Train Local_Simple,  epoch  36, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  36, local model 39, internal_epoch   2,  Average loss: 0.0004, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0713, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   1,  Average loss: 0.0009, Accuracy: 370/376 (98.4043%)
___Train Local_Simple,  epoch  36, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1877, Accuracy: 9485/10000 (94.8500%)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 958/977 (98.0553%)
___Train Local_Simple,  epoch  36, local model 32, internal_epoch   2,  Average loss: 0.0004, Accuracy: 973/977 (99.5906%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1412, Accuracy: 9564/10000 (95.6400%)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 648/658 (98.4802%)
___Train Local_Simple,  epoch  36, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 655/658 (99.5441%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1645, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  36, local model 30, internal_epoch   1,  Average loss: 0.0010, Accuracy: 392/400 (98.0000%)
___Train Local_Simple,  epoch  36, local model 30, internal_epoch   2,  Average loss: 0.0002, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1053, Accuracy: 9664/10000 (96.6400%)
poison local model 63 index 0
___PoisonTrain Local_Simple ,  epoch  36, local model 63, internal_epoch   1,  Average loss: 0.0200, Accuracy: 600/889 (67.4916%), train_poison_data_count: 280
class_loss: 3.0013160705566406, distance_loss: 0.0
class_loss: 2.427187919616699, distance_loss: 0.33390891551971436
class_loss: 1.4184744358062744, distance_loss: 0.8249025344848633
class_loss: 1.9532878398895264, distance_loss: 1.2364100217819214
class_loss: 1.1487324237823486, distance_loss: 1.530898094177246
class_loss: 1.13212251663208, distance_loss: 1.8293620347976685
class_loss: 1.065293550491333, distance_loss: 2.120169162750244
class_loss: 1.1029738187789917, distance_loss: 2.3918070793151855
class_loss: 0.9024167060852051, distance_loss: 2.648758888244629
class_loss: 0.8086027503013611, distance_loss: 2.8890106678009033
class_loss: 0.6329067945480347, distance_loss: 3.118340253829956
class_loss: 0.5038944482803345, distance_loss: 3.337064027786255
class_loss: 0.8831770420074463, distance_loss: 3.538778066635132
class_loss: 0.8136046528816223, distance_loss: 3.719637393951416
___PoisonTrain Local_Simple ,  epoch  36, local model 63, internal_epoch   2,  Average loss: 0.0047, Accuracy: 815/889 (91.6760%), train_poison_data_count: 280
Global model norm: 15.87885291734586.
Norm before scaling: 16.460722441642144. Distance: 5.28175216183492
Total norm for 1 adversaries is: 16.460722441642144. distance: 5.28175216183492
class_loss: 0.534544825553894, distance_loss: 3.879763603210449
class_loss: 0.1951095461845398, distance_loss: 4.025370121002197
class_loss: 0.5527640581130981, distance_loss: 4.163507461547852
class_loss: 0.680156946182251, distance_loss: 4.289727687835693
class_loss: 0.27084386348724365, distance_loss: 4.408000946044922
class_loss: 0.2824617028236389, distance_loss: 4.5221357345581055
class_loss: 0.2774641513824463, distance_loss: 4.63468599319458
class_loss: 0.2691885828971863, distance_loss: 4.742306232452393
class_loss: 0.1550898402929306, distance_loss: 4.841736316680908
class_loss: 0.27072733640670776, distance_loss: 4.93344783782959
class_loss: 0.2654460072517395, distance_loss: 5.01558256149292
class_loss: 0.23762039840221405, distance_loss: 5.088389873504639
class_loss: 0.08557562530040741, distance_loss: 5.158198833465576
class_loss: 0.06104525178670883, distance_loss: 5.222411155700684
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 0.1084, Accuracy: 8636/8968 (96.2979%)
___Train Local_Simple,  epoch  36, local model 23, internal_epoch   1,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Train Local_Simple,  epoch  36, local model 23, internal_epoch   2,  Average loss: 0.0007, Accuracy: 290/293 (98.9761%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0705, Accuracy: 9755/10000 (97.5500%)
___Train Local_Simple,  epoch  36, local model 3, internal_epoch   1,  Average loss: 0.0008, Accuracy: 909/923 (98.4832%)
___Train Local_Simple,  epoch  36, local model 3, internal_epoch   2,  Average loss: 0.0005, Accuracy: 917/923 (99.3499%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1229, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  36, local model 94, internal_epoch   2,  Average loss: 0.0004, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1658, Accuracy: 9445/10000 (94.4500%)
___Train Local_Simple,  epoch  36, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1219/1246 (97.8331%)
___Train Local_Simple,  epoch  36, local model 84, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1226/1246 (98.3949%)
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.1511, Accuracy: 9581/10000 (95.8100%)
time spent on training: 35.34019875526428
Starting performing KrMLRFL...
Num data points: [257, 376, 977, 658, 400, 889, 293, 923, 150, 1246]
Num selected data points: [257 376 400 293 150]
The chosen ones are users: [0, 1, 4, 6, 8], which are global users: [39, 14, 30, 23, 94]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63]
base_p: [-0.00229463  0.00043078  0.00038178 ... -0.00087566 -0.00115427
  0.00051036]
[T_SCORE] attacker_local_idxs is:  [2, 3, 5, 7, 9]
layer1_inf_time: 2.813232421875
[PAIRWISE] pred_attackers_indx:  [5]
layer2_inf_t: 33.32568359375
assumed final_attacker_idxs:  [2 3 5 7 9]
final_attacker_idxs is: [2, 3, 5, 7, 9]
g_attacker_idxs: [32  4 63  3 84]
g_normal_idxs: [39 14 30 23 94]
filtered_attacker_idxs: [2, 3, 5, 7, 9]
final_attacker_idxs are: [2, 3, 5, 7, 9]
num_dps: [257, 376, 977, 658, 400, 889, 293, 923, 150, 1246]
___Test Local_Simple poisoned: False, epoch: 36: Average loss: 0.0511, Accuracy: 9837/10000 (98.3700%)
epoch_acc: 98.37
___Test Local_Simple poisoned: True, epoch: 36: Average loss: 11.6990, Accuracy: 39/8968 (0.4349%)
Done in 126.41934514045715 sec.
Server Epoch:37 choose agents : [69, 2, 42, 25, 17, 37, 45, 54, 30, 0].
___Train Local_Simple,  epoch  37, local model 69, internal_epoch   1,  Average loss: 0.0013, Accuracy: 251/256 (98.0469%)
___Train Local_Simple,  epoch  37, local model 69, internal_epoch   2,  Average loss: 0.0005, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1979, Accuracy: 9250/10000 (92.5000%)
poison local model 2 index 0
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   1,  Average loss: 0.0176, Accuracy: 427/548 (77.9197%), train_poison_data_count: 180
class_loss: 2.3544960021972656, distance_loss: 0.0
class_loss: 1.2969436645507812, distance_loss: 0.22731532156467438
class_loss: 0.7460644841194153, distance_loss: 0.5348332524299622
class_loss: 0.8203310370445251, distance_loss: 0.8516748547554016
class_loss: 1.5686745643615723, distance_loss: 1.17971670627594
class_loss: 0.8462013006210327, distance_loss: 1.5110901594161987
class_loss: 0.7501268982887268, distance_loss: 1.7879070043563843
class_loss: 0.7039458155632019, distance_loss: 2.0360002517700195
class_loss: 0.5498178601264954, distance_loss: 2.262464761734009
___PoisonTrain Local_Simple ,  epoch  37, local model 2, internal_epoch   2,  Average loss: 0.0103, Accuracy: 400/548 (72.9927%), train_poison_data_count: 180
Global model norm: 15.854011177306399.
Norm before scaling: 15.794564792280257. Distance: 3.5716317909188713
Total norm for 4 adversaries is: 15.794564792280257. distance: 3.5716317909188713
class_loss: 1.0110520124435425, distance_loss: 2.4669461250305176
class_loss: 0.6320341229438782, distance_loss: 2.645571708679199
class_loss: 0.7261842489242554, distance_loss: 2.8043339252471924
class_loss: 0.5427988171577454, distance_loss: 2.9461615085601807
class_loss: 0.6442083716392517, distance_loss: 3.0767626762390137
class_loss: 0.5010993480682373, distance_loss: 3.1948251724243164
class_loss: 0.385222464799881, distance_loss: 3.3014185428619385
class_loss: 0.39083173871040344, distance_loss: 3.4010913372039795
class_loss: 0.7980489134788513, distance_loss: 3.4899187088012695
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.8613, Accuracy: 5551/8968 (61.8979%)
poison local model 42 index 1
___PoisonTrain Local_Simple ,  epoch  37, local model 42, internal_epoch   1,  Average loss: 0.0274, Accuracy: 167/236 (70.7627%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  37, local model 42, internal_epoch   2,  Average loss: 0.0190, Accuracy: 136/236 (57.6271%), train_poison_data_count: 80
Global model norm: 15.854011177306399.
Norm before scaling: 15.652449521572994. Distance: 2.098764819239996
Total norm for 4 adversaries is: 15.652449521572994. distance: 2.098764819239996
class_loss: 2.2083065509796143, distance_loss: 0.0
class_loss: 1.5844143629074097, distance_loss: 0.2176564335823059
class_loss: 1.1317671537399292, distance_loss: 0.5661213994026184
class_loss: 1.538991093635559, distance_loss: 0.9058200716972351
class_loss: 1.6249918937683105, distance_loss: 1.191934585571289
class_loss: 0.886660099029541, distance_loss: 1.4051718711853027
class_loss: 0.8889251947402954, distance_loss: 1.6466269493103027
class_loss: 1.0922571420669556, distance_loss: 1.8814918994903564
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.6388, Accuracy: 2670/8968 (29.7725%)
___Train Local_Simple,  epoch  37, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 640/647 (98.9181%)
___Train Local_Simple,  epoch  37, local model 25, internal_epoch   2,  Average loss: 0.0007, Accuracy: 636/647 (98.2998%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1737, Accuracy: 9434/10000 (94.3400%)
poison local model 17 index 2
class_loss: 4.28754997253418, distance_loss: 0.0
class_loss: 1.9364172220230103, distance_loss: 0.35787779092788696
class_loss: 2.7420756816864014, distance_loss: 0.8635929822921753
class_loss: 1.829242467880249, distance_loss: 1.2748833894729614
___PoisonTrain Local_Simple ,  epoch  37, local model 17, internal_epoch   1,  Average loss: 0.0308, Accuracy: 324/620 (52.2581%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  37, local model 17, internal_epoch   2,  Average loss: 0.0164, Accuracy: 335/620 (54.0323%), train_poison_data_count: 200
Global model norm: 15.854011177306399.
Norm before scaling: 16.05339296788221. Distance: 4.77901830512223
Total norm for 4 adversaries is: 16.05339296788221. distance: 4.77901830512223
class_loss: 1.3013299703598022, distance_loss: 1.6608575582504272
class_loss: 1.4363335371017456, distance_loss: 2.0275399684906006
class_loss: 1.4589333534240723, distance_loss: 2.356635808944702
class_loss: 1.4626107215881348, distance_loss: 2.6485583782196045
class_loss: 1.3318027257919312, distance_loss: 2.909848213195801
class_loss: 1.3001147508621216, distance_loss: 3.1505911350250244
class_loss: 1.038770079612732, distance_loss: 3.377261161804199
class_loss: 1.221336007118225, distance_loss: 3.587231159210205
class_loss: 1.046022653579712, distance_loss: 3.7762556076049805
class_loss: 0.8829237222671509, distance_loss: 3.9458329677581787
class_loss: 1.14982008934021, distance_loss: 4.1024370193481445
class_loss: 0.9074217081069946, distance_loss: 4.2435302734375
class_loss: 0.951403796672821, distance_loss: 4.370709419250488
class_loss: 1.0136770009994507, distance_loss: 4.486487865447998
class_loss: 0.9521574974060059, distance_loss: 4.593332290649414
class_loss: 0.9817795157432556, distance_loss: 4.688870429992676
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 1.2650, Accuracy: 4690/8968 (52.2971%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   1,  Average loss: 0.0002, Accuracy: 858/860 (99.7674%)
___Train Local_Simple,  epoch  37, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 856/860 (99.5349%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1070, Accuracy: 9652/10000 (96.5200%)
poison local model 45 index 3
___PoisonTrain Local_Simple ,  epoch  37, local model 45, internal_epoch   1,  Average loss: 0.0211, Accuracy: 391/628 (62.2611%), train_poison_data_count: 200
class_loss: 3.1923000812530518, distance_loss: 0.0
class_loss: 1.7583134174346924, distance_loss: 0.30064094066619873
class_loss: 1.4419206380844116, distance_loss: 0.7482165098190308
class_loss: 1.4667208194732666, distance_loss: 1.075109839439392
class_loss: 0.8827194571495056, distance_loss: 1.3112324476242065
class_loss: 1.0516448020935059, distance_loss: 1.5717493295669556
class_loss: 0.8751348257064819, distance_loss: 1.834114909172058
class_loss: 0.8863955140113831, distance_loss: 2.080857753753662
class_loss: 0.9364893436431885, distance_loss: 2.3086392879486084
class_loss: 0.7874327898025513, distance_loss: 2.5181756019592285
___PoisonTrain Local_Simple ,  epoch  37, local model 45, internal_epoch   2,  Average loss: 0.0096, Accuracy: 483/628 (76.9108%), train_poison_data_count: 200
Global model norm: 15.854011177306399.
Norm before scaling: 16.028633246170255. Distance: 4.035651827400014
Total norm for 4 adversaries is: 16.028633246170255. distance: 4.035651827400014
class_loss: 0.7956345677375793, distance_loss: 2.713535785675049
class_loss: 0.9460086226463318, distance_loss: 2.8911614418029785
class_loss: 0.7513440251350403, distance_loss: 3.0513975620269775
class_loss: 0.6097114682197571, distance_loss: 3.1992790699005127
class_loss: 0.5271459817886353, distance_loss: 3.339566707611084
class_loss: 0.5493600964546204, distance_loss: 3.4723923206329346
class_loss: 0.5149629712104797, distance_loss: 3.5955567359924316
class_loss: 0.5306854248046875, distance_loss: 3.712514877319336
class_loss: 0.3898704946041107, distance_loss: 3.8249645233154297
class_loss: 0.415544331073761, distance_loss: 3.9322240352630615
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 0.1369, Accuracy: 8462/8968 (94.3577%)
___Train Local_Simple,  epoch  37, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 513/519 (98.8439%)
___Train Local_Simple,  epoch  37, local model 54, internal_epoch   2,  Average loss: 0.0005, Accuracy: 512/519 (98.6513%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1455, Accuracy: 9536/10000 (95.3600%)
___Train Local_Simple,  epoch  37, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch  37, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1434, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   1,  Average loss: 0.0012, Accuracy: 427/435 (98.1609%)
___Train Local_Simple,  epoch  37, local model 0, internal_epoch   2,  Average loss: 0.0006, Accuracy: 429/435 (98.6207%)
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.1272, Accuracy: 9579/10000 (95.7900%)
time spent on training: 58.32910227775574
Starting performing KrMLRFL...
Num data points: [256, 548, 236, 647, 620, 860, 628, 519, 400, 435]
Num selected data points: [256 647 519 400 435]
The chosen ones are users: [0, 3, 7, 8, 9], which are global users: [69, 25, 54, 30, 0]
___Test Local_Simple poisoned: False, epoch: 37: Average loss: 0.0505, Accuracy: 9837/10000 (98.3700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 42, 17, 45]
base_p: [-0.00154595  0.00025323 -0.00035085 ... -0.0018661  -0.00532665
  0.00019659]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 5, 6]
layer1_inf_time: 3.2919921875
[PAIRWISE] pred_attackers_indx:  [1 2 4 6]
layer2_inf_t: 26.661376953125
assumed final_attacker_idxs:  [1 2 4 5 6]
final_attacker_idxs is: [1, 2, 4, 5, 6]
g_attacker_idxs: [ 2 42 17 37 45]
g_normal_idxs: [69 25 54 30  0]
filtered_attacker_idxs: [1, 2, 4, 5, 6]
final_attacker_idxs are: [1, 2, 4, 5, 6]
num_dps: [256, 548, 236, 647, 620, 860, 628, 519, 400, 435]
epoch_acc: 98.37
___Test Local_Simple poisoned: True, epoch: 37: Average loss: 12.0368, Accuracy: 30/8968 (0.3345%)
Done in 150.2101411819458 sec.
Server Epoch:38 choose agents : [33, 51, 17, 63, 6, 24, 82, 35, 80, 81].
___Train Local_Simple,  epoch  38, local model 33, internal_epoch   1,  Average loss: 0.0010, Accuracy: 609/623 (97.7528%)
___Train Local_Simple,  epoch  38, local model 33, internal_epoch   2,  Average loss: 0.0011, Accuracy: 613/623 (98.3949%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.2456, Accuracy: 9222/10000 (92.2200%)
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   1,  Average loss: 0.0260, Accuracy: 332/568 (58.4507%), train_poison_data_count: 180
class_loss: 3.7501704692840576, distance_loss: 0.0
class_loss: 2.1300430297851562, distance_loss: 0.3984694480895996
class_loss: 1.5663788318634033, distance_loss: 0.917654275894165
class_loss: 1.844160795211792, distance_loss: 1.3399665355682373
class_loss: 1.287968397140503, distance_loss: 1.7306052446365356
class_loss: 1.1441397666931152, distance_loss: 2.10746169090271
class_loss: 1.2216674089431763, distance_loss: 2.4629881381988525
class_loss: 0.9686345458030701, distance_loss: 2.7893354892730713
class_loss: 0.8401461243629456, distance_loss: 3.0903258323669434
___PoisonTrain Local_Simple ,  epoch  38, local model 51, internal_epoch   2,  Average loss: 0.0143, Accuracy: 335/568 (58.9789%), train_poison_data_count: 180
Global model norm: 15.836753127891749.
Norm before scaling: 15.991509569015005. Distance: 4.807723213683339
Total norm for 4 adversaries is: 15.991509569015005. distance: 4.807723213683339
class_loss: 1.1374529600143433, distance_loss: 3.3628361225128174
class_loss: 0.9316273331642151, distance_loss: 3.5997347831726074
class_loss: 0.9537531137466431, distance_loss: 3.810319423675537
class_loss: 0.9653831124305725, distance_loss: 4.0016303062438965
class_loss: 0.9476724863052368, distance_loss: 4.170690059661865
class_loss: 0.9007037878036499, distance_loss: 4.323058128356934
class_loss: 0.7291240096092224, distance_loss: 4.4609527587890625
class_loss: 0.7925991415977478, distance_loss: 4.58718729019165
class_loss: 0.7381612658500671, distance_loss: 4.701959133148193
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.1961, Accuracy: 3901/8968 (43.4991%)
poison local model 17 index 1
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   1,  Average loss: 0.0273, Accuracy: 358/620 (57.7419%), train_poison_data_count: 200
class_loss: 3.8247733116149902, distance_loss: 0.0
class_loss: 2.2012407779693604, distance_loss: 0.322192519903183
class_loss: 2.0616848468780518, distance_loss: 0.7984187602996826
class_loss: 1.4664868116378784, distance_loss: 1.1526376008987427
class_loss: 1.416827917098999, distance_loss: 1.4581502676010132
class_loss: 1.2920002937316895, distance_loss: 1.7789407968521118
class_loss: 1.2919189929962158, distance_loss: 2.0779411792755127
class_loss: 1.1120240688323975, distance_loss: 2.3475301265716553
class_loss: 1.0625150203704834, distance_loss: 2.583535671234131
class_loss: 1.1894564628601074, distance_loss: 2.795520544052124
___PoisonTrain Local_Simple ,  epoch  38, local model 17, internal_epoch   2,  Average loss: 0.0162, Accuracy: 327/620 (52.7419%), train_poison_data_count: 200
Global model norm: 15.836753127891749.
Norm before scaling: 15.906847150044625. Distance: 4.2087054450064745
Total norm for 4 adversaries is: 15.906847150044625. distance: 4.2087054450064745
class_loss: 1.1074022054672241, distance_loss: 2.999844551086426
class_loss: 0.9774373173713684, distance_loss: 3.1904635429382324
class_loss: 1.1053235530853271, distance_loss: 3.367032527923584
class_loss: 1.038354754447937, distance_loss: 3.5300114154815674
class_loss: 1.1101857423782349, distance_loss: 3.6733710765838623
class_loss: 1.0476560592651367, distance_loss: 3.791957139968872
class_loss: 1.0313833951950073, distance_loss: 3.892408847808838
class_loss: 0.859630823135376, distance_loss: 3.982567310333252
class_loss: 0.8631709218025208, distance_loss: 4.060353755950928
class_loss: 0.9114828705787659, distance_loss: 4.133944034576416
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.1929, Accuracy: 3657/8968 (40.7783%)
poison local model 63 index 2
___PoisonTrain Local_Simple ,  epoch  38, local model 63, internal_epoch   1,  Average loss: 0.0220, Accuracy: 495/889 (55.6805%), train_poison_data_count: 280
class_loss: 3.7424237728118896, distance_loss: 0.0
class_loss: 1.8616734743118286, distance_loss: 0.30164775252342224
class_loss: 1.1121095418930054, distance_loss: 0.7433330416679382
class_loss: 1.955541968345642, distance_loss: 1.1705776453018188
class_loss: 1.2082812786102295, distance_loss: 1.4696258306503296
class_loss: 1.2673814296722412, distance_loss: 1.7296086549758911
class_loss: 1.1555103063583374, distance_loss: 1.9683382511138916
class_loss: 1.2121751308441162, distance_loss: 2.185396909713745
class_loss: 1.1905219554901123, distance_loss: 2.368495464324951
class_loss: 1.09850013256073, distance_loss: 2.5259571075439453
class_loss: 0.9592239856719971, distance_loss: 2.667529582977295
class_loss: 0.9015326499938965, distance_loss: 2.8006372451782227
class_loss: 0.8749827742576599, distance_loss: 2.9284567832946777
class_loss: 1.0207778215408325, distance_loss: 3.0526440143585205
___PoisonTrain Local_Simple ,  epoch  38, local model 63, internal_epoch   2,  Average loss: 0.0121, Accuracy: 576/889 (64.7919%), train_poison_data_count: 280
Global model norm: 15.836753127891749.
Norm before scaling: 16.008238578699974. Distance: 4.206915638644758
Total norm for 4 adversaries is: 16.008238578699974. distance: 4.206915638644758
class_loss: 0.8370795845985413, distance_loss: 3.1712615489959717
class_loss: 0.8912884593009949, distance_loss: 3.286323070526123
class_loss: 0.9144725799560547, distance_loss: 3.3958628177642822
class_loss: 0.7645084857940674, distance_loss: 3.4946279525756836
class_loss: 0.6608688831329346, distance_loss: 3.5860495567321777
class_loss: 0.7301501631736755, distance_loss: 3.6717722415924072
class_loss: 0.746255099773407, distance_loss: 3.7529594898223877
class_loss: 0.8544238805770874, distance_loss: 3.830035924911499
class_loss: 0.5127991437911987, distance_loss: 3.8923499584198
class_loss: 0.8623376488685608, distance_loss: 3.9516444206237793
class_loss: 0.7486241459846497, distance_loss: 4.008835792541504
class_loss: 0.6724098324775696, distance_loss: 4.061465263366699
class_loss: 0.9316853284835815, distance_loss: 4.111535549163818
class_loss: 0.6693467497825623, distance_loss: 4.15888786315918
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 1.0752, Accuracy: 4113/8968 (45.8631%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   1,  Average loss: 0.0005, Accuracy: 611/615 (99.3496%)
___Train Local_Simple,  epoch  38, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 609/615 (99.0244%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1448, Accuracy: 9571/10000 (95.7100%)
___Train Local_Simple,  epoch  38, local model 24, internal_epoch   1,  Average loss: 0.0011, Accuracy: 369/379 (97.3615%)
___Train Local_Simple,  epoch  38, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1043, Accuracy: 9681/10000 (96.8100%)
___Train Local_Simple,  epoch  38, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch  38, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.3655, Accuracy: 8976/10000 (89.7600%)
___Train Local_Simple,  epoch  38, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 496/499 (99.3988%)
___Train Local_Simple,  epoch  38, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1504, Accuracy: 9524/10000 (95.2400%)
___Train Local_Simple,  epoch  38, local model 80, internal_epoch   1,  Average loss: 0.0007, Accuracy: 426/431 (98.8399%)
___Train Local_Simple,  epoch  38, local model 80, internal_epoch   2,  Average loss: 0.0007, Accuracy: 425/431 (98.6079%)
class_loss: 3.9459986686706543, distance_loss: 0.0
class_loss: 2.812116861343384, distance_loss: 0.3418520390987396
class_loss: 1.3153148889541626, distance_loss: 0.8382458090782166
class_loss: 1.8445923328399658, distance_loss: 1.3233531713485718
class_loss: 1.4718738794326782, distance_loss: 1.7081574201583862
class_loss: 1.229367971420288, distance_loss: 2.0492711067199707
class_loss: 1.1969866752624512, distance_loss: 2.363809585571289
class_loss: 1.196964144706726, distance_loss: 2.6477272510528564
class_loss: 1.0968281030654907, distance_loss: 2.9072787761688232
class_loss: 1.100525975227356, distance_loss: 3.145479202270508
class_loss: 1.0004982948303223, distance_loss: 3.3635270595550537
class_loss: 0.8159121870994568, distance_loss: 3.5591695308685303
class_loss: 0.7238367199897766, distance_loss: 3.740154266357422
class_loss: 1.0313076972961426, distance_loss: 3.9043221473693848
class_loss: 0.6667359471321106, distance_loss: 4.0516676902771
class_loss: 0.7585592269897461, distance_loss: 4.183696746826172
class_loss: 0.6658598184585571, distance_loss: 4.304173946380615
class_loss: 0.6028846502304077, distance_loss: 4.414239406585693
class_loss: 0.6379895806312561, distance_loss: 4.522651195526123
class_loss: 0.45289313793182373, distance_loss: 4.633109092712402
class_loss: 0.4045961797237396, distance_loss: 4.759359359741211
class_loss: 0.3683393597602844, distance_loss: 4.881265163421631
class_loss: 0.36527571082115173, distance_loss: 4.990778923034668
class_loss: 0.5315682888031006, distance_loss: 5.091331958770752
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.1551, Accuracy: 9566/10000 (95.6600%)
poison local model 81 index 3
___PoisonTrain Local_Simple ,  epoch  38, local model 81, internal_epoch   1,  Average loss: 0.0200, Accuracy: 742/1227 (60.4727%), train_poison_data_count: 391
class_loss: 0.42767104506492615, distance_loss: 5.178282260894775
class_loss: 0.20496903359889984, distance_loss: 5.257136821746826
class_loss: 0.20812492072582245, distance_loss: 5.332808017730713
class_loss: 0.18125662207603455, distance_loss: 5.407183647155762
class_loss: 0.31425559520721436, distance_loss: 5.477778434753418
class_loss: 0.1524023711681366, distance_loss: 5.545800685882568
class_loss: 0.25768977403640747, distance_loss: 5.613423824310303
class_loss: 0.2125372290611267, distance_loss: 5.680881500244141
class_loss: 0.10898637771606445, distance_loss: 5.748993396759033
class_loss: 0.21535921096801758, distance_loss: 5.811851978302002
class_loss: 0.10559915751218796, distance_loss: 5.8745293617248535
class_loss: 0.0806441456079483, distance_loss: 5.938967227935791
class_loss: 0.1332118660211563, distance_loss: 5.999856472015381
class_loss: 0.1531282663345337, distance_loss: 6.053565502166748
class_loss: 0.019855860620737076, distance_loss: 6.101418495178223
class_loss: 3.1427850899490295e-07, distance_loss: 6.1456732749938965
___PoisonTrain Local_Simple ,  epoch  38, local model 81, internal_epoch   2,  Average loss: 0.0036, Accuracy: 1131/1227 (92.1760%), train_poison_data_count: 391
Global model norm: 15.836753127891749.
Norm before scaling: 16.725646576977788. Distance: 6.186593654026346
Total norm for 4 adversaries is: 16.725646576977788. distance: 6.186593654026346
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 0.0237, Accuracy: 8896/8968 (99.1971%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 17, 63, 81]
base_p: [-0.00628088  0.00032461 -0.00059445 ... -0.00292364 -0.01654678
 -0.00178402]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 9]
layer1_inf_time: 2.8740234375
[PAIRWISE] pred_attackers_indx:  [1 2 3 9]
layer2_inf_t: 25.799560546875
assumed final_attacker_idxs:  [0 1 2 3 9]
final_attacker_idxs is: [0, 1, 2, 3, 9]
g_attacker_idxs: [33 51 17 63 81]
g_normal_idxs: [ 6 24 82 35 80]
filtered_attacker_idxs: [0, 1, 2, 3, 9]
final_attacker_idxs are: [0, 1, 2, 3, 9]
num_dps: [623, 568, 620, 889, 615, 379, 713, 499, 431, 1227]
time spent on training: 67.61392831802368
Starting performing KrMLRFL...
Num data points: [623, 568, 620, 889, 615, 379, 713, 499, 431, 1227]
Num selected data points: [615 379 713 499 431]
The chosen ones are users: [4, 5, 6, 7, 8], which are global users: [6, 24, 82, 35, 80]
epoch_acc: 98.4
___Test Local_Simple poisoned: False, epoch: 38: Average loss: 0.0523, Accuracy: 9840/10000 (98.4000%)
___Test Local_Simple poisoned: True, epoch: 38: Average loss: 13.0251, Accuracy: 19/8968 (0.2119%)
Done in 154.67038869857788 sec.
Server Epoch:39 choose agents : [58, 90, 30, 72, 41, 25, 16, 91, 50, 57].
___Train Local_Simple,  epoch  39, local model 58, internal_epoch   1,  Average loss: 0.0012, Accuracy: 272/276 (98.5507%)
___Train Local_Simple,  epoch  39, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 275/276 (99.6377%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.8841, Accuracy: 8747/10000 (87.4700%)
___Train Local_Simple,  epoch  39, local model 90, internal_epoch   1,  Average loss: 0.0011, Accuracy: 667/683 (97.6574%)
___Train Local_Simple,  epoch  39, local model 90, internal_epoch   2,  Average loss: 0.0005, Accuracy: 677/683 (99.1215%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 1.1000, Accuracy: 7431/10000 (74.3100%)
___Train Local_Simple,  epoch  39, local model 30, internal_epoch   1,  Average loss: 0.0005, Accuracy: 397/400 (99.2500%)
___Train Local_Simple,  epoch  39, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3000, Accuracy: 9064/10000 (90.6400%)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   1,  Average loss: 0.0006, Accuracy: 722/731 (98.7688%)
___Train Local_Simple,  epoch  39, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 728/731 (99.5896%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.2039, Accuracy: 9241/10000 (92.4100%)
___Train Local_Simple,  epoch  39, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 598/606 (98.6799%)
___Train Local_Simple,  epoch  39, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.3415, Accuracy: 9052/10000 (90.5200%)
___Train Local_Simple,  epoch  39, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 643/647 (99.3818%)
___Train Local_Simple,  epoch  39, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 644/647 (99.5363%)
class_loss: 3.1161916255950928, distance_loss: 0.0
class_loss: 2.139063835144043, distance_loss: 0.3438970148563385
class_loss: 2.5400829315185547, distance_loss: 0.8160699009895325
class_loss: 1.550940752029419, distance_loss: 1.1445646286010742
class_loss: 1.1679317951202393, distance_loss: 1.459439754486084
class_loss: 1.187172770500183, distance_loss: 1.7921959161758423
class_loss: 0.9868707060813904, distance_loss: 2.1109864711761475
class_loss: 1.1199051141738892, distance_loss: 2.4033796787261963
class_loss: 0.9944220185279846, distance_loss: 2.6720199584960938
class_loss: 1.2252925634384155, distance_loss: 2.9200994968414307
class_loss: 1.0794342756271362, distance_loss: 3.146150588989258
class_loss: 1.1937223672866821, distance_loss: 3.351182460784912
class_loss: 1.114675760269165, distance_loss: 3.533128261566162
class_loss: 1.0746160745620728, distance_loss: 3.6932270526885986
class_loss: 1.1117029190063477, distance_loss: 3.8398303985595703
class_loss: 0.944171130657196, distance_loss: 3.992321729660034
class_loss: 1.0718518495559692, distance_loss: 4.130175590515137
class_loss: 1.156341314315796, distance_loss: 4.248867034912109
class_loss: 1.0654406547546387, distance_loss: 4.34992790222168
class_loss: 1.0598223209381104, distance_loss: 4.439732074737549
class_loss: 0.9780606627464294, distance_loss: 4.521183967590332
class_loss: 0.8196930885314941, distance_loss: 4.596549987792969
class_loss: 0.854887843132019, distance_loss: 4.666688919067383
class_loss: 0.9039250612258911, distance_loss: 4.735032081604004
class_loss: 0.9353733658790588, distance_loss: 4.797694206237793
class_loss: 0.7955613136291504, distance_loss: 4.857822895050049
class_loss: 0.9007337689399719, distance_loss: 4.914915561676025
class_loss: 0.7179498672485352, distance_loss: 4.968471527099609
class_loss: 0.9242101907730103, distance_loss: 5.014806270599365
class_loss: 0.7704339027404785, distance_loss: 5.056306838989258
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0989, Accuracy: 9672/10000 (96.7200%)
poison local model 16 index 0
___PoisonTrain Local_Simple ,  epoch  39, local model 16, internal_epoch   1,  Average loss: 0.0236, Accuracy: 529/915 (57.8142%), train_poison_data_count: 299
___PoisonTrain Local_Simple ,  epoch  39, local model 16, internal_epoch   2,  Average loss: 0.0152, Accuracy: 490/915 (53.5519%), train_poison_data_count: 299
Global model norm: 15.797454551683318.
Norm before scaling: 16.115408477009183. Distance: 5.119331760906169
Total norm for 2 adversaries is: 16.115408477009183. distance: 5.119331760906169
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 0.9825, Accuracy: 4764/8968 (53.1222%)
class_loss: 4.14412784576416, distance_loss: 0.0
class_loss: 1.802463412284851, distance_loss: 0.39535167813301086
class_loss: 2.065340042114258, distance_loss: 0.8376712203025818
class_loss: 1.3206243515014648, distance_loss: 1.214874505996704
poison local model 91 index 1
___PoisonTrain Local_Simple ,  epoch  39, local model 91, internal_epoch   1,  Average loss: 0.0365, Accuracy: 136/256 (53.1250%), train_poison_data_count: 80
class_loss: 1.415007472038269, distance_loss: 1.5354785919189453
class_loss: 1.319645881652832, distance_loss: 1.8280751705169678
class_loss: 1.1972116231918335, distance_loss: 2.1045355796813965
class_loss: 1.1124924421310425, distance_loss: 2.3630857467651367
___PoisonTrain Local_Simple ,  epoch  39, local model 91, internal_epoch   2,  Average loss: 0.0197, Accuracy: 121/256 (47.2656%), train_poison_data_count: 80
Global model norm: 15.797454551683318.
Norm before scaling: 15.57445388742737. Distance: 2.607127335160664
Total norm for 2 adversaries is: 15.57445388742737. distance: 2.607127335160664
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 1.4501, Accuracy: 3009/8968 (33.5526%)
___Train Local_Simple,  epoch  39, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 466/474 (98.3122%)
___Train Local_Simple,  epoch  39, local model 50, internal_epoch   2,  Average loss: 0.0004, Accuracy: 470/474 (99.1561%)
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.5467, Accuracy: 8572/10000 (85.7200%)
___Train Local_Simple,  epoch  39, local model 57, internal_epoch   1,  Average loss: 0.0012, Accuracy: 336/343 (97.9592%)
___Train Local_Simple,  epoch  39, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 342/343 (99.7085%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 91]
base_p: [ 0.00333421  0.00032551  0.00066303 ...  0.00295451 -0.00282066
 -0.00138392]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 6, 7]
layer1_inf_time: 2.837158203125
[PAIRWISE] pred_attackers_indx:  [6 7]
layer2_inf_t: 29.773193359375
assumed final_attacker_idxs:  [0 4 5 6 7]
final_attacker_idxs is: [0, 4, 5, 6, 7]
g_attacker_idxs: [58 41 25 16 91]
g_normal_idxs: [90 30 72 50 57]
filtered_attacker_idxs: [0, 4, 5, 6, 7]
final_attacker_idxs are: [0, 4, 5, 6, 7]
num_dps: [276, 683, 400, 731, 606, 647, 915, 256, 474, 343]
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.1798, Accuracy: 9469/10000 (94.6900%)
time spent on training: 44.63140916824341
Starting performing KrMLRFL...
Num data points: [276, 683, 400, 731, 606, 647, 915, 256, 474, 343]
Num selected data points: [683 400 731 474 343]
The chosen ones are users: [1, 2, 3, 8, 9], which are global users: [90, 30, 72, 50, 57]
epoch_acc: 97.28
___Test Local_Simple poisoned: False, epoch: 39: Average loss: 0.0840, Accuracy: 9728/10000 (97.2800%)
___Test Local_Simple poisoned: True, epoch: 39: Average loss: 12.3550, Accuracy: 32/8968 (0.3568%)
Done in 140.8078646659851 sec.
Server Epoch:40 choose agents : [50, 77, 73, 21, 10, 8, 40, 52, 45, 30].
___Train Local_Simple,  epoch  40, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch  40, local model 50, internal_epoch   2,  Average loss: 0.0006, Accuracy: 471/474 (99.3671%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2155, Accuracy: 9333/10000 (93.3300%)
___Train Local_Simple,  epoch  40, local model 77, internal_epoch   1,  Average loss: 0.0011, Accuracy: 576/589 (97.7929%)
___Train Local_Simple,  epoch  40, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 583/589 (98.9813%)
class_loss: 2.7148332595825195, distance_loss: 0.0
class_loss: 1.9457552433013916, distance_loss: 0.38791733980178833
class_loss: 2.1304478645324707, distance_loss: 0.6108309626579285
class_loss: 1.1040714979171753, distance_loss: 0.8804031610488892
class_loss: 1.2822368144989014, distance_loss: 1.261603832244873
class_loss: 1.2320958375930786, distance_loss: 1.6544281244277954
class_loss: 1.2007209062576294, distance_loss: 2.0156314373016357
class_loss: 1.2173420190811157, distance_loss: 2.334486722946167
class_loss: 1.308875560760498, distance_loss: 2.612530469894409
class_loss: 0.8592678904533386, distance_loss: 2.8563880920410156
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0859, Accuracy: 9724/10000 (97.2400%)
poison local model 73 index 0
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   1,  Average loss: 0.0254, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
class_loss: 1.5373576879501343, distance_loss: 3.098475456237793
class_loss: 1.469536304473877, distance_loss: 3.3039515018463135
class_loss: 1.196927785873413, distance_loss: 3.47617506980896
class_loss: 0.9109104871749878, distance_loss: 3.6375746726989746
class_loss: 1.0273406505584717, distance_loss: 3.7892191410064697
class_loss: 0.9547744393348694, distance_loss: 3.929779052734375
class_loss: 1.1088398694992065, distance_loss: 4.060066223144531
class_loss: 1.1170769929885864, distance_loss: 4.178815841674805
class_loss: 0.9246371388435364, distance_loss: 4.286446571350098
class_loss: 1.3014051914215088, distance_loss: 4.3843674659729
___PoisonTrain Local_Simple ,  epoch  40, local model 73, internal_epoch   2,  Average loss: 0.0195, Accuracy: 301/591 (50.9306%), train_poison_data_count: 195
Global model norm: 15.738396139286538.
Norm before scaling: 15.777432725980852. Distance: 4.489994581937176
Total norm for 3 adversaries is: 15.777432725980852. distance: 4.489994581937176
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.8088, Accuracy: 7801/8968 (86.9871%)
___Train Local_Simple,  epoch  40, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 310/312 (99.3590%)
___Train Local_Simple,  epoch  40, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0859, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   1,  Average loss: 0.0006, Accuracy: 881/892 (98.7668%)
___Train Local_Simple,  epoch  40, local model 10, internal_epoch   2,  Average loss: 0.0003, Accuracy: 887/892 (99.4395%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1454, Accuracy: 9531/10000 (95.3100%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   1,  Average loss: 0.0004, Accuracy: 629/633 (99.3681%)
___Train Local_Simple,  epoch  40, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0695, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch  40, local model 40, internal_epoch   1,  Average loss: 0.0006, Accuracy: 761/772 (98.5751%)
___Train Local_Simple,  epoch  40, local model 40, internal_epoch   2,  Average loss: 0.0004, Accuracy: 770/772 (99.7409%)
class_loss: 3.987297773361206, distance_loss: 0.0
class_loss: 1.9211695194244385, distance_loss: 0.32970723509788513
class_loss: 1.683959722518921, distance_loss: 0.8320679068565369
class_loss: 1.5574617385864258, distance_loss: 1.2708735466003418
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.1857, Accuracy: 9505/10000 (95.0500%)
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   1,  Average loss: 0.0362, Accuracy: 138/253 (54.5455%), train_poison_data_count: 80
class_loss: 1.410953402519226, distance_loss: 1.618628978729248
class_loss: 1.2721027135849, distance_loss: 1.9343163967132568
class_loss: 1.1314105987548828, distance_loss: 2.226120948791504
class_loss: 1.0625337362289429, distance_loss: 2.501502752304077
___PoisonTrain Local_Simple ,  epoch  40, local model 52, internal_epoch   2,  Average loss: 0.0193, Accuracy: 121/253 (47.8261%), train_poison_data_count: 80
Global model norm: 15.738396139286538.
Norm before scaling: 15.569253092094788. Distance: 2.7604163307813523
Total norm for 3 adversaries is: 15.569253092094788. distance: 2.7604163307813523
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 1.6244, Accuracy: 2542/8968 (28.3452%)
poison local model 45 index 2
class_loss: 3.6261305809020996, distance_loss: 0.0
class_loss: 1.912140965461731, distance_loss: 0.31911784410476685
class_loss: 1.361385703086853, distance_loss: 0.7842645645141602
class_loss: 1.7231031656265259, distance_loss: 1.1768161058425903
class_loss: 1.387474775314331, distance_loss: 1.5075392723083496
class_loss: 1.1915531158447266, distance_loss: 1.8099534511566162
class_loss: 1.342854619026184, distance_loss: 2.0962183475494385
class_loss: 1.426384449005127, distance_loss: 2.3620195388793945
class_loss: 1.2806850671768188, distance_loss: 2.605111837387085
class_loss: 1.1569104194641113, distance_loss: 2.8290934562683105
class_loss: 1.0701385736465454, distance_loss: 3.0413780212402344
class_loss: 1.0277538299560547, distance_loss: 3.239339590072632
class_loss: 0.8854264616966248, distance_loss: 3.4243228435516357
class_loss: 1.1529381275177002, distance_loss: 3.5934031009674072
class_loss: 0.8382139801979065, distance_loss: 3.744713068008423
class_loss: 0.8383069634437561, distance_loss: 3.8834617137908936
class_loss: 0.8131514191627502, distance_loss: 4.0074567794799805
class_loss: 0.8445475101470947, distance_loss: 4.120429039001465
class_loss: 0.8239232301712036, distance_loss: 4.219808578491211
class_loss: 0.9108657240867615, distance_loss: 4.31046199798584
___PoisonTrain Local_Simple ,  epoch  40, local model 45, internal_epoch   1,  Average loss: 0.0261, Accuracy: 334/628 (53.1847%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  40, local model 45, internal_epoch   2,  Average loss: 0.0147, Accuracy: 354/628 (56.3694%), train_poison_data_count: 200
Global model norm: 15.738396139286538.
Norm before scaling: 15.882697214288926. Distance: 4.393564563815583
Total norm for 3 adversaries is: 15.882697214288926. distance: 4.393564563815583
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 0.9198, Accuracy: 5503/8968 (61.3626%)
___Train Local_Simple,  epoch  40, local model 30, internal_epoch   1,  Average loss: 0.0004, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch  40, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73, 52, 45]
base_p: [-0.00438156  0.00029255 -0.00060015 ... -0.00412069 -0.00578265
 -0.00167606]
[T_SCORE] attacker_local_idxs is:  [1, 2, 6, 7, 8]
layer1_inf_time: 4.244873046875
[PAIRWISE] pred_attackers_indx:  [2 7 8]
layer2_inf_t: 39.4140625
assumed final_attacker_idxs:  [1 2 6 7 8]
final_attacker_idxs is: [1, 2, 6, 7, 8]
g_attacker_idxs: [77 73 40 52 45]
g_normal_idxs: [50 21 10  8 30]
filtered_attacker_idxs: [1, 2, 6, 7, 8]
final_attacker_idxs are: [1, 2, 6, 7, 8]
num_dps: [474, 589, 591, 312, 892, 633, 772, 253, 628, 400]
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.2400, Accuracy: 9232/10000 (92.3200%)
time spent on training: 50.19801926612854
Starting performing KrMLRFL...
Num data points: [474, 589, 591, 312, 892, 633, 772, 253, 628, 400]
Num selected data points: [474 312 892 633 400]
The chosen ones are users: [0, 3, 4, 5, 9], which are global users: [50, 21, 10, 8, 30]
epoch_acc: 98.13
___Test Local_Simple poisoned: False, epoch: 40: Average loss: 0.0612, Accuracy: 9813/10000 (98.1300%)
___Test Local_Simple poisoned: True, epoch: 40: Average loss: 13.0789, Accuracy: 32/8968 (0.3568%)
Done in 140.95521545410156 sec.
Server Epoch:41 choose agents : [74, 9, 99, 85, 4, 11, 24, 42, 23, 25].
___Train Local_Simple,  epoch  41, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%)
___Train Local_Simple,  epoch  41, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2153, Accuracy: 9342/10000 (93.4200%)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   1,  Average loss: 0.0006, Accuracy: 430/436 (98.6239%)
___Train Local_Simple,  epoch  41, local model 9, internal_epoch   2,  Average loss: 0.0008, Accuracy: 429/436 (98.3945%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1205, Accuracy: 9593/10000 (95.9300%)
___Train Local_Simple,  epoch  41, local model 99, internal_epoch   1,  Average loss: 0.0006, Accuracy: 373/377 (98.9390%)
___Train Local_Simple,  epoch  41, local model 99, internal_epoch   2,  Average loss: 0.0003, Accuracy: 376/377 (99.7347%)
class_loss: 5.137383937835693, distance_loss: 0.0
class_loss: 2.2564611434936523, distance_loss: 0.42001503705978394
class_loss: 1.077916145324707, distance_loss: 0.9617336392402649
class_loss: 1.4418776035308838, distance_loss: 1.4718183279037476
class_loss: 1.566354513168335, distance_loss: 1.9154056310653687
class_loss: 1.156687617301941, distance_loss: 2.3083622455596924
class_loss: 1.2168654203414917, distance_loss: 2.6645214557647705
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0704, Accuracy: 9755/10000 (97.5500%)
poison local model 85 index 0
___PoisonTrain Local_Simple ,  epoch  41, local model 85, internal_epoch   1,  Average loss: 0.0321, Accuracy: 251/431 (58.2367%), train_poison_data_count: 140
class_loss: 1.198787808418274, distance_loss: 2.985022783279419
class_loss: 1.2776185274124146, distance_loss: 3.272036552429199
class_loss: 1.216312289237976, distance_loss: 3.529881477355957
class_loss: 1.1345428228378296, distance_loss: 3.758754253387451
class_loss: 1.0010539293289185, distance_loss: 3.9650228023529053
class_loss: 0.8964990973472595, distance_loss: 4.1528778076171875
class_loss: 0.9034519791603088, distance_loss: 4.323273658752441
___PoisonTrain Local_Simple ,  epoch  41, local model 85, internal_epoch   2,  Average loss: 0.0177, Accuracy: 221/431 (51.2761%), train_poison_data_count: 140
Global model norm: 15.727442982524359.
Norm before scaling: 15.74811167220484. Distance: 4.481204517085802
Total norm for 3 adversaries is: 15.74811167220484. distance: 4.481204517085802
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.7236, Accuracy: 6787/8968 (75.6802%)
___Train Local_Simple,  epoch  41, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 644/658 (97.8723%)
___Train Local_Simple,  epoch  41, local model 4, internal_epoch   2,  Average loss: 0.0005, Accuracy: 652/658 (99.0881%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.2065, Accuracy: 9329/10000 (93.2900%)
poison local model 11 index 1
class_loss: 4.155071258544922, distance_loss: 0.0
class_loss: 2.8605241775512695, distance_loss: 0.32140272855758667
class_loss: 1.6261415481567383, distance_loss: 0.8649269938468933
class_loss: 1.5764989852905273, distance_loss: 1.327675700187683
class_loss: 1.236842393875122, distance_loss: 1.6949278116226196
class_loss: 1.5091019868850708, distance_loss: 2.0434887409210205
class_loss: 1.2113498449325562, distance_loss: 2.3724327087402344
class_loss: 1.478751301765442, distance_loss: 2.6657848358154297
class_loss: 1.383988857269287, distance_loss: 2.9304614067077637
class_loss: 1.2764638662338257, distance_loss: 3.164501667022705
class_loss: 1.2501479387283325, distance_loss: 3.37734055519104
class_loss: 1.073554515838623, distance_loss: 3.5974557399749756
class_loss: 1.387621521949768, distance_loss: 3.7989368438720703
class_loss: 1.2880343198776245, distance_loss: 3.9766106605529785
class_loss: 1.017130732536316, distance_loss: 4.129433631896973
class_loss: 0.9860475659370422, distance_loss: 4.264537334442139
class_loss: 0.961815357208252, distance_loss: 4.387646198272705
class_loss: 0.9762338995933533, distance_loss: 4.502468109130859
class_loss: 1.0215296745300293, distance_loss: 4.6128764152526855
class_loss: 0.8865296840667725, distance_loss: 4.720748424530029
class_loss: 0.9053202867507935, distance_loss: 4.8232102394104
class_loss: 1.6035163402557373, distance_loss: 4.919566631317139
___PoisonTrain Local_Simple ,  epoch  41, local model 11, internal_epoch   1,  Average loss: 0.0303, Accuracy: 328/645 (50.8527%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  41, local model 11, internal_epoch   2,  Average loss: 0.0188, Accuracy: 330/645 (51.1628%), train_poison_data_count: 205
Global model norm: 15.727442982524359.
Norm before scaling: 15.954613686203015. Distance: 5.04536533511163
Total norm for 3 adversaries is: 15.954613686203015. distance: 5.04536533511163
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 0.6967, Accuracy: 6927/8968 (77.2413%)
___Train Local_Simple,  epoch  41, local model 24, internal_epoch   1,  Average loss: 0.0008, Accuracy: 372/379 (98.1530%)
___Train Local_Simple,  epoch  41, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0959, Accuracy: 9688/10000 (96.8800%)
poison local model 42 index 2
class_loss: 3.8855748176574707, distance_loss: 0.0
class_loss: 1.6369372606277466, distance_loss: 0.3462717831134796
class_loss: 1.533427119255066, distance_loss: 0.8089175224304199
class_loss: 1.1358689069747925, distance_loss: 1.177471399307251
class_loss: 1.277181625366211, distance_loss: 1.5287699699401855
class_loss: 0.9212671518325806, distance_loss: 1.8334697484970093
class_loss: 1.1869802474975586, distance_loss: 2.116696834564209
class_loss: 1.1048312187194824, distance_loss: 2.373715877532959
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   1,  Average loss: 0.0347, Accuracy: 162/236 (68.6441%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  41, local model 42, internal_epoch   2,  Average loss: 0.0190, Accuracy: 118/236 (50.0000%), train_poison_data_count: 80
Global model norm: 15.727442982524359.
Norm before scaling: 15.49095135795763. Distance: 2.605712604692462
Total norm for 3 adversaries is: 15.49095135795763. distance: 2.605712604692462
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 1.1716, Accuracy: 4729/8968 (52.7319%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  41, local model 23, internal_epoch   2,  Average loss: 0.0009, Accuracy: 289/293 (98.6348%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1976, Accuracy: 9360/10000 (93.6000%)
___Train Local_Simple,  epoch  41, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 643/647 (99.3818%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 11, 42]
base_p: [-0.00194224  0.00024186 -0.00037083 ... -0.00529119 -0.00300772
  0.00126813]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 7, 9]
layer1_inf_time: 2.62548828125
[PAIRWISE] pred_attackers_indx:  [3 5 7]
layer2_inf_t: 26.947021484375
assumed final_attacker_idxs:  [3 4 5 7 9]
final_attacker_idxs is: [3, 4, 5, 7, 9]
g_attacker_idxs: [85  4 11 42 25]
g_normal_idxs: [74  9 99 24 23]
filtered_attacker_idxs: [3, 4, 5, 7, 9]
final_attacker_idxs are: [3, 4, 5, 7, 9]
num_dps: [557, 436, 377, 431, 658, 645, 379, 236, 293, 647]
___Train Local_Simple,  epoch  41, local model 25, internal_epoch   2,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.1524, Accuracy: 9528/10000 (95.2800%)
time spent on training: 46.0352087020874
Starting performing KrMLRFL...
Num data points: [557, 436, 377, 431, 658, 645, 379, 236, 293, 647]
Num selected data points: [557 436 377 379 293]
The chosen ones are users: [0, 1, 2, 6, 8], which are global users: [74, 9, 99, 24, 23]
epoch_acc: 98.09
___Test Local_Simple poisoned: False, epoch: 41: Average loss: 0.0576, Accuracy: 9809/10000 (98.0900%)
___Test Local_Simple poisoned: True, epoch: 41: Average loss: 13.6395, Accuracy: 20/8968 (0.2230%)
Done in 129.92577958106995 sec.
Server Epoch:42 choose agents : [93, 87, 55, 70, 15, 90, 91, 86, 67, 20].
poison local model 93 index 0
class_loss: 3.301027297973633, distance_loss: 0.0
class_loss: 2.4195539951324463, distance_loss: 0.2908599376678467
class_loss: 1.6353861093521118, distance_loss: 0.7795301675796509
class_loss: 1.9742519855499268, distance_loss: 1.2081528902053833
class_loss: 1.2227015495300293, distance_loss: 1.5405349731445312
class_loss: 1.145972728729248, distance_loss: 1.8879083395004272
class_loss: 1.2025620937347412, distance_loss: 2.2199347019195557
class_loss: 1.2633520364761353, distance_loss: 2.5269935131073
class_loss: 1.2421139478683472, distance_loss: 2.8041799068450928
class_loss: 1.3609274625778198, distance_loss: 3.0576257705688477
class_loss: 1.1841881275177002, distance_loss: 3.2926833629608154
class_loss: 1.1177140474319458, distance_loss: 3.5115301609039307
class_loss: 1.048863172531128, distance_loss: 3.712665319442749
class_loss: 1.015495777130127, distance_loss: 3.8913753032684326
class_loss: 0.8970272541046143, distance_loss: 4.053074836730957
class_loss: 0.8842077255249023, distance_loss: 4.202380657196045
class_loss: 0.9386339783668518, distance_loss: 4.3415446281433105
class_loss: 0.9320625066757202, distance_loss: 4.472695350646973
class_loss: 0.9475611448287964, distance_loss: 4.592663288116455
class_loss: 1.1860361099243164, distance_loss: 4.704116344451904
___PoisonTrain Local_Simple ,  epoch  42, local model 93, internal_epoch   1,  Average loss: 0.0269, Accuracy: 349/623 (56.0193%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  42, local model 93, internal_epoch   2,  Average loss: 0.0163, Accuracy: 329/623 (52.8090%), train_poison_data_count: 200
Global model norm: 15.705168846313335.
Norm before scaling: 15.860242336966504. Distance: 4.806658481656185
Total norm for 4 adversaries is: 15.860242336966504. distance: 4.806658481656185
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.1180, Accuracy: 4831/8968 (53.8693%)
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   1,  Average loss: 0.0006, Accuracy: 465/470 (98.9362%)
___Train Local_Simple,  epoch  42, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1066, Accuracy: 9675/10000 (96.7500%)
___Train Local_Simple,  epoch  42, local model 55, internal_epoch   1,  Average loss: 0.0008, Accuracy: 347/354 (98.0226%)
___Train Local_Simple,  epoch  42, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.4079, Accuracy: 8726/10000 (87.2600%)
poison local model 70 index 1
class_loss: 4.040878772735596, distance_loss: 0.0
class_loss: 2.1220805644989014, distance_loss: 0.32799455523490906
class_loss: 1.498416543006897, distance_loss: 0.8131735920906067
class_loss: 1.5519863367080688, distance_loss: 1.2551594972610474
class_loss: 1.4238157272338867, distance_loss: 1.6372324228286743
class_loss: 1.3368407487869263, distance_loss: 1.9730134010314941
class_loss: 1.4614017009735107, distance_loss: 2.293113946914673
class_loss: 1.2540963888168335, distance_loss: 2.583359479904175
class_loss: 1.4989551305770874, distance_loss: 2.8423097133636475
class_loss: 1.277921199798584, distance_loss: 3.0758795738220215
class_loss: 1.209337830543518, distance_loss: 3.280545949935913
class_loss: 1.0624878406524658, distance_loss: 3.464308738708496
class_loss: 1.200156569480896, distance_loss: 3.646014451980591
class_loss: 1.3091130256652832, distance_loss: 3.811654567718506
class_loss: 1.2480223178863525, distance_loss: 3.957843542098999
class_loss: 1.1274727582931519, distance_loss: 4.085729598999023
class_loss: 1.0817233324050903, distance_loss: 4.202688217163086
class_loss: 1.2399696111679077, distance_loss: 4.31488561630249
class_loss: 0.8822240829467773, distance_loss: 4.419173717498779
class_loss: 0.8573536276817322, distance_loss: 4.517697334289551
class_loss: 0.8099871277809143, distance_loss: 4.610116481781006
class_loss: 0.890924334526062, distance_loss: 4.698373317718506
class_loss: 0.8387556076049805, distance_loss: 4.781740665435791
class_loss: 1.031687617301941, distance_loss: 4.859703063964844
___PoisonTrain Local_Simple ,  epoch  42, local model 70, internal_epoch   1,  Average loss: 0.0273, Accuracy: 367/724 (50.6906%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  42, local model 70, internal_epoch   2,  Average loss: 0.0173, Accuracy: 389/724 (53.7293%), train_poison_data_count: 240
Global model norm: 15.705168846313335.
Norm before scaling: 15.90314349883479. Distance: 4.958260458188964
Total norm for 4 adversaries is: 15.90314349883479. distance: 4.958260458188964
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.5855, Accuracy: 6533/8968 (72.8479%)
___Train Local_Simple,  epoch  42, local model 15, internal_epoch   1,  Average loss: 0.0007, Accuracy: 396/401 (98.7531%)
___Train Local_Simple,  epoch  42, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0907, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch  42, local model 90, internal_epoch   1,  Average loss: 0.0008, Accuracy: 674/683 (98.6823%)
___Train Local_Simple,  epoch  42, local model 90, internal_epoch   2,  Average loss: 0.0008, Accuracy: 671/683 (98.2430%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.6702, Accuracy: 8506/10000 (85.0600%)
poison local model 91 index 2
class_loss: 4.05430269241333, distance_loss: 0.0
class_loss: 2.0179226398468018, distance_loss: 0.35355135798454285
class_loss: 2.109833002090454, distance_loss: 0.9010647535324097
class_loss: 2.7649857997894287, distance_loss: 1.3374117612838745
class_loss: 1.1747037172317505, distance_loss: 1.6873661279678345
class_loss: 1.271933674812317, distance_loss: 2.057502508163452
class_loss: 1.4871351718902588, distance_loss: 2.4092652797698975
class_loss: 1.4350104331970215, distance_loss: 2.734997034072876
___PoisonTrain Local_Simple ,  epoch  42, local model 91, internal_epoch   1,  Average loss: 0.0428, Accuracy: 132/256 (51.5625%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  42, local model 91, internal_epoch   2,  Average loss: 0.0210, Accuracy: 114/256 (44.5312%), train_poison_data_count: 80
Global model norm: 15.705168846313335.
Norm before scaling: 15.493473278558247. Distance: 3.0352484690281605
Total norm for 4 adversaries is: 15.493473278558247. distance: 3.0352484690281605
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 1.5176, Accuracy: 3875/8968 (43.2092%)
___Train Local_Simple,  epoch  42, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 245/250 (98.0000%)
___Train Local_Simple,  epoch  42, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0991, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  42, local model 67, internal_epoch   1,  Average loss: 0.0008, Accuracy: 984/998 (98.5972%)
___Train Local_Simple,  epoch  42, local model 67, internal_epoch   2,  Average loss: 0.0006, Accuracy: 986/998 (98.7976%)
class_loss: 5.505977630615234, distance_loss: 0.0
class_loss: 2.723116159439087, distance_loss: 0.41181111335754395
class_loss: 0.9109109044075012, distance_loss: 0.9757295250892639
class_loss: 1.127610206604004, distance_loss: 1.5287059545516968
class_loss: 1.4782819747924805, distance_loss: 1.983304738998413
class_loss: 1.2401922941207886, distance_loss: 2.3562817573547363
class_loss: 1.0489869117736816, distance_loss: 2.6901211738586426
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.1442, Accuracy: 9548/10000 (95.4800%)
poison local model 20 index 3
___PoisonTrain Local_Simple ,  epoch  42, local model 20, internal_epoch   1,  Average loss: 0.0327, Accuracy: 228/429 (53.1469%), train_poison_data_count: 140
class_loss: 1.0958564281463623, distance_loss: 2.9989125728607178
class_loss: 1.0414221286773682, distance_loss: 3.279383897781372
class_loss: 0.9738887548446655, distance_loss: 3.5378916263580322
class_loss: 0.8845768570899963, distance_loss: 3.768521547317505
class_loss: 0.8974682092666626, distance_loss: 3.9739179611206055
class_loss: 0.7517532706260681, distance_loss: 4.160390377044678
class_loss: 0.6576535701751709, distance_loss: 4.328941822052002
___PoisonTrain Local_Simple ,  epoch  42, local model 20, internal_epoch   2,  Average loss: 0.0147, Accuracy: 262/429 (61.0723%), train_poison_data_count: 140
Global model norm: 15.705168846313335.
Norm before scaling: 15.765225272125337. Distance: 4.483628267327165
Total norm for 4 adversaries is: 15.765225272125337. distance: 4.483628267327165
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 0.2337, Accuracy: 8388/8968 (93.5326%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93, 70, 91, 20]
base_p: [-0.00296721  0.00026935 -0.00024188 ... -0.00195386 -0.00599784
 -0.00186346]
[T_SCORE] attacker_local_idxs is:  [0, 3, 6, 8, 9]
layer1_inf_time: 2.194580078125
[PAIRWISE] pred_attackers_indx:  [0 3 6 9]
layer2_inf_t: 25.248046875
assumed final_attacker_idxs:  [0 3 6 8 9]
final_attacker_idxs is: [0, 3, 6, 8, 9]
g_attacker_idxs: [93 70 91 67 20]
g_normal_idxs: [87 55 15 90 86]
filtered_attacker_idxs: [0, 3, 6, 8, 9]
final_attacker_idxs are: [0, 3, 6, 8, 9]
num_dps: [623, 470, 354, 724, 401, 683, 256, 250, 998, 429]
epoch_acc: 97.89
time spent on training: 52.99227547645569
Starting performing KrMLRFL...
Num data points: [623, 470, 354, 724, 401, 683, 256, 250, 998, 429]
Num selected data points: [470 354 401 683 250]
The chosen ones are users: [1, 2, 4, 5, 7], which are global users: [87, 55, 15, 90, 86]
___Test Local_Simple poisoned: False, epoch: 42: Average loss: 0.0641, Accuracy: 9789/10000 (97.8900%)
___Test Local_Simple poisoned: True, epoch: 42: Average loss: 12.8631, Accuracy: 22/8968 (0.2453%)
Done in 140.8024652004242 sec.
Server Epoch:43 choose agents : [77, 57, 21, 67, 14, 97, 28, 22, 70, 93].
___Train Local_Simple,  epoch  43, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 582/589 (98.8115%)
___Train Local_Simple,  epoch  43, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 580/589 (98.4720%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0840, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch  43, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 336/343 (97.9592%)
___Train Local_Simple,  epoch  43, local model 57, internal_epoch   2,  Average loss: 0.0012, Accuracy: 337/343 (98.2507%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1872, Accuracy: 9393/10000 (93.9300%)
___Train Local_Simple,  epoch  43, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 311/312 (99.6795%)
___Train Local_Simple,  epoch  43, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1054, Accuracy: 9651/10000 (96.5100%)
___Train Local_Simple,  epoch  43, local model 67, internal_epoch   1,  Average loss: 0.0008, Accuracy: 985/998 (98.6974%)
___Train Local_Simple,  epoch  43, local model 67, internal_epoch   2,  Average loss: 0.0010, Accuracy: 976/998 (97.7956%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.2092, Accuracy: 9326/10000 (93.2600%)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   1,  Average loss: 0.0006, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch  43, local model 14, internal_epoch   2,  Average loss: 0.0008, Accuracy: 371/376 (98.6702%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.1013, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch  43, local model 97, internal_epoch   2,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0777, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  43, local model 28, internal_epoch   1,  Average loss: 0.0006, Accuracy: 492/501 (98.2036%)
___Train Local_Simple,  epoch  43, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0689, Accuracy: 9779/10000 (97.7900%)
poison local model 22 index 0
class_loss: 3.1239497661590576, distance_loss: 0.0
class_loss: 1.6611491441726685, distance_loss: 0.28410178422927856
class_loss: 2.2777974605560303, distance_loss: 0.7189509272575378
class_loss: 1.3685672283172607, distance_loss: 1.0212805271148682
class_loss: 0.9724970459938049, distance_loss: 1.3284529447555542
class_loss: 0.9324049949645996, distance_loss: 1.6343048810958862
class_loss: 1.249717116355896, distance_loss: 1.9301766157150269
class_loss: 1.2285312414169312, distance_loss: 2.2034828662872314
class_loss: 1.1428676843643188, distance_loss: 2.447683811187744
class_loss: 1.4565109014511108, distance_loss: 2.6520628929138184
class_loss: 1.2688617706298828, distance_loss: 2.857804298400879
class_loss: 1.2876137495040894, distance_loss: 3.0389721393585205
class_loss: 1.1714996099472046, distance_loss: 3.19315505027771
class_loss: 1.1529494524002075, distance_loss: 3.324124813079834
class_loss: 0.9310200214385986, distance_loss: 3.4334771633148193
class_loss: 1.1359567642211914, distance_loss: 3.536881923675537
class_loss: 1.0249780416488647, distance_loss: 3.6360087394714355
class_loss: 0.9847551584243774, distance_loss: 3.7292065620422363
class_loss: 0.9545651078224182, distance_loss: 3.8187639713287354
class_loss: 1.5259767770767212, distance_loss: 3.9038538932800293
___PoisonTrain Local_Simple ,  epoch  43, local model 22, internal_epoch   1,  Average loss: 0.0264, Accuracy: 355/583 (60.8919%), train_poison_data_count: 187
___PoisonTrain Local_Simple ,  epoch  43, local model 22, internal_epoch   2,  Average loss: 0.0196, Accuracy: 297/583 (50.9434%), train_poison_data_count: 187
Global model norm: 15.682419885241922.
Norm before scaling: 15.658942137707461. Distance: 4.030035264686792
Total norm for 3 adversaries is: 15.658942137707461. distance: 4.030035264686792
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.7219, Accuracy: 7431/8968 (82.8613%)
poison local model 70 index 1
class_loss: 3.3192808628082275, distance_loss: 0.0
class_loss: 2.319844961166382, distance_loss: 0.3014407753944397
class_loss: 1.6639981269836426, distance_loss: 0.7811276316642761
class_loss: 1.7611141204833984, distance_loss: 1.199074149131775
class_loss: 1.6378172636032104, distance_loss: 1.5422759056091309
class_loss: 1.3906205892562866, distance_loss: 1.866186261177063
class_loss: 1.4347320795059204, distance_loss: 2.1790754795074463
class_loss: 1.3283228874206543, distance_loss: 2.463527202606201
class_loss: 1.4604790210723877, distance_loss: 2.71854829788208
class_loss: 1.2725577354431152, distance_loss: 2.9447062015533447
class_loss: 1.3831099271774292, distance_loss: 3.15029239654541
class_loss: 1.1082565784454346, distance_loss: 3.3350718021392822
class_loss: 1.3579939603805542, distance_loss: 3.5240654945373535
class_loss: 1.441685438156128, distance_loss: 3.6882383823394775
class_loss: 1.2054800987243652, distance_loss: 3.822674036026001
class_loss: 1.1596039533615112, distance_loss: 3.9440271854400635
class_loss: 1.2453656196594238, distance_loss: 4.060083389282227
class_loss: 1.0449644327163696, distance_loss: 4.165855884552002
class_loss: 1.0348583459854126, distance_loss: 4.26625919342041
class_loss: 1.0491070747375488, distance_loss: 4.361271381378174
class_loss: 0.9681179523468018, distance_loss: 4.449779033660889
class_loss: 1.061403512954712, distance_loss: 4.530637741088867
class_loss: 1.1025118827819824, distance_loss: 4.600654125213623
class_loss: 1.3246994018554688, distance_loss: 4.661808967590332
___PoisonTrain Local_Simple ,  epoch  43, local model 70, internal_epoch   1,  Average loss: 0.0277, Accuracy: 366/724 (50.5525%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  43, local model 70, internal_epoch   2,  Average loss: 0.0193, Accuracy: 351/724 (48.4807%), train_poison_data_count: 240
Global model norm: 15.682419885241922.
Norm before scaling: 15.914191940747514. Distance: 4.750561329651196
Total norm for 3 adversaries is: 15.914191940747514. distance: 4.750561329651196
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 0.7345, Accuracy: 6076/8968 (67.7520%)
poison local model 93 index 2
class_loss: 3.8691396713256836, distance_loss: 0.0
class_loss: 1.7036077976226807, distance_loss: 0.3419358432292938
class_loss: 1.6397069692611694, distance_loss: 0.8343994617462158
class_loss: 2.1883862018585205, distance_loss: 1.1915796995162964
class_loss: 1.2656341791152954, distance_loss: 1.5151301622390747
class_loss: 1.3130459785461426, distance_loss: 1.8676525354385376
class_loss: 1.386932611465454, distance_loss: 2.194518566131592
class_loss: 1.4021263122558594, distance_loss: 2.490880012512207
class_loss: 1.2670412063598633, distance_loss: 2.7553186416625977
class_loss: 1.1914020776748657, distance_loss: 2.997115135192871
class_loss: 1.1498610973358154, distance_loss: 3.218606948852539
class_loss: 1.0398484468460083, distance_loss: 3.423398971557617
class_loss: 0.8976825475692749, distance_loss: 3.6130268573760986
class_loss: 1.002192497253418, distance_loss: 3.788576602935791
class_loss: 0.9367563724517822, distance_loss: 3.948366165161133
class_loss: 0.9523288607597351, distance_loss: 4.085775375366211
class_loss: 0.8628522753715515, distance_loss: 4.211187362670898
class_loss: 0.7975381016731262, distance_loss: 4.327845573425293
class_loss: 1.0661219358444214, distance_loss: 4.436508655548096
class_loss: 0.8894636034965515, distance_loss: 4.534668922424316
___PoisonTrain Local_Simple ,  epoch  43, local model 93, internal_epoch   1,  Average loss: 0.0277, Accuracy: 329/623 (52.8090%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  43, local model 93, internal_epoch   2,  Average loss: 0.0154, Accuracy: 352/623 (56.5008%), train_poison_data_count: 200
Global model norm: 15.682419885241922.
Norm before scaling: 15.83706722737066. Distance: 4.631044304484428
Total norm for 3 adversaries is: 15.83706722737066. distance: 4.631044304484428
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 1.2504, Accuracy: 4377/8968 (48.8069%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 70, 93]
base_p: [-0.00111576  0.00022357 -0.0003612  ... -0.00452366 -0.00728261
 -0.00173426]
[T_SCORE] attacker_local_idxs is:  [0, 3, 7, 8, 9]
layer1_inf_time: 2.847900390625
[PAIRWISE] pred_attackers_indx:  [7 8 9]
layer2_inf_t: 26.568359375
assumed final_attacker_idxs:  [0 3 7 8 9]
final_attacker_idxs is: [0, 3, 7, 8, 9]
g_attacker_idxs: [77 67 22 70 93]
g_normal_idxs: [57 21 14 97 28]
filtered_attacker_idxs: [0, 3, 7, 8, 9]
final_attacker_idxs are: [0, 3, 7, 8, 9]
num_dps: [589, 343, 312, 998, 376, 487, 501, 583, 724, 623]
epoch_acc: 98.55000000000001
time spent on training: 50.29609704017639
Starting performing KrMLRFL...
Num data points: [589, 343, 312, 998, 376, 487, 501, 583, 724, 623]
Num selected data points: [343 312 376 487 501]
The chosen ones are users: [1, 2, 4, 5, 6], which are global users: [57, 21, 14, 97, 28]
___Test Local_Simple poisoned: False, epoch: 43: Average loss: 0.0461, Accuracy: 9855/10000 (98.5500%)
___Test Local_Simple poisoned: True, epoch: 43: Average loss: 12.8057, Accuracy: 25/8968 (0.2788%)
Done in 142.2838408946991 sec.
Server Epoch:44 choose agents : [37, 49, 41, 50, 71, 60, 42, 83, 26, 48].
___Train Local_Simple,  epoch  44, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 850/860 (98.8372%)
___Train Local_Simple,  epoch  44, local model 37, internal_epoch   2,  Average loss: 0.0003, Accuracy: 855/860 (99.4186%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1583, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch  44, local model 49, internal_epoch   1,  Average loss: 0.0007, Accuracy: 499/506 (98.6166%)
___Train Local_Simple,  epoch  44, local model 49, internal_epoch   2,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0973, Accuracy: 9689/10000 (96.8900%)
___Train Local_Simple,  epoch  44, local model 41, internal_epoch   1,  Average loss: 0.0009, Accuracy: 596/606 (98.3498%)
___Train Local_Simple,  epoch  44, local model 41, internal_epoch   2,  Average loss: 0.0007, Accuracy: 599/606 (98.8449%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.2775, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch  44, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 469/474 (98.9451%)
___Train Local_Simple,  epoch  44, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1378, Accuracy: 9553/10000 (95.5300%)
poison local model 71 index 0
class_loss: 3.063450574874878, distance_loss: 0.0
class_loss: 1.8881638050079346, distance_loss: 0.3364536166191101
class_loss: 1.5748122930526733, distance_loss: 0.8426998853683472
class_loss: 2.479281425476074, distance_loss: 1.2151240110397339
class_loss: 1.6348340511322021, distance_loss: 1.528304100036621
class_loss: 1.2179055213928223, distance_loss: 1.8534955978393555
class_loss: 1.313793659210205, distance_loss: 2.173767566680908
class_loss: 1.1264448165893555, distance_loss: 2.4784176349639893
class_loss: 1.0069233179092407, distance_loss: 2.763322353363037
class_loss: 0.8758227825164795, distance_loss: 3.0347795486450195
class_loss: 1.2386518716812134, distance_loss: 3.292184352874756
class_loss: 0.9926608800888062, distance_loss: 3.525991916656494
class_loss: 0.887188732624054, distance_loss: 3.740238904953003
class_loss: 0.8470238447189331, distance_loss: 3.933591365814209
class_loss: 0.8049909472465515, distance_loss: 4.108035087585449
class_loss: 1.0394079685211182, distance_loss: 4.266197204589844
class_loss: 0.8208808302879333, distance_loss: 4.411727428436279
class_loss: 0.7241321802139282, distance_loss: 4.544673919677734
class_loss: 0.9081852436065674, distance_loss: 4.668041706085205
class_loss: 0.868782639503479, distance_loss: 4.783982276916504
class_loss: 0.8104476928710938, distance_loss: 4.887355804443359
class_loss: 1.0555652379989624, distance_loss: 4.979257583618164
___PoisonTrain Local_Simple ,  epoch  44, local model 71, internal_epoch   1,  Average loss: 0.0196, Accuracy: 773/1384 (55.8526%), train_poison_data_count: 440
class_loss: 0.7499425411224365, distance_loss: 5.070927619934082
class_loss: 0.7133255004882812, distance_loss: 5.155030727386475
class_loss: 0.787468433380127, distance_loss: 5.23061990737915
class_loss: 0.9600986242294312, distance_loss: 5.29539155960083
class_loss: 0.8043274879455566, distance_loss: 5.3482441902160645
class_loss: 0.6918604969978333, distance_loss: 5.39370584487915
class_loss: 0.7557552456855774, distance_loss: 5.437629222869873
class_loss: 0.611217737197876, distance_loss: 5.481043338775635
class_loss: 0.7200297117233276, distance_loss: 5.5233612060546875
class_loss: 0.7684620022773743, distance_loss: 5.563343048095703
class_loss: 0.7874516844749451, distance_loss: 5.603946208953857
class_loss: 0.581937313079834, distance_loss: 5.643571376800537
class_loss: 0.7750720977783203, distance_loss: 5.682745456695557
class_loss: 0.7296294569969177, distance_loss: 5.715848445892334
class_loss: 0.6379355192184448, distance_loss: 5.742140769958496
class_loss: 0.6113144755363464, distance_loss: 5.764161109924316
class_loss: 0.7281514406204224, distance_loss: 5.782662868499756
class_loss: 0.6595529913902283, distance_loss: 5.800671100616455
class_loss: 0.6915587782859802, distance_loss: 5.82150936126709
class_loss: 0.7094317674636841, distance_loss: 5.841416358947754
class_loss: 0.6897830963134766, distance_loss: 5.859127044677734
class_loss: 0.6103638410568237, distance_loss: 5.875171184539795
___PoisonTrain Local_Simple ,  epoch  44, local model 71, internal_epoch   2,  Average loss: 0.0114, Accuracy: 871/1384 (62.9335%), train_poison_data_count: 440
Global model norm: 15.664448249614276.
Norm before scaling: 16.226434610714126. Distance: 5.8969055207336485
Total norm for 3 adversaries is: 16.226434610714126. distance: 5.8969055207336485
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.8474, Accuracy: 5253/8968 (58.5749%)
___Train Local_Simple,  epoch  44, local model 60, internal_epoch   1,  Average loss: 0.0012, Accuracy: 331/338 (97.9290%)
___Train Local_Simple,  epoch  44, local model 60, internal_epoch   2,  Average loss: 0.0006, Accuracy: 334/338 (98.8166%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.1855, Accuracy: 9444/10000 (94.4400%)
poison local model 42 index 1
class_loss: 3.099151849746704, distance_loss: 0.0
class_loss: 2.600531816482544, distance_loss: 0.30966100096702576
class_loss: 1.5637688636779785, distance_loss: 0.7726966142654419
class_loss: 1.1385973691940308, distance_loss: 1.1876578330993652
class_loss: 1.2570134401321411, distance_loss: 1.585170030593872
class_loss: 1.195286512374878, distance_loss: 1.9388501644134521
class_loss: 1.2513525485992432, distance_loss: 2.2619247436523438
class_loss: 1.3222934007644653, distance_loss: 2.5529592037200928
___PoisonTrain Local_Simple ,  epoch  44, local model 42, internal_epoch   1,  Average loss: 0.0356, Accuracy: 165/236 (69.9153%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  44, local model 42, internal_epoch   2,  Average loss: 0.0213, Accuracy: 125/236 (52.9661%), train_poison_data_count: 80
Global model norm: 15.664448249614276.
Norm before scaling: 15.42152523428723. Distance: 2.8109931299918847
Total norm for 3 adversaries is: 15.42152523428723. distance: 2.8109931299918847
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 1.0905, Accuracy: 6751/8968 (75.2788%)
___Train Local_Simple,  epoch  44, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 429/433 (99.0762%)
___Train Local_Simple,  epoch  44, local model 83, internal_epoch   2,  Average loss: 0.0004, Accuracy: 431/433 (99.5381%)
class_loss: 2.1520044803619385, distance_loss: 0.0
class_loss: 2.6143038272857666, distance_loss: 0.1770997941493988
class_loss: 0.9433836936950684, distance_loss: 0.5113075971603394
class_loss: 0.8452656865119934, distance_loss: 0.9456400871276855
class_loss: 2.0484018325805664, distance_loss: 1.3617737293243408
class_loss: 1.8755154609680176, distance_loss: 1.7311923503875732
class_loss: 1.0606476068496704, distance_loss: 2.073432445526123
class_loss: 1.2467041015625, distance_loss: 2.4108521938323975
class_loss: 1.2482026815414429, distance_loss: 2.716855525970459
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0706, Accuracy: 9766/10000 (97.6600%)
poison local model 26 index 2
___PoisonTrain Local_Simple ,  epoch  44, local model 26, internal_epoch   1,  Average loss: 0.0253, Accuracy: 382/554 (68.9531%), train_poison_data_count: 180
class_loss: 1.1360803842544556, distance_loss: 2.9899537563323975
class_loss: 1.313476800918579, distance_loss: 3.2384097576141357
class_loss: 1.010002851486206, distance_loss: 3.4641597270965576
class_loss: 1.226825475692749, distance_loss: 3.667314052581787
class_loss: 0.9083774089813232, distance_loss: 3.840588331222534
class_loss: 1.12449049949646, distance_loss: 3.995300054550171
class_loss: 0.9440714120864868, distance_loss: 4.13832426071167
class_loss: 0.9624212384223938, distance_loss: 4.272918224334717
class_loss: 0.972635805606842, distance_loss: 4.400302886962891
___PoisonTrain Local_Simple ,  epoch  44, local model 26, internal_epoch   2,  Average loss: 0.0173, Accuracy: 331/554 (59.7473%), train_poison_data_count: 180
Global model norm: 15.664448249614276.
Norm before scaling: 15.597949240455057. Distance: 4.518442509109736
Total norm for 3 adversaries is: 15.597949240455057. distance: 4.518442509109736
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 0.8980, Accuracy: 6444/8968 (71.8555%)
___Train Local_Simple,  epoch  44, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch  44, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0748, Accuracy: 9762/10000 (97.6200%)
time spent on training: 45.80072641372681
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [71, 42, 26]
base_p: [-0.00104936  0.00025351 -0.00013119 ... -0.00177908 -0.00840858
 -0.00302892]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 6, 8]
layer1_inf_time: 3.065185546875
[PAIRWISE] pred_attackers_indx:  [4 6 8]
layer2_inf_t: 77.8564453125
assumed final_attacker_idxs:  [0 1 4 6 8]
final_attacker_idxs is: [0, 1, 4, 6, 8]
g_attacker_idxs: [37 49 71 42 26]
g_normal_idxs: [41 50 60 83 48]
filtered_attacker_idxs: [0, 1, 4, 6, 8]
final_attacker_idxs are: [0, 1, 4, 6, 8]
num_dps: [860, 506, 606, 474, 1384, 338, 236, 433, 554, 448]
epoch_acc: 98.39
Starting performing KrMLRFL...
Num data points: [860, 506, 606, 474, 1384, 338, 236, 433, 554, 448]
Num selected data points: [606 474 338 433 448]
The chosen ones are users: [2, 3, 5, 7, 9], which are global users: [41, 50, 60, 83, 48]
___Test Local_Simple poisoned: False, epoch: 44: Average loss: 0.0492, Accuracy: 9839/10000 (98.3900%)
___Test Local_Simple poisoned: True, epoch: 44: Average loss: 13.2857, Accuracy: 45/8968 (0.5018%)
Done in 132.39280533790588 sec.
Server Epoch:45 choose agents : [50, 36, 53, 79, 33, 25, 15, 1, 65, 98].
___Train Local_Simple,  epoch  45, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 472/474 (99.5781%)
___Train Local_Simple,  epoch  45, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3029, Accuracy: 9230/10000 (92.3000%)
___Train Local_Simple,  epoch  45, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 995/1005 (99.0050%)
___Train Local_Simple,  epoch  45, local model 36, internal_epoch   2,  Average loss: 0.0006, Accuracy: 994/1005 (98.9055%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.5085, Accuracy: 8748/10000 (87.4800%)
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch  45, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 738/739 (99.8647%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.4431, Accuracy: 8723/10000 (87.2300%)
___Train Local_Simple,  epoch  45, local model 79, internal_epoch   1,  Average loss: 0.0006, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch  45, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0686, Accuracy: 9767/10000 (97.6700%)
___Train Local_Simple,  epoch  45, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 614/623 (98.5554%)
___Train Local_Simple,  epoch  45, local model 33, internal_epoch   2,  Average loss: 0.0005, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1711, Accuracy: 9453/10000 (94.5300%)
___Train Local_Simple,  epoch  45, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 642/647 (99.2272%)
___Train Local_Simple,  epoch  45, local model 25, internal_epoch   2,  Average loss: 0.0005, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3965, Accuracy: 8855/10000 (88.5500%)
___Train Local_Simple,  epoch  45, local model 15, internal_epoch   1,  Average loss: 0.0008, Accuracy: 395/401 (98.5037%)
class_loss: 3.71370267868042, distance_loss: 0.0
class_loss: 2.594632148742676, distance_loss: 0.304034560918808
class_loss: 1.084945797920227, distance_loss: 0.7945395112037659
class_loss: 1.436895489692688, distance_loss: 1.2900962829589844
class_loss: 1.0512669086456299, distance_loss: 1.684822678565979
class_loss: 0.9869275689125061, distance_loss: 2.030402421951294
class_loss: 1.1986305713653564, distance_loss: 2.3448221683502197
___Train Local_Simple,  epoch  45, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.1188, Accuracy: 9591/10000 (95.9100%)
poison local model 1 index 0
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   1,  Average loss: 0.0226, Accuracy: 480/760 (63.1579%), train_poison_data_count: 240
class_loss: 1.2579028606414795, distance_loss: 2.622080087661743
class_loss: 1.0692881345748901, distance_loss: 2.8681399822235107
class_loss: 1.1254603862762451, distance_loss: 3.0858230590820312
class_loss: 0.8998206853866577, distance_loss: 3.283182144165039
class_loss: 0.7570085525512695, distance_loss: 3.4667088985443115
class_loss: 0.6027830839157104, distance_loss: 3.638310670852661
class_loss: 0.5824127793312073, distance_loss: 3.799984931945801
class_loss: 0.5301172733306885, distance_loss: 3.9509592056274414
class_loss: 0.510637640953064, distance_loss: 4.088031768798828
class_loss: 0.46406635642051697, distance_loss: 4.216881275177002
class_loss: 0.29880595207214355, distance_loss: 4.3414435386657715
class_loss: 0.38014984130859375, distance_loss: 4.4628777503967285
class_loss: 0.28995323181152344, distance_loss: 4.578768730163574
class_loss: 0.4118295907974243, distance_loss: 4.685091018676758
class_loss: 0.25529608130455017, distance_loss: 4.779549598693848
class_loss: 0.23099182546138763, distance_loss: 4.867015838623047
class_loss: 0.30739474296569824, distance_loss: 4.948360443115234
___PoisonTrain Local_Simple ,  epoch  45, local model 1, internal_epoch   2,  Average loss: 0.0064, Accuracy: 660/760 (86.8421%), train_poison_data_count: 240
Global model norm: 15.64772127276919.
Norm before scaling: 16.102799147379915. Distance: 5.020695580245537
Total norm for 1 adversaries is: 16.102799147379915. distance: 5.020695580245537
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 0.0178, Accuracy: 8923/8968 (99.4982%)
___Train Local_Simple,  epoch  45, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch  45, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0917, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch  45, local model 98, internal_epoch   1,  Average loss: 0.0011, Accuracy: 799/818 (97.6773%)
___Train Local_Simple,  epoch  45, local model 98, internal_epoch   2,  Average loss: 0.0007, Accuracy: 807/818 (98.6553%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1]
base_p: [-0.00285478  0.00038719  0.00026355 ...  0.00017543 -0.00114193
  0.00100679]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 7, 9]
layer1_inf_time: 2.6904296875
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 30.705322265625
assumed final_attacker_idxs:  [1 2 4 7 9]
final_attacker_idxs is: [1, 2, 4, 7, 9]
g_attacker_idxs: [36 53 33  1 98]
g_normal_idxs: [50 79 25 15 65]
filtered_attacker_idxs: [1, 2, 4, 7, 9]
final_attacker_idxs are: [1, 2, 4, 7, 9]
num_dps: [474, 1005, 739, 182, 623, 647, 401, 760, 371, 818]
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.3591, Accuracy: 8959/10000 (89.5900%)
time spent on training: 36.5623619556427
Starting performing KrMLRFL...
Num data points: [474, 1005, 739, 182, 623, 647, 401, 760, 371, 818]
Num selected data points: [474 182 647 401 371]
The chosen ones are users: [0, 3, 5, 6, 8], which are global users: [50, 79, 25, 15, 65]
___Test Local_Simple poisoned: False, epoch: 45: Average loss: 0.0620, Accuracy: 9802/10000 (98.0200%)
epoch_acc: 98.02
___Test Local_Simple poisoned: True, epoch: 45: Average loss: 13.3123, Accuracy: 38/8968 (0.4237%)
Done in 124.59036016464233 sec.
Server Epoch:46 choose agents : [82, 4, 79, 32, 47, 44, 89, 48, 70, 77].
___Train Local_Simple,  epoch  46, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 707/713 (99.1585%)
___Train Local_Simple,  epoch  46, local model 82, internal_epoch   2,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.3277, Accuracy: 8987/10000 (89.8700%)
___Train Local_Simple,  epoch  46, local model 4, internal_epoch   1,  Average loss: 0.0010, Accuracy: 647/658 (98.3283%)
___Train Local_Simple,  epoch  46, local model 4, internal_epoch   2,  Average loss: 0.0009, Accuracy: 647/658 (98.3283%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1650, Accuracy: 9480/10000 (94.8000%)
___Train Local_Simple,  epoch  46, local model 79, internal_epoch   1,  Average loss: 0.0012, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch  46, local model 79, internal_epoch   2,  Average loss: 0.0003, Accuracy: 181/182 (99.4505%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0748, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch  46, local model 32, internal_epoch   1,  Average loss: 0.0010, Accuracy: 955/977 (97.7482%)
___Train Local_Simple,  epoch  46, local model 32, internal_epoch   2,  Average loss: 0.0004, Accuracy: 968/977 (99.0788%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1366, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch  46, local model 47, internal_epoch   1,  Average loss: 0.0008, Accuracy: 765/776 (98.5825%)
___Train Local_Simple,  epoch  46, local model 47, internal_epoch   2,  Average loss: 0.0002, Accuracy: 773/776 (99.6134%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1313, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  46, local model 44, internal_epoch   1,  Average loss: 0.0009, Accuracy: 507/517 (98.0658%)
___Train Local_Simple,  epoch  46, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 513/517 (99.2263%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0984, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   1,  Average loss: 0.0010, Accuracy: 484/492 (98.3740%)
___Train Local_Simple,  epoch  46, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1952, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch  46, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 444/448 (99.1071%)
___Train Local_Simple,  epoch  46, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
class_loss: 3.5503323078155518, distance_loss: 0.0
class_loss: 2.672210693359375, distance_loss: 0.282307505607605
class_loss: 1.5160346031188965, distance_loss: 0.7799643874168396
class_loss: 1.2331355810165405, distance_loss: 1.2755801677703857
class_loss: 1.3807687759399414, distance_loss: 1.694908857345581
class_loss: 1.2436028718948364, distance_loss: 2.0509722232818604
class_loss: 1.372909665107727, distance_loss: 2.3680996894836426
class_loss: 1.2519211769104004, distance_loss: 2.6552891731262207
class_loss: 1.2523165941238403, distance_loss: 2.913003444671631
class_loss: 1.0164967775344849, distance_loss: 3.1460580825805664
class_loss: 1.0330923795700073, distance_loss: 3.3581490516662598
class_loss: 0.13898447155952454, distance_loss: 3.5552706718444824
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1129, Accuracy: 9664/10000 (96.6400%)
poison local model 70 index 0
___PoisonTrain Local_Simple ,  epoch  46, local model 70, internal_epoch   1,  Average loss: 0.0244, Accuracy: 440/724 (60.7735%), train_poison_data_count: 240
class_loss: 0.8645205497741699, distance_loss: 3.749053716659546
class_loss: 0.973404049873352, distance_loss: 3.921973943710327
class_loss: 0.6868318915367126, distance_loss: 4.076086521148682
class_loss: 0.5714830756187439, distance_loss: 4.219456672668457
class_loss: 0.46853041648864746, distance_loss: 4.358223915100098
class_loss: 0.4349077343940735, distance_loss: 4.495799541473389
class_loss: 0.5119475722312927, distance_loss: 4.630558967590332
class_loss: 0.31556153297424316, distance_loss: 4.761597156524658
class_loss: 0.13760687410831451, distance_loss: 4.883861541748047
class_loss: 0.2690199315547943, distance_loss: 5.0008320808410645
class_loss: 0.3274722099304199, distance_loss: 5.106042385101318
class_loss: 0.017199641093611717, distance_loss: 5.206695556640625
___PoisonTrain Local_Simple ,  epoch  46, local model 70, internal_epoch   2,  Average loss: 0.0077, Accuracy: 597/724 (82.4586%), train_poison_data_count: 240
Global model norm: 15.635950264497138.
Norm before scaling: 16.100049017600554. Distance: 5.305569604896109
Total norm for 1 adversaries is: 16.100049017600554. distance: 5.305569604896109
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 0.0729, Accuracy: 8761/8968 (97.6918%)
___Train Local_Simple,  epoch  46, local model 77, internal_epoch   1,  Average loss: 0.0013, Accuracy: 575/589 (97.6231%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70]
base_p: [ 0.00052172  0.00031026 -0.00032869 ...  0.00385075 -0.00767156
 -0.0019934 ]
[T_SCORE] attacker_local_idxs is:  [1, 3, 6, 8, 9]
layer1_inf_time: 2.64453125
[PAIRWISE] pred_attackers_indx:  [8]
layer2_inf_t: 26.560546875
assumed final_attacker_idxs:  [1 3 6 8 9]
final_attacker_idxs is: [1, 3, 6, 8, 9]
g_attacker_idxs: [ 4 32 89 70 77]
g_normal_idxs: [82 79 47 44 48]
filtered_attacker_idxs: [1, 3, 6, 8, 9]
final_attacker_idxs are: [1, 3, 6, 8, 9]
num_dps: [713, 658, 182, 977, 776, 517, 492, 448, 724, 589]
___Train Local_Simple,  epoch  46, local model 77, internal_epoch   2,  Average loss: 0.0016, Accuracy: 573/589 (97.2835%)
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.1498, Accuracy: 9549/10000 (95.4900%)
time spent on training: 34.86366248130798
Starting performing KrMLRFL...
Num data points: [713, 658, 182, 977, 776, 517, 492, 448, 724, 589]
Num selected data points: [713 182 776 517 448]
The chosen ones are users: [0, 2, 4, 5, 7], which are global users: [82, 79, 47, 44, 48]
epoch_acc: 98.69
___Test Local_Simple poisoned: False, epoch: 46: Average loss: 0.0412, Accuracy: 9869/10000 (98.6900%)
___Test Local_Simple poisoned: True, epoch: 46: Average loss: 13.9215, Accuracy: 19/8968 (0.2119%)
class_loss: 5.028755187988281, distance_loss: 0.0
class_loss: 2.874501943588257, distance_loss: 0.4093308746814728
class_loss: 2.2284011840820312, distance_loss: 1.0090898275375366
class_loss: 1.5704569816589355, distance_loss: 1.5065428018569946
class_loss: 1.4312742948532104, distance_loss: 1.941114068031311
class_loss: 1.612008810043335, distance_loss: 2.333648204803467
class_loss: 1.5898594856262207, distance_loss: 2.6880064010620117
class_loss: 1.3047195672988892, distance_loss: 3.000518321990967
Done in 120.20536184310913 sec.
Server Epoch:47 choose agents : [27, 30, 33, 41, 5, 52, 84, 43, 62, 18].
poison local model 27 index 0
___PoisonTrain Local_Simple ,  epoch  47, local model 27, internal_epoch   1,  Average loss: 0.0375, Accuracy: 228/471 (48.4076%), train_poison_data_count: 160
class_loss: 1.438891053199768, distance_loss: 3.2861506938934326
class_loss: 1.2974601984024048, distance_loss: 3.5416016578674316
class_loss: 1.1756056547164917, distance_loss: 3.7747912406921387
class_loss: 1.0240119695663452, distance_loss: 3.988510847091675
class_loss: 1.0213488340377808, distance_loss: 4.184330463409424
class_loss: 1.0916391611099243, distance_loss: 4.361860752105713
class_loss: 0.9198015928268433, distance_loss: 4.526525020599365
class_loss: 1.6099891662597656, distance_loss: 4.676848411560059
___PoisonTrain Local_Simple ,  epoch  47, local model 27, internal_epoch   2,  Average loss: 0.0203, Accuracy: 218/471 (46.2845%), train_poison_data_count: 160
Global model norm: 15.601297940765168.
Norm before scaling: 15.643543683717414. Distance: 4.825537126914726
Total norm for 2 adversaries is: 15.643543683717414. distance: 4.825537126914726
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 0.8628, Accuracy: 5366/8968 (59.8350%)
___Train Local_Simple,  epoch  47, local model 30, internal_epoch   1,  Average loss: 0.0005, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch  47, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2413, Accuracy: 9240/10000 (92.4000%)
___Train Local_Simple,  epoch  47, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 612/623 (98.2343%)
___Train Local_Simple,  epoch  47, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.2548, Accuracy: 9244/10000 (92.4400%)
___Train Local_Simple,  epoch  47, local model 41, internal_epoch   1,  Average loss: 0.0006, Accuracy: 596/606 (98.3498%)
___Train Local_Simple,  epoch  47, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3037, Accuracy: 9186/10000 (91.8600%)
___Train Local_Simple,  epoch  47, local model 5, internal_epoch   1,  Average loss: 0.0013, Accuracy: 425/434 (97.9263%)
___Train Local_Simple,  epoch  47, local model 5, internal_epoch   2,  Average loss: 0.0004, Accuracy: 430/434 (99.0783%)
class_loss: 4.022748947143555, distance_loss: 0.0
class_loss: 2.3787693977355957, distance_loss: 0.4133031368255615
class_loss: 2.6787612438201904, distance_loss: 1.0087635517120361
class_loss: 1.9699386358261108, distance_loss: 1.4444493055343628
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.6829, Accuracy: 8825/10000 (88.2500%)
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  47, local model 52, internal_epoch   1,  Average loss: 0.0437, Accuracy: 137/253 (54.1502%), train_poison_data_count: 80
class_loss: 1.5085474252700806, distance_loss: 1.8566495180130005
class_loss: 1.5469603538513184, distance_loss: 2.2604575157165527
class_loss: 1.5620297193527222, distance_loss: 2.628333806991577
class_loss: 1.4316236972808838, distance_loss: 2.9608089923858643
___PoisonTrain Local_Simple ,  epoch  47, local model 52, internal_epoch   2,  Average loss: 0.0239, Accuracy: 106/253 (41.8972%), train_poison_data_count: 80
Global model norm: 15.601297940765168.
Norm before scaling: 15.400090284206737. Distance: 3.2664329587934287
Total norm for 2 adversaries is: 15.400090284206737. distance: 3.2664329587934287
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 1.6077, Accuracy: 2806/8968 (31.2890%)
___Train Local_Simple,  epoch  47, local model 84, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1223/1246 (98.1541%)
___Train Local_Simple,  epoch  47, local model 84, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1225/1246 (98.3146%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.1612, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 402/408 (98.5294%)
___Train Local_Simple,  epoch  47, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0695, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch  47, local model 62, internal_epoch   1,  Average loss: 0.0005, Accuracy: 419/423 (99.0544%)
___Train Local_Simple,  epoch  47, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0623, Accuracy: 9776/10000 (97.7600%)
___Train Local_Simple,  epoch  47, local model 18, internal_epoch   1,  Average loss: 0.0014, Accuracy: 448/459 (97.6035%)
___Train Local_Simple,  epoch  47, local model 18, internal_epoch   2,  Average loss: 0.0007, Accuracy: 452/459 (98.4749%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 52]
base_p: [-0.00284146  0.00032361 -0.00017885 ...  0.00067324 -0.00778336
  0.0029146 ]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 6, 9]
layer1_inf_time: 2.580322265625
[PAIRWISE] pred_attackers_indx:  [0 5]
layer2_inf_t: 28.279052734375
assumed final_attacker_idxs:  [0 4 5 6 9]
final_attacker_idxs is: [0, 4, 5, 6, 9]
g_attacker_idxs: [27  5 52 84 18]
g_normal_idxs: [30 33 41 43 62]
filtered_attacker_idxs: [0, 4, 5, 6, 9]
final_attacker_idxs are: [0, 4, 5, 6, 9]
num_dps: [471, 400, 623, 606, 434, 253, 1246, 408, 423, 459]
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.3229, Accuracy: 9216/10000 (92.1600%)
time spent on training: 40.30928325653076
Starting performing KrMLRFL...
Num data points: [471, 400, 623, 606, 434, 253, 1246, 408, 423, 459]
Num selected data points: [400 623 606 408 423]
The chosen ones are users: [1, 2, 3, 7, 8], which are global users: [30, 33, 41, 43, 62]
___Test Local_Simple poisoned: False, epoch: 47: Average loss: 0.0557, Accuracy: 9811/10000 (98.1100%)
epoch_acc: 98.11
___Test Local_Simple poisoned: True, epoch: 47: Average loss: 14.2901, Accuracy: 23/8968 (0.2565%)
Done in 129.07334399223328 sec.
Server Epoch:48 choose agents : [39, 29, 87, 78, 53, 83, 19, 45, 52, 17].
___Train Local_Simple,  epoch  48, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch  48, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0955, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  48, local model 29, internal_epoch   1,  Average loss: 0.0007, Accuracy: 989/1002 (98.7026%)
___Train Local_Simple,  epoch  48, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 989/1002 (98.7026%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1870, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   1,  Average loss: 0.0009, Accuracy: 461/470 (98.0851%)
___Train Local_Simple,  epoch  48, local model 87, internal_epoch   2,  Average loss: 0.0005, Accuracy: 467/470 (99.3617%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1245, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch  48, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 296/303 (97.6898%)
___Train Local_Simple,  epoch  48, local model 78, internal_epoch   2,  Average loss: 0.0007, Accuracy: 300/303 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1180, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch  48, local model 53, internal_epoch   1,  Average loss: 0.0010, Accuracy: 722/739 (97.6996%)
___Train Local_Simple,  epoch  48, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.3384, Accuracy: 8902/10000 (89.0200%)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   1,  Average loss: 0.0005, Accuracy: 430/433 (99.3072%)
___Train Local_Simple,  epoch  48, local model 83, internal_epoch   2,  Average loss: 0.0003, Accuracy: 431/433 (99.5381%)
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0573, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   1,  Average loss: 0.0012, Accuracy: 200/205 (97.5610%)
___Train Local_Simple,  epoch  48, local model 19, internal_epoch   2,  Average loss: 0.0010, Accuracy: 203/205 (99.0244%)
class_loss: 3.4073779582977295, distance_loss: 0.0
class_loss: 2.521444797515869, distance_loss: 0.2981501519680023
class_loss: 1.1863665580749512, distance_loss: 0.785172164440155
class_loss: 1.835495948791504, distance_loss: 1.2582004070281982
class_loss: 1.362604022026062, distance_loss: 1.6388798952102661
class_loss: 1.3895341157913208, distance_loss: 1.951144814491272
class_loss: 1.3351554870605469, distance_loss: 2.2317283153533936
class_loss: 1.253038763999939, distance_loss: 2.484520196914673
class_loss: 1.293837547302246, distance_loss: 2.7122249603271484
class_loss: 1.1037888526916504, distance_loss: 2.9228506088256836
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.1462, Accuracy: 9525/10000 (95.2500%)
poison local model 45 index 0
___PoisonTrain Local_Simple ,  epoch  48, local model 45, internal_epoch   1,  Average loss: 0.0266, Accuracy: 337/628 (53.6624%), train_poison_data_count: 200
class_loss: 1.0650837421417236, distance_loss: 3.1218719482421875
class_loss: 0.8889420032501221, distance_loss: 3.3078227043151855
class_loss: 0.9100645184516907, distance_loss: 3.4806504249572754
class_loss: 0.894611120223999, distance_loss: 3.635892391204834
class_loss: 0.7728795409202576, distance_loss: 3.7756261825561523
class_loss: 0.9272617697715759, distance_loss: 3.901555299758911
class_loss: 0.7440170645713806, distance_loss: 4.01710319519043
class_loss: 0.7798942923545837, distance_loss: 4.127377510070801
class_loss: 0.7666562795639038, distance_loss: 4.229666709899902
class_loss: 0.7547534108161926, distance_loss: 4.323345184326172
___PoisonTrain Local_Simple ,  epoch  48, local model 45, internal_epoch   2,  Average loss: 0.0135, Accuracy: 370/628 (58.9172%), train_poison_data_count: 200
Global model norm: 15.559097347015548.
Norm before scaling: 15.621547470123698. Distance: 4.412557429731506
Total norm for 3 adversaries is: 15.621547470123698. distance: 4.412557429731506
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 0.9448, Accuracy: 5215/8968 (58.1512%)
class_loss: 4.238264560699463, distance_loss: 0.0
class_loss: 2.288029193878174, distance_loss: 0.36190542578697205
class_loss: 1.6831470727920532, distance_loss: 0.9104738831520081
class_loss: 2.1713016033172607, distance_loss: 1.3365877866744995
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  48, local model 52, internal_epoch   1,  Average loss: 0.0410, Accuracy: 133/253 (52.5692%), train_poison_data_count: 80
class_loss: 1.4311635494232178, distance_loss: 1.7042670249938965
class_loss: 1.2018531560897827, distance_loss: 2.0565500259399414
class_loss: 1.2403130531311035, distance_loss: 2.3848211765289307
class_loss: 1.1576309204101562, distance_loss: 2.6865735054016113
___PoisonTrain Local_Simple ,  epoch  48, local model 52, internal_epoch   2,  Average loss: 0.0199, Accuracy: 126/253 (49.8024%), train_poison_data_count: 80
Global model norm: 15.559097347015548.
Norm before scaling: 15.366808189904386. Distance: 2.9670681656739637
Total norm for 3 adversaries is: 15.366808189904386. distance: 2.9670681656739637
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.4802, Accuracy: 3095/8968 (34.5116%)
class_loss: 4.567982196807861, distance_loss: 0.0
class_loss: 2.9455950260162354, distance_loss: 0.38186773657798767
class_loss: 1.390895128250122, distance_loss: 0.8927387595176697
class_loss: 2.2584567070007324, distance_loss: 1.3756009340286255
class_loss: 1.5828666687011719, distance_loss: 1.7891466617584229
class_loss: 1.5493634939193726, distance_loss: 2.176414966583252
class_loss: 1.498373031616211, distance_loss: 2.523632287979126
class_loss: 1.4901272058486938, distance_loss: 2.8308749198913574
class_loss: 1.4473353624343872, distance_loss: 3.1048641204833984
class_loss: 1.2450350522994995, distance_loss: 3.3538458347320557
poison local model 17 index 2
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   1,  Average loss: 0.0322, Accuracy: 303/620 (48.8710%), train_poison_data_count: 200
class_loss: 1.158570647239685, distance_loss: 3.5868396759033203
class_loss: 1.1120376586914062, distance_loss: 3.800715208053589
class_loss: 1.2563732862472534, distance_loss: 3.9944403171539307
class_loss: 1.129366397857666, distance_loss: 4.166021823883057
class_loss: 1.0124448537826538, distance_loss: 4.31827974319458
class_loss: 0.9766548871994019, distance_loss: 4.455633640289307
class_loss: 1.2060027122497559, distance_loss: 4.581419944763184
class_loss: 0.9569602012634277, distance_loss: 4.696431636810303
class_loss: 0.937958836555481, distance_loss: 4.801531791687012
class_loss: 1.0226643085479736, distance_loss: 4.897875785827637
___PoisonTrain Local_Simple ,  epoch  48, local model 17, internal_epoch   2,  Average loss: 0.0174, Accuracy: 321/620 (51.7742%), train_poison_data_count: 200
Global model norm: 15.559097347015548.
Norm before scaling: 15.706549883042921. Distance: 4.988434385191054
Total norm for 3 adversaries is: 15.706549883042921. distance: 4.988434385191054
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 1.0040, Accuracy: 4837/8968 (53.9362%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 52, 17]
base_p: [-0.00692426  0.00020935 -0.00118023 ... -0.00212734 -0.00205341
 -0.00153714]
[T_SCORE] attacker_local_idxs is:  [1, 4, 7, 8, 9]
layer1_inf_time: 3.31884765625
[PAIRWISE] pred_attackers_indx:  [7 8 9]
layer2_inf_t: 45.55859375
assumed final_attacker_idxs:  [1 4 7 8 9]
final_attacker_idxs is: [1, 4, 7, 8, 9]
g_attacker_idxs: [29 53 45 52 17]
g_normal_idxs: [39 87 78 83 19]
filtered_attacker_idxs: [1, 4, 7, 8, 9]
final_attacker_idxs are: [1, 4, 7, 8, 9]
num_dps: [257, 1002, 470, 303, 739, 433, 205, 628, 253, 620]
time spent on training: 45.36514329910278
Starting performing KrMLRFL...
Num data points: [257, 1002, 470, 303, 739, 433, 205, 628, 253, 620]
Num selected data points: [257 470 303 433 205]
The chosen ones are users: [0, 2, 3, 5, 6], which are global users: [39, 87, 78, 83, 19]
epoch_acc: 98.49
___Test Local_Simple poisoned: False, epoch: 48: Average loss: 0.0452, Accuracy: 9849/10000 (98.4900%)
___Test Local_Simple poisoned: True, epoch: 48: Average loss: 13.4174, Accuracy: 32/8968 (0.3568%)
Done in 129.47486877441406 sec.
Server Epoch:49 choose agents : [3, 34, 32, 5, 73, 14, 40, 88, 72, 13].
___Train Local_Simple,  epoch  49, local model 3, internal_epoch   1,  Average loss: 0.0012, Accuracy: 905/923 (98.0498%)
___Train Local_Simple,  epoch  49, local model 3, internal_epoch   2,  Average loss: 0.0006, Accuracy: 913/923 (98.9166%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1516, Accuracy: 9508/10000 (95.0800%)
poison local model 34 index 0
class_loss: 5.533046245574951, distance_loss: 0.0
class_loss: 2.5710909366607666, distance_loss: 0.44424447417259216
class_loss: 1.399543046951294, distance_loss: 1.0394889116287231
class_loss: 1.3747341632843018, distance_loss: 1.6086175441741943
class_loss: 1.6176774501800537, distance_loss: 2.080799102783203
class_loss: 1.4993976354599, distance_loss: 2.480102062225342
class_loss: 0.9961772561073303, distance_loss: 2.839980125427246
___PoisonTrain Local_Simple ,  epoch  49, local model 34, internal_epoch   1,  Average loss: 0.0363, Accuracy: 231/413 (55.9322%), train_poison_data_count: 140
class_loss: 1.4365978240966797, distance_loss: 3.167876720428467
class_loss: 1.3469586372375488, distance_loss: 3.461642265319824
class_loss: 1.2149910926818848, distance_loss: 3.7260470390319824
class_loss: 1.1049879789352417, distance_loss: 3.965306043624878
class_loss: 1.17732572555542, distance_loss: 4.185251712799072
class_loss: 0.9145615696907043, distance_loss: 4.388976573944092
class_loss: 1.285737156867981, distance_loss: 4.5733113288879395
___PoisonTrain Local_Simple ,  epoch  49, local model 34, internal_epoch   2,  Average loss: 0.0205, Accuracy: 195/413 (47.2155%), train_poison_data_count: 140
Global model norm: 15.544542361909885.
Norm before scaling: 15.5513562362301. Distance: 4.732608075164817
Total norm for 3 adversaries is: 15.5513562362301. distance: 4.732608075164817
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7870, Accuracy: 6517/8968 (72.6695%)
___Train Local_Simple,  epoch  49, local model 32, internal_epoch   1,  Average loss: 0.0019, Accuracy: 950/977 (97.2364%)
___Train Local_Simple,  epoch  49, local model 32, internal_epoch   2,  Average loss: 0.0017, Accuracy: 945/977 (96.7247%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1664, Accuracy: 9472/10000 (94.7200%)
___Train Local_Simple,  epoch  49, local model 5, internal_epoch   1,  Average loss: 0.0014, Accuracy: 424/434 (97.6959%)
___Train Local_Simple,  epoch  49, local model 5, internal_epoch   2,  Average loss: 0.0005, Accuracy: 430/434 (99.0783%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.4552, Accuracy: 8931/10000 (89.3100%)
poison local model 73 index 1
class_loss: 4.222314834594727, distance_loss: 0.0
class_loss: 1.343749761581421, distance_loss: 0.40587925910949707
class_loss: 3.0048019886016846, distance_loss: 0.8785426616668701
class_loss: 1.6190180778503418, distance_loss: 1.2177544832229614
class_loss: 1.5021761655807495, distance_loss: 1.6146962642669678
class_loss: 1.487424612045288, distance_loss: 2.0008790493011475
class_loss: 1.1544314622879028, distance_loss: 2.3657724857330322
class_loss: 1.2689517736434937, distance_loss: 2.708115577697754
class_loss: 1.1889300346374512, distance_loss: 3.023193597793579
class_loss: 2.0471808910369873, distance_loss: 3.3154006004333496
class_loss: 1.2493869066238403, distance_loss: 3.614076614379883
class_loss: 1.4733893871307373, distance_loss: 3.895895481109619
class_loss: 1.613976240158081, distance_loss: 4.1494364738464355
class_loss: 1.6009916067123413, distance_loss: 4.375709533691406
class_loss: 1.4557026624679565, distance_loss: 4.5770368576049805
class_loss: 1.3938956260681152, distance_loss: 4.758275032043457
class_loss: 1.2732737064361572, distance_loss: 4.922027587890625
class_loss: 1.2328193187713623, distance_loss: 5.071786403656006
class_loss: 1.0262391567230225, distance_loss: 5.2080230712890625
class_loss: 1.325377106666565, distance_loss: 5.335006237030029
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   1,  Average loss: 0.0319, Accuracy: 333/591 (56.3452%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  49, local model 73, internal_epoch   2,  Average loss: 0.0231, Accuracy: 201/591 (34.0102%), train_poison_data_count: 195
Global model norm: 15.544542361909885.
Norm before scaling: 15.802242284120778. Distance: 5.449959697049409
Total norm for 3 adversaries is: 15.802242284120778. distance: 5.449959697049409
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7985, Accuracy: 7751/8968 (86.4295%)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   1,  Average loss: 0.0006, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch  49, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1318, Accuracy: 9625/10000 (96.2500%)
___Train Local_Simple,  epoch  49, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 767/772 (99.3523%)
___Train Local_Simple,  epoch  49, local model 40, internal_epoch   2,  Average loss: 0.0002, Accuracy: 771/772 (99.8705%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0770, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch  49, local model 88, internal_epoch   1,  Average loss: 0.0006, Accuracy: 523/530 (98.6792%)
___Train Local_Simple,  epoch  49, local model 88, internal_epoch   2,  Average loss: 0.0003, Accuracy: 526/530 (99.2453%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1128, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   1,  Average loss: 0.0007, Accuracy: 721/731 (98.6320%)
___Train Local_Simple,  epoch  49, local model 72, internal_epoch   2,  Average loss: 0.0008, Accuracy: 719/731 (98.3584%)
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.1357, Accuracy: 9517/10000 (95.1700%)
poison local model 13 index 2
class_loss: 4.684161186218262, distance_loss: 0.0
class_loss: 2.556097984313965, distance_loss: 0.3569813370704651
class_loss: 2.517974376678467, distance_loss: 0.9337301254272461
class_loss: 1.7965366840362549, distance_loss: 1.4254295825958252
class_loss: 1.5521831512451172, distance_loss: 1.8948601484298706
class_loss: 1.511667251586914, distance_loss: 2.334712505340576
class_loss: 1.646586537361145, distance_loss: 2.725013017654419
class_loss: 1.6300623416900635, distance_loss: 3.06718373298645
class_loss: 1.442219614982605, distance_loss: 3.3729248046875
class_loss: 1.2159056663513184, distance_loss: 3.6503543853759766
class_loss: 1.3608450889587402, distance_loss: 3.9053328037261963
class_loss: 1.9011532068252563, distance_loss: 4.1346940994262695
class_loss: 1.1907778978347778, distance_loss: 4.339400768280029
class_loss: 1.2411659955978394, distance_loss: 4.53316593170166
class_loss: 1.2618423700332642, distance_loss: 4.711175441741943
class_loss: 1.2349039316177368, distance_loss: 4.871134281158447
class_loss: 1.414932370185852, distance_loss: 5.014950275421143
class_loss: 1.1688648462295532, distance_loss: 5.14450740814209
class_loss: 1.0744352340698242, distance_loss: 5.263036251068115
class_loss: 0.9378404021263123, distance_loss: 5.372958183288574
class_loss: 1.0130283832550049, distance_loss: 5.475225448608398
class_loss: 1.069591999053955, distance_loss: 5.56735897064209
class_loss: 1.077689290046692, distance_loss: 5.648552417755127
class_loss: 1.2477675676345825, distance_loss: 5.719861030578613
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   1,  Average loss: 0.0324, Accuracy: 346/734 (47.1390%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  49, local model 13, internal_epoch   2,  Average loss: 0.0190, Accuracy: 326/734 (44.4142%), train_poison_data_count: 240
Global model norm: 15.544542361909885.
Norm before scaling: 15.784673882137373. Distance: 5.786315348518434
Total norm for 3 adversaries is: 15.784673882137373. distance: 5.786315348518434
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 0.7648, Accuracy: 6920/8968 (77.1632%)
time spent on training: 49.13155150413513
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 73, 13]
base_p: [-0.00057931  0.00042627  0.00022905 ...  0.00066573 -0.01054904
  0.0021561 ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 9]
layer1_inf_time: 2.773193359375
[PAIRWISE] pred_attackers_indx:  [1 4 9]
layer2_inf_t: 24.57373046875
assumed final_attacker_idxs:  [0 1 2 4 9]
final_attacker_idxs is: [0, 1, 2, 4, 9]
g_attacker_idxs: [ 3 34 32 73 13]
g_normal_idxs: [ 5 14 40 88 72]
filtered_attacker_idxs: [0, 1, 2, 4, 9]
final_attacker_idxs are: [0, 1, 2, 4, 9]
num_dps: [923, 413, 977, 434, 591, 376, 772, 530, 731, 734]
epoch_acc: 98.56
Starting performing KrMLRFL...
Num data points: [923, 413, 977, 434, 591, 376, 772, 530, 731, 734]
Num selected data points: [434 376 772 530 731]
The chosen ones are users: [3, 5, 6, 7, 8], which are global users: [5, 14, 40, 88, 72]
___Test Local_Simple poisoned: False, epoch: 49: Average loss: 0.0435, Accuracy: 9856/10000 (98.5600%)
___Test Local_Simple poisoned: True, epoch: 49: Average loss: 12.7885, Accuracy: 37/8968 (0.4126%)
Done in 136.07717299461365 sec.
Server Epoch:50 choose agents : [12, 23, 87, 98, 51, 83, 52, 90, 71, 11].
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   1,  Average loss: 0.0015, Accuracy: 1135/1160 (97.8448%)
___Train Local_Simple,  epoch  50, local model 12, internal_epoch   2,  Average loss: 0.0016, Accuracy: 1120/1160 (96.5517%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2592, Accuracy: 9268/10000 (92.6800%)
___Train Local_Simple,  epoch  50, local model 23, internal_epoch   1,  Average loss: 0.0005, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  50, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1251, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch  50, local model 87, internal_epoch   1,  Average loss: 0.0003, Accuracy: 467/470 (99.3617%)
___Train Local_Simple,  epoch  50, local model 87, internal_epoch   2,  Average loss: 0.0005, Accuracy: 466/470 (99.1489%)
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.1176, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  50, local model 98, internal_epoch   1,  Average loss: 0.0010, Accuracy: 798/818 (97.5550%)
___Train Local_Simple,  epoch  50, local model 98, internal_epoch   2,  Average loss: 0.0008, Accuracy: 802/818 (98.0440%)
class_loss: 3.213914155960083, distance_loss: 0.0
class_loss: 1.9696320295333862, distance_loss: 0.2860613763332367
class_loss: 1.5328149795532227, distance_loss: 0.7394770979881287
class_loss: 1.8430330753326416, distance_loss: 1.1346852779388428
class_loss: 1.2868760824203491, distance_loss: 1.4519344568252563
class_loss: 0.8419029712677002, distance_loss: 1.7703595161437988
class_loss: 0.8518519401550293, distance_loss: 2.0831589698791504
class_loss: 0.8755559921264648, distance_loss: 2.382526159286499
class_loss: 0.7957578301429749, distance_loss: 2.661891460418701
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.2800, Accuracy: 9199/10000 (91.9900%)
poison local model 51 index 0
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   1,  Average loss: 0.0233, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
class_loss: 0.9059551358222961, distance_loss: 2.9180805683135986
class_loss: 0.9009454846382141, distance_loss: 3.1488170623779297
class_loss: 0.8182915449142456, distance_loss: 3.3584511280059814
class_loss: 0.8027478456497192, distance_loss: 3.5450589656829834
class_loss: 0.8974707722663879, distance_loss: 3.704110860824585
class_loss: 0.7851198315620422, distance_loss: 3.838498115539551
class_loss: 0.744317889213562, distance_loss: 3.9577596187591553
class_loss: 0.8247109651565552, distance_loss: 4.0663275718688965
class_loss: 0.7043245434761047, distance_loss: 4.167156219482422
___PoisonTrain Local_Simple ,  epoch  50, local model 51, internal_epoch   2,  Average loss: 0.0130, Accuracy: 343/568 (60.3873%), train_poison_data_count: 180
Global model norm: 15.489898343229815.
Norm before scaling: 15.54609127657149. Distance: 4.259393297073572
Total norm for 4 adversaries is: 15.54609127657149. distance: 4.259393297073572
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 1.0025, Accuracy: 4923/8968 (54.8952%)
___Train Local_Simple,  epoch  50, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 429/433 (99.0762%)
___Train Local_Simple,  epoch  50, local model 83, internal_epoch   2,  Average loss: 0.0003, Accuracy: 430/433 (99.3072%)
class_loss: 4.0346784591674805, distance_loss: 0.0
class_loss: 2.284945011138916, distance_loss: 0.383108526468277
class_loss: 1.8247593641281128, distance_loss: 0.9106471538543701
class_loss: 1.686570167541504, distance_loss: 1.2338497638702393
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0551, Accuracy: 9819/10000 (98.1900%)
poison local model 52 index 1
___PoisonTrain Local_Simple ,  epoch  50, local model 52, internal_epoch   1,  Average loss: 0.0389, Accuracy: 135/253 (53.3597%), train_poison_data_count: 80
class_loss: 1.0331552028656006, distance_loss: 1.5446306467056274
class_loss: 1.1627020835876465, distance_loss: 1.8731549978256226
class_loss: 1.1925243139266968, distance_loss: 2.1930792331695557
class_loss: 1.1925469636917114, distance_loss: 2.492276668548584
___PoisonTrain Local_Simple ,  epoch  50, local model 52, internal_epoch   2,  Average loss: 0.0181, Accuracy: 139/253 (54.9407%), train_poison_data_count: 80
Global model norm: 15.489898343229815.
Norm before scaling: 15.296589709418281. Distance: 2.774003693719122
Total norm for 4 adversaries is: 15.296589709418281. distance: 2.774003693719122
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 1.6983, Accuracy: 2124/8968 (23.6842%)
___Train Local_Simple,  epoch  50, local model 90, internal_epoch   1,  Average loss: 0.0006, Accuracy: 675/683 (98.8287%)
___Train Local_Simple,  epoch  50, local model 90, internal_epoch   2,  Average loss: 0.0005, Accuracy: 675/683 (98.8287%)
class_loss: 3.2425711154937744, distance_loss: 0.0
class_loss: 1.9444087743759155, distance_loss: 0.32081177830696106
class_loss: 1.611700177192688, distance_loss: 0.7999633550643921
class_loss: 1.6300264596939087, distance_loss: 1.1779274940490723
class_loss: 1.2495452165603638, distance_loss: 1.4862011671066284
class_loss: 1.3096742630004883, distance_loss: 1.7747336626052856
class_loss: 1.1787701845169067, distance_loss: 2.0463578701019287
class_loss: 1.0912433862686157, distance_loss: 2.2897984981536865
class_loss: 1.0004773139953613, distance_loss: 2.5140533447265625
class_loss: 0.8945806622505188, distance_loss: 2.7273805141448975
class_loss: 1.0427112579345703, distance_loss: 2.929896831512451
class_loss: 0.8806589841842651, distance_loss: 3.1244027614593506
class_loss: 0.9492219090461731, distance_loss: 3.308107852935791
class_loss: 0.910729169845581, distance_loss: 3.4788005352020264
class_loss: 0.6520863771438599, distance_loss: 3.6352298259735107
class_loss: 0.9675483107566833, distance_loss: 3.7769417762756348
class_loss: 0.875940203666687, distance_loss: 3.901395320892334
class_loss: 0.9298927783966064, distance_loss: 4.013357162475586
class_loss: 0.9966472387313843, distance_loss: 4.112280368804932
class_loss: 0.6452773213386536, distance_loss: 4.1998162269592285
class_loss: 0.696780800819397, distance_loss: 4.281027793884277
class_loss: 0.8473064303398132, distance_loss: 4.355381011962891
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.6273, Accuracy: 8125/10000 (81.2500%)
poison local model 71 index 2
___PoisonTrain Local_Simple ,  epoch  50, local model 71, internal_epoch   1,  Average loss: 0.0185, Accuracy: 812/1384 (58.6705%), train_poison_data_count: 440
class_loss: 0.7477812767028809, distance_loss: 4.427418231964111
class_loss: 0.7750743627548218, distance_loss: 4.491330623626709
class_loss: 0.7454877495765686, distance_loss: 4.546821117401123
class_loss: 0.7318379282951355, distance_loss: 4.595959186553955
class_loss: 0.7213515639305115, distance_loss: 4.640666484832764
class_loss: 0.7468819618225098, distance_loss: 4.68301248550415
class_loss: 0.6068362593650818, distance_loss: 4.723875999450684
class_loss: 0.641593873500824, distance_loss: 4.764411449432373
class_loss: 0.611591100692749, distance_loss: 4.79987907409668
class_loss: 0.7707940936088562, distance_loss: 4.838357925415039
class_loss: 0.4399682283401489, distance_loss: 4.878930568695068
class_loss: 0.5523096919059753, distance_loss: 4.922570705413818
class_loss: 0.3896258473396301, distance_loss: 4.967838764190674
class_loss: 0.39626288414001465, distance_loss: 5.01405143737793
class_loss: 0.33872541785240173, distance_loss: 5.056323528289795
class_loss: 0.373820036649704, distance_loss: 5.099842548370361
class_loss: 0.29835811257362366, distance_loss: 5.146381378173828
class_loss: 0.23893649876117706, distance_loss: 5.192844390869141
class_loss: 0.1889941692352295, distance_loss: 5.243032932281494
class_loss: 0.21972084045410156, distance_loss: 5.298798561096191
class_loss: 0.07054194062948227, distance_loss: 5.35431432723999
class_loss: 0.19551250338554382, distance_loss: 5.409072399139404
___PoisonTrain Local_Simple ,  epoch  50, local model 71, internal_epoch   2,  Average loss: 0.0078, Accuracy: 1102/1384 (79.6243%), train_poison_data_count: 440
Global model norm: 15.489898343229815.
Norm before scaling: 16.07107303286667. Distance: 5.4602932311186185
Total norm for 4 adversaries is: 16.07107303286667. distance: 5.4602932311186185
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0401, Accuracy: 8841/8968 (98.5839%)
poison local model 11 index 3
class_loss: 4.3080363273620605, distance_loss: 0.0
class_loss: 2.9026310443878174, distance_loss: 0.3561098873615265
class_loss: 1.2345789670944214, distance_loss: 0.8872417211532593
class_loss: 1.4593472480773926, distance_loss: 1.434245228767395
class_loss: 1.5880005359649658, distance_loss: 1.8606077432632446
class_loss: 1.244965672492981, distance_loss: 2.2286150455474854
class_loss: 1.4262536764144897, distance_loss: 2.5640103816986084
class_loss: 1.4938923120498657, distance_loss: 2.868911027908325
class_loss: 1.2536665201187134, distance_loss: 3.144348382949829
class_loss: 1.2160348892211914, distance_loss: 3.3891303539276123
class_loss: 0.9317504167556763, distance_loss: 3.611987352371216
class_loss: 1.0614243745803833, distance_loss: 3.8409132957458496
class_loss: 1.2713836431503296, distance_loss: 4.047701358795166
class_loss: 1.0609416961669922, distance_loss: 4.2230706214904785
class_loss: 0.7893133759498596, distance_loss: 4.3814592361450195
class_loss: 0.7400990724563599, distance_loss: 4.537405967712402
class_loss: 0.6130532026290894, distance_loss: 4.686697959899902
class_loss: 0.7593904733657837, distance_loss: 4.8320183753967285
class_loss: 0.7617273330688477, distance_loss: 4.970419406890869
class_loss: 0.5833432674407959, distance_loss: 5.103541374206543
class_loss: 0.3912913203239441, distance_loss: 5.232943534851074
class_loss: 0.32242292165756226, distance_loss: 5.35363245010376
___PoisonTrain Local_Simple ,  epoch  50, local model 11, internal_epoch   1,  Average loss: 0.0295, Accuracy: 362/645 (56.1240%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  50, local model 11, internal_epoch   2,  Average loss: 0.0130, Accuracy: 414/645 (64.1860%), train_poison_data_count: 205
Global model norm: 15.489898343229815.
Norm before scaling: 15.942467248292864. Distance: 5.488117212851069
Total norm for 4 adversaries is: 15.942467248292864. distance: 5.488117212851069
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 0.0057, Accuracy: 8962/8968 (99.9331%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 52, 71, 11]
base_p: [-0.00558078  0.00036369 -0.000296   ... -0.00430181 -0.01215482
 -0.00317551]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 8, 9]
layer1_inf_time: 3.360107421875
[PAIRWISE] pred_attackers_indx:  [4 6 8 9]
layer2_inf_t: 295.37451171875
assumed final_attacker_idxs:  [0 4 6 8 9]
final_attacker_idxs is: [0 4 6 8 9]
g_attacker_idxs: [12 51 52 71 11]
g_normal_idxs: [23 87 98 83 90]
filtered_attacker_idxs: [0, 4, 6, 8, 9]
final_attacker_idxs are: [0, 4, 6, 8, 9]
num_dps: [1160, 293, 470, 818, 568, 433, 253, 683, 1384, 645]
time spent on training: 51.70194482803345
Starting performing KrMLRFL...
Num data points: [1160, 293, 470, 818, 568, 433, 253, 683, 1384, 645]
Num selected data points: [293 470 818 433 683]
The chosen ones are users: [1, 2, 3, 5, 7], which are global users: [23, 87, 98, 83, 90]
epoch_acc: 98.25
___Test Local_Simple poisoned: False, epoch: 50: Average loss: 0.0550, Accuracy: 9825/10000 (98.2500%)
___Test Local_Simple poisoned: True, epoch: 50: Average loss: 13.4281, Accuracy: 5/8968 (0.0558%)
Done in 143.03095769882202 sec.
Server Epoch:51 choose agents : [51, 28, 20, 95, 83, 18, 55, 42, 29, 46].
poison local model 51 index 0
class_loss: 4.396421432495117, distance_loss: 0.0
class_loss: 2.9116110801696777, distance_loss: 0.3548438549041748
class_loss: 1.0712968111038208, distance_loss: 0.923610508441925
class_loss: 1.7347737550735474, distance_loss: 1.4085947275161743
class_loss: 1.437142014503479, distance_loss: 1.8309682607650757
class_loss: 1.0918132066726685, distance_loss: 2.2215216159820557
class_loss: 1.048519492149353, distance_loss: 2.5794677734375
class_loss: 0.8791436553001404, distance_loss: 2.910956859588623
class_loss: 0.8224591612815857, distance_loss: 3.2194950580596924
class_loss: 1.1576422452926636, distance_loss: 3.5012025833129883
class_loss: 0.8378961086273193, distance_loss: 3.7435457706451416
class_loss: 0.7215037941932678, distance_loss: 3.961188793182373
class_loss: 0.9742602705955505, distance_loss: 4.159758567810059
class_loss: 0.76596999168396, distance_loss: 4.333130359649658
class_loss: 0.8612869381904602, distance_loss: 4.489279747009277
class_loss: 0.737652063369751, distance_loss: 4.630806922912598
class_loss: 0.7304458022117615, distance_loss: 4.761093616485596
class_loss: 0.8825063109397888, distance_loss: 4.877483367919922
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   1,  Average loss: 0.0271, Accuracy: 309/568 (54.4014%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  51, local model 51, internal_epoch   2,  Average loss: 0.0135, Accuracy: 347/568 (61.0915%), train_poison_data_count: 180
Global model norm: 15.477119539760842.
Norm before scaling: 15.597470376741233. Distance: 4.979755999857346
Total norm for 3 adversaries is: 15.597470376741233. distance: 4.979755999857346
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.9517, Accuracy: 5028/8968 (56.0660%)
___Train Local_Simple,  epoch  51, local model 28, internal_epoch   1,  Average loss: 0.0005, Accuracy: 495/501 (98.8024%)
___Train Local_Simple,  epoch  51, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0748, Accuracy: 9769/10000 (97.6900%)
poison local model 20 index 1
class_loss: 5.518316268920898, distance_loss: 0.0
class_loss: 3.1321263313293457, distance_loss: 0.46861785650253296
class_loss: 1.9354937076568604, distance_loss: 1.0602384805679321
class_loss: 1.6136747598648071, distance_loss: 1.60002863407135
class_loss: 1.4603136777877808, distance_loss: 2.104795217514038
class_loss: 1.5739010572433472, distance_loss: 2.5607709884643555
class_loss: 1.2771224975585938, distance_loss: 2.9691848754882812
class_loss: 1.5411931276321411, distance_loss: 3.333589792251587
class_loss: 1.4409750699996948, distance_loss: 3.6519951820373535
class_loss: 1.2560598850250244, distance_loss: 3.936192512512207
class_loss: 1.2123322486877441, distance_loss: 4.194085597991943
class_loss: 1.2315244674682617, distance_loss: 4.428353786468506
class_loss: 1.3010531663894653, distance_loss: 4.639026641845703
class_loss: 1.2213854789733887, distance_loss: 4.8281474113464355
___PoisonTrain Local_Simple ,  epoch  51, local model 20, internal_epoch   1,  Average loss: 0.0385, Accuracy: 214/429 (49.8834%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  51, local model 20, internal_epoch   2,  Average loss: 0.0215, Accuracy: 181/429 (42.1911%), train_poison_data_count: 140
Global model norm: 15.477119539760842.
Norm before scaling: 15.503054902299448. Distance: 5.002831229663859
Total norm for 3 adversaries is: 15.503054902299448. distance: 5.002831229663859
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 1.0523, Accuracy: 6225/8968 (69.4135%)
___Train Local_Simple,  epoch  51, local model 95, internal_epoch   1,  Average loss: 0.0004, Accuracy: 597/602 (99.1694%)
___Train Local_Simple,  epoch  51, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 1.0203, Accuracy: 7790/10000 (77.9000%)
___Train Local_Simple,  epoch  51, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 429/433 (99.0762%)
___Train Local_Simple,  epoch  51, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0440, Accuracy: 9861/10000 (98.6100%)
___Train Local_Simple,  epoch  51, local model 18, internal_epoch   1,  Average loss: 0.0016, Accuracy: 448/459 (97.6035%)
___Train Local_Simple,  epoch  51, local model 18, internal_epoch   2,  Average loss: 0.0004, Accuracy: 457/459 (99.5643%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1498, Accuracy: 9546/10000 (95.4600%)
___Train Local_Simple,  epoch  51, local model 55, internal_epoch   1,  Average loss: 0.0011, Accuracy: 346/354 (97.7401%)
___Train Local_Simple,  epoch  51, local model 55, internal_epoch   2,  Average loss: 0.0002, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.4416, Accuracy: 8691/10000 (86.9100%)
poison local model 42 index 2
class_loss: 2.613853931427002, distance_loss: 0.0
class_loss: 2.7302894592285156, distance_loss: 0.2200431078672409
class_loss: 1.3053498268127441, distance_loss: 0.6304132342338562
class_loss: 1.3964208364486694, distance_loss: 1.0939449071884155
class_loss: 1.550743579864502, distance_loss: 1.5673550367355347
class_loss: 1.207160234451294, distance_loss: 1.9422441720962524
class_loss: 1.058239221572876, distance_loss: 2.277282953262329
class_loss: 1.0633373260498047, distance_loss: 2.5810608863830566
___PoisonTrain Local_Simple ,  epoch  51, local model 42, internal_epoch   1,  Average loss: 0.0341, Accuracy: 163/236 (69.0678%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  51, local model 42, internal_epoch   2,  Average loss: 0.0207, Accuracy: 122/236 (51.6949%), train_poison_data_count: 80
Global model norm: 15.477119539760842.
Norm before scaling: 15.252060047526674. Distance: 2.853904953441226
Total norm for 3 adversaries is: 15.252060047526674. distance: 2.853904953441226
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 0.9879, Accuracy: 7881/8968 (87.8791%)
___Train Local_Simple,  epoch  51, local model 29, internal_epoch   1,  Average loss: 0.0007, Accuracy: 988/1002 (98.6028%)
___Train Local_Simple,  epoch  51, local model 29, internal_epoch   2,  Average loss: 0.0005, Accuracy: 993/1002 (99.1018%)
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.1903, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  51, local model 46, internal_epoch   1,  Average loss: 0.0014, Accuracy: 696/710 (98.0282%)
___Train Local_Simple,  epoch  51, local model 46, internal_epoch   2,  Average loss: 0.0040, Accuracy: 653/710 (91.9718%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 20, 42]
base_p: [-0.00266534  0.00028757  0.00036613 ... -0.0030258  -0.01884636
  0.00059247]
[T_SCORE] attacker_local_idxs is:  [0, 2, 7, 8, 9]
layer1_inf_time: 3.270263671875
[PAIRWISE] pred_attackers_indx:  [0 2 7]
layer2_inf_t: 27.147705078125
assumed final_attacker_idxs:  [0 2 7 8 9]
final_attacker_idxs is: [0 2 7 8 9]
g_attacker_idxs: [51 20 42 29 46]
g_normal_idxs: [28 95 83 18 55]
filtered_attacker_idxs: [0, 2, 7, 8, 9]
final_attacker_idxs are: [0, 2, 7, 8, 9]
num_dps: [568, 501, 429, 602, 433, 459, 354, 236, 1002, 710]
epoch_acc: 98.5
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.8954, Accuracy: 7413/10000 (74.1300%)
time spent on training: 44.78759765625
Starting performing KrMLRFL...
Num data points: [568, 501, 429, 602, 433, 459, 354, 236, 1002, 710]
Num selected data points: [501 602 433 459 354]
The chosen ones are users: [1, 3, 4, 5, 6], which are global users: [28, 95, 83, 18, 55]
___Test Local_Simple poisoned: False, epoch: 51: Average loss: 0.0490, Accuracy: 9850/10000 (98.5000%)
___Test Local_Simple poisoned: True, epoch: 51: Average loss: 13.7892, Accuracy: 19/8968 (0.2119%)
Done in 128.8023316860199 sec.
Server Epoch:52 choose agents : [87, 73, 89, 48, 81, 10, 92, 62, 26, 29].
___Train Local_Simple,  epoch  52, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 469/470 (99.7872%)
___Train Local_Simple,  epoch  52, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 470/470 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0591, Accuracy: 9818/10000 (98.1800%)
poison local model 73 index 0
class_loss: 3.8430051803588867, distance_loss: 0.0
class_loss: 1.4228723049163818, distance_loss: 0.43123164772987366
class_loss: 3.395094156265259, distance_loss: 0.9362209439277649
class_loss: 1.7231738567352295, distance_loss: 1.2800347805023193
class_loss: 1.5187585353851318, distance_loss: 1.7018650770187378
class_loss: 1.531012773513794, distance_loss: 2.1131949424743652
class_loss: 1.3624886274337769, distance_loss: 2.4970314502716064
class_loss: 1.4462151527404785, distance_loss: 2.8614490032196045
class_loss: 1.2756394147872925, distance_loss: 3.201967716217041
class_loss: 1.6951502561569214, distance_loss: 3.514747142791748
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   1,  Average loss: 0.0325, Accuracy: 329/591 (55.6684%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  52, local model 73, internal_epoch   2,  Average loss: 0.0205, Accuracy: 259/591 (43.8240%), train_poison_data_count: 195
Global model norm: 15.460667080126266.
Norm before scaling: 15.794628553330886. Distance: 5.6030979579224045
Total norm for 3 adversaries is: 15.794628553330886. distance: 5.6030979579224045
class_loss: 1.0713549852371216, distance_loss: 3.822145938873291
class_loss: 1.4313524961471558, distance_loss: 4.102177619934082
class_loss: 1.4003303050994873, distance_loss: 4.345824241638184
class_loss: 1.3908412456512451, distance_loss: 4.557305335998535
class_loss: 1.143547773361206, distance_loss: 4.743542671203613
class_loss: 1.216697335243225, distance_loss: 4.915404796600342
class_loss: 1.0249732732772827, distance_loss: 5.074145793914795
class_loss: 0.9390106797218323, distance_loss: 5.22144079208374
class_loss: 0.985198974609375, distance_loss: 5.354779243469238
class_loss: 1.541574239730835, distance_loss: 5.4749436378479
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.6949, Accuracy: 8329/8968 (92.8747%)
___Train Local_Simple,  epoch  52, local model 89, internal_epoch   1,  Average loss: 0.0004, Accuracy: 487/492 (98.9837%)
___Train Local_Simple,  epoch  52, local model 89, internal_epoch   2,  Average loss: 0.0002, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1110, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch  52, local model 48, internal_epoch   1,  Average loss: 0.0006, Accuracy: 441/448 (98.4375%)
___Train Local_Simple,  epoch  52, local model 48, internal_epoch   2,  Average loss: 0.0005, Accuracy: 445/448 (99.3304%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0764, Accuracy: 9749/10000 (97.4900%)
poison local model 81 index 1
class_loss: 5.01299524307251, distance_loss: 0.0
class_loss: 3.2159769535064697, distance_loss: 0.41406914591789246
class_loss: 1.7347266674041748, distance_loss: 0.9875590205192566
class_loss: 1.4418696165084839, distance_loss: 1.522473692893982
class_loss: 1.5710170269012451, distance_loss: 2.011389970779419
class_loss: 1.5959177017211914, distance_loss: 2.441112756729126
class_loss: 1.616869568824768, distance_loss: 2.8100900650024414
class_loss: 1.5799578428268433, distance_loss: 3.1373167037963867
class_loss: 1.3183951377868652, distance_loss: 3.429612398147583
class_loss: 1.390087366104126, distance_loss: 3.693063259124756
class_loss: 1.1994032859802246, distance_loss: 3.931820869445801
class_loss: 1.070395588874817, distance_loss: 4.149353504180908
class_loss: 1.2342449426651, distance_loss: 4.348970890045166
class_loss: 1.0552271604537964, distance_loss: 4.523614883422852
class_loss: 1.1810826063156128, distance_loss: 4.680368423461914
class_loss: 1.2010278701782227, distance_loss: 4.822209358215332
class_loss: 1.132515788078308, distance_loss: 4.952754974365234
class_loss: 0.9385310411453247, distance_loss: 5.069034099578857
class_loss: 1.011080026626587, distance_loss: 5.176715850830078
class_loss: 1.528212308883667, distance_loss: 5.276744842529297
___PoisonTrain Local_Simple ,  epoch  52, local model 81, internal_epoch   1,  Average loss: 0.0261, Accuracy: 575/1227 (46.8623%), train_poison_data_count: 391
class_loss: 1.0428357124328613, distance_loss: 5.378669738769531
class_loss: 1.0311458110809326, distance_loss: 5.473381519317627
class_loss: 1.131280779838562, distance_loss: 5.5559539794921875
class_loss: 0.9497964978218079, distance_loss: 5.626814365386963
class_loss: 0.8855773210525513, distance_loss: 5.688559532165527
class_loss: 0.8161839842796326, distance_loss: 5.743321418762207
class_loss: 0.8059199452400208, distance_loss: 5.795342922210693
class_loss: 0.7329533100128174, distance_loss: 5.8455328941345215
class_loss: 0.8896217942237854, distance_loss: 5.894416809082031
class_loss: 0.8717517256736755, distance_loss: 5.940267562866211
class_loss: 0.9856711030006409, distance_loss: 5.9828200340271
class_loss: 0.7518109083175659, distance_loss: 6.023557662963867
class_loss: 0.9479029178619385, distance_loss: 6.063069820404053
class_loss: 0.8823713660240173, distance_loss: 6.100616455078125
class_loss: 0.7333061099052429, distance_loss: 6.131028175354004
class_loss: 0.8020209074020386, distance_loss: 6.1595659255981445
class_loss: 0.7669857740402222, distance_loss: 6.186281681060791
class_loss: 0.7933863401412964, distance_loss: 6.2120513916015625
class_loss: 0.7730207443237305, distance_loss: 6.238019943237305
class_loss: 1.2534579038619995, distance_loss: 6.263373374938965
___PoisonTrain Local_Simple ,  epoch  52, local model 81, internal_epoch   2,  Average loss: 0.0145, Accuracy: 675/1227 (55.0122%), train_poison_data_count: 391
Global model norm: 15.460667080126266.
Norm before scaling: 16.08318164075296. Distance: 6.301201103397588
Total norm for 3 adversaries is: 16.08318164075296. distance: 6.301201103397588
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.6725, Accuracy: 6089/8968 (67.8970%)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   1,  Average loss: 0.0005, Accuracy: 883/892 (98.9910%)
___Train Local_Simple,  epoch  52, local model 10, internal_epoch   2,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1762, Accuracy: 9407/10000 (94.0700%)
___Train Local_Simple,  epoch  52, local model 92, internal_epoch   1,  Average loss: 0.0009, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch  52, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 932/937 (99.4664%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.1699, Accuracy: 9454/10000 (94.5400%)
___Train Local_Simple,  epoch  52, local model 62, internal_epoch   1,  Average loss: 0.0005, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch  52, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0530, Accuracy: 9828/10000 (98.2800%)
poison local model 26 index 2
class_loss: 3.3886220455169678, distance_loss: 0.0
class_loss: 2.3720004558563232, distance_loss: 0.3044031858444214
class_loss: 1.0797184705734253, distance_loss: 0.7767038941383362
class_loss: 0.9431660771369934, distance_loss: 1.1788989305496216
class_loss: 0.9187187552452087, distance_loss: 1.5734423398971558
class_loss: 0.9730187058448792, distance_loss: 1.92251455783844
class_loss: 0.9107788801193237, distance_loss: 2.242246627807617
class_loss: 0.965799868106842, distance_loss: 2.5282320976257324
class_loss: 1.030548095703125, distance_loss: 2.7744534015655518
class_loss: 1.2228045463562012, distance_loss: 2.9876346588134766
class_loss: 1.0828676223754883, distance_loss: 3.1696841716766357
class_loss: 0.9565075039863586, distance_loss: 3.3280868530273438
class_loss: 1.0170527696609497, distance_loss: 3.465829610824585
class_loss: 0.8968101739883423, distance_loss: 3.5865566730499268
class_loss: 0.9942696690559387, distance_loss: 3.694622278213501
class_loss: 0.7747556567192078, distance_loss: 3.7922613620758057
class_loss: 0.830682098865509, distance_loss: 3.8824074268341064
class_loss: 0.7724341154098511, distance_loss: 3.966346502304077
___PoisonTrain Local_Simple ,  epoch  52, local model 26, internal_epoch   1,  Average loss: 0.0227, Accuracy: 398/554 (71.8412%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  52, local model 26, internal_epoch   2,  Average loss: 0.0154, Accuracy: 326/554 (58.8448%), train_poison_data_count: 180
Global model norm: 15.460667080126266.
Norm before scaling: 15.380447043084189. Distance: 4.048312487893417
Total norm for 3 adversaries is: 15.380447043084189. distance: 4.048312487893417
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 0.8874, Accuracy: 6139/8968 (68.4545%)
___Train Local_Simple,  epoch  52, local model 29, internal_epoch   1,  Average loss: 0.0009, Accuracy: 986/1002 (98.4032%)
___Train Local_Simple,  epoch  52, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 994/1002 (99.2016%)
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.3762, Accuracy: 8812/10000 (88.1200%)
time spent on training: 46.88668370246887
Starting performing KrMLRFL...
Num data points: [470, 591, 492, 448, 1227, 892, 937, 423, 554, 1002]
Num selected data points: [470 492 448 892 423]
The chosen ones are users: [0, 2, 3, 5, 7], which are global users: [87, 89, 48, 10, 62]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73, 81, 26]
base_p: [-9.5978677e-03  5.7645142e-05 -4.1408464e-05 ...  2.5120676e-03
 -1.1008419e-03 -1.6143546e-03]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 8, 9]
layer1_inf_time: 4.068115234375
[PAIRWISE] pred_attackers_indx:  [1 4 8]
layer2_inf_t: 31.161865234375
assumed final_attacker_idxs:  [1 4 6 8 9]
final_attacker_idxs is: [1 4 6 8 9]
g_attacker_idxs: [73 81 92 26 29]
g_normal_idxs: [87 89 48 10 62]
filtered_attacker_idxs: [1, 4, 6, 8, 9]
final_attacker_idxs are: [1, 4, 6, 8, 9]
num_dps: [470, 591, 492, 448, 1227, 892, 937, 423, 554, 1002]
epoch_acc: 98.4
___Test Local_Simple poisoned: False, epoch: 52: Average loss: 0.0480, Accuracy: 9840/10000 (98.4000%)
___Test Local_Simple poisoned: True, epoch: 52: Average loss: 14.0383, Accuracy: 23/8968 (0.2565%)
Done in 137.91446542739868 sec.
Server Epoch:53 choose agents : [38, 78, 26, 18, 72, 75, 93, 39, 44, 90].
___Train Local_Simple,  epoch  53, local model 38, internal_epoch   1,  Average loss: 0.0006, Accuracy: 883/895 (98.6592%)
___Train Local_Simple,  epoch  53, local model 38, internal_epoch   2,  Average loss: 0.0005, Accuracy: 885/895 (98.8827%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2501, Accuracy: 9279/10000 (92.7900%)
___Train Local_Simple,  epoch  53, local model 78, internal_epoch   1,  Average loss: 0.0009, Accuracy: 298/303 (98.3498%)
___Train Local_Simple,  epoch  53, local model 78, internal_epoch   2,  Average loss: 0.0012, Accuracy: 297/303 (98.0198%)
class_loss: 3.1379897594451904, distance_loss: 0.0
class_loss: 2.014064311981201, distance_loss: 0.2571057379245758
class_loss: 0.8647017478942871, distance_loss: 0.5961636900901794
class_loss: 1.2478710412979126, distance_loss: 1.0294756889343262
class_loss: 0.9654729962348938, distance_loss: 1.3512510061264038
class_loss: 0.7986602783203125, distance_loss: 1.6201850175857544
class_loss: 0.8257673978805542, distance_loss: 1.8752424716949463
class_loss: 0.7920045852661133, distance_loss: 2.0964224338531494
class_loss: 0.9290170073509216, distance_loss: 2.286795139312744
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1417, Accuracy: 9580/10000 (95.8000%)
poison local model 26 index 0
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   1,  Average loss: 0.0209, Accuracy: 405/554 (73.1047%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  53, local model 26, internal_epoch   2,  Average loss: 0.0113, Accuracy: 390/554 (70.3971%), train_poison_data_count: 180
Global model norm: 15.416560872032834.
Norm before scaling: 15.335219115242534. Distance: 3.319946843376665
Total norm for 2 adversaries is: 15.335219115242534. distance: 3.319946843376665
class_loss: 0.7858536243438721, distance_loss: 2.4555296897888184
class_loss: 0.8078160285949707, distance_loss: 2.600224494934082
class_loss: 0.6760889291763306, distance_loss: 2.7250843048095703
class_loss: 0.7702488303184509, distance_loss: 2.832672119140625
class_loss: 0.7957784533500671, distance_loss: 2.927137851715088
class_loss: 0.6749917268753052, distance_loss: 3.0135715007781982
class_loss: 0.7312666177749634, distance_loss: 3.094622850418091
class_loss: 0.5375738143920898, distance_loss: 3.169865608215332
class_loss: 0.45797428488731384, distance_loss: 3.2463948726654053
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 0.9917, Accuracy: 4743/8968 (52.8880%)
___Train Local_Simple,  epoch  53, local model 18, internal_epoch   1,  Average loss: 0.0023, Accuracy: 449/459 (97.8214%)
___Train Local_Simple,  epoch  53, local model 18, internal_epoch   2,  Average loss: 0.0009, Accuracy: 450/459 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.2778, Accuracy: 9144/10000 (91.4400%)
___Train Local_Simple,  epoch  53, local model 72, internal_epoch   1,  Average loss: 0.0002, Accuracy: 728/731 (99.5896%)
___Train Local_Simple,  epoch  53, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 729/731 (99.7264%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1464, Accuracy: 9514/10000 (95.1400%)
___Train Local_Simple,  epoch  53, local model 75, internal_epoch   1,  Average loss: 0.0008, Accuracy: 676/686 (98.5423%)
___Train Local_Simple,  epoch  53, local model 75, internal_epoch   2,  Average loss: 0.0008, Accuracy: 675/686 (98.3965%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1111, Accuracy: 9671/10000 (96.7100%)
poison local model 93 index 1
___PoisonTrain Local_Simple ,  epoch  53, local model 93, internal_epoch   1,  Average loss: 0.0307, Accuracy: 328/623 (52.6485%), train_poison_data_count: 200
class_loss: 4.772702217102051, distance_loss: 0.0
class_loss: 2.2543179988861084, distance_loss: 0.41766637563705444
class_loss: 1.8615319728851318, distance_loss: 1.0228897333145142
class_loss: 1.8467708826065063, distance_loss: 1.4319124221801758
class_loss: 1.4149798154830933, distance_loss: 1.8040162324905396
class_loss: 1.7435367107391357, distance_loss: 2.1502413749694824
class_loss: 1.4863616228103638, distance_loss: 2.4637186527252197
class_loss: 1.4439042806625366, distance_loss: 2.7437961101531982
class_loss: 1.18643057346344, distance_loss: 2.9991965293884277
class_loss: 1.1191807985305786, distance_loss: 3.234874725341797
class_loss: 0.9380590319633484, distance_loss: 3.4637484550476074
class_loss: 0.8638898730278015, distance_loss: 3.680309534072876
class_loss: 0.9118924140930176, distance_loss: 3.8790204524993896
class_loss: 0.9097530245780945, distance_loss: 4.06240177154541
class_loss: 0.9522303938865662, distance_loss: 4.233943939208984
class_loss: 1.1820122003555298, distance_loss: 4.389526844024658
class_loss: 1.1110223531723022, distance_loss: 4.533156394958496
class_loss: 0.9296500086784363, distance_loss: 4.665916919708252
class_loss: 0.7710357308387756, distance_loss: 4.7841973304748535
class_loss: 0.8445109128952026, distance_loss: 4.897791862487793
___PoisonTrain Local_Simple ,  epoch  53, local model 93, internal_epoch   2,  Average loss: 0.0151, Accuracy: 351/623 (56.3403%), train_poison_data_count: 200
Global model norm: 15.416560872032834.
Norm before scaling: 15.645375386870516. Distance: 5.006485737978296
Total norm for 2 adversaries is: 15.645375386870516. distance: 5.006485737978296
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 1.5063, Accuracy: 2543/8968 (28.3564%)
___Train Local_Simple,  epoch  53, local model 39, internal_epoch   1,  Average loss: 0.0005, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  53, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0545, Accuracy: 9829/10000 (98.2900%)
___Train Local_Simple,  epoch  53, local model 44, internal_epoch   1,  Average loss: 0.0012, Accuracy: 503/517 (97.2921%)
___Train Local_Simple,  epoch  53, local model 44, internal_epoch   2,  Average loss: 0.0004, Accuracy: 514/517 (99.4197%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.1280, Accuracy: 9578/10000 (95.7800%)
___Train Local_Simple,  epoch  53, local model 90, internal_epoch   1,  Average loss: 0.0004, Accuracy: 675/683 (98.8287%)
___Train Local_Simple,  epoch  53, local model 90, internal_epoch   2,  Average loss: 0.0002, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.4492, Accuracy: 8792/10000 (87.9200%)
time spent on training: 43.03229379653931
Starting performing KrMLRFL...
Num data points: [895, 303, 554, 459, 731, 686, 623, 257, 517, 683]
Num selected data points: [895 303 731 686 257 517 683]
The chosen ones are users: [0, 1, 4, 5, 7, 8, 9], which are global users: [38, 78, 72, 75, 39, 44, 90]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 93]
base_p: [-0.00043783  0.00026745 -0.0003713  ... -0.0054735  -0.0004114
 -0.00081231]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 6, 8]
layer1_inf_time: 3.4375
[PAIRWISE] pred_attackers_indx:  [2 6]
layer2_inf_t: 33.7294921875
assumed final_attacker_idxs:  [0 2 3 6 8]
final_attacker_idxs is: [0 2 3 6 8]
g_attacker_idxs: [38 26 18 93 44]
g_normal_idxs: [78 72 75 39 90]
filtered_attacker_idxs: [2, 3, 6]
final_attacker_idxs are: [2, 3, 6]
num_dps: [895, 303, 554, 459, 731, 686, 623, 257, 517, 683]
epoch_acc: 98.47
___Test Local_Simple poisoned: False, epoch: 53: Average loss: 0.0458, Accuracy: 9847/10000 (98.4700%)
___Test Local_Simple poisoned: True, epoch: 53: Average loss: 14.4218, Accuracy: 2/8968 (0.0223%)
Done in 129.96000409126282 sec.
Server Epoch:54 choose agents : [31, 1, 38, 9, 6, 19, 65, 66, 73, 15].
___Train Local_Simple,  epoch  54, local model 31, internal_epoch   1,  Average loss: 0.0005, Accuracy: 825/835 (98.8024%)
___Train Local_Simple,  epoch  54, local model 31, internal_epoch   2,  Average loss: 0.0003, Accuracy: 829/835 (99.2814%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1299, Accuracy: 9637/10000 (96.3700%)
poison local model 1 index 0
class_loss: 4.07919979095459, distance_loss: 0.0
class_loss: 2.3381950855255127, distance_loss: 0.32049310207366943
class_loss: 1.961423397064209, distance_loss: 0.7857093811035156
class_loss: 1.1038894653320312, distance_loss: 1.2937984466552734
class_loss: 1.1033713817596436, distance_loss: 1.7628273963928223
class_loss: 1.343920111656189, distance_loss: 2.171818494796753
class_loss: 1.3522745370864868, distance_loss: 2.5175375938415527
class_loss: 1.4079947471618652, distance_loss: 2.8189520835876465
class_loss: 1.5401034355163574, distance_loss: 3.085155725479126
class_loss: 1.2823071479797363, distance_loss: 3.3224306106567383
class_loss: 1.2730300426483154, distance_loss: 3.5331966876983643
class_loss: 1.2871239185333252, distance_loss: 3.719978094100952
class_loss: 1.1917723417282104, distance_loss: 3.8869028091430664
class_loss: 1.144748330116272, distance_loss: 4.03639554977417
class_loss: 1.0740758180618286, distance_loss: 4.168959140777588
class_loss: 0.9532263278961182, distance_loss: 4.289979934692383
class_loss: 0.8239689469337463, distance_loss: 4.402226448059082
class_loss: 0.8700610995292664, distance_loss: 4.506570339202881
class_loss: 1.1844407320022583, distance_loss: 4.606612205505371
class_loss: 0.6964846849441528, distance_loss: 4.697737693786621
class_loss: 0.7361514568328857, distance_loss: 4.785648345947266
class_loss: 0.9749870300292969, distance_loss: 4.865734577178955
class_loss: 0.9158136248588562, distance_loss: 4.937549591064453
class_loss: 0.8225117921829224, distance_loss: 5.00347375869751
___PoisonTrain Local_Simple ,  epoch  54, local model 1, internal_epoch   1,  Average loss: 0.0264, Accuracy: 374/760 (49.2105%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  54, local model 1, internal_epoch   2,  Average loss: 0.0150, Accuracy: 432/760 (56.8421%), train_poison_data_count: 240
Global model norm: 15.375601904027459.
Norm before scaling: 15.564189773190844. Distance: 5.062515258766067
Total norm for 2 adversaries is: 15.564189773190844. distance: 5.062515258766067
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 1.0303, Accuracy: 4221/8968 (47.0674%)
___Train Local_Simple,  epoch  54, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 892/895 (99.6648%)
___Train Local_Simple,  epoch  54, local model 38, internal_epoch   2,  Average loss: 0.0003, Accuracy: 892/895 (99.6648%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1566, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch  54, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0823, Accuracy: 9735/10000 (97.3500%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   1,  Average loss: 0.0005, Accuracy: 607/615 (98.6992%)
___Train Local_Simple,  epoch  54, local model 6, internal_epoch   2,  Average loss: 0.0003, Accuracy: 613/615 (99.6748%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1324, Accuracy: 9555/10000 (95.5500%)
___Train Local_Simple,  epoch  54, local model 19, internal_epoch   1,  Average loss: 0.0010, Accuracy: 201/205 (98.0488%)
___Train Local_Simple,  epoch  54, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0878, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch  54, local model 65, internal_epoch   1,  Average loss: 0.0005, Accuracy: 367/371 (98.9218%)
___Train Local_Simple,  epoch  54, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1264, Accuracy: 9603/10000 (96.0300%)
___Train Local_Simple,  epoch  54, local model 66, internal_epoch   1,  Average loss: 0.0010, Accuracy: 648/660 (98.1818%)
___Train Local_Simple,  epoch  54, local model 66, internal_epoch   2,  Average loss: 0.0007, Accuracy: 652/660 (98.7879%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.1841, Accuracy: 9414/10000 (94.1400%)
poison local model 73 index 1
class_loss: 4.436343669891357, distance_loss: 0.0
class_loss: 2.1862480640411377, distance_loss: 0.38529172539711
class_loss: 2.7441070079803467, distance_loss: 0.9163572788238525
class_loss: 1.49384605884552, distance_loss: 1.3286570310592651
class_loss: 1.40030038356781, distance_loss: 1.7594152688980103
class_loss: 1.1803890466690063, distance_loss: 2.1529600620269775
class_loss: 1.1587603092193604, distance_loss: 2.5072507858276367
class_loss: 1.106526255607605, distance_loss: 2.8311474323272705
class_loss: 1.0349063873291016, distance_loss: 3.127092123031616
class_loss: 1.9937306642532349, distance_loss: 3.397479772567749
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   1,  Average loss: 0.0317, Accuracy: 337/591 (57.0220%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  54, local model 73, internal_epoch   2,  Average loss: 0.0230, Accuracy: 231/591 (39.0863%), train_poison_data_count: 195
Global model norm: 15.375601904027459.
Norm before scaling: 15.525798370424063. Distance: 5.3928847731763945
Total norm for 2 adversaries is: 15.525798370424063. distance: 5.3928847731763945
class_loss: 1.063317060470581, distance_loss: 3.674762487411499
class_loss: 1.516498327255249, distance_loss: 3.9366800785064697
class_loss: 1.482698917388916, distance_loss: 4.17205810546875
class_loss: 1.4581823348999023, distance_loss: 4.383655071258545
class_loss: 1.4753456115722656, distance_loss: 4.574036598205566
class_loss: 1.2805254459381104, distance_loss: 4.7481794357299805
class_loss: 1.1137312650680542, distance_loss: 4.90920877456665
class_loss: 1.1843420267105103, distance_loss: 5.057361125946045
class_loss: 1.1546390056610107, distance_loss: 5.190292835235596
class_loss: 1.8721745014190674, distance_loss: 5.302118301391602
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 0.6027, Accuracy: 8916/8968 (99.4202%)
___Train Local_Simple,  epoch  54, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 398/401 (99.2519%)
___Train Local_Simple,  epoch  54, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0555, Accuracy: 9817/10000 (98.1700%)
time spent on training: 43.49961543083191
Starting performing KrMLRFL...
Num data points: [835, 760, 895, 436, 615, 205, 371, 660, 591, 401]
Num selected data points: [895 436 615 205 371 401]
The chosen ones are users: [2, 3, 4, 5, 6, 9], which are global users: [38, 9, 6, 19, 65, 15]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 73]
base_p: [ 0.00066061  0.00029421  0.00037654 ... -0.00188923 -0.00344226
  0.00364165]
[T_SCORE] attacker_local_idxs is:  [0, 1, 6, 7, 8]
layer1_inf_time: 3.16455078125
[PAIRWISE] pred_attackers_indx:  [1 8]
layer2_inf_t: 31.33642578125
assumed final_attacker_idxs:  [0 1 6 7 8]
final_attacker_idxs is: [0 1 6 7 8]
g_attacker_idxs: [31  1 65 66 73]
g_normal_idxs: [38  9  6 19 15]
filtered_attacker_idxs: [0, 1, 7, 8]
final_attacker_idxs are: [0, 1, 7, 8]
num_dps: [835, 760, 895, 436, 615, 205, 371, 660, 591, 401]
epoch_acc: 98.61
___Test Local_Simple poisoned: False, epoch: 54: Average loss: 0.0438, Accuracy: 9861/10000 (98.6100%)
___Test Local_Simple poisoned: True, epoch: 54: Average loss: 14.5656, Accuracy: 5/8968 (0.0558%)
Done in 128.87835359573364 sec.
Server Epoch:55 choose agents : [53, 75, 1, 37, 94, 51, 29, 39, 60, 5].
___Train Local_Simple,  epoch  55, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch  55, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2635, Accuracy: 9224/10000 (92.2400%)
___Train Local_Simple,  epoch  55, local model 75, internal_epoch   1,  Average loss: 0.0006, Accuracy: 676/686 (98.5423%)
___Train Local_Simple,  epoch  55, local model 75, internal_epoch   2,  Average loss: 0.0007, Accuracy: 678/686 (98.8338%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2449, Accuracy: 9376/10000 (93.7600%)
poison local model 1 index 0
___PoisonTrain Local_Simple ,  epoch  55, local model 1, internal_epoch   1,  Average loss: 0.0261, Accuracy: 403/760 (53.0263%), train_poison_data_count: 240
class_loss: 4.116971492767334, distance_loss: 0.0
class_loss: 2.9751088619232178, distance_loss: 0.30603769421577454
class_loss: 1.3390872478485107, distance_loss: 0.7961289286613464
class_loss: 1.1434342861175537, distance_loss: 1.3473619222640991
class_loss: 1.2360581159591675, distance_loss: 1.8085180521011353
class_loss: 1.1827806234359741, distance_loss: 2.197012186050415
class_loss: 1.2654085159301758, distance_loss: 2.5389606952667236
class_loss: 1.2593694925308228, distance_loss: 2.8417341709136963
class_loss: 1.2298753261566162, distance_loss: 3.110771656036377
class_loss: 1.3054213523864746, distance_loss: 3.352992534637451
class_loss: 1.5848900079727173, distance_loss: 3.5720677375793457
class_loss: 1.2028112411499023, distance_loss: 3.7668848037719727
class_loss: 1.2726452350616455, distance_loss: 3.9421589374542236
class_loss: 1.2933729887008667, distance_loss: 4.096497535705566
class_loss: 1.001991868019104, distance_loss: 4.233064651489258
class_loss: 1.0832878351211548, distance_loss: 4.362454891204834
class_loss: 0.9994279146194458, distance_loss: 4.48252534866333
class_loss: 1.0003215074539185, distance_loss: 4.594258785247803
class_loss: 0.9496162533760071, distance_loss: 4.698550701141357
class_loss: 0.8450877666473389, distance_loss: 4.796234607696533
class_loss: 0.9003516435623169, distance_loss: 4.888057231903076
class_loss: 0.8623335361480713, distance_loss: 4.97221040725708
class_loss: 0.822759211063385, distance_loss: 5.048553466796875
class_loss: 0.8176860213279724, distance_loss: 5.119077682495117
___PoisonTrain Local_Simple ,  epoch  55, local model 1, internal_epoch   2,  Average loss: 0.0156, Accuracy: 410/760 (53.9474%), train_poison_data_count: 240
Global model norm: 15.334048931727882.
Norm before scaling: 15.541330178771247. Distance: 5.185099770331898
Total norm for 2 adversaries is: 15.541330178771247. distance: 5.185099770331898
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1.1682, Accuracy: 3080/8968 (34.3443%)
___Train Local_Simple,  epoch  55, local model 37, internal_epoch   1,  Average loss: 0.0009, Accuracy: 849/860 (98.7209%)
___Train Local_Simple,  epoch  55, local model 37, internal_epoch   2,  Average loss: 0.0012, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1532, Accuracy: 9515/10000 (95.1500%)
___Train Local_Simple,  epoch  55, local model 94, internal_epoch   1,  Average loss: 0.0014, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  55, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1293, Accuracy: 9578/10000 (95.7800%)
poison local model 51 index 1
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   1,  Average loss: 0.0290, Accuracy: 317/568 (55.8099%), train_poison_data_count: 180
class_loss: 5.406397819519043, distance_loss: 0.0
class_loss: 2.3087971210479736, distance_loss: 0.44543108344078064
class_loss: 1.9485419988632202, distance_loss: 1.0488827228546143
class_loss: 1.4821354150772095, distance_loss: 1.5703673362731934
class_loss: 1.3015323877334595, distance_loss: 2.05485463142395
class_loss: 1.1382039785385132, distance_loss: 2.5025861263275146
class_loss: 1.0664058923721313, distance_loss: 2.9063329696655273
class_loss: 0.9052023887634277, distance_loss: 3.2710418701171875
class_loss: 0.9386774301528931, distance_loss: 3.6040215492248535
class_loss: 1.0353692770004272, distance_loss: 3.9066874980926514
class_loss: 1.050479531288147, distance_loss: 4.174131393432617
class_loss: 0.9299159049987793, distance_loss: 4.412302494049072
class_loss: 0.8720976710319519, distance_loss: 4.629586696624756
class_loss: 0.8792363405227661, distance_loss: 4.825242042541504
class_loss: 0.8571150898933411, distance_loss: 5.001000881195068
class_loss: 0.6295904517173767, distance_loss: 5.160989761352539
class_loss: 1.0537168979644775, distance_loss: 5.308731555938721
class_loss: 0.8696338534355164, distance_loss: 5.4433722496032715
___PoisonTrain Local_Simple ,  epoch  55, local model 51, internal_epoch   2,  Average loss: 0.0144, Accuracy: 333/568 (58.6268%), train_poison_data_count: 180
Global model norm: 15.334048931727882.
Norm before scaling: 15.556114755903163. Distance: 5.56366811767057
Total norm for 2 adversaries is: 15.556114755903163. distance: 5.56366811767057
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 1.0307, Accuracy: 5032/8968 (56.1106%)
___Train Local_Simple,  epoch  55, local model 29, internal_epoch   1,  Average loss: 0.0008, Accuracy: 986/1002 (98.4032%)
___Train Local_Simple,  epoch  55, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 992/1002 (99.0020%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.2211, Accuracy: 9285/10000 (92.8500%)
___Train Local_Simple,  epoch  55, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 252/257 (98.0545%)
___Train Local_Simple,  epoch  55, local model 39, internal_epoch   2,  Average loss: 0.0003, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1072, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  55, local model 60, internal_epoch   1,  Average loss: 0.0011, Accuracy: 333/338 (98.5207%)
___Train Local_Simple,  epoch  55, local model 60, internal_epoch   2,  Average loss: 0.0005, Accuracy: 334/338 (98.8166%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0749, Accuracy: 9760/10000 (97.6000%)
___Train Local_Simple,  epoch  55, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 427/434 (98.3871%)
___Train Local_Simple,  epoch  55, local model 5, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/434 (99.7696%)
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.1436, Accuracy: 9417/10000 (94.1700%)
time spent on training: 39.34012699127197
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 51]
base_p: [-0.00091872  0.00032956 -0.00054535 ... -0.00124396 -0.0171551
  0.0062573 ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 6]
layer1_inf_time: 3.408447265625
[PAIRWISE] pred_attackers_indx:  [2 5]
layer2_inf_t: 47.91064453125
assumed final_attacker_idxs:  [0 2 3 5 6]
final_attacker_idxs is: [0 2 3 5 6]
g_attacker_idxs: [53  1 37 51 29]
g_normal_idxs: [75 94 39 60  5]
filtered_attacker_idxs: [0, 2, 3, 5, 6]
final_attacker_idxs are: [0, 2, 3, 5, 6]
num_dps: [739, 686, 760, 860, 150, 568, 1002, 257, 338, 434]
Starting performing KrMLRFL...
Num data points: [739, 686, 760, 860, 150, 568, 1002, 257, 338, 434]
Num selected data points: [686 150 257 338 434]
The chosen ones are users: [1, 4, 7, 8, 9], which are global users: [75, 94, 39, 60, 5]
___Test Local_Simple poisoned: False, epoch: 55: Average loss: 0.0423, Accuracy: 9853/10000 (98.5300%)
epoch_acc: 98.53
___Test Local_Simple poisoned: True, epoch: 55: Average loss: 14.0356, Accuracy: 11/8968 (0.1227%)
Done in 128.92926454544067 sec.
Server Epoch:56 choose agents : [75, 78, 14, 39, 7, 10, 40, 2, 68, 54].
___Train Local_Simple,  epoch  56, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Train Local_Simple,  epoch  56, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0626, Accuracy: 9790/10000 (97.9000%)
___Train Local_Simple,  epoch  56, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch  56, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0748, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch  56, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 374/376 (99.4681%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0736, Accuracy: 9779/10000 (97.7900%)
___Train Local_Simple,  epoch  56, local model 39, internal_epoch   1,  Average loss: 0.0004, Accuracy: 256/257 (99.6109%)
___Train Local_Simple,  epoch  56, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0506, Accuracy: 9832/10000 (98.3200%)
poison local model 7 index 0
___PoisonTrain Local_Simple ,  epoch  56, local model 7, internal_epoch   1,  Average loss: 0.0292, Accuracy: 256/418 (61.2440%), train_poison_data_count: 140
class_loss: 3.457549571990967, distance_loss: 0.0
class_loss: 2.4661495685577393, distance_loss: 0.2676618695259094
class_loss: 1.606397271156311, distance_loss: 0.6948977112770081
class_loss: 1.1030550003051758, distance_loss: 1.178540825843811
class_loss: 1.5111826658248901, distance_loss: 1.5964421033859253
class_loss: 1.1649976968765259, distance_loss: 1.9535207748413086
class_loss: 0.9145019054412842, distance_loss: 2.2767906188964844
class_loss: 1.2436350584030151, distance_loss: 2.5728816986083984
class_loss: 1.236392855644226, distance_loss: 2.8316709995269775
class_loss: 1.3208009004592896, distance_loss: 3.0570569038391113
class_loss: 1.2664886713027954, distance_loss: 3.253387451171875
class_loss: 1.3034437894821167, distance_loss: 3.427013397216797
class_loss: 1.2048250436782837, distance_loss: 3.581346273422241
class_loss: 0.7878686189651489, distance_loss: 3.7184510231018066
___PoisonTrain Local_Simple ,  epoch  56, local model 7, internal_epoch   2,  Average loss: 0.0200, Accuracy: 222/418 (53.1100%), train_poison_data_count: 140
Global model norm: 15.323622793822084.
Norm before scaling: 15.167827408078258. Distance: 3.847838917380306
Total norm for 2 adversaries is: 15.167827408078258. distance: 3.847838917380306
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.5961, Accuracy: 7659/8968 (85.4037%)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%)
___Train Local_Simple,  epoch  56, local model 10, internal_epoch   2,  Average loss: 0.0004, Accuracy: 882/892 (98.8789%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1490, Accuracy: 9486/10000 (94.8600%)
___Train Local_Simple,  epoch  56, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 763/772 (98.8342%)
___Train Local_Simple,  epoch  56, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 770/772 (99.7409%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1693, Accuracy: 9509/10000 (95.0900%)
poison local model 2 index 1
class_loss: 2.4845783710479736, distance_loss: 0.0
class_loss: 1.3470150232315063, distance_loss: 0.1925257295370102
class_loss: 0.8398998975753784, distance_loss: 0.4374673366546631
class_loss: 0.6909478902816772, distance_loss: 0.7154980897903442
class_loss: 0.7069974541664124, distance_loss: 1.0312609672546387
class_loss: 0.6356438994407654, distance_loss: 1.3487526178359985
class_loss: 0.8779283165931702, distance_loss: 1.6442668437957764
class_loss: 0.9526574015617371, distance_loss: 1.902949571609497
class_loss: 0.6665747165679932, distance_loss: 2.118929147720337
___PoisonTrain Local_Simple ,  epoch  56, local model 2, internal_epoch   1,  Average loss: 0.0168, Accuracy: 443/548 (80.8394%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  56, local model 2, internal_epoch   2,  Average loss: 0.0103, Accuracy: 403/548 (73.5401%), train_poison_data_count: 180
Global model norm: 15.323622793822084.
Norm before scaling: 15.168819288701453. Distance: 3.271555065700805
Total norm for 2 adversaries is: 15.168819288701453. distance: 3.271555065700805
class_loss: 0.7830013036727905, distance_loss: 2.3057401180267334
class_loss: 0.6614685654640198, distance_loss: 2.468535900115967
class_loss: 0.5411320328712463, distance_loss: 2.6141955852508545
class_loss: 0.5746912956237793, distance_loss: 2.745335578918457
class_loss: 0.6999454498291016, distance_loss: 2.860564708709717
class_loss: 0.5926086902618408, distance_loss: 2.9624814987182617
class_loss: 0.5680826902389526, distance_loss: 3.0523078441619873
class_loss: 0.7486103773117065, distance_loss: 3.1328353881835938
class_loss: 0.49031269550323486, distance_loss: 3.2033145427703857
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 0.7488, Accuracy: 6485/8968 (72.3127%)
___Train Local_Simple,  epoch  56, local model 68, internal_epoch   1,  Average loss: 0.0007, Accuracy: 487/494 (98.5830%)
___Train Local_Simple,  epoch  56, local model 68, internal_epoch   2,  Average loss: 0.0004, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1075, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch  56, local model 54, internal_epoch   1,  Average loss: 0.0005, Accuracy: 515/519 (99.2293%)
___Train Local_Simple,  epoch  56, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.1184, Accuracy: 9618/10000 (96.1800%)
time spent on training: 40.391348123550415
Starting performing KrMLRFL...
Num data points: [686, 303, 376, 257, 418, 892, 772, 548, 494, 519]
Num selected data points: [686 303 376 257 892 494 519]
The chosen ones are users: [0, 1, 2, 3, 5, 8, 9], which are global users: [75, 78, 14, 39, 10, 68, 54]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 2]
base_p: [ 0.00019228  0.00028492 -0.0004402  ... -0.0005634  -0.00294251
  0.0003224 ]
[T_SCORE] attacker_local_idxs is:  [4, 6, 7, 8, 9]
layer1_inf_time: 2.57763671875
[PAIRWISE] pred_attackers_indx:  [4 7]
layer2_inf_t: 25.87646484375
assumed final_attacker_idxs:  [4 6 7 8 9]
final_attacker_idxs is: [4 6 7 8 9]
g_attacker_idxs: [ 7 40  2 68 54]
g_normal_idxs: [75 78 14 39 10]
filtered_attacker_idxs: [4, 6, 7]
final_attacker_idxs are: [4, 6, 7]
num_dps: [686, 303, 376, 257, 418, 892, 772, 548, 494, 519]
epoch_acc: 98.8
___Test Local_Simple poisoned: False, epoch: 56: Average loss: 0.0367, Accuracy: 9880/10000 (98.8000%)
___Test Local_Simple poisoned: True, epoch: 56: Average loss: 13.9890, Accuracy: 13/8968 (0.1450%)
Done in 133.57906079292297 sec.
Server Epoch:57 choose agents : [94, 48, 82, 25, 26, 16, 7, 90, 68, 43].
___Train Local_Simple,  epoch  57, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  57, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1316, Accuracy: 9526/10000 (95.2600%)
___Train Local_Simple,  epoch  57, local model 48, internal_epoch   1,  Average loss: 0.0003, Accuracy: 444/448 (99.1071%)
___Train Local_Simple,  epoch  57, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0996, Accuracy: 9663/10000 (96.6300%)
___Train Local_Simple,  epoch  57, local model 82, internal_epoch   1,  Average loss: 0.0003, Accuracy: 708/713 (99.2987%)
___Train Local_Simple,  epoch  57, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.3601, Accuracy: 9057/10000 (90.5700%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%)
___Train Local_Simple,  epoch  57, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1301, Accuracy: 9588/10000 (95.8800%)
poison local model 26 index 0
___PoisonTrain Local_Simple ,  epoch  57, local model 26, internal_epoch   1,  Average loss: 0.0229, Accuracy: 396/554 (71.4801%), train_poison_data_count: 180
class_loss: 2.6869592666625977, distance_loss: 0.0
class_loss: 2.183316707611084, distance_loss: 0.22570855915546417
class_loss: 1.6314468383789062, distance_loss: 0.6049418449401855
class_loss: 0.8248304724693298, distance_loss: 1.0589679479599
class_loss: 1.2686660289764404, distance_loss: 1.4511687755584717
class_loss: 1.0689005851745605, distance_loss: 1.8010109663009644
class_loss: 0.8732258677482605, distance_loss: 2.1259472370147705
class_loss: 1.0241689682006836, distance_loss: 2.418903112411499
class_loss: 1.0981321334838867, distance_loss: 2.671630859375
class_loss: 1.0417417287826538, distance_loss: 2.890260696411133
class_loss: 0.9543820023536682, distance_loss: 3.0857906341552734
class_loss: 0.9518789649009705, distance_loss: 3.260730266571045
class_loss: 0.9869908690452576, distance_loss: 3.4137678146362305
class_loss: 0.7928208708763123, distance_loss: 3.546377182006836
class_loss: 0.720744252204895, distance_loss: 3.6666007041931152
class_loss: 0.6895136833190918, distance_loss: 3.7766261100769043
class_loss: 0.6936586499214172, distance_loss: 3.877319097518921
class_loss: 0.7349589467048645, distance_loss: 3.9703595638275146
___PoisonTrain Local_Simple ,  epoch  57, local model 26, internal_epoch   2,  Average loss: 0.0137, Accuracy: 356/554 (64.2599%), train_poison_data_count: 180
Global model norm: 15.280985387215607.
Norm before scaling: 15.234810190098212. Distance: 4.057523995808589
Total norm for 3 adversaries is: 15.234810190098212. distance: 4.057523995808589
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 1.0986, Accuracy: 5219/8968 (58.1958%)
poison local model 16 index 1
class_loss: 4.201904296875, distance_loss: 0.0
class_loss: 2.3729476928710938, distance_loss: 0.33595067262649536
class_loss: 1.8488173484802246, distance_loss: 0.8748178482055664
class_loss: 1.4108341932296753, distance_loss: 1.3234783411026
class_loss: 1.1858360767364502, distance_loss: 1.7160871028900146
class_loss: 1.469380259513855, distance_loss: 2.062307834625244
class_loss: 1.200925350189209, distance_loss: 2.3770194053649902
class_loss: 1.1063975095748901, distance_loss: 2.6614696979522705
class_loss: 1.166720986366272, distance_loss: 2.9193975925445557
class_loss: 1.26187002658844, distance_loss: 3.155837297439575
class_loss: 1.155296802520752, distance_loss: 3.368980646133423
class_loss: 1.0655040740966797, distance_loss: 3.5651302337646484
class_loss: 1.257968783378601, distance_loss: 3.7457656860351562
class_loss: 0.9611802101135254, distance_loss: 3.9015614986419678
class_loss: 1.1314518451690674, distance_loss: 4.0365166664123535
class_loss: 1.026580572128296, distance_loss: 4.175634860992432
class_loss: 1.069085955619812, distance_loss: 4.295886993408203
class_loss: 1.0168899297714233, distance_loss: 4.404568672180176
class_loss: 0.9344419240951538, distance_loss: 4.499807357788086
class_loss: 1.049470067024231, distance_loss: 4.5846686363220215
class_loss: 1.0373281240463257, distance_loss: 4.660909175872803
class_loss: 1.0208760499954224, distance_loss: 4.7281084060668945
class_loss: 0.9334564805030823, distance_loss: 4.789068698883057
___PoisonTrain Local_Simple ,  epoch  57, local model 16, internal_epoch   1,  Average loss: 0.0249, Accuracy: 490/915 (53.5519%), train_poison_data_count: 299
___PoisonTrain Local_Simple ,  epoch  57, local model 16, internal_epoch   2,  Average loss: 0.0153, Accuracy: 490/915 (53.5519%), train_poison_data_count: 299
Global model norm: 15.280985387215607.
Norm before scaling: 15.617295463765135. Distance: 5.15887735648209
Total norm for 3 adversaries is: 15.617295463765135. distance: 5.15887735648209
class_loss: 0.8615631461143494, distance_loss: 4.844527244567871
class_loss: 0.7683992385864258, distance_loss: 4.895963668823242
class_loss: 0.759642481803894, distance_loss: 4.943642616271973
class_loss: 0.8619486689567566, distance_loss: 4.988509654998779
class_loss: 0.7353242635726929, distance_loss: 5.030351638793945
class_loss: 0.8298324346542358, distance_loss: 5.070688724517822
class_loss: 1.071376919746399, distance_loss: 5.10368537902832
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.7699, Accuracy: 5540/8968 (61.7752%)
poison local model 7 index 2
___PoisonTrain Local_Simple ,  epoch  57, local model 7, internal_epoch   1,  Average loss: 0.0292, Accuracy: 259/418 (61.9617%), train_poison_data_count: 140
class_loss: 3.1112427711486816, distance_loss: 0.0
class_loss: 2.321798086166382, distance_loss: 0.28047385811805725
class_loss: 1.6601835489273071, distance_loss: 0.733759343624115
class_loss: 1.634522795677185, distance_loss: 1.1666194200515747
class_loss: 1.2693716287612915, distance_loss: 1.5239624977111816
class_loss: 1.0333091020584106, distance_loss: 1.8636847734451294
class_loss: 1.1754839420318604, distance_loss: 2.1870319843292236
class_loss: 1.3057507276535034, distance_loss: 2.4674980640411377
class_loss: 1.3032598495483398, distance_loss: 2.701054096221924
class_loss: 1.2005265951156616, distance_loss: 2.9039130210876465
class_loss: 1.0101269483566284, distance_loss: 3.078720808029175
class_loss: 1.1059308052062988, distance_loss: 3.234813928604126
class_loss: 1.0002003908157349, distance_loss: 3.3745288848876953
class_loss: 0.705720841884613, distance_loss: 3.498305559158325
___PoisonTrain Local_Simple ,  epoch  57, local model 7, internal_epoch   2,  Average loss: 0.0183, Accuracy: 226/418 (54.0670%), train_poison_data_count: 140
Global model norm: 15.280985387215607.
Norm before scaling: 15.158004690630356. Distance: 3.614691843534973
Total norm for 3 adversaries is: 15.158004690630356. distance: 3.614691843534973
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 0.5621, Accuracy: 7391/8968 (82.4153%)
___Train Local_Simple,  epoch  57, local model 90, internal_epoch   1,  Average loss: 0.0003, Accuracy: 678/683 (99.2679%)
___Train Local_Simple,  epoch  57, local model 90, internal_epoch   2,  Average loss: 0.0007, Accuracy: 674/683 (98.6823%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.2623, Accuracy: 9120/10000 (91.2000%)
___Train Local_Simple,  epoch  57, local model 68, internal_epoch   1,  Average loss: 0.0004, Accuracy: 487/494 (98.5830%)
___Train Local_Simple,  epoch  57, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.1435, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch  57, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 404/408 (99.0196%)
___Train Local_Simple,  epoch  57, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0520, Accuracy: 9828/10000 (98.2800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 16, 7]
base_p: [-0.00644104  0.00029305  0.00036432 ... -0.00039232 -0.00195075
 -0.0022644 ]
[T_SCORE] attacker_local_idxs is:  [3, 4, 5, 6, 8]
layer1_inf_time: 2.913330078125
[PAIRWISE] pred_attackers_indx:  [4 5 6]
layer2_inf_t: 27.603271484375
assumed final_attacker_idxs:  [3 4 5 6 8]
final_attacker_idxs is: [3 4 5 6 8]
g_attacker_idxs: [25 26 16  7 68]
g_normal_idxs: [94 48 82 90 43]
filtered_attacker_idxs: [3, 4, 5, 6]
final_attacker_idxs are: [3, 4, 5, 6]
num_dps: [150, 448, 713, 647, 554, 915, 418, 683, 494, 408]
time spent on training: 47.59421968460083
Starting performing KrMLRFL...
Num data points: [150, 448, 713, 647, 554, 915, 418, 683, 494, 408]
Num selected data points: [150 448 713 683 494 408]
The chosen ones are users: [0, 1, 2, 7, 8, 9], which are global users: [94, 48, 82, 90, 68, 43]
___Test Local_Simple poisoned: False, epoch: 57: Average loss: 0.0414, Accuracy: 9865/10000 (98.6500%)
epoch_acc: 98.65
___Test Local_Simple poisoned: True, epoch: 57: Average loss: 13.6865, Accuracy: 9/8968 (0.1004%)
Done in 130.97719955444336 sec.
Server Epoch:58 choose agents : [74, 27, 75, 19, 58, 83, 91, 96, 17, 57].
___Train Local_Simple,  epoch  58, local model 74, internal_epoch   1,  Average loss: 0.0009, Accuracy: 548/557 (98.3842%)
___Train Local_Simple,  epoch  58, local model 74, internal_epoch   2,  Average loss: 0.0004, Accuracy: 555/557 (99.6409%)
class_loss: 4.440559387207031, distance_loss: 0.0
class_loss: 3.4286952018737793, distance_loss: 0.39631348848342896
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0657, Accuracy: 9781/10000 (97.8100%)
poison local model 27 index 0
___PoisonTrain Local_Simple ,  epoch  58, local model 27, internal_epoch   1,  Average loss: 0.0367, Accuracy: 236/471 (50.1062%), train_poison_data_count: 160
class_loss: 1.2303471565246582, distance_loss: 0.957197904586792
class_loss: 1.9257397651672363, distance_loss: 1.4742012023925781
class_loss: 1.6714775562286377, distance_loss: 1.8995980024337769
class_loss: 1.6108064651489258, distance_loss: 2.279006242752075
class_loss: 1.5684232711791992, distance_loss: 2.6190459728240967
class_loss: 1.4133871793746948, distance_loss: 2.923074960708618
class_loss: 1.4228583574295044, distance_loss: 3.2051782608032227
class_loss: 1.2647377252578735, distance_loss: 3.4612009525299072
class_loss: 1.2190008163452148, distance_loss: 3.6979258060455322
class_loss: 1.2258721590042114, distance_loss: 3.911691665649414
class_loss: 1.1378421783447266, distance_loss: 4.102632999420166
class_loss: 0.977461576461792, distance_loss: 4.275775909423828
class_loss: 0.8622128367424011, distance_loss: 4.436547756195068
class_loss: 1.8315997123718262, distance_loss: 4.586697101593018
___PoisonTrain Local_Simple ,  epoch  58, local model 27, internal_epoch   2,  Average loss: 0.0211, Accuracy: 206/471 (43.7367%), train_poison_data_count: 160
Global model norm: 15.236213330590822.
Norm before scaling: 15.287152170511517. Distance: 4.731603434374088
Total norm for 3 adversaries is: 15.287152170511517. distance: 4.731603434374088
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 1.0934, Accuracy: 4544/8968 (50.6690%)
___Train Local_Simple,  epoch  58, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch  58, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0662, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch  58, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch  58, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1347, Accuracy: 9579/10000 (95.7900%)
___Train Local_Simple,  epoch  58, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch  58, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1341, Accuracy: 9589/10000 (95.8900%)
___Train Local_Simple,  epoch  58, local model 83, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch  58, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0456, Accuracy: 9860/10000 (98.6000%)
poison local model 91 index 1
___PoisonTrain Local_Simple ,  epoch  58, local model 91, internal_epoch   1,  Average loss: 0.0365, Accuracy: 144/256 (56.2500%), train_poison_data_count: 80
class_loss: 3.5711798667907715, distance_loss: 0.0
class_loss: 2.4503142833709717, distance_loss: 0.32233697175979614
class_loss: 1.696627140045166, distance_loss: 0.7937702536582947
class_loss: 1.6297158002853394, distance_loss: 1.2187758684158325
class_loss: 1.752375602722168, distance_loss: 1.5758672952651978
class_loss: 1.390779972076416, distance_loss: 1.8885869979858398
class_loss: 1.5383652448654175, distance_loss: 2.177539825439453
class_loss: 1.3312225341796875, distance_loss: 2.4464104175567627
___PoisonTrain Local_Simple ,  epoch  58, local model 91, internal_epoch   2,  Average loss: 0.0235, Accuracy: 90/256 (35.1562%), train_poison_data_count: 80
Global model norm: 15.236213330590822.
Norm before scaling: 14.986952638533573. Distance: 2.6878732821250555
Total norm for 3 adversaries is: 14.986952638533573. distance: 2.6878732821250555
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 1.3761, Accuracy: 4755/8968 (53.0219%)
___Train Local_Simple,  epoch  58, local model 96, internal_epoch   1,  Average loss: 0.0009, Accuracy: 663/672 (98.6607%)
___Train Local_Simple,  epoch  58, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 663/672 (98.6607%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.1444, Accuracy: 9562/10000 (95.6200%)
poison local model 17 index 2
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   1,  Average loss: 0.0327, Accuracy: 291/620 (46.9355%), train_poison_data_count: 200
class_loss: 4.581698417663574, distance_loss: 0.0
class_loss: 2.5934224128723145, distance_loss: 0.33288249373435974
class_loss: 1.8144090175628662, distance_loss: 0.8745388388633728
class_loss: 2.126458168029785, distance_loss: 1.3762826919555664
class_loss: 1.4617581367492676, distance_loss: 1.8058956861495972
class_loss: 1.6673740148544312, distance_loss: 2.19960355758667
class_loss: 1.6268434524536133, distance_loss: 2.5478553771972656
class_loss: 1.5479906797409058, distance_loss: 2.860524892807007
class_loss: 1.5421432256698608, distance_loss: 3.1410603523254395
class_loss: 1.33436918258667, distance_loss: 3.3924508094787598
class_loss: 1.3009920120239258, distance_loss: 3.625548839569092
class_loss: 1.1402491331100464, distance_loss: 3.8325252532958984
class_loss: 1.3067653179168701, distance_loss: 4.016554832458496
class_loss: 0.9985467791557312, distance_loss: 4.182098865509033
class_loss: 1.077372670173645, distance_loss: 4.336525917053223
class_loss: 0.9355506896972656, distance_loss: 4.478794097900391
class_loss: 0.9810250401496887, distance_loss: 4.613129138946533
class_loss: 0.886676549911499, distance_loss: 4.73914098739624
class_loss: 1.1070374250411987, distance_loss: 4.857425212860107
class_loss: 0.9182977676391602, distance_loss: 4.963443279266357
___PoisonTrain Local_Simple ,  epoch  58, local model 17, internal_epoch   2,  Average loss: 0.0172, Accuracy: 338/620 (54.5161%), train_poison_data_count: 200
Global model norm: 15.236213330590822.
Norm before scaling: 15.389285018602685. Distance: 5.064268203695855
Total norm for 3 adversaries is: 15.389285018602685. distance: 5.064268203695855
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 0.7474, Accuracy: 7072/8968 (78.8582%)
___Train Local_Simple,  epoch  58, local model 57, internal_epoch   1,  Average loss: 0.0010, Accuracy: 335/343 (97.6676%)
___Train Local_Simple,  epoch  58, local model 57, internal_epoch   2,  Average loss: 0.0016, Accuracy: 335/343 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.4100, Accuracy: 9094/10000 (90.9400%)
time spent on training: 50.30070209503174
Starting performing KrMLRFL...
Num data points: [557, 471, 686, 205, 276, 433, 256, 672, 620, 343]
Num selected data points: [557 686 205 433 343]
The chosen ones are users: [0, 2, 3, 5, 9], which are global users: [74, 75, 19, 83, 57]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 91, 17]
base_p: [-0.00106208  0.00016214  0.0004984  ... -0.00360106 -0.00791837
 -0.00067142]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 7, 8]
layer1_inf_time: 2.906982421875
[PAIRWISE] pred_attackers_indx:  [1 6 8]
layer2_inf_t: 45.24853515625
assumed final_attacker_idxs:  [1 4 6 7 8]
final_attacker_idxs is: [1 4 6 7 8]
g_attacker_idxs: [27 58 91 96 17]
g_normal_idxs: [74 75 19 83 57]
filtered_attacker_idxs: [1, 4, 6, 7, 8]
final_attacker_idxs are: [1, 4, 6, 7, 8]
num_dps: [557, 471, 686, 205, 276, 433, 256, 672, 620, 343]
___Test Local_Simple poisoned: False, epoch: 58: Average loss: 0.0359, Accuracy: 9882/10000 (98.8200%)
epoch_acc: 98.82
___Test Local_Simple poisoned: True, epoch: 58: Average loss: 13.3954, Accuracy: 31/8968 (0.3457%)
Done in 137.58775734901428 sec.
Server Epoch:59 choose agents : [77, 10, 78, 72, 91, 13, 98, 21, 82, 74].
___Train Local_Simple,  epoch  59, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 581/589 (98.6418%)
___Train Local_Simple,  epoch  59, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 584/589 (99.1511%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1280, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%)
___Train Local_Simple,  epoch  59, local model 10, internal_epoch   2,  Average loss: 0.0002, Accuracy: 887/892 (99.4395%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2844, Accuracy: 9209/10000 (92.0900%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch  59, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0669, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch  59, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch  59, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0807, Accuracy: 9736/10000 (97.3600%)
poison local model 91 index 0
___PoisonTrain Local_Simple ,  epoch  59, local model 91, internal_epoch   1,  Average loss: 0.0394, Accuracy: 140/256 (54.6875%), train_poison_data_count: 80
class_loss: 3.9342329502105713, distance_loss: 0.0
class_loss: 2.1330697536468506, distance_loss: 0.39474186301231384
class_loss: 1.9435343742370605, distance_loss: 0.924732506275177
class_loss: 2.087414264678955, distance_loss: 1.3133509159088135
___PoisonTrain Local_Simple ,  epoch  59, local model 91, internal_epoch   2,  Average loss: 0.0228, Accuracy: 120/256 (46.8750%), train_poison_data_count: 80
Global model norm: 15.210566833086434.
Norm before scaling: 14.996462595587646. Distance: 3.001094618416988
Total norm for 2 adversaries is: 14.996462595587646. distance: 3.001094618416988
class_loss: 1.5850533246994019, distance_loss: 1.6744906902313232
class_loss: 1.3640316724777222, distance_loss: 2.0350656509399414
class_loss: 1.47825288772583, distance_loss: 2.3829479217529297
class_loss: 1.396803379058838, distance_loss: 2.705049753189087
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 1.3117, Accuracy: 5068/8968 (56.5120%)
poison local model 13 index 1
class_loss: 4.00109338760376, distance_loss: 0.0
class_loss: 2.561913013458252, distance_loss: 0.36181533336639404
class_loss: 2.4628171920776367, distance_loss: 0.8368497490882874
class_loss: 1.41001558303833, distance_loss: 1.2445422410964966
class_loss: 1.1622185707092285, distance_loss: 1.6607279777526855
class_loss: 1.2978904247283936, distance_loss: 2.0447630882263184
class_loss: 1.1737475395202637, distance_loss: 2.380906581878662
class_loss: 1.2032948732376099, distance_loss: 2.678553581237793
class_loss: 1.1468565464019775, distance_loss: 2.9462196826934814
class_loss: 1.2180476188659668, distance_loss: 3.1859214305877686
class_loss: 1.1714038848876953, distance_loss: 3.400740146636963
class_loss: 1.023451328277588, distance_loss: 3.593519926071167
___PoisonTrain Local_Simple ,  epoch  59, local model 13, internal_epoch   1,  Average loss: 0.0270, Accuracy: 407/734 (55.4496%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  59, local model 13, internal_epoch   2,  Average loss: 0.0152, Accuracy: 387/734 (52.7248%), train_poison_data_count: 240
Global model norm: 15.210566833086434.
Norm before scaling: 15.340743444299827. Distance: 4.92791242122857
Total norm for 2 adversaries is: 15.340743444299827. distance: 4.92791242122857
class_loss: 0.9118052124977112, distance_loss: 3.7752010822296143
class_loss: 1.0988422632217407, distance_loss: 3.936962127685547
class_loss: 1.1072481870651245, distance_loss: 4.075159549713135
class_loss: 0.8266361951828003, distance_loss: 4.194231033325195
class_loss: 0.957922101020813, distance_loss: 4.3027424812316895
class_loss: 0.8899943232536316, distance_loss: 4.402777194976807
class_loss: 0.9283055663108826, distance_loss: 4.495744705200195
class_loss: 0.9993798136711121, distance_loss: 4.580740451812744
class_loss: 0.8891364932060242, distance_loss: 4.658002853393555
class_loss: 0.839357852935791, distance_loss: 4.7301483154296875
class_loss: 0.7450361251831055, distance_loss: 4.79749870300293
class_loss: 0.9339802265167236, distance_loss: 4.860846996307373
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 0.8965, Accuracy: 5995/8968 (66.8488%)
___Train Local_Simple,  epoch  59, local model 98, internal_epoch   1,  Average loss: 0.0004, Accuracy: 810/818 (99.0220%)
___Train Local_Simple,  epoch  59, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 815/818 (99.6333%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.2239, Accuracy: 9401/10000 (94.0100%)
___Train Local_Simple,  epoch  59, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 309/312 (99.0385%)
___Train Local_Simple,  epoch  59, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.1879, Accuracy: 9388/10000 (93.8800%)
___Train Local_Simple,  epoch  59, local model 82, internal_epoch   1,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Train Local_Simple,  epoch  59, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0712, Accuracy: 9776/10000 (97.7600%)
___Train Local_Simple,  epoch  59, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%)
___Train Local_Simple,  epoch  59, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0566, Accuracy: 9820/10000 (98.2000%)
time spent on training: 40.87190127372742
Starting performing KrMLRFL...
Num data points: [589, 892, 303, 731, 256, 734, 818, 312, 713, 557]
Num selected data points: [892 303 731 312 713 557]
The chosen ones are users: [1, 2, 3, 7, 8, 9], which are global users: [10, 78, 72, 21, 82, 74]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 13]
base_p: [-0.00043911  0.00034254  0.0003369  ...  0.0008841  -0.00194804
 -0.00059903]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 6]
layer1_inf_time: 3.35009765625
[PAIRWISE] pred_attackers_indx:  [4 5]
layer2_inf_t: 28.938232421875
assumed final_attacker_idxs:  [0 1 4 5 6]
final_attacker_idxs is: [0 1 4 5 6]
g_attacker_idxs: [77 10 91 13 98]
g_normal_idxs: [78 72 21 82 74]
filtered_attacker_idxs: [0, 4, 5, 6]
final_attacker_idxs are: [0, 4, 5, 6]
num_dps: [589, 892, 303, 731, 256, 734, 818, 312, 713, 557]
___Test Local_Simple poisoned: False, epoch: 59: Average loss: 0.0391, Accuracy: 9872/10000 (98.7200%)
epoch_acc: 98.72
___Test Local_Simple poisoned: True, epoch: 59: Average loss: 14.5348, Accuracy: 10/8968 (0.1115%)
Done in 128.75068521499634 sec.
Server Epoch:60 choose agents : [75, 86, 51, 0, 31, 32, 67, 17, 29, 7].
___Train Local_Simple,  epoch  60, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 680/686 (99.1254%)
___Train Local_Simple,  epoch  60, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.0539, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch  60, local model 86, internal_epoch   1,  Average loss: 0.0007, Accuracy: 245/250 (98.0000%)
___Train Local_Simple,  epoch  60, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1158, Accuracy: 9656/10000 (96.5600%)
poison local model 51 index 0
class_loss: 5.513786315917969, distance_loss: 0.0
class_loss: 1.970168113708496, distance_loss: 0.4926661550998688
class_loss: 1.7453113794326782, distance_loss: 1.1643097400665283
class_loss: 1.7559682130813599, distance_loss: 1.7091797590255737
class_loss: 1.1308856010437012, distance_loss: 2.211430311203003
class_loss: 1.287347435951233, distance_loss: 2.6852798461914062
class_loss: 1.13726007938385, distance_loss: 3.1287291049957275
class_loss: 0.8828780055046082, distance_loss: 3.535090923309326
class_loss: 0.7654436826705933, distance_loss: 3.9101133346557617
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   1,  Average loss: 0.0285, Accuracy: 332/568 (58.4507%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  60, local model 51, internal_epoch   2,  Average loss: 0.0138, Accuracy: 361/568 (63.5563%), train_poison_data_count: 180
Global model norm: 15.149674898694453.
Norm before scaling: 15.573204189270207. Distance: 6.085849746639484
Total norm for 3 adversaries is: 15.573204189270207. distance: 6.085849746639484
class_loss: 1.2949281930923462, distance_loss: 4.2498698234558105
class_loss: 0.7979124784469604, distance_loss: 4.5438971519470215
class_loss: 0.922858476638794, distance_loss: 4.809136867523193
class_loss: 0.9054527282714844, distance_loss: 5.047014236450195
class_loss: 0.7932112216949463, distance_loss: 5.262971878051758
class_loss: 0.9197680950164795, distance_loss: 5.4590935707092285
class_loss: 0.6883413791656494, distance_loss: 5.63734245300293
class_loss: 0.7926967144012451, distance_loss: 5.8005194664001465
class_loss: 0.711604118347168, distance_loss: 5.949847221374512
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.7728, Accuracy: 6020/8968 (67.1276%)
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   1,  Average loss: 0.0013, Accuracy: 422/435 (97.0115%)
___Train Local_Simple,  epoch  60, local model 0, internal_epoch   2,  Average loss: 0.0005, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1646, Accuracy: 9504/10000 (95.0400%)
___Train Local_Simple,  epoch  60, local model 31, internal_epoch   1,  Average loss: 0.0005, Accuracy: 829/835 (99.2814%)
___Train Local_Simple,  epoch  60, local model 31, internal_epoch   2,  Average loss: 0.0004, Accuracy: 824/835 (98.6826%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.0796, Accuracy: 9785/10000 (97.8500%)
___Train Local_Simple,  epoch  60, local model 32, internal_epoch   1,  Average loss: 0.0009, Accuracy: 960/977 (98.2600%)
___Train Local_Simple,  epoch  60, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 957/977 (97.9529%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1044, Accuracy: 9652/10000 (96.5200%)
___Train Local_Simple,  epoch  60, local model 67, internal_epoch   1,  Average loss: 0.0006, Accuracy: 985/998 (98.6974%)
___Train Local_Simple,  epoch  60, local model 67, internal_epoch   2,  Average loss: 0.0015, Accuracy: 972/998 (97.3948%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.1494, Accuracy: 9530/10000 (95.3000%)
poison local model 17 index 1
class_loss: 4.324076175689697, distance_loss: 0.0
class_loss: 2.932431936264038, distance_loss: 0.38439035415649414
class_loss: 1.715883731842041, distance_loss: 0.9484573006629944
class_loss: 1.7102549076080322, distance_loss: 1.385844111442566
class_loss: 1.4540495872497559, distance_loss: 1.7768945693969727
class_loss: 1.3304426670074463, distance_loss: 2.1446640491485596
class_loss: 1.289368748664856, distance_loss: 2.4785726070404053
class_loss: 1.2116868495941162, distance_loss: 2.778306722640991
class_loss: 1.0967206954956055, distance_loss: 3.0514683723449707
class_loss: 1.3541369438171387, distance_loss: 3.3031704425811768
___PoisonTrain Local_Simple ,  epoch  60, local model 17, internal_epoch   1,  Average loss: 0.0297, Accuracy: 321/620 (51.7742%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  60, local model 17, internal_epoch   2,  Average loss: 0.0160, Accuracy: 344/620 (55.4839%), train_poison_data_count: 200
Global model norm: 15.149674898694453.
Norm before scaling: 15.292271296356443. Distance: 4.945998398881986
Total norm for 3 adversaries is: 15.292271296356443. distance: 4.945998398881986
class_loss: 1.145405888557434, distance_loss: 3.5374066829681396
class_loss: 1.2869895696640015, distance_loss: 3.7448086738586426
class_loss: 0.9404088258743286, distance_loss: 3.925271987915039
class_loss: 1.0697234869003296, distance_loss: 4.090895175933838
class_loss: 1.131134271621704, distance_loss: 4.245104789733887
class_loss: 0.8379051685333252, distance_loss: 4.386729717254639
class_loss: 0.9865890741348267, distance_loss: 4.518770217895508
class_loss: 0.8388062119483948, distance_loss: 4.6387200355529785
class_loss: 0.764472484588623, distance_loss: 4.7476911544799805
class_loss: 0.9112735390663147, distance_loss: 4.846660137176514
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 1.1459, Accuracy: 3822/8968 (42.6182%)
___Train Local_Simple,  epoch  60, local model 29, internal_epoch   1,  Average loss: 0.0011, Accuracy: 982/1002 (98.0040%)
___Train Local_Simple,  epoch  60, local model 29, internal_epoch   2,  Average loss: 0.0003, Accuracy: 998/1002 (99.6008%)
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.2266, Accuracy: 9271/10000 (92.7100%)
poison local model 7 index 2
class_loss: 4.123239994049072, distance_loss: 0.0
class_loss: 2.545459747314453, distance_loss: 0.341722697019577
class_loss: 1.6296813488006592, distance_loss: 0.8364218473434448
class_loss: 1.279119610786438, distance_loss: 1.2934306859970093
class_loss: 0.9745308756828308, distance_loss: 1.681672215461731
class_loss: 1.1070529222488403, distance_loss: 2.0295937061309814
class_loss: 1.2115222215652466, distance_loss: 2.348090887069702
___PoisonTrain Local_Simple ,  epoch  60, local model 7, internal_epoch   1,  Average loss: 0.0308, Accuracy: 251/418 (60.0478%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  60, local model 7, internal_epoch   2,  Average loss: 0.0185, Accuracy: 240/418 (57.4163%), train_poison_data_count: 140
Global model norm: 15.149674898694453.
Norm before scaling: 15.020614192103059. Distance: 3.876863954224841
Total norm for 3 adversaries is: 15.020614192103059. distance: 3.876863954224841
class_loss: 1.2816370725631714, distance_loss: 2.6414432525634766
class_loss: 1.1616631746292114, distance_loss: 2.890352725982666
class_loss: 1.2000374794006348, distance_loss: 3.10734486579895
class_loss: 1.0329232215881348, distance_loss: 3.2943716049194336
class_loss: 1.0131757259368896, distance_loss: 3.4616894721984863
class_loss: 1.0775222778320312, distance_loss: 3.612834930419922
class_loss: 0.9492168426513672, distance_loss: 3.747713088989258
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 0.5351, Accuracy: 7568/8968 (84.3889%)
time spent on training: 48.61492395401001
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 17, 7]
base_p: [ 0.00073643  0.0003958  -0.0003601  ... -0.003602   -0.01908851
 -0.00132902]
[T_SCORE] attacker_local_idxs is:  [2, 5, 6, 7, 9]
layer1_inf_time: 2.697998046875
[PAIRWISE] pred_attackers_indx:  [2 7 9]
layer2_inf_t: 28.24658203125
assumed final_attacker_idxs:  [2 5 6 7 9]
final_attacker_idxs is: [2 5 6 7 9]
g_attacker_idxs: [51 32 67 17  7]
g_normal_idxs: [75 86  0 31 29]
filtered_attacker_idxs: [2, 5, 6, 7, 9]
final_attacker_idxs are: [2, 5, 6, 7, 9]
num_dps: [686, 250, 568, 435, 835, 977, 998, 620, 1002, 418]
Starting performing KrMLRFL...
Num data points: [686, 250, 568, 435, 835, 977, 998, 620, 1002, 418]
Num selected data points: [ 686  250  435  835 1002]
The chosen ones are users: [0, 1, 3, 4, 8], which are global users: [75, 86, 0, 31, 29]
___Test Local_Simple poisoned: False, epoch: 60: Average loss: 0.0428, Accuracy: 9863/10000 (98.6300%)
epoch_acc: 98.63
___Test Local_Simple poisoned: True, epoch: 60: Average loss: 13.1318, Accuracy: 15/8968 (0.1673%)
Done in 138.99590945243835 sec.
Server Epoch:61 choose agents : [36, 9, 6, 79, 4, 52, 48, 5, 87, 73].
___Train Local_Simple,  epoch  61, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 991/1005 (98.6070%)
___Train Local_Simple,  epoch  61, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 995/1005 (99.0050%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3047, Accuracy: 9031/10000 (90.3100%)
___Train Local_Simple,  epoch  61, local model 9, internal_epoch   1,  Average loss: 0.0009, Accuracy: 429/436 (98.3945%)
___Train Local_Simple,  epoch  61, local model 9, internal_epoch   2,  Average loss: 0.0008, Accuracy: 431/436 (98.8532%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0784, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch  61, local model 6, internal_epoch   1,  Average loss: 0.0004, Accuracy: 608/615 (98.8618%)
___Train Local_Simple,  epoch  61, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 613/615 (99.6748%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.1002, Accuracy: 9668/10000 (96.6800%)
___Train Local_Simple,  epoch  61, local model 79, internal_epoch   1,  Average loss: 0.0006, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch  61, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0519, Accuracy: 9839/10000 (98.3900%)
___Train Local_Simple,  epoch  61, local model 4, internal_epoch   1,  Average loss: 0.0009, Accuracy: 646/658 (98.1763%)
___Train Local_Simple,  epoch  61, local model 4, internal_epoch   2,  Average loss: 0.0008, Accuracy: 645/658 (98.0243%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.8505, Accuracy: 8050/10000 (80.5000%)
poison local model 52 index 0
class_loss: 4.48988151550293, distance_loss: 0.0
class_loss: 2.467615842819214, distance_loss: 0.32395505905151367
class_loss: 1.1868939399719238, distance_loss: 0.8517341613769531
class_loss: 1.9070568084716797, distance_loss: 1.2927690744400024
class_loss: 1.2710174322128296, distance_loss: 1.621872901916504
class_loss: 1.3564985990524292, distance_loss: 1.9347717761993408
class_loss: 1.1829144954681396, distance_loss: 2.229621410369873
class_loss: 1.286540150642395, distance_loss: 2.50588059425354
___PoisonTrain Local_Simple ,  epoch  61, local model 52, internal_epoch   1,  Average loss: 0.0397, Accuracy: 143/253 (56.5217%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  61, local model 52, internal_epoch   2,  Average loss: 0.0201, Accuracy: 121/253 (47.8261%), train_poison_data_count: 80
Global model norm: 15.088362780840406.
Norm before scaling: 14.853930000178247. Distance: 2.764419982806359
Total norm for 2 adversaries is: 14.853930000178247. distance: 2.764419982806359
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 1.6337, Accuracy: 2728/8968 (30.4193%)
___Train Local_Simple,  epoch  61, local model 48, internal_epoch   1,  Average loss: 0.0006, Accuracy: 440/448 (98.2143%)
___Train Local_Simple,  epoch  61, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0847, Accuracy: 9727/10000 (97.2700%)
___Train Local_Simple,  epoch  61, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 430/434 (99.0783%)
___Train Local_Simple,  epoch  61, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 431/434 (99.3088%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.3406, Accuracy: 9077/10000 (90.7700%)
___Train Local_Simple,  epoch  61, local model 87, internal_epoch   1,  Average loss: 0.0004, Accuracy: 466/470 (99.1489%)
___Train Local_Simple,  epoch  61, local model 87, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0729, Accuracy: 9763/10000 (97.6300%)
poison local model 73 index 1
class_loss: 3.627181053161621, distance_loss: 0.0
class_loss: 1.7044837474822998, distance_loss: 0.4474621117115021
class_loss: 1.703335165977478, distance_loss: 0.7658405900001526
class_loss: 1.1472969055175781, distance_loss: 1.0076123476028442
class_loss: 1.2710024118423462, distance_loss: 1.2965301275253296
class_loss: 1.0478841066360474, distance_loss: 1.5964614152908325
class_loss: 1.0542752742767334, distance_loss: 1.8826316595077515
class_loss: 1.0102733373641968, distance_loss: 2.1398231983184814
class_loss: 0.9855644106864929, distance_loss: 2.377284049987793
class_loss: 1.3253103494644165, distance_loss: 2.5954620838165283
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   1,  Average loss: 0.0252, Accuracy: 340/591 (57.5296%), train_poison_data_count: 195
___PoisonTrain Local_Simple ,  epoch  61, local model 73, internal_epoch   2,  Average loss: 0.0203, Accuracy: 278/591 (47.0389%), train_poison_data_count: 195
Global model norm: 15.088362780840406.
Norm before scaling: 15.074560884624727. Distance: 4.080807559930574
Total norm for 2 adversaries is: 15.074560884624727. distance: 4.080807559930574
class_loss: 1.26449453830719, distance_loss: 2.835597515106201
class_loss: 1.4712307453155518, distance_loss: 3.040926218032837
class_loss: 1.3866374492645264, distance_loss: 3.2061715126037598
class_loss: 1.1130826473236084, distance_loss: 3.348529815673828
class_loss: 0.9849296808242798, distance_loss: 3.4762394428253174
class_loss: 1.004449725151062, distance_loss: 3.5933802127838135
class_loss: 1.0967074632644653, distance_loss: 3.70274019241333
class_loss: 0.9830809831619263, distance_loss: 3.805083990097046
class_loss: 1.0744084119796753, distance_loss: 3.8984692096710205
class_loss: 1.6100505590438843, distance_loss: 3.982534170150757
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 0.9604, Accuracy: 6730/8968 (75.0446%)
time spent on training: 38.791985750198364
Starting performing KrMLRFL...
Num data points: [1005, 436, 615, 182, 658, 253, 448, 434, 470, 591]
Num selected data points: [436 182 448 434 470]
The chosen ones are users: [1, 3, 6, 7, 8], which are global users: [9, 79, 48, 5, 87]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 73]
base_p: [-0.00054105  0.00028802  0.00074062 ...  0.00334668 -0.00196077
 -0.00062908]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 9]
layer1_inf_time: 3.0732421875
[PAIRWISE] pred_attackers_indx:  [5 9]
layer2_inf_t: 28.5146484375
assumed final_attacker_idxs:  [0 2 4 5 9]
final_attacker_idxs is: [0 2 4 5 9]
g_attacker_idxs: [36  6  4 52 73]
g_normal_idxs: [ 9 79 48  5 87]
filtered_attacker_idxs: [0, 2, 4, 5, 9]
final_attacker_idxs are: [0, 2, 4, 5, 9]
num_dps: [1005, 436, 615, 182, 658, 253, 448, 434, 470, 591]
epoch_acc: 98.88
___Test Local_Simple poisoned: False, epoch: 61: Average loss: 0.0366, Accuracy: 9888/10000 (98.8800%)
___Test Local_Simple poisoned: True, epoch: 61: Average loss: 12.2838, Accuracy: 23/8968 (0.2565%)
Done in 127.46873497962952 sec.
Server Epoch:62 choose agents : [10, 31, 95, 82, 33, 30, 68, 11, 28, 70].
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Train Local_Simple,  epoch  62, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0890, Accuracy: 9696/10000 (96.9600%)
___Train Local_Simple,  epoch  62, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 832/835 (99.6407%)
___Train Local_Simple,  epoch  62, local model 31, internal_epoch   2,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0894, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch  62, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2003, Accuracy: 9432/10000 (94.3200%)
___Train Local_Simple,  epoch  62, local model 82, internal_epoch   1,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Train Local_Simple,  epoch  62, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.2706, Accuracy: 9175/10000 (91.7500%)
___Train Local_Simple,  epoch  62, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 614/623 (98.5554%)
___Train Local_Simple,  epoch  62, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 612/623 (98.2343%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.1322, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch  62, local model 30, internal_epoch   1,  Average loss: 0.0006, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch  62, local model 30, internal_epoch   2,  Average loss: 0.0005, Accuracy: 396/400 (99.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 1.2505, Accuracy: 8207/10000 (82.0700%)
___Train Local_Simple,  epoch  62, local model 68, internal_epoch   1,  Average loss: 0.0004, Accuracy: 489/494 (98.9879%)
___Train Local_Simple,  epoch  62, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0905, Accuracy: 9721/10000 (97.2100%)
poison local model 11 index 0
class_loss: 4.797501564025879, distance_loss: 0.0
class_loss: 3.0597665309906006, distance_loss: 0.33977749943733215
class_loss: 1.4668461084365845, distance_loss: 0.8415772914886475
class_loss: 1.3516939878463745, distance_loss: 1.3799595832824707
class_loss: 1.4143872261047363, distance_loss: 1.844599723815918
class_loss: 1.592731237411499, distance_loss: 2.2341699600219727
class_loss: 1.6617722511291504, distance_loss: 2.5651471614837646
class_loss: 1.6587653160095215, distance_loss: 2.8542232513427734
class_loss: 1.6687824726104736, distance_loss: 3.1066579818725586
class_loss: 1.616895318031311, distance_loss: 3.326841115951538
class_loss: 1.14278244972229, distance_loss: 3.523037910461426
class_loss: 1.5198676586151123, distance_loss: 3.7125332355499268
class_loss: 1.5066959857940674, distance_loss: 3.8828659057617188
class_loss: 1.6059904098510742, distance_loss: 4.031726360321045
class_loss: 1.2997435331344604, distance_loss: 4.158627033233643
class_loss: 1.1454335451126099, distance_loss: 4.270788669586182
class_loss: 1.2307566404342651, distance_loss: 4.376117706298828
class_loss: 1.117101788520813, distance_loss: 4.476974964141846
class_loss: 1.014021635055542, distance_loss: 4.575386047363281
class_loss: 1.068008303642273, distance_loss: 4.670640468597412
class_loss: 1.0168712139129639, distance_loss: 4.759972095489502
class_loss: 1.8769900798797607, distance_loss: 4.844306945800781
___PoisonTrain Local_Simple ,  epoch  62, local model 11, internal_epoch   1,  Average loss: 0.0332, Accuracy: 304/645 (47.1318%), train_poison_data_count: 205
___PoisonTrain Local_Simple ,  epoch  62, local model 11, internal_epoch   2,  Average loss: 0.0223, Accuracy: 298/645 (46.2016%), train_poison_data_count: 205
Global model norm: 15.072154136760465.
Norm before scaling: 15.2203009909745. Distance: 4.943459692532088
Total norm for 2 adversaries is: 15.2203009909745. distance: 4.943459692532088
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.8979, Accuracy: 5542/8968 (61.7975%)
___Train Local_Simple,  epoch  62, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 499/501 (99.6008%)
___Train Local_Simple,  epoch  62, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0430, Accuracy: 9866/10000 (98.6600%)
poison local model 70 index 1
class_loss: 3.6066977977752686, distance_loss: 0.0
class_loss: 2.3204522132873535, distance_loss: 0.299905389547348
class_loss: 1.867802619934082, distance_loss: 0.7581517100334167
class_loss: 1.5539848804473877, distance_loss: 1.1837486028671265
class_loss: 1.2558951377868652, distance_loss: 1.53684401512146
class_loss: 1.3760719299316406, distance_loss: 1.8679169416427612
class_loss: 1.4526491165161133, distance_loss: 2.1631059646606445
class_loss: 1.42620050907135, distance_loss: 2.420410394668579
class_loss: 1.4615095853805542, distance_loss: 2.6427738666534424
class_loss: 1.3860125541687012, distance_loss: 2.8362302780151367
class_loss: 1.2057368755340576, distance_loss: 3.0084738731384277
class_loss: 1.0787818431854248, distance_loss: 3.16418194770813
___PoisonTrain Local_Simple ,  epoch  62, local model 70, internal_epoch   1,  Average loss: 0.0276, Accuracy: 369/724 (50.9669%), train_poison_data_count: 240
___PoisonTrain Local_Simple ,  epoch  62, local model 70, internal_epoch   2,  Average loss: 0.0180, Accuracy: 379/724 (52.3481%), train_poison_data_count: 240
Global model norm: 15.072154136760465.
Norm before scaling: 15.183953518698871. Distance: 4.430471737718861
Total norm for 2 adversaries is: 15.183953518698871. distance: 4.430471737718861
class_loss: 1.4045929908752441, distance_loss: 3.327439069747925
class_loss: 1.1299998760223389, distance_loss: 3.472949743270874
class_loss: 1.1840925216674805, distance_loss: 3.5976877212524414
class_loss: 0.9827179908752441, distance_loss: 3.7078003883361816
class_loss: 1.1831300258636475, distance_loss: 3.808689832687378
class_loss: 1.1154357194900513, distance_loss: 3.9018335342407227
class_loss: 1.2226091623306274, distance_loss: 3.9883134365081787
class_loss: 1.0927938222885132, distance_loss: 4.070868492126465
class_loss: 0.9129559397697449, distance_loss: 4.149075984954834
class_loss: 0.8427796363830566, distance_loss: 4.223355293273926
class_loss: 1.0115193128585815, distance_loss: 4.291686534881592
class_loss: 0.950733482837677, distance_loss: 4.351672172546387
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 0.7333, Accuracy: 6769/8968 (75.4795%)
time spent on training: 40.00178027153015
Starting performing KrMLRFL...
Num data points: [892, 835, 602, 713, 623, 400, 494, 645, 501, 724]
Num selected data points: [892 713 400 494 501]
The chosen ones are users: [0, 3, 5, 6, 8], which are global users: [10, 82, 30, 68, 28]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 70]
base_p: [-0.00089834  0.00033766 -0.00146682 ... -0.00031713 -0.00934713
 -0.00102318]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 7, 9]
layer1_inf_time: 2.92529296875
[PAIRWISE] pred_attackers_indx:  [7 9]
layer2_inf_t: 27.651123046875
assumed final_attacker_idxs:  [1 2 4 7 9]
final_attacker_idxs is: [1 2 4 7 9]
g_attacker_idxs: [31 95 33 11 70]
g_normal_idxs: [10 82 30 68 28]
filtered_attacker_idxs: [1, 2, 4, 7, 9]
final_attacker_idxs are: [1, 2, 4, 7, 9]
num_dps: [892, 835, 602, 713, 623, 400, 494, 645, 501, 724]
epoch_acc: 98.87
___Test Local_Simple poisoned: False, epoch: 62: Average loss: 0.0357, Accuracy: 9887/10000 (98.8700%)
___Test Local_Simple poisoned: True, epoch: 62: Average loss: 14.4054, Accuracy: 7/8968 (0.0781%)
class_loss: 4.189188003540039, distance_loss: 0.0
class_loss: 2.7072060108184814, distance_loss: 0.3585982918739319
class_loss: 1.3817378282546997, distance_loss: 0.9076789617538452
class_loss: 1.6352012157440186, distance_loss: 1.4232405424118042
class_loss: 1.6859935522079468, distance_loss: 1.8342299461364746
class_loss: 1.4211803674697876, distance_loss: 2.2075796127319336
class_loss: 1.418818473815918, distance_loss: 2.5582737922668457
class_loss: 1.3545714616775513, distance_loss: 2.8759093284606934
class_loss: 1.4267780780792236, distance_loss: 3.161217451095581
class_loss: 1.2527529001235962, distance_loss: 3.416579246520996
class_loss: 1.1831228733062744, distance_loss: 3.6492652893066406
class_loss: 1.2624787092208862, distance_loss: 3.864384174346924
class_loss: 1.0571224689483643, distance_loss: 4.0624189376831055
class_loss: 0.9536344408988953, distance_loss: 4.2419114112854
Done in 122.77642583847046 sec.
Server Epoch:63 choose agents : [63, 99, 35, 31, 85, 62, 21, 81, 52, 26].
poison local model 63 index 0
___PoisonTrain Local_Simple ,  epoch  63, local model 63, internal_epoch   1,  Average loss: 0.0258, Accuracy: 458/889 (51.5186%), train_poison_data_count: 280
class_loss: 1.0645265579223633, distance_loss: 4.4094672203063965
class_loss: 1.072070837020874, distance_loss: 4.56280517578125
class_loss: 0.987060546875, distance_loss: 4.700821399688721
class_loss: 0.9250321984291077, distance_loss: 4.828149795532227
class_loss: 0.8760407567024231, distance_loss: 4.940760612487793
class_loss: 0.9517098069190979, distance_loss: 5.0440521240234375
class_loss: 0.9505640268325806, distance_loss: 5.136758804321289
class_loss: 0.9737584590911865, distance_loss: 5.223978519439697
class_loss: 0.857909083366394, distance_loss: 5.304324150085449
class_loss: 0.8434354066848755, distance_loss: 5.378753185272217
class_loss: 0.7530648708343506, distance_loss: 5.449469566345215
class_loss: 0.7149041891098022, distance_loss: 5.517306804656982
class_loss: 0.8134490251541138, distance_loss: 5.578625679016113
class_loss: 0.8601700067520142, distance_loss: 5.637136459350586
___PoisonTrain Local_Simple ,  epoch  63, local model 63, internal_epoch   2,  Average loss: 0.0142, Accuracy: 510/889 (57.3678%), train_poison_data_count: 280
Global model norm: 15.027226470656208.
Norm before scaling: 15.428376625486285. Distance: 5.6913020242901755
Total norm for 5 adversaries is: 15.428376625486285. distance: 5.6913020242901755
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 1.0318, Accuracy: 4810/8968 (53.6351%)
___Train Local_Simple,  epoch  63, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch  63, local model 99, internal_epoch   2,  Average loss: 0.0003, Accuracy: 375/377 (99.4695%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0522, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch  63, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch  63, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1008, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  63, local model 31, internal_epoch   1,  Average loss: 0.0011, Accuracy: 825/835 (98.8024%)
___Train Local_Simple,  epoch  63, local model 31, internal_epoch   2,  Average loss: 0.0040, Accuracy: 774/835 (92.6946%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.4122, Accuracy: 8830/10000 (88.3000%)
poison local model 85 index 1
class_loss: 5.478402614593506, distance_loss: 0.0
class_loss: 2.9512317180633545, distance_loss: 0.3816598653793335
class_loss: 1.3283134698867798, distance_loss: 0.9405309557914734
class_loss: 1.207124948501587, distance_loss: 1.4882601499557495
class_loss: 1.3147335052490234, distance_loss: 1.9701191186904907
class_loss: 1.2214897871017456, distance_loss: 2.38958740234375
class_loss: 1.236405611038208, distance_loss: 2.7551934719085693
___PoisonTrain Local_Simple ,  epoch  63, local model 85, internal_epoch   1,  Average loss: 0.0342, Accuracy: 258/431 (59.8608%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  63, local model 85, internal_epoch   2,  Average loss: 0.0210, Accuracy: 179/431 (41.5313%), train_poison_data_count: 140
Global model norm: 15.027226470656208.
Norm before scaling: 14.92153754526804. Distance: 4.47495889484984
Total norm for 5 adversaries is: 14.92153754526804. distance: 4.47495889484984
class_loss: 1.3484681844711304, distance_loss: 3.075594425201416
class_loss: 1.3802144527435303, distance_loss: 3.3539700508117676
class_loss: 1.3875280618667603, distance_loss: 3.600541353225708
class_loss: 1.310723066329956, distance_loss: 3.81831693649292
class_loss: 1.3101223707199097, distance_loss: 4.012148857116699
class_loss: 1.3173871040344238, distance_loss: 4.1826629638671875
class_loss: 0.9816625714302063, distance_loss: 4.335784435272217
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.8492, Accuracy: 7314/8968 (81.5566%)
___Train Local_Simple,  epoch  63, local model 62, internal_epoch   1,  Average loss: 0.0004, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch  63, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0868, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 308/312 (98.7179%)
___Train Local_Simple,  epoch  63, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.1428, Accuracy: 9516/10000 (95.1600%)
poison local model 81 index 2
class_loss: 4.791049480438232, distance_loss: 0.0
class_loss: 2.9473228454589844, distance_loss: 0.3643796443939209
class_loss: 1.5564002990722656, distance_loss: 0.9227805137634277
class_loss: 1.4450701475143433, distance_loss: 1.4916143417358398
class_loss: 1.8007688522338867, distance_loss: 1.9663630723953247
class_loss: 1.5015041828155518, distance_loss: 2.3822999000549316
class_loss: 1.3613399267196655, distance_loss: 2.7571215629577637
class_loss: 1.3619098663330078, distance_loss: 3.096946954727173
class_loss: 1.3495701551437378, distance_loss: 3.399384021759033
class_loss: 1.2011908292770386, distance_loss: 3.6727235317230225
class_loss: 1.1204860210418701, distance_loss: 3.9212472438812256
class_loss: 0.9146524667739868, distance_loss: 4.146265983581543
class_loss: 0.9988663792610168, distance_loss: 4.352685928344727
class_loss: 1.321213722229004, distance_loss: 4.541033744812012
class_loss: 0.9898205995559692, distance_loss: 4.706907272338867
class_loss: 0.9521788954734802, distance_loss: 4.857707500457764
class_loss: 0.919309675693512, distance_loss: 4.995813846588135
class_loss: 0.6903815865516663, distance_loss: 5.12222957611084
class_loss: 0.8240330815315247, distance_loss: 5.239871501922607
class_loss: 1.8417530059814453, distance_loss: 5.349009990692139
___PoisonTrain Local_Simple ,  epoch  63, local model 81, internal_epoch   1,  Average loss: 0.0244, Accuracy: 613/1227 (49.9593%), train_poison_data_count: 391
___PoisonTrain Local_Simple ,  epoch  63, local model 81, internal_epoch   2,  Average loss: 0.0137, Accuracy: 730/1227 (59.4947%), train_poison_data_count: 391
Global model norm: 15.027226470656208.
Norm before scaling: 15.774186712178352. Distance: 6.547387733502004
Total norm for 5 adversaries is: 15.774186712178352. distance: 6.547387733502004
class_loss: 0.8849495649337769, distance_loss: 5.462820053100586
class_loss: 0.9512393474578857, distance_loss: 5.573616027832031
class_loss: 1.005695104598999, distance_loss: 5.673603057861328
class_loss: 1.0504249334335327, distance_loss: 5.761514186859131
class_loss: 0.8769646286964417, distance_loss: 5.839780330657959
class_loss: 0.8642382621765137, distance_loss: 5.91094970703125
class_loss: 0.8668714761734009, distance_loss: 5.975314617156982
class_loss: 1.0204423666000366, distance_loss: 6.033017635345459
class_loss: 0.9261410236358643, distance_loss: 6.081857681274414
class_loss: 0.7974856495857239, distance_loss: 6.125726222991943
class_loss: 0.8453777432441711, distance_loss: 6.165920734405518
class_loss: 0.731238842010498, distance_loss: 6.204221248626709
class_loss: 0.7679518461227417, distance_loss: 6.24101448059082
class_loss: 0.7945777773857117, distance_loss: 6.278024673461914
class_loss: 0.7151325941085815, distance_loss: 6.314204692840576
class_loss: 0.7558411955833435, distance_loss: 6.349409103393555
class_loss: 0.6928542256355286, distance_loss: 6.3844475746154785
class_loss: 0.570076048374176, distance_loss: 6.4195966720581055
class_loss: 0.5643870234489441, distance_loss: 6.4549360275268555
class_loss: 1.102219820022583, distance_loss: 6.491464614868164
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.1519, Accuracy: 8496/8968 (94.7368%)
poison local model 52 index 3
class_loss: 4.636259078979492, distance_loss: 0.0
class_loss: 2.4576079845428467, distance_loss: 0.3924921751022339
class_loss: 1.8848259449005127, distance_loss: 1.0300319194793701
class_loss: 1.7705788612365723, distance_loss: 1.4860655069351196
___PoisonTrain Local_Simple ,  epoch  63, local model 52, internal_epoch   1,  Average loss: 0.0425, Accuracy: 145/253 (57.3123%), train_poison_data_count: 80
___PoisonTrain Local_Simple ,  epoch  63, local model 52, internal_epoch   2,  Average loss: 0.0205, Accuracy: 115/253 (45.4545%), train_poison_data_count: 80
Global model norm: 15.027226470656208.
Norm before scaling: 14.850650123211146. Distance: 3.2707453106417446
Total norm for 5 adversaries is: 14.850650123211146. distance: 3.2707453106417446
class_loss: 1.320373296737671, distance_loss: 1.893214225769043
class_loss: 1.374441385269165, distance_loss: 2.284571886062622
class_loss: 1.3363703489303589, distance_loss: 2.643071413040161
class_loss: 1.1540343761444092, distance_loss: 2.970560073852539
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 1.1977, Accuracy: 5528/8968 (61.6414%)
poison local model 26 index 0
class_loss: 2.93648362159729, distance_loss: 0.0
class_loss: 2.386979579925537, distance_loss: 0.21890689432621002
class_loss: 1.658432126045227, distance_loss: 0.5777802467346191
class_loss: 0.9077629446983337, distance_loss: 1.0328408479690552
class_loss: 0.5919728875160217, distance_loss: 1.4492796659469604
class_loss: 0.8376221656799316, distance_loss: 1.7993628978729248
class_loss: 0.9184479117393494, distance_loss: 2.1105144023895264
class_loss: 0.7912424802780151, distance_loss: 2.378303289413452
class_loss: 0.985009491443634, distance_loss: 2.6141114234924316
class_loss: 1.1295676231384277, distance_loss: 2.817506790161133
class_loss: 1.2163950204849243, distance_loss: 2.991960048675537
class_loss: 0.888534426689148, distance_loss: 3.143432378768921
class_loss: 0.8921536803245544, distance_loss: 3.2756056785583496
class_loss: 0.762043833732605, distance_loss: 3.391371488571167
class_loss: 0.7085269689559937, distance_loss: 3.493347644805908
class_loss: 0.7712730765342712, distance_loss: 3.587045431137085
___PoisonTrain Local_Simple ,  epoch  63, local model 26, internal_epoch   1,  Average loss: 0.0217, Accuracy: 402/554 (72.5632%), train_poison_data_count: 180
___PoisonTrain Local_Simple ,  epoch  63, local model 26, internal_epoch   2,  Average loss: 0.0144, Accuracy: 335/554 (60.4693%), train_poison_data_count: 180
Global model norm: 15.027226470656208.
Norm before scaling: 14.910652070450025. Distance: 3.8303506414794626
Total norm for 5 adversaries is: 14.910652070450025. distance: 3.8303506414794626
class_loss: 0.7390022873878479, distance_loss: 3.6709132194519043
class_loss: 0.8601844310760498, distance_loss: 3.751706600189209
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 0.6993, Accuracy: 7359/8968 (82.0584%)
time spent on training: 59.40274000167847
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 85, 81, 52, 26]
base_p: [-0.00588252  0.0004068  -0.00021445 ... -0.00454317 -0.00563908
 -0.00240599]
[T_SCORE] attacker_local_idxs is:  [0, 4, 7, 8, 9]
layer1_inf_time: 2.98486328125
[PAIRWISE] pred_attackers_indx:  [0 4 7 8 9]
layer2_inf_t: 27.073486328125
assumed final_attacker_idxs:  [0 4 7 8 9]
final_attacker_idxs is: [0 4 7 8 9]
g_attacker_idxs: [63 85 81 52 26]
g_normal_idxs: [99 35 31 62 21]
filtered_attacker_idxs: [0, 4, 7, 8, 9]
final_attacker_idxs are: [0, 4, 7, 8, 9]
num_dps: [889, 377, 499, 835, 431, 423, 312, 1227, 253, 554]
epoch_acc: 97.94
Starting performing KrMLRFL...
Num data points: [889, 377, 499, 835, 431, 423, 312, 1227, 253, 554]
Num selected data points: [377 499 835 423 312]
The chosen ones are users: [1, 2, 3, 5, 6], which are global users: [99, 35, 31, 62, 21]
___Test Local_Simple poisoned: False, epoch: 63: Average loss: 0.0678, Accuracy: 9794/10000 (97.9400%)
___Test Local_Simple poisoned: True, epoch: 63: Average loss: 12.3521, Accuracy: 19/8968 (0.2119%)
Done in 149.05474209785461 sec.
Server Epoch:64 choose agents : [27, 54, 48, 85, 16, 43, 52, 29, 93, 78].
poison local model 27 index 0
class_loss: 3.9041476249694824, distance_loss: 0.0
class_loss: 2.2896313667297363, distance_loss: 0.34618449211120605
class_loss: 1.6519325971603394, distance_loss: 0.8239970207214355
class_loss: 1.8012810945510864, distance_loss: 1.274489402770996
class_loss: 1.322697639465332, distance_loss: 1.642030119895935
class_loss: 1.5160478353500366, distance_loss: 1.9790310859680176
class_loss: 1.4684988260269165, distance_loss: 2.283510684967041
class_loss: 1.761024832725525, distance_loss: 2.5528483390808105
class_loss: 1.4020682573318481, distance_loss: 2.810699701309204
class_loss: 1.2126926183700562, distance_loss: 3.044621467590332
class_loss: 1.102843165397644, distance_loss: 3.260176420211792
class_loss: 1.2886419296264648, distance_loss: 3.4591426849365234
class_loss: 1.086039662361145, distance_loss: 3.633072853088379
class_loss: 0.9856184124946594, distance_loss: 3.789588212966919
class_loss: 0.89690762758255, distance_loss: 3.931690216064453
class_loss: 0.9307248592376709, distance_loss: 4.065212726593018
___PoisonTrain Local_Simple ,  epoch  64, local model 27, internal_epoch   1,  Average loss: 0.0334, Accuracy: 234/471 (49.6815%), train_poison_data_count: 160
___PoisonTrain Local_Simple ,  epoch  64, local model 27, internal_epoch   2,  Average loss: 0.0189, Accuracy: 232/471 (49.2569%), train_poison_data_count: 160
Global model norm: 15.222496871759974.
Norm before scaling: 15.304051400129723. Distance: 4.21706531937044
Total norm for 5 adversaries is: 15.304051400129723. distance: 4.21706531937044
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.8038, Accuracy: 6027/8968 (67.2056%)
___Train Local_Simple,  epoch  64, local model 54, internal_epoch   1,  Average loss: 0.0009, Accuracy: 512/519 (98.6513%)
___Train Local_Simple,  epoch  64, local model 54, internal_epoch   2,  Average loss: 0.0004, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1762, Accuracy: 9414/10000 (94.1400%)
___Train Local_Simple,  epoch  64, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch  64, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
class_loss: 3.7300446033477783, distance_loss: 0.0
class_loss: 2.0279152393341064, distance_loss: 0.3587248623371124
class_loss: 1.3269773721694946, distance_loss: 0.7997556328773499
class_loss: 2.0066349506378174, distance_loss: 1.2403931617736816
class_loss: 1.4087401628494263, distance_loss: 1.5998179912567139
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1017, Accuracy: 9688/10000 (96.8800%)
poison local model 85 index 1
___PoisonTrain Local_Simple ,  epoch  64, local model 85, internal_epoch   1,  Average loss: 0.0303, Accuracy: 242/431 (56.1485%), train_poison_data_count: 140
class_loss: 1.3098520040512085, distance_loss: 1.9282844066619873
class_loss: 1.269260287284851, distance_loss: 2.234365224838257
class_loss: 1.2961211204528809, distance_loss: 2.514904499053955
class_loss: 1.0469223260879517, distance_loss: 2.7749552726745605
class_loss: 1.2420028448104858, distance_loss: 3.0151681900024414
class_loss: 0.8867841362953186, distance_loss: 3.2302088737487793
class_loss: 0.9702995419502258, distance_loss: 3.42620587348938
class_loss: 1.0805561542510986, distance_loss: 3.6017301082611084
class_loss: 0.9107761979103088, distance_loss: 3.7628402709960938
___PoisonTrain Local_Simple ,  epoch  64, local model 85, internal_epoch   2,  Average loss: 0.0172, Accuracy: 233/431 (54.0603%), train_poison_data_count: 140
Global model norm: 15.222496871759974.
Norm before scaling: 15.243095961362465. Distance: 3.9175880376469965
Total norm for 5 adversaries is: 15.243095961362465. distance: 3.9175880376469965
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 1.0565, Accuracy: 5380/8968 (59.9911%)
class_loss: 3.394247055053711, distance_loss: 0.0
class_loss: 2.4407169818878174, distance_loss: 0.3106346130371094
class_loss: 1.0914875268936157, distance_loss: 0.8215578198432922
class_loss: 1.7115880250930786, distance_loss: 1.2603880167007446
class_loss: 1.5399161577224731, distance_loss: 1.6162183284759521
class_loss: 1.4923115968704224, distance_loss: 1.935958981513977
class_loss: 1.392604112625122, distance_loss: 2.230799436569214
class_loss: 1.310804843902588, distance_loss: 2.499321460723877
class_loss: 1.2786568403244019, distance_loss: 2.742682695388794
class_loss: 0.993206262588501, distance_loss: 2.969313621520996
class_loss: 1.3912428617477417, distance_loss: 3.1812827587127686
class_loss: 1.224077820777893, distance_loss: 3.363727331161499
class_loss: 1.1260088682174683, distance_loss: 3.523399829864502
class_loss: 0.9195937514305115, distance_loss: 3.6710286140441895
class_loss: 0.9813552498817444, distance_loss: 3.8142077922821045
poison local model 16 index 2
___PoisonTrain Local_Simple ,  epoch  64, local model 16, internal_epoch   1,  Average loss: 0.0244, Accuracy: 490/915 (53.5519%), train_poison_data_count: 299
class_loss: 1.5052247047424316, distance_loss: 3.9766688346862793
class_loss: 1.3598129749298096, distance_loss: 4.103034973144531
class_loss: 1.128510594367981, distance_loss: 4.204198360443115
class_loss: 0.9063469171524048, distance_loss: 4.296651840209961
class_loss: 1.0473886728286743, distance_loss: 4.3922200202941895
class_loss: 1.083512544631958, distance_loss: 4.488662242889404
class_loss: 0.9010425806045532, distance_loss: 4.583199977874756
class_loss: 1.0593435764312744, distance_loss: 4.675051212310791
class_loss: 0.8329133987426758, distance_loss: 4.760379314422607
class_loss: 1.0399086475372314, distance_loss: 4.841943264007568
class_loss: 0.7814538478851318, distance_loss: 4.917978286743164
class_loss: 0.8859590291976929, distance_loss: 4.989377021789551
class_loss: 0.8634684681892395, distance_loss: 5.053787708282471
class_loss: 0.6592790484428406, distance_loss: 5.1092610359191895
class_loss: 1.1555604934692383, distance_loss: 5.163254261016846
___PoisonTrain Local_Simple ,  epoch  64, local model 16, internal_epoch   2,  Average loss: 0.0166, Accuracy: 501/915 (54.7541%), train_poison_data_count: 299
Global model norm: 15.222496871759974.
Norm before scaling: 15.657648020322858. Distance: 5.244165539105158
Total norm for 5 adversaries is: 15.657648020322858. distance: 5.244165539105158
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 0.3046, Accuracy: 7889/8968 (87.9683%)
___Train Local_Simple,  epoch  64, local model 43, internal_epoch   1,  Average loss: 0.0006, Accuracy: 403/408 (98.7745%)
___Train Local_Simple,  epoch  64, local model 43, internal_epoch   2,  Average loss: 0.0006, Accuracy: 404/408 (99.0196%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0800, Accuracy: 9731/10000 (97.3100%)
poison local model 52 index 3
___PoisonTrain Local_Simple ,  epoch  64, local model 52, internal_epoch   1,  Average loss: 0.0344, Accuracy: 143/253 (56.5217%), train_poison_data_count: 80
class_loss: 3.9392998218536377, distance_loss: 0.0
class_loss: 1.8118224143981934, distance_loss: 0.3586635887622833
class_loss: 1.2050585746765137, distance_loss: 0.8662903308868408
class_loss: 1.744865894317627, distance_loss: 1.2833755016326904
class_loss: 1.3094509840011597, distance_loss: 1.6116892099380493
class_loss: 1.0949724912643433, distance_loss: 1.9170273542404175
class_loss: 1.2922706604003906, distance_loss: 2.213165044784546
class_loss: 1.0615947246551514, distance_loss: 2.4893858432769775
___PoisonTrain Local_Simple ,  epoch  64, local model 52, internal_epoch   2,  Average loss: 0.0188, Accuracy: 130/253 (51.3834%), train_poison_data_count: 80
Global model norm: 15.222496871759974.
Norm before scaling: 15.07258287476309. Distance: 2.74349483615618
Total norm for 5 adversaries is: 15.07258287476309. distance: 2.74349483615618
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 1.2827, Accuracy: 5185/8968 (57.8167%)
___Train Local_Simple,  epoch  64, local model 29, internal_epoch   1,  Average loss: 0.0005, Accuracy: 995/1002 (99.3014%)
___Train Local_Simple,  epoch  64, local model 29, internal_epoch   2,  Average loss: 0.0006, Accuracy: 990/1002 (98.8024%)
class_loss: 4.637838840484619, distance_loss: 0.0
class_loss: 1.6975955963134766, distance_loss: 0.43182551860809326
class_loss: 1.6473325490951538, distance_loss: 0.9926703572273254
class_loss: 1.7373489141464233, distance_loss: 1.4947535991668701
class_loss: 1.5545152425765991, distance_loss: 1.9242419004440308
class_loss: 1.6597990989685059, distance_loss: 2.2951579093933105
class_loss: 1.63307523727417, distance_loss: 2.6177306175231934
class_loss: 1.645556926727295, distance_loss: 2.9024288654327393
class_loss: 1.5114420652389526, distance_loss: 3.157175064086914
class_loss: 1.270743727684021, distance_loss: 3.3866705894470215
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1242, Accuracy: 9600/10000 (96.0000%)
poison local model 93 index 0
___PoisonTrain Local_Simple ,  epoch  64, local model 93, internal_epoch   1,  Average loss: 0.0305, Accuracy: 294/623 (47.1910%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  64, local model 93, internal_epoch   2,  Average loss: 0.0158, Accuracy: 343/623 (55.0562%), train_poison_data_count: 200
Global model norm: 15.222496871759974.
Norm before scaling: 15.509137813330907. Distance: 5.088945802891364
Total norm for 5 adversaries is: 15.509137813330907. distance: 5.088945802891364
class_loss: 1.192407250404358, distance_loss: 3.6012775897979736
class_loss: 1.1846052408218384, distance_loss: 3.7992701530456543
class_loss: 0.9676479697227478, distance_loss: 3.9763400554656982
class_loss: 0.9186914563179016, distance_loss: 4.141793251037598
class_loss: 1.0434114933013916, distance_loss: 4.300229549407959
class_loss: 0.8361769318580627, distance_loss: 4.447208404541016
class_loss: 0.8936346769332886, distance_loss: 4.588902950286865
class_loss: 0.8119232654571533, distance_loss: 4.7256855964660645
class_loss: 0.8689467906951904, distance_loss: 4.856241226196289
class_loss: 1.0948865413665771, distance_loss: 4.9773454666137695
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 1.1478, Accuracy: 3920/8968 (43.7110%)
___Train Local_Simple,  epoch  64, local model 78, internal_epoch   1,  Average loss: 0.0010, Accuracy: 296/303 (97.6898%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 85, 16, 52, 93]
base_p: [-8.1023872e-03  1.5448779e-05 -2.7170926e-03 ... -3.6604702e-03
 -2.7688220e-03 -3.0678436e-03]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 8]
layer1_inf_time: 2.324462890625
[PAIRWISE] pred_attackers_indx:  [0 3 4 6 8]
layer2_inf_t: 26.75439453125
assumed final_attacker_idxs:  [0 3 4 6 8]
final_attacker_idxs is: [0 3 4 6 8]
g_attacker_idxs: [27 85 16 52 93]
g_normal_idxs: [54 48 43 29 78]
filtered_attacker_idxs: [0, 3, 4, 6, 8]
final_attacker_idxs are: [0, 3, 4, 6, 8]
num_dps: [471, 519, 448, 431, 915, 408, 253, 1002, 623, 303]
___Train Local_Simple,  epoch  64, local model 78, internal_epoch   2,  Average loss: 0.0007, Accuracy: 298/303 (98.3498%)
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.1666, Accuracy: 9489/10000 (94.8900%)
time spent on training: 57.88220000267029
Starting performing KrMLRFL...
Num data points: [471, 519, 448, 431, 915, 408, 253, 1002, 623, 303]
Num selected data points: [ 519  448  408 1002  303]
The chosen ones are users: [1, 2, 5, 7, 9], which are global users: [54, 48, 43, 29, 78]
epoch_acc: 98.5
___Test Local_Simple poisoned: False, epoch: 64: Average loss: 0.0465, Accuracy: 9850/10000 (98.5000%)
___Test Local_Simple poisoned: True, epoch: 64: Average loss: 12.1787, Accuracy: 30/8968 (0.3345%)
Done in 140.60973930358887 sec.
Server Epoch:65 choose agents : [5, 85, 24, 0, 35, 65, 46, 29, 45, 69].
___Train Local_Simple,  epoch  65, local model 5, internal_epoch   1,  Average loss: 0.0009, Accuracy: 428/434 (98.6175%)
___Train Local_Simple,  epoch  65, local model 5, internal_epoch   2,  Average loss: 0.0004, Accuracy: 432/434 (99.5392%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.2339, Accuracy: 9133/10000 (91.3300%)
poison local model 85 index 0
class_loss: 4.531806468963623, distance_loss: 0.0
class_loss: 2.044710636138916, distance_loss: 0.3913155496120453
class_loss: 1.5927313566207886, distance_loss: 0.9068371653556824
class_loss: 1.3577773571014404, distance_loss: 1.3561500310897827
class_loss: 1.5295244455337524, distance_loss: 1.765559196472168
class_loss: 1.2204066514968872, distance_loss: 2.1317930221557617
class_loss: 1.2709174156188965, distance_loss: 2.455864906311035
class_loss: 1.2308642864227295, distance_loss: 2.751042604446411
class_loss: 1.2133456468582153, distance_loss: 3.0167486667633057
class_loss: 1.4564484357833862, distance_loss: 3.2493937015533447
class_loss: 1.304368257522583, distance_loss: 3.4488821029663086
class_loss: 1.1297253370285034, distance_loss: 3.624537706375122
class_loss: 1.0090765953063965, distance_loss: 3.782299041748047
class_loss: 1.003940224647522, distance_loss: 3.9295525550842285
___PoisonTrain Local_Simple ,  epoch  65, local model 85, internal_epoch   1,  Average loss: 0.0314, Accuracy: 232/431 (53.8283%), train_poison_data_count: 140
___PoisonTrain Local_Simple ,  epoch  65, local model 85, internal_epoch   2,  Average loss: 0.0194, Accuracy: 213/431 (49.4200%), train_poison_data_count: 140
Global model norm: 15.209974951087043.
Norm before scaling: 15.182712381159812. Distance: 4.070647066684105
Total norm for 2 adversaries is: 15.182712381159812. distance: 4.070647066684105
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.9512, Accuracy: 5288/8968 (58.9652%)
___Train Local_Simple,  epoch  65, local model 24, internal_epoch   1,  Average loss: 0.0009, Accuracy: 372/379 (98.1530%)
___Train Local_Simple,  epoch  65, local model 24, internal_epoch   2,  Average loss: 0.0006, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1004, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  65, local model 0, internal_epoch   1,  Average loss: 0.0010, Accuracy: 427/435 (98.1609%)
___Train Local_Simple,  epoch  65, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1344, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  65, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch  65, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1016, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  65, local model 65, internal_epoch   1,  Average loss: 0.0004, Accuracy: 368/371 (99.1914%)
___Train Local_Simple,  epoch  65, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0691, Accuracy: 9792/10000 (97.9200%)
___Train Local_Simple,  epoch  65, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 700/710 (98.5915%)
___Train Local_Simple,  epoch  65, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 706/710 (99.4366%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1512, Accuracy: 9505/10000 (95.0500%)
___Train Local_Simple,  epoch  65, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 997/1002 (99.5010%)
___Train Local_Simple,  epoch  65, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0948, Accuracy: 9708/10000 (97.0800%)
poison local model 45 index 1
class_loss: 3.7952568531036377, distance_loss: 0.0
class_loss: 2.283567428588867, distance_loss: 0.3296539783477783
class_loss: 1.0566468238830566, distance_loss: 0.819991946220398
class_loss: 1.9454752206802368, distance_loss: 1.2439333200454712
class_loss: 1.3699356317520142, distance_loss: 1.5947892665863037
class_loss: 1.5291041135787964, distance_loss: 1.920628547668457
class_loss: 1.5661264657974243, distance_loss: 2.2114968299865723
class_loss: 1.3529767990112305, distance_loss: 2.467111110687256
class_loss: 1.3034080266952515, distance_loss: 2.692922353744507
class_loss: 1.2124342918395996, distance_loss: 2.8991880416870117
___PoisonTrain Local_Simple ,  epoch  65, local model 45, internal_epoch   1,  Average loss: 0.0277, Accuracy: 326/628 (51.9108%), train_poison_data_count: 200
class_loss: 1.2769399881362915, distance_loss: 3.0965631008148193
class_loss: 1.03691565990448, distance_loss: 3.2817957401275635
class_loss: 0.812347412109375, distance_loss: 3.455597162246704
class_loss: 0.8264743685722351, distance_loss: 3.6155545711517334
class_loss: 1.0838942527770996, distance_loss: 3.766658306121826
class_loss: 0.8614793419837952, distance_loss: 3.9047248363494873
class_loss: 0.8207434415817261, distance_loss: 4.029793739318848
class_loss: 0.7176194190979004, distance_loss: 4.1451029777526855
class_loss: 0.7512180209159851, distance_loss: 4.25390100479126
class_loss: 0.7210360169410706, distance_loss: 4.355274200439453
___PoisonTrain Local_Simple ,  epoch  65, local model 45, internal_epoch   2,  Average loss: 0.0142, Accuracy: 358/628 (57.0064%), train_poison_data_count: 200
Global model norm: 15.209974951087043.
Norm before scaling: 15.337479127653635. Distance: 4.452216447200721
Total norm for 2 adversaries is: 15.337479127653635. distance: 4.452216447200721
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 0.8063, Accuracy: 6163/8968 (68.7221%)
___Train Local_Simple,  epoch  65, local model 69, internal_epoch   1,  Average loss: 0.0010, Accuracy: 250/256 (97.6562%)
___Train Local_Simple,  epoch  65, local model 69, internal_epoch   2,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.1814, Accuracy: 9364/10000 (93.6400%)
time spent on training: 40.1871383190155
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 45]
base_p: [-0.00217251  0.00022545 -0.00031233 ... -0.00216381 -0.00101274
 -0.00084114]
[T_SCORE] attacker_local_idxs is:  [1, 5, 6, 7, 8]
layer1_inf_time: 3.16650390625
[PAIRWISE] pred_attackers_indx:  [1 8]
layer2_inf_t: 33.868408203125
assumed final_attacker_idxs:  [1 5 6 7 8]
final_attacker_idxs is: [1 5 6 7 8]
g_attacker_idxs: [85 65 46 29 45]
g_normal_idxs: [ 5 24  0 35 69]
filtered_attacker_idxs: [1, 6, 7, 8]
final_attacker_idxs are: [1, 6, 7, 8]
num_dps: [434, 431, 379, 435, 499, 371, 710, 1002, 628, 256]
epoch_acc: 98.61
Starting performing KrMLRFL...
Num data points: [434, 431, 379, 435, 499, 371, 710, 1002, 628, 256]
Num selected data points: [434 379 435 499 371 256]
The chosen ones are users: [0, 2, 3, 4, 5, 9], which are global users: [5, 24, 0, 35, 65, 69]
___Test Local_Simple poisoned: False, epoch: 65: Average loss: 0.0421, Accuracy: 9861/10000 (98.6100%)
___Test Local_Simple poisoned: True, epoch: 65: Average loss: 13.4835, Accuracy: 13/8968 (0.1450%)
Done in 132.68660473823547 sec.
Server Epoch:66 choose agents : [10, 16, 41, 45, 65, 81, 24, 64, 48, 29].
___Train Local_Simple,  epoch  66, local model 10, internal_epoch   1,  Average loss: 0.0004, Accuracy: 881/892 (98.7668%)
___Train Local_Simple,  epoch  66, local model 10, internal_epoch   2,  Average loss: 0.0003, Accuracy: 885/892 (99.2152%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2052, Accuracy: 9384/10000 (93.8400%)
poison local model 16 index 0
class_loss: 3.894162654876709, distance_loss: 0.0
class_loss: 2.7261691093444824, distance_loss: 0.30588874220848083
class_loss: 1.4954569339752197, distance_loss: 0.791817843914032
class_loss: 1.3760859966278076, distance_loss: 1.2666789293289185
class_loss: 1.3427164554595947, distance_loss: 1.6563440561294556
class_loss: 1.36201810836792, distance_loss: 1.9964303970336914
class_loss: 1.4113621711730957, distance_loss: 2.2911934852600098
class_loss: 1.435880184173584, distance_loss: 2.55100154876709
class_loss: 1.340048909187317, distance_loss: 2.7810897827148438
class_loss: 1.045615553855896, distance_loss: 2.989988088607788
class_loss: 1.2919859886169434, distance_loss: 3.185978889465332
class_loss: 1.082820177078247, distance_loss: 3.361710548400879
class_loss: 1.2406959533691406, distance_loss: 3.5198307037353516
class_loss: 0.9612708687782288, distance_loss: 3.6588375568389893
class_loss: 0.9215779304504395, distance_loss: 3.790665626525879
___PoisonTrain Local_Simple ,  epoch  66, local model 16, internal_epoch   1,  Average loss: 0.0251, Accuracy: 488/915 (53.3333%), train_poison_data_count: 299
___PoisonTrain Local_Simple ,  epoch  66, local model 16, internal_epoch   2,  Average loss: 0.0166, Accuracy: 506/915 (55.3005%), train_poison_data_count: 299
Global model norm: 15.188711110243347.
Norm before scaling: 15.483106697868426. Distance: 5.112663494004831
Total norm for 3 adversaries is: 15.483106697868426. distance: 5.112663494004831
class_loss: 1.4178292751312256, distance_loss: 3.9492526054382324
class_loss: 1.4238070249557495, distance_loss: 4.076289653778076
class_loss: 1.0205634832382202, distance_loss: 4.173980712890625
class_loss: 1.1060454845428467, distance_loss: 4.263781547546387
class_loss: 0.9944033622741699, distance_loss: 4.351507663726807
class_loss: 0.9439570903778076, distance_loss: 4.4363861083984375
class_loss: 0.9002097249031067, distance_loss: 4.519257545471191
class_loss: 1.005366325378418, distance_loss: 4.600347518920898
class_loss: 1.0992307662963867, distance_loss: 4.678687572479248
class_loss: 0.8896568417549133, distance_loss: 4.753864288330078
class_loss: 0.750215470790863, distance_loss: 4.825292110443115
class_loss: 0.880887508392334, distance_loss: 4.891469478607178
class_loss: 0.965569257736206, distance_loss: 4.950615882873535
class_loss: 0.8154934048652649, distance_loss: 5.001839637756348
class_loss: 0.9374966621398926, distance_loss: 5.048229217529297
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.6912, Accuracy: 6282/8968 (70.0491%)
___Train Local_Simple,  epoch  66, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 602/606 (99.3399%)
___Train Local_Simple,  epoch  66, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0741, Accuracy: 9769/10000 (97.6900%)
poison local model 45 index 1
class_loss: 3.933847665786743, distance_loss: 0.0
class_loss: 2.4805610179901123, distance_loss: 0.317801296710968
class_loss: 1.213430404663086, distance_loss: 0.8144862651824951
class_loss: 1.7649463415145874, distance_loss: 1.318772792816162
class_loss: 1.5102014541625977, distance_loss: 1.6907731294631958
class_loss: 1.3968559503555298, distance_loss: 2.017899751663208
class_loss: 1.528710961341858, distance_loss: 2.3123598098754883
class_loss: 1.3744819164276123, distance_loss: 2.5697474479675293
class_loss: 1.395036220550537, distance_loss: 2.7961385250091553
class_loss: 1.0737007856369019, distance_loss: 3.00400972366333
___PoisonTrain Local_Simple ,  epoch  66, local model 45, internal_epoch   1,  Average loss: 0.0281, Accuracy: 312/628 (49.6815%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  66, local model 45, internal_epoch   2,  Average loss: 0.0138, Accuracy: 378/628 (60.1911%), train_poison_data_count: 200
Global model norm: 15.188711110243347.
Norm before scaling: 15.27115502046848. Distance: 4.520099890963914
Total norm for 3 adversaries is: 15.27115502046848. distance: 4.520099890963914
class_loss: 1.0008554458618164, distance_loss: 3.2022511959075928
class_loss: 1.0738028287887573, distance_loss: 3.389143705368042
class_loss: 1.2117571830749512, distance_loss: 3.565293312072754
class_loss: 0.7362367510795593, distance_loss: 3.714426040649414
class_loss: 0.7715650796890259, distance_loss: 3.853455066680908
class_loss: 0.9030623435974121, distance_loss: 3.984908103942871
class_loss: 0.7465125322341919, distance_loss: 4.107008934020996
class_loss: 0.7421795129776001, distance_loss: 4.218756198883057
class_loss: 0.7381803393363953, distance_loss: 4.32702112197876
class_loss: 0.7654715776443481, distance_loss: 4.430450916290283
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.9200, Accuracy: 5502/8968 (61.3515%)
___Train Local_Simple,  epoch  66, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch  66, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0463, Accuracy: 9852/10000 (98.5200%)
poison local model 81 index 2
class_loss: 5.193409442901611, distance_loss: 0.0
class_loss: 2.601384401321411, distance_loss: 0.3951537311077118
class_loss: 1.5235000848770142, distance_loss: 0.9486164450645447
class_loss: 1.3887536525726318, distance_loss: 1.4850255250930786
class_loss: 1.4730488061904907, distance_loss: 1.9483851194381714
class_loss: 1.5735056400299072, distance_loss: 2.349964141845703
class_loss: 1.4864397048950195, distance_loss: 2.7016167640686035
class_loss: 1.4803097248077393, distance_loss: 3.0137345790863037
class_loss: 1.3465789556503296, distance_loss: 3.2925732135772705
class_loss: 1.4032410383224487, distance_loss: 3.542764186859131
class_loss: 1.320225477218628, distance_loss: 3.7668685913085938
class_loss: 1.3846138715744019, distance_loss: 3.969806671142578
class_loss: 1.2442104816436768, distance_loss: 4.1505818367004395
class_loss: 1.1326848268508911, distance_loss: 4.315578937530518
class_loss: 1.0429340600967407, distance_loss: 4.468994140625
class_loss: 1.1231203079223633, distance_loss: 4.61076021194458
class_loss: 1.1901603937149048, distance_loss: 4.739938735961914
class_loss: 0.8794822096824646, distance_loss: 4.857027053833008
class_loss: 1.1184481382369995, distance_loss: 4.965310573577881
class_loss: 0.9225855469703674, distance_loss: 5.0654826164245605
class_loss: 1.1165060997009277, distance_loss: 5.169679164886475
class_loss: 1.3019938468933105, distance_loss: 5.260498046875
class_loss: 1.2559819221496582, distance_loss: 5.331387519836426
class_loss: 0.9181415438652039, distance_loss: 5.389865398406982
class_loss: 0.8203610181808472, distance_loss: 5.446218013763428
class_loss: 0.9884971976280212, distance_loss: 5.503646373748779
class_loss: 0.8951222896575928, distance_loss: 5.559103488922119
class_loss: 0.9741200804710388, distance_loss: 5.61063814163208
class_loss: 0.8154658079147339, distance_loss: 5.658921718597412
class_loss: 0.8989655375480652, distance_loss: 5.704959392547607
class_loss: 0.8181067705154419, distance_loss: 5.748743534088135
class_loss: 0.8681474328041077, distance_loss: 5.791460037231445
class_loss: 0.8564786314964294, distance_loss: 5.834848880767822
class_loss: 0.7354004979133606, distance_loss: 5.8752570152282715
class_loss: 0.8289361596107483, distance_loss: 5.9128828048706055
class_loss: 0.8145477771759033, distance_loss: 5.947413444519043
class_loss: 0.6151867508888245, distance_loss: 5.978881359100342
class_loss: 0.7423925399780273, distance_loss: 6.0106048583984375
class_loss: 0.6917390823364258, distance_loss: 6.043321132659912
class_loss: 0.6383479833602905, distance_loss: 6.078646183013916
___PoisonTrain Local_Simple ,  epoch  66, local model 81, internal_epoch   1,  Average loss: 0.0251, Accuracy: 593/1227 (48.3293%), train_poison_data_count: 391
___PoisonTrain Local_Simple ,  epoch  66, local model 81, internal_epoch   2,  Average loss: 0.0143, Accuracy: 720/1227 (58.6797%), train_poison_data_count: 391
Global model norm: 15.188711110243347.
Norm before scaling: 15.811783484105838. Distance: 6.1318442582609975
Total norm for 3 adversaries is: 15.811783484105838. distance: 6.1318442582609975
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 0.2709, Accuracy: 7890/8968 (87.9795%)
___Train Local_Simple,  epoch  66, local model 24, internal_epoch   1,  Average loss: 0.0006, Accuracy: 375/379 (98.9446%)
___Train Local_Simple,  epoch  66, local model 24, internal_epoch   2,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0952, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch  66, local model 64, internal_epoch   1,  Average loss: 0.0009, Accuracy: 799/813 (98.2780%)
___Train Local_Simple,  epoch  66, local model 64, internal_epoch   2,  Average loss: 0.0006, Accuracy: 804/813 (98.8930%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2100, Accuracy: 9271/10000 (92.7100%)
___Train Local_Simple,  epoch  66, local model 48, internal_epoch   1,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Train Local_Simple,  epoch  66, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0773, Accuracy: 9748/10000 (97.4800%)
___Train Local_Simple,  epoch  66, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 995/1002 (99.3014%)
___Train Local_Simple,  epoch  66, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 996/1002 (99.4012%)
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.2002, Accuracy: 9353/10000 (93.5300%)
time spent on training: 46.818652629852295
Starting performing KrMLRFL...
Num data points: [892, 915, 606, 628, 371, 1227, 379, 813, 448, 1002]
Num selected data points: [ 892  606  371  379  813  448 1002]
The chosen ones are users: [0, 2, 4, 6, 7, 8, 9], which are global users: [10, 41, 65, 24, 64, 48, 29]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 45, 81]
base_p: [-0.00614077  0.00012016 -0.00153789 ... -0.00110471 -0.00246048
 -0.00125209]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 5, 7]
layer1_inf_time: 2.208251953125
[PAIRWISE] pred_attackers_indx:  [1 3 5]
layer2_inf_t: 25.707275390625
assumed final_attacker_idxs:  [1 2 3 5 7]
final_attacker_idxs is: [1 2 3 5 7]
g_attacker_idxs: [16 41 45 81 64]
g_normal_idxs: [10 65 24 48 29]
filtered_attacker_idxs: [1, 3, 5]
final_attacker_idxs are: [1, 3, 5]
num_dps: [892, 915, 606, 628, 371, 1227, 379, 813, 448, 1002]
epoch_acc: 98.4
___Test Local_Simple poisoned: False, epoch: 66: Average loss: 0.0477, Accuracy: 9840/10000 (98.4000%)
___Test Local_Simple poisoned: True, epoch: 66: Average loss: 13.8513, Accuracy: 23/8968 (0.2565%)
Done in 130.55623722076416 sec.
Server Epoch:67 choose agents : [43, 96, 61, 70, 67, 8, 68, 93, 30, 71].
___Train Local_Simple,  epoch  67, local model 43, internal_epoch   1,  Average loss: 0.0009, Accuracy: 402/408 (98.5294%)
___Train Local_Simple,  epoch  67, local model 43, internal_epoch   2,  Average loss: 0.0005, Accuracy: 402/408 (98.5294%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0720, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch  67, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 665/672 (98.9583%)
___Train Local_Simple,  epoch  67, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1685, Accuracy: 9462/10000 (94.6200%)
poison local model 61 index 0
___PoisonTrain Local_Simple ,  epoch  67, local model 61, internal_epoch   1,  Average loss: 0.0237, Accuracy: 401/699 (57.3677%), train_poison_data_count: 220
class_loss: 3.6599323749542236, distance_loss: 0.0
class_loss: 2.3801653385162354, distance_loss: 0.3016968369483948
class_loss: 1.54871666431427, distance_loss: 0.7900189161300659
class_loss: 1.725169062614441, distance_loss: 1.258715033531189
class_loss: 1.432349681854248, distance_loss: 1.6709537506103516
class_loss: 1.116294026374817, distance_loss: 2.035093307495117
class_loss: 1.0911093950271606, distance_loss: 2.368039846420288
class_loss: 1.007245421409607, distance_loss: 2.66561222076416
class_loss: 0.8828304409980774, distance_loss: 2.937952756881714
class_loss: 0.8280459642410278, distance_loss: 3.188978672027588
class_loss: 0.9124459624290466, distance_loss: 3.4201369285583496
class_loss: 0.7956600189208984, distance_loss: 3.632129669189453
class_loss: 0.8682095408439636, distance_loss: 3.8239665031433105
class_loss: 0.8554621934890747, distance_loss: 3.9963574409484863
class_loss: 1.2043803930282593, distance_loss: 4.144135475158691
class_loss: 0.9313362836837769, distance_loss: 4.270689964294434
class_loss: 0.7623496651649475, distance_loss: 4.389344215393066
class_loss: 0.8186201453208923, distance_loss: 4.501440048217773
class_loss: 0.729800283908844, distance_loss: 4.607460021972656
class_loss: 0.6564863920211792, distance_loss: 4.703860282897949
class_loss: 0.7833374738693237, distance_loss: 4.79311990737915
class_loss: 0.7169281840324402, distance_loss: 4.875887393951416
___PoisonTrain Local_Simple ,  epoch  67, local model 61, internal_epoch   2,  Average loss: 0.0131, Accuracy: 447/699 (63.9485%), train_poison_data_count: 220
Global model norm: 15.156253523678714.
Norm before scaling: 15.377084978357914. Distance: 4.951727733220529
Total norm for 4 adversaries is: 15.377084978357914. distance: 4.951727733220529
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 1.1284, Accuracy: 4613/8968 (51.4384%)
poison local model 70 index 1
___PoisonTrain Local_Simple ,  epoch  67, local model 70, internal_epoch   1,  Average loss: 0.0291, Accuracy: 342/724 (47.2376%), train_poison_data_count: 240
class_loss: 4.028048038482666, distance_loss: 0.0
class_loss: 2.831078052520752, distance_loss: 0.30223655700683594
class_loss: 1.2576992511749268, distance_loss: 0.7942523956298828
class_loss: 1.2331225872039795, distance_loss: 1.3107848167419434
class_loss: 1.6590986251831055, distance_loss: 1.7530381679534912
class_loss: 1.5610677003860474, distance_loss: 2.1429331302642822
class_loss: 1.5435267686843872, distance_loss: 2.4875779151916504
class_loss: 1.657737374305725, distance_loss: 2.7893340587615967
class_loss: 1.5172139406204224, distance_loss: 3.0557405948638916
class_loss: 1.502590537071228, distance_loss: 3.2931783199310303
class_loss: 1.4711633920669556, distance_loss: 3.5047311782836914
class_loss: 0.809363842010498, distance_loss: 3.6929149627685547
class_loss: 1.497421145439148, distance_loss: 3.8839199542999268
class_loss: 1.6165963411331177, distance_loss: 4.046214580535889
class_loss: 1.3114064931869507, distance_loss: 4.182773590087891
class_loss: 1.2021167278289795, distance_loss: 4.308378219604492
class_loss: 1.2387750148773193, distance_loss: 4.424299716949463
class_loss: 1.1000785827636719, distance_loss: 4.532148838043213
class_loss: 1.0196897983551025, distance_loss: 4.633971691131592
class_loss: 1.0581660270690918, distance_loss: 4.730118274688721
class_loss: 0.9467003345489502, distance_loss: 4.823288917541504
class_loss: 1.0353214740753174, distance_loss: 4.913304328918457
class_loss: 0.8925498723983765, distance_loss: 5.001282215118408
class_loss: 0.7118209600448608, distance_loss: 5.087711811065674
___PoisonTrain Local_Simple ,  epoch  67, local model 70, internal_epoch   2,  Average loss: 0.0188, Accuracy: 392/724 (54.1436%), train_poison_data_count: 240
Global model norm: 15.156253523678714.
Norm before scaling: 15.496588054568909. Distance: 5.183984139524145
Total norm for 4 adversaries is: 15.496588054568909. distance: 5.183984139524145
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.3686, Accuracy: 7555/8968 (84.2440%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   1,  Average loss: 0.0011, Accuracy: 974/998 (97.5952%)
___Train Local_Simple,  epoch  67, local model 67, internal_epoch   2,  Average loss: 0.0006, Accuracy: 986/998 (98.7976%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1815, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  67, local model 8, internal_epoch   1,  Average loss: 0.0006, Accuracy: 626/633 (98.8942%)
___Train Local_Simple,  epoch  67, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 632/633 (99.8420%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0660, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch  67, local model 68, internal_epoch   1,  Average loss: 0.0005, Accuracy: 489/494 (98.9879%)
___Train Local_Simple,  epoch  67, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.1130, Accuracy: 9643/10000 (96.4300%)
poison local model 93 index 2
class_loss: 4.467985153198242, distance_loss: 0.0
class_loss: 2.5676004886627197, distance_loss: 0.4064258933067322
class_loss: 1.4711003303527832, distance_loss: 0.9483097791671753
class_loss: 1.807081699371338, distance_loss: 1.4110684394836426
class_loss: 1.5227322578430176, distance_loss: 1.788569450378418
class_loss: 1.7310025691986084, distance_loss: 2.1357743740081787
class_loss: 1.6435497999191284, distance_loss: 2.447493553161621
class_loss: 1.4655675888061523, distance_loss: 2.7207443714141846
class_loss: 1.3777724504470825, distance_loss: 2.964317798614502
class_loss: 1.1354219913482666, distance_loss: 3.1834514141082764
___PoisonTrain Local_Simple ,  epoch  67, local model 93, internal_epoch   1,  Average loss: 0.0308, Accuracy: 285/623 (45.7464%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  67, local model 93, internal_epoch   2,  Average loss: 0.0136, Accuracy: 369/623 (59.2295%), train_poison_data_count: 200
Global model norm: 15.156253523678714.
Norm before scaling: 15.36351316011718. Distance: 4.803860923564422
Total norm for 4 adversaries is: 15.36351316011718. distance: 4.803860923564422
class_loss: 1.2462985515594482, distance_loss: 3.388394355773926
class_loss: 1.0246018171310425, distance_loss: 3.5718142986297607
class_loss: 0.7569171786308289, distance_loss: 3.7393124103546143
class_loss: 1.012384057044983, distance_loss: 3.899808168411255
class_loss: 0.8689814805984497, distance_loss: 4.052119255065918
class_loss: 0.6941418647766113, distance_loss: 4.198097229003906
class_loss: 0.7039444446563721, distance_loss: 4.338755130767822
class_loss: 0.6840802431106567, distance_loss: 4.473713397979736
class_loss: 0.7705927491188049, distance_loss: 4.597344875335693
class_loss: 0.6996366381645203, distance_loss: 4.703807830810547
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.5570, Accuracy: 6788/8968 (75.6913%)
___Train Local_Simple,  epoch  67, local model 30, internal_epoch   1,  Average loss: 0.0004, Accuracy: 397/400 (99.2500%)
___Train Local_Simple,  epoch  67, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.2185, Accuracy: 9333/10000 (93.3300%)
poison local model 71 index 3
class_loss: 4.531933307647705, distance_loss: 0.0
class_loss: 2.433683156967163, distance_loss: 0.3856891691684723
class_loss: 1.1903115510940552, distance_loss: 0.9250446557998657
class_loss: 1.6424630880355835, distance_loss: 1.4198780059814453
class_loss: 1.3707212209701538, distance_loss: 1.7969344854354858
class_loss: 1.2626450061798096, distance_loss: 2.1320409774780273
class_loss: 1.1657387018203735, distance_loss: 2.4398224353790283
class_loss: 1.044815182685852, distance_loss: 2.723501205444336
class_loss: 1.1414433717727661, distance_loss: 2.989021062850952
class_loss: 0.9910362958908081, distance_loss: 3.2285890579223633
class_loss: 0.6914196014404297, distance_loss: 3.4524524211883545
class_loss: 0.5658632516860962, distance_loss: 3.6662628650665283
class_loss: 0.5397542715072632, distance_loss: 3.8715133666992188
class_loss: 0.3507172167301178, distance_loss: 4.066836833953857
class_loss: 0.3122974634170532, distance_loss: 4.2519965171813965
class_loss: 0.5425429940223694, distance_loss: 4.426644325256348
class_loss: 0.33629676699638367, distance_loss: 4.584001541137695
class_loss: 0.1284668892621994, distance_loss: 4.728362083435059
class_loss: 0.27875426411628723, distance_loss: 4.861789703369141
class_loss: 0.37005192041397095, distance_loss: 4.984348297119141
class_loss: 0.25532734394073486, distance_loss: 5.098196029663086
class_loss: 0.3963499069213867, distance_loss: 5.203488826751709
___PoisonTrain Local_Simple ,  epoch  67, local model 71, internal_epoch   1,  Average loss: 0.0156, Accuracy: 1026/1384 (74.1329%), train_poison_data_count: 440
___PoisonTrain Local_Simple ,  epoch  67, local model 71, internal_epoch   2,  Average loss: 0.0027, Accuracy: 1312/1384 (94.7977%), train_poison_data_count: 440
Global model norm: 15.156253523678714.
Norm before scaling: 15.880044451058005. Distance: 6.206261444849562
Total norm for 4 adversaries is: 15.880044451058005. distance: 6.206261444849562
class_loss: 0.20735211670398712, distance_loss: 5.2975006103515625
class_loss: 0.3060312569141388, distance_loss: 5.382174968719482
class_loss: 0.145653635263443, distance_loss: 5.4568328857421875
class_loss: 0.17965927720069885, distance_loss: 5.526699066162109
class_loss: 0.2096935510635376, distance_loss: 5.593054294586182
class_loss: 0.17499244213104248, distance_loss: 5.655160903930664
class_loss: 0.22808119654655457, distance_loss: 5.7128825187683105
class_loss: 0.15804165601730347, distance_loss: 5.766193389892578
class_loss: 0.18875375390052795, distance_loss: 5.81618595123291
class_loss: 0.13516300916671753, distance_loss: 5.862216472625732
class_loss: 0.12815643846988678, distance_loss: 5.905411243438721
class_loss: 0.11106214672327042, distance_loss: 5.945069789886475
class_loss: 0.30048561096191406, distance_loss: 5.981979846954346
class_loss: 0.19874225556850433, distance_loss: 6.014298439025879
class_loss: 0.1341833919286728, distance_loss: 6.042771816253662
class_loss: 0.2363860011100769, distance_loss: 6.06768798828125
class_loss: 0.18596959114074707, distance_loss: 6.090404987335205
class_loss: 0.07064735889434814, distance_loss: 6.112018585205078
class_loss: 0.11012731492519379, distance_loss: 6.1322174072265625
class_loss: 0.10902680456638336, distance_loss: 6.151328086853027
class_loss: 0.12827982008457184, distance_loss: 6.1705803871154785
class_loss: 0.08158369362354279, distance_loss: 6.189027309417725
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 0.0456, Accuracy: 8780/8968 (97.9037%)
time spent on training: 55.07421112060547
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 70, 93, 71]
base_p: [-5.0033554e-03  4.4740736e-05 -7.3994324e-04 ... -1.9556582e-03
 -6.0299486e-03 -2.3376197e-03]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 9]
layer1_inf_time: 3.086181640625
[PAIRWISE] pred_attackers_indx:  [2 3 7 9]
layer2_inf_t: 37.245849609375
assumed final_attacker_idxs:  [2 3 4 7 9]
final_attacker_idxs is: [2 3 4 7 9]
g_attacker_idxs: [61 70 67 93 71]
g_normal_idxs: [43 96  8 68 30]
filtered_attacker_idxs: [2, 3, 4, 7, 9]
final_attacker_idxs are: [2, 3, 4, 7, 9]
num_dps: [408, 672, 699, 724, 998, 633, 494, 623, 400, 1384]
Starting performing KrMLRFL...
Num data points: [408, 672, 699, 724, 998, 633, 494, 623, 400, 1384]
Num selected data points: [408 672 633 494 400]
The chosen ones are users: [0, 1, 5, 6, 8], which are global users: [43, 96, 8, 68, 30]
___Test Local_Simple poisoned: False, epoch: 67: Average loss: 0.0435, Accuracy: 9868/10000 (98.6800%)
epoch_acc: 98.68
___Test Local_Simple poisoned: True, epoch: 67: Average loss: 13.4486, Accuracy: 17/8968 (0.1896%)
Done in 141.8237042427063 sec.
Server Epoch:68 choose agents : [77, 32, 80, 30, 53, 41, 13, 49, 17, 31].
___Train Local_Simple,  epoch  68, local model 77, internal_epoch   1,  Average loss: 0.0010, Accuracy: 580/589 (98.4720%)
___Train Local_Simple,  epoch  68, local model 77, internal_epoch   2,  Average loss: 0.0010, Accuracy: 579/589 (98.3022%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0605, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   1,  Average loss: 0.0007, Accuracy: 963/977 (98.5670%)
___Train Local_Simple,  epoch  68, local model 32, internal_epoch   2,  Average loss: 0.0005, Accuracy: 971/977 (99.3859%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1623, Accuracy: 9533/10000 (95.3300%)
___Train Local_Simple,  epoch  68, local model 80, internal_epoch   1,  Average loss: 0.0005, Accuracy: 426/431 (98.8399%)
___Train Local_Simple,  epoch  68, local model 80, internal_epoch   2,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1057, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch  68, local model 30, internal_epoch   1,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Train Local_Simple,  epoch  68, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0871, Accuracy: 9723/10000 (97.2300%)
___Train Local_Simple,  epoch  68, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch  68, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 737/739 (99.7294%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.2466, Accuracy: 9280/10000 (92.8000%)
___Train Local_Simple,  epoch  68, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 603/606 (99.5050%)
___Train Local_Simple,  epoch  68, local model 41, internal_epoch   2,  Average loss: 0.0003, Accuracy: 600/606 (99.0099%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1039, Accuracy: 9659/10000 (96.5900%)
poison local model 13 index 0
___PoisonTrain Local_Simple ,  epoch  68, local model 13, internal_epoch   1,  Average loss: 0.0268, Accuracy: 392/734 (53.4060%), train_poison_data_count: 240
class_loss: 4.560575485229492, distance_loss: 0.0
class_loss: 1.8873392343521118, distance_loss: 0.3706663250923157
class_loss: 1.9559425115585327, distance_loss: 0.8573058247566223
class_loss: 1.5189306735992432, distance_loss: 1.2800649404525757
class_loss: 1.2924573421478271, distance_loss: 1.6688152551651
class_loss: 1.2550129890441895, distance_loss: 2.0367074012756348
class_loss: 1.1532213687896729, distance_loss: 2.3704440593719482
class_loss: 1.3330464363098145, distance_loss: 2.673689603805542
class_loss: 1.2469120025634766, distance_loss: 2.9475176334381104
class_loss: 1.1328444480895996, distance_loss: 3.1950342655181885
class_loss: 1.2368059158325195, distance_loss: 3.4166860580444336
class_loss: 1.0718204975128174, distance_loss: 3.6160953044891357
class_loss: 1.120255947113037, distance_loss: 3.8034698963165283
class_loss: 1.2640984058380127, distance_loss: 3.967346429824829
class_loss: 1.175114393234253, distance_loss: 4.107295036315918
class_loss: 1.0105124711990356, distance_loss: 4.226617336273193
class_loss: 0.9360060095787048, distance_loss: 4.334176540374756
class_loss: 1.0015991926193237, distance_loss: 4.4343485832214355
class_loss: 1.1135742664337158, distance_loss: 4.526219367980957
class_loss: 0.9198769330978394, distance_loss: 4.612777233123779
class_loss: 0.7374265789985657, distance_loss: 4.695494174957275
class_loss: 0.8556779026985168, distance_loss: 4.773611068725586
class_loss: 0.7995017170906067, distance_loss: 4.848764419555664
class_loss: 0.9060220718383789, distance_loss: 4.91854190826416
___PoisonTrain Local_Simple ,  epoch  68, local model 13, internal_epoch   2,  Average loss: 0.0161, Accuracy: 382/734 (52.0436%), train_poison_data_count: 240
Global model norm: 15.119221237553147.
Norm before scaling: 15.305538416716542. Distance: 4.987349528478415
Total norm for 2 adversaries is: 15.305538416716542. distance: 4.987349528478415
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.9399, Accuracy: 5050/8968 (56.3113%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   1,  Average loss: 0.0006, Accuracy: 500/506 (98.8142%)
___Train Local_Simple,  epoch  68, local model 49, internal_epoch   2,  Average loss: 0.0003, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1060, Accuracy: 9677/10000 (96.7700%)
poison local model 17 index 1
class_loss: 4.523490905761719, distance_loss: 0.0
class_loss: 2.56886887550354, distance_loss: 0.378659188747406
class_loss: 1.7448941469192505, distance_loss: 0.9414097666740417
class_loss: 1.865102767944336, distance_loss: 1.4265776872634888
class_loss: 1.6382510662078857, distance_loss: 1.8480855226516724
class_loss: 1.6022660732269287, distance_loss: 2.2375056743621826
class_loss: 1.730339765548706, distance_loss: 2.592291831970215
class_loss: 1.5287917852401733, distance_loss: 2.907794713973999
class_loss: 1.5511434078216553, distance_loss: 3.185842752456665
class_loss: 1.2729042768478394, distance_loss: 3.435701847076416
___PoisonTrain Local_Simple ,  epoch  68, local model 17, internal_epoch   1,  Average loss: 0.0323, Accuracy: 309/620 (49.8387%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  68, local model 17, internal_epoch   2,  Average loss: 0.0191, Accuracy: 288/620 (46.4516%), train_poison_data_count: 200
Global model norm: 15.119221237553147.
Norm before scaling: 15.308785622521732. Distance: 5.116585313148177
Total norm for 2 adversaries is: 15.308785622521732. distance: 5.116585313148177
class_loss: 1.6135512590408325, distance_loss: 3.6691763401031494
class_loss: 1.4127225875854492, distance_loss: 3.8753952980041504
class_loss: 1.4493167400360107, distance_loss: 4.055302619934082
class_loss: 1.0580716133117676, distance_loss: 4.215733528137207
class_loss: 1.2021594047546387, distance_loss: 4.367984294891357
class_loss: 1.040181040763855, distance_loss: 4.512277603149414
class_loss: 0.9467620849609375, distance_loss: 4.648870944976807
class_loss: 1.0577131509780884, distance_loss: 4.777436256408691
class_loss: 0.9444883465766907, distance_loss: 4.896941661834717
class_loss: 1.118388056755066, distance_loss: 5.00860595703125
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 0.7424, Accuracy: 5954/8968 (66.3916%)
___Train Local_Simple,  epoch  68, local model 31, internal_epoch   1,  Average loss: 0.0003, Accuracy: 829/835 (99.2814%)
___Train Local_Simple,  epoch  68, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 833/835 (99.7605%)
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.1809, Accuracy: 9518/10000 (95.1800%)
time spent on training: 41.451491594314575
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 17]
base_p: [-0.00141114  0.00043282 -0.00051646 ... -0.00185917  0.00242838
  0.00080881]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 7, 8]
layer1_inf_time: 2.917724609375
[PAIRWISE] pred_attackers_indx:  [6 8]
layer2_inf_t: 32.8857421875
assumed final_attacker_idxs:  [1 4 6 7 8]
final_attacker_idxs is: [1 4 6 7 8]
g_attacker_idxs: [32 53 13 49 17]
g_normal_idxs: [77 80 30 41 31]
filtered_attacker_idxs: [1, 4, 6, 7, 8]
final_attacker_idxs are: [1, 4, 6, 7, 8]
num_dps: [589, 977, 431, 400, 739, 606, 734, 506, 620, 835]
Starting performing KrMLRFL...
Num data points: [589, 977, 431, 400, 739, 606, 734, 506, 620, 835]
Num selected data points: [589 431 400 606 835]
The chosen ones are users: [0, 2, 3, 5, 9], which are global users: [77, 80, 30, 41, 31]
___Test Local_Simple poisoned: False, epoch: 68: Average loss: 0.0459, Accuracy: 9859/10000 (98.5900%)
epoch_acc: 98.59
___Test Local_Simple poisoned: True, epoch: 68: Average loss: 14.7159, Accuracy: 24/8968 (0.2676%)
Done in 131.52210474014282 sec.
Server Epoch:69 choose agents : [46, 56, 12, 72, 79, 17, 71, 70, 74, 27].
___Train Local_Simple,  epoch  69, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 694/710 (97.7465%)
___Train Local_Simple,  epoch  69, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 706/710 (99.4366%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.2371, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch  69, local model 56, internal_epoch   1,  Average loss: 0.0006, Accuracy: 869/880 (98.7500%)
___Train Local_Simple,  epoch  69, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 878/880 (99.7727%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1822, Accuracy: 9409/10000 (94.0900%)
___Train Local_Simple,  epoch  69, local model 12, internal_epoch   1,  Average loss: 0.0013, Accuracy: 1133/1160 (97.6724%)
___Train Local_Simple,  epoch  69, local model 12, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1146/1160 (98.7931%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.3561, Accuracy: 9185/10000 (91.8500%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   1,  Average loss: 0.0002, Accuracy: 728/731 (99.5896%)
___Train Local_Simple,  epoch  69, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1331, Accuracy: 9570/10000 (95.7000%)
___Train Local_Simple,  epoch  69, local model 79, internal_epoch   1,  Average loss: 0.0007, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch  69, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0554, Accuracy: 9827/10000 (98.2700%)
poison local model 17 index 0
class_loss: 4.84589958190918, distance_loss: 0.0
class_loss: 3.023273229598999, distance_loss: 0.3980740010738373
class_loss: 2.0049047470092773, distance_loss: 0.9352225661277771
class_loss: 1.6760786771774292, distance_loss: 1.4907441139221191
class_loss: 2.1568493843078613, distance_loss: 1.966095209121704
class_loss: 1.6882957220077515, distance_loss: 2.412156820297241
class_loss: 1.6648930311203003, distance_loss: 2.8100521564483643
class_loss: 1.8467676639556885, distance_loss: 3.156175374984741
class_loss: 1.6820234060287476, distance_loss: 3.461538314819336
class_loss: 1.3761521577835083, distance_loss: 3.7348732948303223
class_loss: 1.3396408557891846, distance_loss: 3.985581636428833
___PoisonTrain Local_Simple ,  epoch  69, local model 17, internal_epoch   1,  Average loss: 0.0354, Accuracy: 279/620 (45.0000%), train_poison_data_count: 200
___PoisonTrain Local_Simple ,  epoch  69, local model 17, internal_epoch   2,  Average loss: 0.0201, Accuracy: 306/620 (49.3548%), train_poison_data_count: 200
Global model norm: 15.099830555754592.
Norm before scaling: 15.25871853108699. Distance: 5.619275719613437
Total norm for 4 adversaries is: 15.25871853108699. distance: 5.619275719613437
class_loss: 1.1516568660736084, distance_loss: 4.214873790740967
class_loss: 1.5154240131378174, distance_loss: 4.425792217254639
class_loss: 1.4831080436706543, distance_loss: 4.617155075073242
class_loss: 1.465024471282959, distance_loss: 4.790988922119141
class_loss: 1.1321535110473633, distance_loss: 4.954874038696289
class_loss: 1.039122462272644, distance_loss: 5.110830783843994
class_loss: 1.1942322254180908, distance_loss: 5.2552571296691895
class_loss: 1.1114710569381714, distance_loss: 5.387270927429199
class_loss: 1.0427616834640503, distance_loss: 5.507357120513916
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 1.1372, Accuracy: 5548/8968 (61.8644%)
poison local model 71 index 1
class_loss: 4.802614212036133, distance_loss: 0.0
class_loss: 2.7310433387756348, distance_loss: 0.3670676350593567
class_loss: 1.2113515138626099, distance_loss: 0.9325833916664124
class_loss: 1.5959546566009521, distance_loss: 1.4308269023895264
class_loss: 1.6066604852676392, distance_loss: 1.8227876424789429
class_loss: 1.5321658849716187, distance_loss: 2.169832706451416
class_loss: 1.3831321001052856, distance_loss: 2.481119394302368
class_loss: 1.431482195854187, distance_loss: 2.7578792572021484
class_loss: 1.1687229871749878, distance_loss: 3.0100960731506348
class_loss: 1.059584379196167, distance_loss: 3.2432186603546143
class_loss: 1.0168625116348267, distance_loss: 3.4610812664031982
class_loss: 0.8950379490852356, distance_loss: 3.661694049835205
class_loss: 0.8984497785568237, distance_loss: 3.8483529090881348
class_loss: 0.916462242603302, distance_loss: 4.02273416519165
class_loss: 0.9636707901954651, distance_loss: 4.186003684997559
class_loss: 0.848392128944397, distance_loss: 4.335900783538818
class_loss: 0.8316797614097595, distance_loss: 4.469518184661865
class_loss: 0.7471234798431396, distance_loss: 4.591968059539795
class_loss: 0.8214341998100281, distance_loss: 4.705417633056641
class_loss: 0.8115260601043701, distance_loss: 4.806691646575928
class_loss: 0.7347980737686157, distance_loss: 4.897021293640137
class_loss: 1.0744948387145996, distance_loss: 4.97992467880249
___PoisonTrain Local_Simple ,  epoch  69, local model 71, internal_epoch   1,  Average loss: 0.0210, Accuracy: 751/1384 (54.2630%), train_poison_data_count: 440
class_loss: 0.7701559066772461, distance_loss: 5.060186386108398
class_loss: 0.7931585311889648, distance_loss: 5.135663032531738
class_loss: 0.7091380953788757, distance_loss: 5.204679012298584
class_loss: 0.688643753528595, distance_loss: 5.267018795013428
class_loss: 0.6386014223098755, distance_loss: 5.324348449707031
class_loss: 0.6305031776428223, distance_loss: 5.379757881164551
class_loss: 0.6913950443267822, distance_loss: 5.432478904724121
class_loss: 0.5585293769836426, distance_loss: 5.485312461853027
class_loss: 0.3918507695198059, distance_loss: 5.538468360900879
class_loss: 0.43510350584983826, distance_loss: 5.594963550567627
class_loss: 0.3840159773826599, distance_loss: 5.652561664581299
class_loss: 0.2596379816532135, distance_loss: 5.710635662078857
class_loss: 0.20498256385326385, distance_loss: 5.76701545715332
class_loss: 0.19499212503433228, distance_loss: 5.823507785797119
class_loss: 0.25876834988594055, distance_loss: 5.876639366149902
class_loss: 0.08029086887836456, distance_loss: 5.929609775543213
class_loss: 0.10224491357803345, distance_loss: 5.981987476348877
class_loss: 0.15899969637393951, distance_loss: 6.038687705993652
class_loss: 0.03981251269578934, distance_loss: 6.096808433532715
class_loss: 0.06559541821479797, distance_loss: 6.1535749435424805
class_loss: 0.1272401362657547, distance_loss: 6.206029415130615
class_loss: 0.02369038388133049, distance_loss: 6.253602981567383
___PoisonTrain Local_Simple ,  epoch  69, local model 71, internal_epoch   2,  Average loss: 0.0059, Accuracy: 1180/1384 (85.2601%), train_poison_data_count: 440
Global model norm: 15.099830555754592.
Norm before scaling: 15.81606713871461. Distance: 6.29801230181852
Total norm for 4 adversaries is: 15.81606713871461. distance: 6.29801230181852
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.0043, Accuracy: 8958/8968 (99.8885%)
poison local model 70 index 2
___PoisonTrain Local_Simple ,  epoch  69, local model 70, internal_epoch   1,  Average loss: 0.0294, Accuracy: 346/724 (47.7901%), train_poison_data_count: 240
class_loss: 4.399770736694336, distance_loss: 0.0
class_loss: 2.2947194576263428, distance_loss: 0.3455074429512024
class_loss: 1.7306201457977295, distance_loss: 0.8437483906745911
class_loss: 1.9419156312942505, distance_loss: 1.2999645471572876
class_loss: 1.4213788509368896, distance_loss: 1.7293139696121216
class_loss: 1.397314190864563, distance_loss: 2.110179901123047
class_loss: 1.4404253959655762, distance_loss: 2.455418586730957
class_loss: 1.555899739265442, distance_loss: 2.7593624591827393
class_loss: 1.5620214939117432, distance_loss: 3.0250284671783447
class_loss: 1.3742921352386475, distance_loss: 3.260725736618042
class_loss: 1.3998221158981323, distance_loss: 3.4714300632476807
class_loss: 0.7452775239944458, distance_loss: 3.657437562942505
class_loss: 1.936378836631775, distance_loss: 3.8543951511383057
class_loss: 1.3461718559265137, distance_loss: 3.995023727416992
class_loss: 1.1737804412841797, distance_loss: 4.124546527862549
class_loss: 1.0762996673583984, distance_loss: 4.251473426818848
class_loss: 1.1182259321212769, distance_loss: 4.37697172164917
class_loss: 1.0652192831039429, distance_loss: 4.499006271362305
class_loss: 1.0363770723342896, distance_loss: 4.616488456726074
class_loss: 0.9111056923866272, distance_loss: 4.729049205780029
class_loss: 0.8915237188339233, distance_loss: 4.836893081665039
class_loss: 0.8906933665275574, distance_loss: 4.938638210296631
class_loss: 0.9672223329544067, distance_loss: 5.034547328948975
class_loss: 0.611548662185669, distance_loss: 5.122826099395752
___PoisonTrain Local_Simple ,  epoch  69, local model 70, internal_epoch   2,  Average loss: 0.0180, Accuracy: 386/724 (53.3149%), train_poison_data_count: 240
Global model norm: 15.099830555754592.
Norm before scaling: 15.407566718421737. Distance: 5.228793410801091
Total norm for 4 adversaries is: 15.407566718421737. distance: 5.228793410801091
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.1076, Accuracy: 8871/8968 (98.9184%)
___Train Local_Simple,  epoch  69, local model 74, internal_epoch   1,  Average loss: 0.0008, Accuracy: 549/557 (98.5637%)
___Train Local_Simple,  epoch  69, local model 74, internal_epoch   2,  Average loss: 0.0012, Accuracy: 545/557 (97.8456%)
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.1592, Accuracy: 9533/10000 (95.3300%)
poison local model 27 index 3
___PoisonTrain Local_Simple ,  epoch  69, local model 27, internal_epoch   1,  Average loss: 0.0339, Accuracy: 277/471 (58.8110%), train_poison_data_count: 160
class_loss: 4.705073356628418, distance_loss: 0.0
class_loss: 3.1643238067626953, distance_loss: 0.3743022680282593
class_loss: 1.0644001960754395, distance_loss: 0.9397178292274475
class_loss: 1.8200424909591675, distance_loss: 1.4477540254592896
class_loss: 1.3017667531967163, distance_loss: 1.8230332136154175
class_loss: 1.2930337190628052, distance_loss: 2.16717267036438
class_loss: 1.4423011541366577, distance_loss: 2.481278419494629
class_loss: 1.1968780755996704, distance_loss: 2.7598884105682373
class_loss: 1.2639073133468628, distance_loss: 3.027827262878418
class_loss: 1.0068480968475342, distance_loss: 3.2755792140960693
class_loss: 1.1039423942565918, distance_loss: 3.5030977725982666
class_loss: 0.8711771965026855, distance_loss: 3.7070882320404053
class_loss: 0.7161095142364502, distance_loss: 3.8937811851501465
class_loss: 0.6526803374290466, distance_loss: 4.066781997680664
class_loss: 0.4917171597480774, distance_loss: 4.230127334594727
class_loss: 0.46748214960098267, distance_loss: 4.388852596282959
___PoisonTrain Local_Simple ,  epoch  69, local model 27, internal_epoch   2,  Average loss: 0.0140, Accuracy: 303/471 (64.3312%), train_poison_data_count: 160
Global model norm: 15.099830555754592.
Norm before scaling: 15.21560642745067. Distance: 4.551876083765682
Total norm for 4 adversaries is: 15.21560642745067. distance: 4.551876083765682
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 0.1429, Accuracy: 8564/8968 (95.4951%)
time spent on training: 53.38805532455444
Starting performing KrMLRFL...
Num data points: [710, 880, 1160, 731, 182, 620, 1384, 724, 557, 471]
Num selected data points: [ 880 1160  731  182  557]
The chosen ones are users: [1, 2, 3, 4, 8], which are global users: [56, 12, 72, 79, 74]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 71, 70, 27]
base_p: [-2.9221848e-03  9.3843788e-05 -1.9009914e-03 ... -7.2944164e-04
 -4.1976795e-03 -2.3275614e-05]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 7, 9]
layer1_inf_time: 2.7705078125
[PAIRWISE] pred_attackers_indx:  [5 6 7 9]
layer2_inf_t: 29.61572265625
assumed final_attacker_idxs:  [0 5 6 7 9]
final_attacker_idxs is: [0 5 6 7 9]
g_attacker_idxs: [46 17 71 70 27]
g_normal_idxs: [56 12 72 79 74]
filtered_attacker_idxs: [0, 5, 6, 7, 9]
final_attacker_idxs are: [0, 5, 6, 7, 9]
num_dps: [710, 880, 1160, 731, 182, 620, 1384, 724, 557, 471]
epoch_acc: 98.38
___Test Local_Simple poisoned: False, epoch: 69: Average loss: 0.0479, Accuracy: 9838/10000 (98.3800%)
___Test Local_Simple poisoned: True, epoch: 69: Average loss: 13.9843, Accuracy: 21/8968 (0.2342%)
Done in 140.84282779693604 sec.
Server Epoch:70 choose agents : [4, 49, 74, 6, 16, 59, 46, 66, 84, 63].
___Train Local_Simple,  epoch  70, local model 4, internal_epoch   1,  Average loss: 0.0008, Accuracy: 643/658 (97.7204%)
___Train Local_Simple,  epoch  70, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 655/658 (99.5441%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.3597, Accuracy: 9066/10000 (90.6600%)
___Train Local_Simple,  epoch  70, local model 49, internal_epoch   1,  Average loss: 0.0008, Accuracy: 498/506 (98.4190%)
___Train Local_Simple,  epoch  70, local model 49, internal_epoch   2,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1157, Accuracy: 9620/10000 (96.2000%)
___Train Local_Simple,  epoch  70, local model 74, internal_epoch   1,  Average loss: 0.0006, Accuracy: 552/557 (99.1023%)
___Train Local_Simple,  epoch  70, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0936, Accuracy: 9710/10000 (97.1000%)
___Train Local_Simple,  epoch  70, local model 6, internal_epoch   1,  Average loss: 0.0007, Accuracy: 606/615 (98.5366%)
___Train Local_Simple,  epoch  70, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 611/615 (99.3496%)
class_loss: 3.9963877201080322, distance_loss: 0.0
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0881, Accuracy: 9732/10000 (97.3200%)
poison local model 16 index 0
___PoisonTrain Local_Simple ,  epoch  70, local model 16, internal_epoch   1,  Average loss: 0.0256, Accuracy: 483/915 (52.7869%), train_poison_data_count: 299
class_loss: 2.400970935821533, distance_loss: 0.3198290467262268
class_loss: 2.135932683944702, distance_loss: 0.7879104018211365
class_loss: 1.4691635370254517, distance_loss: 1.2469433546066284
class_loss: 1.4095300436019897, distance_loss: 1.6469465494155884
class_loss: 1.2060846090316772, distance_loss: 2.006619453430176
class_loss: 1.411271333694458, distance_loss: 2.323077440261841
class_loss: 1.352817416191101, distance_loss: 2.596798896789551
class_loss: 1.2261544466018677, distance_loss: 2.8313705921173096
class_loss: 1.120046615600586, distance_loss: 3.0413732528686523
class_loss: 1.027174949645996, distance_loss: 3.2319788932800293
class_loss: 0.9899051785469055, distance_loss: 3.403019666671753
class_loss: 1.0278511047363281, distance_loss: 3.5587949752807617
class_loss: 0.9675087332725525, distance_loss: 3.7001290321350098
class_loss: 1.6994524002075195, distance_loss: 3.8326289653778076
class_loss: 1.370124101638794, distance_loss: 4.011824131011963
class_loss: 1.6251322031021118, distance_loss: 4.171144485473633
class_loss: 1.2936586141586304, distance_loss: 4.308324337005615
class_loss: 1.1924972534179688, distance_loss: 4.442860126495361
class_loss: 1.0862360000610352, distance_loss: 4.573507308959961
class_loss: 1.1891942024230957, distance_loss: 4.695322513580322
class_loss: 1.1662060022354126, distance_loss: 4.808469295501709
class_loss: 1.2527540922164917, distance_loss: 4.912892818450928
class_loss: 1.1187872886657715, distance_loss: 5.0085835456848145
class_loss: 1.0141664743423462, distance_loss: 5.09734582901001
class_loss: 0.9512310028076172, distance_loss: 5.180393695831299
class_loss: 0.9301477074623108, distance_loss: 5.258130073547363
class_loss: 0.8502228260040283, distance_loss: 5.3322319984436035
class_loss: 0.888361394405365, distance_loss: 5.401593208312988
class_loss: 1.49057936668396, distance_loss: 5.463900089263916
___PoisonTrain Local_Simple ,  epoch  70, local model 16, internal_epoch   2,  Average loss: 0.0190, Accuracy: 467/915 (51.0383%), train_poison_data_count: 299
Global model norm: 15.065059207023808.
Norm before scaling: 15.409126926174407. Distance: 5.543838744544496
Total norm for 2 adversaries is: 15.409126926174407. distance: 5.543838744544496
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.6994, Accuracy: 6020/8968 (67.1276%)
___Train Local_Simple,  epoch  70, local model 59, internal_epoch   1,  Average loss: 0.0008, Accuracy: 747/760 (98.2895%)
___Train Local_Simple,  epoch  70, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 748/760 (98.4211%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1331, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  70, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 700/710 (98.5915%)
___Train Local_Simple,  epoch  70, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 705/710 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1406, Accuracy: 9543/10000 (95.4300%)
___Train Local_Simple,  epoch  70, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 652/660 (98.7879%)
___Train Local_Simple,  epoch  70, local model 66, internal_epoch   2,  Average loss: 0.0003, Accuracy: 656/660 (99.3939%)
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.1306, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  70, local model 84, internal_epoch   1,  Average loss: 0.0012, Accuracy: 1220/1246 (97.9133%)
___Train Local_Simple,  epoch  70, local model 84, internal_epoch   2,  Average loss: 0.0012, Accuracy: 1218/1246 (97.7528%)
class_loss: 2.9795777797698975, distance_loss: 0.0
class_loss: 3.3227829933166504, distance_loss: 0.2271084487438202
class_loss: 1.5443923473358154, distance_loss: 0.6699747443199158
class_loss: 1.2493714094161987, distance_loss: 1.1639913320541382
class_loss: 1.7658864259719849, distance_loss: 1.5496248006820679
class_loss: 1.2749321460723877, distance_loss: 1.8805080652236938
class_loss: 1.3229117393493652, distance_loss: 2.178279399871826
class_loss: 1.4152928590774536, distance_loss: 2.441713571548462
class_loss: 1.3368645906448364, distance_loss: 2.6710970401763916
class_loss: 1.1709328889846802, distance_loss: 2.871567726135254
class_loss: 1.0575233697891235, distance_loss: 3.052622079849243
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0944, Accuracy: 9702/10000 (97.0200%)
poison local model 63 index 1
___PoisonTrain Local_Simple ,  epoch  70, local model 63, internal_epoch   1,  Average loss: 0.0241, Accuracy: 473/889 (53.2058%), train_poison_data_count: 280
class_loss: 0.8909165859222412, distance_loss: 3.2182884216308594
class_loss: 0.9527341723442078, distance_loss: 3.3750429153442383
class_loss: 1.1041239500045776, distance_loss: 3.517794132232666
class_loss: 0.9782407283782959, distance_loss: 3.6520047187805176
class_loss: 0.8292316794395447, distance_loss: 3.776939630508423
class_loss: 0.9650353789329529, distance_loss: 3.8922066688537598
class_loss: 0.7577733993530273, distance_loss: 4.005985736846924
class_loss: 0.6590924263000488, distance_loss: 4.118004322052002
class_loss: 0.9279135465621948, distance_loss: 4.216761589050293
class_loss: 0.804596483707428, distance_loss: 4.300108909606934
class_loss: 0.8783805966377258, distance_loss: 4.3733062744140625
class_loss: 0.6860217452049255, distance_loss: 4.441182613372803
class_loss: 0.7101478576660156, distance_loss: 4.505717754364014
class_loss: 0.7178366780281067, distance_loss: 4.563624858856201
class_loss: 0.8583034873008728, distance_loss: 4.619389057159424
class_loss: 0.7638120651245117, distance_loss: 4.66823673248291
class_loss: 0.8976064324378967, distance_loss: 4.714897155761719
___PoisonTrain Local_Simple ,  epoch  70, local model 63, internal_epoch   2,  Average loss: 0.0129, Accuracy: 564/889 (63.4421%), train_poison_data_count: 280
Global model norm: 15.065059207023808.
Norm before scaling: 15.27185543676489. Distance: 4.761213017583199
Total norm for 2 adversaries is: 15.27185543676489. distance: 4.761213017583199
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 0.8522, Accuracy: 4933/8968 (55.0067%)
time spent on training: 40.71480703353882
Starting performing KrMLRFL...
Num data points: [658, 506, 557, 615, 915, 760, 710, 660, 1246, 889]
Num selected data points: [658 506 557 615 660]
The chosen ones are users: [0, 1, 2, 3, 7], which are global users: [4, 49, 74, 6, 66]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 63]
base_p: [-0.00832164  0.00041075 -0.00073866 ... -0.00170708 -0.00229079
  0.00260687]
[T_SCORE] attacker_local_idxs is:  [4, 5, 6, 8, 9]
layer1_inf_time: 3.0986328125
[PAIRWISE] pred_attackers_indx:  [4 9]
layer2_inf_t: 28.797607421875
assumed final_attacker_idxs:  [4 5 6 8 9]
final_attacker_idxs is: [4 5 6 8 9]
g_attacker_idxs: [16 59 46 84 63]
g_normal_idxs: [ 4 49 74  6 66]
filtered_attacker_idxs: [4, 5, 6, 8, 9]
final_attacker_idxs are: [4, 5, 6, 8, 9]
num_dps: [658, 506, 557, 615, 915, 760, 710, 660, 1246, 889]
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: False, epoch: 70: Average loss: 0.0418, Accuracy: 9874/10000 (98.7400%)
___Test Local_Simple poisoned: True, epoch: 70: Average loss: 13.7121, Accuracy: 17/8968 (0.1896%)
Done in 127.44055485725403 sec.
Server Epoch:71 choose agents : [23, 92, 22, 91, 70, 58, 35, 12, 55, 94].
___Train Local_Simple,  epoch  71, local model 23, internal_epoch   1,  Average loss: 0.0005, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  71, local model 23, internal_epoch   2,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0786, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch  71, local model 92, internal_epoch   1,  Average loss: 0.0008, Accuracy: 922/937 (98.3991%)
___Train Local_Simple,  epoch  71, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 932/937 (99.4664%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.2388, Accuracy: 9205/10000 (92.0500%)
poison local model 22 index 0
___Train Local_Simple,  epoch  71, local model 22, internal_epoch   1,  Average loss: 0.0011, Accuracy: 573/583 (98.2847%)
___Train Local_Simple,  epoch  71, local model 22, internal_epoch   2,  Average loss: 0.0004, Accuracy: 580/583 (99.4854%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1744, Accuracy: 9468/10000 (94.6800%)
poison local model 91 index 1
___Train Local_Simple,  epoch  71, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch  71, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0507, Accuracy: 9842/10000 (98.4200%)
poison local model 70 index 2
___Train Local_Simple,  epoch  71, local model 70, internal_epoch   1,  Average loss: 0.0006, Accuracy: 715/724 (98.7569%)
___Train Local_Simple,  epoch  71, local model 70, internal_epoch   2,  Average loss: 0.0003, Accuracy: 722/724 (99.7238%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1903, Accuracy: 9421/10000 (94.2100%)
___Train Local_Simple,  epoch  71, local model 58, internal_epoch   1,  Average loss: 0.0005, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch  71, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 273/276 (98.9130%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0674, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch  71, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch  71, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0708, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch  71, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1144/1160 (98.6207%)
___Train Local_Simple,  epoch  71, local model 12, internal_epoch   2,  Average loss: 0.0017, Accuracy: 1129/1160 (97.3276%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.2742, Accuracy: 9144/10000 (91.4400%)
___Train Local_Simple,  epoch  71, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 347/354 (98.0226%)
___Train Local_Simple,  epoch  71, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.6092, Accuracy: 8302/10000 (83.0200%)
___Train Local_Simple,  epoch  71, local model 94, internal_epoch   1,  Average loss: 0.0011, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch  71, local model 94, internal_epoch   2,  Average loss: 0.0003, Accuracy: 149/150 (99.3333%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 91, 70]
base_p: [ 0.00137674  0.00030479  0.00050669 ... -0.00201839 -0.00097159
  0.00248407]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 7]
layer1_inf_time: 2.624755859375
[PAIRWISE] pred_attackers_indx:  [7]
layer2_inf_t: 29.421630859375
assumed final_attacker_idxs:  [1 2 3 4 7]
final_attacker_idxs is: [1 2 3 4 7]
g_attacker_idxs: [92 22 91 70 12]
g_normal_idxs: [23 58 35 55 94]
filtered_attacker_idxs: [1, 2, 3, 4, 7]
final_attacker_idxs are: [1, 2, 3, 4, 7]
num_dps: [293, 937, 583, 256, 724, 276, 499, 1160, 354, 150]
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.1660, Accuracy: 9362/10000 (93.6200%)
time spent on training: 38.62126350402832
Starting performing KrMLRFL...
Num data points: [293, 937, 583, 256, 724, 276, 499, 1160, 354, 150]
Num selected data points: [293 276 499 354 150]
The chosen ones are users: [0, 5, 6, 8, 9], which are global users: [23, 58, 35, 55, 94]
___Test Local_Simple poisoned: False, epoch: 71: Average loss: 0.0492, Accuracy: 9849/10000 (98.4900%)
epoch_acc: 98.49
___Test Local_Simple poisoned: True, epoch: 71: Average loss: 13.2229, Accuracy: 41/8968 (0.4572%)
Done in 128.08249521255493 sec.
Server Epoch:72 choose agents : [60, 54, 79, 77, 63, 99, 67, 88, 28, 37].
___Train Local_Simple,  epoch  72, local model 60, internal_epoch   1,  Average loss: 0.0006, Accuracy: 333/338 (98.5207%)
___Train Local_Simple,  epoch  72, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0921, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch  72, local model 54, internal_epoch   1,  Average loss: 0.0006, Accuracy: 512/519 (98.6513%)
___Train Local_Simple,  epoch  72, local model 54, internal_epoch   2,  Average loss: 0.0004, Accuracy: 511/519 (98.4586%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1186, Accuracy: 9647/10000 (96.4700%)
___Train Local_Simple,  epoch  72, local model 79, internal_epoch   1,  Average loss: 0.0006, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch  72, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0606, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch  72, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch  72, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 586/589 (99.4907%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0585, Accuracy: 9829/10000 (98.2900%)
poison local model 63 index 0
___Train Local_Simple,  epoch  72, local model 63, internal_epoch   1,  Average loss: 0.0014, Accuracy: 861/889 (96.8504%)
___Train Local_Simple,  epoch  72, local model 63, internal_epoch   2,  Average loss: 0.0009, Accuracy: 877/889 (98.6502%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0773, Accuracy: 9757/10000 (97.5700%)
___Train Local_Simple,  epoch  72, local model 99, internal_epoch   1,  Average loss: 0.0004, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch  72, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0482, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch  72, local model 67, internal_epoch   1,  Average loss: 0.0007, Accuracy: 982/998 (98.3968%)
___Train Local_Simple,  epoch  72, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 996/998 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0892, Accuracy: 9714/10000 (97.1400%)
___Train Local_Simple,  epoch  72, local model 88, internal_epoch   1,  Average loss: 0.0004, Accuracy: 527/530 (99.4340%)
___Train Local_Simple,  epoch  72, local model 88, internal_epoch   2,  Average loss: 0.0001, Accuracy: 529/530 (99.8113%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1214, Accuracy: 9641/10000 (96.4100%)
___Train Local_Simple,  epoch  72, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch  72, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0517, Accuracy: 9839/10000 (98.3900%)
___Train Local_Simple,  epoch  72, local model 37, internal_epoch   1,  Average loss: 0.0003, Accuracy: 854/860 (99.3023%)
___Train Local_Simple,  epoch  72, local model 37, internal_epoch   2,  Average loss: 0.0002, Accuracy: 857/860 (99.6512%)
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.1681, Accuracy: 9521/10000 (95.2100%)
time spent on training: 32.56661248207092
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63]
base_p: [ 0.00311247  0.000337   -0.00055288 ...  0.00052118 -0.00078046
  0.00066768]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 9]
layer1_inf_time: 3.253173828125
[PAIRWISE] pred_attackers_indx:  [1 4 7 9]
layer2_inf_t: 43.749267578125
assumed final_attacker_idxs:  [1 3 4 6 7 9]
final_attacker_idxs is: [1 3 4 6 7 9]
g_attacker_idxs: [54 77 63 67 88 37]
g_normal_idxs: [60 79 99 28]
filtered_attacker_idxs: [3, 4, 6, 7, 9]
final_attacker_idxs are: [3, 4, 6, 7, 9]
num_dps: [338, 519, 182, 589, 889, 377, 998, 530, 501, 860]
Starting performing KrMLRFL...
Num data points: [338, 519, 182, 589, 889, 377, 998, 530, 501, 860]
Num selected data points: [338 519 182 377 501]
The chosen ones are users: [0, 1, 2, 5, 8], which are global users: [60, 54, 79, 99, 28]
___Test Local_Simple poisoned: False, epoch: 72: Average loss: 0.0432, Accuracy: 9876/10000 (98.7600%)
epoch_acc: 98.76
___Test Local_Simple poisoned: True, epoch: 72: Average loss: 14.7691, Accuracy: 10/8968 (0.1115%)
Done in 111.97300434112549 sec.
Server Epoch:73 choose agents : [4, 88, 6, 99, 49, 69, 66, 79, 36, 64].
___Train Local_Simple,  epoch  73, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 655/658 (99.5441%)
___Train Local_Simple,  epoch  73, local model 4, internal_epoch   2,  Average loss: 0.0003, Accuracy: 653/658 (99.2401%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0819, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch  73, local model 88, internal_epoch   1,  Average loss: 0.0005, Accuracy: 525/530 (99.0566%)
___Train Local_Simple,  epoch  73, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1737, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch  73, local model 6, internal_epoch   1,  Average loss: 0.0004, Accuracy: 610/615 (99.1870%)
___Train Local_Simple,  epoch  73, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1119, Accuracy: 9646/10000 (96.4600%)
___Train Local_Simple,  epoch  73, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch  73, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0464, Accuracy: 9850/10000 (98.5000%)
___Train Local_Simple,  epoch  73, local model 49, internal_epoch   1,  Average loss: 0.0003, Accuracy: 502/506 (99.2095%)
___Train Local_Simple,  epoch  73, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0849, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch  73, local model 69, internal_epoch   1,  Average loss: 0.0012, Accuracy: 252/256 (98.4375%)
___Train Local_Simple,  epoch  73, local model 69, internal_epoch   2,  Average loss: 0.0004, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1357, Accuracy: 9553/10000 (95.5300%)
___Train Local_Simple,  epoch  73, local model 66, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/660 (98.9394%)
___Train Local_Simple,  epoch  73, local model 66, internal_epoch   2,  Average loss: 0.0002, Accuracy: 658/660 (99.6970%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.4844, Accuracy: 8901/10000 (89.0100%)
___Train Local_Simple,  epoch  73, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch  73, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0518, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch  73, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 985/1005 (98.0100%)
___Train Local_Simple,  epoch  73, local model 36, internal_epoch   2,  Average loss: 0.0011, Accuracy: 983/1005 (97.8109%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.2431, Accuracy: 9204/10000 (92.0400%)
___Train Local_Simple,  epoch  73, local model 64, internal_epoch   1,  Average loss: 0.0009, Accuracy: 798/813 (98.1550%)
___Train Local_Simple,  epoch  73, local model 64, internal_epoch   2,  Average loss: 0.0004, Accuracy: 804/813 (98.8930%)
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.1594, Accuracy: 9480/10000 (94.8000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [-1.5452504e-05  3.1751022e-04 -1.8150806e-03 ... -2.9469430e-03
 -2.2350997e-03 -1.5644729e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 6, 8, 9]
layer1_inf_time: 3.453857421875
[PAIRWISE] pred_attackers_indx:  [1 8]
layer2_inf_t: 38.3916015625
assumed final_attacker_idxs:  [0 1 6 8 9]
final_attacker_idxs is: [0 1 6 8 9]
g_attacker_idxs: [ 4 88 66 36 64]
g_normal_idxs: [ 6 99 49 69 79]
filtered_attacker_idxs: [0, 1, 6, 8]
final_attacker_idxs are: [0, 1, 6, 8]
num_dps: [658, 530, 615, 377, 506, 256, 660, 182, 1005, 813]
time spent on training: 32.798022508621216
Starting performing KrMLRFL...
Num data points: [658, 530, 615, 377, 506, 256, 660, 182, 1005, 813]
Num selected data points: [615 377 506 256 182 813]
The chosen ones are users: [2, 3, 4, 5, 7, 9], which are global users: [6, 99, 49, 69, 79, 64]
___Test Local_Simple poisoned: False, epoch: 73: Average loss: 0.0474, Accuracy: 9854/10000 (98.5400%)
epoch_acc: 98.54
___Test Local_Simple poisoned: True, epoch: 73: Average loss: 13.4814, Accuracy: 22/8968 (0.2453%)
Done in 113.50472354888916 sec.
Server Epoch:74 choose agents : [33, 90, 7, 26, 13, 51, 24, 40, 35, 98].
___Train Local_Simple,  epoch  74, local model 33, internal_epoch   1,  Average loss: 0.0009, Accuracy: 612/623 (98.2343%)
___Train Local_Simple,  epoch  74, local model 33, internal_epoch   2,  Average loss: 0.0002, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1312, Accuracy: 9579/10000 (95.7900%)
___Train Local_Simple,  epoch  74, local model 90, internal_epoch   1,  Average loss: 0.0005, Accuracy: 679/683 (99.4143%)
___Train Local_Simple,  epoch  74, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.4527, Accuracy: 8861/10000 (88.6100%)
poison local model 7 index 0
___Train Local_Simple,  epoch  74, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 411/418 (98.3254%)
___Train Local_Simple,  epoch  74, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1055, Accuracy: 9652/10000 (96.5200%)
poison local model 26 index 1
___Train Local_Simple,  epoch  74, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 546/554 (98.5560%)
___Train Local_Simple,  epoch  74, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.0827, Accuracy: 9724/10000 (97.2400%)
poison local model 13 index 2
___Train Local_Simple,  epoch  74, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 719/734 (97.9564%)
___Train Local_Simple,  epoch  74, local model 13, internal_epoch   2,  Average loss: 0.0012, Accuracy: 722/734 (98.3651%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.4269, Accuracy: 8818/10000 (88.1800%)
poison local model 51 index 3
___Train Local_Simple,  epoch  74, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%)
___Train Local_Simple,  epoch  74, local model 51, internal_epoch   2,  Average loss: 0.0009, Accuracy: 562/568 (98.9437%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.2164, Accuracy: 9348/10000 (93.4800%)
___Train Local_Simple,  epoch  74, local model 24, internal_epoch   1,  Average loss: 0.0006, Accuracy: 373/379 (98.4169%)
___Train Local_Simple,  epoch  74, local model 24, internal_epoch   2,  Average loss: 0.0005, Accuracy: 375/379 (98.9446%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1292, Accuracy: 9617/10000 (96.1700%)
___Train Local_Simple,  epoch  74, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 765/772 (99.0933%)
___Train Local_Simple,  epoch  74, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1008, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  74, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 499/499 (100.0000%)
___Train Local_Simple,  epoch  74, local model 35, internal_epoch   2,  Average loss: 0.0000, Accuracy: 499/499 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.0635, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch  74, local model 98, internal_epoch   1,  Average loss: 0.0005, Accuracy: 809/818 (98.8998%)
___Train Local_Simple,  epoch  74, local model 98, internal_epoch   2,  Average loss: 0.0001, Accuracy: 817/818 (99.8778%)
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.1914, Accuracy: 9430/10000 (94.3000%)
time spent on training: 42.885995864868164
Starting performing KrMLRFL...
Num data points: [623, 683, 418, 554, 734, 568, 379, 772, 499, 818]
Num selected data points: [623 683 379 499]
The chosen ones are users: [0, 1, 6, 8], which are global users: [33, 90, 24, 35]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 26, 13, 51]
base_p: [-0.00034027  0.00029584 -0.00039446 ...  0.00133677 -0.00196117
  0.00061835]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 9]
layer1_inf_time: 6.104736328125
[PAIRWISE] pred_attackers_indx:  [2 3 4 5 7]
layer2_inf_t: 98.37158203125
assumed final_attacker_idxs:  [2 3 4 5 7 9]
final_attacker_idxs is: [2 3 4 5 7 9]
g_attacker_idxs: [ 7 26 13 51 40 98]
g_normal_idxs: [33 90 24 35]
filtered_attacker_idxs: [2, 3, 4, 5, 7, 9]
final_attacker_idxs are: [2, 3, 4, 5, 7, 9]
num_dps: [623, 683, 418, 554, 734, 568, 379, 772, 499, 818]
___Test Local_Simple poisoned: False, epoch: 74: Average loss: 0.0497, Accuracy: 9840/10000 (98.4000%)
epoch_acc: 98.4
___Test Local_Simple poisoned: True, epoch: 74: Average loss: 15.1821, Accuracy: 4/8968 (0.0446%)
Done in 136.31206846237183 sec.
Server Epoch:75 choose agents : [46, 27, 26, 85, 41, 77, 52, 61, 3, 82].
___Train Local_Simple,  epoch  75, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 693/710 (97.6056%)
___Train Local_Simple,  epoch  75, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 700/710 (98.5915%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.3019, Accuracy: 9067/10000 (90.6700%)
poison local model 27 index 0
___Train Local_Simple,  epoch  75, local model 27, internal_epoch   1,  Average loss: 0.0011, Accuracy: 461/471 (97.8769%)
___Train Local_Simple,  epoch  75, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 466/471 (98.9384%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.3772, Accuracy: 9122/10000 (91.2200%)
poison local model 26 index 1
___Train Local_Simple,  epoch  75, local model 26, internal_epoch   1,  Average loss: 0.0006, Accuracy: 545/554 (98.3755%)
___Train Local_Simple,  epoch  75, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.0769, Accuracy: 9754/10000 (97.5400%)
poison local model 85 index 2
___Train Local_Simple,  epoch  75, local model 85, internal_epoch   1,  Average loss: 0.0003, Accuracy: 428/431 (99.3039%)
___Train Local_Simple,  epoch  75, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.0837, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch  75, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 600/606 (99.0099%)
___Train Local_Simple,  epoch  75, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.0876, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch  75, local model 77, internal_epoch   1,  Average loss: 0.0008, Accuracy: 584/589 (99.1511%)
___Train Local_Simple,  epoch  75, local model 77, internal_epoch   2,  Average loss: 0.0006, Accuracy: 584/589 (99.1511%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.0657, Accuracy: 9800/10000 (98.0000%)
poison local model 52 index 3
___Train Local_Simple,  epoch  75, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch  75, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1238, Accuracy: 9641/10000 (96.4100%)
poison local model 61 index 0
___Train Local_Simple,  epoch  75, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 688/699 (98.4263%)
___Train Local_Simple,  epoch  75, local model 61, internal_epoch   2,  Average loss: 0.0006, Accuracy: 692/699 (98.9986%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.2328, Accuracy: 9158/10000 (91.5800%)
___Train Local_Simple,  epoch  75, local model 3, internal_epoch   1,  Average loss: 0.0009, Accuracy: 908/923 (98.3749%)
___Train Local_Simple,  epoch  75, local model 3, internal_epoch   2,  Average loss: 0.0004, Accuracy: 916/923 (99.2416%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1357, Accuracy: 9562/10000 (95.6200%)
___Train Local_Simple,  epoch  75, local model 82, internal_epoch   1,  Average loss: 0.0002, Accuracy: 711/713 (99.7195%)
___Train Local_Simple,  epoch  75, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.1461, Accuracy: 9520/10000 (95.2000%)
time spent on training: 46.45976734161377
Starting performing KrMLRFL...
Num data points: [710, 471, 554, 431, 606, 589, 253, 699, 923, 713]
Num selected data points: [606 589 923 713]
The chosen ones are users: [4, 5, 8, 9], which are global users: [41, 77, 3, 82]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 26, 85, 52, 61]
base_p: [ 3.0843168e-04  3.3348054e-04 -1.8748082e-04 ...  5.0336123e-05
  3.2469332e-03 -7.7711046e-04]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 6, 7]
layer1_inf_time: 3.6328125
[PAIRWISE] pred_attackers_indx:  [0 4 7]
layer2_inf_t: 29.60595703125
assumed final_attacker_idxs:  [0 1 2 3 4 6 7]
final_attacker_idxs is: [0 1 2 3 4 6 7]
g_attacker_idxs: [46 27 26 85 41 52 61]
g_normal_idxs: [77  3 82]
filtered_attacker_idxs: [0, 1, 2, 3, 6, 7]
final_attacker_idxs are: [0, 1, 2, 3, 6, 7]
num_dps: [710, 471, 554, 431, 606, 589, 253, 699, 923, 713]
epoch_acc: 98.69
___Test Local_Simple poisoned: False, epoch: 75: Average loss: 0.0410, Accuracy: 9869/10000 (98.6900%)
___Test Local_Simple poisoned: True, epoch: 75: Average loss: 13.7697, Accuracy: 20/8968 (0.2230%)
Done in 130.22908210754395 sec.
Server Epoch:76 choose agents : [78, 9, 54, 62, 26, 53, 28, 22, 94, 70].
___Train Local_Simple,  epoch  76, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch  76, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0966, Accuracy: 9706/10000 (97.0600%)
___Train Local_Simple,  epoch  76, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch  76, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0617, Accuracy: 9809/10000 (98.0900%)
___Train Local_Simple,  epoch  76, local model 54, internal_epoch   1,  Average loss: 0.0005, Accuracy: 516/519 (99.4220%)
___Train Local_Simple,  epoch  76, local model 54, internal_epoch   2,  Average loss: 0.0011, Accuracy: 508/519 (97.8805%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.7097, Accuracy: 8621/10000 (86.2100%)
___Train Local_Simple,  epoch  76, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch  76, local model 62, internal_epoch   2,  Average loss: 0.0006, Accuracy: 418/423 (98.8180%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1058, Accuracy: 9672/10000 (96.7200%)
poison local model 26 index 0
___Train Local_Simple,  epoch  76, local model 26, internal_epoch   1,  Average loss: 0.0005, Accuracy: 547/554 (98.7365%)
___Train Local_Simple,  epoch  76, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0913, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch  76, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 726/739 (98.2409%)
___Train Local_Simple,  epoch  76, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.2068, Accuracy: 9392/10000 (93.9200%)
___Train Local_Simple,  epoch  76, local model 28, internal_epoch   1,  Average loss: 0.0003, Accuracy: 496/501 (99.0020%)
___Train Local_Simple,  epoch  76, local model 28, internal_epoch   2,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0625, Accuracy: 9814/10000 (98.1400%)
poison local model 22 index 1
___Train Local_Simple,  epoch  76, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 576/583 (98.7993%)
___Train Local_Simple,  epoch  76, local model 22, internal_epoch   2,  Average loss: 0.0004, Accuracy: 578/583 (99.1424%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1134, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch  76, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  76, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1392, Accuracy: 9502/10000 (95.0200%)
poison local model 70 index 2
___Train Local_Simple,  epoch  76, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 712/724 (98.3425%)
___Train Local_Simple,  epoch  76, local model 70, internal_epoch   2,  Average loss: 0.0004, Accuracy: 719/724 (99.3094%)
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.1777, Accuracy: 9445/10000 (94.4500%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 22, 70]
base_p: [-0.00061225  0.00025111  0.00018521 ... -0.00120996 -0.00037211
 -0.00093579]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 9]
layer1_inf_time: 3.0908203125
time spent on training: 43.28299331665039
Starting performing KrMLRFL...
Num data points: [303, 436, 519, 423, 554, 739, 501, 583, 150, 724]
Num selected data points: [303 436 519 423 501 150]
The chosen ones are users: [0, 1, 2, 3, 6, 8], which are global users: [78, 9, 54, 62, 28, 94]
[PAIRWISE] pred_attackers_indx:  [2]
layer2_inf_t: 385.276611328125
assumed final_attacker_idxs:  [2 4 5 7 9]
final_attacker_idxs is: [2 4 5 7 9]
g_attacker_idxs: [54 26 53 22 70]
g_normal_idxs: [78  9 62 28 94]
filtered_attacker_idxs: [4, 5, 7, 9]
final_attacker_idxs are: [4, 5, 7, 9]
num_dps: [303, 436, 519, 423, 554, 739, 501, 583, 150, 724]
epoch_acc: 97.87
___Test Local_Simple poisoned: False, epoch: 76: Average loss: 0.0640, Accuracy: 9787/10000 (97.8700%)
___Test Local_Simple poisoned: True, epoch: 76: Average loss: 13.3971, Accuracy: 151/8968 (1.6838%)
Done in 123.61604881286621 sec.
Server Epoch:77 choose agents : [68, 69, 90, 8, 66, 70, 0, 14, 40, 45].
___Train Local_Simple,  epoch  77, local model 68, internal_epoch   1,  Average loss: 0.0005, Accuracy: 488/494 (98.7854%)
___Train Local_Simple,  epoch  77, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1242, Accuracy: 9618/10000 (96.1800%)
___Train Local_Simple,  epoch  77, local model 69, internal_epoch   1,  Average loss: 0.0008, Accuracy: 251/256 (98.0469%)
___Train Local_Simple,  epoch  77, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1048, Accuracy: 9649/10000 (96.4900%)
___Train Local_Simple,  epoch  77, local model 90, internal_epoch   1,  Average loss: 0.0004, Accuracy: 678/683 (99.2679%)
___Train Local_Simple,  epoch  77, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1707, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch  77, local model 8, internal_epoch   1,  Average loss: 0.0005, Accuracy: 626/633 (98.8942%)
___Train Local_Simple,  epoch  77, local model 8, internal_epoch   2,  Average loss: 0.0006, Accuracy: 626/633 (98.8942%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.0574, Accuracy: 9834/10000 (98.3400%)
___Train Local_Simple,  epoch  77, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 651/660 (98.6364%)
___Train Local_Simple,  epoch  77, local model 66, internal_epoch   2,  Average loss: 0.0008, Accuracy: 646/660 (97.8788%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2135, Accuracy: 9377/10000 (93.7700%)
poison local model 70 index 0
___Train Local_Simple,  epoch  77, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 712/724 (98.3425%)
___Train Local_Simple,  epoch  77, local model 70, internal_epoch   2,  Average loss: 0.0006, Accuracy: 713/724 (98.4807%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2094, Accuracy: 9303/10000 (93.0300%)
___Train Local_Simple,  epoch  77, local model 0, internal_epoch   1,  Average loss: 0.0009, Accuracy: 427/435 (98.1609%)
___Train Local_Simple,  epoch  77, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.2204, Accuracy: 9336/10000 (93.3600%)
___Train Local_Simple,  epoch  77, local model 14, internal_epoch   1,  Average loss: 0.0008, Accuracy: 369/376 (98.1383%)
___Train Local_Simple,  epoch  77, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 372/376 (98.9362%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1295, Accuracy: 9582/10000 (95.8200%)
___Train Local_Simple,  epoch  77, local model 40, internal_epoch   1,  Average loss: 0.0003, Accuracy: 768/772 (99.4819%)
___Train Local_Simple,  epoch  77, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 767/772 (99.3523%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1583, Accuracy: 9561/10000 (95.6100%)
poison local model 45 index 1
___Train Local_Simple,  epoch  77, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 616/628 (98.0892%)
___Train Local_Simple,  epoch  77, local model 45, internal_epoch   2,  Average loss: 0.0007, Accuracy: 622/628 (99.0446%)
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.1596, Accuracy: 9552/10000 (95.5200%)
time spent on training: 36.89084768295288
Starting performing KrMLRFL...
Num data points: [494, 256, 683, 633, 660, 724, 435, 376, 772, 628]
Num selected data points: [494 256 683 633 435 376]
The chosen ones are users: [0, 1, 2, 3, 6, 7], which are global users: [68, 69, 90, 8, 0, 14]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 45]
base_p: [-0.00039125  0.00030795  0.00040833 ... -0.00169417 -0.00423172
 -0.00205269]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 8, 9]
layer1_inf_time: 2.654052734375
[PAIRWISE] pred_attackers_indx:  [6 9]
layer2_inf_t: 31.99267578125
assumed final_attacker_idxs:  [2 4 5 6 8 9]
final_attacker_idxs is: [2 4 5 6 8 9]
g_attacker_idxs: [90 66 70  0 40 45]
g_normal_idxs: [68 69  8 14]
filtered_attacker_idxs: [4, 5, 8, 9]
final_attacker_idxs are: [4, 5, 8, 9]
num_dps: [494, 256, 683, 633, 660, 724, 435, 376, 772, 628]
___Test Local_Simple poisoned: False, epoch: 77: Average loss: 0.0414, Accuracy: 9870/10000 (98.7000%)
epoch_acc: 98.7
___Test Local_Simple poisoned: True, epoch: 77: Average loss: 15.0586, Accuracy: 11/8968 (0.1227%)
Done in 125.77379870414734 sec.
Server Epoch:78 choose agents : [23, 19, 72, 15, 37, 80, 27, 95, 1, 46].
___Train Local_Simple,  epoch  78, local model 23, internal_epoch   1,  Average loss: 0.0003, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  78, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0551, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch  78, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch  78, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0515, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch  78, local model 72, internal_epoch   1,  Average loss: 0.0002, Accuracy: 729/731 (99.7264%)
___Train Local_Simple,  epoch  78, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0771, Accuracy: 9768/10000 (97.6800%)
___Train Local_Simple,  epoch  78, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch  78, local model 15, internal_epoch   2,  Average loss: 0.0004, Accuracy: 397/401 (99.0025%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0857, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch  78, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 850/860 (98.8372%)
___Train Local_Simple,  epoch  78, local model 37, internal_epoch   2,  Average loss: 0.0001, Accuracy: 860/860 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1008, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  78, local model 80, internal_epoch   1,  Average loss: 0.0005, Accuracy: 428/431 (99.3039%)
___Train Local_Simple,  epoch  78, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1021, Accuracy: 9710/10000 (97.1000%)
poison local model 27 index 0
___Train Local_Simple,  epoch  78, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch  78, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.2148, Accuracy: 9381/10000 (93.8100%)
___Train Local_Simple,  epoch  78, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch  78, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.3947, Accuracy: 8670/10000 (86.7000%)
poison local model 1 index 1
___Train Local_Simple,  epoch  78, local model 1, internal_epoch   1,  Average loss: 0.0009, Accuracy: 746/760 (98.1579%)
___Train Local_Simple,  epoch  78, local model 1, internal_epoch   2,  Average loss: 0.0003, Accuracy: 755/760 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.2128, Accuracy: 9243/10000 (92.4300%)
___Train Local_Simple,  epoch  78, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch  78, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 704/710 (99.1549%)
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.1643, Accuracy: 9475/10000 (94.7500%)
time spent on training: 35.85936212539673
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 1]
base_p: [ 0.00180923  0.00030069 -0.00013408 ... -0.00164242 -0.00047095
  0.0001659 ]
[T_SCORE] attacker_local_idxs is:  [4, 6, 7, 8, 9]
layer1_inf_time: 2.30859375
[PAIRWISE] pred_attackers_indx:  [5 6 8 9]
layer2_inf_t: 25.853515625
assumed final_attacker_idxs:  [4 5 6 7 8 9]
final_attacker_idxs is: [4 5 6 7 8 9]
g_attacker_idxs: [37 80 27 95  1 46]
g_normal_idxs: [23 19 72 15]
filtered_attacker_idxs: [4, 6, 7, 8, 9]
final_attacker_idxs are: [4, 6, 7, 8, 9]
num_dps: [293, 205, 731, 401, 860, 431, 471, 602, 760, 710]
Starting performing KrMLRFL...
Num data points: [293, 205, 731, 401, 860, 431, 471, 602, 760, 710]
Num selected data points: [293 205 731 401 431]
The chosen ones are users: [0, 1, 2, 3, 5], which are global users: [23, 19, 72, 15, 80]
___Test Local_Simple poisoned: False, epoch: 78: Average loss: 0.0373, Accuracy: 9876/10000 (98.7600%)
epoch_acc: 98.76
___Test Local_Simple poisoned: True, epoch: 78: Average loss: 14.9432, Accuracy: 9/8968 (0.1004%)
Done in 125.41369557380676 sec.
Server Epoch:79 choose agents : [54, 97, 77, 68, 98, 52, 78, 88, 45, 95].
___Train Local_Simple,  epoch  79, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch  79, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0930, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  79, local model 97, internal_epoch   1,  Average loss: 0.0004, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch  79, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.2179, Accuracy: 9499/10000 (94.9900%)
___Train Local_Simple,  epoch  79, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 585/589 (99.3209%)
___Train Local_Simple,  epoch  79, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 584/589 (99.1511%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0484, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch  79, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch  79, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0515, Accuracy: 9829/10000 (98.2900%)
___Train Local_Simple,  epoch  79, local model 98, internal_epoch   1,  Average loss: 0.0004, Accuracy: 808/818 (98.7775%)
___Train Local_Simple,  epoch  79, local model 98, internal_epoch   2,  Average loss: 0.0002, Accuracy: 815/818 (99.6333%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.2403, Accuracy: 9325/10000 (93.2500%)
poison local model 52 index 0
___Train Local_Simple,  epoch  79, local model 52, internal_epoch   1,  Average loss: 0.0003, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch  79, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0781, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch  79, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch  79, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0974, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch  79, local model 88, internal_epoch   1,  Average loss: 0.0004, Accuracy: 523/530 (98.6792%)
___Train Local_Simple,  epoch  79, local model 88, internal_epoch   2,  Average loss: 0.0005, Accuracy: 525/530 (99.0566%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.2272, Accuracy: 9413/10000 (94.1300%)
poison local model 45 index 1
___Train Local_Simple,  epoch  79, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 618/628 (98.4076%)
___Train Local_Simple,  epoch  79, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1427, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch  79, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Train Local_Simple,  epoch  79, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.1351, Accuracy: 9599/10000 (95.9900%)
time spent on training: 35.64932870864868
Starting performing KrMLRFL...
Num data points: [519, 487, 589, 494, 818, 253, 303, 530, 628, 602]
Num selected data points: [519 487 589 494 303 602]
The chosen ones are users: [0, 1, 2, 3, 6, 9], which are global users: [54, 97, 77, 68, 78, 95]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 45]
base_p: [ 0.00093336  0.00026675  0.00084897 ... -0.00159049  0.00269099
  0.00148594]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 7, 8]
layer1_inf_time: 2.95849609375
[PAIRWISE] pred_attackers_indx:  [4 8]
layer2_inf_t: 27.675537109375
assumed final_attacker_idxs:  [0 4 5 7 8]
final_attacker_idxs is: [0 4 5 7 8]
g_attacker_idxs: [54 98 52 88 45]
g_normal_idxs: [97 77 68 78 95]
filtered_attacker_idxs: [4, 5, 7, 8]
final_attacker_idxs are: [4, 5, 7, 8]
num_dps: [519, 487, 589, 494, 818, 253, 303, 530, 628, 602]
epoch_acc: 98.97
___Test Local_Simple poisoned: False, epoch: 79: Average loss: 0.0342, Accuracy: 9897/10000 (98.9700%)
___Test Local_Simple poisoned: True, epoch: 79: Average loss: 15.3725, Accuracy: 11/8968 (0.1227%)
Done in 129.99310636520386 sec.
Server Epoch:80 choose agents : [42, 38, 63, 31, 47, 12, 77, 37, 23, 83].
poison local model 42 index 0
___Train Local_Simple,  epoch  80, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch  80, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0416, Accuracy: 9868/10000 (98.6800%)
___Train Local_Simple,  epoch  80, local model 38, internal_epoch   1,  Average loss: 0.0006, Accuracy: 879/895 (98.2123%)
___Train Local_Simple,  epoch  80, local model 38, internal_epoch   2,  Average loss: 0.0006, Accuracy: 884/895 (98.7709%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.2601, Accuracy: 9179/10000 (91.7900%)
poison local model 63 index 1
___Train Local_Simple,  epoch  80, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 869/889 (97.7503%)
___Train Local_Simple,  epoch  80, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 875/889 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0817, Accuracy: 9745/10000 (97.4500%)
___Train Local_Simple,  epoch  80, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 832/835 (99.6407%)
___Train Local_Simple,  epoch  80, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 832/835 (99.6407%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0671, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch  80, local model 47, internal_epoch   1,  Average loss: 0.0003, Accuracy: 770/776 (99.2268%)
___Train Local_Simple,  epoch  80, local model 47, internal_epoch   2,  Average loss: 0.0002, Accuracy: 773/776 (99.6134%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1049, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  80, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1145/1160 (98.7069%)
___Train Local_Simple,  epoch  80, local model 12, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1156/1160 (99.6552%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1437, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch  80, local model 77, internal_epoch   1,  Average loss: 0.0004, Accuracy: 586/589 (99.4907%)
___Train Local_Simple,  epoch  80, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 587/589 (99.6604%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0472, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch  80, local model 37, internal_epoch   1,  Average loss: 0.0005, Accuracy: 851/860 (98.9535%)
___Train Local_Simple,  epoch  80, local model 37, internal_epoch   2,  Average loss: 0.0008, Accuracy: 843/860 (98.0233%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.1608, Accuracy: 9492/10000 (94.9200%)
___Train Local_Simple,  epoch  80, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch  80, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0887, Accuracy: 9710/10000 (97.1000%)
___Train Local_Simple,  epoch  80, local model 83, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/433 (99.0762%)
___Train Local_Simple,  epoch  80, local model 83, internal_epoch   2,  Average loss: 0.0003, Accuracy: 430/433 (99.3072%)
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0488, Accuracy: 9843/10000 (98.4300%)
time spent on training: 35.65439701080322
Starting performing KrMLRFL...
Num data points: [236, 895, 889, 835, 776, 1160, 589, 860, 293, 433]
Num selected data points: [895 835 776 293 433]
The chosen ones are users: [1, 3, 4, 8, 9], which are global users: [38, 31, 47, 23, 83]
___Test Local_Simple poisoned: False, epoch: 80: Average loss: 0.0482, Accuracy: 9836/10000 (98.3600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 63]
base_p: [0.00538863 0.00041433 0.00026312 ... 0.00432587 0.00029241 0.00159398]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 6, 7]
layer1_inf_time: 3.15234375
[PAIRWISE] pred_attackers_indx:  [1]
layer2_inf_t: 26.405517578125
assumed final_attacker_idxs:  [0 1 2 5 6 7]
final_attacker_idxs is: [0 1 2 5 6 7]
g_attacker_idxs: [42 38 63 12 77 37]
g_normal_idxs: [31 47 23 83]
filtered_attacker_idxs: [0, 2, 5, 6, 7]
final_attacker_idxs are: [0, 2, 5, 6, 7]
num_dps: [236, 895, 889, 835, 776, 1160, 589, 860, 293, 433]
epoch_acc: 98.36
___Test Local_Simple poisoned: True, epoch: 80: Average loss: 16.5594, Accuracy: 0/8968 (0.0000%)
Done in 132.64405798912048 sec.
Server Epoch:81 choose agents : [94, 48, 35, 79, 29, 17, 27, 1, 41, 25].
___Train Local_Simple,  epoch  81, local model 94, internal_epoch   1,  Average loss: 0.0016, Accuracy: 146/150 (97.3333%)
___Train Local_Simple,  epoch  81, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1322, Accuracy: 9503/10000 (95.0300%)
___Train Local_Simple,  epoch  81, local model 48, internal_epoch   1,  Average loss: 0.0006, Accuracy: 443/448 (98.8839%)
___Train Local_Simple,  epoch  81, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0943, Accuracy: 9691/10000 (96.9100%)
___Train Local_Simple,  epoch  81, local model 35, internal_epoch   1,  Average loss: 0.0003, Accuracy: 496/499 (99.3988%)
___Train Local_Simple,  epoch  81, local model 35, internal_epoch   2,  Average loss: 0.0003, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1325, Accuracy: 9590/10000 (95.9000%)
___Train Local_Simple,  epoch  81, local model 79, internal_epoch   1,  Average loss: 0.0006, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch  81, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0593, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch  81, local model 29, internal_epoch   1,  Average loss: 0.0005, Accuracy: 989/1002 (98.7026%)
___Train Local_Simple,  epoch  81, local model 29, internal_epoch   2,  Average loss: 0.0004, Accuracy: 996/1002 (99.4012%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1259, Accuracy: 9609/10000 (96.0900%)
poison local model 17 index 0
___Train Local_Simple,  epoch  81, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 608/620 (98.0645%)
___Train Local_Simple,  epoch  81, local model 17, internal_epoch   2,  Average loss: 0.0006, Accuracy: 614/620 (99.0323%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0944, Accuracy: 9700/10000 (97.0000%)
poison local model 27 index 1
___Train Local_Simple,  epoch  81, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 464/471 (98.5138%)
___Train Local_Simple,  epoch  81, local model 27, internal_epoch   2,  Average loss: 0.0016, Accuracy: 459/471 (97.4522%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1447, Accuracy: 9516/10000 (95.1600%)
poison local model 1 index 2
___Train Local_Simple,  epoch  81, local model 1, internal_epoch   1,  Average loss: 0.0009, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch  81, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 755/760 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1409, Accuracy: 9538/10000 (95.3800%)
___Train Local_Simple,  epoch  81, local model 41, internal_epoch   1,  Average loss: 0.0005, Accuracy: 600/606 (99.0099%)
___Train Local_Simple,  epoch  81, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 606/606 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1406, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  81, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 640/647 (98.9181%)
___Train Local_Simple,  epoch  81, local model 25, internal_epoch   2,  Average loss: 0.0003, Accuracy: 645/647 (99.6909%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17, 27, 1]
base_p: [-0.00068682  0.00028963 -0.0002137  ... -0.00302735 -0.00336664
 -0.00110234]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 2.607421875
[PAIRWISE] pred_attackers_indx:  [5 6 7]
layer2_inf_t: 28.204345703125
assumed final_attacker_idxs:  [5 6 7 8 9]
final_attacker_idxs is: [5 6 7 8 9]
g_attacker_idxs: [17 27  1 41 25]
g_normal_idxs: [94 48 35 79 29]
filtered_attacker_idxs: [5, 6, 7, 9]
final_attacker_idxs are: [5, 6, 7, 9]
num_dps: [150, 448, 499, 182, 1002, 620, 471, 760, 606, 647]
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.1206, Accuracy: 9610/10000 (96.1000%)
time spent on training: 38.71204209327698
Starting performing KrMLRFL...
Num data points: [150, 448, 499, 182, 1002, 620, 471, 760, 606, 647]
Num selected data points: [ 150  448  499  182 1002  606]
The chosen ones are users: [0, 1, 2, 3, 4, 8], which are global users: [94, 48, 35, 79, 29, 41]
___Test Local_Simple poisoned: False, epoch: 81: Average loss: 0.0423, Accuracy: 9863/10000 (98.6300%)
epoch_acc: 98.63
___Test Local_Simple poisoned: True, epoch: 81: Average loss: 12.9564, Accuracy: 26/8968 (0.2899%)
Done in 126.45244646072388 sec.
Server Epoch:82 choose agents : [26, 77, 17, 61, 14, 0, 73, 94, 96, 25].
poison local model 26 index 0
___Train Local_Simple,  epoch  82, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 551/554 (99.4585%)
___Train Local_Simple,  epoch  82, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1070, Accuracy: 9670/10000 (96.7000%)
___Train Local_Simple,  epoch  82, local model 77, internal_epoch   1,  Average loss: 0.0005, Accuracy: 585/589 (99.3209%)
___Train Local_Simple,  epoch  82, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 586/589 (99.4907%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0567, Accuracy: 9832/10000 (98.3200%)
poison local model 17 index 1
___Train Local_Simple,  epoch  82, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 602/620 (97.0968%)
___Train Local_Simple,  epoch  82, local model 17, internal_epoch   2,  Average loss: 0.0004, Accuracy: 616/620 (99.3548%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1684, Accuracy: 9438/10000 (94.3800%)
poison local model 61 index 2
___Train Local_Simple,  epoch  82, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 690/699 (98.7124%)
___Train Local_Simple,  epoch  82, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 692/699 (98.9986%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1608, Accuracy: 9495/10000 (94.9500%)
___Train Local_Simple,  epoch  82, local model 14, internal_epoch   1,  Average loss: 0.0004, Accuracy: 375/376 (99.7340%)
___Train Local_Simple,  epoch  82, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0552, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch  82, local model 0, internal_epoch   1,  Average loss: 0.0006, Accuracy: 428/435 (98.3908%)
___Train Local_Simple,  epoch  82, local model 0, internal_epoch   2,  Average loss: 0.0003, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0813, Accuracy: 9738/10000 (97.3800%)
poison local model 73 index 3
___Train Local_Simple,  epoch  82, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 584/591 (98.8156%)
___Train Local_Simple,  epoch  82, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 588/591 (99.4924%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0978, Accuracy: 9696/10000 (96.9600%)
___Train Local_Simple,  epoch  82, local model 94, internal_epoch   1,  Average loss: 0.0020, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  82, local model 94, internal_epoch   2,  Average loss: 0.0010, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.2107, Accuracy: 9178/10000 (91.7800%)
___Train Local_Simple,  epoch  82, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 662/672 (98.5119%)
___Train Local_Simple,  epoch  82, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1037, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch  82, local model 25, internal_epoch   1,  Average loss: 0.0004, Accuracy: 642/647 (99.2272%)
___Train Local_Simple,  epoch  82, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 645/647 (99.6909%)
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.1737, Accuracy: 9431/10000 (94.3100%)
time spent on training: 41.128838300704956
Starting performing KrMLRFL...
Num data points: [554, 589, 620, 699, 376, 435, 591, 150, 672, 647]
Num selected data points: [589 376 435 150 647]
The chosen ones are users: [1, 4, 5, 7, 9], which are global users: [77, 14, 0, 94, 25]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 17, 61, 73]
base_p: [1.1898577e-05 2.7998164e-04 1.3229810e-04 ... 9.7681582e-04 3.6631823e-03
 1.8438622e-03]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 6, 8]
layer1_inf_time: 3.010498046875
[PAIRWISE] pred_attackers_indx:  [2 3 6 8]
layer2_inf_t: 27.905029296875
assumed final_attacker_idxs:  [0 2 3 6 8]
final_attacker_idxs is: [0 2 3 6 8]
g_attacker_idxs: [26 17 61 73 96]
g_normal_idxs: [77 14  0 94 25]
filtered_attacker_idxs: [0, 2, 3, 6, 8]
final_attacker_idxs are: [0, 2, 3, 6, 8]
num_dps: [554, 589, 620, 699, 376, 435, 591, 150, 672, 647]
epoch_acc: 98.58
___Test Local_Simple poisoned: False, epoch: 82: Average loss: 0.0433, Accuracy: 9858/10000 (98.5800%)
___Test Local_Simple poisoned: True, epoch: 82: Average loss: 12.7943, Accuracy: 49/8968 (0.5464%)
Done in 122.6033124923706 sec.
Server Epoch:83 choose agents : [55, 99, 45, 50, 70, 11, 57, 98, 58, 43].
___Train Local_Simple,  epoch  83, local model 55, internal_epoch   1,  Average loss: 0.0009, Accuracy: 349/354 (98.5876%)
___Train Local_Simple,  epoch  83, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.3309, Accuracy: 9107/10000 (91.0700%)
___Train Local_Simple,  epoch  83, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch  83, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0435, Accuracy: 9843/10000 (98.4300%)
poison local model 45 index 0
___Train Local_Simple,  epoch  83, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 617/628 (98.2484%)
___Train Local_Simple,  epoch  83, local model 45, internal_epoch   2,  Average loss: 0.0007, Accuracy: 621/628 (98.8854%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1100, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch  83, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 468/474 (98.7342%)
___Train Local_Simple,  epoch  83, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 472/474 (99.5781%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0783, Accuracy: 9732/10000 (97.3200%)
poison local model 70 index 1
___Train Local_Simple,  epoch  83, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 713/724 (98.4807%)
___Train Local_Simple,  epoch  83, local model 70, internal_epoch   2,  Average loss: 0.0008, Accuracy: 711/724 (98.2044%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2373, Accuracy: 9203/10000 (92.0300%)
poison local model 11 index 2
___Train Local_Simple,  epoch  83, local model 11, internal_epoch   1,  Average loss: 0.0009, Accuracy: 634/645 (98.2946%)
___Train Local_Simple,  epoch  83, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 639/645 (99.0698%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.2531, Accuracy: 9318/10000 (93.1800%)
___Train Local_Simple,  epoch  83, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 338/343 (98.5423%)
___Train Local_Simple,  epoch  83, local model 57, internal_epoch   2,  Average loss: 0.0005, Accuracy: 339/343 (98.8338%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.1633, Accuracy: 9523/10000 (95.2300%)
___Train Local_Simple,  epoch  83, local model 98, internal_epoch   1,  Average loss: 0.0007, Accuracy: 803/818 (98.1663%)
___Train Local_Simple,  epoch  83, local model 98, internal_epoch   2,  Average loss: 0.0002, Accuracy: 813/818 (99.3888%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.3033, Accuracy: 9116/10000 (91.1600%)
___Train Local_Simple,  epoch  83, local model 58, internal_epoch   1,  Average loss: 0.0013, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch  83, local model 58, internal_epoch   2,  Average loss: 0.0008, Accuracy: 271/276 (98.1884%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.3575, Accuracy: 9213/10000 (92.1300%)
___Train Local_Simple,  epoch  83, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch  83, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0434, Accuracy: 9866/10000 (98.6600%)
time spent on training: 38.70887875556946
Starting performing KrMLRFL...
Num data points: [354, 377, 628, 474, 724, 645, 343, 818, 276, 408]
Num selected data points: [354 377 474 343 276 408]
The chosen ones are users: [0, 1, 3, 6, 8, 9], which are global users: [55, 99, 50, 57, 58, 43]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 70, 11]
base_p: [ 0.00120077  0.00025924  0.00054098 ... -0.00130554 -0.00328805
  0.000235  ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 7]
layer1_inf_time: 2.807373046875
[PAIRWISE] pred_attackers_indx:  [0 2 4 5 7]
layer2_inf_t: 33.241455078125
assumed final_attacker_idxs:  [0 2 4 5 7]
final_attacker_idxs is: [0 2 4 5 7]
g_attacker_idxs: [55 45 70 11 98]
g_normal_idxs: [99 50 57 58 43]
filtered_attacker_idxs: [2, 4, 5, 7]
final_attacker_idxs are: [2, 4, 5, 7]
num_dps: [354, 377, 628, 474, 724, 645, 343, 818, 276, 408]
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: False, epoch: 83: Average loss: 0.0364, Accuracy: 9885/10000 (98.8500%)
___Test Local_Simple poisoned: True, epoch: 83: Average loss: 13.4069, Accuracy: 28/8968 (0.3122%)
Done in 119.11540865898132 sec.
Server Epoch:84 choose agents : [42, 11, 89, 50, 55, 83, 51, 21, 0, 79].
poison local model 42 index 0
___Train Local_Simple,  epoch  84, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch  84, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0549, Accuracy: 9819/10000 (98.1900%)
poison local model 11 index 1
___Train Local_Simple,  epoch  84, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 637/645 (98.7597%)
___Train Local_Simple,  epoch  84, local model 11, internal_epoch   2,  Average loss: 0.0017, Accuracy: 625/645 (96.8992%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.2531, Accuracy: 9350/10000 (93.5000%)
___Train Local_Simple,  epoch  84, local model 89, internal_epoch   1,  Average loss: 0.0005, Accuracy: 487/492 (98.9837%)
___Train Local_Simple,  epoch  84, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.1140, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  84, local model 50, internal_epoch   1,  Average loss: 0.0003, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch  84, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0911, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch  84, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch  84, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.1873, Accuracy: 9412/10000 (94.1200%)
___Train Local_Simple,  epoch  84, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch  84, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 432/433 (99.7691%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0373, Accuracy: 9882/10000 (98.8200%)
poison local model 51 index 2
___Train Local_Simple,  epoch  84, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 566/568 (99.6479%)
___Train Local_Simple,  epoch  84, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0949, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch  84, local model 21, internal_epoch   1,  Average loss: 0.0004, Accuracy: 308/312 (98.7179%)
___Train Local_Simple,  epoch  84, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0895, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch  84, local model 0, internal_epoch   1,  Average loss: 0.0004, Accuracy: 430/435 (98.8506%)
___Train Local_Simple,  epoch  84, local model 0, internal_epoch   2,  Average loss: 0.0005, Accuracy: 432/435 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0687, Accuracy: 9778/10000 (97.7800%)
___Train Local_Simple,  epoch  84, local model 79, internal_epoch   1,  Average loss: 0.0005, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch  84, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 11, 51]
base_p: [ 0.00198737  0.00019034 -0.00028794 ... -0.00515592 -0.00350659
  0.00046609]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 6]
layer1_inf_time: 2.79638671875
[PAIRWISE] pred_attackers_indx:  [1 6]
layer2_inf_t: 26.248779296875
assumed final_attacker_idxs:  [0 1 2 4 6]
final_attacker_idxs is: [0 1 2 4 6]
g_attacker_idxs: [42 11 89 55 51]
g_normal_idxs: [50 83 21  0 79]
filtered_attacker_idxs: [0, 1, 2, 6]
final_attacker_idxs are: [0, 1, 2, 6]
num_dps: [236, 645, 492, 474, 354, 433, 568, 312, 435, 182]
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0439, Accuracy: 9874/10000 (98.7400%)
time spent on training: 39.00253629684448
Starting performing KrMLRFL...
Num data points: [236, 645, 492, 474, 354, 433, 568, 312, 435, 182]
Num selected data points: [474 354 433 312 435 182]
The chosen ones are users: [3, 4, 5, 7, 8, 9], which are global users: [50, 55, 83, 21, 0, 79]
___Test Local_Simple poisoned: False, epoch: 84: Average loss: 0.0349, Accuracy: 9881/10000 (98.8100%)
epoch_acc: 98.81
___Test Local_Simple poisoned: True, epoch: 84: Average loss: 14.2559, Accuracy: 18/8968 (0.2007%)
Done in 124.2234218120575 sec.
Server Epoch:85 choose agents : [7, 65, 20, 13, 16, 67, 55, 61, 24, 46].
poison local model 7 index 0
___Train Local_Simple,  epoch  85, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch  85, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 414/418 (99.0431%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1120, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch  85, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch  85, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0584, Accuracy: 9806/10000 (98.0600%)
poison local model 20 index 1
___Train Local_Simple,  epoch  85, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 419/429 (97.6690%)
___Train Local_Simple,  epoch  85, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1919, Accuracy: 9397/10000 (93.9700%)
poison local model 13 index 2
___Train Local_Simple,  epoch  85, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 722/734 (98.3651%)
___Train Local_Simple,  epoch  85, local model 13, internal_epoch   2,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1527, Accuracy: 9548/10000 (95.4800%)
poison local model 16 index 3
___Train Local_Simple,  epoch  85, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 902/915 (98.5792%)
___Train Local_Simple,  epoch  85, local model 16, internal_epoch   2,  Average loss: 0.0002, Accuracy: 911/915 (99.5628%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0922, Accuracy: 9716/10000 (97.1600%)
___Train Local_Simple,  epoch  85, local model 67, internal_epoch   1,  Average loss: 0.0005, Accuracy: 989/998 (99.0982%)
___Train Local_Simple,  epoch  85, local model 67, internal_epoch   2,  Average loss: 0.0004, Accuracy: 993/998 (99.4990%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1421, Accuracy: 9570/10000 (95.7000%)
___Train Local_Simple,  epoch  85, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 353/354 (99.7175%)
___Train Local_Simple,  epoch  85, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1626, Accuracy: 9481/10000 (94.8100%)
poison local model 61 index 0
___Train Local_Simple,  epoch  85, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 689/699 (98.5694%)
___Train Local_Simple,  epoch  85, local model 61, internal_epoch   2,  Average loss: 0.0010, Accuracy: 682/699 (97.5680%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1081, Accuracy: 9648/10000 (96.4800%)
___Train Local_Simple,  epoch  85, local model 24, internal_epoch   1,  Average loss: 0.0006, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch  85, local model 24, internal_epoch   2,  Average loss: 0.0005, Accuracy: 375/379 (98.9446%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0687, Accuracy: 9800/10000 (98.0000%)
___Train Local_Simple,  epoch  85, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 698/710 (98.3099%)
___Train Local_Simple,  epoch  85, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 698/710 (98.3099%)
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.1713, Accuracy: 9449/10000 (94.4900%)
time spent on training: 46.81882858276367
Starting performing KrMLRFL...
Num data points: [418, 371, 429, 734, 915, 998, 354, 699, 379, 710]
Num selected data points: [371 998 354 379]
The chosen ones are users: [1, 5, 6, 8], which are global users: [65, 67, 55, 24]
___Test Local_Simple poisoned: False, epoch: 85: Average loss: 0.0491, Accuracy: 9839/10000 (98.3900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 20, 13, 16, 61]
base_p: [ 2.2331253e-03  3.2702088e-04  4.2957254e-04 ... -2.7893037e-03
 -2.5194064e-03  8.8594854e-05]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 7, 9]
layer1_inf_time: 2.89453125
[PAIRWISE] pred_attackers_indx:  [0 2 3 4]
layer2_inf_t: 282.384765625
assumed final_attacker_idxs:  [0 2 3 4 7 9]
final_attacker_idxs is: [0 2 3 4 7 9]
g_attacker_idxs: [ 7 20 13 16 61 46]
g_normal_idxs: [65 67 55 24]
filtered_attacker_idxs: [0, 2, 3, 4, 7, 9]
final_attacker_idxs are: [0, 2, 3, 4, 7, 9]
num_dps: [418, 371, 429, 734, 915, 998, 354, 699, 379, 710]
epoch_acc: 98.39
___Test Local_Simple poisoned: True, epoch: 85: Average loss: 14.6012, Accuracy: 8/8968 (0.0892%)
Done in 129.50131583213806 sec.
Server Epoch:86 choose agents : [85, 65, 12, 51, 68, 15, 75, 90, 26, 71].
poison local model 85 index 0
___Train Local_Simple,  epoch  86, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch  86, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0520, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch  86, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch  86, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1512, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch  86, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1137/1160 (98.0172%)
___Train Local_Simple,  epoch  86, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1149/1160 (99.0517%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1346, Accuracy: 9605/10000 (96.0500%)
poison local model 51 index 1
___Train Local_Simple,  epoch  86, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 558/568 (98.2394%)
___Train Local_Simple,  epoch  86, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0981, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch  86, local model 68, internal_epoch   1,  Average loss: 0.0005, Accuracy: 488/494 (98.7854%)
___Train Local_Simple,  epoch  86, local model 68, internal_epoch   2,  Average loss: 0.0002, Accuracy: 492/494 (99.5951%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.1191, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch  86, local model 15, internal_epoch   1,  Average loss: 0.0007, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch  86, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0625, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch  86, local model 75, internal_epoch   1,  Average loss: 0.0010, Accuracy: 674/686 (98.2507%)
___Train Local_Simple,  epoch  86, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 683/686 (99.5627%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0998, Accuracy: 9684/10000 (96.8400%)
___Train Local_Simple,  epoch  86, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 678/683 (99.2679%)
___Train Local_Simple,  epoch  86, local model 90, internal_epoch   2,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.2472, Accuracy: 9295/10000 (92.9500%)
poison local model 26 index 2
___Train Local_Simple,  epoch  86, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 546/554 (98.5560%)
___Train Local_Simple,  epoch  86, local model 26, internal_epoch   2,  Average loss: 0.0002, Accuracy: 551/554 (99.4585%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0934, Accuracy: 9717/10000 (97.1700%)
poison local model 71 index 3
___Train Local_Simple,  epoch  86, local model 71, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1369/1384 (98.9162%)
___Train Local_Simple,  epoch  86, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1378/1384 (99.5665%)
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.5649, Accuracy: 8721/10000 (87.2100%)
time spent on training: 44.06001663208008
Starting performing KrMLRFL...
Num data points: [431, 371, 1160, 568, 494, 401, 686, 683, 554, 1384]
Num selected data points: [371 494 401 686 683]
The chosen ones are users: [1, 4, 5, 6, 7], which are global users: [65, 68, 15, 75, 90]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 51, 26, 71]
base_p: [-7.0696324e-04  3.6689639e-04 -1.7074868e-04 ... -8.8770688e-04
 -9.7052753e-04 -4.7534704e-05]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 8, 9]
layer1_inf_time: 3.1162109375
[PAIRWISE] pred_attackers_indx:  [1 2 3 5 7]
layer2_inf_t: 40.625
assumed final_attacker_idxs:  [0 1 2 3 5 7 8 9]
final_attacker_idxs is: [0 1 2 3 5 7 8 9]
g_attacker_idxs: [85 65 12 51 15 90 26 71]
g_normal_idxs: [68 75]
filtered_attacker_idxs: [0, 2, 3, 8, 9]
final_attacker_idxs are: [0, 2, 3, 8, 9]
num_dps: [431, 371, 1160, 568, 494, 401, 686, 683, 554, 1384]
___Test Local_Simple poisoned: False, epoch: 86: Average loss: 0.0360, Accuracy: 9881/10000 (98.8100%)
epoch_acc: 98.81
___Test Local_Simple poisoned: True, epoch: 86: Average loss: 15.5853, Accuracy: 6/8968 (0.0669%)
Done in 136.02025771141052 sec.
Server Epoch:87 choose agents : [57, 55, 95, 96, 74, 18, 53, 39, 52, 60].
___Train Local_Simple,  epoch  87, local model 57, internal_epoch   1,  Average loss: 0.0014, Accuracy: 332/343 (96.7930%)
___Train Local_Simple,  epoch  87, local model 57, internal_epoch   2,  Average loss: 0.0008, Accuracy: 336/343 (97.9592%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1380, Accuracy: 9577/10000 (95.7700%)
___Train Local_Simple,  epoch  87, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch  87, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1231, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch  87, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch  87, local model 95, internal_epoch   2,  Average loss: 0.0006, Accuracy: 596/602 (99.0033%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1286, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch  87, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 665/672 (98.9583%)
___Train Local_Simple,  epoch  87, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 671/672 (99.8512%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1399, Accuracy: 9591/10000 (95.9100%)
___Train Local_Simple,  epoch  87, local model 74, internal_epoch   1,  Average loss: 0.0011, Accuracy: 543/557 (97.4865%)
___Train Local_Simple,  epoch  87, local model 74, internal_epoch   2,  Average loss: 0.0011, Accuracy: 544/557 (97.6661%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1987, Accuracy: 9404/10000 (94.0400%)
___Train Local_Simple,  epoch  87, local model 18, internal_epoch   1,  Average loss: 0.0012, Accuracy: 450/459 (98.0392%)
___Train Local_Simple,  epoch  87, local model 18, internal_epoch   2,  Average loss: 0.0008, Accuracy: 448/459 (97.6035%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.1951, Accuracy: 9391/10000 (93.9100%)
___Train Local_Simple,  epoch  87, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch  87, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 735/739 (99.4587%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.2688, Accuracy: 9233/10000 (92.3300%)
___Train Local_Simple,  epoch  87, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch  87, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0473, Accuracy: 9845/10000 (98.4500%)
poison local model 52 index 0
___Train Local_Simple,  epoch  87, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch  87, local model 52, internal_epoch   2,  Average loss: 0.0006, Accuracy: 251/253 (99.2095%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0877, Accuracy: 9738/10000 (97.3800%)
___Train Local_Simple,  epoch  87, local model 60, internal_epoch   1,  Average loss: 0.0005, Accuracy: 332/338 (98.2249%)
___Train Local_Simple,  epoch  87, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 337/338 (99.7041%)
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0900, Accuracy: 9729/10000 (97.2900%)
time spent on training: 32.094504594802856
Starting performing KrMLRFL...
Num data points: [343, 354, 602, 672, 557, 459, 739, 257, 253, 338]
Num selected data points: [343 354 557 459 257 338]
The chosen ones are users: [0, 1, 4, 5, 7, 9], which are global users: [57, 55, 74, 18, 39, 60]
___Test Local_Simple poisoned: False, epoch: 87: Average loss: 0.0443, Accuracy: 9862/10000 (98.6200%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00016069  0.00023138  0.00085222 ... -0.00157121 -0.00342719
 -0.0003876 ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 6, 8]
layer1_inf_time: 2.790771484375
[PAIRWISE] pred_attackers_indx:  [0 2 3 4]
layer2_inf_t: 27.607421875
assumed final_attacker_idxs:  [0 2 3 4 6 8]
final_attacker_idxs is: [0 2 3 4 6 8]
g_attacker_idxs: [57 95 96 74 53 52]
g_normal_idxs: [55 18 39 60]
filtered_attacker_idxs: [2, 3, 6, 8]
final_attacker_idxs are: [2, 3, 6, 8]
num_dps: [343, 354, 602, 672, 557, 459, 739, 257, 253, 338]
epoch_acc: 98.61999999999999
___Test Local_Simple poisoned: True, epoch: 87: Average loss: 13.1054, Accuracy: 37/8968 (0.4126%)
Done in 119.31801986694336 sec.
Server Epoch:88 choose agents : [43, 49, 84, 46, 1, 11, 5, 7, 3, 45].
___Train Local_Simple,  epoch  88, local model 43, internal_epoch   1,  Average loss: 0.0010, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch  88, local model 43, internal_epoch   2,  Average loss: 0.0009, Accuracy: 400/408 (98.0392%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1766, Accuracy: 9372/10000 (93.7200%)
___Train Local_Simple,  epoch  88, local model 49, internal_epoch   1,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%)
___Train Local_Simple,  epoch  88, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 505/506 (99.8024%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1101, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch  88, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1229/1246 (98.6356%)
___Train Local_Simple,  epoch  88, local model 84, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1235/1246 (99.1172%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.0666, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch  88, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch  88, local model 46, internal_epoch   2,  Average loss: 0.0013, Accuracy: 699/710 (98.4507%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1602, Accuracy: 9467/10000 (94.6700%)
poison local model 1 index 0
___Train Local_Simple,  epoch  88, local model 1, internal_epoch   1,  Average loss: 0.0008, Accuracy: 747/760 (98.2895%)
___Train Local_Simple,  epoch  88, local model 1, internal_epoch   2,  Average loss: 0.0006, Accuracy: 752/760 (98.9474%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.3335, Accuracy: 8946/10000 (89.4600%)
poison local model 11 index 1
___Train Local_Simple,  epoch  88, local model 11, internal_epoch   1,  Average loss: 0.0007, Accuracy: 636/645 (98.6047%)
___Train Local_Simple,  epoch  88, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 640/645 (99.2248%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1944, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch  88, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 429/434 (98.8479%)
___Train Local_Simple,  epoch  88, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 431/434 (99.3088%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1022, Accuracy: 9616/10000 (96.1600%)
poison local model 7 index 2
___Train Local_Simple,  epoch  88, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 410/418 (98.0861%)
___Train Local_Simple,  epoch  88, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1256, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch  88, local model 3, internal_epoch   1,  Average loss: 0.0005, Accuracy: 912/923 (98.8082%)
___Train Local_Simple,  epoch  88, local model 3, internal_epoch   2,  Average loss: 0.0004, Accuracy: 916/923 (99.2416%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1717, Accuracy: 9496/10000 (94.9600%)
poison local model 45 index 3
___Train Local_Simple,  epoch  88, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 621/628 (98.8854%)
___Train Local_Simple,  epoch  88, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.1443, Accuracy: 9516/10000 (95.1600%)
time spent on training: 43.600054025650024
Starting performing KrMLRFL...
Num data points: [408, 506, 1246, 710, 760, 645, 434, 418, 923, 628]
Num selected data points: [408 506 434]
The chosen ones are users: [0, 1, 6], which are global users: [43, 49, 5]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 11, 7, 45]
base_p: [-5.7867914e-04  3.7172064e-04 -4.5154057e-04 ...  8.3412230e-04
 -3.5114586e-05  1.1406913e-03]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 7, 8, 9]
layer1_inf_time: 3.840576171875
[PAIRWISE] pred_attackers_indx:  [3 4 5 6 7]
layer2_inf_t: 36.06396484375
assumed final_attacker_idxs:  [2 3 4 5 6 7 8 9]
final_attacker_idxs is: [2 3 4 5 6 7 8 9]
g_attacker_idxs: [84 46  1 11  5  7  3 45]
g_normal_idxs: [43 49]
filtered_attacker_idxs: [2, 3, 4, 5, 7, 8, 9]
final_attacker_idxs are: [2, 3, 4, 5, 7, 8, 9]
num_dps: [408, 506, 1246, 710, 760, 645, 434, 418, 923, 628]
___Test Local_Simple poisoned: False, epoch: 88: Average loss: 0.0452, Accuracy: 9853/10000 (98.5300%)
epoch_acc: 98.53
___Test Local_Simple poisoned: True, epoch: 88: Average loss: 13.7846, Accuracy: 3/8968 (0.0335%)
Done in 126.9680278301239 sec.
Server Epoch:89 choose agents : [54, 29, 4, 38, 52, 86, 28, 34, 15, 75].
___Train Local_Simple,  epoch  89, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch  89, local model 54, internal_epoch   2,  Average loss: 0.0003, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0511, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch  89, local model 29, internal_epoch   1,  Average loss: 0.0003, Accuracy: 995/1002 (99.3014%)
___Train Local_Simple,  epoch  89, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 997/1002 (99.5010%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1958, Accuracy: 9422/10000 (94.2200%)
___Train Local_Simple,  epoch  89, local model 4, internal_epoch   1,  Average loss: 0.0006, Accuracy: 651/658 (98.9362%)
___Train Local_Simple,  epoch  89, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 655/658 (99.5441%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.2683, Accuracy: 9315/10000 (93.1500%)
___Train Local_Simple,  epoch  89, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 885/895 (98.8827%)
___Train Local_Simple,  epoch  89, local model 38, internal_epoch   2,  Average loss: 0.0003, Accuracy: 891/895 (99.5531%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1231, Accuracy: 9606/10000 (96.0600%)
poison local model 52 index 0
___Train Local_Simple,  epoch  89, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch  89, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.1214, Accuracy: 9659/10000 (96.5900%)
___Train Local_Simple,  epoch  89, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch  89, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0557, Accuracy: 9824/10000 (98.2400%)
___Train Local_Simple,  epoch  89, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch  89, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0545, Accuracy: 9830/10000 (98.3000%)
poison local model 34 index 1
___Train Local_Simple,  epoch  89, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch  89, local model 34, internal_epoch   2,  Average loss: 0.0000, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0903, Accuracy: 9727/10000 (97.2700%)
___Train Local_Simple,  epoch  89, local model 15, internal_epoch   1,  Average loss: 0.0004, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch  89, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0802, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch  89, local model 75, internal_epoch   1,  Average loss: 0.0003, Accuracy: 682/686 (99.4169%)
___Train Local_Simple,  epoch  89, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0998, Accuracy: 9682/10000 (96.8200%)
time spent on training: 35.37969136238098
Starting performing KrMLRFL...
Num data points: [519, 1002, 658, 895, 253, 250, 501, 413, 401, 686]
Num selected data points: [ 519 1002  895  250  501  401  686]
The chosen ones are users: [0, 1, 3, 5, 6, 8, 9], which are global users: [54, 29, 38, 86, 28, 15, 75]
___Test Local_Simple poisoned: False, epoch: 89: Average loss: 0.0388, Accuracy: 9876/10000 (98.7600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 34]
base_p: [-1.6847104e-03  2.9044971e-04 -1.8524006e-05 ...  1.8857419e-04
  1.2035072e-03  3.5367906e-05]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 7]
layer1_inf_time: 2.65576171875
[PAIRWISE] pred_attackers_indx:  [2 3]
layer2_inf_t: 25.33740234375
assumed final_attacker_idxs:  [0 2 3 4 7]
final_attacker_idxs is: [0 2 3 4 7]
g_attacker_idxs: [54  4 38 52 34]
g_normal_idxs: [29 86 28 15 75]
filtered_attacker_idxs: [2, 4, 7]
final_attacker_idxs are: [2, 4, 7]
num_dps: [519, 1002, 658, 895, 253, 250, 501, 413, 401, 686]
epoch_acc: 98.76
___Test Local_Simple poisoned: True, epoch: 89: Average loss: 14.4409, Accuracy: 4/8968 (0.0446%)
Done in 133.08469009399414 sec.
Server Epoch:90 choose agents : [66, 24, 28, 36, 54, 92, 27, 46, 29, 52].
___Train Local_Simple,  epoch  90, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 654/660 (99.0909%)
___Train Local_Simple,  epoch  90, local model 66, internal_epoch   2,  Average loss: 0.0002, Accuracy: 658/660 (99.6970%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0982, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch  90, local model 24, internal_epoch   1,  Average loss: 0.0005, Accuracy: 374/379 (98.6807%)
___Train Local_Simple,  epoch  90, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0707, Accuracy: 9782/10000 (97.8200%)
___Train Local_Simple,  epoch  90, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch  90, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0446, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch  90, local model 36, internal_epoch   1,  Average loss: 0.0008, Accuracy: 990/1005 (98.5075%)
___Train Local_Simple,  epoch  90, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 993/1005 (98.8060%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1384, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch  90, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch  90, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0811, Accuracy: 9746/10000 (97.4600%)
___Train Local_Simple,  epoch  90, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 928/937 (99.0395%)
___Train Local_Simple,  epoch  90, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 932/937 (99.4664%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1649, Accuracy: 9433/10000 (94.3300%)
poison local model 27 index 0
___Train Local_Simple,  epoch  90, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 467/471 (99.1507%)
___Train Local_Simple,  epoch  90, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 466/471 (98.9384%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0822, Accuracy: 9723/10000 (97.2300%)
___Train Local_Simple,  epoch  90, local model 46, internal_epoch   1,  Average loss: 0.0006, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch  90, local model 46, internal_epoch   2,  Average loss: 0.0007, Accuracy: 699/710 (98.4507%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.1285, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch  90, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch  90, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0593, Accuracy: 9801/10000 (98.0100%)
poison local model 52 index 1
___Train Local_Simple,  epoch  90, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch  90, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0890, Accuracy: 9728/10000 (97.2800%)
time spent on training: 36.34211254119873
Starting performing KrMLRFL...
Num data points: [660, 379, 501, 1005, 519, 937, 471, 710, 1002, 253]
Num selected data points: [ 379  501  519  937 1002]
The chosen ones are users: [1, 2, 4, 5, 8], which are global users: [24, 28, 54, 92, 29]
___Test Local_Simple poisoned: False, epoch: 90: Average loss: 0.0429, Accuracy: 9861/10000 (98.6100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 52]
base_p: [ 0.00090794  0.00035207  0.00011188 ... -0.00058052 -0.00089374
 -0.00230258]
[T_SCORE] attacker_local_idxs is:  [0, 3, 6, 7, 9]
layer1_inf_time: 3.02880859375
[PAIRWISE] pred_attackers_indx:  [3]
layer2_inf_t: 35.156005859375
assumed final_attacker_idxs:  [0 3 6 7 9]
final_attacker_idxs is: [0 3 6 7 9]
g_attacker_idxs: [66 36 27 46 52]
g_normal_idxs: [24 28 54 92 29]
filtered_attacker_idxs: [0, 3, 6, 7, 9]
final_attacker_idxs are: [0, 3, 6, 7, 9]
num_dps: [660, 379, 501, 1005, 519, 937, 471, 710, 1002, 253]
epoch_acc: 98.61
___Test Local_Simple poisoned: True, epoch: 90: Average loss: 13.4222, Accuracy: 19/8968 (0.2119%)
Done in 123.35900950431824 sec.
Server Epoch:91 choose agents : [18, 22, 59, 69, 37, 56, 36, 68, 39, 46].
___Train Local_Simple,  epoch  91, local model 18, internal_epoch   1,  Average loss: 0.0010, Accuracy: 451/459 (98.2571%)
___Train Local_Simple,  epoch  91, local model 18, internal_epoch   2,  Average loss: 0.0004, Accuracy: 455/459 (99.1285%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.0948, Accuracy: 9695/10000 (96.9500%)
poison local model 22 index 0
___Train Local_Simple,  epoch  91, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch  91, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.0860, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch  91, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 750/760 (98.6842%)
___Train Local_Simple,  epoch  91, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1977, Accuracy: 9323/10000 (93.2300%)
___Train Local_Simple,  epoch  91, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch  91, local model 69, internal_epoch   2,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1112, Accuracy: 9639/10000 (96.3900%)
___Train Local_Simple,  epoch  91, local model 37, internal_epoch   1,  Average loss: 0.0006, Accuracy: 850/860 (98.8372%)
___Train Local_Simple,  epoch  91, local model 37, internal_epoch   2,  Average loss: 0.0009, Accuracy: 841/860 (97.7907%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.2055, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch  91, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 875/880 (99.4318%)
___Train Local_Simple,  epoch  91, local model 56, internal_epoch   2,  Average loss: 0.0002, Accuracy: 877/880 (99.6591%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1035, Accuracy: 9690/10000 (96.9000%)
___Train Local_Simple,  epoch  91, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 993/1005 (98.8060%)
___Train Local_Simple,  epoch  91, local model 36, internal_epoch   2,  Average loss: 0.0009, Accuracy: 987/1005 (98.2090%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1302, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch  91, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 491/494 (99.3927%)
___Train Local_Simple,  epoch  91, local model 68, internal_epoch   2,  Average loss: 0.0004, Accuracy: 491/494 (99.3927%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1368, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch  91, local model 39, internal_epoch   1,  Average loss: 0.0006, Accuracy: 253/257 (98.4436%)
___Train Local_Simple,  epoch  91, local model 39, internal_epoch   2,  Average loss: 0.0008, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1386, Accuracy: 9658/10000 (96.5800%)
___Train Local_Simple,  epoch  91, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 699/710 (98.4507%)
___Train Local_Simple,  epoch  91, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 706/710 (99.4366%)
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.1341, Accuracy: 9569/10000 (95.6900%)
time spent on training: 34.19580578804016
Starting performing KrMLRFL...
Num data points: [459, 583, 760, 256, 860, 880, 1005, 494, 257, 710]
Num selected data points: [459 256 880 494 257]
The chosen ones are users: [0, 3, 5, 7, 8], which are global users: [18, 69, 56, 68, 39]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22]
base_p: [ 1.9356832e-03  3.3978000e-04  8.2919560e-04 ...  4.7408044e-04
 -9.0971589e-06 -1.3517961e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 6, 9]
layer1_inf_time: 2.7763671875
[PAIRWISE] pred_attackers_indx:  [1 4 6]
layer2_inf_t: 29.93359375
assumed final_attacker_idxs:  [1 2 4 6 9]
final_attacker_idxs is: [1 2 4 6 9]
g_attacker_idxs: [22 59 37 36 46]
g_normal_idxs: [18 69 56 68 39]
filtered_attacker_idxs: [1, 2, 4, 6, 9]
final_attacker_idxs are: [1, 2, 4, 6, 9]
num_dps: [459, 583, 760, 256, 860, 880, 1005, 494, 257, 710]
___Test Local_Simple poisoned: False, epoch: 91: Average loss: 0.0419, Accuracy: 9867/10000 (98.6700%)
epoch_acc: 98.67
___Test Local_Simple poisoned: True, epoch: 91: Average loss: 16.1709, Accuracy: 5/8968 (0.0558%)
Done in 121.21656274795532 sec.
Server Epoch:92 choose agents : [72, 95, 79, 51, 47, 29, 10, 16, 84, 27].
___Train Local_Simple,  epoch  92, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch  92, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0693, Accuracy: 9774/10000 (97.7400%)
___Train Local_Simple,  epoch  92, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 597/602 (99.1694%)
___Train Local_Simple,  epoch  92, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.3542, Accuracy: 8709/10000 (87.0900%)
___Train Local_Simple,  epoch  92, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch  92, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0551, Accuracy: 9833/10000 (98.3300%)
poison local model 51 index 0
___Train Local_Simple,  epoch  92, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 563/568 (99.1197%)
___Train Local_Simple,  epoch  92, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1298, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  92, local model 47, internal_epoch   1,  Average loss: 0.0004, Accuracy: 767/776 (98.8402%)
___Train Local_Simple,  epoch  92, local model 47, internal_epoch   2,  Average loss: 0.0003, Accuracy: 770/776 (99.2268%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0715, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch  92, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch  92, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0973, Accuracy: 9696/10000 (96.9600%)
___Train Local_Simple,  epoch  92, local model 10, internal_epoch   1,  Average loss: 0.0003, Accuracy: 885/892 (99.2152%)
___Train Local_Simple,  epoch  92, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 889/892 (99.6637%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.1190, Accuracy: 9612/10000 (96.1200%)
poison local model 16 index 1
___Train Local_Simple,  epoch  92, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 903/915 (98.6885%)
___Train Local_Simple,  epoch  92, local model 16, internal_epoch   2,  Average loss: 0.0016, Accuracy: 892/915 (97.4863%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0919, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch  92, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1227/1246 (98.4751%)
___Train Local_Simple,  epoch  92, local model 84, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1229/1246 (98.6356%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0873, Accuracy: 9736/10000 (97.3600%)
poison local model 27 index 2
___Train Local_Simple,  epoch  92, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 462/471 (98.0892%)
___Train Local_Simple,  epoch  92, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 469/471 (99.5754%)
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.4019, Accuracy: 9137/10000 (91.3700%)
time spent on training: 38.52589654922485
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 16, 27]
base_p: [ 1.2151077e-03  4.1849539e-04  2.3066066e-03 ... -1.9940883e-03
 -3.3033937e-03  3.8221478e-06]
[T_SCORE] attacker_local_idxs is:  [1, 3, 7, 8, 9]
layer1_inf_time: 2.579833984375
[PAIRWISE] pred_attackers_indx:  [8]
layer2_inf_t: 28.52734375
assumed final_attacker_idxs:  [1 3 7 8 9]
final_attacker_idxs is: [1 3 7 8 9]
g_attacker_idxs: [95 51 16 84 27]
g_normal_idxs: [72 79 47 29 10]
filtered_attacker_idxs: [1, 3, 7, 8, 9]
final_attacker_idxs are: [1, 3, 7, 8, 9]
num_dps: [731, 602, 182, 568, 776, 1002, 892, 915, 1246, 471]
epoch_acc: 98.79
Starting performing KrMLRFL...
Num data points: [731, 602, 182, 568, 776, 1002, 892, 915, 1246, 471]
Num selected data points: [ 731  182  776 1002  892]
The chosen ones are users: [0, 2, 4, 5, 6], which are global users: [72, 79, 47, 29, 10]
___Test Local_Simple poisoned: False, epoch: 92: Average loss: 0.0388, Accuracy: 9879/10000 (98.7900%)
___Test Local_Simple poisoned: True, epoch: 92: Average loss: 15.0871, Accuracy: 5/8968 (0.0558%)
Done in 128.82613801956177 sec.
Server Epoch:93 choose agents : [47, 97, 40, 98, 33, 92, 96, 76, 73, 72].
___Train Local_Simple,  epoch  93, local model 47, internal_epoch   1,  Average loss: 0.0002, Accuracy: 774/776 (99.7423%)
___Train Local_Simple,  epoch  93, local model 47, internal_epoch   2,  Average loss: 0.0015, Accuracy: 767/776 (98.8402%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1014, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch  93, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 484/487 (99.3840%)
___Train Local_Simple,  epoch  93, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.2241, Accuracy: 9462/10000 (94.6200%)
___Train Local_Simple,  epoch  93, local model 40, internal_epoch   1,  Average loss: 0.0008, Accuracy: 762/772 (98.7047%)
___Train Local_Simple,  epoch  93, local model 40, internal_epoch   2,  Average loss: 0.0003, Accuracy: 768/772 (99.4819%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1042, Accuracy: 9696/10000 (96.9600%)
___Train Local_Simple,  epoch  93, local model 98, internal_epoch   1,  Average loss: 0.0006, Accuracy: 808/818 (98.7775%)
___Train Local_Simple,  epoch  93, local model 98, internal_epoch   2,  Average loss: 0.0004, Accuracy: 812/818 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1699, Accuracy: 9474/10000 (94.7400%)
___Train Local_Simple,  epoch  93, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 611/623 (98.0738%)
___Train Local_Simple,  epoch  93, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0738, Accuracy: 9762/10000 (97.6200%)
___Train Local_Simple,  epoch  93, local model 92, internal_epoch   1,  Average loss: 0.0003, Accuracy: 929/937 (99.1462%)
___Train Local_Simple,  epoch  93, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1297, Accuracy: 9587/10000 (95.8700%)
___Train Local_Simple,  epoch  93, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 663/672 (98.6607%)
___Train Local_Simple,  epoch  93, local model 96, internal_epoch   2,  Average loss: 0.0003, Accuracy: 668/672 (99.4048%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.2827, Accuracy: 9174/10000 (91.7400%)
___Train Local_Simple,  epoch  93, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch  93, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0365, Accuracy: 9884/10000 (98.8400%)
poison local model 73 index 0
___Train Local_Simple,  epoch  93, local model 73, internal_epoch   1,  Average loss: 0.0005, Accuracy: 588/591 (99.4924%)
___Train Local_Simple,  epoch  93, local model 73, internal_epoch   2,  Average loss: 0.0004, Accuracy: 587/591 (99.3232%)
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.1510, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch  93, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch  93, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [73]
base_p: [ 0.00124358  0.00035328  0.00046061 ...  0.00131004 -0.00014815
  0.00146401]
[T_SCORE] attacker_local_idxs is:  [0, 3, 5, 6, 8]
layer1_inf_time: 3.186279296875
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0458, Accuracy: 9850/10000 (98.5000%)
time spent on training: 33.21289134025574
Starting performing KrMLRFL...
Num data points: [776, 487, 772, 818, 623, 937, 672, 78, 591, 731]
Num selected data points: [776 487 772  78 731]
The chosen ones are users: [0, 1, 2, 7, 9], which are global users: [47, 97, 40, 76, 72]
[PAIRWISE] pred_attackers_indx:  [0 3 4]
layer2_inf_t: 35.255615234375
assumed final_attacker_idxs:  [0 3 4 5 6 8]
final_attacker_idxs is: [0 3 4 5 6 8]
g_attacker_idxs: [47 98 33 92 96 73]
g_normal_idxs: [97 40 76 72]
filtered_attacker_idxs: [3, 4, 5, 6, 8]
final_attacker_idxs are: [3, 4, 5, 6, 8]
num_dps: [776, 487, 772, 818, 623, 937, 672, 78, 591, 731]
epoch_acc: 98.76
___Test Local_Simple poisoned: False, epoch: 93: Average loss: 0.0384, Accuracy: 9876/10000 (98.7600%)
___Test Local_Simple poisoned: True, epoch: 93: Average loss: 14.6544, Accuracy: 16/8968 (0.1784%)
Done in 146.96582651138306 sec.
Server Epoch:94 choose agents : [68, 38, 40, 13, 30, 2, 83, 51, 27, 88].
___Train Local_Simple,  epoch  94, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 492/494 (99.5951%)
___Train Local_Simple,  epoch  94, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0837, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch  94, local model 38, internal_epoch   1,  Average loss: 0.0004, Accuracy: 887/895 (99.1061%)
___Train Local_Simple,  epoch  94, local model 38, internal_epoch   2,  Average loss: 0.0004, Accuracy: 889/895 (99.3296%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.2223, Accuracy: 9307/10000 (93.0700%)
___Train Local_Simple,  epoch  94, local model 40, internal_epoch   1,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%)
___Train Local_Simple,  epoch  94, local model 40, internal_epoch   2,  Average loss: 0.0000, Accuracy: 772/772 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0552, Accuracy: 9837/10000 (98.3700%)
poison local model 13 index 0
___Train Local_Simple,  epoch  94, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 727/734 (99.0463%)
___Train Local_Simple,  epoch  94, local model 13, internal_epoch   2,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0889, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch  94, local model 30, internal_epoch   1,  Average loss: 0.0004, Accuracy: 396/400 (99.0000%)
___Train Local_Simple,  epoch  94, local model 30, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1980, Accuracy: 9365/10000 (93.6500%)
poison local model 2 index 1
___Train Local_Simple,  epoch  94, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 535/548 (97.6277%)
___Train Local_Simple,  epoch  94, local model 2, internal_epoch   2,  Average loss: 0.0006, Accuracy: 540/548 (98.5401%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0854, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch  94, local model 83, internal_epoch   1,  Average loss: 0.0004, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch  94, local model 83, internal_epoch   2,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0521, Accuracy: 9836/10000 (98.3600%)
poison local model 51 index 2
___Train Local_Simple,  epoch  94, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch  94, local model 51, internal_epoch   2,  Average loss: 0.0003, Accuracy: 565/568 (99.4718%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1035, Accuracy: 9675/10000 (96.7500%)
poison local model 27 index 3
___Train Local_Simple,  epoch  94, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 465/471 (98.7261%)
___Train Local_Simple,  epoch  94, local model 27, internal_epoch   2,  Average loss: 0.0005, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0860, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch  94, local model 88, internal_epoch   1,  Average loss: 0.0006, Accuracy: 525/530 (99.0566%)
___Train Local_Simple,  epoch  94, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 527/530 (99.4340%)
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.1003, Accuracy: 9681/10000 (96.8100%)
time spent on training: 46.81473183631897
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 2, 51, 27]
base_p: [-0.00035253  0.00029487  0.00091767 ... -0.00361286 -0.00361264
 -0.00098391]
[T_SCORE] attacker_local_idxs is:  [3, 5, 7, 8, 9]
layer1_inf_time: 3.174560546875
[PAIRWISE] pred_attackers_indx:  [1 3 5 7 8]
layer2_inf_t: 70.401123046875
assumed final_attacker_idxs:  [1 3 5 7 8 9]
final_attacker_idxs is: [1 3 5 7 8 9]
g_attacker_idxs: [38 13  2 51 27 88]
g_normal_idxs: [68 40 30 83]
filtered_attacker_idxs: [3, 5, 7, 8, 9]
final_attacker_idxs are: [3, 5, 7, 8, 9]
num_dps: [494, 895, 772, 734, 400, 548, 433, 568, 471, 530]
epoch_acc: 98.65
Starting performing KrMLRFL...
Num data points: [494, 895, 772, 734, 400, 548, 433, 568, 471, 530]
Num selected data points: [494 895 772 400 433]
The chosen ones are users: [0, 1, 2, 4, 6], which are global users: [68, 38, 40, 30, 83]
___Test Local_Simple poisoned: False, epoch: 94: Average loss: 0.0408, Accuracy: 9865/10000 (98.6500%)
___Test Local_Simple poisoned: True, epoch: 94: Average loss: 15.5964, Accuracy: 9/8968 (0.1004%)
Done in 232.92468070983887 sec.
Server Epoch:95 choose agents : [6, 49, 50, 32, 22, 78, 64, 66, 82, 47].
___Train Local_Simple,  epoch  95, local model 6, internal_epoch   1,  Average loss: 0.0006, Accuracy: 610/615 (99.1870%)
___Train Local_Simple,  epoch  95, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 610/615 (99.1870%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0894, Accuracy: 9701/10000 (97.0100%)
___Train Local_Simple,  epoch  95, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch  95, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0810, Accuracy: 9752/10000 (97.5200%)
___Train Local_Simple,  epoch  95, local model 50, internal_epoch   1,  Average loss: 0.0005, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch  95, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0968, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch  95, local model 32, internal_epoch   1,  Average loss: 0.0008, Accuracy: 961/977 (98.3623%)
___Train Local_Simple,  epoch  95, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 971/977 (99.3859%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1000, Accuracy: 9685/10000 (96.8500%)
poison local model 22 index 0
___Train Local_Simple,  epoch  95, local model 22, internal_epoch   1,  Average loss: 0.0013, Accuracy: 572/583 (98.1132%)
___Train Local_Simple,  epoch  95, local model 22, internal_epoch   2,  Average loss: 0.0012, Accuracy: 570/583 (97.7702%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.2360, Accuracy: 9228/10000 (92.2800%)
___Train Local_Simple,  epoch  95, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 301/303 (99.3399%)
___Train Local_Simple,  epoch  95, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0782, Accuracy: 9759/10000 (97.5900%)
___Train Local_Simple,  epoch  95, local model 64, internal_epoch   1,  Average loss: 0.0009, Accuracy: 800/813 (98.4010%)
___Train Local_Simple,  epoch  95, local model 64, internal_epoch   2,  Average loss: 0.0003, Accuracy: 809/813 (99.5080%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1807, Accuracy: 9431/10000 (94.3100%)
___Train Local_Simple,  epoch  95, local model 66, internal_epoch   1,  Average loss: 0.0011, Accuracy: 649/660 (98.3333%)
___Train Local_Simple,  epoch  95, local model 66, internal_epoch   2,  Average loss: 0.0003, Accuracy: 658/660 (99.6970%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.1251, Accuracy: 9584/10000 (95.8400%)
___Train Local_Simple,  epoch  95, local model 82, internal_epoch   1,  Average loss: 0.0004, Accuracy: 706/713 (99.0182%)
___Train Local_Simple,  epoch  95, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 710/713 (99.5792%)
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.5020, Accuracy: 8871/10000 (88.7100%)
___Train Local_Simple,  epoch  95, local model 47, internal_epoch   1,  Average loss: 0.0002, Accuracy: 774/776 (99.7423%)
___Train Local_Simple,  epoch  95, local model 47, internal_epoch   2,  Average loss: 0.0001, Accuracy: 776/776 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22]
base_p: [ 1.7079785e-03  3.3909827e-04 -1.5321663e-03 ... -1.2848824e-03
 -2.7380884e-05  1.2249872e-03]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 9]
layer1_inf_time: 4.851806640625
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 422.88818359375
assumed final_attacker_idxs:  [3 4 6 7 9]
final_attacker_idxs is: [3 4 6 7 9]
g_attacker_idxs: [32 22 64 66 47]
g_normal_idxs: [ 6 49 50 78 82]
filtered_attacker_idxs: [3, 4, 7]
final_attacker_idxs are: [3, 4, 7]
num_dps: [615, 506, 474, 977, 583, 303, 813, 660, 713, 776]
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0530, Accuracy: 9840/10000 (98.4000%)
time spent on training: 54.773542165756226
Starting performing KrMLRFL...
Num data points: [615, 506, 474, 977, 583, 303, 813, 660, 713, 776]
Num selected data points: [615 506 474 303 813 713 776]
The chosen ones are users: [0, 1, 2, 5, 6, 8, 9], which are global users: [6, 49, 50, 78, 64, 82, 47]
epoch_acc: 98.66
___Test Local_Simple poisoned: False, epoch: 95: Average loss: 0.0373, Accuracy: 9866/10000 (98.6600%)
___Test Local_Simple poisoned: True, epoch: 95: Average loss: 14.9168, Accuracy: 10/8968 (0.1115%)
Done in 364.10422110557556 sec.
Server Epoch:96 choose agents : [1, 14, 49, 15, 89, 79, 44, 9, 13, 68].
poison local model 1 index 0
___Train Local_Simple,  epoch  96, local model 1, internal_epoch   1,  Average loss: 0.0008, Accuracy: 747/760 (98.2895%)
___Train Local_Simple,  epoch  96, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.2443, Accuracy: 9214/10000 (92.1400%)
___Train Local_Simple,  epoch  96, local model 14, internal_epoch   1,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Train Local_Simple,  epoch  96, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0954, Accuracy: 9753/10000 (97.5300%)
___Train Local_Simple,  epoch  96, local model 49, internal_epoch   1,  Average loss: 0.0001, Accuracy: 506/506 (100.0000%)
___Train Local_Simple,  epoch  96, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0680, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch  96, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch  96, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0391, Accuracy: 9866/10000 (98.6600%)
___Train Local_Simple,  epoch  96, local model 89, internal_epoch   1,  Average loss: 0.0004, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch  96, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0732, Accuracy: 9771/10000 (97.7100%)
___Train Local_Simple,  epoch  96, local model 79, internal_epoch   1,  Average loss: 0.0008, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch  96, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0475, Accuracy: 9843/10000 (98.4300%)
___Train Local_Simple,  epoch  96, local model 44, internal_epoch   1,  Average loss: 0.0007, Accuracy: 510/517 (98.6460%)
___Train Local_Simple,  epoch  96, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 512/517 (99.0329%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0858, Accuracy: 9732/10000 (97.3200%)
___Train Local_Simple,  epoch  96, local model 9, internal_epoch   1,  Average loss: 0.0006, Accuracy: 432/436 (99.0826%)
___Train Local_Simple,  epoch  96, local model 9, internal_epoch   2,  Average loss: 0.0003, Accuracy: 432/436 (99.0826%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0820, Accuracy: 9739/10000 (97.3900%)
poison local model 13 index 1
___Train Local_Simple,  epoch  96, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%)
___Train Local_Simple,  epoch  96, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 731/734 (99.5913%)
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.2030, Accuracy: 9447/10000 (94.4700%)
___Train Local_Simple,  epoch  96, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch  96, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 13]
base_p: [-5.8919191e-05  2.2413954e-04  1.3533793e-04 ...  4.2583048e-04
  1.4454573e-03  7.2054565e-04]
[T_SCORE] attacker_local_idxs is:  [0, 4, 6, 8, 9]
layer1_inf_time: 6.099365234375
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0624, Accuracy: 9800/10000 (98.0000%)
time spent on training: 68.01087641716003
Starting performing KrMLRFL...
[PAIRWISE] pred_attackers_indx:  [0 8]
layer2_inf_t: 653.323974609375
assumed final_attacker_idxs:  [0 4 6 8 9]
final_attacker_idxs is: [0 4 6 8 9]
g_attacker_idxs: [ 1 89 44 13 68]
g_normal_idxs: [14 49 15 79  9]
filtered_attacker_idxs: [0, 4, 8]
final_attacker_idxs are: [0, 4, 8]
num_dps: [760, 376, 506, 401, 492, 182, 517, 436, 734, 494]
Num data points: [760, 376, 506, 401, 492, 182, 517, 436, 734, 494]
Num selected data points: [376 506 401 182 517 436 494]
The chosen ones are users: [1, 2, 3, 5, 6, 7, 9], which are global users: [14, 49, 15, 79, 44, 9, 68]
epoch_acc: 99.0
___Test Local_Simple poisoned: False, epoch: 96: Average loss: 0.0317, Accuracy: 9900/10000 (99.0000%)
___Test Local_Simple poisoned: True, epoch: 96: Average loss: 14.4704, Accuracy: 12/8968 (0.1338%)
Done in 469.44376611709595 sec.
Server Epoch:97 choose agents : [90, 51, 82, 94, 53, 48, 52, 72, 54, 36].
___Train Local_Simple,  epoch  97, local model 90, internal_epoch   1,  Average loss: 0.0004, Accuracy: 679/683 (99.4143%)
___Train Local_Simple,  epoch  97, local model 90, internal_epoch   2,  Average loss: 0.0005, Accuracy: 674/683 (98.6823%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.4575, Accuracy: 8660/10000 (86.6000%)
poison local model 51 index 0
___Train Local_Simple,  epoch  97, local model 51, internal_epoch   1,  Average loss: 0.0004, Accuracy: 563/568 (99.1197%)
___Train Local_Simple,  epoch  97, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0879, Accuracy: 9750/10000 (97.5000%)
___Train Local_Simple,  epoch  97, local model 82, internal_epoch   1,  Average loss: 0.0001, Accuracy: 711/713 (99.7195%)
___Train Local_Simple,  epoch  97, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.2239, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch  97, local model 94, internal_epoch   1,  Average loss: 0.0011, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  97, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1422, Accuracy: 9459/10000 (94.5900%)
___Train Local_Simple,  epoch  97, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 734/739 (99.3234%)
___Train Local_Simple,  epoch  97, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 737/739 (99.7294%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1215, Accuracy: 9644/10000 (96.4400%)
___Train Local_Simple,  epoch  97, local model 48, internal_epoch   1,  Average loss: 0.0005, Accuracy: 443/448 (98.8839%)
___Train Local_Simple,  epoch  97, local model 48, internal_epoch   2,  Average loss: 0.0007, Accuracy: 445/448 (99.3304%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0929, Accuracy: 9701/10000 (97.0100%)
poison local model 52 index 1
___Train Local_Simple,  epoch  97, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch  97, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 251/253 (99.2095%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0927, Accuracy: 9710/10000 (97.1000%)
___Train Local_Simple,  epoch  97, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch  97, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0739, Accuracy: 9750/10000 (97.5000%)
___Train Local_Simple,  epoch  97, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 516/519 (99.4220%)
___Train Local_Simple,  epoch  97, local model 54, internal_epoch   2,  Average loss: 0.0000, Accuracy: 519/519 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0553, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch  97, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 993/1005 (98.8060%)
___Train Local_Simple,  epoch  97, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 995/1005 (99.0050%)
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.1670, Accuracy: 9479/10000 (94.7900%)
time spent on training: 63.66035866737366
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 52]
base_p: [ 4.5470893e-04  2.8692558e-04  7.7559613e-05 ...  7.9706311e-05
  7.0175529e-04 -1.0263622e-03]
[T_SCORE] attacker_local_idxs is:  [1, 4, 6, 8, 9]
layer1_inf_time: 4.723876953125
[PAIRWISE] pred_attackers_indx:  [1 4 9]
layer2_inf_t: 146.40380859375
assumed final_attacker_idxs:  [1 4 6 8 9]
final_attacker_idxs is: [1 4 6 8 9]
g_attacker_idxs: [51 53 52 54 36]
g_normal_idxs: [90 82 94 48 72]
filtered_attacker_idxs: [1, 4, 6, 9]
final_attacker_idxs are: [1, 4, 6, 9]
num_dps: [683, 568, 713, 150, 739, 448, 253, 731, 519, 1005]
Starting performing KrMLRFL...
Num data points: [683, 568, 713, 150, 739, 448, 253, 731, 519, 1005]
Num selected data points: [683 713 150 448 731 519]
The chosen ones are users: [0, 2, 3, 5, 7, 8], which are global users: [90, 82, 94, 48, 72, 54]
epoch_acc: 98.54
___Test Local_Simple poisoned: False, epoch: 97: Average loss: 0.0437, Accuracy: 9854/10000 (98.5400%)
___Test Local_Simple poisoned: True, epoch: 97: Average loss: 14.0273, Accuracy: 11/8968 (0.1227%)
Done in 475.4638352394104 sec.
Server Epoch:98 choose agents : [94, 90, 75, 70, 69, 80, 96, 82, 37, 1].
___Train Local_Simple,  epoch  98, local model 94, internal_epoch   1,  Average loss: 0.0003, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch  98, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0907, Accuracy: 9699/10000 (96.9900%)
___Train Local_Simple,  epoch  98, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 681/683 (99.7072%)
___Train Local_Simple,  epoch  98, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0876, Accuracy: 9713/10000 (97.1300%)
___Train Local_Simple,  epoch  98, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 679/686 (98.9796%)
___Train Local_Simple,  epoch  98, local model 75, internal_epoch   2,  Average loss: 0.0003, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0425, Accuracy: 9871/10000 (98.7100%)
poison local model 70 index 0
___Train Local_Simple,  epoch  98, local model 70, internal_epoch   1,  Average loss: 0.0010, Accuracy: 706/724 (97.5138%)
___Train Local_Simple,  epoch  98, local model 70, internal_epoch   2,  Average loss: 0.0004, Accuracy: 719/724 (99.3094%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.8427, Accuracy: 8751/10000 (87.5100%)
___Train Local_Simple,  epoch  98, local model 69, internal_epoch   1,  Average loss: 0.0004, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch  98, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1104, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch  98, local model 80, internal_epoch   1,  Average loss: 0.0005, Accuracy: 426/431 (98.8399%)
___Train Local_Simple,  epoch  98, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1225, Accuracy: 9669/10000 (96.6900%)
___Train Local_Simple,  epoch  98, local model 96, internal_epoch   1,  Average loss: 0.0011, Accuracy: 663/672 (98.6607%)
___Train Local_Simple,  epoch  98, local model 96, internal_epoch   2,  Average loss: 0.0003, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1900, Accuracy: 9465/10000 (94.6500%)
___Train Local_Simple,  epoch  98, local model 82, internal_epoch   1,  Average loss: 0.0001, Accuracy: 713/713 (100.0000%)
___Train Local_Simple,  epoch  98, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0506, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch  98, local model 37, internal_epoch   1,  Average loss: 0.0005, Accuracy: 852/860 (99.0698%)
___Train Local_Simple,  epoch  98, local model 37, internal_epoch   2,  Average loss: 0.0011, Accuracy: 845/860 (98.2558%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1370, Accuracy: 9613/10000 (96.1300%)
poison local model 1 index 1
___Train Local_Simple,  epoch  98, local model 1, internal_epoch   1,  Average loss: 0.0005, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch  98, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.1898, Accuracy: 9362/10000 (93.6200%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 1]
base_p: [ 0.00078217  0.00030507  0.00033059 ... -0.00111401  0.00072738
 -0.00060117]
[T_SCORE] attacker_local_idxs is:  [3, 5, 6, 8, 9]
layer1_inf_time: 4.19873046875
[PAIRWISE] pred_attackers_indx:  [3]
layer2_inf_t: 32.506103515625
assumed final_attacker_idxs:  [3 5 6 8 9]
final_attacker_idxs is: [3 5 6 8 9]
g_attacker_idxs: [70 80 96 37  1]
g_normal_idxs: [94 90 75 69 82]
filtered_attacker_idxs: [3, 6, 8, 9]
final_attacker_idxs are: [3, 6, 8, 9]
num_dps: [150, 683, 686, 724, 256, 431, 672, 713, 860, 760]
time spent on training: 68.87152147293091
Starting performing KrMLRFL...
Num data points: [150, 683, 686, 724, 256, 431, 672, 713, 860, 760]
Num selected data points: [150 683 686 256 431 713]
The chosen ones are users: [0, 1, 2, 4, 5, 7], which are global users: [94, 90, 75, 69, 80, 82]
epoch_acc: 98.92
___Test Local_Simple poisoned: False, epoch: 98: Average loss: 0.0349, Accuracy: 9892/10000 (98.9200%)
___Test Local_Simple poisoned: True, epoch: 98: Average loss: 14.8848, Accuracy: 4/8968 (0.0446%)
Done in 417.5324857234955 sec.
Server Epoch:99 choose agents : [82, 36, 17, 29, 79, 33, 64, 19, 15, 66].
___Train Local_Simple,  epoch  99, local model 82, internal_epoch   1,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Train Local_Simple,  epoch  99, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0547, Accuracy: 9820/10000 (98.2000%)
___Train Local_Simple,  epoch  99, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 990/1005 (98.5075%)
___Train Local_Simple,  epoch  99, local model 36, internal_epoch   2,  Average loss: 0.0004, Accuracy: 995/1005 (99.0050%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1599, Accuracy: 9522/10000 (95.2200%)
poison local model 17 index 0
___Train Local_Simple,  epoch  99, local model 17, internal_epoch   1,  Average loss: 0.0014, Accuracy: 609/620 (98.2258%)
___Train Local_Simple,  epoch  99, local model 17, internal_epoch   2,  Average loss: 0.0005, Accuracy: 612/620 (98.7097%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0939, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch  99, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Train Local_Simple,  epoch  99, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1054, Accuracy: 9749/10000 (97.4900%)
___Train Local_Simple,  epoch  99, local model 79, internal_epoch   1,  Average loss: 0.0005, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch  99, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0438, Accuracy: 9852/10000 (98.5200%)
___Train Local_Simple,  epoch  99, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 612/623 (98.2343%)
___Train Local_Simple,  epoch  99, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 617/623 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0810, Accuracy: 9740/10000 (97.4000%)
___Train Local_Simple,  epoch  99, local model 64, internal_epoch   1,  Average loss: 0.0004, Accuracy: 807/813 (99.2620%)
___Train Local_Simple,  epoch  99, local model 64, internal_epoch   2,  Average loss: 0.0003, Accuracy: 808/813 (99.3850%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1514, Accuracy: 9494/10000 (94.9400%)
___Train Local_Simple,  epoch  99, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 201/205 (98.0488%)
___Train Local_Simple,  epoch  99, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1371, Accuracy: 9605/10000 (96.0500%)
___Train Local_Simple,  epoch  99, local model 15, internal_epoch   1,  Average loss: 0.0003, Accuracy: 398/401 (99.2519%)
___Train Local_Simple,  epoch  99, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0448, Accuracy: 9846/10000 (98.4600%)
___Train Local_Simple,  epoch  99, local model 66, internal_epoch   1,  Average loss: 0.0007, Accuracy: 650/660 (98.4848%)
___Train Local_Simple,  epoch  99, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 658/660 (99.6970%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [17]
base_p: [ 0.00084139  0.00032145 -0.00045498 ... -0.00039963 -0.00107846
 -0.00046033]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 6, 9]
layer1_inf_time: 4.192138671875
[PAIRWISE] pred_attackers_indx:  [1 4 5 7 8]
layer2_inf_t: 318.319091796875
assumed final_attacker_idxs:  [1 2 4 5 6 7 8 9]
final_attacker_idxs is: [1 2 4 5 6 7 8 9]
g_attacker_idxs: [36 17 79 33 64 19 15 66]
g_normal_idxs: [82 29]
filtered_attacker_idxs: [1, 2, 5, 9]
final_attacker_idxs are: [1, 2, 5, 9]
num_dps: [713, 1005, 620, 1002, 182, 623, 813, 205, 401, 660]
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.1171, Accuracy: 9612/10000 (96.1200%)
time spent on training: 57.861483335494995
Starting performing KrMLRFL...
Num data points: [713, 1005, 620, 1002, 182, 623, 813, 205, 401, 660]
Num selected data points: [ 713 1002  182  813  205  401]
The chosen ones are users: [0, 3, 4, 6, 7, 8], which are global users: [82, 29, 79, 64, 19, 15]
epoch_acc: 98.83
___Test Local_Simple poisoned: False, epoch: 99: Average loss: 0.0354, Accuracy: 9883/10000 (98.8300%)
___Test Local_Simple poisoned: True, epoch: 99: Average loss: 15.0765, Accuracy: 8/8968 (0.0892%)
Done in 416.282785654068 sec.
Server Epoch:100 choose agents : [76, 67, 89, 86, 25, 4, 77, 85, 94, 91].
___Train Local_Simple,  epoch 100, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 100, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0354, Accuracy: 9883/10000 (98.8300%)
___Train Local_Simple,  epoch 100, local model 67, internal_epoch   1,  Average loss: 0.0003, Accuracy: 991/998 (99.2986%)
___Train Local_Simple,  epoch 100, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 995/998 (99.6994%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1824, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch 100, local model 89, internal_epoch   1,  Average loss: 0.0003, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch 100, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1056, Accuracy: 9656/10000 (96.5600%)
___Train Local_Simple,  epoch 100, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 100, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0653, Accuracy: 9796/10000 (97.9600%)
___Train Local_Simple,  epoch 100, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%)
___Train Local_Simple,  epoch 100, local model 25, internal_epoch   2,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1116, Accuracy: 9644/10000 (96.4400%)
___Train Local_Simple,  epoch 100, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 651/658 (98.9362%)
___Train Local_Simple,  epoch 100, local model 4, internal_epoch   2,  Average loss: 0.0001, Accuracy: 656/658 (99.6960%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0987, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch 100, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 586/589 (99.4907%)
___Train Local_Simple,  epoch 100, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 589/589 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0454, Accuracy: 9866/10000 (98.6600%)
poison local model 85 index 0
___Train Local_Simple,  epoch 100, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 100, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0529, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 100, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch 100, local model 94, internal_epoch   2,  Average loss: 0.0005, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.1571, Accuracy: 9372/10000 (93.7200%)
poison local model 91 index 1
___Train Local_Simple,  epoch 100, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 100, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0460, Accuracy: 9846/10000 (98.4600%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 91]
base_p: [1.5217811e-04 2.1464378e-04 6.2739383e-04 ... 1.3027936e-03 5.7220459e-06
 2.3120642e-04]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 7, 9]
layer1_inf_time: 5.781494140625
[PAIRWISE] pred_attackers_indx:  [1 3 5 6]
layer2_inf_t: 449.484619140625
assumed final_attacker_idxs:  [1 2 3 5 6 7 9]
final_attacker_idxs is: [1 2 3 5 6 7 9]
g_attacker_idxs: [67 89 86  4 77 85 91]
g_normal_idxs: [76 25 94]
filtered_attacker_idxs: [1, 2, 5, 6, 7, 9]
final_attacker_idxs are: [1, 2, 5, 6, 7, 9]
num_dps: [78, 998, 492, 250, 647, 658, 589, 431, 150, 256]
time spent on training: 74.37107586860657
Starting performing KrMLRFL...
Num data points: [78, 998, 492, 250, 647, 658, 589, 431, 150, 256]
Num selected data points: [ 78 250 647 150]
The chosen ones are users: [0, 3, 4, 8], which are global users: [76, 86, 25, 94]
epoch_acc: 98.48
___Test Local_Simple poisoned: False, epoch: 100: Average loss: 0.0472, Accuracy: 9848/10000 (98.4800%)
___Test Local_Simple poisoned: True, epoch: 100: Average loss: 13.3466, Accuracy: 51/8968 (0.5687%)
Done in 465.5178916454315 sec.
Server Epoch:101 choose agents : [20, 58, 95, 86, 54, 98, 80, 19, 94, 33].
poison local model 20 index 0
___Train Local_Simple,  epoch 101, local model 20, internal_epoch   1,  Average loss: 0.0009, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 101, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 423/429 (98.6014%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1285, Accuracy: 9608/10000 (96.0800%)
___Train Local_Simple,  epoch 101, local model 58, internal_epoch   1,  Average loss: 0.0002, Accuracy: 273/276 (98.9130%)
___Train Local_Simple,  epoch 101, local model 58, internal_epoch   2,  Average loss: 0.0004, Accuracy: 274/276 (99.2754%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0562, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 101, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 598/602 (99.3355%)
___Train Local_Simple,  epoch 101, local model 95, internal_epoch   2,  Average loss: 0.0001, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.4331, Accuracy: 8883/10000 (88.8300%)
___Train Local_Simple,  epoch 101, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 246/250 (98.4000%)
___Train Local_Simple,  epoch 101, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0896, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch 101, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 516/519 (99.4220%)
___Train Local_Simple,  epoch 101, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 515/519 (99.2293%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1379, Accuracy: 9607/10000 (96.0700%)
___Train Local_Simple,  epoch 101, local model 98, internal_epoch   1,  Average loss: 0.0012, Accuracy: 796/818 (97.3105%)
___Train Local_Simple,  epoch 101, local model 98, internal_epoch   2,  Average loss: 0.0007, Accuracy: 806/818 (98.5330%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1323, Accuracy: 9572/10000 (95.7200%)
___Train Local_Simple,  epoch 101, local model 80, internal_epoch   1,  Average loss: 0.0004, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 101, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0737, Accuracy: 9793/10000 (97.9300%)
___Train Local_Simple,  epoch 101, local model 19, internal_epoch   1,  Average loss: 0.0005, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 101, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 204/205 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.2690, Accuracy: 9314/10000 (93.1400%)
___Train Local_Simple,  epoch 101, local model 94, internal_epoch   1,  Average loss: 0.0006, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 101, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1581, Accuracy: 9448/10000 (94.4800%)
___Train Local_Simple,  epoch 101, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 616/623 (98.8764%)
___Train Local_Simple,  epoch 101, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.1828, Accuracy: 9446/10000 (94.4600%)
time spent on training: 58.24101543426514
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20]
base_p: [ 0.0003802   0.00017301 -0.00010482 ... -0.00215571 -0.00651719
  0.00018314]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 6, 9]
layer1_inf_time: 5.186767578125
[PAIRWISE] pred_attackers_indx:  [0 2 3 5 9]
layer2_inf_t: 713.841064453125
assumed final_attacker_idxs:  [0 2 3 5 6 9]
final_attacker_idxs is: [0 2 3 5 6 9]
g_attacker_idxs: [20 95 86 98 80 33]
g_normal_idxs: [58 54 19 94]
filtered_attacker_idxs: [0, 2, 5, 9]
final_attacker_idxs are: [0, 2, 5, 9]
num_dps: [429, 276, 602, 250, 519, 818, 431, 205, 150, 623]
Starting performing KrMLRFL...
Num data points: [429, 276, 602, 250, 519, 818, 431, 205, 150, 623]
Num selected data points: [276 250 519 431 205 150]
The chosen ones are users: [1, 3, 4, 6, 7, 8], which are global users: [58, 86, 54, 80, 19, 94]
epoch_acc: 98.66
___Test Local_Simple poisoned: False, epoch: 101: Average loss: 0.0415, Accuracy: 9866/10000 (98.6600%)
___Test Local_Simple poisoned: True, epoch: 101: Average loss: 14.1888, Accuracy: 14/8968 (0.1561%)
Done in 449.2622790336609 sec.
Server Epoch:102 choose agents : [47, 89, 52, 39, 94, 10, 36, 79, 53, 74].
___Train Local_Simple,  epoch 102, local model 47, internal_epoch   1,  Average loss: 0.0002, Accuracy: 775/776 (99.8711%)
___Train Local_Simple,  epoch 102, local model 47, internal_epoch   2,  Average loss: 0.0001, Accuracy: 772/776 (99.4845%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0553, Accuracy: 9832/10000 (98.3200%)
___Train Local_Simple,  epoch 102, local model 89, internal_epoch   1,  Average loss: 0.0004, Accuracy: 484/492 (98.3740%)
___Train Local_Simple,  epoch 102, local model 89, internal_epoch   2,  Average loss: 0.0004, Accuracy: 489/492 (99.3902%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.1860, Accuracy: 9492/10000 (94.9200%)
poison local model 52 index 0
___Train Local_Simple,  epoch 102, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 102, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0696, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch 102, local model 39, internal_epoch   1,  Average loss: 0.0004, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 102, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0431, Accuracy: 9861/10000 (98.6100%)
___Train Local_Simple,  epoch 102, local model 94, internal_epoch   1,  Average loss: 0.0009, Accuracy: 148/150 (98.6667%)
___Train Local_Simple,  epoch 102, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0942, Accuracy: 9683/10000 (96.8300%)
___Train Local_Simple,  epoch 102, local model 10, internal_epoch   1,  Average loss: 0.0004, Accuracy: 881/892 (98.7668%)
___Train Local_Simple,  epoch 102, local model 10, internal_epoch   2,  Average loss: 0.0014, Accuracy: 874/892 (97.9821%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.3434, Accuracy: 9072/10000 (90.7200%)
___Train Local_Simple,  epoch 102, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 994/1005 (98.9055%)
___Train Local_Simple,  epoch 102, local model 36, internal_epoch   2,  Average loss: 0.0004, Accuracy: 996/1005 (99.1045%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.1325, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch 102, local model 79, internal_epoch   1,  Average loss: 0.0007, Accuracy: 179/182 (98.3516%)
___Train Local_Simple,  epoch 102, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0454, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 102, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 102, local model 53, internal_epoch   2,  Average loss: 0.0004, Accuracy: 733/739 (99.1881%)
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0978, Accuracy: 9679/10000 (96.7900%)
___Train Local_Simple,  epoch 102, local model 74, internal_epoch   1,  Average loss: 0.0004, Accuracy: 554/557 (99.4614%)
___Train Local_Simple,  epoch 102, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00110947  0.00025782 -0.0002181  ...  0.00139055 -0.00046052
 -0.00120807]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 8]
layer1_inf_time: 6.013671875
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0549, Accuracy: 9822/10000 (98.2200%)
time spent on training: 59.40829396247864
Starting performing KrMLRFL...
[PAIRWISE] pred_attackers_indx:  [1 5 6 8 9]
layer2_inf_t: 617.209716796875
assumed final_attacker_idxs:  [0 1 2 5 6 8 9]
final_attacker_idxs is: [0 1 2 5 6 8 9]
g_attacker_idxs: [47 89 52 10 36 53 74]
g_normal_idxs: [39 94 79]
filtered_attacker_idxs: [1, 2, 6, 8]
final_attacker_idxs are: [1, 2, 6, 8]
num_dps: [776, 492, 253, 257, 150, 892, 1005, 182, 739, 557]
Num data points: [776, 492, 253, 257, 150, 892, 1005, 182, 739, 557]
Num selected data points: [776 257 150 892 182 557]
The chosen ones are users: [0, 3, 4, 5, 7, 9], which are global users: [47, 39, 94, 10, 79, 74]
epoch_acc: 98.72999999999999
___Test Local_Simple poisoned: False, epoch: 102: Average loss: 0.0386, Accuracy: 9873/10000 (98.7300%)
___Test Local_Simple poisoned: True, epoch: 102: Average loss: 13.7111, Accuracy: 7/8968 (0.0781%)
Done in 414.288685798645 sec.
Server Epoch:103 choose agents : [6, 10, 27, 69, 28, 15, 13, 81, 44, 66].
___Train Local_Simple,  epoch 103, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 612/615 (99.5122%)
___Train Local_Simple,  epoch 103, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 613/615 (99.6748%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0851, Accuracy: 9707/10000 (97.0700%)
___Train Local_Simple,  epoch 103, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 890/892 (99.7758%)
___Train Local_Simple,  epoch 103, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 890/892 (99.7758%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0707, Accuracy: 9765/10000 (97.6500%)
poison local model 27 index 0
___Train Local_Simple,  epoch 103, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 103, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.2132, Accuracy: 9417/10000 (94.1700%)
___Train Local_Simple,  epoch 103, local model 69, internal_epoch   1,  Average loss: 0.0004, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 103, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.1111, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch 103, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 103, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0451, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 103, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 396/401 (98.7531%)
___Train Local_Simple,  epoch 103, local model 15, internal_epoch   2,  Average loss: 0.0003, Accuracy: 399/401 (99.5012%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.1156, Accuracy: 9571/10000 (95.7100%)
poison local model 13 index 1
___Train Local_Simple,  epoch 103, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 723/734 (98.5014%)
___Train Local_Simple,  epoch 103, local model 13, internal_epoch   2,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.1061, Accuracy: 9654/10000 (96.5400%)
poison local model 81 index 2
___Train Local_Simple,  epoch 103, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1213/1227 (98.8590%)
___Train Local_Simple,  epoch 103, local model 81, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1221/1227 (99.5110%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.6790, Accuracy: 8899/10000 (88.9900%)
___Train Local_Simple,  epoch 103, local model 44, internal_epoch   1,  Average loss: 0.0004, Accuracy: 514/517 (99.4197%)
___Train Local_Simple,  epoch 103, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 512/517 (99.0329%)
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.1294, Accuracy: 9590/10000 (95.9000%)
___Train Local_Simple,  epoch 103, local model 66, internal_epoch   1,  Average loss: 0.0004, Accuracy: 655/660 (99.2424%)
___Train Local_Simple,  epoch 103, local model 66, internal_epoch   2,  Average loss: 0.0003, Accuracy: 656/660 (99.3939%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 13, 81]
base_p: [-0.00306092  0.00031454 -0.00082029 ... -0.0043592  -0.00226316
 -0.00142182]
[T_SCORE] attacker_local_idxs is:  [2, 6, 7, 8, 9]
layer1_inf_time: 3.851318359375
[PAIRWISE] pred_attackers_indx:  [6 7]
layer2_inf_t: 38.112548828125
assumed final_attacker_idxs:  [2 6 7 8 9]
final_attacker_idxs is: [2 6 7 8 9]
g_attacker_idxs: [27 13 81 44 66]
g_normal_idxs: [ 6 10 69 28 15]
filtered_attacker_idxs: [2, 6, 7, 9]
final_attacker_idxs are: [2, 6, 7, 9]
num_dps: [615, 892, 471, 256, 501, 401, 734, 1227, 517, 660]
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.1968, Accuracy: 9382/10000 (93.8200%)
time spent on training: 83.19381713867188
Starting performing KrMLRFL...
Num data points: [615, 892, 471, 256, 501, 401, 734, 1227, 517, 660]
Num selected data points: [615 892 256 501 401 517]
The chosen ones are users: [0, 1, 3, 4, 5, 8], which are global users: [6, 10, 69, 28, 15, 44]
epoch_acc: 98.79
___Test Local_Simple poisoned: False, epoch: 103: Average loss: 0.0372, Accuracy: 9879/10000 (98.7900%)
___Test Local_Simple poisoned: True, epoch: 103: Average loss: 13.8593, Accuracy: 10/8968 (0.1115%)
Done in 437.94659066200256 sec.
Server Epoch:104 choose agents : [29, 45, 66, 74, 73, 21, 79, 80, 25, 96].
___Train Local_Simple,  epoch 104, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Train Local_Simple,  epoch 104, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1205, Accuracy: 9625/10000 (96.2500%)
poison local model 45 index 0
___Train Local_Simple,  epoch 104, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 616/628 (98.0892%)
___Train Local_Simple,  epoch 104, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1562, Accuracy: 9550/10000 (95.5000%)
___Train Local_Simple,  epoch 104, local model 66, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/660 (98.9394%)
___Train Local_Simple,  epoch 104, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 655/660 (99.2424%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.3099, Accuracy: 9101/10000 (91.0100%)
___Train Local_Simple,  epoch 104, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 552/557 (99.1023%)
___Train Local_Simple,  epoch 104, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0732, Accuracy: 9760/10000 (97.6000%)
poison local model 73 index 1
___Train Local_Simple,  epoch 104, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%)
___Train Local_Simple,  epoch 104, local model 73, internal_epoch   2,  Average loss: 0.0003, Accuracy: 588/591 (99.4924%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1108, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 104, local model 21, internal_epoch   1,  Average loss: 0.0005, Accuracy: 307/312 (98.3974%)
___Train Local_Simple,  epoch 104, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1283, Accuracy: 9551/10000 (95.5100%)
___Train Local_Simple,  epoch 104, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 104, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0392, Accuracy: 9883/10000 (98.8300%)
___Train Local_Simple,  epoch 104, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 104, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0931, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 104, local model 25, internal_epoch   1,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Train Local_Simple,  epoch 104, local model 25, internal_epoch   2,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0696, Accuracy: 9786/10000 (97.8600%)
___Train Local_Simple,  epoch 104, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 664/672 (98.8095%)
___Train Local_Simple,  epoch 104, local model 96, internal_epoch   2,  Average loss: 0.0004, Accuracy: 668/672 (99.4048%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 73]
base_p: [ 0.00087872  0.00026982  0.00077539 ... -0.00553896 -0.00186558
 -0.00011897]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 7, 9]
layer1_inf_time: 4.798095703125
[PAIRWISE] pred_attackers_indx:  [0 2 3 5 8]
layer2_inf_t: 127.218994140625
assumed final_attacker_idxs:  [0 1 2 3 4 5 7 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 7 8 9]
g_attacker_idxs: [29 45 66 74 73 21 80 25 96]
g_normal_idxs: [79]
filtered_attacker_idxs: [0, 1, 2, 4, 8, 9]
final_attacker_idxs are: [0, 1, 2, 4, 8, 9]
num_dps: [1002, 628, 660, 557, 591, 312, 182, 431, 647, 672]
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.1327, Accuracy: 9593/10000 (95.9300%)
time spent on training: 68.98534989356995
Starting performing KrMLRFL...
Num data points: [1002, 628, 660, 557, 591, 312, 182, 431, 647, 672]
Num selected data points: [557 312 182 431]
The chosen ones are users: [3, 5, 6, 7], which are global users: [74, 21, 79, 80]
epoch_acc: 98.94
___Test Local_Simple poisoned: False, epoch: 104: Average loss: 0.0356, Accuracy: 9894/10000 (98.9400%)
___Test Local_Simple poisoned: True, epoch: 104: Average loss: 13.2544, Accuracy: 31/8968 (0.3457%)
Done in 421.5005006790161 sec.
Server Epoch:105 choose agents : [59, 53, 27, 94, 48, 51, 20, 52, 93, 89].
___Train Local_Simple,  epoch 105, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 753/760 (99.0789%)
___Train Local_Simple,  epoch 105, local model 59, internal_epoch   2,  Average loss: 0.0003, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1501, Accuracy: 9523/10000 (95.2300%)
___Train Local_Simple,  epoch 105, local model 53, internal_epoch   1,  Average loss: 0.0005, Accuracy: 736/739 (99.5940%)
___Train Local_Simple,  epoch 105, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0634, Accuracy: 9800/10000 (98.0000%)
poison local model 27 index 0
___Train Local_Simple,  epoch 105, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 105, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 467/471 (99.1507%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.3389, Accuracy: 9254/10000 (92.5400%)
___Train Local_Simple,  epoch 105, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 105, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0693, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch 105, local model 48, internal_epoch   1,  Average loss: 0.0004, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch 105, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 446/448 (99.5536%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0589, Accuracy: 9808/10000 (98.0800%)
poison local model 51 index 1
___Train Local_Simple,  epoch 105, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 563/568 (99.1197%)
___Train Local_Simple,  epoch 105, local model 51, internal_epoch   2,  Average loss: 0.0000, Accuracy: 568/568 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0861, Accuracy: 9721/10000 (97.2100%)
poison local model 20 index 2
___Train Local_Simple,  epoch 105, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 105, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 424/429 (98.8345%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1345, Accuracy: 9592/10000 (95.9200%)
poison local model 52 index 3
___Train Local_Simple,  epoch 105, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch 105, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.1206, Accuracy: 9646/10000 (96.4600%)
poison local model 93 index 0
___Train Local_Simple,  epoch 105, local model 93, internal_epoch   1,  Average loss: 0.0003, Accuracy: 617/623 (99.0369%)
___Train Local_Simple,  epoch 105, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.3391, Accuracy: 9107/10000 (91.0700%)
___Train Local_Simple,  epoch 105, local model 89, internal_epoch   1,  Average loss: 0.0003, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch 105, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 51, 20, 52, 93]
base_p: [ 0.0003271   0.00021445  0.00056101 ... -0.00185047 -0.00076295
  0.00032157]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6, 7, 8]
layer1_inf_time: 4.434814453125
[PAIRWISE] pred_attackers_indx:  [0 6 8]
layer2_inf_t: 262.1025390625
assumed final_attacker_idxs:  [0 1 2 5 6 7 8]
final_attacker_idxs is: [0 1 2 5 6 7 8]
g_attacker_idxs: [59 53 27 51 20 52 93]
g_normal_idxs: [94 48 89]
filtered_attacker_idxs: [0, 1, 2, 5, 6, 7, 8]
final_attacker_idxs are: [0, 1, 2, 5, 6, 7, 8]
num_dps: [760, 739, 471, 150, 448, 568, 429, 253, 623, 492]
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0682, Accuracy: 9786/10000 (97.8600%)
time spent on training: 124.24307131767273
Starting performing KrMLRFL...
Num data points: [760, 739, 471, 150, 448, 568, 429, 253, 623, 492]
Num selected data points: [150 448 492]
The chosen ones are users: [3, 4, 9], which are global users: [94, 48, 89]
epoch_acc: 98.68
___Test Local_Simple poisoned: False, epoch: 105: Average loss: 0.0398, Accuracy: 9868/10000 (98.6800%)
___Test Local_Simple poisoned: True, epoch: 105: Average loss: 13.4880, Accuracy: 31/8968 (0.3457%)
Done in 482.56662368774414 sec.
Server Epoch:106 choose agents : [46, 20, 0, 79, 78, 82, 87, 33, 62, 76].
___Train Local_Simple,  epoch 106, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 697/710 (98.1690%)
___Train Local_Simple,  epoch 106, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 699/710 (98.4507%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.1982, Accuracy: 9361/10000 (93.6100%)
poison local model 20 index 0
___Train Local_Simple,  epoch 106, local model 20, internal_epoch   1,  Average loss: 0.0007, Accuracy: 423/429 (98.6014%)
___Train Local_Simple,  epoch 106, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 425/429 (99.0676%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.2367, Accuracy: 9298/10000 (92.9800%)
___Train Local_Simple,  epoch 106, local model 0, internal_epoch   1,  Average loss: 0.0008, Accuracy: 429/435 (98.6207%)
___Train Local_Simple,  epoch 106, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0650, Accuracy: 9788/10000 (97.8800%)
___Train Local_Simple,  epoch 106, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch 106, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0424, Accuracy: 9870/10000 (98.7000%)
___Train Local_Simple,  epoch 106, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 106, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0948, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch 106, local model 82, internal_epoch   1,  Average loss: 0.0002, Accuracy: 710/713 (99.5792%)
___Train Local_Simple,  epoch 106, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.6377, Accuracy: 8829/10000 (88.2900%)
___Train Local_Simple,  epoch 106, local model 87, internal_epoch   1,  Average loss: 0.0005, Accuracy: 466/470 (99.1489%)
___Train Local_Simple,  epoch 106, local model 87, internal_epoch   2,  Average loss: 0.0007, Accuracy: 463/470 (98.5106%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.2776, Accuracy: 9290/10000 (92.9000%)
___Train Local_Simple,  epoch 106, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 613/623 (98.3949%)
___Train Local_Simple,  epoch 106, local model 33, internal_epoch   2,  Average loss: 0.0006, Accuracy: 616/623 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.2059, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch 106, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 106, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0557, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 106, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 106, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20]
base_p: [-0.00177272  0.0001764  -0.00195307 ...  0.00193352  0.00104505
  0.00029191]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 7]
layer1_inf_time: 6.165771484375
[PAIRWISE] pred_attackers_indx:  [0 5 7]
layer2_inf_t: 216.792236328125
assumed final_attacker_idxs:  [0 1 2 5 7]
final_attacker_idxs is: [0 1 2 5 7]
g_attacker_idxs: [46 20  0 82 33]
g_normal_idxs: [79 78 87 62 76]
filtered_attacker_idxs: [0, 1, 7]
final_attacker_idxs are: [0, 1, 7]
num_dps: [710, 429, 435, 182, 303, 713, 470, 623, 423, 78]
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0390, Accuracy: 9869/10000 (98.6900%)
time spent on training: 60.27101254463196
Starting performing KrMLRFL...
Num data points: [710, 429, 435, 182, 303, 713, 470, 623, 423, 78]
Num selected data points: [435 182 303 713 470 423  78]
The chosen ones are users: [2, 3, 4, 5, 6, 8, 9], which are global users: [0, 79, 78, 82, 87, 62, 76]
epoch_acc: 98.89
___Test Local_Simple poisoned: False, epoch: 106: Average loss: 0.0347, Accuracy: 9889/10000 (98.8900%)
___Test Local_Simple poisoned: True, epoch: 106: Average loss: 14.4370, Accuracy: 8/8968 (0.0892%)
Done in 409.9524612426758 sec.
Server Epoch:107 choose agents : [56, 34, 5, 20, 94, 22, 14, 63, 4, 67].
___Train Local_Simple,  epoch 107, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 876/880 (99.5455%)
___Train Local_Simple,  epoch 107, local model 56, internal_epoch   2,  Average loss: 0.0002, Accuracy: 876/880 (99.5455%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0891, Accuracy: 9718/10000 (97.1800%)
poison local model 34 index 0
___Train Local_Simple,  epoch 107, local model 34, internal_epoch   1,  Average loss: 0.0004, Accuracy: 410/413 (99.2736%)
___Train Local_Simple,  epoch 107, local model 34, internal_epoch   2,  Average loss: 0.0001, Accuracy: 413/413 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.2024, Accuracy: 9484/10000 (94.8400%)
___Train Local_Simple,  epoch 107, local model 5, internal_epoch   1,  Average loss: 0.0007, Accuracy: 428/434 (98.6175%)
___Train Local_Simple,  epoch 107, local model 5, internal_epoch   2,  Average loss: 0.0003, Accuracy: 431/434 (99.3088%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0914, Accuracy: 9681/10000 (96.8100%)
poison local model 20 index 1
___Train Local_Simple,  epoch 107, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 425/429 (99.0676%)
___Train Local_Simple,  epoch 107, local model 20, internal_epoch   2,  Average loss: 0.0003, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.4592, Accuracy: 8838/10000 (88.3800%)
___Train Local_Simple,  epoch 107, local model 94, internal_epoch   1,  Average loss: 0.0016, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 107, local model 94, internal_epoch   2,  Average loss: 0.0017, Accuracy: 148/150 (98.6667%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.2507, Accuracy: 9177/10000 (91.7700%)
poison local model 22 index 2
___Train Local_Simple,  epoch 107, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 576/583 (98.7993%)
___Train Local_Simple,  epoch 107, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.1344, Accuracy: 9588/10000 (95.8800%)
___Train Local_Simple,  epoch 107, local model 14, internal_epoch   1,  Average loss: 0.0004, Accuracy: 374/376 (99.4681%)
___Train Local_Simple,  epoch 107, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.1147, Accuracy: 9688/10000 (96.8800%)
poison local model 63 index 3
___Train Local_Simple,  epoch 107, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 870/889 (97.8628%)
___Train Local_Simple,  epoch 107, local model 63, internal_epoch   2,  Average loss: 0.0010, Accuracy: 871/889 (97.9753%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0680, Accuracy: 9784/10000 (97.8400%)
___Train Local_Simple,  epoch 107, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 654/658 (99.3921%)
___Train Local_Simple,  epoch 107, local model 4, internal_epoch   2,  Average loss: 0.0009, Accuracy: 649/658 (98.6322%)
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0545, Accuracy: 9829/10000 (98.2900%)
___Train Local_Simple,  epoch 107, local model 67, internal_epoch   1,  Average loss: 0.0002, Accuracy: 991/998 (99.2986%)
___Train Local_Simple,  epoch 107, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 20, 22, 63]
base_p: [ 0.00249309  0.00027807  0.00044266 ...  0.00016108 -0.00135572
  0.00018441]
[T_SCORE] attacker_local_idxs is:  [1, 3, 5, 7, 8]
layer1_inf_time: 4.263671875
[PAIRWISE] pred_attackers_indx:  [1 3 5 7]
layer2_inf_t: 532.0576171875
assumed final_attacker_idxs:  [1 3 5 7 8]
final_attacker_idxs is: [1 3 5 7 8]
g_attacker_idxs: [34 20 22 63  4]
g_normal_idxs: [56  5 94 14 67]
filtered_attacker_idxs: [1, 3, 5, 7, 8]
final_attacker_idxs are: [1, 3, 5, 7, 8]
num_dps: [880, 413, 434, 429, 150, 583, 376, 889, 658, 998]
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.1363, Accuracy: 9588/10000 (95.8800%)
time spent on training: 98.03320956230164
Starting performing KrMLRFL...
Num data points: [880, 413, 434, 429, 150, 583, 376, 889, 658, 998]
Num selected data points: [880 434 150 376 998]
The chosen ones are users: [0, 2, 4, 6, 9], which are global users: [56, 5, 94, 14, 67]
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: False, epoch: 107: Average loss: 0.0411, Accuracy: 9874/10000 (98.7400%)
___Test Local_Simple poisoned: True, epoch: 107: Average loss: 13.8153, Accuracy: 33/8968 (0.3680%)
Done in 459.96589255332947 sec.
Server Epoch:108 choose agents : [91, 64, 77, 14, 67, 90, 75, 97, 92, 40].
poison local model 91 index 0
___Train Local_Simple,  epoch 108, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 108, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0440, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 108, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 806/813 (99.1390%)
___Train Local_Simple,  epoch 108, local model 64, internal_epoch   2,  Average loss: 0.0006, Accuracy: 807/813 (99.2620%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.1780, Accuracy: 9414/10000 (94.1400%)
___Train Local_Simple,  epoch 108, local model 77, internal_epoch   1,  Average loss: 0.0004, Accuracy: 586/589 (99.4907%)
___Train Local_Simple,  epoch 108, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 587/589 (99.6604%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0462, Accuracy: 9867/10000 (98.6700%)
___Train Local_Simple,  epoch 108, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 369/376 (98.1383%)
___Train Local_Simple,  epoch 108, local model 14, internal_epoch   2,  Average loss: 0.0002, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0772, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 108, local model 67, internal_epoch   1,  Average loss: 0.0001, Accuracy: 997/998 (99.8998%)
___Train Local_Simple,  epoch 108, local model 67, internal_epoch   2,  Average loss: 0.0000, Accuracy: 998/998 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0721, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch 108, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 679/683 (99.4143%)
___Train Local_Simple,  epoch 108, local model 90, internal_epoch   2,  Average loss: 0.0003, Accuracy: 680/683 (99.5608%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.3141, Accuracy: 9004/10000 (90.0400%)
___Train Local_Simple,  epoch 108, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch 108, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0625, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 108, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 108, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.2260, Accuracy: 9439/10000 (94.3900%)
___Train Local_Simple,  epoch 108, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 928/937 (99.0395%)
___Train Local_Simple,  epoch 108, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 929/937 (99.1462%)
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0900, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch 108, local model 40, internal_epoch   1,  Average loss: 0.0004, Accuracy: 766/772 (99.2228%)
___Train Local_Simple,  epoch 108, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 770/772 (99.7409%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91]
base_p: [ 0.00030095  0.00032324  0.00132769 ... -0.0002166   0.00285239
  0.00075845]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 8, 9]
layer1_inf_time: 3.857177734375
[PAIRWISE] pred_attackers_indx:  [3 5 6 7 9]
layer2_inf_t: 255.734130859375
assumed final_attacker_idxs:  [0 1 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 1 3 4 5 6 7 8 9]
g_attacker_idxs: [91 64 14 67 90 75 97 92 40]
g_normal_idxs: [77]
filtered_attacker_idxs: [0, 4, 8, 9]
final_attacker_idxs are: [0, 4, 8, 9]
num_dps: [256, 813, 589, 376, 998, 683, 686, 487, 937, 772]
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0697, Accuracy: 9794/10000 (97.9400%)
time spent on training: 60.42915320396423
Starting performing KrMLRFL...
Num data points: [256, 813, 589, 376, 998, 683, 686, 487, 937, 772]
Num selected data points: [813 589 376 683 686 487]
The chosen ones are users: [1, 2, 3, 5, 6, 7], which are global users: [64, 77, 14, 90, 75, 97]
epoch_acc: 98.68
___Test Local_Simple poisoned: False, epoch: 108: Average loss: 0.0408, Accuracy: 9868/10000 (98.6800%)
___Test Local_Simple poisoned: True, epoch: 108: Average loss: 13.5593, Accuracy: 19/8968 (0.2119%)
Done in 416.1365625858307 sec.
Server Epoch:109 choose agents : [76, 6, 8, 88, 2, 82, 12, 27, 61, 21].
___Train Local_Simple,  epoch 109, local model 76, internal_epoch   1,  Average loss: 0.0002, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 109, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0365, Accuracy: 9887/10000 (98.8700%)
___Train Local_Simple,  epoch 109, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Train Local_Simple,  epoch 109, local model 6, internal_epoch   2,  Average loss: 0.0000, Accuracy: 615/615 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0663, Accuracy: 9789/10000 (97.8900%)
___Train Local_Simple,  epoch 109, local model 8, internal_epoch   1,  Average loss: 0.0004, Accuracy: 626/633 (98.8942%)
___Train Local_Simple,  epoch 109, local model 8, internal_epoch   2,  Average loss: 0.0003, Accuracy: 630/633 (99.5261%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0719, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 109, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 521/530 (98.3019%)
___Train Local_Simple,  epoch 109, local model 88, internal_epoch   2,  Average loss: 0.0003, Accuracy: 527/530 (99.4340%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.2156, Accuracy: 9320/10000 (93.2000%)
poison local model 2 index 0
___Train Local_Simple,  epoch 109, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 109, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 546/548 (99.6350%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0572, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch 109, local model 82, internal_epoch   1,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Train Local_Simple,  epoch 109, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0638, Accuracy: 9781/10000 (97.8100%)
___Train Local_Simple,  epoch 109, local model 12, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1141/1160 (98.3621%)
___Train Local_Simple,  epoch 109, local model 12, internal_epoch   2,  Average loss: 0.0015, Accuracy: 1133/1160 (97.6724%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.1765, Accuracy: 9477/10000 (94.7700%)
poison local model 27 index 1
___Train Local_Simple,  epoch 109, local model 27, internal_epoch   1,  Average loss: 0.0009, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 109, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 466/471 (98.9384%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.1383, Accuracy: 9516/10000 (95.1600%)
poison local model 61 index 2
___Train Local_Simple,  epoch 109, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 691/699 (98.8555%)
___Train Local_Simple,  epoch 109, local model 61, internal_epoch   2,  Average loss: 0.0001, Accuracy: 699/699 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.2240, Accuracy: 9214/10000 (92.1400%)
___Train Local_Simple,  epoch 109, local model 21, internal_epoch   1,  Average loss: 0.0006, Accuracy: 308/312 (98.7179%)
___Train Local_Simple,  epoch 109, local model 21, internal_epoch   2,  Average loss: 0.0004, Accuracy: 309/312 (99.0385%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 27, 61]
base_p: [ 0.00078002  0.00027543 -0.00039363 ... -0.00165643  0.00036886
 -0.00030418]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 8]
layer1_inf_time: 5.982177734375
[PAIRWISE] pred_attackers_indx:  [3 6 8]
layer2_inf_t: 77.1533203125
assumed final_attacker_idxs:  [3 4 6 7 8]
final_attacker_idxs is: [3 4 6 7 8]
g_attacker_idxs: [88  2 12 27 61]
g_normal_idxs: [76  6  8 82 21]
filtered_attacker_idxs: [3, 4, 6, 7, 8]
final_attacker_idxs are: [3, 4, 6, 7, 8]
num_dps: [78, 615, 633, 530, 548, 713, 1160, 471, 699, 312]
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.1068, Accuracy: 9621/10000 (96.2100%)
time spent on training: 85.54642820358276
Starting performing KrMLRFL...
Num data points: [78, 615, 633, 530, 548, 713, 1160, 471, 699, 312]
Num selected data points: [ 78 615 633 713 312]
The chosen ones are users: [0, 1, 2, 5, 9], which are global users: [76, 6, 8, 82, 21]
epoch_acc: 98.61999999999999
___Test Local_Simple poisoned: False, epoch: 109: Average loss: 0.0413, Accuracy: 9862/10000 (98.6200%)
___Test Local_Simple poisoned: True, epoch: 109: Average loss: 14.0963, Accuracy: 18/8968 (0.2007%)
Done in 469.2821707725525 sec.
Server Epoch:110 choose agents : [35, 57, 43, 34, 76, 26, 92, 3, 13, 16].
___Train Local_Simple,  epoch 110, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 110, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0820, Accuracy: 9753/10000 (97.5300%)
___Train Local_Simple,  epoch 110, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 338/343 (98.5423%)
___Train Local_Simple,  epoch 110, local model 57, internal_epoch   2,  Average loss: 0.0014, Accuracy: 335/343 (97.6676%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0973, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch 110, local model 43, internal_epoch   1,  Average loss: 0.0012, Accuracy: 398/408 (97.5490%)
___Train Local_Simple,  epoch 110, local model 43, internal_epoch   2,  Average loss: 0.0005, Accuracy: 405/408 (99.2647%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0603, Accuracy: 9812/10000 (98.1200%)
poison local model 34 index 0
___Train Local_Simple,  epoch 110, local model 34, internal_epoch   1,  Average loss: 0.0004, Accuracy: 409/413 (99.0315%)
___Train Local_Simple,  epoch 110, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.3543, Accuracy: 9243/10000 (92.4300%)
___Train Local_Simple,  epoch 110, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 110, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0389, Accuracy: 9874/10000 (98.7400%)
poison local model 26 index 1
___Train Local_Simple,  epoch 110, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 110, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0774, Accuracy: 9756/10000 (97.5600%)
___Train Local_Simple,  epoch 110, local model 92, internal_epoch   1,  Average loss: 0.0008, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch 110, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 932/937 (99.4664%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.2523, Accuracy: 9176/10000 (91.7600%)
___Train Local_Simple,  epoch 110, local model 3, internal_epoch   1,  Average loss: 0.0004, Accuracy: 915/923 (99.1333%)
___Train Local_Simple,  epoch 110, local model 3, internal_epoch   2,  Average loss: 0.0001, Accuracy: 922/923 (99.8917%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1172, Accuracy: 9661/10000 (96.6100%)
poison local model 13 index 2
___Train Local_Simple,  epoch 110, local model 13, internal_epoch   1,  Average loss: 0.0006, Accuracy: 722/734 (98.3651%)
___Train Local_Simple,  epoch 110, local model 13, internal_epoch   2,  Average loss: 0.0004, Accuracy: 726/734 (98.9101%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.1333, Accuracy: 9584/10000 (95.8400%)
poison local model 16 index 3
___Train Local_Simple,  epoch 110, local model 16, internal_epoch   1,  Average loss: 0.0011, Accuracy: 902/915 (98.5792%)
___Train Local_Simple,  epoch 110, local model 16, internal_epoch   2,  Average loss: 0.0014, Accuracy: 885/915 (96.7213%)
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0872, Accuracy: 9717/10000 (97.1700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34, 26, 13, 16]
base_p: [ 0.00229429  0.000278    0.00278922 ... -0.00365251 -0.0044603
 -0.00139783]
[T_SCORE] attacker_local_idxs is:  [3, 5, 7, 8, 9]
layer1_inf_time: 3.989501953125
[PAIRWISE] pred_attackers_indx:  [3 5 8 9]
layer2_inf_t: 125.263916015625
assumed final_attacker_idxs:  [3 5 7 8 9]
final_attacker_idxs is: [3 5 7 8 9]
g_attacker_idxs: [34 26  3 13 16]
g_normal_idxs: [35 57 43 76 92]
filtered_attacker_idxs: [3, 5, 7, 8, 9]
final_attacker_idxs are: [3, 5, 7, 8, 9]
num_dps: [499, 343, 408, 413, 78, 554, 937, 923, 734, 915]
time spent on training: 78.78059077262878
Starting performing KrMLRFL...
Num data points: [499, 343, 408, 413, 78, 554, 937, 923, 734, 915]
Num selected data points: [499 343 408  78 937]
The chosen ones are users: [0, 1, 2, 4, 6], which are global users: [35, 57, 43, 76, 92]
epoch_acc: 98.35000000000001
___Test Local_Simple poisoned: False, epoch: 110: Average loss: 0.0537, Accuracy: 9835/10000 (98.3500%)
___Test Local_Simple poisoned: True, epoch: 110: Average loss: 11.8134, Accuracy: 37/8968 (0.4126%)
Done in 278.18774032592773 sec.
Server Epoch:111 choose agents : [53, 42, 38, 29, 92, 24, 85, 68, 45, 33].
___Train Local_Simple,  epoch 111, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 111, local model 53, internal_epoch   2,  Average loss: 0.0001, Accuracy: 738/739 (99.8647%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1360, Accuracy: 9575/10000 (95.7500%)
poison local model 42 index 0
___Train Local_Simple,  epoch 111, local model 42, internal_epoch   1,  Average loss: 0.0007, Accuracy: 232/236 (98.3051%)
___Train Local_Simple,  epoch 111, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0453, Accuracy: 9851/10000 (98.5100%)
___Train Local_Simple,  epoch 111, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 887/895 (99.1061%)
___Train Local_Simple,  epoch 111, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1924, Accuracy: 9429/10000 (94.2900%)
___Train Local_Simple,  epoch 111, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 997/1002 (99.5010%)
___Train Local_Simple,  epoch 111, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1000/1002 (99.8004%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1396, Accuracy: 9596/10000 (95.9600%)
___Train Local_Simple,  epoch 111, local model 92, internal_epoch   1,  Average loss: 0.0001, Accuracy: 936/937 (99.8933%)
___Train Local_Simple,  epoch 111, local model 92, internal_epoch   2,  Average loss: 0.0000, Accuracy: 937/937 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0800, Accuracy: 9751/10000 (97.5100%)
___Train Local_Simple,  epoch 111, local model 24, internal_epoch   1,  Average loss: 0.0006, Accuracy: 373/379 (98.4169%)
___Train Local_Simple,  epoch 111, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0955, Accuracy: 9691/10000 (96.9100%)
poison local model 85 index 1
___Train Local_Simple,  epoch 111, local model 85, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 111, local model 85, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0904, Accuracy: 9725/10000 (97.2500%)
___Train Local_Simple,  epoch 111, local model 68, internal_epoch   1,  Average loss: 0.0004, Accuracy: 489/494 (98.9879%)
___Train Local_Simple,  epoch 111, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1498, Accuracy: 9566/10000 (95.6600%)
poison local model 45 index 2
___Train Local_Simple,  epoch 111, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 618/628 (98.4076%)
___Train Local_Simple,  epoch 111, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.1618, Accuracy: 9508/10000 (95.0800%)
___Train Local_Simple,  epoch 111, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 612/623 (98.2343%)
___Train Local_Simple,  epoch 111, local model 33, internal_epoch   2,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 85, 45]
base_p: [ 0.00031608  0.00021536  0.00166684 ... -0.00194164 -0.0012093
  0.00162434]
[T_SCORE] attacker_local_idxs is:  [0, 1, 6, 8, 9]
layer1_inf_time: 3.687744140625
[PAIRWISE] pred_attackers_indx:  [0 2 3 4 5]
layer2_inf_t: 402.494873046875
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 8 9]
g_attacker_idxs: [53 42 38 29 92 24 85 45 33]
g_normal_idxs: [68]
filtered_attacker_idxs: [0, 1, 3, 4, 6, 8, 9]
final_attacker_idxs are: [0, 1, 3, 4, 6, 8, 9]
num_dps: [739, 236, 895, 1002, 937, 379, 431, 494, 628, 623]
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0698, Accuracy: 9775/10000 (97.7500%)
time spent on training: 56.71952152252197
Starting performing KrMLRFL...
Num data points: [739, 236, 895, 1002, 937, 379, 431, 494, 628, 623]
Num selected data points: [895 379 494]
The chosen ones are users: [2, 5, 7], which are global users: [38, 24, 68]
epoch_acc: 97.05
___Test Local_Simple poisoned: False, epoch: 111: Average loss: 0.0948, Accuracy: 9705/10000 (97.0500%)
___Test Local_Simple poisoned: True, epoch: 111: Average loss: 16.3255, Accuracy: 0/8968 (0.0000%)
Done in 231.4785933494568 sec.
Server Epoch:112 choose agents : [10, 49, 41, 67, 42, 86, 48, 92, 8, 21].
___Train Local_Simple,  epoch 112, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 890/892 (99.7758%)
___Train Local_Simple,  epoch 112, local model 10, internal_epoch   2,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1388, Accuracy: 9575/10000 (95.7500%)
___Train Local_Simple,  epoch 112, local model 49, internal_epoch   1,  Average loss: 0.0006, Accuracy: 500/506 (98.8142%)
___Train Local_Simple,  epoch 112, local model 49, internal_epoch   2,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1078, Accuracy: 9680/10000 (96.8000%)
___Train Local_Simple,  epoch 112, local model 41, internal_epoch   1,  Average loss: 0.0008, Accuracy: 597/606 (98.5149%)
___Train Local_Simple,  epoch 112, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.2560, Accuracy: 9294/10000 (92.9400%)
___Train Local_Simple,  epoch 112, local model 67, internal_epoch   1,  Average loss: 0.0005, Accuracy: 990/998 (99.1984%)
___Train Local_Simple,  epoch 112, local model 67, internal_epoch   2,  Average loss: 0.0001, Accuracy: 998/998 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1079, Accuracy: 9672/10000 (96.7200%)
poison local model 42 index 0
___Train Local_Simple,  epoch 112, local model 42, internal_epoch   1,  Average loss: 0.0019, Accuracy: 228/236 (96.6102%)
___Train Local_Simple,  epoch 112, local model 42, internal_epoch   2,  Average loss: 0.0003, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1571, Accuracy: 9519/10000 (95.1900%)
___Train Local_Simple,  epoch 112, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 249/250 (99.6000%)
___Train Local_Simple,  epoch 112, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.0866, Accuracy: 9711/10000 (97.1100%)
___Train Local_Simple,  epoch 112, local model 48, internal_epoch   1,  Average loss: 0.0011, Accuracy: 436/448 (97.3214%)
___Train Local_Simple,  epoch 112, local model 48, internal_epoch   2,  Average loss: 0.0010, Accuracy: 439/448 (97.9911%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.0954, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch 112, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 923/937 (98.5059%)
___Train Local_Simple,  epoch 112, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 934/937 (99.6798%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.4017, Accuracy: 8921/10000 (89.2100%)
___Train Local_Simple,  epoch 112, local model 8, internal_epoch   1,  Average loss: 0.0018, Accuracy: 605/633 (95.5766%)
___Train Local_Simple,  epoch 112, local model 8, internal_epoch   2,  Average loss: 0.0008, Accuracy: 627/633 (99.0521%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1323, Accuracy: 9623/10000 (96.2300%)
___Train Local_Simple,  epoch 112, local model 21, internal_epoch   1,  Average loss: 0.0011, Accuracy: 305/312 (97.7564%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42]
base_p: [ 0.00032111  0.00026272  0.00172394 ... -0.00336358  0.00025027
  0.0004284 ]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 7, 8]
layer1_inf_time: 4.389404296875
___Train Local_Simple,  epoch 112, local model 21, internal_epoch   2,  Average loss: 0.0002, Accuracy: 311/312 (99.6795%)
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.1704, Accuracy: 9468/10000 (94.6800%)
time spent on training: 40.47780704498291
[PAIRWISE] pred_attackers_indx:  [0 1 2 4 6]
layer2_inf_t: 189.110107421875
assumed final_attacker_idxs:  [0 1 2 3 4 6 7 8]
final_attacker_idxs is: [0 1 2 3 4 6 7 8]
g_attacker_idxs: [10 49 41 67 42 48 92  8]
g_normal_idxs: [86 21]
filtered_attacker_idxs: [1, 3, 4, 7]
final_attacker_idxs are: [1, 3, 4, 7]
num_dps: [892, 506, 606, 998, 236, 250, 448, 937, 633, 312]
epoch_acc: 98.57000000000001
Starting performing KrMLRFL...
Num data points: [892, 506, 606, 998, 236, 250, 448, 937, 633, 312]
Num selected data points: [892 606 250 448 633 312]
The chosen ones are users: [0, 2, 5, 6, 8, 9], which are global users: [10, 41, 86, 48, 8, 21]
___Test Local_Simple poisoned: False, epoch: 112: Average loss: 0.0475, Accuracy: 9857/10000 (98.5700%)
___Test Local_Simple poisoned: True, epoch: 112: Average loss: 13.2637, Accuracy: 37/8968 (0.4126%)
Done in 178.3732714653015 sec.
Server Epoch:113 choose agents : [52, 99, 38, 24, 20, 14, 86, 59, 36, 53].
poison local model 52 index 0
___Train Local_Simple,  epoch 113, local model 52, internal_epoch   1,  Average loss: 0.0011, Accuracy: 248/253 (98.0237%)
___Train Local_Simple,  epoch 113, local model 52, internal_epoch   2,  Average loss: 0.0006, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1086, Accuracy: 9664/10000 (96.6400%)
___Train Local_Simple,  epoch 113, local model 99, internal_epoch   1,  Average loss: 0.0005, Accuracy: 374/377 (99.2042%)
___Train Local_Simple,  epoch 113, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0828, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch 113, local model 38, internal_epoch   1,  Average loss: 0.0003, Accuracy: 887/895 (99.1061%)
___Train Local_Simple,  epoch 113, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1794, Accuracy: 9464/10000 (94.6400%)
___Train Local_Simple,  epoch 113, local model 24, internal_epoch   1,  Average loss: 0.0005, Accuracy: 375/379 (98.9446%)
___Train Local_Simple,  epoch 113, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0622, Accuracy: 9803/10000 (98.0300%)
poison local model 20 index 1
___Train Local_Simple,  epoch 113, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 113, local model 20, internal_epoch   2,  Average loss: 0.0006, Accuracy: 423/429 (98.6014%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.3493, Accuracy: 9128/10000 (91.2800%)
___Train Local_Simple,  epoch 113, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 372/376 (98.9362%)
___Train Local_Simple,  epoch 113, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0671, Accuracy: 9792/10000 (97.9200%)
___Train Local_Simple,  epoch 113, local model 86, internal_epoch   1,  Average loss: 0.0006, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 113, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 249/250 (99.6000%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0889, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch 113, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 743/760 (97.7632%)
___Train Local_Simple,  epoch 113, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1724, Accuracy: 9431/10000 (94.3100%)
___Train Local_Simple,  epoch 113, local model 36, internal_epoch   1,  Average loss: 0.0006, Accuracy: 991/1005 (98.6070%)
___Train Local_Simple,  epoch 113, local model 36, internal_epoch   2,  Average loss: 0.0006, Accuracy: 990/1005 (98.5075%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.1959, Accuracy: 9405/10000 (94.0500%)
___Train Local_Simple,  epoch 113, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 113, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.2493, Accuracy: 9267/10000 (92.6700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 20]
base_p: [ 4.3606013e-04  2.3240969e-04 -2.3040920e-06 ... -1.7745346e-03
 -3.9473176e-04 -7.2026998e-04]
[T_SCORE] attacker_local_idxs is:  [0, 4, 7, 8, 9]
layer1_inf_time: 4.123291015625
[PAIRWISE] pred_attackers_indx:  [4 7 8]
layer2_inf_t: 475.653076171875
assumed final_attacker_idxs:  [0 4 7 8 9]
final_attacker_idxs is: [0 4 7 8 9]
g_attacker_idxs: [52 20 59 36 53]
g_normal_idxs: [99 38 24 14 86]
filtered_attacker_idxs: [0, 4, 7, 8, 9]
final_attacker_idxs are: [0, 4, 7, 8, 9]
num_dps: [253, 377, 895, 379, 429, 376, 250, 760, 1005, 739]
time spent on training: 44.56291127204895
Starting performing KrMLRFL...
Num data points: [253, 377, 895, 379, 429, 376, 250, 760, 1005, 739]
Num selected data points: [377 895 379 376 250]
The chosen ones are users: [1, 2, 3, 5, 6], which are global users: [99, 38, 24, 14, 86]
epoch_acc: 98.6
___Test Local_Simple poisoned: False, epoch: 113: Average loss: 0.0432, Accuracy: 9860/10000 (98.6000%)
___Test Local_Simple poisoned: True, epoch: 113: Average loss: 15.0942, Accuracy: 12/8968 (0.1338%)
Done in 202.40142822265625 sec.
Server Epoch:114 choose agents : [88, 93, 50, 49, 14, 96, 72, 79, 38, 28].
___Train Local_Simple,  epoch 114, local model 88, internal_epoch   1,  Average loss: 0.0009, Accuracy: 518/530 (97.7358%)
___Train Local_Simple,  epoch 114, local model 88, internal_epoch   2,  Average loss: 0.0002, Accuracy: 528/530 (99.6226%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.2717, Accuracy: 9269/10000 (92.6900%)
poison local model 93 index 0
___Train Local_Simple,  epoch 114, local model 93, internal_epoch   1,  Average loss: 0.0003, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 114, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.1533, Accuracy: 9532/10000 (95.3200%)
___Train Local_Simple,  epoch 114, local model 50, internal_epoch   1,  Average loss: 0.0006, Accuracy: 470/474 (99.1561%)
___Train Local_Simple,  epoch 114, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.1499, Accuracy: 9525/10000 (95.2500%)
___Train Local_Simple,  epoch 114, local model 49, internal_epoch   1,  Average loss: 0.0004, Accuracy: 503/506 (99.4071%)
___Train Local_Simple,  epoch 114, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0833, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 114, local model 14, internal_epoch   1,  Average loss: 0.0006, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch 114, local model 14, internal_epoch   2,  Average loss: 0.0003, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.1593, Accuracy: 9579/10000 (95.7900%)
___Train Local_Simple,  epoch 114, local model 96, internal_epoch   1,  Average loss: 0.0008, Accuracy: 660/672 (98.2143%)
___Train Local_Simple,  epoch 114, local model 96, internal_epoch   2,  Average loss: 0.0003, Accuracy: 668/672 (99.4048%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.1556, Accuracy: 9513/10000 (95.1300%)
___Train Local_Simple,  epoch 114, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 114, local model 72, internal_epoch   2,  Average loss: 0.0002, Accuracy: 729/731 (99.7264%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0685, Accuracy: 9773/10000 (97.7300%)
___Train Local_Simple,  epoch 114, local model 79, internal_epoch   1,  Average loss: 0.0009, Accuracy: 178/182 (97.8022%)
___Train Local_Simple,  epoch 114, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0635, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 114, local model 38, internal_epoch   1,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Train Local_Simple,  epoch 114, local model 38, internal_epoch   2,  Average loss: 0.0000, Accuracy: 895/895 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0534, Accuracy: 9820/10000 (98.2000%)
___Train Local_Simple,  epoch 114, local model 28, internal_epoch   1,  Average loss: 0.0004, Accuracy: 497/501 (99.2016%)
___Train Local_Simple,  epoch 114, local model 28, internal_epoch   2,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [93]
base_p: [ 0.00119451  0.00026697  0.00079108 ... -0.00073034  0.00055835
  0.00052761]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 8]
layer1_inf_time: 4.495849609375
[PAIRWISE] pred_attackers_indx:  [0 1 3 4 7 9]
layer2_inf_t: 127.04443359375
assumed final_attacker_idxs:  [0 1 3 4 5 7 8 9]
final_attacker_idxs is: [0 1 3 4 5 7 8 9]
g_attacker_idxs: [88 93 49 14 96 79 38 28]
g_normal_idxs: [50 72]
filtered_attacker_idxs: [0, 1, 3, 5]
final_attacker_idxs are: [0, 1, 3, 5]
num_dps: [530, 623, 474, 506, 376, 672, 731, 182, 895, 501]
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0647, Accuracy: 9803/10000 (98.0300%)
time spent on training: 42.57591438293457
Starting performing KrMLRFL...
Num data points: [530, 623, 474, 506, 376, 672, 731, 182, 895, 501]
Num selected data points: [474 376 731 182 895 501]
The chosen ones are users: [2, 4, 6, 7, 8, 9], which are global users: [50, 14, 72, 79, 38, 28]
epoch_acc: 98.96000000000001
___Test Local_Simple poisoned: False, epoch: 114: Average loss: 0.0332, Accuracy: 9896/10000 (98.9600%)
___Test Local_Simple poisoned: True, epoch: 114: Average loss: 14.5243, Accuracy: 12/8968 (0.1338%)
Done in 195.87658977508545 sec.
Server Epoch:115 choose agents : [72, 59, 80, 22, 31, 62, 54, 58, 24, 42].
___Train Local_Simple,  epoch 115, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 115, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.1120, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 115, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch 115, local model 59, internal_epoch   2,  Average loss: 0.0005, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.1993, Accuracy: 9345/10000 (93.4500%)
___Train Local_Simple,  epoch 115, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 115, local model 80, internal_epoch   2,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0634, Accuracy: 9827/10000 (98.2700%)
poison local model 22 index 0
___Train Local_Simple,  epoch 115, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 573/583 (98.2847%)
___Train Local_Simple,  epoch 115, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0753, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch 115, local model 31, internal_epoch   1,  Average loss: 0.0002, Accuracy: 833/835 (99.7605%)
___Train Local_Simple,  epoch 115, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 833/835 (99.7605%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0764, Accuracy: 9767/10000 (97.6700%)
___Train Local_Simple,  epoch 115, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 115, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0942, Accuracy: 9693/10000 (96.9300%)
___Train Local_Simple,  epoch 115, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch 115, local model 54, internal_epoch   2,  Average loss: 0.0008, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.3190, Accuracy: 9185/10000 (91.8500%)
___Train Local_Simple,  epoch 115, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 271/276 (98.1884%)
___Train Local_Simple,  epoch 115, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0644, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 115, local model 24, internal_epoch   1,  Average loss: 0.0003, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 115, local model 24, internal_epoch   2,  Average loss: 0.0001, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0728, Accuracy: 9793/10000 (97.9300%)
poison local model 42 index 1
___Train Local_Simple,  epoch 115, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch 115, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0384, Accuracy: 9873/10000 (98.7300%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 42]
base_p: [0.00058562 0.00021803 0.00050477 ... 0.00023191 0.00277466 0.00038093]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 6, 9]
layer1_inf_time: 3.71826171875
[PAIRWISE] pred_attackers_indx:  [1 2 3 4 6]
layer2_inf_t: 142.54541015625
assumed final_attacker_idxs:  [1 2 3 4 6 9]
final_attacker_idxs is: [1 2 3 4 6 9]
g_attacker_idxs: [59 80 22 31 54 42]
g_normal_idxs: [72 62 58 24]
filtered_attacker_idxs: [1, 3, 4, 9]
final_attacker_idxs are: [1, 3, 4, 9]
num_dps: [731, 760, 431, 583, 835, 423, 519, 276, 379, 236]
time spent on training: 45.18696069717407
Starting performing KrMLRFL...
Num data points: [731, 760, 431, 583, 835, 423, 519, 276, 379, 236]
Num selected data points: [731 431 423 519 276 379]
The chosen ones are users: [0, 2, 5, 6, 7, 8], which are global users: [72, 80, 62, 54, 58, 24]
___Test Local_Simple poisoned: False, epoch: 115: Average loss: 0.0350, Accuracy: 9891/10000 (98.9100%)
epoch_acc: 98.91
___Test Local_Simple poisoned: True, epoch: 115: Average loss: 14.2420, Accuracy: 17/8968 (0.1896%)
Done in 181.07233810424805 sec.
Server Epoch:116 choose agents : [76, 96, 97, 23, 75, 77, 27, 3, 46, 82].
___Train Local_Simple,  epoch 116, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 116, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0334, Accuracy: 9892/10000 (98.9200%)
___Train Local_Simple,  epoch 116, local model 96, internal_epoch   1,  Average loss: 0.0007, Accuracy: 661/672 (98.3631%)
___Train Local_Simple,  epoch 116, local model 96, internal_epoch   2,  Average loss: 0.0005, Accuracy: 665/672 (98.9583%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.1108, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch 116, local model 97, internal_epoch   1,  Average loss: 0.0002, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 116, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0898, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch 116, local model 23, internal_epoch   1,  Average loss: 0.0005, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 116, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0784, Accuracy: 9723/10000 (97.2300%)
___Train Local_Simple,  epoch 116, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 680/686 (99.1254%)
___Train Local_Simple,  epoch 116, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0504, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 116, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch 116, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 584/589 (99.1511%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0487, Accuracy: 9849/10000 (98.4900%)
poison local model 27 index 0
___Train Local_Simple,  epoch 116, local model 27, internal_epoch   1,  Average loss: 0.0007, Accuracy: 464/471 (98.5138%)
___Train Local_Simple,  epoch 116, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 468/471 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.4445, Accuracy: 9196/10000 (91.9600%)
___Train Local_Simple,  epoch 116, local model 3, internal_epoch   1,  Average loss: 0.0006, Accuracy: 907/923 (98.2665%)
___Train Local_Simple,  epoch 116, local model 3, internal_epoch   2,  Average loss: 0.0002, Accuracy: 921/923 (99.7833%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0730, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch 116, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 701/710 (98.7324%)
___Train Local_Simple,  epoch 116, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 707/710 (99.5775%)
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.1109, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch 116, local model 82, internal_epoch   1,  Average loss: 0.0001, Accuracy: 712/713 (99.8597%)
___Train Local_Simple,  epoch 116, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27]
base_p: [-7.3127449e-05  2.7771667e-04  8.1736594e-05 ...  3.3155531e-03
  7.5695664e-04  6.3013285e-04]
[T_SCORE] attacker_local_idxs is:  [1, 5, 6, 7, 8]
layer1_inf_time: 3.68701171875
[PAIRWISE] pred_attackers_indx:  [1 7 8]
layer2_inf_t: 46.6611328125
assumed final_attacker_idxs:  [1 5 6 7 8]
final_attacker_idxs is: [1 5 6 7 8]
g_attacker_idxs: [96 77 27  3 46]
g_normal_idxs: [76 97 23 75 82]
filtered_attacker_idxs: [1, 5, 6, 7, 8]
final_attacker_idxs are: [1, 5, 6, 7, 8]
num_dps: [78, 672, 487, 293, 686, 589, 471, 923, 710, 713]
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0832, Accuracy: 9734/10000 (97.3400%)
time spent on training: 48.18092155456543
Starting performing KrMLRFL...
Num data points: [78, 672, 487, 293, 686, 589, 471, 923, 710, 713]
Num selected data points: [ 78 487 293 686 713]
The chosen ones are users: [0, 2, 3, 4, 9], which are global users: [76, 97, 23, 75, 82]
epoch_acc: 98.71
___Test Local_Simple poisoned: False, epoch: 116: Average loss: 0.0398, Accuracy: 9871/10000 (98.7100%)
___Test Local_Simple poisoned: True, epoch: 116: Average loss: 15.1642, Accuracy: 6/8968 (0.0669%)
Done in 234.6768867969513 sec.
Server Epoch:117 choose agents : [26, 45, 67, 43, 13, 71, 84, 76, 25, 94].
poison local model 26 index 0
___Train Local_Simple,  epoch 117, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 117, local model 26, internal_epoch   2,  Average loss: 0.0004, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0536, Accuracy: 9839/10000 (98.3900%)
poison local model 45 index 1
___Train Local_Simple,  epoch 117, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 117, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.2004, Accuracy: 9346/10000 (93.4600%)
___Train Local_Simple,  epoch 117, local model 67, internal_epoch   1,  Average loss: 0.0004, Accuracy: 989/998 (99.0982%)
___Train Local_Simple,  epoch 117, local model 67, internal_epoch   2,  Average loss: 0.0002, Accuracy: 994/998 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.1111, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch 117, local model 43, internal_epoch   1,  Average loss: 0.0005, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 117, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0808, Accuracy: 9753/10000 (97.5300%)
poison local model 13 index 2
___Train Local_Simple,  epoch 117, local model 13, internal_epoch   1,  Average loss: 0.0004, Accuracy: 728/734 (99.1826%)
___Train Local_Simple,  epoch 117, local model 13, internal_epoch   2,  Average loss: 0.0001, Accuracy: 732/734 (99.7275%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0971, Accuracy: 9706/10000 (97.0600%)
poison local model 71 index 3
___Train Local_Simple,  epoch 117, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1372/1384 (99.1329%)
___Train Local_Simple,  epoch 117, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1375/1384 (99.3497%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.2983, Accuracy: 9089/10000 (90.8900%)
___Train Local_Simple,  epoch 117, local model 84, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1231/1246 (98.7961%)
___Train Local_Simple,  epoch 117, local model 84, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1233/1246 (98.9567%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0889, Accuracy: 9723/10000 (97.2300%)
___Train Local_Simple,  epoch 117, local model 76, internal_epoch   1,  Average loss: 0.0003, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 117, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0333, Accuracy: 9892/10000 (98.9200%)
___Train Local_Simple,  epoch 117, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 644/647 (99.5363%)
___Train Local_Simple,  epoch 117, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0931, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch 117, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 117, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0778, Accuracy: 9754/10000 (97.5400%)
time spent on training: 64.6585304737091
Starting performing KrMLRFL...
Num data points: [554, 628, 998, 408, 734, 1384, 1246, 78, 647, 150]
Num selected data points: [998 408  78 647 150]
The chosen ones are users: [2, 3, 7, 8, 9], which are global users: [67, 43, 76, 25, 94]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 45, 13, 71]
base_p: [-0.00093842  0.00031828  0.00207069 ...  0.00243998 -0.004237
 -0.00122561]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 6]
layer1_inf_time: 2.78515625
[PAIRWISE] pred_attackers_indx:  [0 1 4 5 6]
layer2_inf_t: 29.931884765625
assumed final_attacker_idxs:  [0 1 4 5 6]
final_attacker_idxs is: [0 1 4 5 6]
g_attacker_idxs: [26 45 13 71 84]
g_normal_idxs: [67 43 76 25 94]
filtered_attacker_idxs: [0, 1, 4, 5, 6]
final_attacker_idxs are: [0, 1, 4, 5, 6]
num_dps: [554, 628, 998, 408, 734, 1384, 1246, 78, 647, 150]
epoch_acc: 98.49
___Test Local_Simple poisoned: False, epoch: 117: Average loss: 0.0472, Accuracy: 9849/10000 (98.4900%)
___Test Local_Simple poisoned: True, epoch: 117: Average loss: 13.9008, Accuracy: 32/8968 (0.3568%)
Done in 278.7972946166992 sec.
Server Epoch:118 choose agents : [22, 34, 40, 46, 26, 19, 80, 62, 14, 24].
poison local model 22 index 0
___Train Local_Simple,  epoch 118, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 575/583 (98.6278%)
___Train Local_Simple,  epoch 118, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 582/583 (99.8285%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0921, Accuracy: 9720/10000 (97.2000%)
poison local model 34 index 1
___Train Local_Simple,  epoch 118, local model 34, internal_epoch   1,  Average loss: 0.0004, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 118, local model 34, internal_epoch   2,  Average loss: 0.0003, Accuracy: 410/413 (99.2736%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.1015, Accuracy: 9708/10000 (97.0800%)
___Train Local_Simple,  epoch 118, local model 40, internal_epoch   1,  Average loss: 0.0005, Accuracy: 765/772 (99.0933%)
___Train Local_Simple,  epoch 118, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 771/772 (99.8705%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0976, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch 118, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 698/710 (98.3099%)
___Train Local_Simple,  epoch 118, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 702/710 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.1498, Accuracy: 9521/10000 (95.2100%)
poison local model 26 index 2
___Train Local_Simple,  epoch 118, local model 26, internal_epoch   1,  Average loss: 0.0007, Accuracy: 547/554 (98.7365%)
___Train Local_Simple,  epoch 118, local model 26, internal_epoch   2,  Average loss: 0.0006, Accuracy: 546/554 (98.5560%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.1092, Accuracy: 9622/10000 (96.2200%)
___Train Local_Simple,  epoch 118, local model 19, internal_epoch   1,  Average loss: 0.0009, Accuracy: 200/205 (97.5610%)
___Train Local_Simple,  epoch 118, local model 19, internal_epoch   2,  Average loss: 0.0004, Accuracy: 204/205 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.3586, Accuracy: 9139/10000 (91.3900%)
___Train Local_Simple,  epoch 118, local model 80, internal_epoch   1,  Average loss: 0.0004, Accuracy: 427/431 (99.0719%)
___Train Local_Simple,  epoch 118, local model 80, internal_epoch   2,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0910, Accuracy: 9733/10000 (97.3300%)
___Train Local_Simple,  epoch 118, local model 62, internal_epoch   1,  Average loss: 0.0006, Accuracy: 420/423 (99.2908%)
___Train Local_Simple,  epoch 118, local model 62, internal_epoch   2,  Average loss: 0.0002, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0919, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch 118, local model 14, internal_epoch   1,  Average loss: 0.0002, Accuracy: 375/376 (99.7340%)
___Train Local_Simple,  epoch 118, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 375/376 (99.7340%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0437, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 118, local model 24, internal_epoch   1,  Average loss: 0.0004, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 118, local model 24, internal_epoch   2,  Average loss: 0.0003, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0544, Accuracy: 9819/10000 (98.1900%)
time spent on training: 52.49378156661987
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 34, 26]
base_p: [ 6.8589300e-04  1.6729906e-04  4.5672059e-05 ... -1.8476695e-03
 -6.7139193e-03  5.8989972e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 3, 4]
layer1_inf_time: 3.264404296875
[PAIRWISE] pred_attackers_indx:  [0 1 2 4 5 6]
layer2_inf_t: 293.7216796875
assumed final_attacker_idxs:  [0 1 2 3 4 5 6]
final_attacker_idxs is: [0 1 2 3 4 5 6]
g_attacker_idxs: [22 34 40 46 26 19 80]
g_normal_idxs: [62 14 24]
filtered_attacker_idxs: [0, 1, 2, 3, 4]
final_attacker_idxs are: [0, 1, 2, 3, 4]
num_dps: [583, 413, 772, 710, 554, 205, 431, 423, 376, 379]
Num data points: [583, 413, 772, 710, 554, 205, 431, 423, 376, 379]
Num selected data points: [205 431 423 376 379]
The chosen ones are users: [5, 6, 7, 8, 9], which are global users: [19, 80, 62, 14, 24]
___Test Local_Simple poisoned: False, epoch: 118: Average loss: 0.0350, Accuracy: 9889/10000 (98.8900%)
epoch_acc: 98.89
___Test Local_Simple poisoned: True, epoch: 118: Average loss: 13.5350, Accuracy: 23/8968 (0.2565%)
Done in 214.4740514755249 sec.
Server Epoch:119 choose agents : [26, 9, 89, 40, 45, 94, 67, 51, 1, 44].
poison local model 26 index 0
___Train Local_Simple,  epoch 119, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 119, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0719, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch 119, local model 9, internal_epoch   1,  Average loss: 0.0004, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 119, local model 9, internal_epoch   2,  Average loss: 0.0004, Accuracy: 433/436 (99.3119%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0625, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 119, local model 89, internal_epoch   1,  Average loss: 0.0002, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch 119, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.1378, Accuracy: 9578/10000 (95.7800%)
___Train Local_Simple,  epoch 119, local model 40, internal_epoch   1,  Average loss: 0.0002, Accuracy: 770/772 (99.7409%)
___Train Local_Simple,  epoch 119, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 772/772 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0483, Accuracy: 9855/10000 (98.5500%)
poison local model 45 index 1
___Train Local_Simple,  epoch 119, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 618/628 (98.4076%)
___Train Local_Simple,  epoch 119, local model 45, internal_epoch   2,  Average loss: 0.0002, Accuracy: 625/628 (99.5223%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.1378, Accuracy: 9545/10000 (95.4500%)
___Train Local_Simple,  epoch 119, local model 94, internal_epoch   1,  Average loss: 0.0007, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 119, local model 94, internal_epoch   2,  Average loss: 0.0002, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0907, Accuracy: 9687/10000 (96.8700%)
___Train Local_Simple,  epoch 119, local model 67, internal_epoch   1,  Average loss: 0.0000, Accuracy: 998/998 (100.0000%)
___Train Local_Simple,  epoch 119, local model 67, internal_epoch   2,  Average loss: 0.0000, Accuracy: 998/998 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0484, Accuracy: 9845/10000 (98.4500%)
poison local model 51 index 2
___Train Local_Simple,  epoch 119, local model 51, internal_epoch   1,  Average loss: 0.0005, Accuracy: 561/568 (98.7676%)
___Train Local_Simple,  epoch 119, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.1458, Accuracy: 9585/10000 (95.8500%)
poison local model 1 index 3
___Train Local_Simple,  epoch 119, local model 1, internal_epoch   1,  Average loss: 0.0006, Accuracy: 753/760 (99.0789%)
___Train Local_Simple,  epoch 119, local model 1, internal_epoch   2,  Average loss: 0.0003, Accuracy: 755/760 (99.3421%)
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.2167, Accuracy: 9298/10000 (92.9800%)
___Train Local_Simple,  epoch 119, local model 44, internal_epoch   1,  Average loss: 0.0006, Accuracy: 511/517 (98.8395%)
___Train Local_Simple,  epoch 119, local model 44, internal_epoch   2,  Average loss: 0.0005, Accuracy: 511/517 (98.8395%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 45, 51, 1]
base_p: [ 0.00070951  0.00024679  0.00091847 ...  0.00296348 -0.00047089
  0.00137585]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 7, 8]
layer1_inf_time: 3.107177734375
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 123.361572265625
assumed final_attacker_idxs:  [0 2 4 7 8]
final_attacker_idxs is: [0 2 4 7 8]
g_attacker_idxs: [26 89 45 51  1]
g_normal_idxs: [ 9 40 94 67 44]
filtered_attacker_idxs: [0, 2, 4, 7, 8]
final_attacker_idxs are: [0, 2, 4, 7, 8]
num_dps: [554, 436, 492, 772, 628, 150, 998, 568, 760, 517]
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0634, Accuracy: 9793/10000 (97.9300%)
time spent on training: 76.98989129066467
Starting performing KrMLRFL...
Num data points: [554, 436, 492, 772, 628, 150, 998, 568, 760, 517]
Num selected data points: [436 772 150 998 517]
The chosen ones are users: [1, 3, 5, 6, 9], which are global users: [9, 40, 94, 67, 44]
epoch_acc: 98.95
___Test Local_Simple poisoned: False, epoch: 119: Average loss: 0.0331, Accuracy: 9895/10000 (98.9500%)
___Test Local_Simple poisoned: True, epoch: 119: Average loss: 14.1681, Accuracy: 18/8968 (0.2007%)
Done in 241.80798482894897 sec.
Server Epoch:120 choose agents : [83, 45, 42, 87, 19, 2, 72, 4, 7, 52].
___Train Local_Simple,  epoch 120, local model 83, internal_epoch   1,  Average loss: 0.0003, Accuracy: 430/433 (99.3072%)
___Train Local_Simple,  epoch 120, local model 83, internal_epoch   2,  Average loss: 0.0005, Accuracy: 429/433 (99.0762%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0412, Accuracy: 9865/10000 (98.6500%)
poison local model 45 index 0
___Train Local_Simple,  epoch 120, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 120, local model 45, internal_epoch   2,  Average loss: 0.0007, Accuracy: 619/628 (98.5669%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.1269, Accuracy: 9638/10000 (96.3800%)
poison local model 42 index 1
___Train Local_Simple,  epoch 120, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 120, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0350, Accuracy: 9893/10000 (98.9300%)
___Train Local_Simple,  epoch 120, local model 87, internal_epoch   1,  Average loss: 0.0003, Accuracy: 468/470 (99.5745%)
___Train Local_Simple,  epoch 120, local model 87, internal_epoch   2,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0752, Accuracy: 9766/10000 (97.6600%)
___Train Local_Simple,  epoch 120, local model 19, internal_epoch   1,  Average loss: 0.0005, Accuracy: 201/205 (98.0488%)
___Train Local_Simple,  epoch 120, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0821, Accuracy: 9744/10000 (97.4400%)
poison local model 2 index 2
___Train Local_Simple,  epoch 120, local model 2, internal_epoch   1,  Average loss: 0.0010, Accuracy: 539/548 (98.3577%)
___Train Local_Simple,  epoch 120, local model 2, internal_epoch   2,  Average loss: 0.0008, Accuracy: 541/548 (98.7226%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0722, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch 120, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Train Local_Simple,  epoch 120, local model 72, internal_epoch   2,  Average loss: 0.0001, Accuracy: 730/731 (99.8632%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0528, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch 120, local model 4, internal_epoch   1,  Average loss: 0.0003, Accuracy: 654/658 (99.3921%)
___Train Local_Simple,  epoch 120, local model 4, internal_epoch   2,  Average loss: 0.0008, Accuracy: 648/658 (98.4802%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.1698, Accuracy: 9474/10000 (94.7400%)
poison local model 7 index 3
___Train Local_Simple,  epoch 120, local model 7, internal_epoch   1,  Average loss: 0.0005, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 120, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.1363, Accuracy: 9550/10000 (95.5000%)
poison local model 52 index 0
___Train Local_Simple,  epoch 120, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 249/253 (98.4190%)
___Train Local_Simple,  epoch 120, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0957, Accuracy: 9731/10000 (97.3100%)
time spent on training: 56.50895595550537
Starting performing KrMLRFL...
Num data points: [433, 628, 236, 470, 205, 548, 731, 658, 418, 253]
Num selected data points: [433 470 205 731]
The chosen ones are users: [0, 3, 4, 6], which are global users: [83, 87, 19, 72]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 42, 2, 7, 52]
base_p: [ 6.1132014e-05  1.7779320e-04  1.4580134e-04 ...  9.1747940e-04
 -9.9204481e-05  8.2015991e-04]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 8, 9]
layer1_inf_time: 2.317626953125
[PAIRWISE] pred_attackers_indx:  [1 6 7 9]
layer2_inf_t: 26.187744140625
assumed final_attacker_idxs:  [1 2 5 6 7 8 9]
final_attacker_idxs is: [1 2 5 6 7 8 9]
g_attacker_idxs: [45 42  2 72  4  7 52]
g_normal_idxs: [83 87 19]
filtered_attacker_idxs: [1, 2, 5, 7, 8, 9]
final_attacker_idxs are: [1, 2, 5, 7, 8, 9]
num_dps: [433, 628, 236, 470, 205, 548, 731, 658, 418, 253]
epoch_acc: 98.96000000000001
___Test Local_Simple poisoned: False, epoch: 120: Average loss: 0.0330, Accuracy: 9896/10000 (98.9600%)
___Test Local_Simple poisoned: True, epoch: 120: Average loss: 13.4904, Accuracy: 26/8968 (0.2899%)
Done in 177.67754340171814 sec.
Server Epoch:121 choose agents : [91, 95, 30, 2, 92, 86, 78, 48, 18, 28].
poison local model 91 index 0
___Train Local_Simple,  epoch 121, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 121, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0407, Accuracy: 9878/10000 (98.7800%)
___Train Local_Simple,  epoch 121, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Train Local_Simple,  epoch 121, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.1802, Accuracy: 9394/10000 (93.9400%)
___Train Local_Simple,  epoch 121, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/400 (99.7500%)
___Train Local_Simple,  epoch 121, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0855, Accuracy: 9742/10000 (97.4200%)
poison local model 2 index 1
___Train Local_Simple,  epoch 121, local model 2, internal_epoch   1,  Average loss: 0.0007, Accuracy: 539/548 (98.3577%)
___Train Local_Simple,  epoch 121, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0896, Accuracy: 9741/10000 (97.4100%)
___Train Local_Simple,  epoch 121, local model 92, internal_epoch   1,  Average loss: 0.0003, Accuracy: 931/937 (99.3597%)
___Train Local_Simple,  epoch 121, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 934/937 (99.6798%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.1405, Accuracy: 9546/10000 (95.4600%)
___Train Local_Simple,  epoch 121, local model 86, internal_epoch   1,  Average loss: 0.0003, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 121, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0639, Accuracy: 9807/10000 (98.0700%)
___Train Local_Simple,  epoch 121, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 302/303 (99.6700%)
___Train Local_Simple,  epoch 121, local model 78, internal_epoch   2,  Average loss: 0.0003, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0765, Accuracy: 9767/10000 (97.6700%)
___Train Local_Simple,  epoch 121, local model 48, internal_epoch   1,  Average loss: 0.0003, Accuracy: 443/448 (98.8839%)
___Train Local_Simple,  epoch 121, local model 48, internal_epoch   2,  Average loss: 0.0004, Accuracy: 444/448 (99.1071%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0653, Accuracy: 9789/10000 (97.8900%)
___Train Local_Simple,  epoch 121, local model 18, internal_epoch   1,  Average loss: 0.0009, Accuracy: 451/459 (98.2571%)
___Train Local_Simple,  epoch 121, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 459/459 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.3056, Accuracy: 9300/10000 (93.0000%)
___Train Local_Simple,  epoch 121, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 121, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0383, Accuracy: 9885/10000 (98.8500%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 2]
base_p: [ 0.00053518  0.00018689  0.00052459 ... -0.00018314 -0.00497796
 -0.0002249 ]
[T_SCORE] attacker_local_idxs is:  [0, 1, 3, 4, 8]
layer1_inf_time: 3.838623046875
[PAIRWISE] pred_attackers_indx:  [3 6 8]
layer2_inf_t: 32.786376953125
assumed final_attacker_idxs:  [0 1 3 4 6 8]
final_attacker_idxs is: [0 1 3 4 6 8]
g_attacker_idxs: [91 95  2 92 78 18]
g_normal_idxs: [30 86 48 28]
filtered_attacker_idxs: [0, 1, 3, 4, 8]
final_attacker_idxs are: [0, 1, 3, 4, 8]
num_dps: [256, 602, 400, 548, 937, 250, 303, 448, 459, 501]
time spent on training: 45.64028239250183
Starting performing KrMLRFL...
Num data points: [256, 602, 400, 548, 937, 250, 303, 448, 459, 501]
Num selected data points: [400 250 303 448 501]
The chosen ones are users: [2, 5, 6, 7, 9], which are global users: [30, 86, 78, 48, 28]
___Test Local_Simple poisoned: False, epoch: 121: Average loss: 0.0382, Accuracy: 9886/10000 (98.8600%)
epoch_acc: 98.86
___Test Local_Simple poisoned: True, epoch: 121: Average loss: 14.2194, Accuracy: 17/8968 (0.1896%)
Done in 160.77587270736694 sec.
Server Epoch:122 choose agents : [68, 70, 48, 49, 61, 85, 9, 91, 86, 57].
___Train Local_Simple,  epoch 122, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 122, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0699, Accuracy: 9779/10000 (97.7900%)
poison local model 70 index 0
___Train Local_Simple,  epoch 122, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 713/724 (98.4807%)
___Train Local_Simple,  epoch 122, local model 70, internal_epoch   2,  Average loss: 0.0008, Accuracy: 714/724 (98.6188%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.6145, Accuracy: 8929/10000 (89.2900%)
___Train Local_Simple,  epoch 122, local model 48, internal_epoch   1,  Average loss: 0.0001, Accuracy: 448/448 (100.0000%)
___Train Local_Simple,  epoch 122, local model 48, internal_epoch   2,  Average loss: 0.0002, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0496, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 122, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 505/506 (99.8024%)
___Train Local_Simple,  epoch 122, local model 49, internal_epoch   2,  Average loss: 0.0000, Accuracy: 506/506 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0539, Accuracy: 9831/10000 (98.3100%)
poison local model 61 index 1
___Train Local_Simple,  epoch 122, local model 61, internal_epoch   1,  Average loss: 0.0010, Accuracy: 684/699 (97.8541%)
___Train Local_Simple,  epoch 122, local model 61, internal_epoch   2,  Average loss: 0.0002, Accuracy: 696/699 (99.5708%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.1888, Accuracy: 9373/10000 (93.7300%)
poison local model 85 index 2
___Train Local_Simple,  epoch 122, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 122, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0431, Accuracy: 9867/10000 (98.6700%)
___Train Local_Simple,  epoch 122, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 434/436 (99.5413%)
___Train Local_Simple,  epoch 122, local model 9, internal_epoch   2,  Average loss: 0.0002, Accuracy: 434/436 (99.5413%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0573, Accuracy: 9812/10000 (98.1200%)
poison local model 91 index 3
___Train Local_Simple,  epoch 122, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 122, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0541, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 122, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 249/250 (99.6000%)
___Train Local_Simple,  epoch 122, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0552, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 122, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 340/343 (99.1254%)
___Train Local_Simple,  epoch 122, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 342/343 (99.7085%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [70, 61, 85, 91]
base_p: [ 0.00040772  0.00017323 -0.00013748 ... -0.00138879  0.00436925
 -0.0004089 ]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 7, 9]
layer1_inf_time: 4.99853515625
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.1378, Accuracy: 9588/10000 (95.8800%)
time spent on training: 58.02808141708374
Starting performing KrMLRFL...
Num data points: [494, 724, 448, 506, 699, 431, 436, 256, 250, 343]
Num selected data points: [494 448 506 436 250 343]
The chosen ones are users: [0, 2, 3, 6, 8, 9], which are global users: [68, 48, 49, 9, 86, 57]
[PAIRWISE] pred_attackers_indx:  [1 4]
layer2_inf_t: 149.029296875
assumed final_attacker_idxs:  [1 4 5 7 9]
final_attacker_idxs is: [1 4 5 7 9]
g_attacker_idxs: [70 61 85 91 57]
g_normal_idxs: [68 48 49  9 86]
filtered_attacker_idxs: [1, 4, 5, 7]
final_attacker_idxs are: [1, 4, 5, 7]
num_dps: [494, 724, 448, 506, 699, 431, 436, 256, 250, 343]
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: False, epoch: 122: Average loss: 0.0346, Accuracy: 9893/10000 (98.9300%)
___Test Local_Simple poisoned: True, epoch: 122: Average loss: 14.6497, Accuracy: 16/8968 (0.1784%)
Done in 208.18855214118958 sec.
Server Epoch:123 choose agents : [15, 30, 86, 55, 11, 69, 59, 60, 95, 29].
___Train Local_Simple,  epoch 123, local model 15, internal_epoch   1,  Average loss: 0.0005, Accuracy: 397/401 (99.0025%)
___Train Local_Simple,  epoch 123, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0867, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch 123, local model 30, internal_epoch   1,  Average loss: 0.0001, Accuracy: 400/400 (100.0000%)
___Train Local_Simple,  epoch 123, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0663, Accuracy: 9806/10000 (98.0600%)
___Train Local_Simple,  epoch 123, local model 86, internal_epoch   1,  Average loss: 0.0002, Accuracy: 249/250 (99.6000%)
___Train Local_Simple,  epoch 123, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0529, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 123, local model 55, internal_epoch   1,  Average loss: 0.0007, Accuracy: 348/354 (98.3051%)
___Train Local_Simple,  epoch 123, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.3823, Accuracy: 8890/10000 (88.9000%)
poison local model 11 index 0
___Train Local_Simple,  epoch 123, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 638/645 (98.9147%)
___Train Local_Simple,  epoch 123, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 640/645 (99.2248%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.1932, Accuracy: 9482/10000 (94.8200%)
___Train Local_Simple,  epoch 123, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 123, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.1348, Accuracy: 9540/10000 (95.4000%)
___Train Local_Simple,  epoch 123, local model 59, internal_epoch   1,  Average loss: 0.0010, Accuracy: 752/760 (98.9474%)
___Train Local_Simple,  epoch 123, local model 59, internal_epoch   2,  Average loss: 0.0008, Accuracy: 747/760 (98.2895%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.1566, Accuracy: 9479/10000 (94.7900%)
___Train Local_Simple,  epoch 123, local model 60, internal_epoch   1,  Average loss: 0.0005, Accuracy: 334/338 (98.8166%)
___Train Local_Simple,  epoch 123, local model 60, internal_epoch   2,  Average loss: 0.0001, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0759, Accuracy: 9763/10000 (97.6300%)
___Train Local_Simple,  epoch 123, local model 95, internal_epoch   1,  Average loss: 0.0001, Accuracy: 601/602 (99.8339%)
___Train Local_Simple,  epoch 123, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 601/602 (99.8339%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0749, Accuracy: 9784/10000 (97.8400%)
___Train Local_Simple,  epoch 123, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 998/1002 (99.6008%)
___Train Local_Simple,  epoch 123, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.2260, Accuracy: 9399/10000 (93.9900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11]
base_p: [ 9.0897083e-06  2.0860881e-04  2.6395917e-04 ... -2.3219585e-03
  1.1429787e-03 -1.7040968e-04]
[T_SCORE] attacker_local_idxs is:  [4, 6, 7, 8, 9]
layer1_inf_time: 2.60400390625
[PAIRWISE] pred_attackers_indx:  [3 4 6]
layer2_inf_t: 27.9306640625
assumed final_attacker_idxs:  [3 4 6 7 8 9]
final_attacker_idxs is: [3 4 6 7 8 9]
g_attacker_idxs: [55 11 59 60 95 29]
g_normal_idxs: [15 30 86 69]
filtered_attacker_idxs: [4, 6, 7, 8, 9]
final_attacker_idxs are: [4, 6, 7, 8, 9]
num_dps: [401, 400, 250, 354, 645, 256, 760, 338, 602, 1002]
time spent on training: 38.96797204017639
Starting performing KrMLRFL...
Num data points: [401, 400, 250, 354, 645, 256, 760, 338, 602, 1002]
Num selected data points: [401 400 250 354 256]
The chosen ones are users: [0, 1, 2, 3, 5], which are global users: [15, 30, 86, 55, 69]
___Test Local_Simple poisoned: False, epoch: 123: Average loss: 0.0372, Accuracy: 9883/10000 (98.8300%)
epoch_acc: 98.83
___Test Local_Simple poisoned: True, epoch: 123: Average loss: 14.4147, Accuracy: 21/8968 (0.2342%)
Done in 219.87345600128174 sec.
Server Epoch:124 choose agents : [37, 94, 29, 55, 21, 2, 92, 61, 40, 88].
___Train Local_Simple,  epoch 124, local model 37, internal_epoch   1,  Average loss: 0.0011, Accuracy: 844/860 (98.1395%)
___Train Local_Simple,  epoch 124, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 853/860 (99.1860%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.3355, Accuracy: 9113/10000 (91.1300%)
___Train Local_Simple,  epoch 124, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 124, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1134, Accuracy: 9592/10000 (95.9200%)
___Train Local_Simple,  epoch 124, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 996/1002 (99.4012%)
___Train Local_Simple,  epoch 124, local model 29, internal_epoch   2,  Average loss: 0.0002, Accuracy: 998/1002 (99.6008%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1450, Accuracy: 9541/10000 (95.4100%)
___Train Local_Simple,  epoch 124, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 354/354 (100.0000%)
___Train Local_Simple,  epoch 124, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1175, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch 124, local model 21, internal_epoch   1,  Average loss: 0.0002, Accuracy: 312/312 (100.0000%)
___Train Local_Simple,  epoch 124, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0669, Accuracy: 9786/10000 (97.8600%)
poison local model 2 index 0
___Train Local_Simple,  epoch 124, local model 2, internal_epoch   1,  Average loss: 0.0006, Accuracy: 541/548 (98.7226%)
___Train Local_Simple,  epoch 124, local model 2, internal_epoch   2,  Average loss: 0.0003, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0749, Accuracy: 9754/10000 (97.5400%)
___Train Local_Simple,  epoch 124, local model 92, internal_epoch   1,  Average loss: 0.0004, Accuracy: 930/937 (99.2529%)
___Train Local_Simple,  epoch 124, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 931/937 (99.3597%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1094, Accuracy: 9634/10000 (96.3400%)
poison local model 61 index 1
___Train Local_Simple,  epoch 124, local model 61, internal_epoch   1,  Average loss: 0.0007, Accuracy: 687/699 (98.2833%)
___Train Local_Simple,  epoch 124, local model 61, internal_epoch   2,  Average loss: 0.0002, Accuracy: 696/699 (99.5708%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1351, Accuracy: 9525/10000 (95.2500%)
___Train Local_Simple,  epoch 124, local model 40, internal_epoch   1,  Average loss: 0.0002, Accuracy: 770/772 (99.7409%)
___Train Local_Simple,  epoch 124, local model 40, internal_epoch   2,  Average loss: 0.0000, Accuracy: 772/772 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0900, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch 124, local model 88, internal_epoch   1,  Average loss: 0.0008, Accuracy: 527/530 (99.4340%)
___Train Local_Simple,  epoch 124, local model 88, internal_epoch   2,  Average loss: 0.0009, Accuracy: 518/530 (97.7358%)
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.1944, Accuracy: 9400/10000 (94.0000%)
time spent on training: 49.0256187915802
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 61]
base_p: [-0.00095595  0.00027304 -0.00047609 ... -0.00048448  0.00171594
  0.00022084]
[T_SCORE] attacker_local_idxs is:  [0, 5, 6, 7, 9]
layer1_inf_time: 2.767333984375
[PAIRWISE] pred_attackers_indx:  [0 5 7 8 9]
layer2_inf_t: 33.118896484375
assumed final_attacker_idxs:  [0 5 6 7 8 9]
final_attacker_idxs is: [0 5 6 7 8 9]
g_attacker_idxs: [37  2 92 61 40 88]
g_normal_idxs: [94 29 55 21]
filtered_attacker_idxs: [0, 5, 6, 7, 8, 9]
final_attacker_idxs are: [0, 5, 6, 7, 8, 9]
num_dps: [860, 150, 1002, 354, 312, 548, 937, 699, 772, 530]
Starting performing KrMLRFL...
Num data points: [860, 150, 1002, 354, 312, 548, 937, 699, 772, 530]
Num selected data points: [ 150 1002  354  312]
The chosen ones are users: [1, 2, 3, 4], which are global users: [94, 29, 55, 21]
___Test Local_Simple poisoned: False, epoch: 124: Average loss: 0.0559, Accuracy: 9820/10000 (98.2000%)
epoch_acc: 98.2
___Test Local_Simple poisoned: True, epoch: 124: Average loss: 13.7796, Accuracy: 10/8968 (0.1115%)
Done in 213.29687762260437 sec.
Server Epoch:125 choose agents : [82, 53, 22, 44, 39, 85, 4, 84, 46, 69].
___Train Local_Simple,  epoch 125, local model 82, internal_epoch   1,  Average loss: 0.0002, Accuracy: 710/713 (99.5792%)
___Train Local_Simple,  epoch 125, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1701, Accuracy: 9443/10000 (94.4300%)
___Train Local_Simple,  epoch 125, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 125, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1589, Accuracy: 9512/10000 (95.1200%)
poison local model 22 index 0
___Train Local_Simple,  epoch 125, local model 22, internal_epoch   1,  Average loss: 0.0010, Accuracy: 571/583 (97.9417%)
___Train Local_Simple,  epoch 125, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 582/583 (99.8285%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1920, Accuracy: 9413/10000 (94.1300%)
___Train Local_Simple,  epoch 125, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 515/517 (99.6132%)
___Train Local_Simple,  epoch 125, local model 44, internal_epoch   2,  Average loss: 0.0007, Accuracy: 514/517 (99.4197%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0879, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch 125, local model 39, internal_epoch   1,  Average loss: 0.0007, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch 125, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0432, Accuracy: 9851/10000 (98.5100%)
poison local model 85 index 1
___Train Local_Simple,  epoch 125, local model 85, internal_epoch   1,  Average loss: 0.0003, Accuracy: 427/431 (99.0719%)
___Train Local_Simple,  epoch 125, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 430/431 (99.7680%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0977, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch 125, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 647/658 (98.3283%)
___Train Local_Simple,  epoch 125, local model 4, internal_epoch   2,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.3866, Accuracy: 9049/10000 (90.4900%)
___Train Local_Simple,  epoch 125, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1222/1246 (98.0738%)
___Train Local_Simple,  epoch 125, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1231/1246 (98.7961%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0835, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch 125, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 698/710 (98.3099%)
___Train Local_Simple,  epoch 125, local model 46, internal_epoch   2,  Average loss: 0.0006, Accuracy: 702/710 (98.8732%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.1308, Accuracy: 9566/10000 (95.6600%)
___Train Local_Simple,  epoch 125, local model 69, internal_epoch   1,  Average loss: 0.0003, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 125, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0870, Accuracy: 9711/10000 (97.1100%)
time spent on training: 51.62883949279785
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [22, 85]
base_p: [-0.00100037  0.00027622  0.00043302 ... -0.00071058 -0.00743899
 -0.00044788]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 7, 8]
layer1_inf_time: 3.532470703125
[PAIRWISE] pred_attackers_indx:  [2 5 7]
layer2_inf_t: 796.36865234375
assumed final_attacker_idxs:  [1 2 5 7 8]
final_attacker_idxs is: [1 2 5 7 8]
g_attacker_idxs: [53 22 85 84 46]
g_normal_idxs: [82 44 39  4 69]
filtered_attacker_idxs: [1, 2, 5, 7, 8]
final_attacker_idxs are: [1, 2, 5, 7, 8]
num_dps: [713, 739, 583, 517, 257, 431, 658, 1246, 710, 256]
Num data points: [713, 739, 583, 517, 257, 431, 658, 1246, 710, 256]
Num selected data points: [713 517 257 658 256]
The chosen ones are users: [0, 3, 4, 6, 9], which are global users: [82, 44, 39, 4, 69]
epoch_acc: 98.74000000000001
___Test Local_Simple poisoned: False, epoch: 125: Average loss: 0.0405, Accuracy: 9874/10000 (98.7400%)
___Test Local_Simple poisoned: True, epoch: 125: Average loss: 14.0349, Accuracy: 10/8968 (0.1115%)
Done in 267.84783458709717 sec.
Server Epoch:126 choose agents : [1, 3, 16, 55, 51, 43, 89, 32, 94, 54].
poison local model 1 index 0
___Train Local_Simple,  epoch 126, local model 1, internal_epoch   1,  Average loss: 0.0007, Accuracy: 753/760 (99.0789%)
___Train Local_Simple,  epoch 126, local model 1, internal_epoch   2,  Average loss: 0.0006, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1120, Accuracy: 9661/10000 (96.6100%)
___Train Local_Simple,  epoch 126, local model 3, internal_epoch   1,  Average loss: 0.0004, Accuracy: 917/923 (99.3499%)
___Train Local_Simple,  epoch 126, local model 3, internal_epoch   2,  Average loss: 0.0002, Accuracy: 920/923 (99.6750%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0818, Accuracy: 9759/10000 (97.5900%)
poison local model 16 index 1
___Train Local_Simple,  epoch 126, local model 16, internal_epoch   1,  Average loss: 0.0009, Accuracy: 904/915 (98.7978%)
___Train Local_Simple,  epoch 126, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 910/915 (99.4536%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1121, Accuracy: 9688/10000 (96.8800%)
___Train Local_Simple,  epoch 126, local model 55, internal_epoch   1,  Average loss: 0.0006, Accuracy: 350/354 (98.8701%)
___Train Local_Simple,  epoch 126, local model 55, internal_epoch   2,  Average loss: 0.0003, Accuracy: 352/354 (99.4350%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.4174, Accuracy: 8973/10000 (89.7300%)
poison local model 51 index 2
___Train Local_Simple,  epoch 126, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 126, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0883, Accuracy: 9727/10000 (97.2700%)
___Train Local_Simple,  epoch 126, local model 43, internal_epoch   1,  Average loss: 0.0004, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 126, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0789, Accuracy: 9754/10000 (97.5400%)
___Train Local_Simple,  epoch 126, local model 89, internal_epoch   1,  Average loss: 0.0005, Accuracy: 487/492 (98.9837%)
___Train Local_Simple,  epoch 126, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.2022, Accuracy: 9443/10000 (94.4300%)
___Train Local_Simple,  epoch 126, local model 32, internal_epoch   1,  Average loss: 0.0011, Accuracy: 961/977 (98.3623%)
___Train Local_Simple,  epoch 126, local model 32, internal_epoch   2,  Average loss: 0.0009, Accuracy: 966/977 (98.8741%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1929, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch 126, local model 94, internal_epoch   1,  Average loss: 0.0005, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 126, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1107, Accuracy: 9614/10000 (96.1400%)
___Train Local_Simple,  epoch 126, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 515/519 (99.2293%)
___Train Local_Simple,  epoch 126, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 516/519 (99.4220%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1, 16, 51]
base_p: [ 0.00047614  0.00026833  0.00073104 ...  0.00610802 -0.00325231
  0.00101223]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 6]
layer1_inf_time: 3.46923828125
[PAIRWISE] pred_attackers_indx:  [2 3 4 6]
layer2_inf_t: 40.3056640625
assumed final_attacker_idxs:  [0 1 2 3 4 6]
final_attacker_idxs is: [0 1 2 3 4 6]
g_attacker_idxs: [ 1  3 16 55 51 89]
g_normal_idxs: [43 32 94 54]
filtered_attacker_idxs: [0, 1, 2, 4, 6]
final_attacker_idxs are: [0, 1, 2, 4, 6]
num_dps: [760, 923, 915, 354, 568, 408, 492, 977, 150, 519]
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.1246, Accuracy: 9612/10000 (96.1200%)
time spent on training: 55.12940526008606
Starting performing KrMLRFL...
Num data points: [760, 923, 915, 354, 568, 408, 492, 977, 150, 519]
Num selected data points: [354 408 977 150 519]
The chosen ones are users: [3, 5, 7, 8, 9], which are global users: [55, 43, 32, 94, 54]
___Test Local_Simple poisoned: False, epoch: 126: Average loss: 0.0555, Accuracy: 9830/10000 (98.3000%)
epoch_acc: 98.3
___Test Local_Simple poisoned: True, epoch: 126: Average loss: 12.7247, Accuracy: 12/8968 (0.1338%)
Done in 242.9343798160553 sec.
Server Epoch:127 choose agents : [53, 94, 92, 75, 27, 52, 78, 35, 29, 41].
___Train Local_Simple,  epoch 127, local model 53, internal_epoch   1,  Average loss: 0.0009, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 127, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 734/739 (99.3234%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0854, Accuracy: 9737/10000 (97.3700%)
___Train Local_Simple,  epoch 127, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 127, local model 94, internal_epoch   2,  Average loss: 0.0001, Accuracy: 150/150 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0886, Accuracy: 9709/10000 (97.0900%)
___Train Local_Simple,  epoch 127, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 926/937 (98.8260%)
___Train Local_Simple,  epoch 127, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 933/937 (99.5731%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1123, Accuracy: 9660/10000 (96.6000%)
___Train Local_Simple,  epoch 127, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 685/686 (99.8542%)
___Train Local_Simple,  epoch 127, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0791, Accuracy: 9753/10000 (97.5300%)
poison local model 27 index 0
___Train Local_Simple,  epoch 127, local model 27, internal_epoch   1,  Average loss: 0.0008, Accuracy: 462/471 (98.0892%)
___Train Local_Simple,  epoch 127, local model 27, internal_epoch   2,  Average loss: 0.0003, Accuracy: 469/471 (99.5754%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1790, Accuracy: 9457/10000 (94.5700%)
poison local model 52 index 1
___Train Local_Simple,  epoch 127, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 127, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 253/253 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.1100, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch 127, local model 78, internal_epoch   1,  Average loss: 0.0005, Accuracy: 300/303 (99.0099%)
___Train Local_Simple,  epoch 127, local model 78, internal_epoch   2,  Average loss: 0.0007, Accuracy: 301/303 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.2226, Accuracy: 9347/10000 (93.4700%)
___Train Local_Simple,  epoch 127, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 127, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0885, Accuracy: 9716/10000 (97.1600%)
___Train Local_Simple,  epoch 127, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1002/1002 (100.0000%)
___Train Local_Simple,  epoch 127, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1001/1002 (99.9002%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0699, Accuracy: 9777/10000 (97.7700%)
___Train Local_Simple,  epoch 127, local model 41, internal_epoch   1,  Average loss: 0.0012, Accuracy: 597/606 (98.5149%)
___Train Local_Simple,  epoch 127, local model 41, internal_epoch   2,  Average loss: 0.0006, Accuracy: 602/606 (99.3399%)
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.4165, Accuracy: 8918/10000 (89.1800%)
time spent on training: 51.95610427856445
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27, 52]
base_p: [ 4.4964254e-05  2.3908541e-04  9.4400067e-04 ... -2.5314987e-03
 -1.5188605e-03 -7.2476268e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 8]
layer1_inf_time: 4.113525390625
[PAIRWISE] pred_attackers_indx:  [9]
layer2_inf_t: 128.882080078125
assumed final_attacker_idxs:  [0 2 4 5 8 9]
final_attacker_idxs is: [0 2 4 5 8 9]
g_attacker_idxs: [53 92 27 52 29 41]
g_normal_idxs: [94 75 78 35]
filtered_attacker_idxs: [0, 2, 4, 5, 8]
final_attacker_idxs are: [0, 2, 4, 5, 8]
num_dps: [739, 150, 937, 686, 471, 253, 303, 499, 1002, 606]
Starting performing KrMLRFL...
Num data points: [739, 150, 937, 686, 471, 253, 303, 499, 1002, 606]
Num selected data points: [150 686 303 499 606]
The chosen ones are users: [1, 3, 6, 7, 9], which are global users: [94, 75, 78, 35, 41]
___Test Local_Simple poisoned: False, epoch: 127: Average loss: 0.0423, Accuracy: 9860/10000 (98.6000%)
epoch_acc: 98.6
___Test Local_Simple poisoned: True, epoch: 127: Average loss: 13.1874, Accuracy: 15/8968 (0.1673%)
Done in 230.65196323394775 sec.
Server Epoch:128 choose agents : [38, 61, 45, 57, 19, 53, 67, 98, 62, 65].
___Train Local_Simple,  epoch 128, local model 38, internal_epoch   1,  Average loss: 0.0005, Accuracy: 883/895 (98.6592%)
___Train Local_Simple,  epoch 128, local model 38, internal_epoch   2,  Average loss: 0.0002, Accuracy: 892/895 (99.6648%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1019, Accuracy: 9666/10000 (96.6600%)
poison local model 61 index 0
___Train Local_Simple,  epoch 128, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 686/699 (98.1402%)
___Train Local_Simple,  epoch 128, local model 61, internal_epoch   2,  Average loss: 0.0005, Accuracy: 693/699 (99.1416%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.4582, Accuracy: 8781/10000 (87.8100%)
poison local model 45 index 1
___Train Local_Simple,  epoch 128, local model 45, internal_epoch   1,  Average loss: 0.0007, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 128, local model 45, internal_epoch   2,  Average loss: 0.0006, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1696, Accuracy: 9493/10000 (94.9300%)
___Train Local_Simple,  epoch 128, local model 57, internal_epoch   1,  Average loss: 0.0008, Accuracy: 339/343 (98.8338%)
___Train Local_Simple,  epoch 128, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 342/343 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1623, Accuracy: 9492/10000 (94.9200%)
___Train Local_Simple,  epoch 128, local model 19, internal_epoch   1,  Average loss: 0.0006, Accuracy: 202/205 (98.5366%)
___Train Local_Simple,  epoch 128, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 205/205 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0471, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 128, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 731/739 (98.9175%)
___Train Local_Simple,  epoch 128, local model 53, internal_epoch   2,  Average loss: 0.0001, Accuracy: 738/739 (99.8647%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1385, Accuracy: 9573/10000 (95.7300%)
___Train Local_Simple,  epoch 128, local model 67, internal_epoch   1,  Average loss: 0.0002, Accuracy: 997/998 (99.8998%)
___Train Local_Simple,  epoch 128, local model 67, internal_epoch   2,  Average loss: 0.0001, Accuracy: 997/998 (99.8998%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.1339, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch 128, local model 98, internal_epoch   1,  Average loss: 0.0008, Accuracy: 804/818 (98.2885%)
___Train Local_Simple,  epoch 128, local model 98, internal_epoch   2,  Average loss: 0.0002, Accuracy: 815/818 (99.6333%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.2435, Accuracy: 9197/10000 (91.9700%)
___Train Local_Simple,  epoch 128, local model 62, internal_epoch   1,  Average loss: 0.0003, Accuracy: 419/423 (99.0544%)
___Train Local_Simple,  epoch 128, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0880, Accuracy: 9710/10000 (97.1000%)
___Train Local_Simple,  epoch 128, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 368/371 (99.1914%)
___Train Local_Simple,  epoch 128, local model 65, internal_epoch   2,  Average loss: 0.0003, Accuracy: 370/371 (99.7305%)
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0697, Accuracy: 9773/10000 (97.7300%)
time spent on training: 47.47882652282715
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 45]
base_p: [3.7898868e-04 2.5698915e-04 1.2040772e-03 ... 1.8835068e-05 2.7315170e-03
 9.3391538e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 7]
layer1_inf_time: 2.85107421875
[PAIRWISE] pred_attackers_indx:  [0 2 6 7 9]
layer2_inf_t: 28.619384765625
assumed final_attacker_idxs:  [0 1 2 5 6 7 9]
final_attacker_idxs is: [0 1 2 5 6 7 9]
g_attacker_idxs: [38 61 45 53 67 98 65]
g_normal_idxs: [57 19 62]
filtered_attacker_idxs: [1, 2, 5, 6, 7]
final_attacker_idxs are: [1, 2, 5, 6, 7]
num_dps: [895, 699, 628, 343, 205, 739, 998, 818, 423, 371]
epoch_acc: 98.67
Starting performing KrMLRFL...
Num data points: [895, 699, 628, 343, 205, 739, 998, 818, 423, 371]
Num selected data points: [895 343 205 423 371]
The chosen ones are users: [0, 3, 4, 8, 9], which are global users: [38, 57, 19, 62, 65]
___Test Local_Simple poisoned: False, epoch: 128: Average loss: 0.0402, Accuracy: 9867/10000 (98.6700%)
___Test Local_Simple poisoned: True, epoch: 128: Average loss: 13.2617, Accuracy: 13/8968 (0.1450%)
Done in 210.3038046360016 sec.
Server Epoch:129 choose agents : [91, 9, 42, 71, 78, 68, 19, 23, 20, 28].
poison local model 91 index 0
___Train Local_Simple,  epoch 129, local model 91, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 129, local model 91, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0483, Accuracy: 9847/10000 (98.4700%)
___Train Local_Simple,  epoch 129, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 129, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0596, Accuracy: 9817/10000 (98.1700%)
poison local model 42 index 1
___Train Local_Simple,  epoch 129, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 233/236 (98.7288%)
___Train Local_Simple,  epoch 129, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0494, Accuracy: 9835/10000 (98.3500%)
poison local model 71 index 2
___Train Local_Simple,  epoch 129, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1370/1384 (98.9884%)
___Train Local_Simple,  epoch 129, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1376/1384 (99.4220%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.1659, Accuracy: 9488/10000 (94.8800%)
___Train Local_Simple,  epoch 129, local model 78, internal_epoch   1,  Average loss: 0.0004, Accuracy: 300/303 (99.0099%)
___Train Local_Simple,  epoch 129, local model 78, internal_epoch   2,  Average loss: 0.0001, Accuracy: 302/303 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.1208, Accuracy: 9631/10000 (96.3100%)
___Train Local_Simple,  epoch 129, local model 68, internal_epoch   1,  Average loss: 0.0003, Accuracy: 490/494 (99.1903%)
___Train Local_Simple,  epoch 129, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.1088, Accuracy: 9666/10000 (96.6600%)
___Train Local_Simple,  epoch 129, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 200/205 (97.5610%)
___Train Local_Simple,  epoch 129, local model 19, internal_epoch   2,  Average loss: 0.0006, Accuracy: 203/205 (99.0244%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0924, Accuracy: 9729/10000 (97.2900%)
___Train Local_Simple,  epoch 129, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 129, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0409, Accuracy: 9872/10000 (98.7200%)
poison local model 20 index 3
___Train Local_Simple,  epoch 129, local model 20, internal_epoch   1,  Average loss: 0.0008, Accuracy: 422/429 (98.3683%)
___Train Local_Simple,  epoch 129, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 427/429 (99.5338%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.2120, Accuracy: 9369/10000 (93.6900%)
___Train Local_Simple,  epoch 129, local model 28, internal_epoch   1,  Average loss: 0.0002, Accuracy: 500/501 (99.8004%)
___Train Local_Simple,  epoch 129, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0399, Accuracy: 9874/10000 (98.7400%)
time spent on training: 66.43978452682495
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 42, 71, 20]
base_p: [-7.4991584e-04  1.7392635e-04 -5.4776669e-05 ... -2.4525523e-03
 -1.6969293e-03 -5.7506561e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 8]
layer1_inf_time: 4.27490234375
[PAIRWISE] pred_attackers_indx:  [3 8]
layer2_inf_t: 690.9423828125
assumed final_attacker_idxs:  [0 2 3 5 8]
final_attacker_idxs is: [0 2 3 5 8]
g_attacker_idxs: [91 42 71 68 20]
g_normal_idxs: [ 9 78 19 23 28]
filtered_attacker_idxs: [0, 2, 3, 8]
final_attacker_idxs are: [0, 2, 3, 8]
num_dps: [256, 436, 236, 1384, 303, 494, 205, 293, 429, 501]
Num data points: [256, 436, 236, 1384, 303, 494, 205, 293, 429, 501]
Num selected data points: [436 303 494 205 293 501]
The chosen ones are users: [1, 4, 5, 6, 7, 9], which are global users: [9, 78, 68, 19, 23, 28]
___Test Local_Simple poisoned: False, epoch: 129: Average loss: 0.0349, Accuracy: 9893/10000 (98.9300%)
epoch_acc: 98.92999999999999
___Test Local_Simple poisoned: True, epoch: 129: Average loss: 14.7599, Accuracy: 6/8968 (0.0669%)
Done in 256.6061735153198 sec.
Server Epoch:130 choose agents : [39, 57, 6, 94, 26, 99, 32, 33, 7, 73].
___Train Local_Simple,  epoch 130, local model 39, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch 130, local model 39, internal_epoch   2,  Average loss: 0.0001, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0461, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 130, local model 57, internal_epoch   1,  Average loss: 0.0007, Accuracy: 337/343 (98.2507%)
___Train Local_Simple,  epoch 130, local model 57, internal_epoch   2,  Average loss: 0.0003, Accuracy: 340/343 (99.1254%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.1601, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch 130, local model 6, internal_epoch   1,  Average loss: 0.0005, Accuracy: 609/615 (99.0244%)
___Train Local_Simple,  epoch 130, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 610/615 (99.1870%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.1138, Accuracy: 9671/10000 (96.7100%)
___Train Local_Simple,  epoch 130, local model 94, internal_epoch   1,  Average loss: 0.0010, Accuracy: 149/150 (99.3333%)
___Train Local_Simple,  epoch 130, local model 94, internal_epoch   2,  Average loss: 0.0003, Accuracy: 149/150 (99.3333%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.1189, Accuracy: 9561/10000 (95.6100%)
poison local model 26 index 0
___Train Local_Simple,  epoch 130, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 130, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0667, Accuracy: 9775/10000 (97.7500%)
___Train Local_Simple,  epoch 130, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 375/377 (99.4695%)
___Train Local_Simple,  epoch 130, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0453, Accuracy: 9852/10000 (98.5200%)
___Train Local_Simple,  epoch 130, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 970/977 (99.2835%)
___Train Local_Simple,  epoch 130, local model 32, internal_epoch   2,  Average loss: 0.0001, Accuracy: 975/977 (99.7953%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.1112, Accuracy: 9636/10000 (96.3600%)
___Train Local_Simple,  epoch 130, local model 33, internal_epoch   1,  Average loss: 0.0006, Accuracy: 614/623 (98.5554%)
___Train Local_Simple,  epoch 130, local model 33, internal_epoch   2,  Average loss: 0.0003, Accuracy: 618/623 (99.1974%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0660, Accuracy: 9790/10000 (97.9000%)
poison local model 7 index 1
___Train Local_Simple,  epoch 130, local model 7, internal_epoch   1,  Average loss: 0.0009, Accuracy: 409/418 (97.8469%)
___Train Local_Simple,  epoch 130, local model 7, internal_epoch   2,  Average loss: 0.0001, Accuracy: 418/418 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.1081, Accuracy: 9656/10000 (96.5600%)
poison local model 73 index 2
___Train Local_Simple,  epoch 130, local model 73, internal_epoch   1,  Average loss: 0.0006, Accuracy: 586/591 (99.1540%)
___Train Local_Simple,  epoch 130, local model 73, internal_epoch   2,  Average loss: 0.0002, Accuracy: 589/591 (99.6616%)
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0701, Accuracy: 9767/10000 (97.6700%)
time spent on training: 52.16982936859131
Starting performing KrMLRFL...
Num data points: [257, 343, 615, 150, 554, 377, 977, 623, 418, 591]
Num selected data points: [257 343 150 377]
The chosen ones are users: [0, 1, 3, 5], which are global users: [39, 57, 94, 99]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 7, 73]
base_p: [ 0.00097238  0.0001964   0.00030249 ... -0.00481309 -0.00192965
  0.00179982]
[T_SCORE] attacker_local_idxs is:  [4, 6, 7, 8, 9]
layer1_inf_time: 3.0498046875
[PAIRWISE] pred_attackers_indx:  [1 2 4 8]
layer2_inf_t: 96.966796875
assumed final_attacker_idxs:  [1 2 4 6 7 8 9]
final_attacker_idxs is: [1 2 4 6 7 8 9]
g_attacker_idxs: [57  6 26 32 33  7 73]
g_normal_idxs: [39 94 99]
filtered_attacker_idxs: [2, 4, 6, 7, 8, 9]
final_attacker_idxs are: [2, 4, 6, 7, 8, 9]
num_dps: [257, 343, 615, 150, 554, 377, 977, 623, 418, 591]
epoch_acc: 98.72
___Test Local_Simple poisoned: False, epoch: 130: Average loss: 0.0403, Accuracy: 9872/10000 (98.7200%)
___Test Local_Simple poisoned: True, epoch: 130: Average loss: 12.8925, Accuracy: 34/8968 (0.3791%)
Done in 207.1757514476776 sec.
Server Epoch:131 choose agents : [66, 3, 2, 14, 43, 81, 63, 64, 34, 98].
___Train Local_Simple,  epoch 131, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 651/660 (98.6364%)
___Train Local_Simple,  epoch 131, local model 66, internal_epoch   2,  Average loss: 0.0004, Accuracy: 654/660 (99.0909%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.2967, Accuracy: 9125/10000 (91.2500%)
___Train Local_Simple,  epoch 131, local model 3, internal_epoch   1,  Average loss: 0.0004, Accuracy: 916/923 (99.2416%)
___Train Local_Simple,  epoch 131, local model 3, internal_epoch   2,  Average loss: 0.0001, Accuracy: 921/923 (99.7833%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1712, Accuracy: 9485/10000 (94.8500%)
poison local model 2 index 0
___Train Local_Simple,  epoch 131, local model 2, internal_epoch   1,  Average loss: 0.0009, Accuracy: 540/548 (98.5401%)
___Train Local_Simple,  epoch 131, local model 2, internal_epoch   2,  Average loss: 0.0004, Accuracy: 544/548 (99.2701%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1069, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch 131, local model 14, internal_epoch   1,  Average loss: 0.0005, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch 131, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1343, Accuracy: 9640/10000 (96.4000%)
___Train Local_Simple,  epoch 131, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 131, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 408/408 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0411, Accuracy: 9867/10000 (98.6700%)
poison local model 81 index 1
___Train Local_Simple,  epoch 131, local model 81, internal_epoch   1,  Average loss: 0.0005, Accuracy: 1211/1227 (98.6960%)
___Train Local_Simple,  epoch 131, local model 81, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1214/1227 (98.9405%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.4875, Accuracy: 8892/10000 (88.9200%)
poison local model 63 index 2
___Train Local_Simple,  epoch 131, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 870/889 (97.8628%)
___Train Local_Simple,  epoch 131, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 877/889 (98.6502%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0665, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch 131, local model 64, internal_epoch   1,  Average loss: 0.0005, Accuracy: 801/813 (98.5240%)
___Train Local_Simple,  epoch 131, local model 64, internal_epoch   2,  Average loss: 0.0004, Accuracy: 807/813 (99.2620%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0937, Accuracy: 9697/10000 (96.9700%)
poison local model 34 index 3
___Train Local_Simple,  epoch 131, local model 34, internal_epoch   1,  Average loss: 0.0003, Accuracy: 409/413 (99.0315%)
___Train Local_Simple,  epoch 131, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0889, Accuracy: 9749/10000 (97.4900%)
___Train Local_Simple,  epoch 131, local model 98, internal_epoch   1,  Average loss: 0.0008, Accuracy: 804/818 (98.2885%)
___Train Local_Simple,  epoch 131, local model 98, internal_epoch   2,  Average loss: 0.0003, Accuracy: 813/818 (99.3888%)
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.1607, Accuracy: 9514/10000 (95.1400%)
time spent on training: 61.22114133834839
Starting performing KrMLRFL...
Num data points: [660, 923, 548, 376, 408, 1227, 889, 813, 413, 818]
Num selected data points: [376 408 813]
The chosen ones are users: [3, 4, 7], which are global users: [14, 43, 64]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 81, 63, 34]
base_p: [ 0.00397807  0.00031377 -0.00143496 ...  0.00191098 -0.00080489
 -0.00117371]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 6, 7, 8, 9]
layer1_inf_time: 5.1875
[PAIRWISE] pred_attackers_indx:  [2 5 6 8]
layer2_inf_t: 38.899658203125
assumed final_attacker_idxs:  [0 1 2 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 5 6 7 8 9]
g_attacker_idxs: [66  3  2 81 63 64 34 98]
g_normal_idxs: [14 43]
filtered_attacker_idxs: [0, 1, 2, 5, 6, 8, 9]
final_attacker_idxs are: [0, 1, 2, 5, 6, 8, 9]
num_dps: [660, 923, 548, 376, 408, 1227, 889, 813, 413, 818]
epoch_acc: 98.52
___Test Local_Simple poisoned: False, epoch: 131: Average loss: 0.0468, Accuracy: 9852/10000 (98.5200%)
___Test Local_Simple poisoned: True, epoch: 131: Average loss: 12.2885, Accuracy: 35/8968 (0.3903%)
Done in 212.36248993873596 sec.
Server Epoch:132 choose agents : [54, 58, 51, 55, 72, 42, 69, 93, 80, 15].
___Train Local_Simple,  epoch 132, local model 54, internal_epoch   1,  Average loss: 0.0003, Accuracy: 516/519 (99.4220%)
___Train Local_Simple,  epoch 132, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 519/519 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0936, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch 132, local model 58, internal_epoch   1,  Average loss: 0.0008, Accuracy: 270/276 (97.8261%)
___Train Local_Simple,  epoch 132, local model 58, internal_epoch   2,  Average loss: 0.0012, Accuracy: 271/276 (98.1884%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.1120, Accuracy: 9609/10000 (96.0900%)
poison local model 51 index 0
___Train Local_Simple,  epoch 132, local model 51, internal_epoch   1,  Average loss: 0.0006, Accuracy: 561/568 (98.7676%)
___Train Local_Simple,  epoch 132, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 567/568 (99.8239%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.1538, Accuracy: 9506/10000 (95.0600%)
___Train Local_Simple,  epoch 132, local model 55, internal_epoch   1,  Average loss: 0.0005, Accuracy: 350/354 (98.8701%)
___Train Local_Simple,  epoch 132, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.3587, Accuracy: 8996/10000 (89.9600%)
___Train Local_Simple,  epoch 132, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 729/731 (99.7264%)
___Train Local_Simple,  epoch 132, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0924, Accuracy: 9701/10000 (97.0100%)
poison local model 42 index 1
___Train Local_Simple,  epoch 132, local model 42, internal_epoch   1,  Average loss: 0.0005, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 132, local model 42, internal_epoch   2,  Average loss: 0.0002, Accuracy: 235/236 (99.5763%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0491, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 132, local model 69, internal_epoch   1,  Average loss: 0.0011, Accuracy: 252/256 (98.4375%)
___Train Local_Simple,  epoch 132, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0841, Accuracy: 9712/10000 (97.1200%)
poison local model 93 index 2
___Train Local_Simple,  epoch 132, local model 93, internal_epoch   1,  Average loss: 0.0006, Accuracy: 617/623 (99.0369%)
___Train Local_Simple,  epoch 132, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 621/623 (99.6790%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.3343, Accuracy: 9057/10000 (90.5700%)
___Train Local_Simple,  epoch 132, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 132, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0587, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 132, local model 15, internal_epoch   1,  Average loss: 0.0006, Accuracy: 396/401 (98.7531%)
___Train Local_Simple,  epoch 132, local model 15, internal_epoch   2,  Average loss: 0.0002, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.1537, Accuracy: 9530/10000 (95.3000%)
time spent on training: 47.337318658828735
Starting performing KrMLRFL...
Num data points: [519, 276, 568, 354, 731, 236, 256, 623, 431, 401]
Num selected data points: [519 276 354 731 256 431 401]
The chosen ones are users: [0, 1, 3, 4, 6, 8, 9], which are global users: [54, 58, 55, 72, 69, 80, 15]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 42, 93]
base_p: [-0.00177445  0.0001618   0.00103043 ... -0.0004954   0.0036634
  0.0010594 ]
[T_SCORE] attacker_local_idxs is:  [0, 2, 5, 7, 8]
layer1_inf_time: 2.90771484375
[PAIRWISE] pred_attackers_indx:  [7 8]
layer2_inf_t: 100.423583984375
assumed final_attacker_idxs:  [0 2 5 7 8]
final_attacker_idxs is: [0 2 5 7 8]
g_attacker_idxs: [54 51 42 93 80]
g_normal_idxs: [58 55 72 69 15]
filtered_attacker_idxs: [2, 5, 7]
final_attacker_idxs are: [2, 5, 7]
num_dps: [519, 276, 568, 354, 731, 236, 256, 623, 431, 401]
___Test Local_Simple poisoned: False, epoch: 132: Average loss: 0.0356, Accuracy: 9886/10000 (98.8600%)
epoch_acc: 98.86
___Test Local_Simple poisoned: True, epoch: 132: Average loss: 14.0839, Accuracy: 8/8968 (0.0892%)
Done in 185.58109545707703 sec.
Server Epoch:133 choose agents : [56, 32, 45, 76, 63, 81, 78, 59, 13, 19].
___Train Local_Simple,  epoch 133, local model 56, internal_epoch   1,  Average loss: 0.0002, Accuracy: 876/880 (99.5455%)
___Train Local_Simple,  epoch 133, local model 56, internal_epoch   2,  Average loss: 0.0001, Accuracy: 879/880 (99.8864%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.1119, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch 133, local model 32, internal_epoch   1,  Average loss: 0.0005, Accuracy: 968/977 (99.0788%)
___Train Local_Simple,  epoch 133, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 971/977 (99.3859%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0907, Accuracy: 9711/10000 (97.1100%)
poison local model 45 index 0
___Train Local_Simple,  epoch 133, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 133, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.1399, Accuracy: 9589/10000 (95.8900%)
___Train Local_Simple,  epoch 133, local model 76, internal_epoch   1,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 133, local model 76, internal_epoch   2,  Average loss: 0.0001, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0346, Accuracy: 9886/10000 (98.8600%)
poison local model 63 index 1
___Train Local_Simple,  epoch 133, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 873/889 (98.2002%)
___Train Local_Simple,  epoch 133, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 880/889 (98.9876%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0622, Accuracy: 9802/10000 (98.0200%)
poison local model 81 index 2
___Train Local_Simple,  epoch 133, local model 81, internal_epoch   1,  Average loss: 0.0003, Accuracy: 1219/1227 (99.3480%)
___Train Local_Simple,  epoch 133, local model 81, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1218/1227 (99.2665%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.5324, Accuracy: 8958/10000 (89.5800%)
___Train Local_Simple,  epoch 133, local model 78, internal_epoch   1,  Average loss: 0.0003, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 133, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0880, Accuracy: 9719/10000 (97.1900%)
___Train Local_Simple,  epoch 133, local model 59, internal_epoch   1,  Average loss: 0.0012, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch 133, local model 59, internal_epoch   2,  Average loss: 0.0004, Accuracy: 753/760 (99.0789%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0979, Accuracy: 9670/10000 (96.7000%)
poison local model 13 index 3
___Train Local_Simple,  epoch 133, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 729/734 (99.3188%)
___Train Local_Simple,  epoch 133, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 729/734 (99.3188%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.2020, Accuracy: 9421/10000 (94.2100%)
___Train Local_Simple,  epoch 133, local model 19, internal_epoch   1,  Average loss: 0.0007, Accuracy: 200/205 (97.5610%)
___Train Local_Simple,  epoch 133, local model 19, internal_epoch   2,  Average loss: 0.0001, Accuracy: 204/205 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.1342, Accuracy: 9611/10000 (96.1100%)
time spent on training: 49.93875575065613
Starting performing KrMLRFL...
Num data points: [880, 977, 628, 78, 889, 1227, 303, 760, 734, 205]
Num selected data points: [880 977  78 303 205]
The chosen ones are users: [0, 1, 3, 6, 9], which are global users: [56, 32, 76, 78, 19]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 63, 81, 13]
base_p: [ 0.00106583  0.00029227  0.00054006 ...  0.00192784 -0.00044083
 -0.0001582 ]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 8]
layer1_inf_time: 3.103271484375
[PAIRWISE] pred_attackers_indx:  [2 5 8]
layer2_inf_t: 250.25146484375
assumed final_attacker_idxs:  [2 4 5 7 8]
final_attacker_idxs is: [2 4 5 7 8]
g_attacker_idxs: [45 63 81 59 13]
g_normal_idxs: [56 32 76 78 19]
filtered_attacker_idxs: [2, 4, 5, 7, 8]
final_attacker_idxs are: [2, 4, 5, 7, 8]
num_dps: [880, 977, 628, 78, 889, 1227, 303, 760, 734, 205]
epoch_acc: 98.81
___Test Local_Simple poisoned: False, epoch: 133: Average loss: 0.0375, Accuracy: 9881/10000 (98.8100%)
___Test Local_Simple poisoned: True, epoch: 133: Average loss: 14.7550, Accuracy: 6/8968 (0.0669%)
Done in 213.13574242591858 sec.
Server Epoch:134 choose agents : [85, 46, 71, 25, 11, 70, 83, 24, 65, 68].
poison local model 85 index 0
___Train Local_Simple,  epoch 134, local model 85, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 134, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0580, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 134, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 698/710 (98.3099%)
___Train Local_Simple,  epoch 134, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 704/710 (99.1549%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.1255, Accuracy: 9599/10000 (95.9900%)
poison local model 71 index 1
___Train Local_Simple,  epoch 134, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1363/1384 (98.4827%)
___Train Local_Simple,  epoch 134, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1372/1384 (99.1329%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.4280, Accuracy: 8759/10000 (87.5900%)
___Train Local_Simple,  epoch 134, local model 25, internal_epoch   1,  Average loss: 0.0003, Accuracy: 644/647 (99.5363%)
___Train Local_Simple,  epoch 134, local model 25, internal_epoch   2,  Average loss: 0.0001, Accuracy: 646/647 (99.8454%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.1289, Accuracy: 9580/10000 (95.8000%)
poison local model 11 index 2
___Train Local_Simple,  epoch 134, local model 11, internal_epoch   1,  Average loss: 0.0010, Accuracy: 636/645 (98.6047%)
___Train Local_Simple,  epoch 134, local model 11, internal_epoch   2,  Average loss: 0.0014, Accuracy: 621/645 (96.2791%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.2542, Accuracy: 9302/10000 (93.0200%)
poison local model 70 index 3
___Train Local_Simple,  epoch 134, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 710/724 (98.0663%)
___Train Local_Simple,  epoch 134, local model 70, internal_epoch   2,  Average loss: 0.0003, Accuracy: 720/724 (99.4475%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.2125, Accuracy: 9400/10000 (94.0000%)
___Train Local_Simple,  epoch 134, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 431/433 (99.5381%)
___Train Local_Simple,  epoch 134, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0466, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch 134, local model 24, internal_epoch   1,  Average loss: 0.0007, Accuracy: 372/379 (98.1530%)
___Train Local_Simple,  epoch 134, local model 24, internal_epoch   2,  Average loss: 0.0004, Accuracy: 377/379 (99.4723%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0827, Accuracy: 9736/10000 (97.3600%)
___Train Local_Simple,  epoch 134, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 134, local model 65, internal_epoch   2,  Average loss: 0.0003, Accuracy: 367/371 (98.9218%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0981, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch 134, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 134, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0731, Accuracy: 9787/10000 (97.8700%)
time spent on training: 60.44486212730408
Starting performing KrMLRFL...
Num data points: [431, 710, 1384, 647, 645, 724, 433, 379, 371, 494]
Num selected data points: [433 379 371 494]
The chosen ones are users: [6, 7, 8, 9], which are global users: [83, 24, 65, 68]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [85, 71, 11, 70]
base_p: [ 0.00245266  0.00026193 -0.00072724 ... -0.00233479 -0.00304968
 -0.00012409]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 5]
layer1_inf_time: 3.33984375
[PAIRWISE] pred_attackers_indx:  [1 3 6 7 8 9]
layer2_inf_t: 156.152099609375
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 8 9]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 8 9]
g_attacker_idxs: [85 46 71 25 11 70 83 24 65 68]
g_normal_idxs: []
filtered_attacker_idxs: [0, 1, 2, 3, 4, 5]
final_attacker_idxs are: [0, 1, 2, 3, 4, 5]
num_dps: [431, 710, 1384, 647, 645, 724, 433, 379, 371, 494]
epoch_acc: 98.7
___Test Local_Simple poisoned: False, epoch: 134: Average loss: 0.0388, Accuracy: 9870/10000 (98.7000%)
___Test Local_Simple poisoned: True, epoch: 134: Average loss: 14.8106, Accuracy: 10/8968 (0.1115%)
Done in 217.83866906166077 sec.
Server Epoch:135 choose agents : [13, 77, 92, 8, 70, 84, 35, 9, 22, 90].
poison local model 13 index 0
___Train Local_Simple,  epoch 135, local model 13, internal_epoch   1,  Average loss: 0.0003, Accuracy: 728/734 (99.1826%)
___Train Local_Simple,  epoch 135, local model 13, internal_epoch   2,  Average loss: 0.0002, Accuracy: 730/734 (99.4550%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0826, Accuracy: 9718/10000 (97.1800%)
___Train Local_Simple,  epoch 135, local model 77, internal_epoch   1,  Average loss: 0.0007, Accuracy: 584/589 (99.1511%)
___Train Local_Simple,  epoch 135, local model 77, internal_epoch   2,  Average loss: 0.0003, Accuracy: 585/589 (99.3209%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0548, Accuracy: 9831/10000 (98.3100%)
___Train Local_Simple,  epoch 135, local model 92, internal_epoch   1,  Average loss: 0.0006, Accuracy: 926/937 (98.8260%)
___Train Local_Simple,  epoch 135, local model 92, internal_epoch   2,  Average loss: 0.0002, Accuracy: 935/937 (99.7866%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1810, Accuracy: 9401/10000 (94.0100%)
___Train Local_Simple,  epoch 135, local model 8, internal_epoch   1,  Average loss: 0.0004, Accuracy: 630/633 (99.5261%)
___Train Local_Simple,  epoch 135, local model 8, internal_epoch   2,  Average loss: 0.0002, Accuracy: 631/633 (99.6840%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0516, Accuracy: 9834/10000 (98.3400%)
poison local model 70 index 1
___Train Local_Simple,  epoch 135, local model 70, internal_epoch   1,  Average loss: 0.0008, Accuracy: 709/724 (97.9282%)
___Train Local_Simple,  epoch 135, local model 70, internal_epoch   2,  Average loss: 0.0004, Accuracy: 719/724 (99.3094%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1509, Accuracy: 9537/10000 (95.3700%)
___Train Local_Simple,  epoch 135, local model 84, internal_epoch   1,  Average loss: 0.0010, Accuracy: 1226/1246 (98.3949%)
___Train Local_Simple,  epoch 135, local model 84, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1234/1246 (99.0369%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0696, Accuracy: 9790/10000 (97.9000%)
___Train Local_Simple,  epoch 135, local model 35, internal_epoch   1,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Train Local_Simple,  epoch 135, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0511, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 135, local model 9, internal_epoch   1,  Average loss: 0.0003, Accuracy: 431/436 (98.8532%)
___Train Local_Simple,  epoch 135, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1513, Accuracy: 9615/10000 (96.1500%)
poison local model 22 index 2
___Train Local_Simple,  epoch 135, local model 22, internal_epoch   1,  Average loss: 0.0009, Accuracy: 575/583 (98.6278%)
___Train Local_Simple,  epoch 135, local model 22, internal_epoch   2,  Average loss: 0.0004, Accuracy: 578/583 (99.1424%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1487, Accuracy: 9561/10000 (95.6100%)
___Train Local_Simple,  epoch 135, local model 90, internal_epoch   1,  Average loss: 0.0008, Accuracy: 671/683 (98.2430%)
___Train Local_Simple,  epoch 135, local model 90, internal_epoch   2,  Average loss: 0.0003, Accuracy: 679/683 (99.4143%)
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.1799, Accuracy: 9406/10000 (94.0600%)
time spent on training: 57.92035722732544
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 70, 22]
base_p: [-0.00076166  0.0003049   0.00143642 ... -0.00504082 -0.00078399
  0.00016549]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 5, 8]
layer1_inf_time: 3.234130859375
[PAIRWISE] pred_attackers_indx:  [0 4 5 7 9]
layer2_inf_t: 151.2412109375
assumed final_attacker_idxs:  [0 2 4 5 7 8 9]
final_attacker_idxs is: [0 2 4 5 7 8 9]
g_attacker_idxs: [13 92 70 84  9 22 90]
g_normal_idxs: [77  8 35]
filtered_attacker_idxs: [0, 2, 4, 5, 8]
final_attacker_idxs are: [0, 2, 4, 5, 8]
num_dps: [734, 589, 937, 633, 724, 1246, 499, 436, 583, 683]
Starting performing KrMLRFL...
Num data points: [734, 589, 937, 633, 724, 1246, 499, 436, 583, 683]
Num selected data points: [589 633 499 436 683]
The chosen ones are users: [1, 3, 6, 7, 9], which are global users: [77, 8, 35, 9, 90]
___Test Local_Simple poisoned: False, epoch: 135: Average loss: 0.0349, Accuracy: 9886/10000 (98.8600%)
epoch_acc: 98.86
___Test Local_Simple poisoned: True, epoch: 135: Average loss: 14.0071, Accuracy: 9/8968 (0.1004%)
Done in 230.60102462768555 sec.
Server Epoch:136 choose agents : [11, 77, 46, 32, 88, 6, 67, 15, 4, 66].
poison local model 11 index 0
___Train Local_Simple,  epoch 136, local model 11, internal_epoch   1,  Average loss: 0.0008, Accuracy: 635/645 (98.4496%)
___Train Local_Simple,  epoch 136, local model 11, internal_epoch   2,  Average loss: 0.0013, Accuracy: 628/645 (97.3643%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1244, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch 136, local model 77, internal_epoch   1,  Average loss: 0.0004, Accuracy: 588/589 (99.8302%)
___Train Local_Simple,  epoch 136, local model 77, internal_epoch   2,  Average loss: 0.0002, Accuracy: 587/589 (99.6604%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0444, Accuracy: 9871/10000 (98.7100%)
___Train Local_Simple,  epoch 136, local model 46, internal_epoch   1,  Average loss: 0.0009, Accuracy: 699/710 (98.4507%)
___Train Local_Simple,  epoch 136, local model 46, internal_epoch   2,  Average loss: 0.0007, Accuracy: 701/710 (98.7324%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1949, Accuracy: 9358/10000 (93.5800%)
___Train Local_Simple,  epoch 136, local model 32, internal_epoch   1,  Average loss: 0.0002, Accuracy: 975/977 (99.7953%)
___Train Local_Simple,  epoch 136, local model 32, internal_epoch   2,  Average loss: 0.0001, Accuracy: 976/977 (99.8976%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0747, Accuracy: 9776/10000 (97.7600%)
___Train Local_Simple,  epoch 136, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 525/530 (99.0566%)
___Train Local_Simple,  epoch 136, local model 88, internal_epoch   2,  Average loss: 0.0003, Accuracy: 526/530 (99.2453%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.1149, Accuracy: 9643/10000 (96.4300%)
___Train Local_Simple,  epoch 136, local model 6, internal_epoch   1,  Average loss: 0.0003, Accuracy: 611/615 (99.3496%)
___Train Local_Simple,  epoch 136, local model 6, internal_epoch   2,  Average loss: 0.0002, Accuracy: 612/615 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0677, Accuracy: 9782/10000 (97.8200%)
___Train Local_Simple,  epoch 136, local model 67, internal_epoch   1,  Average loss: 0.0001, Accuracy: 998/998 (100.0000%)
___Train Local_Simple,  epoch 136, local model 67, internal_epoch   2,  Average loss: 0.0000, Accuracy: 998/998 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0687, Accuracy: 9802/10000 (98.0200%)
___Train Local_Simple,  epoch 136, local model 15, internal_epoch   1,  Average loss: 0.0003, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch 136, local model 15, internal_epoch   2,  Average loss: 0.0001, Accuracy: 400/401 (99.7506%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0532, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 136, local model 4, internal_epoch   1,  Average loss: 0.0003, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch 136, local model 4, internal_epoch   2,  Average loss: 0.0000, Accuracy: 658/658 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0851, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch 136, local model 66, internal_epoch   1,  Average loss: 0.0006, Accuracy: 651/660 (98.6364%)
___Train Local_Simple,  epoch 136, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 653/660 (98.9394%)
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0894, Accuracy: 9695/10000 (96.9500%)
time spent on training: 43.691479206085205
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11]
base_p: [ 2.4449080e-04  3.2595173e-04 -3.1141564e-04 ...  5.2154064e-07
 -1.6396344e-03  3.5835803e-04]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 8, 9]
layer1_inf_time: 3.015380859375
[PAIRWISE] pred_attackers_indx:  [0 2 7 9]
layer2_inf_t: 29.148681640625
assumed final_attacker_idxs:  [0 2 4 7 8 9]
final_attacker_idxs is: [0 2 4 7 8 9]
g_attacker_idxs: [11 46 88 15  4 66]
g_normal_idxs: [77 32  6 67]
filtered_attacker_idxs: [0, 2, 4, 8, 9]
final_attacker_idxs are: [0, 2, 4, 8, 9]
num_dps: [645, 589, 710, 977, 530, 615, 998, 401, 658, 660]
Num data points: [645, 589, 710, 977, 530, 615, 998, 401, 658, 660]
Num selected data points: [589 977 615 998 401]
The chosen ones are users: [1, 3, 5, 6, 7], which are global users: [77, 32, 6, 67, 15]
___Test Local_Simple poisoned: False, epoch: 136: Average loss: 0.0394, Accuracy: 9879/10000 (98.7900%)
epoch_acc: 98.79
___Test Local_Simple poisoned: True, epoch: 136: Average loss: 14.4872, Accuracy: 12/8968 (0.1338%)
Done in 223.2540636062622 sec.
Server Epoch:137 choose agents : [16, 42, 69, 68, 41, 61, 82, 45, 15, 21].
poison local model 16 index 0
___Train Local_Simple,  epoch 137, local model 16, internal_epoch   1,  Average loss: 0.0008, Accuracy: 901/915 (98.4699%)
___Train Local_Simple,  epoch 137, local model 16, internal_epoch   2,  Average loss: 0.0005, Accuracy: 905/915 (98.9071%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0674, Accuracy: 9767/10000 (97.6700%)
poison local model 42 index 1
___Train Local_Simple,  epoch 137, local model 42, internal_epoch   1,  Average loss: 0.0006, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 137, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0596, Accuracy: 9816/10000 (98.1600%)
___Train Local_Simple,  epoch 137, local model 69, internal_epoch   1,  Average loss: 0.0003, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 137, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0790, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 137, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 137, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0528, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 137, local model 41, internal_epoch   1,  Average loss: 0.0007, Accuracy: 598/606 (98.6799%)
___Train Local_Simple,  epoch 137, local model 41, internal_epoch   2,  Average loss: 0.0001, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.1875, Accuracy: 9401/10000 (94.0100%)
poison local model 61 index 2
___Train Local_Simple,  epoch 137, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 689/699 (98.5694%)
___Train Local_Simple,  epoch 137, local model 61, internal_epoch   2,  Average loss: 0.0003, Accuracy: 694/699 (99.2847%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.1540, Accuracy: 9439/10000 (94.3900%)
___Train Local_Simple,  epoch 137, local model 82, internal_epoch   1,  Average loss: 0.0002, Accuracy: 712/713 (99.8597%)
___Train Local_Simple,  epoch 137, local model 82, internal_epoch   2,  Average loss: 0.0001, Accuracy: 709/713 (99.4390%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.2162, Accuracy: 9316/10000 (93.1600%)
poison local model 45 index 3
___Train Local_Simple,  epoch 137, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 137, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.1288, Accuracy: 9623/10000 (96.2300%)
___Train Local_Simple,  epoch 137, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch 137, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0428, Accuracy: 9859/10000 (98.5900%)
___Train Local_Simple,  epoch 137, local model 21, internal_epoch   1,  Average loss: 0.0002, Accuracy: 311/312 (99.6795%)
___Train Local_Simple,  epoch 137, local model 21, internal_epoch   2,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [16, 42, 61, 45]
base_p: [ 0.0012138   0.00019497  0.00289756 ... -0.00030285 -0.00093278
  0.00042167]
[T_SCORE] attacker_local_idxs is:  [0, 1, 4, 5, 7]
layer1_inf_time: 2.61572265625
[PAIRWISE] pred_attackers_indx:  [0 4 7]
layer2_inf_t: 30.9013671875
assumed final_attacker_idxs:  [0 1 4 5 7]
final_attacker_idxs is: [0 1 4 5 7]
g_attacker_idxs: [16 42 41 61 45]
g_normal_idxs: [69 68 82 15 21]
filtered_attacker_idxs: [0, 1, 5, 7]
final_attacker_idxs are: [0, 1, 5, 7]
num_dps: [915, 236, 256, 494, 606, 699, 713, 628, 401, 312]
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0627, Accuracy: 9813/10000 (98.1300%)
time spent on training: 79.21517610549927
Starting performing KrMLRFL...
Num data points: [915, 236, 256, 494, 606, 699, 713, 628, 401, 312]
Num selected data points: [256 494 606 713 401 312]
The chosen ones are users: [2, 3, 4, 6, 8, 9], which are global users: [69, 68, 41, 82, 15, 21]
___Test Local_Simple poisoned: False, epoch: 137: Average loss: 0.0327, Accuracy: 9891/10000 (98.9100%)
epoch_acc: 98.91
___Test Local_Simple poisoned: True, epoch: 137: Average loss: 14.2182, Accuracy: 10/8968 (0.1115%)
Done in 260.3048758506775 sec.
Server Epoch:138 choose agents : [54, 24, 11, 9, 53, 63, 78, 93, 61, 45].
___Train Local_Simple,  epoch 138, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 517/519 (99.6146%)
___Train Local_Simple,  epoch 138, local model 54, internal_epoch   2,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.1105, Accuracy: 9645/10000 (96.4500%)
___Train Local_Simple,  epoch 138, local model 24, internal_epoch   1,  Average loss: 0.0002, Accuracy: 376/379 (99.2084%)
___Train Local_Simple,  epoch 138, local model 24, internal_epoch   2,  Average loss: 0.0002, Accuracy: 378/379 (99.7361%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0496, Accuracy: 9844/10000 (98.4400%)
poison local model 11 index 0
___Train Local_Simple,  epoch 138, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 636/645 (98.6047%)
___Train Local_Simple,  epoch 138, local model 11, internal_epoch   2,  Average loss: 0.0004, Accuracy: 639/645 (99.0698%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.1305, Accuracy: 9619/10000 (96.1900%)
___Train Local_Simple,  epoch 138, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 138, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0860, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 138, local model 53, internal_epoch   1,  Average loss: 0.0008, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 138, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.2550, Accuracy: 9212/10000 (92.1200%)
poison local model 63 index 1
___Train Local_Simple,  epoch 138, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 875/889 (98.4252%)
___Train Local_Simple,  epoch 138, local model 63, internal_epoch   2,  Average loss: 0.0006, Accuracy: 878/889 (98.7627%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0497, Accuracy: 9840/10000 (98.4000%)
___Train Local_Simple,  epoch 138, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 138, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0518, Accuracy: 9828/10000 (98.2800%)
poison local model 93 index 2
___Train Local_Simple,  epoch 138, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 620/623 (99.5185%)
___Train Local_Simple,  epoch 138, local model 93, internal_epoch   2,  Average loss: 0.0002, Accuracy: 622/623 (99.8395%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.2249, Accuracy: 9395/10000 (93.9500%)
poison local model 61 index 3
___Train Local_Simple,  epoch 138, local model 61, internal_epoch   1,  Average loss: 0.0008, Accuracy: 691/699 (98.8555%)
___Train Local_Simple,  epoch 138, local model 61, internal_epoch   2,  Average loss: 0.0012, Accuracy: 683/699 (97.7110%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.1415, Accuracy: 9527/10000 (95.2700%)
poison local model 45 index 0
___Train Local_Simple,  epoch 138, local model 45, internal_epoch   1,  Average loss: 0.0010, Accuracy: 619/628 (98.5669%)
___Train Local_Simple,  epoch 138, local model 45, internal_epoch   2,  Average loss: 0.0008, Accuracy: 621/628 (98.8854%)
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.1470, Accuracy: 9586/10000 (95.8600%)
time spent on training: 66.45591926574707
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [11, 63, 93, 61, 45]
base_p: [ 0.00182151  0.00011479  0.00074508 ... -0.00280756  0.00070037
  0.00024755]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 8, 9]
layer1_inf_time: 3.905517578125
[PAIRWISE] pred_attackers_indx:  [2 7 9]
layer2_inf_t: 156.506591796875
assumed final_attacker_idxs:  [2 4 5 7 8 9]
final_attacker_idxs is: [2 4 5 7 8 9]
g_attacker_idxs: [11 53 63 93 61 45]
g_normal_idxs: [54 24  9 78]
filtered_attacker_idxs: [2, 4, 5, 7, 8, 9]
final_attacker_idxs are: [2, 4, 5, 7, 8, 9]
num_dps: [519, 379, 645, 436, 739, 889, 303, 623, 699, 628]
Starting performing KrMLRFL...
Num data points: [519, 379, 645, 436, 739, 889, 303, 623, 699, 628]
Num selected data points: [519 379 436 303]
The chosen ones are users: [0, 1, 3, 6], which are global users: [54, 24, 9, 78]
___Test Local_Simple poisoned: False, epoch: 138: Average loss: 0.0432, Accuracy: 9868/10000 (98.6800%)
epoch_acc: 98.68
___Test Local_Simple poisoned: True, epoch: 138: Average loss: 14.0978, Accuracy: 13/8968 (0.1450%)
Done in 209.15185141563416 sec.
Server Epoch:139 choose agents : [23, 48, 95, 57, 33, 52, 35, 60, 12, 65].
___Train Local_Simple,  epoch 139, local model 23, internal_epoch   1,  Average loss: 0.0003, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 139, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0593, Accuracy: 9812/10000 (98.1200%)
___Train Local_Simple,  epoch 139, local model 48, internal_epoch   1,  Average loss: 0.0003, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch 139, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0857, Accuracy: 9724/10000 (97.2400%)
___Train Local_Simple,  epoch 139, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Train Local_Simple,  epoch 139, local model 95, internal_epoch   2,  Average loss: 0.0006, Accuracy: 600/602 (99.6678%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.8802, Accuracy: 8374/10000 (83.7400%)
___Train Local_Simple,  epoch 139, local model 57, internal_epoch   1,  Average loss: 0.0006, Accuracy: 338/343 (98.5423%)
___Train Local_Simple,  epoch 139, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 343/343 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.2103, Accuracy: 9437/10000 (94.3700%)
___Train Local_Simple,  epoch 139, local model 33, internal_epoch   1,  Average loss: 0.0007, Accuracy: 613/623 (98.3949%)
___Train Local_Simple,  epoch 139, local model 33, internal_epoch   2,  Average loss: 0.0008, Accuracy: 614/623 (98.5554%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.1109, Accuracy: 9652/10000 (96.5200%)
poison local model 52 index 0
___Train Local_Simple,  epoch 139, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 139, local model 52, internal_epoch   2,  Average loss: 0.0007, Accuracy: 250/253 (98.8142%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0617, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 139, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 139, local model 35, internal_epoch   2,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.1196, Accuracy: 9672/10000 (96.7200%)
___Train Local_Simple,  epoch 139, local model 60, internal_epoch   1,  Average loss: 0.0009, Accuracy: 333/338 (98.5207%)
___Train Local_Simple,  epoch 139, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 336/338 (99.4083%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0773, Accuracy: 9754/10000 (97.5400%)
___Train Local_Simple,  epoch 139, local model 12, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1140/1160 (98.2759%)
___Train Local_Simple,  epoch 139, local model 12, internal_epoch   2,  Average loss: 0.0008, Accuracy: 1150/1160 (99.1379%)
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.3595, Accuracy: 9038/10000 (90.3800%)
___Train Local_Simple,  epoch 139, local model 65, internal_epoch   1,  Average loss: 0.0003, Accuracy: 370/371 (99.7305%)
___Train Local_Simple,  epoch 139, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 0.00081883  0.00018539  0.00020463 ... -0.00277723 -0.00775769
 -0.00055448]
[T_SCORE] attacker_local_idxs is:  [2, 3, 4, 5, 8]
layer1_inf_time: 3.475341796875
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0776, Accuracy: 9775/10000 (97.7500%)
time spent on training: 41.960288524627686
Starting performing KrMLRFL...
Num data points: [293, 448, 602, 343, 623, 253, 499, 338, 1160, 371]
Num selected data points: [293 448 343 499 338 371]
The chosen ones are users: [0, 1, 3, 6, 7, 9], which are global users: [23, 48, 57, 35, 60, 65]
[PAIRWISE] pred_attackers_indx:  [2 3 4 8]
layer2_inf_t: 150.299560546875
assumed final_attacker_idxs:  [2 3 4 5 8]
final_attacker_idxs is: [2 3 4 5 8]
g_attacker_idxs: [95 57 33 52 12]
g_normal_idxs: [23 48 35 60 65]
filtered_attacker_idxs: [2, 4, 5, 8]
final_attacker_idxs are: [2, 4, 5, 8]
num_dps: [293, 448, 602, 343, 623, 253, 499, 338, 1160, 371]
epoch_acc: 98.71
___Test Local_Simple poisoned: False, epoch: 139: Average loss: 0.0411, Accuracy: 9871/10000 (98.7100%)
___Test Local_Simple poisoned: True, epoch: 139: Average loss: 13.8267, Accuracy: 25/8968 (0.2788%)
Done in 188.1888587474823 sec.
Server Epoch:140 choose agents : [52, 37, 2, 77, 29, 53, 22, 26, 57, 16].
poison local model 52 index 0
___Train Local_Simple,  epoch 140, local model 52, internal_epoch   1,  Average loss: 0.0009, Accuracy: 250/253 (98.8142%)
___Train Local_Simple,  epoch 140, local model 52, internal_epoch   2,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.1192, Accuracy: 9628/10000 (96.2800%)
___Train Local_Simple,  epoch 140, local model 37, internal_epoch   1,  Average loss: 0.0004, Accuracy: 850/860 (98.8372%)
___Train Local_Simple,  epoch 140, local model 37, internal_epoch   2,  Average loss: 0.0006, Accuracy: 846/860 (98.3721%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0855, Accuracy: 9709/10000 (97.0900%)
poison local model 2 index 1
___Train Local_Simple,  epoch 140, local model 2, internal_epoch   1,  Average loss: 0.0010, Accuracy: 539/548 (98.3577%)
___Train Local_Simple,  epoch 140, local model 2, internal_epoch   2,  Average loss: 0.0002, Accuracy: 547/548 (99.8175%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.1567, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch 140, local model 77, internal_epoch   1,  Average loss: 0.0004, Accuracy: 586/589 (99.4907%)
___Train Local_Simple,  epoch 140, local model 77, internal_epoch   2,  Average loss: 0.0001, Accuracy: 588/589 (99.8302%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0472, Accuracy: 9862/10000 (98.6200%)
___Train Local_Simple,  epoch 140, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 998/1002 (99.6008%)
___Train Local_Simple,  epoch 140, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 999/1002 (99.7006%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0862, Accuracy: 9734/10000 (97.3400%)
___Train Local_Simple,  epoch 140, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 734/739 (99.3234%)
___Train Local_Simple,  epoch 140, local model 53, internal_epoch   2,  Average loss: 0.0003, Accuracy: 737/739 (99.7294%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.1533, Accuracy: 9552/10000 (95.5200%)
poison local model 22 index 2
___Train Local_Simple,  epoch 140, local model 22, internal_epoch   1,  Average loss: 0.0006, Accuracy: 576/583 (98.7993%)
___Train Local_Simple,  epoch 140, local model 22, internal_epoch   2,  Average loss: 0.0001, Accuracy: 583/583 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0824, Accuracy: 9738/10000 (97.3800%)
poison local model 26 index 3
___Train Local_Simple,  epoch 140, local model 26, internal_epoch   1,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Train Local_Simple,  epoch 140, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0521, Accuracy: 9837/10000 (98.3700%)
___Train Local_Simple,  epoch 140, local model 57, internal_epoch   1,  Average loss: 0.0003, Accuracy: 341/343 (99.4169%)
___Train Local_Simple,  epoch 140, local model 57, internal_epoch   2,  Average loss: 0.0001, Accuracy: 342/343 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0743, Accuracy: 9786/10000 (97.8600%)
poison local model 16 index 0
___Train Local_Simple,  epoch 140, local model 16, internal_epoch   1,  Average loss: 0.0007, Accuracy: 904/915 (98.7978%)
___Train Local_Simple,  epoch 140, local model 16, internal_epoch   2,  Average loss: 0.0002, Accuracy: 910/915 (99.4536%)
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0676, Accuracy: 9803/10000 (98.0300%)
time spent on training: 62.484371185302734
Starting performing KrMLRFL...
Num data points: [253, 860, 548, 589, 1002, 739, 583, 554, 343, 915]
Num selected data points: [ 589 1002  343]
The chosen ones are users: [3, 4, 8], which are global users: [77, 29, 57]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 2, 22, 26, 16]
base_p: [ 0.00061898  0.00026272  0.00012149 ...  0.0005497  -0.00069597
  0.00017874]
[T_SCORE] attacker_local_idxs is:  [1, 2, 5, 6, 7, 9]
layer1_inf_time: 3.467529296875
[PAIRWISE] pred_attackers_indx:  [0 6 9]
layer2_inf_t: 550.037353515625
assumed final_attacker_idxs:  [0 1 2 5 6 7 9]
final_attacker_idxs is: [0 1 2 5 6 7 9]
g_attacker_idxs: [52 37  2 53 22 26 16]
g_normal_idxs: [77 29 57]
filtered_attacker_idxs: [0, 1, 2, 5, 6, 7, 9]
final_attacker_idxs are: [0, 1, 2, 5, 6, 7, 9]
num_dps: [253, 860, 548, 589, 1002, 739, 583, 554, 343, 915]
epoch_acc: 98.58
___Test Local_Simple poisoned: False, epoch: 140: Average loss: 0.0433, Accuracy: 9858/10000 (98.5800%)
___Test Local_Simple poisoned: True, epoch: 140: Average loss: 13.2573, Accuracy: 30/8968 (0.3345%)
Done in 245.4633195400238 sec.
Server Epoch:141 choose agents : [99, 14, 0, 96, 26, 72, 51, 16, 25, 7].
___Train Local_Simple,  epoch 141, local model 99, internal_epoch   1,  Average loss: 0.0002, Accuracy: 376/377 (99.7347%)
___Train Local_Simple,  epoch 141, local model 99, internal_epoch   2,  Average loss: 0.0000, Accuracy: 377/377 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0424, Accuracy: 9872/10000 (98.7200%)
___Train Local_Simple,  epoch 141, local model 14, internal_epoch   1,  Average loss: 0.0004, Accuracy: 371/376 (98.6702%)
___Train Local_Simple,  epoch 141, local model 14, internal_epoch   2,  Average loss: 0.0004, Accuracy: 373/376 (99.2021%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0530, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 141, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 430/435 (98.8506%)
___Train Local_Simple,  epoch 141, local model 0, internal_epoch   2,  Average loss: 0.0005, Accuracy: 431/435 (99.0805%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0729, Accuracy: 9776/10000 (97.7600%)
___Train Local_Simple,  epoch 141, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 664/672 (98.8095%)
___Train Local_Simple,  epoch 141, local model 96, internal_epoch   2,  Average loss: 0.0001, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.1455, Accuracy: 9548/10000 (95.4800%)
poison local model 26 index 0
___Train Local_Simple,  epoch 141, local model 26, internal_epoch   1,  Average loss: 0.0002, Accuracy: 552/554 (99.6390%)
___Train Local_Simple,  epoch 141, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 553/554 (99.8195%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0528, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 141, local model 72, internal_epoch   1,  Average loss: 0.0001, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 141, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0442, Accuracy: 9863/10000 (98.6300%)
poison local model 51 index 1
___Train Local_Simple,  epoch 141, local model 51, internal_epoch   1,  Average loss: 0.0008, Accuracy: 559/568 (98.4155%)
___Train Local_Simple,  epoch 141, local model 51, internal_epoch   2,  Average loss: 0.0002, Accuracy: 567/568 (99.8239%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.1022, Accuracy: 9676/10000 (96.7600%)
poison local model 16 index 2
___Train Local_Simple,  epoch 141, local model 16, internal_epoch   1,  Average loss: 0.0011, Accuracy: 902/915 (98.5792%)
___Train Local_Simple,  epoch 141, local model 16, internal_epoch   2,  Average loss: 0.0005, Accuracy: 907/915 (99.1257%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0790, Accuracy: 9754/10000 (97.5400%)
___Train Local_Simple,  epoch 141, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 643/647 (99.3818%)
___Train Local_Simple,  epoch 141, local model 25, internal_epoch   2,  Average loss: 0.0004, Accuracy: 643/647 (99.3818%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.1792, Accuracy: 9408/10000 (94.0800%)
poison local model 7 index 3
___Train Local_Simple,  epoch 141, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 141, local model 7, internal_epoch   2,  Average loss: 0.0003, Accuracy: 416/418 (99.5215%)
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0750, Accuracy: 9750/10000 (97.5000%)
time spent on training: 59.62589502334595
Starting performing KrMLRFL...
Num data points: [377, 376, 435, 672, 554, 731, 568, 915, 647, 418]
Num selected data points: [377 376 435 731 647]
The chosen ones are users: [0, 1, 2, 5, 8], which are global users: [99, 14, 0, 72, 25]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 51, 16, 7]
base_p: [ 1.6793162e-03  2.1575391e-04  1.4748760e-03 ...  1.0985583e-03
 -9.6023083e-05  1.5226752e-04]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 9]
layer1_inf_time: 2.27685546875
[PAIRWISE] pred_attackers_indx:  [2 3 4 6 7 9]
layer2_inf_t: 51.369873046875
assumed final_attacker_idxs:  [2 3 4 6 7 9]
final_attacker_idxs is: [2 3 4 6 7 9]
g_attacker_idxs: [ 0 96 26 51 16  7]
g_normal_idxs: [99 14 72 25]
filtered_attacker_idxs: [3, 4, 6, 7, 9]
final_attacker_idxs are: [3, 4, 6, 7, 9]
num_dps: [377, 376, 435, 672, 554, 731, 568, 915, 647, 418]
epoch_acc: 98.95
___Test Local_Simple poisoned: False, epoch: 141: Average loss: 0.0322, Accuracy: 9895/10000 (98.9500%)
___Test Local_Simple poisoned: True, epoch: 141: Average loss: 13.4597, Accuracy: 23/8968 (0.2565%)
Done in 201.66607451438904 sec.
Server Epoch:142 choose agents : [4, 10, 57, 65, 81, 72, 58, 68, 15, 86].
___Train Local_Simple,  epoch 142, local model 4, internal_epoch   1,  Average loss: 0.0005, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch 142, local model 4, internal_epoch   2,  Average loss: 0.0002, Accuracy: 654/658 (99.3921%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.1283, Accuracy: 9609/10000 (96.0900%)
___Train Local_Simple,  epoch 142, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 888/892 (99.5516%)
___Train Local_Simple,  epoch 142, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.1331, Accuracy: 9599/10000 (95.9900%)
___Train Local_Simple,  epoch 142, local model 57, internal_epoch   1,  Average loss: 0.0002, Accuracy: 341/343 (99.4169%)
___Train Local_Simple,  epoch 142, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 342/343 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0674, Accuracy: 9786/10000 (97.8600%)
___Train Local_Simple,  epoch 142, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 371/371 (100.0000%)
___Train Local_Simple,  epoch 142, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0476, Accuracy: 9857/10000 (98.5700%)
poison local model 81 index 0
___Train Local_Simple,  epoch 142, local model 81, internal_epoch   1,  Average loss: 0.0002, Accuracy: 1223/1227 (99.6740%)
___Train Local_Simple,  epoch 142, local model 81, internal_epoch   2,  Average loss: 0.0002, Accuracy: 1222/1227 (99.5925%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.4153, Accuracy: 9112/10000 (91.1200%)
___Train Local_Simple,  epoch 142, local model 72, internal_epoch   1,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Train Local_Simple,  epoch 142, local model 72, internal_epoch   2,  Average loss: 0.0000, Accuracy: 731/731 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0424, Accuracy: 9870/10000 (98.7000%)
___Train Local_Simple,  epoch 142, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 275/276 (99.6377%)
___Train Local_Simple,  epoch 142, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0574, Accuracy: 9810/10000 (98.1000%)
___Train Local_Simple,  epoch 142, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 142, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0759, Accuracy: 9761/10000 (97.6100%)
___Train Local_Simple,  epoch 142, local model 15, internal_epoch   1,  Average loss: 0.0002, Accuracy: 399/401 (99.5012%)
___Train Local_Simple,  epoch 142, local model 15, internal_epoch   2,  Average loss: 0.0000, Accuracy: 401/401 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0370, Accuracy: 9882/10000 (98.8200%)
___Train Local_Simple,  epoch 142, local model 86, internal_epoch   1,  Average loss: 0.0003, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 142, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0730, Accuracy: 9782/10000 (97.8200%)
time spent on training: 38.031620264053345
Starting performing KrMLRFL...
Num data points: [658, 892, 343, 371, 1227, 731, 276, 494, 401, 250]
Num selected data points: [892 343 371 731 276 494 401 250]
The chosen ones are users: [1, 2, 3, 5, 6, 7, 8, 9], which are global users: [10, 57, 65, 72, 58, 68, 15, 86]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [81]
base_p: [ 0.00048786  0.00022327  0.00021787 ...  0.00170591 -0.00048354
 -0.00216129]
[T_SCORE] attacker_local_idxs is:  [0, 2, 4, 7, 8]
layer1_inf_time: 4.3876953125
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 112.55029296875
assumed final_attacker_idxs:  [0 2 4 7 8]
final_attacker_idxs is: [0 2 4 7 8]
g_attacker_idxs: [ 4 57 81 68 15]
g_normal_idxs: [10 65 72 58 86]
filtered_attacker_idxs: [0, 4]
final_attacker_idxs are: [0, 4]
num_dps: [658, 892, 343, 371, 1227, 731, 276, 494, 401, 250]
___Test Local_Simple poisoned: False, epoch: 142: Average loss: 0.0320, Accuracy: 9900/10000 (99.0000%)
epoch_acc: 99.0
___Test Local_Simple poisoned: True, epoch: 142: Average loss: 15.0000, Accuracy: 11/8968 (0.1227%)
Done in 180.94982504844666 sec.
Server Epoch:143 choose agents : [24, 18, 7, 23, 70, 50, 51, 38, 10, 67].
___Train Local_Simple,  epoch 143, local model 24, internal_epoch   1,  Average loss: 0.0002, Accuracy: 377/379 (99.4723%)
___Train Local_Simple,  epoch 143, local model 24, internal_epoch   2,  Average loss: 0.0000, Accuracy: 379/379 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0500, Accuracy: 9844/10000 (98.4400%)
___Train Local_Simple,  epoch 143, local model 18, internal_epoch   1,  Average loss: 0.0015, Accuracy: 454/459 (98.9107%)
___Train Local_Simple,  epoch 143, local model 18, internal_epoch   2,  Average loss: 0.0024, Accuracy: 442/459 (96.2963%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.6588, Accuracy: 8413/10000 (84.1300%)
poison local model 7 index 0
___Train Local_Simple,  epoch 143, local model 7, internal_epoch   1,  Average loss: 0.0004, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 143, local model 7, internal_epoch   2,  Average loss: 0.0002, Accuracy: 417/418 (99.7608%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0672, Accuracy: 9784/10000 (97.8400%)
___Train Local_Simple,  epoch 143, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 143, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0514, Accuracy: 9832/10000 (98.3200%)
poison local model 70 index 1
___Train Local_Simple,  epoch 143, local model 70, internal_epoch   1,  Average loss: 0.0003, Accuracy: 720/724 (99.4475%)
___Train Local_Simple,  epoch 143, local model 70, internal_epoch   2,  Average loss: 0.0001, Accuracy: 722/724 (99.7238%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.1929, Accuracy: 9478/10000 (94.7800%)
___Train Local_Simple,  epoch 143, local model 50, internal_epoch   1,  Average loss: 0.0008, Accuracy: 467/474 (98.5232%)
___Train Local_Simple,  epoch 143, local model 50, internal_epoch   2,  Average loss: 0.0002, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.1068, Accuracy: 9654/10000 (96.5400%)
poison local model 51 index 2
___Train Local_Simple,  epoch 143, local model 51, internal_epoch   1,  Average loss: 0.0010, Accuracy: 561/568 (98.7676%)
___Train Local_Simple,  epoch 143, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 562/568 (98.9437%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.1555, Accuracy: 9527/10000 (95.2700%)
___Train Local_Simple,  epoch 143, local model 38, internal_epoch   1,  Average loss: 0.0002, Accuracy: 893/895 (99.7765%)
___Train Local_Simple,  epoch 143, local model 38, internal_epoch   2,  Average loss: 0.0003, Accuracy: 893/895 (99.7765%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0894, Accuracy: 9742/10000 (97.4200%)
___Train Local_Simple,  epoch 143, local model 10, internal_epoch   1,  Average loss: 0.0002, Accuracy: 889/892 (99.6637%)
___Train Local_Simple,  epoch 143, local model 10, internal_epoch   2,  Average loss: 0.0006, Accuracy: 881/892 (98.7668%)
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.2239, Accuracy: 9318/10000 (93.1800%)
___Train Local_Simple,  epoch 143, local model 67, internal_epoch   1,  Average loss: 0.0000, Accuracy: 998/998 (100.0000%)
___Train Local_Simple,  epoch 143, local model 67, internal_epoch   2,  Average loss: 0.0000, Accuracy: 998/998 (100.0000%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [7, 70, 51]
base_p: [ 6.8891048e-04  2.3902208e-04  1.0807067e-05 ...  4.5435131e-04
 -2.7276501e-03 -1.0182410e-03]
[T_SCORE] attacker_local_idxs is:  [1, 2, 4, 6, 7]
layer1_inf_time: 2.77392578125
[PAIRWISE] pred_attackers_indx:  [1 5 6 7 8]
layer2_inf_t: 46.9306640625
assumed final_attacker_idxs:  [1 2 4 5 6 7 8]
final_attacker_idxs is: [1 2 4 5 6 7 8]
g_attacker_idxs: [18  7 70 50 51 38 10]
g_normal_idxs: [24 23 67]
filtered_attacker_idxs: [1, 2, 4, 6]
final_attacker_idxs are: [1, 2, 4, 6]
num_dps: [379, 459, 418, 293, 724, 474, 568, 895, 892, 998]
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0529, Accuracy: 9833/10000 (98.3300%)
time spent on training: 46.31663513183594
Starting performing KrMLRFL...
Num data points: [379, 459, 418, 293, 724, 474, 568, 895, 892, 998]
Num selected data points: [379 293 474 895 892 998]
The chosen ones are users: [0, 3, 5, 7, 8, 9], which are global users: [24, 23, 50, 38, 10, 67]
___Test Local_Simple poisoned: False, epoch: 143: Average loss: 0.0370, Accuracy: 9885/10000 (98.8500%)
epoch_acc: 98.85000000000001
___Test Local_Simple poisoned: True, epoch: 143: Average loss: 15.5296, Accuracy: 7/8968 (0.0781%)
Done in 176.29574728012085 sec.
Server Epoch:144 choose agents : [58, 60, 32, 0, 92, 89, 28, 59, 83, 37].
___Train Local_Simple,  epoch 144, local model 58, internal_epoch   1,  Average loss: 0.0003, Accuracy: 275/276 (99.6377%)
___Train Local_Simple,  epoch 144, local model 58, internal_epoch   2,  Average loss: 0.0000, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0566, Accuracy: 9826/10000 (98.2600%)
___Train Local_Simple,  epoch 144, local model 60, internal_epoch   1,  Average loss: 0.0007, Accuracy: 332/338 (98.2249%)
___Train Local_Simple,  epoch 144, local model 60, internal_epoch   2,  Average loss: 0.0003, Accuracy: 337/338 (99.7041%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.2563, Accuracy: 9293/10000 (92.9300%)
___Train Local_Simple,  epoch 144, local model 32, internal_epoch   1,  Average loss: 0.0002, Accuracy: 973/977 (99.5906%)
___Train Local_Simple,  epoch 144, local model 32, internal_epoch   2,  Average loss: 0.0001, Accuracy: 974/977 (99.6929%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0798, Accuracy: 9753/10000 (97.5300%)
___Train Local_Simple,  epoch 144, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 431/435 (99.0805%)
___Train Local_Simple,  epoch 144, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 433/435 (99.5402%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0950, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch 144, local model 92, internal_epoch   1,  Average loss: 0.0002, Accuracy: 933/937 (99.5731%)
___Train Local_Simple,  epoch 144, local model 92, internal_epoch   2,  Average loss: 0.0007, Accuracy: 925/937 (98.7193%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0930, Accuracy: 9702/10000 (97.0200%)
___Train Local_Simple,  epoch 144, local model 89, internal_epoch   1,  Average loss: 0.0005, Accuracy: 487/492 (98.9837%)
___Train Local_Simple,  epoch 144, local model 89, internal_epoch   2,  Average loss: 0.0002, Accuracy: 490/492 (99.5935%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.1769, Accuracy: 9490/10000 (94.9000%)
___Train Local_Simple,  epoch 144, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 144, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0434, Accuracy: 9873/10000 (98.7300%)
___Train Local_Simple,  epoch 144, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 749/760 (98.5526%)
___Train Local_Simple,  epoch 144, local model 59, internal_epoch   2,  Average loss: 0.0007, Accuracy: 752/760 (98.9474%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.4322, Accuracy: 8874/10000 (88.7400%)
___Train Local_Simple,  epoch 144, local model 83, internal_epoch   1,  Average loss: 0.0002, Accuracy: 433/433 (100.0000%)
___Train Local_Simple,  epoch 144, local model 83, internal_epoch   2,  Average loss: 0.0001, Accuracy: 433/433 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0459, Accuracy: 9854/10000 (98.5400%)
___Train Local_Simple,  epoch 144, local model 37, internal_epoch   1,  Average loss: 0.0007, Accuracy: 848/860 (98.6047%)
___Train Local_Simple,  epoch 144, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 854/860 (99.3023%)
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.1270, Accuracy: 9619/10000 (96.1900%)
time spent on training: 33.24743700027466
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [ 0.0005432   0.0002325   0.00130889 ... -0.00010076 -0.00240705
  0.00147308]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 7, 9]
layer1_inf_time: 3.964111328125
[PAIRWISE] pred_attackers_indx:  [3 5 7 9]
layer2_inf_t: 95.132568359375
assumed final_attacker_idxs:  [2 3 4 5 7 9]
final_attacker_idxs is: [2 3 4 5 7 9]
g_attacker_idxs: [32  0 92 89 59 37]
g_normal_idxs: [58 60 28 83]
filtered_attacker_idxs: [2, 4, 5, 7, 9]
final_attacker_idxs are: [2, 4, 5, 7, 9]
num_dps: [276, 338, 977, 435, 937, 492, 501, 760, 433, 860]
Num data points: [276, 338, 977, 435, 937, 492, 501, 760, 433, 860]
Num selected data points: [276 338 435 501 433]
The chosen ones are users: [0, 1, 3, 6, 8], which are global users: [58, 60, 0, 28, 83]
___Test Local_Simple poisoned: False, epoch: 144: Average loss: 0.0333, Accuracy: 9901/10000 (99.0100%)
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: True, epoch: 144: Average loss: 14.7013, Accuracy: 12/8968 (0.1338%)
Done in 152.84700465202332 sec.
Server Epoch:145 choose agents : [39, 76, 61, 79, 92, 12, 85, 45, 89, 74].
___Train Local_Simple,  epoch 145, local model 39, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/257 (99.2218%)
___Train Local_Simple,  epoch 145, local model 39, internal_epoch   2,  Average loss: 0.0000, Accuracy: 257/257 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0464, Accuracy: 9860/10000 (98.6000%)
___Train Local_Simple,  epoch 145, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 145, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0334, Accuracy: 9903/10000 (99.0300%)
poison local model 61 index 0
___Train Local_Simple,  epoch 145, local model 61, internal_epoch   1,  Average loss: 0.0011, Accuracy: 681/699 (97.4249%)
___Train Local_Simple,  epoch 145, local model 61, internal_epoch   2,  Average loss: 0.0006, Accuracy: 689/699 (98.5694%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.3707, Accuracy: 8729/10000 (87.2900%)
___Train Local_Simple,  epoch 145, local model 79, internal_epoch   1,  Average loss: 0.0004, Accuracy: 180/182 (98.9011%)
___Train Local_Simple,  epoch 145, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0415, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 145, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 925/937 (98.7193%)
___Train Local_Simple,  epoch 145, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 928/937 (99.0395%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.1675, Accuracy: 9473/10000 (94.7300%)
___Train Local_Simple,  epoch 145, local model 12, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1146/1160 (98.7931%)
___Train Local_Simple,  epoch 145, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1148/1160 (98.9655%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.3446, Accuracy: 9213/10000 (92.1300%)
poison local model 85 index 1
___Train Local_Simple,  epoch 145, local model 85, internal_epoch   1,  Average loss: 0.0001, Accuracy: 431/431 (100.0000%)
___Train Local_Simple,  epoch 145, local model 85, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0431, Accuracy: 9861/10000 (98.6100%)
poison local model 45 index 2
___Train Local_Simple,  epoch 145, local model 45, internal_epoch   1,  Average loss: 0.0008, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 145, local model 45, internal_epoch   2,  Average loss: 0.0004, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.1019, Accuracy: 9720/10000 (97.2000%)
___Train Local_Simple,  epoch 145, local model 89, internal_epoch   1,  Average loss: 0.0004, Accuracy: 489/492 (99.3902%)
___Train Local_Simple,  epoch 145, local model 89, internal_epoch   2,  Average loss: 0.0000, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.1283, Accuracy: 9626/10000 (96.2600%)
___Train Local_Simple,  epoch 145, local model 74, internal_epoch   1,  Average loss: 0.0005, Accuracy: 553/557 (99.2819%)
___Train Local_Simple,  epoch 145, local model 74, internal_epoch   2,  Average loss: 0.0002, Accuracy: 554/557 (99.4614%)
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0638, Accuracy: 9792/10000 (97.9200%)
time spent on training: 48.1761589050293
Starting performing KrMLRFL...
Num data points: [257, 78, 699, 182, 937, 1160, 431, 628, 492, 557]
Num selected data points: [257  78 182 557]
The chosen ones are users: [0, 1, 3, 9], which are global users: [39, 76, 79, 74]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [61, 85, 45]
base_p: [0.00042978 0.00018743 0.0012939  ... 0.00383322 0.00045022 0.00257806]
[T_SCORE] attacker_local_idxs is:  [2, 4, 5, 6, 7, 8]
layer1_inf_time: 4.269287109375
[PAIRWISE] pred_attackers_indx:  [2 5 7]
layer2_inf_t: 29.879150390625
assumed final_attacker_idxs:  [2 4 5 6 7 8]
final_attacker_idxs is: [2 4 5 6 7 8]
g_attacker_idxs: [61 92 12 85 45 89]
g_normal_idxs: [39 76 79 74]
filtered_attacker_idxs: [2, 4, 5, 6, 7, 8]
final_attacker_idxs are: [2, 4, 5, 6, 7, 8]
num_dps: [257, 78, 699, 182, 937, 1160, 431, 628, 492, 557]
epoch_acc: 98.72999999999999
___Test Local_Simple poisoned: False, epoch: 145: Average loss: 0.0388, Accuracy: 9873/10000 (98.7300%)
___Test Local_Simple poisoned: True, epoch: 145: Average loss: 13.7731, Accuracy: 24/8968 (0.2676%)
Done in 162.52151608467102 sec.
Server Epoch:146 choose agents : [43, 60, 28, 10, 84, 51, 62, 75, 34, 47].
___Train Local_Simple,  epoch 146, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 146, local model 43, internal_epoch   2,  Average loss: 0.0001, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0496, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 146, local model 60, internal_epoch   1,  Average loss: 0.0002, Accuracy: 337/338 (99.7041%)
___Train Local_Simple,  epoch 146, local model 60, internal_epoch   2,  Average loss: 0.0000, Accuracy: 338/338 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0531, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 146, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 146, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0354, Accuracy: 9891/10000 (98.9100%)
___Train Local_Simple,  epoch 146, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 891/892 (99.8879%)
___Train Local_Simple,  epoch 146, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0804, Accuracy: 9743/10000 (97.4300%)
___Train Local_Simple,  epoch 146, local model 84, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1228/1246 (98.5554%)
___Train Local_Simple,  epoch 146, local model 84, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1237/1246 (99.2777%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0725, Accuracy: 9781/10000 (97.8100%)
poison local model 51 index 0
___Train Local_Simple,  epoch 146, local model 51, internal_epoch   1,  Average loss: 0.0009, Accuracy: 564/568 (99.2958%)
___Train Local_Simple,  epoch 146, local model 51, internal_epoch   2,  Average loss: 0.0001, Accuracy: 566/568 (99.6479%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.1380, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch 146, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 146, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 421/423 (99.5272%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0431, Accuracy: 9865/10000 (98.6500%)
___Train Local_Simple,  epoch 146, local model 75, internal_epoch   1,  Average loss: 0.0005, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch 146, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 682/686 (99.4169%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.1142, Accuracy: 9660/10000 (96.6000%)
poison local model 34 index 1
___Train Local_Simple,  epoch 146, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 146, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0937, Accuracy: 9722/10000 (97.2200%)
___Train Local_Simple,  epoch 146, local model 47, internal_epoch   1,  Average loss: 0.0005, Accuracy: 771/776 (99.3557%)
___Train Local_Simple,  epoch 146, local model 47, internal_epoch   2,  Average loss: 0.0022, Accuracy: 740/776 (95.3608%)
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.3333, Accuracy: 9182/10000 (91.8200%)
time spent on training: 43.6385862827301
Starting performing KrMLRFL...
Num data points: [408, 338, 501, 892, 1246, 568, 423, 686, 413, 776]
Num selected data points: [408 501 892 423 686 776]
The chosen ones are users: [0, 2, 3, 6, 7, 9], which are global users: [43, 28, 10, 62, 75, 47]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 34]
base_p: [ 0.00010931  0.00024216 -0.00056508 ...  0.00327064  0.00036443
  0.00152376]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 8, 9]
layer1_inf_time: 2.775634765625
[PAIRWISE] pred_attackers_indx:  [9]
layer2_inf_t: 47.134765625
assumed final_attacker_idxs:  [1 4 5 8 9]
final_attacker_idxs is: [1 4 5 8 9]
g_attacker_idxs: [60 84 51 34 47]
g_normal_idxs: [43 28 10 62 75]
filtered_attacker_idxs: [1, 4, 5, 8]
final_attacker_idxs are: [1, 4, 5, 8]
num_dps: [408, 338, 501, 892, 1246, 568, 423, 686, 413, 776]
epoch_acc: 98.82
___Test Local_Simple poisoned: False, epoch: 146: Average loss: 0.0363, Accuracy: 9882/10000 (98.8200%)
___Test Local_Simple poisoned: True, epoch: 146: Average loss: 15.0217, Accuracy: 7/8968 (0.0781%)
Done in 175.35307836532593 sec.
Server Epoch:147 choose agents : [23, 91, 10, 92, 61, 60, 58, 8, 4, 30].
___Train Local_Simple,  epoch 147, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 147, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0520, Accuracy: 9833/10000 (98.3300%)
poison local model 91 index 0
___Train Local_Simple,  epoch 147, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 147, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0445, Accuracy: 9874/10000 (98.7400%)
___Train Local_Simple,  epoch 147, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 147, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0543, Accuracy: 9822/10000 (98.2200%)
___Train Local_Simple,  epoch 147, local model 92, internal_epoch   1,  Average loss: 0.0005, Accuracy: 930/937 (99.2529%)
___Train Local_Simple,  epoch 147, local model 92, internal_epoch   2,  Average loss: 0.0004, Accuracy: 929/937 (99.1462%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.2987, Accuracy: 9014/10000 (90.1400%)
poison local model 61 index 1
___Train Local_Simple,  epoch 147, local model 61, internal_epoch   1,  Average loss: 0.0009, Accuracy: 689/699 (98.5694%)
___Train Local_Simple,  epoch 147, local model 61, internal_epoch   2,  Average loss: 0.0004, Accuracy: 694/699 (99.2847%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.2869, Accuracy: 8997/10000 (89.9700%)
___Train Local_Simple,  epoch 147, local model 60, internal_epoch   1,  Average loss: 0.0005, Accuracy: 334/338 (98.8166%)
___Train Local_Simple,  epoch 147, local model 60, internal_epoch   2,  Average loss: 0.0002, Accuracy: 336/338 (99.4083%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0949, Accuracy: 9703/10000 (97.0300%)
___Train Local_Simple,  epoch 147, local model 58, internal_epoch   1,  Average loss: 0.0006, Accuracy: 272/276 (98.5507%)
___Train Local_Simple,  epoch 147, local model 58, internal_epoch   2,  Average loss: 0.0001, Accuracy: 276/276 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.1079, Accuracy: 9686/10000 (96.8600%)
___Train Local_Simple,  epoch 147, local model 8, internal_epoch   1,  Average loss: 0.0003, Accuracy: 629/633 (99.3681%)
___Train Local_Simple,  epoch 147, local model 8, internal_epoch   2,  Average loss: 0.0001, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0706, Accuracy: 9787/10000 (97.8700%)
___Train Local_Simple,  epoch 147, local model 4, internal_epoch   1,  Average loss: 0.0004, Accuracy: 653/658 (99.2401%)
___Train Local_Simple,  epoch 147, local model 4, internal_epoch   2,  Average loss: 0.0001, Accuracy: 656/658 (99.6960%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0981, Accuracy: 9698/10000 (96.9800%)
___Train Local_Simple,  epoch 147, local model 30, internal_epoch   1,  Average loss: 0.0002, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch 147, local model 30, internal_epoch   2,  Average loss: 0.0000, Accuracy: 400/400 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.1809, Accuracy: 9469/10000 (94.6900%)
time spent on training: 42.23491191864014
Starting performing KrMLRFL...
Num data points: [293, 256, 892, 937, 699, 338, 276, 633, 658, 400]
Num selected data points: [293 892 276 633 400]
The chosen ones are users: [0, 2, 6, 7, 9], which are global users: [23, 10, 58, 8, 30]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 61]
base_p: [ 0.00046822  0.00020004  0.00041613 ...  0.0007426   0.00087676
 -0.00020304]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 5, 8]
layer1_inf_time: 4.916015625
[PAIRWISE] pred_attackers_indx:  [4]
layer2_inf_t: 132.369873046875
assumed final_attacker_idxs:  [1 3 4 5 8]
final_attacker_idxs is: [1 3 4 5 8]
g_attacker_idxs: [91 92 61 60  4]
g_normal_idxs: [23 10 58  8 30]
filtered_attacker_idxs: [1, 3, 4, 5, 8]
final_attacker_idxs are: [1, 3, 4, 5, 8]
num_dps: [293, 256, 892, 937, 699, 338, 276, 633, 658, 400]
epoch_acc: 98.83
___Test Local_Simple poisoned: False, epoch: 147: Average loss: 0.0386, Accuracy: 9883/10000 (98.8300%)
___Test Local_Simple poisoned: True, epoch: 147: Average loss: 14.8216, Accuracy: 10/8968 (0.1115%)
Done in 184.6461579799652 sec.
Server Epoch:148 choose agents : [44, 12, 8, 23, 62, 21, 55, 96, 46, 69].
___Train Local_Simple,  epoch 148, local model 44, internal_epoch   1,  Average loss: 0.0003, Accuracy: 512/517 (99.0329%)
___Train Local_Simple,  epoch 148, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 516/517 (99.8066%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0659, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 148, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1141/1160 (98.3621%)
___Train Local_Simple,  epoch 148, local model 12, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1152/1160 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.3153, Accuracy: 9277/10000 (92.7700%)
___Train Local_Simple,  epoch 148, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 633/633 (100.0000%)
___Train Local_Simple,  epoch 148, local model 8, internal_epoch   2,  Average loss: 0.0000, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0468, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 148, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 148, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0489, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 148, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 148, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0559, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 148, local model 21, internal_epoch   1,  Average loss: 0.0003, Accuracy: 309/312 (99.0385%)
___Train Local_Simple,  epoch 148, local model 21, internal_epoch   2,  Average loss: 0.0000, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0990, Accuracy: 9705/10000 (97.0500%)
___Train Local_Simple,  epoch 148, local model 55, internal_epoch   1,  Average loss: 0.0005, Accuracy: 349/354 (98.5876%)
___Train Local_Simple,  epoch 148, local model 55, internal_epoch   2,  Average loss: 0.0001, Accuracy: 353/354 (99.7175%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.3095, Accuracy: 9079/10000 (90.7900%)
___Train Local_Simple,  epoch 148, local model 96, internal_epoch   1,  Average loss: 0.0006, Accuracy: 668/672 (99.4048%)
___Train Local_Simple,  epoch 148, local model 96, internal_epoch   2,  Average loss: 0.0002, Accuracy: 670/672 (99.7024%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.1178, Accuracy: 9624/10000 (96.2400%)
___Train Local_Simple,  epoch 148, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 700/710 (98.5915%)
___Train Local_Simple,  epoch 148, local model 46, internal_epoch   2,  Average loss: 0.0004, Accuracy: 701/710 (98.7324%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.1885, Accuracy: 9415/10000 (94.1500%)
___Train Local_Simple,  epoch 148, local model 69, internal_epoch   1,  Average loss: 0.0005, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 148, local model 69, internal_epoch   2,  Average loss: 0.0001, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.1039, Accuracy: 9656/10000 (96.5600%)
time spent on training: 36.660088300704956
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: []
base_p: [-3.9636344e-04  1.9935891e-04 -1.0319948e-03 ...  6.0006976e-05
  2.0920485e-03  8.5557252e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 6, 7, 8]
layer1_inf_time: 6.023681640625
[PAIRWISE] pred_attackers_indx:  [1 6 8]
layer2_inf_t: 341.46728515625
assumed final_attacker_idxs:  [0 1 6 7 8]
final_attacker_idxs is: [0 1 6 7 8]
g_attacker_idxs: [44 12 55 96 46]
g_normal_idxs: [ 8 23 62 21 69]
filtered_attacker_idxs: [1, 7, 8]
final_attacker_idxs are: [1, 7, 8]
num_dps: [517, 1160, 633, 293, 423, 312, 354, 672, 710, 256]
Starting performing KrMLRFL...
Num data points: [517, 1160, 633, 293, 423, 312, 354, 672, 710, 256]
Num selected data points: [517 633 293 423 312 354 256]
The chosen ones are users: [0, 2, 3, 4, 5, 6, 9], which are global users: [44, 8, 23, 62, 21, 55, 69]
epoch_acc: 98.83999999999999
___Test Local_Simple poisoned: False, epoch: 148: Average loss: 0.0367, Accuracy: 9884/10000 (98.8400%)
___Test Local_Simple poisoned: True, epoch: 148: Average loss: 14.4598, Accuracy: 17/8968 (0.1896%)
Done in 201.39749884605408 sec.
Server Epoch:149 choose agents : [79, 19, 31, 41, 50, 9, 29, 42, 88, 71].
___Train Local_Simple,  epoch 149, local model 79, internal_epoch   1,  Average loss: 0.0003, Accuracy: 181/182 (99.4505%)
___Train Local_Simple,  epoch 149, local model 79, internal_epoch   2,  Average loss: 0.0001, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0404, Accuracy: 9881/10000 (98.8100%)
___Train Local_Simple,  epoch 149, local model 19, internal_epoch   1,  Average loss: 0.0004, Accuracy: 203/205 (99.0244%)
___Train Local_Simple,  epoch 149, local model 19, internal_epoch   2,  Average loss: 0.0003, Accuracy: 203/205 (99.0244%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.1225, Accuracy: 9653/10000 (96.5300%)
___Train Local_Simple,  epoch 149, local model 31, internal_epoch   1,  Average loss: 0.0003, Accuracy: 831/835 (99.5210%)
___Train Local_Simple,  epoch 149, local model 31, internal_epoch   2,  Average loss: 0.0002, Accuracy: 830/835 (99.4012%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0615, Accuracy: 9800/10000 (98.0000%)
___Train Local_Simple,  epoch 149, local model 41, internal_epoch   1,  Average loss: 0.0004, Accuracy: 601/606 (99.1749%)
___Train Local_Simple,  epoch 149, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 604/606 (99.6700%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0516, Accuracy: 9836/10000 (98.3600%)
___Train Local_Simple,  epoch 149, local model 50, internal_epoch   1,  Average loss: 0.0004, Accuracy: 469/474 (98.9451%)
___Train Local_Simple,  epoch 149, local model 50, internal_epoch   2,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.1992, Accuracy: 9423/10000 (94.2300%)
___Train Local_Simple,  epoch 149, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 149, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0661, Accuracy: 9801/10000 (98.0100%)
___Train Local_Simple,  epoch 149, local model 29, internal_epoch   1,  Average loss: 0.0001, Accuracy: 1001/1002 (99.9002%)
___Train Local_Simple,  epoch 149, local model 29, internal_epoch   2,  Average loss: 0.0001, Accuracy: 998/1002 (99.6008%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0770, Accuracy: 9738/10000 (97.3800%)
poison local model 42 index 0
___Train Local_Simple,  epoch 149, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 234/236 (99.1525%)
___Train Local_Simple,  epoch 149, local model 42, internal_epoch   2,  Average loss: 0.0001, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0436, Accuracy: 9858/10000 (98.5800%)
___Train Local_Simple,  epoch 149, local model 88, internal_epoch   1,  Average loss: 0.0003, Accuracy: 527/530 (99.4340%)
___Train Local_Simple,  epoch 149, local model 88, internal_epoch   2,  Average loss: 0.0001, Accuracy: 530/530 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.3152, Accuracy: 9166/10000 (91.6600%)
poison local model 71 index 1
___Train Local_Simple,  epoch 149, local model 71, internal_epoch   1,  Average loss: 0.0007, Accuracy: 1366/1384 (98.6994%)
___Train Local_Simple,  epoch 149, local model 71, internal_epoch   2,  Average loss: 0.0004, Accuracy: 1377/1384 (99.4942%)
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.3235, Accuracy: 9018/10000 (90.1800%)
time spent on training: 52.66578221321106
Starting performing KrMLRFL...
Num data points: [182, 205, 835, 606, 474, 436, 1002, 236, 530, 1384]
Num selected data points: [182 205 835 606 474 436]
The chosen ones are users: [0, 1, 2, 3, 4, 5], which are global users: [79, 19, 31, 41, 50, 9]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 71]
base_p: [-7.8387558e-05  2.3405254e-04 -8.2783401e-04 ... -4.4350326e-04
 -2.2466406e-03  7.7547133e-04]
[T_SCORE] attacker_local_idxs is:  [3, 6, 7, 8, 9]
layer1_inf_time: 3.26025390625
[PAIRWISE] pred_attackers_indx:  [9]
layer2_inf_t: 249.080810546875
assumed final_attacker_idxs:  [3 6 7 8 9]
final_attacker_idxs is: [3 6 7 8 9]
g_attacker_idxs: [41 29 42 88 71]
g_normal_idxs: [79 19 31 50  9]
filtered_attacker_idxs: [6, 7, 8, 9]
final_attacker_idxs are: [6, 7, 8, 9]
num_dps: [182, 205, 835, 606, 474, 436, 1002, 236, 530, 1384]
epoch_acc: 99.1
___Test Local_Simple poisoned: False, epoch: 149: Average loss: 0.0312, Accuracy: 9910/10000 (99.1000%)
___Test Local_Simple poisoned: True, epoch: 149: Average loss: 14.7538, Accuracy: 14/8968 (0.1561%)
Done in 188.59457302093506 sec.
Server Epoch:150 choose agents : [45, 46, 81, 9, 23, 32, 10, 68, 55, 80].
poison local model 45 index 0
___Train Local_Simple,  epoch 150, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 615/628 (97.9299%)
___Train Local_Simple,  epoch 150, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 623/628 (99.2038%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.1846, Accuracy: 9425/10000 (94.2500%)
___Train Local_Simple,  epoch 150, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 698/710 (98.3099%)
___Train Local_Simple,  epoch 150, local model 46, internal_epoch   2,  Average loss: 0.0003, Accuracy: 703/710 (99.0141%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.2613, Accuracy: 9216/10000 (92.1600%)
poison local model 81 index 1
___Train Local_Simple,  epoch 150, local model 81, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1214/1227 (98.9405%)
___Train Local_Simple,  epoch 150, local model 81, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1220/1227 (99.4295%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.4831, Accuracy: 8950/10000 (89.5000%)
___Train Local_Simple,  epoch 150, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 150, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0416, Accuracy: 9860/10000 (98.6000%)
___Train Local_Simple,  epoch 150, local model 23, internal_epoch   1,  Average loss: 0.0002, Accuracy: 292/293 (99.6587%)
___Train Local_Simple,  epoch 150, local model 23, internal_epoch   2,  Average loss: 0.0001, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0522, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 150, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 968/977 (99.0788%)
___Train Local_Simple,  epoch 150, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 969/977 (99.1812%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.1084, Accuracy: 9644/10000 (96.4400%)
___Train Local_Simple,  epoch 150, local model 10, internal_epoch   1,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 150, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0407, Accuracy: 9875/10000 (98.7500%)
___Train Local_Simple,  epoch 150, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 491/494 (99.3927%)
___Train Local_Simple,  epoch 150, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0892, Accuracy: 9758/10000 (97.5800%)
___Train Local_Simple,  epoch 150, local model 55, internal_epoch   1,  Average loss: 0.0004, Accuracy: 352/354 (99.4350%)
___Train Local_Simple,  epoch 150, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.2186, Accuracy: 9351/10000 (93.5100%)
___Train Local_Simple,  epoch 150, local model 80, internal_epoch   1,  Average loss: 0.0003, Accuracy: 429/431 (99.5360%)
___Train Local_Simple,  epoch 150, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0696, Accuracy: 9788/10000 (97.8800%)
time spent on training: 46.532803773880005
Starting performing KrMLRFL...
Num data points: [628, 710, 1227, 436, 293, 977, 892, 494, 354, 431]
Num selected data points: [436 293 892 494 354 431]
The chosen ones are users: [3, 4, 6, 7, 8, 9], which are global users: [9, 23, 10, 68, 55, 80]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45, 81]
base_p: [ 0.00082981  0.00023776  0.00142869 ...  0.00054455  0.00161897
 -0.00145078]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 5, 9]
layer1_inf_time: 4.87109375
[PAIRWISE] pred_attackers_indx:  [0 2]
layer2_inf_t: 277.756103515625
assumed final_attacker_idxs:  [0 1 2 5 9]
final_attacker_idxs is: [0 1 2 5 9]
g_attacker_idxs: [45 46 81 32 80]
g_normal_idxs: [ 9 23 10 68 55]
filtered_attacker_idxs: [0, 1, 2, 5]
final_attacker_idxs are: [0, 1, 2, 5]
num_dps: [628, 710, 1227, 436, 293, 977, 892, 494, 354, 431]
___Test Local_Simple poisoned: False, epoch: 150: Average loss: 0.0323, Accuracy: 9907/10000 (99.0700%)
epoch_acc: 99.07000000000001
___Test Local_Simple poisoned: True, epoch: 150: Average loss: 15.1684, Accuracy: 11/8968 (0.1227%)
Done in 191.7371015548706 sec.
Server Epoch:151 choose agents : [34, 10, 86, 99, 14, 53, 39, 47, 25, 43].
poison local model 34 index 0
___Train Local_Simple,  epoch 151, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 412/413 (99.7579%)
___Train Local_Simple,  epoch 151, local model 34, internal_epoch   2,  Average loss: 0.0003, Accuracy: 412/413 (99.7579%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.1292, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch 151, local model 10, internal_epoch   1,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Train Local_Simple,  epoch 151, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0368, Accuracy: 9892/10000 (98.9200%)
___Train Local_Simple,  epoch 151, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 247/250 (98.8000%)
___Train Local_Simple,  epoch 151, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0579, Accuracy: 9829/10000 (98.2900%)
___Train Local_Simple,  epoch 151, local model 99, internal_epoch   1,  Average loss: 0.0003, Accuracy: 374/377 (99.2042%)
___Train Local_Simple,  epoch 151, local model 99, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/377 (99.7347%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0588, Accuracy: 9805/10000 (98.0500%)
___Train Local_Simple,  epoch 151, local model 14, internal_epoch   1,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Train Local_Simple,  epoch 151, local model 14, internal_epoch   2,  Average loss: 0.0001, Accuracy: 376/376 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0689, Accuracy: 9794/10000 (97.9400%)
___Train Local_Simple,  epoch 151, local model 53, internal_epoch   1,  Average loss: 0.0006, Accuracy: 728/739 (98.5115%)
___Train Local_Simple,  epoch 151, local model 53, internal_epoch   2,  Average loss: 0.0006, Accuracy: 733/739 (99.1881%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.2743, Accuracy: 9138/10000 (91.3800%)
___Train Local_Simple,  epoch 151, local model 39, internal_epoch   1,  Average loss: 0.0004, Accuracy: 254/257 (98.8327%)
___Train Local_Simple,  epoch 151, local model 39, internal_epoch   2,  Average loss: 0.0002, Accuracy: 256/257 (99.6109%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0703, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch 151, local model 47, internal_epoch   1,  Average loss: 0.0001, Accuracy: 775/776 (99.8711%)
___Train Local_Simple,  epoch 151, local model 47, internal_epoch   2,  Average loss: 0.0001, Accuracy: 775/776 (99.8711%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0403, Accuracy: 9877/10000 (98.7700%)
___Train Local_Simple,  epoch 151, local model 25, internal_epoch   1,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Train Local_Simple,  epoch 151, local model 25, internal_epoch   2,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0593, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 151, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 151, local model 43, internal_epoch   2,  Average loss: 0.0007, Accuracy: 403/408 (98.7745%)
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.1007, Accuracy: 9705/10000 (97.0500%)
time spent on training: 41.0957453250885
Starting performing KrMLRFL...
Num data points: [413, 892, 250, 377, 376, 739, 257, 776, 647, 408]
Num selected data points: [892 250 377 376 257 776 408]
The chosen ones are users: [1, 2, 3, 4, 6, 7, 9], which are global users: [10, 86, 99, 14, 39, 47, 43]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [34]
base_p: [ 4.1505694e-04  1.8334389e-04  1.0427088e-05 ... -1.6246438e-03
 -1.9305199e-04  2.6775897e-04]
[T_SCORE] attacker_local_idxs is:  [0, 4, 5, 7, 8]
layer1_inf_time: 4.616943359375
[PAIRWISE] pred_attackers_indx:  [2 3 5 6 7]
layer2_inf_t: 46.074951171875
assumed final_attacker_idxs:  [0 2 3 4 5 6 7 8]
final_attacker_idxs is: [0 2 3 4 5 6 7 8]
g_attacker_idxs: [34 86 99 14 53 39 47 25]
g_normal_idxs: [10 43]
filtered_attacker_idxs: [0, 5, 8]
final_attacker_idxs are: [0, 5, 8]
num_dps: [413, 892, 250, 377, 376, 739, 257, 776, 647, 408]
___Test Local_Simple poisoned: False, epoch: 151: Average loss: 0.0292, Accuracy: 9914/10000 (99.1400%)
epoch_acc: 99.14
___Test Local_Simple poisoned: True, epoch: 151: Average loss: 15.1702, Accuracy: 9/8968 (0.1004%)
Done in 185.37201070785522 sec.
Server Epoch:152 choose agents : [42, 25, 89, 12, 90, 84, 71, 75, 6, 50].
poison local model 42 index 0
___Train Local_Simple,  epoch 152, local model 42, internal_epoch   1,  Average loss: 0.0004, Accuracy: 235/236 (99.5763%)
___Train Local_Simple,  epoch 152, local model 42, internal_epoch   2,  Average loss: 0.0000, Accuracy: 236/236 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0353, Accuracy: 9893/10000 (98.9300%)
___Train Local_Simple,  epoch 152, local model 25, internal_epoch   1,  Average loss: 0.0001, Accuracy: 647/647 (100.0000%)
___Train Local_Simple,  epoch 152, local model 25, internal_epoch   2,  Average loss: 0.0000, Accuracy: 647/647 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0534, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 152, local model 89, internal_epoch   1,  Average loss: 0.0003, Accuracy: 488/492 (99.1870%)
___Train Local_Simple,  epoch 152, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 492/492 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0633, Accuracy: 9805/10000 (98.0500%)
___Train Local_Simple,  epoch 152, local model 12, internal_epoch   1,  Average loss: 0.0009, Accuracy: 1141/1160 (98.3621%)
___Train Local_Simple,  epoch 152, local model 12, internal_epoch   2,  Average loss: 0.0005, Accuracy: 1152/1160 (99.3103%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.4128, Accuracy: 9176/10000 (91.7600%)
___Train Local_Simple,  epoch 152, local model 90, internal_epoch   1,  Average loss: 0.0002, Accuracy: 680/683 (99.5608%)
___Train Local_Simple,  epoch 152, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 682/683 (99.8536%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.5983, Accuracy: 8633/10000 (86.3300%)
___Train Local_Simple,  epoch 152, local model 84, internal_epoch   1,  Average loss: 0.0008, Accuracy: 1228/1246 (98.5554%)
___Train Local_Simple,  epoch 152, local model 84, internal_epoch   2,  Average loss: 0.0007, Accuracy: 1230/1246 (98.7159%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.1005, Accuracy: 9679/10000 (96.7900%)
poison local model 71 index 1
___Train Local_Simple,  epoch 152, local model 71, internal_epoch   1,  Average loss: 0.0004, Accuracy: 1373/1384 (99.2052%)
___Train Local_Simple,  epoch 152, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1375/1384 (99.3497%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.1636, Accuracy: 9481/10000 (94.8100%)
___Train Local_Simple,  epoch 152, local model 75, internal_epoch   1,  Average loss: 0.0002, Accuracy: 683/686 (99.5627%)
___Train Local_Simple,  epoch 152, local model 75, internal_epoch   2,  Average loss: 0.0001, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0627, Accuracy: 9808/10000 (98.0800%)
___Train Local_Simple,  epoch 152, local model 6, internal_epoch   1,  Average loss: 0.0002, Accuracy: 614/615 (99.8374%)
___Train Local_Simple,  epoch 152, local model 6, internal_epoch   2,  Average loss: 0.0001, Accuracy: 612/615 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0609, Accuracy: 9813/10000 (98.1300%)
___Train Local_Simple,  epoch 152, local model 50, internal_epoch   1,  Average loss: 0.0003, Accuracy: 471/474 (99.3671%)
___Train Local_Simple,  epoch 152, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 474/474 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0953, Accuracy: 9703/10000 (97.0300%)
time spent on training: 47.34821557998657
Starting performing KrMLRFL...
Num data points: [236, 647, 492, 1160, 683, 1246, 1384, 686, 615, 474]
Num selected data points: [647 683 686 615 474]
The chosen ones are users: [1, 4, 7, 8, 9], which are global users: [25, 90, 75, 6, 50]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [42, 71]
base_p: [ 0.00050773  0.00031039 -0.00079726 ...  0.00116409 -0.0003418
  0.00522245]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 5, 6]
layer1_inf_time: 2.65576171875
[PAIRWISE] pred_attackers_indx:  [5 6 7]
layer2_inf_t: 27.30419921875
assumed final_attacker_idxs:  [0 2 3 5 6 7]
final_attacker_idxs is: [0 2 3 5 6 7]
g_attacker_idxs: [42 89 12 84 71 75]
g_normal_idxs: [25 90  6 50]
filtered_attacker_idxs: [0, 2, 3, 5, 6]
final_attacker_idxs are: [0, 2, 3, 5, 6]
num_dps: [236, 647, 492, 1160, 683, 1246, 1384, 686, 615, 474]
epoch_acc: 98.82
___Test Local_Simple poisoned: False, epoch: 152: Average loss: 0.0388, Accuracy: 9882/10000 (98.8200%)
___Test Local_Simple poisoned: True, epoch: 152: Average loss: 15.1316, Accuracy: 9/8968 (0.1004%)
Done in 187.11326789855957 sec.
Server Epoch:153 choose agents : [45, 62, 66, 43, 68, 9, 78, 97, 53, 33].
poison local model 45 index 0
___Train Local_Simple,  epoch 153, local model 45, internal_epoch   1,  Average loss: 0.0011, Accuracy: 618/628 (98.4076%)
___Train Local_Simple,  epoch 153, local model 45, internal_epoch   2,  Average loss: 0.0003, Accuracy: 624/628 (99.3631%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1920, Accuracy: 9269/10000 (92.6900%)
___Train Local_Simple,  epoch 153, local model 62, internal_epoch   1,  Average loss: 0.0002, Accuracy: 421/423 (99.5272%)
___Train Local_Simple,  epoch 153, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0577, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 153, local model 66, internal_epoch   1,  Average loss: 0.0004, Accuracy: 654/660 (99.0909%)
___Train Local_Simple,  epoch 153, local model 66, internal_epoch   2,  Average loss: 0.0005, Accuracy: 653/660 (98.9394%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1395, Accuracy: 9535/10000 (95.3500%)
___Train Local_Simple,  epoch 153, local model 43, internal_epoch   1,  Average loss: 0.0002, Accuracy: 405/408 (99.2647%)
___Train Local_Simple,  epoch 153, local model 43, internal_epoch   2,  Average loss: 0.0004, Accuracy: 406/408 (99.5098%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0404, Accuracy: 9874/10000 (98.7400%)
___Train Local_Simple,  epoch 153, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 153, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0547, Accuracy: 9825/10000 (98.2500%)
___Train Local_Simple,  epoch 153, local model 9, internal_epoch   1,  Average loss: 0.0002, Accuracy: 435/436 (99.7706%)
___Train Local_Simple,  epoch 153, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/436 (99.7706%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0602, Accuracy: 9817/10000 (98.1700%)
___Train Local_Simple,  epoch 153, local model 78, internal_epoch   1,  Average loss: 0.0002, Accuracy: 303/303 (100.0000%)
___Train Local_Simple,  epoch 153, local model 78, internal_epoch   2,  Average loss: 0.0000, Accuracy: 303/303 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1443, Accuracy: 9601/10000 (96.0100%)
___Train Local_Simple,  epoch 153, local model 97, internal_epoch   1,  Average loss: 0.0003, Accuracy: 485/487 (99.5893%)
___Train Local_Simple,  epoch 153, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0670, Accuracy: 9790/10000 (97.9000%)
___Train Local_Simple,  epoch 153, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 732/739 (99.0528%)
___Train Local_Simple,  epoch 153, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 737/739 (99.7294%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.3889, Accuracy: 8980/10000 (89.8000%)
___Train Local_Simple,  epoch 153, local model 33, internal_epoch   1,  Average loss: 0.0014, Accuracy: 607/623 (97.4318%)
___Train Local_Simple,  epoch 153, local model 33, internal_epoch   2,  Average loss: 0.0017, Accuracy: 599/623 (96.1477%)
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.1522, Accuracy: 9524/10000 (95.2400%)
time spent on training: 41.940189599990845
Starting performing KrMLRFL...
Num data points: [628, 423, 660, 408, 494, 436, 303, 487, 739, 623]
Num selected data points: [423 408 494 436 303 487]
The chosen ones are users: [1, 3, 4, 5, 6, 7], which are global users: [62, 43, 68, 9, 78, 97]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [45]
base_p: [ 0.00022555  0.00017038  0.00128102 ... -0.00264116 -0.00310038
  0.00027779]
[T_SCORE] attacker_local_idxs is:  [0, 2, 7, 8, 9]
layer1_inf_time: 3.257568359375
[PAIRWISE] pred_attackers_indx:  [0 8]
layer2_inf_t: 64.67431640625
assumed final_attacker_idxs:  [0 2 7 8 9]
final_attacker_idxs is: [0 2 7 8 9]
g_attacker_idxs: [45 66 97 53 33]
g_normal_idxs: [62 43 68  9 78]
filtered_attacker_idxs: [0, 2, 8, 9]
final_attacker_idxs are: [0, 2, 8, 9]
num_dps: [628, 423, 660, 408, 494, 436, 303, 487, 739, 623]
___Test Local_Simple poisoned: False, epoch: 153: Average loss: 0.0303, Accuracy: 9909/10000 (99.0900%)
epoch_acc: 99.09
___Test Local_Simple poisoned: True, epoch: 153: Average loss: 15.4594, Accuracy: 5/8968 (0.0558%)
Done in 198.58409714698792 sec.
Server Epoch:154 choose agents : [51, 97, 17, 55, 76, 41, 2, 45, 84, 20].
poison local model 51 index 0
___Train Local_Simple,  epoch 154, local model 51, internal_epoch   1,  Average loss: 0.0007, Accuracy: 561/568 (98.7676%)
___Train Local_Simple,  epoch 154, local model 51, internal_epoch   2,  Average loss: 0.0004, Accuracy: 564/568 (99.2958%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1859, Accuracy: 9408/10000 (94.0800%)
___Train Local_Simple,  epoch 154, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Train Local_Simple,  epoch 154, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1380, Accuracy: 9628/10000 (96.2800%)
poison local model 17 index 1
___Train Local_Simple,  epoch 154, local model 17, internal_epoch   1,  Average loss: 0.0015, Accuracy: 607/620 (97.9032%)
___Train Local_Simple,  epoch 154, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 609/620 (98.2258%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1208, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch 154, local model 55, internal_epoch   1,  Average loss: 0.0004, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch 154, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.2410, Accuracy: 9353/10000 (93.5300%)
___Train Local_Simple,  epoch 154, local model 76, internal_epoch   1,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Train Local_Simple,  epoch 154, local model 76, internal_epoch   2,  Average loss: 0.0000, Accuracy: 78/78 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.0301, Accuracy: 9908/10000 (99.0800%)
___Train Local_Simple,  epoch 154, local model 41, internal_epoch   1,  Average loss: 0.0003, Accuracy: 604/606 (99.6700%)
___Train Local_Simple,  epoch 154, local model 41, internal_epoch   2,  Average loss: 0.0002, Accuracy: 605/606 (99.8350%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.2102, Accuracy: 9372/10000 (93.7200%)
poison local model 2 index 2
___Train Local_Simple,  epoch 154, local model 2, internal_epoch   1,  Average loss: 0.0008, Accuracy: 542/548 (98.9051%)
___Train Local_Simple,  epoch 154, local model 2, internal_epoch   2,  Average loss: 0.0006, Accuracy: 542/548 (98.9051%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1239, Accuracy: 9606/10000 (96.0600%)
poison local model 45 index 3
___Train Local_Simple,  epoch 154, local model 45, internal_epoch   1,  Average loss: 0.0009, Accuracy: 620/628 (98.7261%)
___Train Local_Simple,  epoch 154, local model 45, internal_epoch   2,  Average loss: 0.0005, Accuracy: 622/628 (99.0446%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1328, Accuracy: 9637/10000 (96.3700%)
___Train Local_Simple,  epoch 154, local model 84, internal_epoch   1,  Average loss: 0.0011, Accuracy: 1223/1246 (98.1541%)
___Train Local_Simple,  epoch 154, local model 84, internal_epoch   2,  Average loss: 0.0006, Accuracy: 1232/1246 (98.8764%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.0915, Accuracy: 9715/10000 (97.1500%)
poison local model 20 index 0
___Train Local_Simple,  epoch 154, local model 20, internal_epoch   1,  Average loss: 0.0006, Accuracy: 424/429 (98.8345%)
___Train Local_Simple,  epoch 154, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 426/429 (99.3007%)
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.1585, Accuracy: 9536/10000 (95.3600%)
time spent on training: 59.67575454711914
Starting performing KrMLRFL...
Num data points: [568, 487, 620, 354, 78, 606, 548, 628, 1246, 429]
Num selected data points: [487 354  78 606]
The chosen ones are users: [1, 3, 4, 5], which are global users: [97, 55, 76, 41]
___Test Local_Simple poisoned: False, epoch: 154: Average loss: 0.0392, Accuracy: 9878/10000 (98.7800%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [51, 17, 2, 45, 20]
base_p: [ 0.00120516  0.00012599  0.00096869 ... -0.00067413  0.00235502
  0.00179045]
[T_SCORE] attacker_local_idxs is:  [0, 2, 6, 7, 8, 9]
layer1_inf_time: 4.68310546875
[PAIRWISE] pred_attackers_indx:  [2 7 8 9]
layer2_inf_t: 34.374267578125
assumed final_attacker_idxs:  [0 2 6 7 8 9]
final_attacker_idxs is: [0 2 6 7 8 9]
g_attacker_idxs: [51 17  2 45 84 20]
g_normal_idxs: [97 55 76 41]
filtered_attacker_idxs: [0, 2, 6, 7, 8, 9]
final_attacker_idxs are: [0, 2, 6, 7, 8, 9]
num_dps: [568, 487, 620, 354, 78, 606, 548, 628, 1246, 429]
epoch_acc: 98.78
___Test Local_Simple poisoned: True, epoch: 154: Average loss: 14.9116, Accuracy: 23/8968 (0.2565%)
Done in 217.19421911239624 sec.
Server Epoch:155 choose agents : [62, 65, 21, 43, 30, 89, 26, 59, 36, 22].
___Train Local_Simple,  epoch 155, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Train Local_Simple,  epoch 155, local model 62, internal_epoch   2,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0380, Accuracy: 9888/10000 (98.8800%)
___Train Local_Simple,  epoch 155, local model 65, internal_epoch   1,  Average loss: 0.0002, Accuracy: 369/371 (99.4609%)
___Train Local_Simple,  epoch 155, local model 65, internal_epoch   2,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0828, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 155, local model 21, internal_epoch   1,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Train Local_Simple,  epoch 155, local model 21, internal_epoch   2,  Average loss: 0.0001, Accuracy: 312/312 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0515, Accuracy: 9828/10000 (98.2800%)
___Train Local_Simple,  epoch 155, local model 43, internal_epoch   1,  Average loss: 0.0003, Accuracy: 406/408 (99.5098%)
___Train Local_Simple,  epoch 155, local model 43, internal_epoch   2,  Average loss: 0.0003, Accuracy: 407/408 (99.7549%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0504, Accuracy: 9851/10000 (98.5100%)
___Train Local_Simple,  epoch 155, local model 30, internal_epoch   1,  Average loss: 0.0003, Accuracy: 398/400 (99.5000%)
___Train Local_Simple,  epoch 155, local model 30, internal_epoch   2,  Average loss: 0.0005, Accuracy: 396/400 (99.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.1666, Accuracy: 9510/10000 (95.1000%)
___Train Local_Simple,  epoch 155, local model 89, internal_epoch   1,  Average loss: 0.0004, Accuracy: 488/492 (99.1870%)
___Train Local_Simple,  epoch 155, local model 89, internal_epoch   2,  Average loss: 0.0001, Accuracy: 491/492 (99.7967%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.1224, Accuracy: 9602/10000 (96.0200%)
poison local model 26 index 0
___Train Local_Simple,  epoch 155, local model 26, internal_epoch   1,  Average loss: 0.0003, Accuracy: 550/554 (99.2780%)
___Train Local_Simple,  epoch 155, local model 26, internal_epoch   2,  Average loss: 0.0001, Accuracy: 554/554 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0998, Accuracy: 9700/10000 (97.0000%)
___Train Local_Simple,  epoch 155, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 155, local model 59, internal_epoch   2,  Average loss: 0.0007, Accuracy: 749/760 (98.5526%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.1949, Accuracy: 9354/10000 (93.5400%)
___Train Local_Simple,  epoch 155, local model 36, internal_epoch   1,  Average loss: 0.0009, Accuracy: 984/1005 (97.9104%)
___Train Local_Simple,  epoch 155, local model 36, internal_epoch   2,  Average loss: 0.0005, Accuracy: 993/1005 (98.8060%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.2138, Accuracy: 9378/10000 (93.7800%)
poison local model 22 index 1
___Train Local_Simple,  epoch 155, local model 22, internal_epoch   1,  Average loss: 0.0008, Accuracy: 574/583 (98.4563%)
___Train Local_Simple,  epoch 155, local model 22, internal_epoch   2,  Average loss: 0.0004, Accuracy: 577/583 (98.9708%)
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.1896, Accuracy: 9404/10000 (94.0400%)
time spent on training: 47.03007245063782
Starting performing KrMLRFL...
Num data points: [423, 371, 312, 408, 400, 492, 554, 760, 1005, 583]
Num selected data points: [423 371 312 408 400]
The chosen ones are users: [0, 1, 2, 3, 4], which are global users: [62, 65, 21, 43, 30]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 22]
base_p: [-0.00047918  0.00011931 -0.0005346  ...  0.00211106 -0.00560463
 -0.00132611]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 3.383056640625
[PAIRWISE] pred_attackers_indx:  [7 8 9]
layer2_inf_t: 31.05126953125
assumed final_attacker_idxs:  [5 6 7 8 9]
final_attacker_idxs is: [5 6 7 8 9]
g_attacker_idxs: [89 26 59 36 22]
g_normal_idxs: [62 65 21 43 30]
filtered_attacker_idxs: [5, 6, 7, 8, 9]
final_attacker_idxs are: [5, 6, 7, 8, 9]
num_dps: [423, 371, 312, 408, 400, 492, 554, 760, 1005, 583]
___Test Local_Simple poisoned: False, epoch: 155: Average loss: 0.0331, Accuracy: 9903/10000 (99.0300%)
epoch_acc: 99.03
___Test Local_Simple poisoned: True, epoch: 155: Average loss: 14.3567, Accuracy: 16/8968 (0.1784%)
Done in 208.48933267593384 sec.
Server Epoch:156 choose agents : [63, 13, 18, 4, 59, 27, 16, 95, 55, 62].
poison local model 63 index 0
___Train Local_Simple,  epoch 156, local model 63, internal_epoch   1,  Average loss: 0.0009, Accuracy: 871/889 (97.9753%)
___Train Local_Simple,  epoch 156, local model 63, internal_epoch   2,  Average loss: 0.0009, Accuracy: 875/889 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0838, Accuracy: 9737/10000 (97.3700%)
poison local model 13 index 1
___Train Local_Simple,  epoch 156, local model 13, internal_epoch   1,  Average loss: 0.0007, Accuracy: 724/734 (98.6376%)
___Train Local_Simple,  epoch 156, local model 13, internal_epoch   2,  Average loss: 0.0014, Accuracy: 724/734 (98.6376%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.1652, Accuracy: 9509/10000 (95.0900%)
___Train Local_Simple,  epoch 156, local model 18, internal_epoch   1,  Average loss: 0.0013, Accuracy: 448/459 (97.6035%)
___Train Local_Simple,  epoch 156, local model 18, internal_epoch   2,  Average loss: 0.0015, Accuracy: 449/459 (97.8214%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.3827, Accuracy: 9138/10000 (91.3800%)
___Train Local_Simple,  epoch 156, local model 4, internal_epoch   1,  Average loss: 0.0007, Accuracy: 649/658 (98.6322%)
___Train Local_Simple,  epoch 156, local model 4, internal_epoch   2,  Average loss: 0.0007, Accuracy: 650/658 (98.7842%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.1355, Accuracy: 9576/10000 (95.7600%)
___Train Local_Simple,  epoch 156, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 748/760 (98.4211%)
___Train Local_Simple,  epoch 156, local model 59, internal_epoch   2,  Average loss: 0.0006, Accuracy: 752/760 (98.9474%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.2493, Accuracy: 9209/10000 (92.0900%)
poison local model 27 index 2
___Train Local_Simple,  epoch 156, local model 27, internal_epoch   1,  Average loss: 0.0012, Accuracy: 465/471 (98.7261%)
___Train Local_Simple,  epoch 156, local model 27, internal_epoch   2,  Average loss: 0.0004, Accuracy: 466/471 (98.9384%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.2665, Accuracy: 9334/10000 (93.3400%)
poison local model 16 index 3
___Train Local_Simple,  epoch 156, local model 16, internal_epoch   1,  Average loss: 0.0005, Accuracy: 906/915 (99.0164%)
___Train Local_Simple,  epoch 156, local model 16, internal_epoch   2,  Average loss: 0.0002, Accuracy: 913/915 (99.7814%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0754, Accuracy: 9767/10000 (97.6700%)
___Train Local_Simple,  epoch 156, local model 95, internal_epoch   1,  Average loss: 0.0003, Accuracy: 599/602 (99.5017%)
___Train Local_Simple,  epoch 156, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.2612, Accuracy: 9167/10000 (91.6700%)
___Train Local_Simple,  epoch 156, local model 55, internal_epoch   1,  Average loss: 0.0003, Accuracy: 351/354 (99.1525%)
___Train Local_Simple,  epoch 156, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.3332, Accuracy: 9111/10000 (91.1100%)
___Train Local_Simple,  epoch 156, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 422/423 (99.7636%)
___Train Local_Simple,  epoch 156, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0495, Accuracy: 9848/10000 (98.4800%)
time spent on training: 54.15538763999939
Starting performing KrMLRFL...
Num data points: [889, 734, 459, 658, 760, 471, 915, 602, 354, 423]
Num selected data points: [354 423]
The chosen ones are users: [8, 9], which are global users: [55, 62]
___Test Local_Simple poisoned: False, epoch: 156: Average loss: 0.0579, Accuracy: 9817/10000 (98.1700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [63, 13, 27, 16]
base_p: [ 0.00156634  0.00023353  0.00085002 ...  0.00136738 -0.00037467
  0.00056637]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 4, 5, 6]
layer1_inf_time: 2.757568359375
[PAIRWISE] pred_attackers_indx:  [3 6 7 8]
layer2_inf_t: 38.19189453125
assumed final_attacker_idxs:  [0 1 2 3 4 5 6 7 8]
final_attacker_idxs is: [0 1 2 3 4 5 6 7 8]
g_attacker_idxs: [63 13 18  4 59 27 16 95 55]
g_normal_idxs: [62]
filtered_attacker_idxs: [0, 1, 2, 3, 4, 5, 6, 7]
final_attacker_idxs are: [0, 1, 2, 3, 4, 5, 6, 7]
num_dps: [889, 734, 459, 658, 760, 471, 915, 602, 354, 423]
epoch_acc: 98.17
___Test Local_Simple poisoned: True, epoch: 156: Average loss: 15.0465, Accuracy: 24/8968 (0.2676%)
Done in 216.19164896011353 sec.
Server Epoch:157 choose agents : [2, 87, 97, 89, 53, 23, 77, 7, 83, 75].
poison local model 2 index 0
___Train Local_Simple,  epoch 157, local model 2, internal_epoch   1,  Average loss: 0.0015, Accuracy: 533/548 (97.2628%)
___Train Local_Simple,  epoch 157, local model 2, internal_epoch   2,  Average loss: 0.0012, Accuracy: 539/548 (98.3577%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.5408, Accuracy: 8421/10000 (84.2100%)
___Train Local_Simple,  epoch 157, local model 87, internal_epoch   1,  Average loss: 0.0002, Accuracy: 468/470 (99.5745%)
___Train Local_Simple,  epoch 157, local model 87, internal_epoch   2,  Average loss: 0.0001, Accuracy: 469/470 (99.7872%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0609, Accuracy: 9823/10000 (98.2300%)
___Train Local_Simple,  epoch 157, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 157, local model 97, internal_epoch   2,  Average loss: 0.0001, Accuracy: 486/487 (99.7947%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0646, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 157, local model 89, internal_epoch   1,  Average loss: 0.0005, Accuracy: 488/492 (99.1870%)
___Train Local_Simple,  epoch 157, local model 89, internal_epoch   2,  Average loss: 0.0004, Accuracy: 490/492 (99.5935%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.1301, Accuracy: 9602/10000 (96.0200%)
___Train Local_Simple,  epoch 157, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 726/739 (98.2409%)
___Train Local_Simple,  epoch 157, local model 53, internal_epoch   2,  Average loss: 0.0007, Accuracy: 725/739 (98.1055%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.2616, Accuracy: 9166/10000 (91.6600%)
___Train Local_Simple,  epoch 157, local model 23, internal_epoch   1,  Average loss: 0.0004, Accuracy: 291/293 (99.3174%)
___Train Local_Simple,  epoch 157, local model 23, internal_epoch   2,  Average loss: 0.0006, Accuracy: 292/293 (99.6587%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0575, Accuracy: 9815/10000 (98.1500%)
___Train Local_Simple,  epoch 157, local model 77, internal_epoch   1,  Average loss: 0.0006, Accuracy: 583/589 (98.9813%)
___Train Local_Simple,  epoch 157, local model 77, internal_epoch   2,  Average loss: 0.0004, Accuracy: 584/589 (99.1511%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0521, Accuracy: 9827/10000 (98.2700%)
poison local model 7 index 1
___Train Local_Simple,  epoch 157, local model 7, internal_epoch   1,  Average loss: 0.0006, Accuracy: 413/418 (98.8038%)
___Train Local_Simple,  epoch 157, local model 7, internal_epoch   2,  Average loss: 0.0006, Accuracy: 413/418 (98.8038%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.3040, Accuracy: 9250/10000 (92.5000%)
___Train Local_Simple,  epoch 157, local model 83, internal_epoch   1,  Average loss: 0.0003, Accuracy: 430/433 (99.3072%)
___Train Local_Simple,  epoch 157, local model 83, internal_epoch   2,  Average loss: 0.0003, Accuracy: 430/433 (99.3072%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0471, Accuracy: 9841/10000 (98.4100%)
___Train Local_Simple,  epoch 157, local model 75, internal_epoch   1,  Average loss: 0.0004, Accuracy: 681/686 (99.2711%)
___Train Local_Simple,  epoch 157, local model 75, internal_epoch   2,  Average loss: 0.0002, Accuracy: 684/686 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0553, Accuracy: 9824/10000 (98.2400%)
time spent on training: 43.29225397109985
Starting performing KrMLRFL...
Num data points: [548, 470, 487, 492, 739, 293, 589, 418, 433, 686]
Num selected data points: [470 487 293 433 686]
The chosen ones are users: [1, 2, 5, 8, 9], which are global users: [87, 97, 23, 83, 75]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [2, 7]
base_p: [-0.0011471   0.00017512 -0.00313946 ... -0.00438841 -0.01010596
  0.00027308]
[T_SCORE] attacker_local_idxs is:  [0, 3, 4, 6, 7]
layer1_inf_time: 5.797607421875
[PAIRWISE] pred_attackers_indx:  [0 6 7]
layer2_inf_t: 53.7275390625
assumed final_attacker_idxs:  [0 3 4 6 7]
final_attacker_idxs is: [0 3 4 6 7]
g_attacker_idxs: [ 2 89 53 77  7]
g_normal_idxs: [87 97 23 83 75]
filtered_attacker_idxs: [0, 3, 4, 6, 7]
final_attacker_idxs are: [0, 3, 4, 6, 7]
num_dps: [548, 470, 487, 492, 739, 293, 589, 418, 433, 686]
___Test Local_Simple poisoned: False, epoch: 157: Average loss: 0.0335, Accuracy: 9895/10000 (98.9500%)
epoch_acc: 98.95
___Test Local_Simple poisoned: True, epoch: 157: Average loss: 15.1218, Accuracy: 8/8968 (0.0892%)
Done in 184.37367701530457 sec.
Server Epoch:158 choose agents : [74, 48, 9, 90, 32, 35, 47, 1, 59, 72].
___Train Local_Simple,  epoch 158, local model 74, internal_epoch   1,  Average loss: 0.0003, Accuracy: 553/557 (99.2819%)
___Train Local_Simple,  epoch 158, local model 74, internal_epoch   2,  Average loss: 0.0003, Accuracy: 555/557 (99.6409%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0616, Accuracy: 9797/10000 (97.9700%)
___Train Local_Simple,  epoch 158, local model 48, internal_epoch   1,  Average loss: 0.0003, Accuracy: 445/448 (99.3304%)
___Train Local_Simple,  epoch 158, local model 48, internal_epoch   2,  Average loss: 0.0001, Accuracy: 447/448 (99.7768%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0726, Accuracy: 9772/10000 (97.7200%)
___Train Local_Simple,  epoch 158, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 158, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0476, Accuracy: 9845/10000 (98.4500%)
___Train Local_Simple,  epoch 158, local model 90, internal_epoch   1,  Average loss: 0.0003, Accuracy: 679/683 (99.4143%)
___Train Local_Simple,  epoch 158, local model 90, internal_epoch   2,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.2369, Accuracy: 9310/10000 (93.1000%)
___Train Local_Simple,  epoch 158, local model 32, internal_epoch   1,  Average loss: 0.0004, Accuracy: 969/977 (99.1812%)
___Train Local_Simple,  epoch 158, local model 32, internal_epoch   2,  Average loss: 0.0003, Accuracy: 970/977 (99.2835%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0808, Accuracy: 9739/10000 (97.3900%)
___Train Local_Simple,  epoch 158, local model 35, internal_epoch   1,  Average loss: 0.0002, Accuracy: 497/499 (99.5992%)
___Train Local_Simple,  epoch 158, local model 35, internal_epoch   2,  Average loss: 0.0001, Accuracy: 498/499 (99.7996%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0628, Accuracy: 9799/10000 (97.9900%)
___Train Local_Simple,  epoch 158, local model 47, internal_epoch   1,  Average loss: 0.0001, Accuracy: 776/776 (100.0000%)
___Train Local_Simple,  epoch 158, local model 47, internal_epoch   2,  Average loss: 0.0000, Accuracy: 776/776 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0548, Accuracy: 9831/10000 (98.3100%)
poison local model 1 index 0
___Train Local_Simple,  epoch 158, local model 1, internal_epoch   1,  Average loss: 0.0008, Accuracy: 746/760 (98.1579%)
___Train Local_Simple,  epoch 158, local model 1, internal_epoch   2,  Average loss: 0.0004, Accuracy: 754/760 (99.2105%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.1248, Accuracy: 9556/10000 (95.5600%)
___Train Local_Simple,  epoch 158, local model 59, internal_epoch   1,  Average loss: 0.0009, Accuracy: 751/760 (98.8158%)
___Train Local_Simple,  epoch 158, local model 59, internal_epoch   2,  Average loss: 0.0007, Accuracy: 751/760 (98.8158%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.1571, Accuracy: 9489/10000 (94.8900%)
___Train Local_Simple,  epoch 158, local model 72, internal_epoch   1,  Average loss: 0.0002, Accuracy: 727/731 (99.4528%)
___Train Local_Simple,  epoch 158, local model 72, internal_epoch   2,  Average loss: 0.0003, Accuracy: 728/731 (99.5896%)
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0922, Accuracy: 9684/10000 (96.8400%)
time spent on training: 38.18979287147522
Starting performing KrMLRFL...
Num data points: [557, 448, 436, 683, 977, 499, 776, 760, 760, 731]
Num selected data points: [557 448 436 683 499 776 731]
The chosen ones are users: [0, 1, 2, 3, 5, 6, 9], which are global users: [74, 48, 9, 90, 35, 47, 72]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [1]
base_p: [ 8.9302659e-05  2.4532527e-04  1.2946576e-03 ...  2.9096901e-03
 -2.4791285e-03  9.6373260e-04]
[T_SCORE] attacker_local_idxs is:  [3, 4, 6, 7, 8]
layer1_inf_time: 2.96142578125
[PAIRWISE] pred_attackers_indx:  [8]
layer2_inf_t: 29.65185546875
assumed final_attacker_idxs:  [3 4 6 7 8]
final_attacker_idxs is: [3 4 6 7 8]
g_attacker_idxs: [90 32 47  1 59]
g_normal_idxs: [74 48  9 35 72]
filtered_attacker_idxs: [4, 7, 8]
final_attacker_idxs are: [4, 7, 8]
num_dps: [557, 448, 436, 683, 977, 499, 776, 760, 760, 731]
epoch_acc: 99.00999999999999
___Test Local_Simple poisoned: False, epoch: 158: Average loss: 0.0307, Accuracy: 9901/10000 (99.0100%)
___Test Local_Simple poisoned: True, epoch: 158: Average loss: 15.0472, Accuracy: 7/8968 (0.0781%)
Done in 147.85104274749756 sec.
Server Epoch:159 choose agents : [74, 18, 90, 75, 52, 53, 31, 8, 97, 54].
___Train Local_Simple,  epoch 159, local model 74, internal_epoch   1,  Average loss: 0.0002, Accuracy: 555/557 (99.6409%)
___Train Local_Simple,  epoch 159, local model 74, internal_epoch   2,  Average loss: 0.0001, Accuracy: 556/557 (99.8205%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0693, Accuracy: 9776/10000 (97.7600%)
___Train Local_Simple,  epoch 159, local model 18, internal_epoch   1,  Average loss: 0.0007, Accuracy: 454/459 (98.9107%)
___Train Local_Simple,  epoch 159, local model 18, internal_epoch   2,  Average loss: 0.0002, Accuracy: 458/459 (99.7821%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.4235, Accuracy: 9188/10000 (91.8800%)
___Train Local_Simple,  epoch 159, local model 90, internal_epoch   1,  Average loss: 0.0001, Accuracy: 683/683 (100.0000%)
___Train Local_Simple,  epoch 159, local model 90, internal_epoch   2,  Average loss: 0.0000, Accuracy: 683/683 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0574, Accuracy: 9827/10000 (98.2700%)
___Train Local_Simple,  epoch 159, local model 75, internal_epoch   1,  Average loss: 0.0001, Accuracy: 685/686 (99.8542%)
___Train Local_Simple,  epoch 159, local model 75, internal_epoch   2,  Average loss: 0.0000, Accuracy: 686/686 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0485, Accuracy: 9859/10000 (98.5900%)
poison local model 52 index 0
___Train Local_Simple,  epoch 159, local model 52, internal_epoch   1,  Average loss: 0.0004, Accuracy: 251/253 (99.2095%)
___Train Local_Simple,  epoch 159, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.1818, Accuracy: 9509/10000 (95.0900%)
___Train Local_Simple,  epoch 159, local model 53, internal_epoch   1,  Average loss: 0.0007, Accuracy: 730/739 (98.7821%)
___Train Local_Simple,  epoch 159, local model 53, internal_epoch   2,  Average loss: 0.0002, Accuracy: 736/739 (99.5940%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.1516, Accuracy: 9517/10000 (95.1700%)
___Train Local_Simple,  epoch 159, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 832/835 (99.6407%)
___Train Local_Simple,  epoch 159, local model 31, internal_epoch   2,  Average loss: 0.0001, Accuracy: 834/835 (99.8802%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0773, Accuracy: 9782/10000 (97.8200%)
___Train Local_Simple,  epoch 159, local model 8, internal_epoch   1,  Average loss: 0.0001, Accuracy: 633/633 (100.0000%)
___Train Local_Simple,  epoch 159, local model 8, internal_epoch   2,  Average loss: 0.0000, Accuracy: 633/633 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0608, Accuracy: 9795/10000 (97.9500%)
___Train Local_Simple,  epoch 159, local model 97, internal_epoch   1,  Average loss: 0.0001, Accuracy: 487/487 (100.0000%)
___Train Local_Simple,  epoch 159, local model 97, internal_epoch   2,  Average loss: 0.0000, Accuracy: 487/487 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0361, Accuracy: 9879/10000 (98.7900%)
___Train Local_Simple,  epoch 159, local model 54, internal_epoch   1,  Average loss: 0.0002, Accuracy: 518/519 (99.8073%)
___Train Local_Simple,  epoch 159, local model 54, internal_epoch   2,  Average loss: 0.0001, Accuracy: 518/519 (99.8073%)
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0775, Accuracy: 9751/10000 (97.5100%)
time spent on training: 34.21048712730408
Starting performing KrMLRFL...
Num data points: [557, 459, 683, 686, 253, 739, 835, 633, 487, 519]
Num selected data points: [557 683 686 633 487 519]
The chosen ones are users: [0, 2, 3, 7, 8, 9], which are global users: [74, 90, 75, 8, 97, 54]
___Test Local_Simple poisoned: False, epoch: 159: Average loss: 0.0320, Accuracy: 9899/10000 (98.9900%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52]
base_p: [ 4.2559952e-04  2.0943955e-04  1.7503649e-04 ... -1.0289252e-04
  2.6755035e-05  5.8045983e-04]
[T_SCORE] attacker_local_idxs is:  [1, 4, 5, 6, 9]
layer1_inf_time: 3.0458984375
[PAIRWISE] pred_attackers_indx:  [0 5 6 7]
layer2_inf_t: 36.88525390625
assumed final_attacker_idxs:  [0 1 4 5 6 7 9]
final_attacker_idxs is: [0 1 4 5 6 7 9]
g_attacker_idxs: [74 18 52 53 31  8 54]
g_normal_idxs: [90 75 97]
filtered_attacker_idxs: [1, 4, 5, 6]
final_attacker_idxs are: [1, 4, 5, 6]
num_dps: [557, 459, 683, 686, 253, 739, 835, 633, 487, 519]
epoch_acc: 98.99
___Test Local_Simple poisoned: True, epoch: 159: Average loss: 15.0087, Accuracy: 11/8968 (0.1227%)
Done in 165.16870856285095 sec.
Server Epoch:160 choose agents : [55, 28, 52, 44, 22, 6, 49, 95, 68, 79].
___Train Local_Simple,  epoch 160, local model 55, internal_epoch   1,  Average loss: 0.0002, Accuracy: 354/354 (100.0000%)
___Train Local_Simple,  epoch 160, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0668, Accuracy: 9783/10000 (97.8300%)
___Train Local_Simple,  epoch 160, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 160, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0367, Accuracy: 9881/10000 (98.8100%)
poison local model 52 index 0
___Train Local_Simple,  epoch 160, local model 52, internal_epoch   1,  Average loss: 0.0005, Accuracy: 248/253 (98.0237%)
___Train Local_Simple,  epoch 160, local model 52, internal_epoch   2,  Average loss: 0.0008, Accuracy: 249/253 (98.4190%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.1154, Accuracy: 9655/10000 (96.5500%)
___Train Local_Simple,  epoch 160, local model 44, internal_epoch   1,  Average loss: 0.0002, Accuracy: 513/517 (99.2263%)
___Train Local_Simple,  epoch 160, local model 44, internal_epoch   2,  Average loss: 0.0002, Accuracy: 513/517 (99.2263%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0416, Accuracy: 9869/10000 (98.6900%)
poison local model 22 index 1
___Train Local_Simple,  epoch 160, local model 22, internal_epoch   1,  Average loss: 0.0007, Accuracy: 576/583 (98.7993%)
___Train Local_Simple,  epoch 160, local model 22, internal_epoch   2,  Average loss: 0.0002, Accuracy: 581/583 (99.6569%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.1708, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch 160, local model 6, internal_epoch   1,  Average loss: 0.0001, Accuracy: 614/615 (99.8374%)
___Train Local_Simple,  epoch 160, local model 6, internal_epoch   2,  Average loss: 0.0004, Accuracy: 612/615 (99.5122%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0632, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 160, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 160, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0653, Accuracy: 9798/10000 (97.9800%)
___Train Local_Simple,  epoch 160, local model 95, internal_epoch   1,  Average loss: 0.0002, Accuracy: 600/602 (99.6678%)
___Train Local_Simple,  epoch 160, local model 95, internal_epoch   2,  Average loss: 0.0000, Accuracy: 602/602 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.2395, Accuracy: 9197/10000 (91.9700%)
___Train Local_Simple,  epoch 160, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 494/494 (100.0000%)
___Train Local_Simple,  epoch 160, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0468, Accuracy: 9849/10000 (98.4900%)
___Train Local_Simple,  epoch 160, local model 79, internal_epoch   1,  Average loss: 0.0002, Accuracy: 182/182 (100.0000%)
___Train Local_Simple,  epoch 160, local model 79, internal_epoch   2,  Average loss: 0.0000, Accuracy: 182/182 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0342, Accuracy: 9897/10000 (98.9700%)
time spent on training: 42.629652976989746
Starting performing KrMLRFL...
Num data points: [354, 501, 253, 517, 583, 615, 506, 602, 494, 182]
Num selected data points: [354 501 517 615 506 494 182]
The chosen ones are users: [0, 1, 3, 5, 6, 8, 9], which are global users: [55, 28, 44, 6, 49, 68, 79]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 22]
base_p: [ 0.00122634  0.00014891  0.00086505 ... -0.00056195 -0.00056013
 -0.00012692]
[T_SCORE] attacker_local_idxs is:  [0, 2, 3, 4, 7]
layer1_inf_time: 3.166259765625
[PAIRWISE] pred_attackers_indx:  [4 7]
layer2_inf_t: 27.985107421875
assumed final_attacker_idxs:  [0 2 3 4 7]
final_attacker_idxs is: [0 2 3 4 7]
g_attacker_idxs: [55 52 44 22 95]
g_normal_idxs: [28  6 49 68 79]
filtered_attacker_idxs: [2, 4, 7]
final_attacker_idxs are: [2, 4, 7]
num_dps: [354, 501, 253, 517, 583, 615, 506, 602, 494, 182]
___Test Local_Simple poisoned: False, epoch: 160: Average loss: 0.0304, Accuracy: 9907/10000 (99.0700%)
epoch_acc: 99.07000000000001
___Test Local_Simple poisoned: True, epoch: 160: Average loss: 15.2330, Accuracy: 6/8968 (0.0669%)
Done in 174.7071168422699 sec.
Server Epoch:161 choose agents : [46, 0, 57, 92, 62, 55, 27, 23, 9, 38].
___Train Local_Simple,  epoch 161, local model 46, internal_epoch   1,  Average loss: 0.0007, Accuracy: 702/710 (98.8732%)
___Train Local_Simple,  epoch 161, local model 46, internal_epoch   2,  Average loss: 0.0005, Accuracy: 707/710 (99.5775%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.2068, Accuracy: 9337/10000 (93.3700%)
___Train Local_Simple,  epoch 161, local model 0, internal_epoch   1,  Average loss: 0.0005, Accuracy: 430/435 (98.8506%)
___Train Local_Simple,  epoch 161, local model 0, internal_epoch   2,  Average loss: 0.0001, Accuracy: 435/435 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.1050, Accuracy: 9674/10000 (96.7400%)
___Train Local_Simple,  epoch 161, local model 57, internal_epoch   1,  Average loss: 0.0005, Accuracy: 341/343 (99.4169%)
___Train Local_Simple,  epoch 161, local model 57, internal_epoch   2,  Average loss: 0.0002, Accuracy: 342/343 (99.7085%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.1872, Accuracy: 9542/10000 (95.4200%)
___Train Local_Simple,  epoch 161, local model 92, internal_epoch   1,  Average loss: 0.0004, Accuracy: 930/937 (99.2529%)
___Train Local_Simple,  epoch 161, local model 92, internal_epoch   2,  Average loss: 0.0008, Accuracy: 921/937 (98.2924%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.5606, Accuracy: 8539/10000 (85.3900%)
___Train Local_Simple,  epoch 161, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Train Local_Simple,  epoch 161, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0480, Accuracy: 9848/10000 (98.4800%)
___Train Local_Simple,  epoch 161, local model 55, internal_epoch   1,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Train Local_Simple,  epoch 161, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0561, Accuracy: 9830/10000 (98.3000%)
poison local model 27 index 0
___Train Local_Simple,  epoch 161, local model 27, internal_epoch   1,  Average loss: 0.0010, Accuracy: 463/471 (98.3015%)
___Train Local_Simple,  epoch 161, local model 27, internal_epoch   2,  Average loss: 0.0006, Accuracy: 467/471 (99.1507%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.4221, Accuracy: 9171/10000 (91.7100%)
___Train Local_Simple,  epoch 161, local model 23, internal_epoch   1,  Average loss: 0.0001, Accuracy: 293/293 (100.0000%)
___Train Local_Simple,  epoch 161, local model 23, internal_epoch   2,  Average loss: 0.0000, Accuracy: 293/293 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0525, Accuracy: 9820/10000 (98.2000%)
___Train Local_Simple,  epoch 161, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 161, local model 9, internal_epoch   2,  Average loss: 0.0000, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0459, Accuracy: 9860/10000 (98.6000%)
___Train Local_Simple,  epoch 161, local model 38, internal_epoch   1,  Average loss: 0.0001, Accuracy: 893/895 (99.7765%)
___Train Local_Simple,  epoch 161, local model 38, internal_epoch   2,  Average loss: 0.0001, Accuracy: 894/895 (99.8883%)
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0483, Accuracy: 9842/10000 (98.4200%)
time spent on training: 38.13002347946167
Starting performing KrMLRFL...
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [27]
base_p: [-0.00089873  0.0001818   0.0020335  ... -0.00177637  0.00127363
 -0.00017416]
[T_SCORE] attacker_local_idxs is:  [0, 3, 5, 6, 9]
layer1_inf_time: 3.075439453125
[PAIRWISE] pred_attackers_indx:  [0 2 3 5 6]
layer2_inf_t: 27.174560546875
assumed final_attacker_idxs:  [0 2 3 5 6 9]
final_attacker_idxs is: [0 2 3 5 6 9]
g_attacker_idxs: [46 57 92 55 27 38]
g_normal_idxs: [ 0 62 23  9]
filtered_attacker_idxs: [0, 3, 6]
final_attacker_idxs are: [0, 3, 6]
num_dps: [710, 435, 343, 937, 423, 354, 471, 293, 436, 895]
Num data points: [710, 435, 343, 937, 423, 354, 471, 293, 436, 895]
Num selected data points: [435 343 423 354 293 436 895]
The chosen ones are users: [1, 2, 4, 5, 7, 8, 9], which are global users: [0, 57, 62, 55, 23, 9, 38]
___Test Local_Simple poisoned: False, epoch: 161: Average loss: 0.0328, Accuracy: 9897/10000 (98.9700%)
epoch_acc: 98.97
___Test Local_Simple poisoned: True, epoch: 161: Average loss: 15.6181, Accuracy: 6/8968 (0.0669%)
Done in 190.19758319854736 sec.
Server Epoch:162 choose agents : [55, 64, 28, 20, 33, 0, 46, 91, 16, 65].
___Train Local_Simple,  epoch 162, local model 55, internal_epoch   1,  Average loss: 0.0001, Accuracy: 354/354 (100.0000%)
___Train Local_Simple,  epoch 162, local model 55, internal_epoch   2,  Average loss: 0.0000, Accuracy: 354/354 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0444, Accuracy: 9869/10000 (98.6900%)
___Train Local_Simple,  epoch 162, local model 64, internal_epoch   1,  Average loss: 0.0003, Accuracy: 808/813 (99.3850%)
___Train Local_Simple,  epoch 162, local model 64, internal_epoch   2,  Average loss: 0.0006, Accuracy: 800/813 (98.4010%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.1134, Accuracy: 9639/10000 (96.3900%)
___Train Local_Simple,  epoch 162, local model 28, internal_epoch   1,  Average loss: 0.0001, Accuracy: 501/501 (100.0000%)
___Train Local_Simple,  epoch 162, local model 28, internal_epoch   2,  Average loss: 0.0000, Accuracy: 501/501 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0367, Accuracy: 9882/10000 (98.8200%)
poison local model 20 index 0
___Train Local_Simple,  epoch 162, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 420/429 (97.9021%)
___Train Local_Simple,  epoch 162, local model 20, internal_epoch   2,  Average loss: 0.0005, Accuracy: 425/429 (99.0676%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.1818, Accuracy: 9424/10000 (94.2400%)
___Train Local_Simple,  epoch 162, local model 33, internal_epoch   1,  Average loss: 0.0008, Accuracy: 613/623 (98.3949%)
___Train Local_Simple,  epoch 162, local model 33, internal_epoch   2,  Average loss: 0.0007, Accuracy: 614/623 (98.5554%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.1372, Accuracy: 9563/10000 (95.6300%)
___Train Local_Simple,  epoch 162, local model 0, internal_epoch   1,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Train Local_Simple,  epoch 162, local model 0, internal_epoch   2,  Average loss: 0.0002, Accuracy: 434/435 (99.7701%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0616, Accuracy: 9810/10000 (98.1000%)
___Train Local_Simple,  epoch 162, local model 46, internal_epoch   1,  Average loss: 0.0010, Accuracy: 696/710 (98.0282%)
___Train Local_Simple,  epoch 162, local model 46, internal_epoch   2,  Average loss: 0.0009, Accuracy: 701/710 (98.7324%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.1666, Accuracy: 9464/10000 (94.6400%)
poison local model 91 index 1
___Train Local_Simple,  epoch 162, local model 91, internal_epoch   1,  Average loss: 0.0003, Accuracy: 254/256 (99.2188%)
___Train Local_Simple,  epoch 162, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0578, Accuracy: 9824/10000 (98.2400%)
poison local model 16 index 2
___Train Local_Simple,  epoch 162, local model 16, internal_epoch   1,  Average loss: 0.0006, Accuracy: 902/915 (98.5792%)
___Train Local_Simple,  epoch 162, local model 16, internal_epoch   2,  Average loss: 0.0014, Accuracy: 890/915 (97.2678%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0670, Accuracy: 9780/10000 (97.8000%)
___Train Local_Simple,  epoch 162, local model 65, internal_epoch   1,  Average loss: 0.0001, Accuracy: 371/371 (100.0000%)
___Train Local_Simple,  epoch 162, local model 65, internal_epoch   2,  Average loss: 0.0000, Accuracy: 371/371 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0344, Accuracy: 9891/10000 (98.9100%)
time spent on training: 48.230326890945435
Starting performing KrMLRFL...
Num data points: [354, 813, 501, 429, 623, 435, 710, 256, 915, 371]
Num selected data points: [354 813 501 435 256 371]
The chosen ones are users: [0, 1, 2, 5, 7, 9], which are global users: [55, 64, 28, 0, 91, 65]
___Test Local_Simple poisoned: False, epoch: 162: Average loss: 0.0328, Accuracy: 9897/10000 (98.9700%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [20, 91, 16]
base_p: [ 0.00083867  0.00018412 -0.00109538 ... -0.00423536  0.00032764
 -0.0017539 ]
[T_SCORE] attacker_local_idxs is:  [1, 3, 4, 6, 8]
layer1_inf_time: 3.76123046875
[PAIRWISE] pred_attackers_indx:  [1 3 6 8]
layer2_inf_t: 144.282470703125
assumed final_attacker_idxs:  [1 3 4 6 8]
final_attacker_idxs is: [1 3 4 6 8]
g_attacker_idxs: [64 20 33 46 16]
g_normal_idxs: [55 28  0 91 65]
filtered_attacker_idxs: [3, 4, 6, 8]
final_attacker_idxs are: [3, 4, 6, 8]
num_dps: [354, 813, 501, 429, 623, 435, 710, 256, 915, 371]
epoch_acc: 98.97
___Test Local_Simple poisoned: True, epoch: 162: Average loss: 15.6339, Accuracy: 5/8968 (0.0558%)
Done in 200.6553304195404 sec.
Server Epoch:163 choose agents : [68, 49, 29, 31, 62, 52, 18, 63, 64, 93].
___Train Local_Simple,  epoch 163, local model 68, internal_epoch   1,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 163, local model 68, internal_epoch   2,  Average loss: 0.0000, Accuracy: 494/494 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0382, Accuracy: 9883/10000 (98.8300%)
___Train Local_Simple,  epoch 163, local model 49, internal_epoch   1,  Average loss: 0.0002, Accuracy: 504/506 (99.6047%)
___Train Local_Simple,  epoch 163, local model 49, internal_epoch   2,  Average loss: 0.0001, Accuracy: 504/506 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0493, Accuracy: 9842/10000 (98.4200%)
___Train Local_Simple,  epoch 163, local model 29, internal_epoch   1,  Average loss: 0.0002, Accuracy: 999/1002 (99.7006%)
___Train Local_Simple,  epoch 163, local model 29, internal_epoch   2,  Average loss: 0.0000, Accuracy: 1002/1002 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0906, Accuracy: 9721/10000 (97.2100%)
___Train Local_Simple,  epoch 163, local model 31, internal_epoch   1,  Average loss: 0.0001, Accuracy: 832/835 (99.6407%)
___Train Local_Simple,  epoch 163, local model 31, internal_epoch   2,  Average loss: 0.0000, Accuracy: 835/835 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0757, Accuracy: 9776/10000 (97.7600%)
___Train Local_Simple,  epoch 163, local model 62, internal_epoch   1,  Average loss: 0.0001, Accuracy: 423/423 (100.0000%)
___Train Local_Simple,  epoch 163, local model 62, internal_epoch   2,  Average loss: 0.0000, Accuracy: 423/423 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0414, Accuracy: 9869/10000 (98.6900%)
poison local model 52 index 0
___Train Local_Simple,  epoch 163, local model 52, internal_epoch   1,  Average loss: 0.0002, Accuracy: 252/253 (99.6047%)
___Train Local_Simple,  epoch 163, local model 52, internal_epoch   2,  Average loss: 0.0001, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.1418, Accuracy: 9613/10000 (96.1300%)
___Train Local_Simple,  epoch 163, local model 18, internal_epoch   1,  Average loss: 0.0008, Accuracy: 451/459 (98.2571%)
___Train Local_Simple,  epoch 163, local model 18, internal_epoch   2,  Average loss: 0.0009, Accuracy: 453/459 (98.6928%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.7751, Accuracy: 8953/10000 (89.5300%)
poison local model 63 index 1
___Train Local_Simple,  epoch 163, local model 63, internal_epoch   1,  Average loss: 0.0010, Accuracy: 875/889 (98.4252%)
___Train Local_Simple,  epoch 163, local model 63, internal_epoch   2,  Average loss: 0.0010, Accuracy: 866/889 (97.4128%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0982, Accuracy: 9665/10000 (96.6500%)
___Train Local_Simple,  epoch 163, local model 64, internal_epoch   1,  Average loss: 0.0002, Accuracy: 811/813 (99.7540%)
___Train Local_Simple,  epoch 163, local model 64, internal_epoch   2,  Average loss: 0.0001, Accuracy: 812/813 (99.8770%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0820, Accuracy: 9764/10000 (97.6400%)
poison local model 93 index 2
___Train Local_Simple,  epoch 163, local model 93, internal_epoch   1,  Average loss: 0.0004, Accuracy: 619/623 (99.3579%)
___Train Local_Simple,  epoch 163, local model 93, internal_epoch   2,  Average loss: 0.0003, Accuracy: 620/623 (99.5185%)
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.3675, Accuracy: 9040/10000 (90.4000%)
time spent on training: 54.483094692230225
Starting performing KrMLRFL...
Num data points: [494, 506, 1002, 835, 423, 253, 459, 889, 813, 623]
Num selected data points: [ 494  506 1002  835  423  813]
The chosen ones are users: [0, 1, 2, 3, 4, 8], which are global users: [68, 49, 29, 31, 62, 64]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [52, 63, 93]
base_p: [ 0.00113431  0.00021591 -0.00036613 ...  0.00266518  0.00092411
  0.00222886]
[T_SCORE] attacker_local_idxs is:  [5, 6, 7, 8, 9]
layer1_inf_time: 2.6826171875
[PAIRWISE] pred_attackers_indx:  [7 8 9]
layer2_inf_t: 37.0888671875
assumed final_attacker_idxs:  [5 6 7 8 9]
final_attacker_idxs is: [5 6 7 8 9]
g_attacker_idxs: [52 18 63 64 93]
g_normal_idxs: [68 49 29 31 62]
filtered_attacker_idxs: [5, 6, 7, 9]
final_attacker_idxs are: [5, 6, 7, 9]
num_dps: [494, 506, 1002, 835, 423, 253, 459, 889, 813, 623]
___Test Local_Simple poisoned: False, epoch: 163: Average loss: 0.0319, Accuracy: 9909/10000 (99.0900%)
epoch_acc: 99.09
___Test Local_Simple poisoned: True, epoch: 163: Average loss: 14.7767, Accuracy: 15/8968 (0.1673%)
Done in 209.90029215812683 sec.
Server Epoch:164 choose agents : [26, 71, 40, 52, 69, 25, 34, 82, 13, 80].
poison local model 26 index 0
___Train Local_Simple,  epoch 164, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 549/554 (99.0975%)
___Train Local_Simple,  epoch 164, local model 26, internal_epoch   2,  Average loss: 0.0007, Accuracy: 548/554 (98.9170%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0833, Accuracy: 9732/10000 (97.3200%)
poison local model 71 index 1
___Train Local_Simple,  epoch 164, local model 71, internal_epoch   1,  Average loss: 0.0006, Accuracy: 1367/1384 (98.7717%)
___Train Local_Simple,  epoch 164, local model 71, internal_epoch   2,  Average loss: 0.0003, Accuracy: 1375/1384 (99.3497%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.3845, Accuracy: 8847/10000 (88.4700%)
___Train Local_Simple,  epoch 164, local model 40, internal_epoch   1,  Average loss: 0.0002, Accuracy: 769/772 (99.6114%)
___Train Local_Simple,  epoch 164, local model 40, internal_epoch   2,  Average loss: 0.0001, Accuracy: 770/772 (99.7409%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0622, Accuracy: 9811/10000 (98.1100%)
poison local model 52 index 2
___Train Local_Simple,  epoch 164, local model 52, internal_epoch   1,  Average loss: 0.0008, Accuracy: 248/253 (98.0237%)
___Train Local_Simple,  epoch 164, local model 52, internal_epoch   2,  Average loss: 0.0003, Accuracy: 252/253 (99.6047%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.2211, Accuracy: 9397/10000 (93.9700%)
___Train Local_Simple,  epoch 164, local model 69, internal_epoch   1,  Average loss: 0.0007, Accuracy: 253/256 (98.8281%)
___Train Local_Simple,  epoch 164, local model 69, internal_epoch   2,  Average loss: 0.0003, Accuracy: 253/256 (98.8281%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.1161, Accuracy: 9634/10000 (96.3400%)
___Train Local_Simple,  epoch 164, local model 25, internal_epoch   1,  Average loss: 0.0002, Accuracy: 646/647 (99.8454%)
___Train Local_Simple,  epoch 164, local model 25, internal_epoch   2,  Average loss: 0.0008, Accuracy: 640/647 (98.9181%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0903, Accuracy: 9728/10000 (97.2800%)
poison local model 34 index 3
___Train Local_Simple,  epoch 164, local model 34, internal_epoch   1,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Train Local_Simple,  epoch 164, local model 34, internal_epoch   2,  Average loss: 0.0002, Accuracy: 411/413 (99.5157%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0899, Accuracy: 9731/10000 (97.3100%)
___Train Local_Simple,  epoch 164, local model 82, internal_epoch   1,  Average loss: 0.0001, Accuracy: 711/713 (99.7195%)
___Train Local_Simple,  epoch 164, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.3468, Accuracy: 9140/10000 (91.4000%)
poison local model 13 index 0
___Train Local_Simple,  epoch 164, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%)
___Train Local_Simple,  epoch 164, local model 13, internal_epoch   2,  Average loss: 0.0009, Accuracy: 718/734 (97.8202%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.1952, Accuracy: 9497/10000 (94.9700%)
___Train Local_Simple,  epoch 164, local model 80, internal_epoch   1,  Average loss: 0.0002, Accuracy: 430/431 (99.7680%)
___Train Local_Simple,  epoch 164, local model 80, internal_epoch   2,  Average loss: 0.0000, Accuracy: 431/431 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0562, Accuracy: 9837/10000 (98.3700%)
time spent on training: 61.628395795822144
Starting performing KrMLRFL...
Num data points: [554, 1384, 772, 253, 256, 647, 413, 713, 734, 431]
Num selected data points: [253 256 647 713 431]
The chosen ones are users: [3, 4, 5, 7, 9], which are global users: [52, 69, 25, 82, 80]
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [26, 71, 52, 34, 13]
base_p: [-1.6225949e-03  2.2419170e-04  7.3939562e-05 ... -3.3347160e-03
  3.1789392e-04 -2.0245463e-04]
[T_SCORE] attacker_local_idxs is:  [0, 1, 2, 6, 8]
layer1_inf_time: 5.01416015625
[PAIRWISE] pred_attackers_indx:  [1 8]
layer2_inf_t: 42.162353515625
assumed final_attacker_idxs:  [0 1 2 6 8]
final_attacker_idxs is: [0 1 2 6 8]
g_attacker_idxs: [26 71 40 34 13]
g_normal_idxs: [52 69 25 82 80]
filtered_attacker_idxs: [0, 1, 2, 6, 8]
final_attacker_idxs are: [0, 1, 2, 6, 8]
num_dps: [554, 1384, 772, 253, 256, 647, 413, 713, 734, 431]
___Test Local_Simple poisoned: False, epoch: 164: Average loss: 0.0410, Accuracy: 9862/10000 (98.6200%)
epoch_acc: 98.61999999999999
___Test Local_Simple poisoned: True, epoch: 164: Average loss: 13.9327, Accuracy: 12/8968 (0.1338%)
Done in 224.1226305961609 sec.
Server Epoch:165 choose agents : [91, 45, 92, 26, 17, 20, 82, 86, 68, 37].
poison local model 91 index 0
___Train Local_Simple,  epoch 165, local model 91, internal_epoch   1,  Average loss: 0.0002, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 165, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0483, Accuracy: 9841/10000 (98.4100%)
poison local model 45 index 1
___Train Local_Simple,  epoch 165, local model 45, internal_epoch   1,  Average loss: 0.0012, Accuracy: 614/628 (97.7707%)
___Train Local_Simple,  epoch 165, local model 45, internal_epoch   2,  Average loss: 0.0009, Accuracy: 620/628 (98.7261%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.5738, Accuracy: 8501/10000 (85.0100%)
___Train Local_Simple,  epoch 165, local model 92, internal_epoch   1,  Average loss: 0.0004, Accuracy: 928/937 (99.0395%)
___Train Local_Simple,  epoch 165, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 933/937 (99.5731%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.3030, Accuracy: 9072/10000 (90.7200%)
poison local model 26 index 2
___Train Local_Simple,  epoch 165, local model 26, internal_epoch   1,  Average loss: 0.0004, Accuracy: 549/554 (99.0975%)
___Train Local_Simple,  epoch 165, local model 26, internal_epoch   2,  Average loss: 0.0003, Accuracy: 549/554 (99.0975%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0493, Accuracy: 9834/10000 (98.3400%)
poison local model 17 index 3
___Train Local_Simple,  epoch 165, local model 17, internal_epoch   1,  Average loss: 0.0013, Accuracy: 609/620 (98.2258%)
___Train Local_Simple,  epoch 165, local model 17, internal_epoch   2,  Average loss: 0.0007, Accuracy: 611/620 (98.5484%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0958, Accuracy: 9702/10000 (97.0200%)
poison local model 20 index 0
___Train Local_Simple,  epoch 165, local model 20, internal_epoch   1,  Average loss: 0.0011, Accuracy: 420/429 (97.9021%)
___Train Local_Simple,  epoch 165, local model 20, internal_epoch   2,  Average loss: 0.0004, Accuracy: 425/429 (99.0676%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.2348, Accuracy: 9390/10000 (93.9000%)
___Train Local_Simple,  epoch 165, local model 82, internal_epoch   1,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Train Local_Simple,  epoch 165, local model 82, internal_epoch   2,  Average loss: 0.0000, Accuracy: 713/713 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0484, Accuracy: 9835/10000 (98.3500%)
___Train Local_Simple,  epoch 165, local model 86, internal_epoch   1,  Average loss: 0.0004, Accuracy: 248/250 (99.2000%)
___Train Local_Simple,  epoch 165, local model 86, internal_epoch   2,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0671, Accuracy: 9791/10000 (97.9100%)
___Train Local_Simple,  epoch 165, local model 68, internal_epoch   1,  Average loss: 0.0002, Accuracy: 493/494 (99.7976%)
___Train Local_Simple,  epoch 165, local model 68, internal_epoch   2,  Average loss: 0.0001, Accuracy: 493/494 (99.7976%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0937, Accuracy: 9689/10000 (96.8900%)
___Train Local_Simple,  epoch 165, local model 37, internal_epoch   1,  Average loss: 0.0008, Accuracy: 846/860 (98.3721%)
___Train Local_Simple,  epoch 165, local model 37, internal_epoch   2,  Average loss: 0.0004, Accuracy: 851/860 (98.9535%)
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.1921, Accuracy: 9358/10000 (93.5800%)
time spent on training: 60.15977358818054
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [91, 45, 26, 17, 20]
base_p: [ 0.00022977  0.00014122  0.00131074 ...  0.0012147  -0.00276267
 -0.00018915]
[T_SCORE] attacker_local_idxs is:  [1, 2, 3, 4, 5, 9]
layer1_inf_time: 3.577880859375
[PAIRWISE] pred_attackers_indx:  [1 3 4 5 9]
layer2_inf_t: 168.49951171875
assumed final_attacker_idxs:  [1 2 3 4 5 9]
final_attacker_idxs is: [1 2 3 4 5 9]
g_attacker_idxs: [45 92 26 17 20 37]
g_normal_idxs: [91 82 86 68]
filtered_attacker_idxs: [1, 2, 3, 4, 5, 9]
final_attacker_idxs are: [1, 2, 3, 4, 5, 9]
num_dps: [256, 628, 937, 554, 620, 429, 713, 250, 494, 860]
epoch_acc: 98.8
Starting performing KrMLRFL...
Num data points: [256, 628, 937, 554, 620, 429, 713, 250, 494, 860]
Num selected data points: [256 713 250 494]
The chosen ones are users: [0, 6, 7, 8], which are global users: [91, 82, 86, 68]
___Test Local_Simple poisoned: False, epoch: 165: Average loss: 0.0371, Accuracy: 9880/10000 (98.8000%)
___Test Local_Simple poisoned: True, epoch: 165: Average loss: 14.9600, Accuracy: 9/8968 (0.1004%)
Done in 225.12158012390137 sec.
Server Epoch:166 choose agents : [13, 86, 10, 11, 9, 91, 16, 92, 50, 63].
poison local model 13 index 0
___Train Local_Simple,  epoch 166, local model 13, internal_epoch   1,  Average loss: 0.0005, Accuracy: 725/734 (98.7738%)
___Train Local_Simple,  epoch 166, local model 13, internal_epoch   2,  Average loss: 0.0004, Accuracy: 729/734 (99.3188%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.1732, Accuracy: 9477/10000 (94.7700%)
___Train Local_Simple,  epoch 166, local model 86, internal_epoch   1,  Average loss: 0.0001, Accuracy: 250/250 (100.0000%)
___Train Local_Simple,  epoch 166, local model 86, internal_epoch   2,  Average loss: 0.0000, Accuracy: 250/250 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0485, Accuracy: 9838/10000 (98.3800%)
___Train Local_Simple,  epoch 166, local model 10, internal_epoch   1,  Average loss: 0.0001, Accuracy: 890/892 (99.7758%)
___Train Local_Simple,  epoch 166, local model 10, internal_epoch   2,  Average loss: 0.0000, Accuracy: 892/892 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0866, Accuracy: 9730/10000 (97.3000%)
poison local model 11 index 1
___Train Local_Simple,  epoch 166, local model 11, internal_epoch   1,  Average loss: 0.0006, Accuracy: 638/645 (98.9147%)
___Train Local_Simple,  epoch 166, local model 11, internal_epoch   2,  Average loss: 0.0005, Accuracy: 636/645 (98.6047%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.1374, Accuracy: 9595/10000 (95.9500%)
___Train Local_Simple,  epoch 166, local model 9, internal_epoch   1,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Train Local_Simple,  epoch 166, local model 9, internal_epoch   2,  Average loss: 0.0001, Accuracy: 436/436 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0804, Accuracy: 9749/10000 (97.4900%)
poison local model 91 index 2
___Train Local_Simple,  epoch 166, local model 91, internal_epoch   1,  Average loss: 0.0001, Accuracy: 255/256 (99.6094%)
___Train Local_Simple,  epoch 166, local model 91, internal_epoch   2,  Average loss: 0.0000, Accuracy: 256/256 (100.0000%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0395, Accuracy: 9873/10000 (98.7300%)
poison local model 16 index 3
___Train Local_Simple,  epoch 166, local model 16, internal_epoch   1,  Average loss: 0.0008, Accuracy: 903/915 (98.6885%)
___Train Local_Simple,  epoch 166, local model 16, internal_epoch   2,  Average loss: 0.0004, Accuracy: 911/915 (99.5628%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0603, Accuracy: 9818/10000 (98.1800%)
___Train Local_Simple,  epoch 166, local model 92, internal_epoch   1,  Average loss: 0.0004, Accuracy: 928/937 (99.0395%)
___Train Local_Simple,  epoch 166, local model 92, internal_epoch   2,  Average loss: 0.0003, Accuracy: 932/937 (99.4664%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.2322, Accuracy: 9239/10000 (92.3900%)
___Train Local_Simple,  epoch 166, local model 50, internal_epoch   1,  Average loss: 0.0003, Accuracy: 472/474 (99.5781%)
___Train Local_Simple,  epoch 166, local model 50, internal_epoch   2,  Average loss: 0.0001, Accuracy: 473/474 (99.7890%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.1614, Accuracy: 9504/10000 (95.0400%)
poison local model 63 index 0
___Train Local_Simple,  epoch 166, local model 63, internal_epoch   1,  Average loss: 0.0011, Accuracy: 870/889 (97.8628%)
___Train Local_Simple,  epoch 166, local model 63, internal_epoch   2,  Average loss: 0.0008, Accuracy: 875/889 (98.4252%)
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0538, Accuracy: 9841/10000 (98.4100%)
type of model <class 'models.MnistNet.MnistNet'>
selected_attackers: [13, 11, 91, 16, 63]
base_p: [ 0.00268989  0.00022911  0.00041951 ...  0.00110471 -0.00187776
 -0.00308778]
[T_SCORE] attacker_local_idxs is:  [0, 3, 6, 7, 9]
layer1_inf_time: 2.932373046875
[PAIRWISE] pred_attackers_indx:  [0 3 6]
layer2_inf_t: 29.451904296875
assumed final_attacker_idxs:  [0 3 6 7 9]
final_attacker_idxs is: [0 3 6 7 9]
g_attacker_idxs: [13 11 16 92 63]
g_normal_idxs: [86 10  9 91 50]
filtered_attacker_idxs: [0, 3, 6, 7, 9]
final_attacker_idxs are: [0, 3, 6, 7, 9]
num_dps: [734, 250, 892, 645, 436, 256, 915, 937, 474, 889]
time spent on training: 68.14913558959961
Starting performing KrMLRFL...
Num data points: [734, 250, 892, 645, 436, 256, 915, 937, 474, 889]
Num selected data points: [250 892 436 256 474]
The chosen ones are users: [1, 2, 4, 5, 8], which are global users: [86, 10, 9, 91, 50]
epoch_acc: 98.8
___Test Local_Simple poisoned: False, epoch: 166: Average loss: 0.0367, Accuracy: 9880/10000 (98.8000%)
___Test Local_Simple poisoned: True, epoch: 166: Average loss: 15.7865, Accuracy: 4/8968 (0.0446%)
Traceback (most recent call last):
  File "dba.py", line 268, in <module>
    poison_epoch_loss, poison_epoch_acc, poison_epoch_corret, poison_epoch_total = trigger_test_byname(helper, agent_name_key, None, epoch)
  File "dba.py", line 54, in trigger_test_byname
    test.Mytest_poison_agent_trigger(helper=helper, model=helper.target_model, agent_name_key=agent_name_key)
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/test.py", line 222, in Mytest_poison_agent_trigger
    data, targets, poison_num = helper.get_poison_batch(batch, adversarial_index=adv_index, evaluation=True)
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/image_helper.py", line 310, in get_poison_batch
    new_images[index] = self.add_pixel_pattern(images[index],adversarial_index)
  File "/home/ubuntu/dung.nt184244/backdoor-attack/FedGrad-DBA/image_helper.py", line 330, in add_pixel_pattern
    image = copy.deepcopy(ori_image)
  File "/home/ubuntu/miniconda3/envs/dungnt/lib/python3.8/copy.py", line 153, in deepcopy
    y = copier(memo)
  File "/home/ubuntu/miniconda3/envs/dungnt/lib/python3.8/site-packages/torch/_tensor.py", line 141, in __deepcopy__
    new_tensor = self.new_empty([])
KeyboardInterrupt